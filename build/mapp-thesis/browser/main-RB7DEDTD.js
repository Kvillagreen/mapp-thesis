var XC=Object.defineProperty,Qk=Object.defineProperties;var Kk=Object.getOwnPropertyDescriptors;var Rf=Object.getOwnPropertySymbols,Jk=Object.getPrototypeOf,QC=Object.prototype.hasOwnProperty,KC=Object.prototype.propertyIsEnumerable,$k=Reflect.get;var bx=(i,e)=>(e=Symbol[i])?e:Symbol.for("Symbol."+i);var YC=(i,e,t)=>e in i?XC(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ae=(i,e)=>{for(var t in e||={})QC.call(e,t)&&YC(i,t,e[t]);if(Rf)for(var t of Rf(e))KC.call(e,t)&&YC(i,t,e[t]);return i},We=(i,e)=>Qk(i,Kk(e));var yx=(i,e)=>{var t={};for(var n in i)QC.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&Rf)for(var n of Rf(i))e.indexOf(n)<0&&KC.call(i,n)&&(t[n]=i[n]);return t};var eN=(i,e)=>{for(var t in e)XC(i,t,{get:e[t],enumerable:!0})};var nd=(i,e,t)=>$k(Jk(i),t,e);var re=(i,e,t)=>new Promise((n,r)=>{var s=l=>{try{a(t.next(l))}catch(d){r(d)}},o=l=>{try{a(t.throw(l))}catch(d){r(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(i,e)).next())}),Lf=function(i,e){this[0]=i,this[1]=e},Ax=(i,e,t)=>{var n=(o,a,l,d)=>{try{var c=t[o](a),u=(a=c.value)instanceof Lf,h=c.done;Promise.resolve(u?a[0]:a).then(f=>u?n(o==="return"?o:"next",a[1]?{done:f.done,value:f.value}:f,l,d):l({value:f,done:h})).catch(f=>n("throw",f,l,d))}catch(f){d(f)}},r=o=>s[o]=a=>new Promise((l,d)=>n(o,a,l,d)),s={};return t=t.apply(i,e),s[bx("asyncIterator")]=()=>s,r("next"),r("throw"),r("return"),s};var JC=(i,e,t)=>(e=i[bx("asyncIterator")])?e.call(i):(i=i[bx("iterator")](),e={},t=(n,r)=>(r=i[n])&&(e[n]=s=>new Promise((o,a,l)=>(s=r.call(i,s),l=s.done,Promise.resolve(s.value).then(d=>o({value:d,done:l}),a)))),t("next"),t("return"),e);function $C(i,e){return Object.is(i,e)}var Kn=null,ru=!1,kf=1,Cs=Symbol("SIGNAL");function Qt(i){let e=Kn;return Kn=i,e}function eM(){return Kn}function tN(){return ru}var id={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Cx(i){if(ru)throw new Error("");if(Kn===null)return;Kn.consumerOnSignalRead(i);let e=Kn.nextProducerIndex++;if(Uf(Kn),e<Kn.producerNode.length&&Kn.producerNode[e]!==i&&su(Kn)){let t=Kn.producerNode[e];Vf(t,Kn.producerIndexOfThis[e])}Kn.producerNode[e]!==i&&(Kn.producerNode[e]=i,Kn.producerIndexOfThis[e]=su(Kn)?sM(i,Kn,e):0),Kn.producerLastReadVersion[e]=i.version}function nN(){kf++}function tM(i){if(!(su(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===kf)){if(!i.producerMustRecompute(i)&&!Of(i)){i.dirty=!1,i.lastCleanEpoch=kf;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=kf}}function nM(i){if(i.liveConsumerNode===void 0)return;let e=ru;ru=!0;try{for(let t of i.liveConsumerNode)t.dirty||rM(t)}finally{ru=e}}function iM(){return Kn?.consumerAllowSignalWrites!==!1}function rM(i){i.dirty=!0,nM(i),i.consumerMarkedDirty?.(i)}function ou(i){return i&&(i.nextProducerIndex=0),Qt(i)}function Ff(i,e){if(Qt(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(su(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)Vf(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function Of(i){Uf(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(tM(t),n!==t.version))return!0}return!1}function Bf(i){if(Uf(i),su(i))for(let e=0;e<i.producerNode.length;e++)Vf(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function sM(i,e,t){if(oM(i),i.liveConsumerNode.length===0&&aM(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=sM(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(t),i.liveConsumerNode.push(e)-1}function Vf(i,e){if(oM(i),i.liveConsumerNode.length===1&&aM(i))for(let n=0;n<i.producerNode.length;n++)Vf(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];Uf(r),r.producerIndexOfThis[n]=e}}function su(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function Uf(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function oM(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function aM(i){return i.producerNode!==void 0}function lM(i){let e=Object.create(iN);e.computation=i;let t=()=>{if(tM(e),Cx(e),e.value===Nf)throw e.error;return e.value};return t[Cs]=e,t}var _x=Symbol("UNSET"),Sx=Symbol("COMPUTING"),Nf=Symbol("ERRORED"),iN=We(ae({},id),{value:_x,dirty:!0,error:null,equal:$C,producerMustRecompute(i){return i.value===_x||i.value===Sx},producerRecomputeValue(i){if(i.value===Sx)throw new Error("Detected cycle in computations.");let e=i.value;i.value=Sx;let t=ou(i),n;try{n=i.computation()}catch(r){n=Nf,i.error=r}finally{Ff(i,t)}if(e!==_x&&e!==Nf&&n!==Nf&&i.equal(e,n)){i.value=e;return}i.value=n,i.version++}});function rN(){throw new Error}var dM=rN;function cM(){dM()}function uM(i){dM=i}var sN=null;function hM(i){let e=Object.create(pM);e.value=i;let t=()=>(Cx(e),e.value);return t[Cs]=e,t}function Mx(i,e){iM()||cM(),i.equal(i.value,e)||(i.value=e,oN(i))}function fM(i,e){iM()||cM(),Mx(i,e(i.value))}var pM=We(ae({},id),{equal:$C,value:void 0});function oN(i){i.version++,nN(),nM(i),sN?.()}function mM(i,e,t){let n=Object.create(aN);t&&(n.consumerAllowSignalWrites=!0),n.fn=i,n.schedule=e;let r=l=>{n.cleanupFn=l};function s(l){return l.fn===null&&l.schedule===null}function o(l){s(l)||(Bf(l),l.cleanupFn(),l.fn=null,l.schedule=null,l.cleanupFn=Ex)}let a=()=>{if(n.fn===null)return;if(tN())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(n.dirty=!1,n.hasRun&&!Of(n))return;n.hasRun=!0;let l=ou(n);try{n.cleanupFn(),n.cleanupFn=Ex,n.fn(r)}finally{Ff(n,l)}};return n.ref={notify:()=>rM(n),run:a,cleanup:()=>n.cleanupFn(),destroy:()=>o(n),[Cs]:n},n.ref}var Ex=()=>{},aN=We(ae({},id),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:i=>{i.schedule!==null&&i.schedule(i.ref)},hasRun:!1,cleanupFn:Ex});function At(i){return typeof i=="function"}function rd(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Hf=rd(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function au(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var zn=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(At(n))try{n()}catch(s){e=s instanceof Hf?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{gM(s)}catch(o){e=e??[],o instanceof Hf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Hf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)gM(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&au(t,e)}remove(e){let{_finalizers:t}=this;t&&au(t,e),e instanceof i&&e._removeParent(this)}};zn.EMPTY=(()=>{let i=new zn;return i.closed=!0,i})();var Tx=zn.EMPTY;function zf(i){return i instanceof zn||i&&"closed"in i&&At(i.remove)&&At(i.add)&&At(i.unsubscribe)}function gM(i){At(i)?i():i.unsubscribe()}var es={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var sd={setTimeout(i,e,...t){let{delegate:n}=sd;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=sd;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function jf(i){sd.setTimeout(()=>{let{onUnhandledError:e}=es;if(e)e(i);else throw i})}function lu(){}var vM=Ix("C",void 0,void 0);function xM(i){return Ix("E",void 0,i)}function wM(i){return Ix("N",i,void 0)}function Ix(i,e,t){return{kind:i,value:e,error:t}}var el=null;function od(i){if(es.useDeprecatedSynchronousErrorHandling){let e=!el;if(e&&(el={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=el;if(el=null,t)throw n}}else i()}function bM(i){es.useDeprecatedSynchronousErrorHandling&&el&&(el.errorThrown=!0,el.error=i)}var tl=class extends zn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,zf(e)&&e.add(this)):this.destination=cN}static create(e,t,n){return new ad(e,t,n)}next(e){this.isStopped?Px(wM(e),this):this._next(e)}error(e){this.isStopped?Px(xM(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Px(vM,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},lN=Function.prototype.bind;function Dx(i,e){return lN.call(i,e)}var Rx=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Gf(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Gf(n)}else Gf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Gf(t)}}},ad=class extends tl{constructor(e,t,n){super();let r;if(At(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&es.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Dx(e.next,s),error:e.error&&Dx(e.error,s),complete:e.complete&&Dx(e.complete,s)}):r=e}this.destination=new Rx(r)}};function Gf(i){es.useDeprecatedSynchronousErrorHandling?bM(i):jf(i)}function dN(i){throw i}function Px(i,e){let{onStoppedNotification:t}=es;t&&sd.setTimeout(()=>t(i,e))}var cN={closed:!0,next:lu,error:dN,complete:lu};var ld=typeof Symbol=="function"&&Symbol.observable||"@@observable";function dr(i){return i}function Lx(...i){return kx(i)}function kx(i){return i.length===0?dr:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var qt=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=hN(t)?t:new ad(t,n,r);return od(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=yM(n),new n((r,s)=>{let o=new ad({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[ld](){return this}pipe(...t){return kx(t)(this)}toPromise(t){return t=yM(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function yM(i){var e;return(e=i??es.Promise)!==null&&e!==void 0?e:Promise}function uN(i){return i&&At(i.next)&&At(i.error)&&At(i.complete)}function hN(i){return i&&i instanceof tl||uN(i)&&zf(i)}function Nx(i){return At(i?.lift)}function Zt(i){return e=>{if(Nx(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ht(i,e,t,n,r){return new Fx(i,e,t,n,r)}var Fx=class extends tl{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function dd(){return Zt((i,e)=>{let t=null;i._refCount++;let n=Ht(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var cd=class extends qt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Nx(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new zn;let t=this.getSubject();e.add(this.source.subscribe(Ht(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=zn.EMPTY)}return e}refCount(){return dd()(this)}};var AM=rd(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var si=(()=>{class i extends qt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new Wf(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new AM}next(t){od(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){od(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){od(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?Tx:(this.currentObservers=null,s.push(t),new zn(()=>{this.currentObservers=null,au(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new qt;return t.source=this,t}}return i.create=(e,t)=>new Wf(e,t),i})(),Wf=class extends si{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:Tx}};var pi=class extends si{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var cr=new qt(i=>i.complete());function _M(i){return i&&At(i.schedule)}function SM(i){return i[i.length-1]}function qf(i){return At(SM(i))?i.pop():void 0}function na(i){return _M(SM(i))?i.pop():void 0}function CM(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{d(n.next(c))}catch(u){o(u)}}function l(c){try{d(n.throw(c))}catch(u){o(u)}}function d(c){c.done?s(c.value):r(c.value).then(a,l)}d((n=n.apply(i,e||[])).next())})}function EM(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nl(i){return this instanceof nl?(this.v=i,this):new nl(i)}function MM(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(p){return Promise.resolve(p).then(f,u)}}function a(f,p){n[f]&&(r[f]=function(x){return new Promise(function(v,g){s.push([f,x,v,g])>1||l(f,x)})},p&&(r[f]=p(r[f])))}function l(f,p){try{d(n[f](p))}catch(x){h(s[0][3],x)}}function d(f){f.value instanceof nl?Promise.resolve(f.value.v).then(c,u):h(s[0][2],f)}function c(f){l("next",f)}function u(f){l("throw",f)}function h(f,p){f(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function TM(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof EM=="function"?EM(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){o=i[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(d){s({value:d,done:a})},o)}}var Zf=i=>i&&typeof i.length=="number"&&typeof i!="function";function Yf(i){return At(i?.then)}function Xf(i){return At(i[ld])}function Qf(i){return Symbol.asyncIterator&&At(i?.[Symbol.asyncIterator])}function Kf(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function fN(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Jf=fN();function $f(i){return At(i?.[Jf])}function ep(i){return MM(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield nl(t.read());if(r)return yield nl(void 0);yield yield nl(n)}}finally{t.releaseLock()}})}function tp(i){return At(i?.getReader)}function jn(i){if(i instanceof qt)return i;if(i!=null){if(Xf(i))return pN(i);if(Zf(i))return mN(i);if(Yf(i))return gN(i);if(Qf(i))return IM(i);if($f(i))return vN(i);if(tp(i))return xN(i)}throw Kf(i)}function pN(i){return new qt(e=>{let t=i[ld]();if(At(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function mN(i){return new qt(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function gN(i){return new qt(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,jf)})}function vN(i){return new qt(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function IM(i){return new qt(e=>{wN(i,e).catch(t=>e.error(t))})}function xN(i){return IM(ep(i))}function wN(i,e){var t,n,r,s;return CM(this,void 0,void 0,function*(){try{for(t=TM(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function Zi(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function np(i,e=0){return Zt((t,n)=>{t.subscribe(Ht(n,r=>Zi(n,i,()=>n.next(r),e),()=>Zi(n,i,()=>n.complete(),e),r=>Zi(n,i,()=>n.error(r),e)))})}function ip(i,e=0){return Zt((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function DM(i,e){return jn(i).pipe(ip(e),np(e))}function PM(i,e){return jn(i).pipe(ip(e),np(e))}function RM(i,e){return new qt(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function LM(i,e){return new qt(t=>{let n;return Zi(t,e,()=>{n=i[Jf](),Zi(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>At(n?.return)&&n.return()})}function rp(i,e){if(!i)throw new Error("Iterable cannot be null");return new qt(t=>{Zi(t,e,()=>{let n=i[Symbol.asyncIterator]();Zi(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function kM(i,e){return rp(ep(i),e)}function NM(i,e){if(i!=null){if(Xf(i))return DM(i,e);if(Zf(i))return RM(i,e);if(Yf(i))return PM(i,e);if(Qf(i))return rp(i,e);if($f(i))return LM(i,e);if(tp(i))return kM(i,e)}throw Kf(i)}function gn(i,e){return e?NM(i,e):jn(i)}function lt(...i){let e=na(i);return gn(i,e)}function Ms(i,e){let t=At(i)?i:()=>i,n=r=>r.error(t());return new qt(e?r=>e.schedule(n,0,r):n)}function Ox(i){return!!i&&(i instanceof qt||At(i.lift)&&At(i.subscribe))}var to=rd(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function St(i,e){return Zt((t,n)=>{let r=0;t.subscribe(Ht(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:bN}=Array;function yN(i,e){return bN(e)?i(...e):i(e)}function sp(i){return St(e=>yN(i,e))}var{isArray:AN}=Array,{getPrototypeOf:_N,prototype:SN,keys:EN}=Object;function op(i){if(i.length===1){let e=i[0];if(AN(e))return{args:e,keys:null};if(CN(e)){let t=EN(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function CN(i){return i&&typeof i=="object"&&_N(i)===SN}function ap(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function il(...i){let e=na(i),t=qf(i),{args:n,keys:r}=op(i);if(n.length===0)return gn([],e);let s=new qt(MN(n,e,r?o=>ap(r,o):dr));return t?s.pipe(sp(t)):s}function MN(i,e,t=dr){return n=>{FM(e,()=>{let{length:r}=i,s=new Array(r),o=r,a=r;for(let l=0;l<r;l++)FM(e,()=>{let d=gn(i[l],e),c=!1;d.subscribe(Ht(n,u=>{s[l]=u,c||(c=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}function FM(i,e,t){i?Zi(t,i,e):e()}function OM(i,e,t,n,r,s,o,a){let l=[],d=0,c=0,u=!1,h=()=>{u&&!l.length&&!d&&e.complete()},f=x=>d<n?p(x):l.push(x),p=x=>{s&&e.next(x),d++;let v=!1;jn(t(x,c++)).subscribe(Ht(e,g=>{r?.(g),s?f(g):e.next(g)},()=>{v=!0},void 0,()=>{if(v)try{for(d--;l.length&&d<n;){let g=l.shift();o?Zi(e,o,()=>p(g)):p(g)}h()}catch(g){e.error(g)}}))};return i.subscribe(Ht(e,f,()=>{u=!0,h()})),()=>{a?.()}}function Gn(i,e,t=1/0){return At(e)?Gn((n,r)=>St((s,o)=>e(n,s,r,o))(jn(i(n,r))),t):(typeof e=="number"&&(t=e),Zt((n,r)=>OM(n,r,i,t)))}function ia(i=1/0){return Gn(dr,i)}function BM(){return ia(1)}function ud(...i){return BM()(gn(i,na(i)))}function lp(i){return new qt(e=>{jn(i()).subscribe(e)})}function Bx(...i){let e=qf(i),{args:t,keys:n}=op(i),r=new qt(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),l=o,d=o;for(let c=0;c<o;c++){let u=!1;jn(t[c]).subscribe(Ht(s,h=>{u||(u=!0,d--),a[c]=h},()=>l--,void 0,()=>{(!l||!u)&&(d||s.next(n?ap(n,a):a),s.complete())}))}});return e?r.pipe(sp(e)):r}function Yi(i,e){return Zt((t,n)=>{let r=0;t.subscribe(Ht(n,s=>i.call(e,s,r++)&&n.next(s)))})}function Er(i){return Zt((e,t)=>{let n=null,r=!1,s;n=e.subscribe(Ht(t,void 0,void 0,o=>{s=jn(i(o,Er(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function VM(i,e,t,n,r){return(s,o)=>{let a=t,l=e,d=0;s.subscribe(Ht(o,c=>{let u=d++;l=a?i(l,c,u):(a=!0,c),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function no(i,e){return At(e)?Gn(i,e,1):Gn(i,1)}function ra(i){return Zt((e,t)=>{let n=!1;e.subscribe(Ht(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function io(i){return i<=0?()=>cr:Zt((e,t)=>{let n=0;e.subscribe(Ht(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Vx(i){return St(()=>i)}function dp(i=TN){return Zt((e,t)=>{let n=!1;e.subscribe(Ht(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function TN(){return new to}function rl(i){return Zt((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function Ts(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Yi((r,s)=>i(r,s,n)):dr,io(1),t?ra(e):dp(()=>new to))}function hd(i){return i<=0?()=>cr:Zt((e,t)=>{let n=[];e.subscribe(Ht(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function Ux(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Yi((r,s)=>i(r,s,n)):dr,hd(1),t?ra(e):dp(()=>new to))}function Hx(i,e){return Zt(VM(i,e,arguments.length>=2,!0))}function zx(...i){let e=na(i);return Zt((t,n)=>{(e?ud(i,t,e):ud(i,t)).subscribe(n)})}function Xi(i,e){return Zt((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(Ht(n,l=>{r?.unsubscribe();let d=0,c=s++;jn(i(l,c)).subscribe(r=Ht(n,u=>n.next(e?e(l,u,c,d++):u),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function jx(i){return Zt((e,t)=>{jn(i).subscribe(Ht(t,()=>t.complete(),lu)),!t.closed&&e.subscribe(t)})}function oi(i,e,t){let n=At(i)||e||t?{next:i,error:e,complete:t}:i;return n?Zt((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(Ht(s,l=>{var d;(d=n.next)===null||d===void 0||d.call(n,l),s.next(l)},()=>{var l;a=!1,(l=n.complete)===null||l===void 0||l.call(n),s.complete()},l=>{var d;a=!1,(d=n.error)===null||d===void 0||d.call(n,l),s.error(l)},()=>{var l,d;a&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(d=n.finalize)===null||d===void 0||d.call(n)}))}):dr}var TT="https://g.co/ng/security#xss",qe=class extends Error{constructor(e,t){super(Yp(e,t)),this.code=e}};function Yp(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}function wu(i){return{toString:i}.toString()}var cp="__parameters__";function IN(i){return function(...t){if(i){let n=i(...t);for(let r in n)this[r]=n[r]}}}function IT(i,e,t){return wu(()=>{let n=IN(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(l,d,c){let u=l.hasOwnProperty(cp)?l[cp]:Object.defineProperty(l,cp,{value:[]})[cp];for(;u.length<=c;)u.push(null);return(u[c]=u[c]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}var uu=globalThis;function un(i){for(let e in i)if(i[e]===un)return e;throw Error("Could not find renamed property on target object.")}function DN(i,e){for(let t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function Oi(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(Oi).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function UM(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var PN=un({__forward_ref__:un});function rs(i){return i.__forward_ref__=rs,i.toString=function(){return Oi(this())},i}function Fi(i){return DT(i)?i():i}function DT(i){return typeof i=="function"&&i.hasOwnProperty(PN)&&i.__forward_ref__===rs}function Ee(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function mi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Xp(i){return HM(i,RT)||HM(i,LT)}function PT(i){return Xp(i)!==null}function HM(i,e){return i.hasOwnProperty(e)?i[e]:null}function RN(i){let e=i&&(i[RT]||i[LT]);return e||null}function zM(i){return i&&(i.hasOwnProperty(jM)||i.hasOwnProperty(LN))?i[jM]:null}var RT=un({\u0275prov:un}),jM=un({\u0275inj:un}),LT=un({ngInjectableDef:un}),LN=un({ngInjectorDef:un}),rt=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Ee({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function kT(i){return i&&!!i.\u0275providers}var kN=un({\u0275cmp:un}),NN=un({\u0275dir:un}),FN=un({\u0275pipe:un}),ON=un({\u0275mod:un}),Sp=un({\u0275fac:un}),cu=un({__NG_ELEMENT_ID__:un}),GM=un({__NG_ENV_ID__:un});function wd(i){return typeof i=="string"?i:i==null?"":String(i)}function BN(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():wd(i)}function VN(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new qe(-200,i)}function ab(i,e){throw new qe(-201,!1)}var Ft=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(Ft||{}),nw;function NT(){return nw}function Qi(i){let e=nw;return nw=i,e}function FT(i,e,t){let n=Xp(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&Ft.Optional)return null;if(e!==void 0)return e;ab(i,"Injector")}var UN={},hu=UN,iw="__NG_DI_FLAG__",Ep="ngTempTokenPath",HN="ngTokenPath",zN=/\n/gm,jN="\u0275",WM="__source",vd;function GN(){return vd}function sa(i){let e=vd;return vd=i,e}function WN(i,e=Ft.Default){if(vd===void 0)throw new qe(-203,!1);return vd===null?FT(i,void 0,e):vd.get(i,e&Ft.Optional?null:void 0,e)}function Te(i,e=Ft.Default){return(NT()||WN)(Fi(i),e)}function ve(i,e=Ft.Default){return Te(i,Qp(e))}function Qp(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function rw(i){let e=[];for(let t=0;t<i.length;t++){let n=Fi(i[t]);if(Array.isArray(n)){if(n.length===0)throw new qe(900,!1);let r,s=Ft.Default;for(let o=0;o<n.length;o++){let a=n[o],l=qN(a);typeof l=="number"?l===-1?r=a.token:s|=l:r=a}e.push(Te(r,s))}else e.push(Te(n))}return e}function OT(i,e){return i[iw]=e,i.prototype[iw]=e,i}function qN(i){return i[iw]}function ZN(i,e,t,n){let r=i[Ep];throw e[WM]&&r.unshift(e[WM]),i.message=YN(`
`+i.message,r,t,n),i[HN]=r,i[Ep]=null,i}function YN(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==jN?i.slice(2):i;let r=Oi(e);if(Array.isArray(e))r=e.map(Oi).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Oi(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(zN,`
  `)}`}var Kp=OT(IT("Optional"),8);var lb=OT(IT("SkipSelf"),4);function ol(i,e){let t=i.hasOwnProperty(Sp);return t?i[Sp]:null}function XN(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function QN(i){return i.flat(Number.POSITIVE_INFINITY)}function db(i,e){i.forEach(t=>Array.isArray(t)?db(t,e):e(t))}function BT(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Cp(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function KN(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function JN(i,e,t){let n=bu(i,e);return n>=0?i[n|1]=t:(n=~n,KN(i,n,e,t)),n}function Gx(i,e){let t=bu(i,e);if(t>=0)return i[t|1]}function bu(i,e){return $N(i,e,1)}function $N(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var bd={},Cr=[],yd=new rt(""),VT=new rt("",-1),UT=new rt(""),Mp=class{get(e,t=hu){if(t===hu){let n=new Error(`NullInjectorError: No provider for ${Oi(e)}!`);throw n.name="NullInjectorError",n}return t}},HT=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(HT||{}),Ps=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(Ps||{}),la=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(la||{});function eF(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function sw(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];tF(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function zT(i){return i===3||i===4||i===6}function tF(i){return i.charCodeAt(0)===64}function fu(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?qM(i,t,r,null,e[++n]):qM(i,t,r,null,null))}}return i}function qM(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var jT="ng-template";function nF(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&eF(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(cb(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function cb(i){return i.type===4&&i.value!==jT}function iF(i,e,t){let n=i.type===4&&!t?jT:i.value;return e===n}function rF(i,e,t){let n=4,r=i.attrs,s=r!==null?aF(r):0,o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!ts(n)&&!ts(l))return!1;if(o&&ts(l))continue;o=!1,n=l|n&1;continue}if(!o)if(n&4){if(n=2|n&1,l!==""&&!iF(i,l,t)||l===""&&e.length===1){if(ts(n))return!1;o=!0}}else if(n&8){if(r===null||!nF(i,r,l,t)){if(ts(n))return!1;o=!0}}else{let d=e[++a],c=sF(l,r,cb(i),t);if(c===-1){if(ts(n))return!1;o=!0;continue}if(d!==""){let u;if(c>s?u="":u=r[c+1].toLowerCase(),n&2&&d!==u){if(ts(n))return!1;o=!0}}}}return ts(n)||o}function ts(i){return(i&1)===0}function sF(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return lF(e,i)}function oF(i,e,t=!1){for(let n=0;n<e.length;n++)if(rF(i,e[n],t))return!0;return!1}function aF(i){for(let e=0;e<i.length;e++){let t=i[e];if(zT(t))return e}return i.length}function lF(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function ZM(i,e){return i?":not("+e.trim()+")":e}function dF(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!ts(o)&&(e+=ZM(s,r),r=""),n=o,s=s||!ts(n);t++}return r!==""&&(e+=ZM(s,r)),e}function cF(i){return i.map(dF).join(",")}function uF(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!ts(r))break;r=s}n++}return{attrs:e,classes:t}}function ft(i){return wu(()=>{let e=YT(i),t=We(ae({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===HT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||Ps.Emulated,styles:i.styles||Cr,_:null,schemas:i.schemas||null,tView:null,id:""});XT(t);let n=i.dependencies;return t.directiveDefs=XM(n,!1),t.pipeDefs=XM(n,!0),t.id=pF(t),t})}function hF(i){return da(i)||GT(i)}function fF(i){return i!==null}function gi(i){return wu(()=>({type:i.type,bootstrap:i.bootstrap||Cr,declarations:i.declarations||Cr,imports:i.imports||Cr,exports:i.exports||Cr,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function YM(i,e){if(i==null)return bd;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=la.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==la.None?[n,a]:n,e[s]=o):t[s]=n}return t}function hn(i){return wu(()=>{let e=YT(i);return XT(e),e})}function ub(i){return{type:i.type,name:i.name,factory:null,pure:i.pure!==!1,standalone:i.standalone===!0,onDestroy:i.type.prototype.ngOnDestroy||null}}function da(i){return i[kN]||null}function GT(i){return i[NN]||null}function WT(i){return i[FN]||null}function qT(i){let e=da(i)||GT(i)||WT(i);return e!==null?e.standalone:!1}function ZT(i,e){let t=i[ON]||null;if(!t&&e===!0)throw new Error(`Type ${Oi(i)} does not have '\u0275mod' property.`);return t}function YT(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||bd,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||Cr,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:YM(i.inputs,e),outputs:YM(i.outputs),debugInfo:null}}function XT(i){i.features?.forEach(e=>e(i))}function XM(i,e){if(!i)return null;let t=e?WT:hF;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter(fF)}function pF(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function yu(i){return{\u0275providers:i}}function mF(...i){return{\u0275providers:QT(!0,i),\u0275fromNgModule:!0}}function QT(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return db(e,o=>{let a=o;ow(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&KT(r,s),t}function KT(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];hb(r,s=>{e(s,n)})}}function ow(i,e,t,n){if(i=Fi(i),!i)return!1;let r=null,s=zM(i),o=!s&&da(i);if(!s&&!o){let l=i.ngModule;if(s=zM(l),s)r=l;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let d of l)ow(d,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let d;try{db(s.imports,c=>{ow(c,e,t,n)&&(d||=[],d.push(c))})}finally{}d!==void 0&&KT(d,e)}if(!a){let d=ol(r)||(()=>new r);e({provide:r,useFactory:d,deps:Cr},r),e({provide:UT,useValue:r,multi:!0},r),e({provide:yd,useValue:()=>Te(r),multi:!0},r)}let l=s.providers;if(l!=null&&!a){let d=i;hb(l,c=>{e(c,d)})}}else return!1;return r!==i&&i.providers!==void 0}function hb(i,e){for(let t of i)kT(t)&&(t=t.\u0275providers),Array.isArray(t)?hb(t,e):e(t)}var gF=un({provide:String,useValue:un});function JT(i){return i!==null&&typeof i=="object"&&gF in i}function vF(i){return!!(i&&i.useExisting)}function xF(i){return!!(i&&i.useFactory)}function Ad(i){return typeof i=="function"}function wF(i){return!!i.useClass}var Jp=new rt(""),vp={},bF={},Wx;function fb(){return Wx===void 0&&(Wx=new Mp),Wx}var Bi=class{},pu=class extends Bi{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,lw(e,o=>this.processProvider(o)),this.records.set(VT,fd(void 0,this)),r.has("environment")&&this.records.set(Bi,fd(void 0,this));let s=this.records.get(Jp);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(UT,Cr,Ft.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Qt(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Qt(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=sa(this),n=Qi(void 0),r;try{return e()}finally{sa(t),Qi(n)}}get(e,t=hu,n=Ft.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(GM))return e[GM](this);n=Qp(n);let r,s=sa(this),o=Qi(void 0);try{if(!(n&Ft.SkipSelf)){let l=this.records.get(e);if(l===void 0){let d=EF(e)&&Xp(e);d&&this.injectableDefInScope(d)?l=fd(aw(e),vp):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=n&Ft.Self?fb():this.parent;return t=n&Ft.Optional&&t===hu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Ep]=a[Ep]||[]).unshift(Oi(e)),s)throw a;return ZN(a,e,"R3InjectorError",this.source)}else throw a}finally{Qi(o),sa(s)}}resolveInjectorInitializers(){let e=Qt(null),t=sa(this),n=Qi(void 0),r;try{let s=this.get(yd,Cr,Ft.Self);for(let o of s)o()}finally{sa(t),Qi(n),Qt(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(Oi(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new qe(205,!1)}processProvider(e){e=Fi(e);let t=Ad(e)?e:Fi(e&&e.provide),n=AF(e);if(!Ad(e)&&e.multi===!0){let r=this.records.get(t);r||(r=fd(void 0,vp,!0),r.factory=()=>rw(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=Qt(null);try{return t.value===vp&&(t.value=bF,t.value=t.factory()),typeof t.value=="object"&&t.value&&SF(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Qt(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Fi(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function aw(i){let e=Xp(i),t=e!==null?e.factory:ol(i);if(t!==null)return t;if(i instanceof rt)throw new qe(204,!1);if(i instanceof Function)return yF(i);throw new qe(204,!1)}function yF(i){if(i.length>0)throw new qe(204,!1);let t=RN(i);return t!==null?()=>t.factory(i):()=>new i}function AF(i){if(JT(i))return fd(void 0,i.useValue);{let e=$T(i);return fd(e,vp)}}function $T(i,e,t){let n;if(Ad(i)){let r=Fi(i);return ol(r)||aw(r)}else if(JT(i))n=()=>Fi(i.useValue);else if(xF(i))n=()=>i.useFactory(...rw(i.deps||[]));else if(vF(i))n=()=>Te(Fi(i.useExisting));else{let r=Fi(i&&(i.useClass||i.provide));if(_F(i))n=()=>new r(...rw(i.deps));else return ol(r)||aw(r)}return n}function fd(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function _F(i){return!!i.deps}function SF(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function EF(i){return typeof i=="function"||typeof i=="object"&&i instanceof rt}function lw(i,e){for(let t of i)Array.isArray(t)?lw(t,e):t&&kT(t)?lw(t.\u0275providers,e):e(t)}function Dr(i,e){i instanceof pu&&i.assertNotDestroyed();let t,n=sa(i),r=Qi(void 0);try{return e()}finally{sa(n),Qi(r)}}function e2(){return NT()!==void 0||GN()!=null}function t2(i){if(!e2())throw new qe(-203,!1)}function CF(i){return typeof i=="function"}var lo=0,Tt=1,pt=2,Si=3,ns=4,ss=5,Tp=6,Ip=7,is=8,_d=9,Rs=10,Bn=11,mu=12,QM=13,Dd=14,Ls=15,al=16,pd=17,ro=18,$p=19,n2=20,oa=21,xp=22,Mr=23,Tr=25,i2=1;var ll=7,Dp=8,Sd=9,ur=10,Pp=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Pp||{});function aa(i){return Array.isArray(i)&&typeof i[i2]=="object"}function co(i){return Array.isArray(i)&&i[i2]===!0}function pb(i){return(i.flags&4)!==0}function em(i){return i.componentOffset>-1}function tm(i){return(i.flags&1)===1}function ca(i){return!!i.template}function dw(i){return(i[pt]&512)!==0}var cw=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function r2(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function Vi(){return s2}function s2(i){return i.type.prototype.ngOnChanges&&(i.setInput=TF),MF}Vi.ngInherit=!0;function MF(){let i=a2(this),e=i?.current;if(e){let t=i.previous;if(t===bd)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function TF(i,e,t,n,r){let s=this.declaredInputs[n],o=a2(i)||IF(i,{previous:bd,current:null}),a=o.current||(o.current={}),l=o.previous,d=l[s];a[s]=new cw(d&&d.currentValue,t,l===bd),r2(i,e,r,t)}var o2="__ngSimpleChanges__";function a2(i){return i[o2]||null}function IF(i,e){return i[o2]=e}var KM=null;var Is=function(i,e,t){KM?.(i,e,t)},l2="svg",DF="math";function ks(i){for(;Array.isArray(i);)i=i[lo];return i}function d2(i,e){return ks(e[i])}function Pr(i,e){return ks(e[i.index])}function c2(i,e){return i.data[e]}function u2(i,e){return i[e]}function ma(i,e){let t=e[i];return aa(t)?t:t[lo]}function PF(i){return(i[pt]&4)===4}function mb(i){return(i[pt]&128)===128}function RF(i){return co(i[Si])}function Ed(i,e){return e==null?null:i[e]}function h2(i){i[pd]=0}function f2(i){i[pt]&1024||(i[pt]|=1024,mb(i)&&im(i))}function LF(i,e){for(;i>0;)e=e[Dd],i--;return e}function nm(i){return!!(i[pt]&9216||i[Mr]?.dirty)}function uw(i){i[Rs].changeDetectionScheduler?.notify(8),i[pt]&64&&(i[pt]|=1024),nm(i)&&im(i)}function im(i){i[Rs].changeDetectionScheduler?.notify(0);let e=dl(i);for(;e!==null&&!(e[pt]&8192||(e[pt]|=8192,!mb(e)));)e=dl(e)}function p2(i,e){if((i[pt]&256)===256)throw new qe(911,!1);i[oa]===null&&(i[oa]=[]),i[oa].push(e)}function kF(i,e){if(i[oa]===null)return;let t=i[oa].indexOf(e);t!==-1&&i[oa].splice(t,1)}function dl(i){let e=i[Si];return co(e)?e[Si]:e}var Et={lFrame:S2(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var m2=!1;function NF(){return Et.lFrame.elementDepthCount}function FF(){Et.lFrame.elementDepthCount++}function OF(){Et.lFrame.elementDepthCount--}function g2(){return Et.bindingsEnabled}function BF(){return Et.skipHydrationRootTNode!==null}function VF(i){return Et.skipHydrationRootTNode===i}function UF(){Et.skipHydrationRootTNode=null}function Bt(){return Et.lFrame.lView}function Wn(){return Et.lFrame.tView}function $(i){return Et.lFrame.contextLView=i,i[is]}function ee(i){return Et.lFrame.contextLView=null,i}function vi(){let i=v2();for(;i!==null&&i.type===64;)i=i.parent;return i}function v2(){return Et.lFrame.currentTNode}function HF(){let i=Et.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function ml(i,e){let t=Et.lFrame;t.currentTNode=i,t.isParent=e}function gb(){return Et.lFrame.isParent}function x2(){Et.lFrame.isParent=!1}function zF(){return Et.lFrame.contextLView}function w2(){return m2}function JM(i){m2=i}function Au(){let i=Et.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function jF(){return Et.lFrame.bindingIndex}function GF(i){return Et.lFrame.bindingIndex=i}function rm(){return Et.lFrame.bindingIndex++}function b2(i){let e=Et.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function WF(){return Et.lFrame.inI18n}function qF(i,e){let t=Et.lFrame;t.bindingIndex=t.bindingRootIndex=i,hw(e)}function ZF(){return Et.lFrame.currentDirectiveIndex}function hw(i){Et.lFrame.currentDirectiveIndex=i}function YF(i){let e=Et.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function y2(){return Et.lFrame.currentQueryIndex}function vb(i){Et.lFrame.currentQueryIndex=i}function XF(i){let e=i[Tt];return e.type===2?e.declTNode:e.type===1?i[ss]:null}function A2(i,e,t){if(t&Ft.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&Ft.Host);)if(r=XF(s),r===null||(s=s[Dd],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=Et.lFrame=_2();return n.currentTNode=e,n.lView=i,!0}function xb(i){let e=_2(),t=i[Tt];Et.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function _2(){let i=Et.lFrame,e=i===null?null:i.child;return e===null?S2(i):e}function S2(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function E2(){let i=Et.lFrame;return Et.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var C2=E2;function wb(){let i=E2();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function QF(i){return(Et.lFrame.contextLView=LF(i,Et.lFrame.contextLView))[is]}function gl(){return Et.lFrame.selectedIndex}function cl(i){Et.lFrame.selectedIndex=i}function sm(){let i=Et.lFrame;return c2(i.tView,i.selectedIndex)}function ie(){Et.lFrame.currentNamespace=l2}function Je(){KF()}function KF(){Et.lFrame.currentNamespace=null}function JF(){return Et.lFrame.currentNamespace}var M2=!0;function om(){return M2}function am(i){M2=i}function $F(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=s2(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function lm(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:d,ngOnDestroy:c}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),l&&(i.viewHooks??=[]).push(-t,l),d&&((i.viewHooks??=[]).push(t,d),(i.viewCheckHooks??=[]).push(t,d)),c!=null&&(i.destroyHooks??=[]).push(t,c)}}function wp(i,e,t){T2(i,e,3,t)}function bp(i,e,t,n){(i[pt]&3)===t&&T2(i,e,t,n)}function qx(i,e){let t=i[pt];(t&3)===e&&(t&=16383,t+=1,i[pt]=t)}function T2(i,e,t,n){let r=n!==void 0?i[pd]&65535:0,s=n??-1,o=e.length-1,a=0;for(let l=r;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],n!=null&&a>=n)break}else e[l]<0&&(i[pd]+=65536),(a<s||s==-1)&&(eO(i,t,e,l),i[pd]=(i[pd]&4294901760)+l+2),l++}function $M(i,e){Is(4,i,e);let t=Qt(null);try{e.call(i)}finally{Qt(t),Is(5,i,e)}}function eO(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[pt]>>14<i[pd]>>16&&(i[pt]&3)===e&&(i[pt]+=16384,$M(a,s)):$M(a,s)}var xd=-1,ul=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function tO(i){return i instanceof ul}function nO(i){return(i.flags&8)!==0}function iO(i){return(i.flags&16)!==0}var Zx={},fw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Qp(n);let r=this.injector.get(e,Zx,n);return r!==Zx||t===Zx?r:this.parentInjector.get(e,t,n)}};function I2(i){return i!==xd}function Rp(i){return i&32767}function rO(i){return i>>16}function Lp(i,e){let t=rO(i),n=e;for(;t>0;)n=n[Dd],t--;return n}var pw=!0;function kp(i){let e=pw;return pw=i,e}var sO=256,D2=sO-1,P2=5,oO=0,Ds={};function aO(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(cu)&&(n=t[cu]),n==null&&(n=t[cu]=oO++);let r=n&D2,s=1<<r;e.data[i+(r>>P2)]|=s}function Np(i,e){let t=R2(i,e);if(t!==-1)return t;let n=e[Tt];n.firstCreatePass&&(i.injectorIndex=e.length,Yx(n.data,i),Yx(e,null),Yx(n.blueprint,null));let r=bb(i,e),s=i.injectorIndex;if(I2(r)){let o=Rp(r),a=Lp(r,e),l=a[Tt].data;for(let d=0;d<8;d++)e[s+d]=a[o+d]|l[o+d]}return e[s+8]=r,s}function Yx(i,e){i.push(0,0,0,0,0,0,0,0,e)}function R2(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function bb(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=O2(r),n===null)return xd;if(t++,r=r[Dd],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return xd}function mw(i,e,t){aO(i,e,t)}function lO(i,e){if(e==="class")return i.classes;if(e==="style")return i.styles;let t=i.attrs;if(t){let n=t.length,r=0;for(;r<n;){let s=t[r];if(zT(s))break;if(s===0)r=r+2;else if(typeof s=="number")for(r++;r<n&&typeof t[r]=="string";)r++;else{if(s===e)return t[r+1];r=r+2}}}return null}function L2(i,e,t){if(t&Ft.Optional||i!==void 0)return i;ab(e,"NodeInjector")}function k2(i,e,t,n){if(t&Ft.Optional&&n===void 0&&(n=null),!(t&(Ft.Self|Ft.Host))){let r=i[_d],s=Qi(void 0);try{return r?r.get(e,n,t&Ft.Optional):FT(e,n,t&Ft.Optional)}finally{Qi(s)}}return L2(n,e,t)}function N2(i,e,t,n=Ft.Default,r){if(i!==null){if(e[pt]&2048&&!(n&Ft.Self)){let o=hO(i,e,t,n,Ds);if(o!==Ds)return o}let s=F2(i,e,t,n,Ds);if(s!==Ds)return s}return k2(e,t,n,r)}function F2(i,e,t,n,r){let s=cO(t);if(typeof s=="function"){if(!A2(e,i,n))return n&Ft.Host?L2(r,t,n):k2(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&Ft.Optional))ab(t);else return o}finally{C2()}}else if(typeof s=="number"){let o=null,a=R2(i,e),l=xd,d=n&Ft.Host?e[Ls][ss]:null;for((a===-1||n&Ft.SkipSelf)&&(l=a===-1?bb(i,e):e[a+8],l===xd||!tT(n,!1)?a=-1:(o=e[Tt],a=Rp(l),e=Lp(l,e)));a!==-1;){let c=e[Tt];if(eT(s,a,c.data)){let u=dO(a,e,t,o,n,d);if(u!==Ds)return u}l=e[a+8],l!==xd&&tT(n,e[Tt].data[a+8]===d)&&eT(s,a,e)?(o=c,a=Rp(l),e=Lp(l,e)):a=-1}}return r}function dO(i,e,t,n,r,s){let o=e[Tt],a=o.data[i+8],l=n==null?em(a)&&pw:n!=o&&(a.type&3)!==0,d=r&Ft.Host&&s===a,c=yp(a,o,t,l,d);return c!==null?hl(e,o,c,a):Ds}function yp(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,l=i.directiveStart,d=i.directiveEnd,c=s>>20,u=n?a:a+c,h=r?a+c:d;for(let f=u;f<h;f++){let p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){let f=o[l];if(f&&ca(f)&&f.type===t)return l}return null}function hl(i,e,t,n){let r=i[t],s=e.data;if(tO(r)){let o=r;o.resolving&&VN(BN(s[t]));let a=kp(o.canSeeViewProviders);o.resolving=!0;let l,d=o.injectImpl?Qi(o.injectImpl):null,c=A2(i,n,Ft.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&$F(t,s[t],e)}finally{d!==null&&Qi(d),kp(a),o.resolving=!1,C2()}}return r}function cO(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(cu)?i[cu]:void 0;return typeof e=="number"?e>=0?e&D2:uO:e}function eT(i,e,t){let n=1<<i;return!!(t[e+(i>>P2)]&n)}function tT(i,e){return!(i&Ft.Self)&&!(i&Ft.Host&&e)}var sl=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return N2(this._tNode,this._lView,e,Qp(n),t)}};function uO(){return new sl(vi(),Bt())}function Rr(i){return wu(()=>{let e=i.prototype.constructor,t=e[Sp]||gw(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[Sp]||gw(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function gw(i){return DT(i)?()=>{let e=gw(Fi(i));return e&&e()}:ol(i)}function hO(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[pt]&2048&&!(o[pt]&512);){let a=F2(s,o,t,n|Ft.Self,Ds);if(a!==Ds)return a;let l=s.parent;if(!l){let d=o[n2];if(d){let c=d.get(t,Ds,n);if(c!==Ds)return c}l=O2(o),o=o[Dd]}s=l}return r}function O2(i){let e=i[Tt],t=e.type;return t===2?e.declTNode:t===1?i[ss]:null}function yb(i){return lO(vi(),i)}function nT(i,e=null,t=null,n){let r=B2(i,e,t,n);return r.resolveInjectorInitializers(),r}function B2(i,e=null,t=null,n,r=new Set){let s=[t||Cr,mF(i)];return n=n||(typeof i=="object"?void 0:Oi(i)),new pu(s,e||fb(),n||null,r)}var Ir=class i{static{this.THROW_IF_NOT_FOUND=hu}static{this.NULL=new Mp}static create(e,t){if(Array.isArray(e))return nT({name:""},t,e,"");{let n=e.name??"";return nT({name:n},e.parent,e.providers,n)}}static{this.\u0275prov=Ee({token:i,providedIn:"any",factory:()=>Te(VT)})}static{this.__NG_ELEMENT_ID__=-1}};var fO=new rt("");fO.__NG_ELEMENT_ID__=i=>{let e=vi();if(e===null)throw new qe(204,!1);if(e.type&2)return e.value;if(i&Ft.Optional)return null;throw new qe(204,!1)};var pO="ngOriginalError";function Xx(i){return i[pO]}var V2=!0,dm=(()=>{class i{static{this.__NG_ELEMENT_ID__=mO}static{this.__NG_ENV_ID__=t=>t}}return i})(),vw=class extends dm{constructor(e){super(),this._lView=e}onDestroy(e){return p2(this._lView,e),()=>kF(this._lView,e)}};function mO(){return new vw(Bt())}var uo=(()=>{class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new pi(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>new i})}}return i})();var xw=class extends si{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,e2()&&(this.destroyRef=ve(dm,{optional:!0})??void 0,this.pendingTasks=ve(uo,{optional:!0})??void 0)}emit(e){let t=Qt(null);try{super.next(e)}finally{Qt(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof zn&&e.add(a),a}wrapInTimeout(e){return t=>{let n=this.pendingTasks?.add();setTimeout(()=>{e(t),n!==void 0&&this.pendingTasks?.remove(n)})}}},En=xw;function Fp(...i){}function U2(i){let e,t;function n(){i=Fp;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{i(),n()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{i(),n()})),()=>n()}function iT(i){return queueMicrotask(()=>i()),()=>{i=Fp}}var Ab="isAngularZone",Op=Ab+"_ID",gO=0,rn=class i{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new En(!1),this.onMicrotaskEmpty=new En(!1),this.onStable=new En(!1),this.onError=new En(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=V2}=e;if(typeof Zone>"u")throw new qe(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,wO(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Ab)===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new qe(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new qe(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,vO,Fp,Fp);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},vO={};function _b(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function xO(i){if(i.isCheckStableRunning||i.callbackScheduled)return;i.callbackScheduled=!0;function e(){U2(()=>{i.callbackScheduled=!1,ww(i),i.isCheckStableRunning=!0,_b(i),i.isCheckStableRunning=!1})}i.scheduleInRootZone?Zone.root.run(()=>{e()}):i._outer.run(()=>{e()}),ww(i)}function wO(i){let e=()=>{xO(i)},t=gO++;i._inner=i._inner.fork({name:"angular",properties:{[Ab]:!0,[Op]:t,[Op+t]:!0},onInvokeTask:(n,r,s,o,a,l)=>{if(bO(l))return n.invokeTask(s,o,a,l);try{return rT(i),n.invokeTask(s,o,a,l)}finally{(i.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),sT(i)}},onInvoke:(n,r,s,o,a,l,d)=>{try{return rT(i),n.invoke(s,o,a,l,d)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!yO(l)&&e(),sT(i)}},onHasTask:(n,r,s,o)=>{n.hasTask(s,o),r===s&&(o.change=="microTask"?(i._hasPendingMicrotasks=o.microTask,ww(i),_b(i)):o.change=="macroTask"&&(i.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,s,o)=>(n.handleError(s,o),i.runOutsideAngular(()=>i.onError.emit(o)),!1)})}function ww(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function rT(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function sT(i){i._nesting--,_b(i)}var bw=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new En,this.onMicrotaskEmpty=new En,this.onStable=new En,this.onError=new En}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}};function bO(i){return H2(i,"__ignore_ng_zone__")}function yO(i){return H2(i,"__scheduler_tick__")}function H2(i,e){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[e]===!0}var Ns=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Xx(e);for(;t&&Xx(t);)t=Xx(t);return t||null}},AO=new rt("",{providedIn:"root",factory:()=>{let i=ve(rn),e=ve(Ns);return t=>i.runOutsideAngular(()=>e.handleError(t))}});function _O(){return Pd(vi(),Bt())}function Pd(i,e){return new xi(Pr(i,e))}var xi=(()=>{class i{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=_O}}return i})();function SO(i){return i instanceof xi?i.nativeElement:i}function EO(){return this._results[Symbol.iterator]()}var yw=class i{get changes(){return this._changes??=new En}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=EO)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=QN(e);(this._changesDetected=!XN(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function z2(i){return(i.flags&128)===128}var j2=new Map,CO=0;function MO(){return CO++}function TO(i){j2.set(i[$p],i)}function Aw(i){j2.delete(i[$p])}var oT="__ngContext__";function ua(i,e){aa(e)?(i[oT]=e[$p],TO(e)):i[oT]=e}function G2(i){return q2(i[mu])}function W2(i){return q2(i[ns])}function q2(i){for(;i!==null&&!co(i);)i=i[ns];return i}var _w;function Z2(i){_w=i}function IO(){if(_w!==void 0)return _w;if(typeof document<"u")return document;throw new qe(210,!1)}var Sb=new rt("",{providedIn:"root",factory:()=>DO}),DO="ng",Eb=new rt(""),os=new rt("",{providedIn:"platform",factory:()=>"unknown"});var cm=new rt("",{providedIn:"root",factory:()=>IO().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var PO="h",RO="b";var LO=()=>null;function Cb(i,e,t=!1){return LO(i,e,t)}var Y2=!1,kO=new rt("",{providedIn:"root",factory:()=>Y2});var up;function NO(){if(up===void 0&&(up=null,uu.trustedTypes))try{up=uu.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return up}function um(i){return NO()?.createHTML(i)||i}var hp;function FO(){if(hp===void 0&&(hp=null,uu.trustedTypes))try{hp=uu.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return hp}function aT(i){return FO()?.createScriptURL(i)||i}var so=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${TT})`}},Sw=class extends so{getTypeName(){return"HTML"}},Ew=class extends so{getTypeName(){return"Style"}},Cw=class extends so{getTypeName(){return"Script"}},Mw=class extends so{getTypeName(){return"URL"}},Tw=class extends so{getTypeName(){return"ResourceURL"}};function Fs(i){return i instanceof so?i.changingThisBreaksApplicationSecurity:i}function ga(i,e){let t=OO(i);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${TT})`)}return t===e}function OO(i){return i instanceof so&&i.getTypeName()||null}function X2(i){return new Sw(i)}function Q2(i){return new Ew(i)}function K2(i){return new Cw(i)}function J2(i){return new Mw(i)}function $2(i){return new Tw(i)}function BO(i){let e=new Dw(i);return VO()?new Iw(e):e}var Iw=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(um(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},Dw=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=um(e),t}};function VO(){try{return!!new window.DOMParser().parseFromString(um(""),"text/html")}catch{return!1}}var UO=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function hm(i){return i=String(i),i.match(UO)?i:"unsafe:"+i}function ho(i){let e={};for(let t of i.split(","))e[t]=!0;return e}function _u(...i){let e={};for(let t of i)for(let n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}var eI=ho("area,br,col,hr,img,wbr"),tI=ho("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),nI=ho("rp,rt"),HO=_u(nI,tI),zO=_u(tI,ho("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),jO=_u(nI,ho("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),lT=_u(eI,zO,jO,HO),iI=ho("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),GO=ho("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),WO=ho("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),qO=_u(iI,GO,WO),ZO=ho("script,style,template"),Pw=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0,r=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild){r.push(t),t=QO(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=XO(t);if(s){t=s;break}t=r.pop()}}return this.buf.join("")}startElement(e){let t=dT(e).toLowerCase();if(!lT.hasOwnProperty(t))return this.sanitizedSomething=!0,!ZO.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let n=e.attributes;for(let r=0;r<n.length;r++){let s=n.item(r),o=s.name,a=o.toLowerCase();if(!qO.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;iI[a]&&(l=hm(l)),this.buf.push(" ",o,'="',cT(l),'"')}return this.buf.push(">"),!0}endElement(e){let t=dT(e).toLowerCase();lT.hasOwnProperty(t)&&!eI.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(cT(e))}};function YO(i,e){return(i.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function XO(i){let e=i.nextSibling;if(e&&i!==e.previousSibling)throw rI(e);return e}function QO(i){let e=i.firstChild;if(e&&YO(i,e))throw rI(e);return e}function dT(i){let e=i.nodeName;return typeof e=="string"?e:"FORM"}function rI(i){return new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`)}var KO=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,JO=/([^\#-~ |!])/g;function cT(i){return i.replace(/&/g,"&amp;").replace(KO,function(e){let t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(JO,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var fp;function sI(i,e){let t=null;try{fp=fp||BO(i);let n=e?String(e):"";t=fp.getInertBodyElement(n);let r=5,s=n;do{if(r===0)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=fp.getInertBodyElement(n)}while(n!==s);let a=new Pw().sanitizeChildren(uT(t)||t);return um(a)}finally{if(t){let n=uT(t)||t;for(;n.firstChild;)n.firstChild.remove()}}}function uT(i){return"content"in i&&$O(i)?i.content:null}function $O(i){return i.nodeType===Node.ELEMENT_NODE&&i.nodeName==="TEMPLATE"}var Os=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(Os||{});function ai(i){let e=aI();return e?e.sanitize(Os.URL,i)||"":ga(i,"URL")?Fs(i):hm(wd(i))}function Mb(i){let e=aI();if(e)return aT(e.sanitize(Os.RESOURCE_URL,i)||"");if(ga(i,"ResourceURL"))return aT(Fs(i));throw new qe(904,!1)}function e4(i,e){return e==="src"&&(i==="embed"||i==="frame"||i==="iframe"||i==="media"||i==="script")||e==="href"&&(i==="base"||i==="link")?Mb:ai}function oI(i,e,t){return e4(e,t)(i)}function aI(){let i=Bt();return i&&i[Rs].sanitizer}var t4=/^>|^->|<!--|-->|--!>|<!-$/g,n4=/(<|>)/g,i4="\u200B$1\u200B";function r4(i){return i.replace(t4,e=>e.replace(n4,i4))}function lI(i){return i.ownerDocument}function dI(i){return i instanceof Function?i():i}function s4(i){return(i??ve(Ir)).get(os)==="browser"}var oo=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(oo||{}),o4;function Tb(i,e){return o4(i,e)}function md(i,e,t,n,r){if(n!=null){let s,o=!1;co(n)?s=n:aa(n)&&(o=!0,n=n[lo]);let a=ks(n);i===0&&t!==null?r==null?pI(e,t,a):Bp(e,t,a,r||null,!0):i===1&&t!==null?Bp(e,t,a,r||null,!0):i===2?A4(e,a,o):i===3&&e.destroyNode(a),s!=null&&S4(e,i,s,t,r)}}function a4(i,e){return i.createText(e)}function l4(i,e,t){i.setValue(e,t)}function d4(i,e){return i.createComment(r4(e))}function cI(i,e,t){return i.createElement(e,t)}function c4(i,e){uI(i,e),e[lo]=null,e[ss]=null}function u4(i,e,t,n,r,s){n[lo]=r,n[ss]=e,pm(i,n,t,1,r,s)}function uI(i,e){e[Rs].changeDetectionScheduler?.notify(9),pm(i,e,e[Bn],2,null,null)}function h4(i){let e=i[mu];if(!e)return Qx(i[Tt],i);for(;e;){let t=null;if(aa(e))t=e[mu];else{let n=e[ur];n&&(t=n)}if(!t){for(;e&&!e[ns]&&e!==i;)aa(e)&&Qx(e[Tt],e),e=e[Si];e===null&&(e=i),aa(e)&&Qx(e[Tt],e),t=e&&e[ns]}e=t}}function f4(i,e,t,n){let r=ur+n,s=t.length;n>0&&(t[r-1][ns]=e),n<s-ur?(e[ns]=t[r],BT(t,ur+n,e)):(t.push(e),e[ns]=null),e[Si]=t;let o=e[al];o!==null&&t!==o&&hI(o,e);let a=e[ro];a!==null&&a.insertView(i),uw(e),e[pt]|=128}function hI(i,e){let t=i[Sd],n=e[Si];if(aa(n))i[pt]|=Pp.HasTransplantedViews;else{let r=n[Si][Ls];e[Ls]!==r&&(i[pt]|=Pp.HasTransplantedViews)}t===null?i[Sd]=[e]:t.push(e)}function Ib(i,e){let t=i[Sd],n=t.indexOf(e);t.splice(n,1)}function Rw(i,e){if(i.length<=ur)return;let t=ur+e,n=i[t];if(n){let r=n[al];r!==null&&r!==i&&Ib(r,n),e>0&&(i[t-1][ns]=n[ns]);let s=Cp(i,ur+e);c4(n[Tt],n);let o=s[ro];o!==null&&o.detachView(s[Tt]),n[Si]=null,n[ns]=null,n[pt]&=-129}return n}function fI(i,e){if(!(e[pt]&256)){let t=e[Bn];t.destroyNode&&pm(i,e,t,3,null,null),h4(e)}}function Qx(i,e){if(e[pt]&256)return;let t=Qt(null);try{e[pt]&=-129,e[pt]|=256,e[Mr]&&Bf(e[Mr]),m4(i,e),p4(i,e),e[Tt].type===1&&e[Bn].destroy();let n=e[al];if(n!==null&&co(e[Si])){n!==e[Si]&&Ib(n,e);let r=e[ro];r!==null&&r.detachView(i)}Aw(e)}finally{Qt(t)}}function p4(i,e){let t=i.cleanup,n=e[Ip];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[Ip]=null);let r=e[oa];if(r!==null){e[oa]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function m4(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof ul)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],l=s[o+1];Is(4,a,l);try{l.call(a)}finally{Is(5,a,l)}}else{Is(4,r,s);try{s.call(r)}finally{Is(5,r,s)}}}}}function g4(i,e,t){return v4(i,e.parent,t)}function v4(i,e,t){let n=e;for(;n!==null&&n.type&168;)e=n,n=e.parent;if(n===null)return t[lo];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===Ps.None||s===Ps.Emulated)return null}return Pr(n,t)}}function Bp(i,e,t,n,r){i.insertBefore(e,t,n,r)}function pI(i,e,t){i.appendChild(e,t)}function hT(i,e,t,n,r){n!==null?Bp(i,e,t,n,r):pI(i,e,t)}function mI(i,e){return i.parentNode(e)}function x4(i,e){return i.nextSibling(e)}function w4(i,e,t){return y4(i,e,t)}function b4(i,e,t){return i.type&40?Pr(i,t):null}var y4=b4,fT;function fm(i,e,t,n){let r=g4(i,n,e),s=e[Bn],o=n.parent||e[ss],a=w4(o,n,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)hT(s,r,t[l],a,!1);else hT(s,r,t,a,!1);fT!==void 0&&fT(s,n,e,t,r)}function du(i,e){if(e!==null){let t=e.type;if(t&3)return Pr(e,i);if(t&4)return Lw(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return du(i,n);{let r=i[e.index];return co(r)?Lw(-1,r):ks(r)}}else{if(t&128)return du(i,e.next);if(t&32)return Tb(e,i)()||ks(i[e.index]);{let n=gI(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=dl(i[Ls]);return du(r,n)}else return du(i,e.next)}}}return null}function gI(i,e){if(e!==null){let n=i[Ls][ss],r=e.projection;return n.projection[r]}return null}function Lw(i,e){let t=ur+i+1;if(t<e.length){let n=e[t],r=n[Tt].firstChild;if(r!==null)return du(n,r)}return e[ll]}function A4(i,e,t){i.removeChild(null,e,t)}function Db(i,e,t,n,r,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=n[t.index],l=t.type;if(o&&e===0&&(a&&ua(ks(a),n),t.flags|=2),(t.flags&32)!==32)if(l&8)Db(i,e,t.child,n,r,s,!1),md(e,i,r,a,s);else if(l&32){let d=Tb(t,n),c;for(;c=d();)md(e,i,r,c,s);md(e,i,r,a,s)}else l&16?_4(i,e,n,t,r,s):md(e,i,r,a,s);t=o?t.projectionNext:t.next}}function pm(i,e,t,n,r,s){Db(t,n,i.firstChild,e,r,s,!1)}function _4(i,e,t,n,r,s){let o=t[Ls],l=o[ss].projection[n.projection];if(Array.isArray(l))for(let d=0;d<l.length;d++){let c=l[d];md(e,i,r,c,s)}else{let d=l,c=o[Si];z2(n)&&(d.flags|=128),Db(i,e,d,c,r,s,!0)}}function S4(i,e,t,n,r){let s=t[ll],o=ks(t);s!==o&&md(e,i,n,s,r);for(let a=ur;a<t.length;a++){let l=t[a];pm(l[Tt],l,i,e,n,s)}}function E4(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:oo.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=oo.Important),i.setStyle(t,n,r,s))}}function C4(i,e,t){i.setAttribute(e,"style",t)}function vI(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function xI(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&sw(i,e,n),r!==null&&vI(i,e,r),s!==null&&C4(i,e,s)}var as={};function C(i=1){wI(Wn(),Bt(),gl()+i,!1)}function wI(i,e,t,n){if(!n)if((e[pt]&3)===3){let s=i.preOrderCheckHooks;s!==null&&wp(e,s,t)}else{let s=i.preOrderHooks;s!==null&&bp(e,s,0,t)}cl(t)}function se(i,e=Ft.Default){let t=Bt();if(t===null)return Te(i,e);let n=vi();return N2(n,t,Fi(i),e)}function bI(){let i="invalid";throw new Error(i)}function yI(i,e,t,n,r,s){let o=Qt(null);try{let a=null;r&la.SignalBased&&(a=e[n][Cs]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&la.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):r2(e,a,n,s)}finally{Qt(o)}}function M4(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)cl(~r);else{let s=r,o=t[++n],a=t[++n];qF(o,s);let l=e[s];a(2,l)}}}finally{cl(-1)}}function mm(i,e,t,n,r,s,o,a,l,d,c){let u=e.blueprint.slice();return u[lo]=r,u[pt]=n|4|128|8|64,(d!==null||i&&i[pt]&2048)&&(u[pt]|=2048),h2(u),u[Si]=u[Dd]=i,u[is]=t,u[Rs]=o||i&&i[Rs],u[Bn]=a||i&&i[Bn],u[_d]=l||i&&i[_d]||null,u[ss]=s,u[$p]=MO(),u[Tp]=c,u[n2]=d,u[Ls]=e.type==2?i[Ls]:u,u}function Su(i,e,t,n,r){let s=i.data[e];if(s===null)s=T4(i,e,t,n,r),WF()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=HF();s.injectorIndex=o===null?-1:o.injectorIndex}return ml(s,!0),s}function T4(i,e,t,n,r){let s=v2(),o=gb(),a=o?s:s&&s.parent,l=i.data[e]=k4(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function AI(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function _I(i,e,t,n,r){let s=gl(),o=n&2;try{cl(-1),o&&e.length>Tr&&wI(i,e,Tr,!1),Is(o?2:0,r),t(n,r)}finally{cl(s),Is(o?3:1,r)}}function Pb(i,e,t){if(pb(e)){let n=Qt(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let l=t[o];a.contentQueries(1,l,o)}}}finally{Qt(n)}}}function Rb(i,e,t){g2()&&(U4(i,e,t,Pr(t,e)),(t.flags&64)===64&&CI(i,e,t))}function Lb(i,e,t=Pr){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function SI(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=kb(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function kb(i,e,t,n,r,s,o,a,l,d,c){let u=Tr+n,h=u+r,f=I4(u,h),p=typeof d=="function"?d():d;return f[Tt]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:c}}function I4(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:as);return t}function D4(i,e,t,n){let s=n.get(kO,Y2)||t===Ps.ShadowDom,o=i.selectRootElement(e,s);return P4(o),o}function P4(i){R4(i)}var R4=()=>null;function L4(i,e,t,n){let r=II(e);r.push(t),i.firstCreatePass&&DI(i).push(n,r.length-1)}function k4(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return BF()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function pT(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,l=la.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let d=s;if(r!==null){if(!r.hasOwnProperty(s))continue;d=r[s]}i===0?mT(n,t,d,a,l):mT(n,t,d,a)}return n}function mT(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function N4(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],l=null,d=null;for(let c=n;c<r;c++){let u=s[c],h=t?t.get(u):null,f=h?h.inputs:null,p=h?h.outputs:null;l=pT(0,u.inputs,c,l,f),d=pT(1,u.outputs,c,d,p);let x=l!==null&&o!==null&&!cb(e)?K4(l,c,o):null;a.push(x)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=d}function F4(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function Nb(i,e,t,n,r,s,o,a){let l=Pr(e,t),d=e.inputs,c;!a&&d!=null&&(c=d[n])?(Ob(i,t,c,n,r),em(e)&&O4(t,e.index)):e.type&3?(n=F4(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(l,n,r)):e.type&12}function O4(i,e){let t=ma(e,i);t[pt]&16||(t[pt]|=64)}function Fb(i,e,t,n){if(g2()){let r=n===null?null:{"":-1},s=z4(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&EI(i,e,t,o,r,a),r&&j4(t,n,r)}t.mergedAttrs=fu(t.mergedAttrs,t.attrs)}function EI(i,e,t,n,r,s){for(let d=0;d<n.length;d++)mw(Np(t,e),i,n[d].type);W4(t,i.data.length,n.length);for(let d=0;d<n.length;d++){let c=n[d];c.providersResolver&&c.providersResolver(c)}let o=!1,a=!1,l=AI(i,e,n.length,null);for(let d=0;d<n.length;d++){let c=n[d];t.mergedAttrs=fu(t.mergedAttrs,c.hostAttrs),q4(i,t,e,l,c),G4(l,c,r),c.contentQueries!==null&&(t.flags|=4),(c.hostBindings!==null||c.hostAttrs!==null||c.hostVars!==0)&&(t.flags|=64);let u=c.type.prototype;!o&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}N4(i,t,s)}function B4(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;V4(o)!=a&&o.push(a),o.push(t,n,s)}}function V4(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function U4(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;em(t)&&Z4(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||Np(t,e),ua(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let l=i.data[a],d=hl(e,i,a,t);if(ua(d,e),o!==null&&Q4(e,a-r,d,l,t,o),ca(l)){let c=ma(t.index,e);c[is]=hl(e,i,a,t)}}}function CI(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=ZF();try{cl(s);for(let a=n;a<r;a++){let l=i.data[a],d=e[a];hw(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&H4(l,d)}}finally{cl(-1),hw(o)}}function H4(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function z4(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(oF(e,o.selectors,!1))if(n||(n=[]),ca(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let l=a.length;kw(i,e,l)}else n.unshift(o),kw(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function kw(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function j4(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new qe(-301,!1);n.push(e[r],s)}}}function G4(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;ca(e)&&(t[""]=i)}}function W4(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function q4(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=ol(r.type,!0)),o=new ul(s,ca(r),se);i.blueprint[n]=o,t[n]=o,B4(i,e,n,AI(i,t,r.hostVars,as),r)}function Z4(i,e,t){let n=Pr(e,i),r=SI(t),s=i[Rs].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=gm(i,mm(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function Y4(i,e,t,n,r,s){let o=Pr(i,e);X4(e[Bn],o,s,i.value,t,n,r)}function X4(i,e,t,n,r,s,o){if(s==null)i.removeAttribute(e,r,t);else{let a=o==null?wd(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}function Q4(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],d=o[a++],c=o[a++],u=o[a++];yI(n,t,l,d,c,u)}}function K4(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function MI(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function TI(i,e){let t=i.contentQueries;if(t!==null){let n=Qt(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];vb(s),a.contentQueries(2,e[o],o)}}}finally{Qt(n)}}}function gm(i,e){return i[mu]?i[QM][ns]=e:i[mu]=e,i[QM]=e,e}function Nw(i,e,t){vb(0);let n=Qt(null);try{e(i,t)}finally{Qt(n)}}function II(i){return i[Ip]??=[]}function DI(i){return i.cleanup??=[]}function PI(i,e){let t=i[_d],n=t?t.get(Ns,null):null;n&&n.handleError(e)}function Ob(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],l=t[s++],d=e[o],c=i.data[o];yI(c,d,n,a,l,r)}}function RI(i,e,t){let n=d2(e,i);l4(i[Bn],n,t)}function J4(i,e){let t=ma(e,i),n=t[Tt];$4(n,t);let r=t[lo];r!==null&&t[Tp]===null&&(t[Tp]=Cb(r,t[_d])),Bb(n,t,t[is])}function $4(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function Bb(i,e,t){xb(e);try{let n=i.viewQuery;n!==null&&Nw(1,n,t);let r=i.template;r!==null&&_I(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[ro]?.finishViewCreation(i),i.staticContentQueries&&TI(i,e),i.staticViewQueries&&Nw(2,i.viewQuery,t);let s=i.components;s!==null&&e5(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[pt]&=-5,wb()}}function e5(i,e){for(let t=0;t<e.length;t++)J4(i,e[t])}function t5(i,e,t,n){let r=Qt(null);try{let s=e.tView,a=i[pt]&4096?4096:16,l=mm(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),d=i[e.index];l[al]=d;let c=i[ro];return c!==null&&(l[ro]=c.createEmbeddedView(s)),Bb(s,l,t),l}finally{Qt(r)}}function gT(i,e){return!e||e.firstChild===null||z2(i)}function n5(i,e,t,n=!0){let r=e[Tt];if(f4(r,e,i,t),n){let o=Lw(t,i),a=e[Bn],l=mI(a,i[ll]);l!==null&&u4(r,i[ss],a,e,l,o)}let s=e[Tp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Vp(i,e,t,n,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&n.push(ks(s)),co(s)&&i5(s,n);let o=t.type;if(o&8)Vp(i,e,t.child,n);else if(o&32){let a=Tb(t,e),l;for(;l=a();)n.push(l)}else if(o&16){let a=gI(e,t);if(Array.isArray(a))n.push(...a);else{let l=dl(e[Ls]);Vp(l[Tt],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function i5(i,e){for(let t=ur;t<i.length;t++){let n=i[t],r=n[Tt].firstChild;r!==null&&Vp(n[Tt],n,r,e)}i[ll]!==i[lo]&&e.push(i[ll])}var LI=[];function r5(i){return i[Mr]??s5(i)}function s5(i){let e=LI.pop()??Object.create(a5);return e.lView=i,e}function o5(i){i.lView[Mr]!==i&&(i.lView=null,LI.push(i))}var a5=We(ae({},id),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{im(i.lView)},consumerOnSignalRead(){this.lView[Mr]=this}});function l5(i){let e=i[Mr]??Object.create(d5);return e.lView=i,e}var d5=We(ae({},id),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{let e=dl(i.lView);for(;e&&!kI(e[Tt]);)e=dl(e);e&&f2(e)},consumerOnSignalRead(){this.lView[Mr]=this}});function kI(i){return i.type!==2}var c5=100;function NI(i,e=!0,t=0){let n=i[Rs],r=n.rendererFactory,s=!1;s||r.begin?.();try{u5(i,t)}catch(o){throw e&&PI(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function u5(i,e){let t=w2();try{JM(!0),Fw(i,e);let n=0;for(;nm(i);){if(n===c5)throw new qe(103,!1);n++,Fw(i,1)}}finally{JM(t)}}function h5(i,e,t,n){let r=e[pt];if((r&256)===256)return;let s=!1,o=!1;!s&&e[Rs].inlineEffectRunner?.flush(),xb(e);let a=!0,l=null,d=null;s||(kI(i)?(d=r5(e),l=ou(d)):eM()===null?(a=!1,d=l5(e),l=ou(d)):e[Mr]&&(Bf(e[Mr]),e[Mr]=null));try{h2(e),GF(i.bindingStartIndex),t!==null&&_I(i,e,t,2,n);let c=(r&3)===3;if(!s)if(c){let f=i.preOrderCheckHooks;f!==null&&wp(e,f,null)}else{let f=i.preOrderHooks;f!==null&&bp(e,f,0,null),qx(e,0)}if(o||f5(e),FI(e,0),i.contentQueries!==null&&TI(i,e),!s)if(c){let f=i.contentCheckHooks;f!==null&&wp(e,f)}else{let f=i.contentHooks;f!==null&&bp(e,f,1),qx(e,1)}M4(i,e);let u=i.components;u!==null&&BI(e,u,0);let h=i.viewQuery;if(h!==null&&Nw(2,h,n),!s)if(c){let f=i.viewCheckHooks;f!==null&&wp(e,f)}else{let f=i.viewHooks;f!==null&&bp(e,f,2),qx(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[xp]){for(let f of e[xp])f();e[xp]=null}s||(e[pt]&=-73)}catch(c){throw s||im(e),c}finally{d!==null&&(Ff(d,l),a&&o5(d)),wb()}}function FI(i,e){for(let t=G2(i);t!==null;t=W2(t))for(let n=ur;n<t.length;n++){let r=t[n];OI(r,e)}}function f5(i){for(let e=G2(i);e!==null;e=W2(e)){if(!(e[pt]&Pp.HasTransplantedViews))continue;let t=e[Sd];for(let n=0;n<t.length;n++){let r=t[n];f2(r)}}}function p5(i,e,t){let n=ma(e,i);OI(n,t)}function OI(i,e){mb(i)&&Fw(i,e)}function Fw(i,e){let n=i[Tt],r=i[pt],s=i[Mr],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&Of(s)),o||=!1,s&&(s.dirty=!1),i[pt]&=-9217,o)h5(n,i,n.template,i[is]);else if(r&8192){FI(i,1);let a=n.components;a!==null&&BI(i,a,1)}}function BI(i,e,t){for(let n=0;n<e.length;n++)p5(i,e[n],t)}function Vb(i,e){let t=w2()?64:1088;for(i[Rs].changeDetectionScheduler?.notify(e);i;){i[pt]|=t;let n=dl(i);if(dw(i)&&!n)return i;i=n}return null}var fl=class{get rootNodes(){let e=this._lView,t=e[Tt];return Vp(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[is]}set context(e){this._lView[is]=e}get destroyed(){return(this._lView[pt]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Si];if(co(e)){let t=e[Dp],n=t?t.indexOf(this):-1;n>-1&&(Rw(e,n),Cp(t,n))}this._attachedToViewContainer=!1}fI(this._lView[Tt],this._lView)}onDestroy(e){p2(this._lView,e)}markForCheck(){Vb(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[pt]&=-129}reattach(){uw(this._lView),this._lView[pt]|=128}detectChanges(){this._lView[pt]|=1024,NI(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new qe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=dw(this._lView),t=this._lView[al];t!==null&&!e&&Ib(t,this._lView),uI(this._lView[Tt],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new qe(902,!1);this._appRef=e;let t=dw(this._lView),n=this._lView[al];n!==null&&!t&&hI(n,this._lView),uw(this._lView)}},ha=(()=>{class i{static{this.__NG_ELEMENT_ID__=v5}}return i})(),m5=ha,g5=class extends m5{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=t5(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new fl(r)}};function v5(){return vm(vi(),Bt())}function vm(i,e){return i.type&4?new g5(e,i,Pd(i,e)):null}var wle=new RegExp(`^(\\d+)*(${RO}|${PO})*(.*)`);var x5=()=>null;function vT(i,e){return x5(i,e)}var Cd=class{},Ub=new rt("",{providedIn:"root",factory:()=>!1});var VI=new rt(""),UI=new rt(""),Ow=class{},Up=class{};function w5(i){let e=Error(`No component factory found for ${Oi(i)}.`);return e[b5]=i,e}var b5="ngComponent";var Bw=class{resolveComponentFactory(e){throw w5(e)}},Md=class{static{this.NULL=new Bw}},fa=class{},Ei=(()=>{class i{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>y5()}}return i})();function y5(){let i=Bt(),e=vi(),t=ma(e.index,i);return(aa(t)?t:i)[Bn]}var A5=(()=>{class i{static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>null})}}return i})();function Hp(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=UM(r,a);else if(s==2){let l=a,d=e[++o];n=UM(n,l+": "+d+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var zp=class extends Md{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=da(e);return new Td(t,this.ngModule)}};function xT(i,e){let t=[];for(let n in i){if(!i.hasOwnProperty(n))continue;let r=i[n];if(r===void 0)continue;let s=Array.isArray(r),o=s?r[0]:r,a=s?r[1]:la.None;e?t.push({propName:o,templateName:n,isSignal:(a&la.SignalBased)!==0}):t.push({propName:o,templateName:n})}return t}function _5(i){let e=i.toLowerCase();return e==="svg"?l2:e==="math"?DF:null}var Td=class extends Up{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=xT(e.inputs,!0);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return xT(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=cF(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=Qt(null);try{r=r||this.ngModule;let o=r instanceof Bi?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new fw(e,o):e,l=a.get(fa,null);if(l===null)throw new qe(407,!1);let d=a.get(A5,null),c=a.get(Cd,null),u={rendererFactory:l,sanitizer:d,inlineEffectRunner:null,changeDetectionScheduler:c},h=l.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=n?D4(h,n,this.componentDef.encapsulation,a):cI(h,f,_5(f)),x=512;this.componentDef.signals?x|=4096:this.componentDef.onPush||(x|=16);let v=null;p!==null&&(v=Cb(p,a,!0));let g=kb(0,null,null,1,0,null,null,null,null,null,null),y=mm(null,g,null,x,null,null,u,h,a,null,v);xb(y);let b,A,M=null;try{let T=this.componentDef,I,L=null;T.findHostDirectiveDefs?(I=[],L=new Map,T.findHostDirectiveDefs(T,I,L),I.push(T)):I=[T];let E=S5(y,p);M=E5(E,p,T,I,y,u,h),A=c2(g,Tr),p&&T5(h,T,p,n),t!==void 0&&I5(A,this.ngContentSelectors,t),b=M5(M,T,I,L,y,[D5]),Bb(g,y,null)}catch(T){throw M!==null&&Aw(M),Aw(y),T}finally{wb()}return new Vw(this.componentType,b,Pd(A,y),y,A)}finally{Qt(s)}}},Vw=class extends Ow{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new fl(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Ob(s[Tt],s,r,e,t),this.previousInputValues.set(e,t);let o=ma(this._tNode.index,s);Vb(o,1)}}get injector(){return new sl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function S5(i,e){let t=i[Tt],n=Tr;return i[n]=e,Su(t,n,2,"#host",null)}function E5(i,e,t,n,r,s,o){let a=r[Tt];C5(n,i,e,o);let l=null;e!==null&&(l=Cb(e,r[_d]));let d=s.rendererFactory.createRenderer(e,t),c=16;t.signals?c=4096:t.onPush&&(c=64);let u=mm(r,SI(t),null,c,r[i.index],i,s,d,null,null,l);return a.firstCreatePass&&kw(a,i,n.length-1),gm(r,u),r[i.index]=u}function C5(i,e,t,n){for(let r of i)e.mergedAttrs=fu(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(Hp(e,e.mergedAttrs,!0),t!==null&&xI(n,t,e))}function M5(i,e,t,n,r,s){let o=vi(),a=r[Tt],l=Pr(o,r);EI(a,r,o,t,null,n);for(let c=0;c<t.length;c++){let u=o.directiveStart+c,h=hl(r,a,u,o);ua(h,r)}CI(a,r,o),l&&ua(l,r);let d=hl(r,a,o.directiveStart+o.componentOffset,o);if(i[is]=r[is]=d,s!==null)for(let c of s)c(d,e);return Pb(a,o,r),d}function T5(i,e,t,n){if(n)sw(i,t,["ng-version","18.2.13"]);else{let{attrs:r,classes:s}=uF(e.selectors[0]);r&&sw(i,t,r),s&&s.length>0&&vI(i,t,s.join(" "))}}function I5(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function D5(){let i=vi();lm(Bt()[Tt],i)}var va=(()=>{class i{static{this.__NG_ELEMENT_ID__=P5}}return i})();function P5(){let i=vi();return zI(i,Bt())}var R5=va,HI=class extends R5{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Pd(this._hostTNode,this._hostLView)}get injector(){return new sl(this._hostTNode,this._hostLView)}get parentInjector(){let e=bb(this._hostTNode,this._hostLView);if(I2(e)){let t=Lp(e,this._hostLView),n=Rp(e),r=t[Tt].data[n+8];return new sl(r,t)}else return new sl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=wT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ur}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=vT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,gT(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!CF(e),a;if(o)a=t;else{let p=t||{};a=p.index,n=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=o?e:new Td(da(e)),d=n||this.parentInjector;if(!s&&l.ngModule==null){let x=(o?d:this.parentInjector).get(Bi,null);x&&(s=x)}let c=da(l.componentType??{}),u=vT(this._lContainer,c?.id??null),h=u?.firstChild??null,f=l.create(d,r,h,s);return this.insertImpl(f.hostView,a,gT(this._hostTNode,u)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(RF(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Si],d=new HI(l,l[ss],l[Si]);d.detach(d.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return n5(o,r,s,n),e.attachToViewContainerRef(),BT(Kx(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=wT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=Rw(this._lContainer,t);n&&(Cp(Kx(this._lContainer),t),fI(n[Tt],n))}detach(e){let t=this._adjustIndex(e,-1),n=Rw(this._lContainer,t);return n&&Cp(Kx(this._lContainer),t)!=null?new fl(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function wT(i){return i[Dp]}function Kx(i){return i[Dp]||(i[Dp]=[])}function zI(i,e){let t,n=e[i.index];return co(n)?t=n:(t=MI(n,e,null,i),e[i.index]=t,gm(e,t)),k5(t,e,i,n),new HI(t,i,e)}function L5(i,e){let t=i[Bn],n=t.createComment(""),r=Pr(e,i),s=mI(t,r);return Bp(t,s,n,x4(t,r),!1),n}var k5=O5,N5=()=>!1;function F5(i,e,t){return N5(i,e,t)}function O5(i,e,t,n){if(i[ll])return;let r;t.type&8?r=ks(n):r=L5(e,t),i[ll]=r}var Uw=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},Hw=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Hb(e,t).matches!==null&&this.queries[t].setDirty()}},jp=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=W5(e):this.predicate=e}},zw=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},jw=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,B5(t,s)),this.matchTNodeWithReadOption(e,t,yp(t,e,s,!1,!1))}else n===ha?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,yp(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===xi||r===va||r===ha&&t.type&4)this.addMatch(t.index,-2);else{let s=yp(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function B5(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function V5(i,e){return i.type&11?Pd(i,e):i.type&4?vm(i,e):null}function U5(i,e,t,n){return t===-1?V5(e,i):t===-2?H5(i,e,n):hl(i,i[Tt],t,e)}function H5(i,e,t){if(t===xi)return Pd(e,i);if(t===ha)return vm(e,i);if(t===va)return zI(e,i)}function jI(i,e,t,n){let r=e[ro].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let l=0;o!==null&&l<o.length;l+=2){let d=o[l];if(d<0)a.push(null);else{let c=s[d];a.push(U5(e,c,o[l+1],t.metadata.read))}}r.matches=a}return r.matches}function Gw(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=jI(i,e,r,t);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)n.push(o[a/2]);else{let d=s[a+1],c=e[-l];for(let u=ur;u<c.length;u++){let h=c[u];h[al]===h[Si]&&Gw(h[Tt],h,d,n)}if(c[Sd]!==null){let u=c[Sd];for(let h=0;h<u.length;h++){let f=u[h];Gw(f[Tt],f,d,n)}}}}}return n}function z5(i,e){return i[ro].queries[e].queryList}function GI(i,e,t){let n=new yw((t&4)===4);return L4(i,e,n,n.destroy),(e[ro]??=new Hw).queries.push(new Uw(n))-1}function j5(i,e,t){let n=Wn();return n.firstCreatePass&&(WI(n,new jp(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),GI(n,Bt(),e)}function G5(i,e,t,n){let r=Wn();if(r.firstCreatePass){let s=vi();WI(r,new jp(e,t,n),s.index),q5(r,i),(t&2)===2&&(r.staticContentQueries=!0)}return GI(r,Bt(),t)}function W5(i){return i.split(",").map(e=>e.trim())}function WI(i,e,t){i.queries===null&&(i.queries=new zw),i.queries.track(new jw(e,t))}function q5(i,e){let t=i.contentQueries||(i.contentQueries=[]),n=t.length?t[t.length-1]:-1;e!==n&&t.push(i.queries.length-1,e)}function Hb(i,e){return i.queries.getByIndex(e)}function Z5(i,e){let t=i[Tt],n=Hb(t,e);return n.crossesNgTemplate?Gw(t,i,e,[]):jI(t,i,n,e)}var bT=new Set;function vl(i){bT.has(i)||(bT.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function Y5(i){return typeof i=="function"&&i[Cs]!==void 0}function xl(i,e){vl("NgSignals");let t=hM(i),n=t[Cs];return e?.equal&&(n.equal=e.equal),t.set=r=>Mx(n,r),t.update=r=>fM(n,r),t.asReadonly=X5.bind(t),t}function X5(){let i=this[Cs];if(i.readonlyFn===void 0){let e=()=>this();e[Cs]=i,i.readonlyFn=e}return i.readonlyFn}function qI(i){return Y5(i)&&typeof i.set=="function"}function Q5(i){return Object.getPrototypeOf(i.prototype).constructor}function Ui(i){let e=Q5(i.type),t=!0,n=[i];for(;e;){let r;if(ca(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new qe(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);let o=i;o.inputs=pp(i.inputs),o.inputTransforms=pp(i.inputTransforms),o.declaredInputs=pp(i.declaredInputs),o.outputs=pp(i.outputs);let a=r.hostBindings;a&&tB(i,a);let l=r.viewQuery,d=r.contentQueries;if(l&&$5(i,l),d&&eB(i,d),K5(i,r),DN(i.outputs,r.outputs),ca(r)&&r.data.animation){let c=i.data;c.animation=(c.animation||[]).concat(r.data.animation)}}let s=r.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(i),a===Ui&&(t=!1)}}e=Object.getPrototypeOf(e)}J5(n)}function K5(i,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||i.inputs.hasOwnProperty(t))continue;let n=e.inputs[t];if(n!==void 0&&(i.inputs[t]=n,i.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let r=Array.isArray(n)?n[0]:n;if(!e.inputTransforms.hasOwnProperty(r))continue;i.inputTransforms??={},i.inputTransforms[r]=e.inputTransforms[r]}}}function J5(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){let r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=fu(r.hostAttrs,t=fu(t,r.hostAttrs))}}function pp(i){return i===bd?{}:i===Cr?[]:i}function $5(i,e){let t=i.viewQuery;t?i.viewQuery=(n,r)=>{e(n,r),t(n,r)}:i.viewQuery=e}function eB(i,e){let t=i.contentQueries;t?i.contentQueries=(n,r,s)=>{e(n,r,s),t(n,r,s)}:i.contentQueries=e}function tB(i,e){let t=i.hostBindings;t?i.hostBindings=(n,r)=>{e(n,r),t(n,r)}:i.hostBindings=e}function zb(i){let e=i.inputConfig,t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];Array.isArray(r)&&r[3]&&(t[n]=r[3])}i.inputTransforms=t}var pa=class{},gu=class{};var Ww=class extends pa{constructor(e,t,n,r=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new zp(this);let s=ZT(e);this._bootstrapComponents=dI(s.bootstrap),this._r3Injector=B2(e,t,[{provide:pa,useValue:this},{provide:Md,useValue:this.componentFactoryResolver},...n],Oi(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},qw=class extends gu{constructor(e){super(),this.moduleType=e}create(e){return new Ww(this.moduleType,e,[])}};var Gp=class extends pa{constructor(e){super(),this.componentFactoryResolver=new zp(this),this.instance=null;let t=new pu([...e.providers,{provide:pa,useValue:this},{provide:Md,useValue:this.componentFactoryResolver}],e.parent||fb(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function xm(i,e,t=null){return new Gp({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function ZI(i){return iB(i)?Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i:!1}function nB(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{let t=i[Symbol.iterator](),n;for(;!(n=t.next()).done;)e(n.value)}}function iB(i){return i!==null&&(typeof i=="function"||typeof i=="object")}function Eu(i,e,t){return i[e]=t}function rB(i,e){return i[e]}function ao(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function vu(i,e,t,n){let r=ao(i,e,t);return ao(i,e+1,n)||r}function sB(i,e,t,n,r){let s=vu(i,e,t,n);return ao(i,e+2,r)||s}function oB(i,e,t,n,r,s){let o=vu(i,e,t,n);return vu(i,e+2,r,s)||o}function aB(i){return(i.flags&32)===32}function lB(i,e,t,n,r,s,o,a,l){let d=e.consts,c=Su(e,i,4,o||null,a||null);Fb(e,t,c,Ed(d,l)),lm(e,c);let u=c.tView=kb(2,c,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,d,null);return e.queries!==null&&(e.queries.template(e,c),u.queries=e.queries.embeddedTView(c)),c}function dB(i,e,t,n,r,s,o,a,l,d){let c=t+Tr,u=e.firstCreatePass?lB(c,e,i,n,r,s,o,a,l):e.data[c];ml(u,!1);let h=cB(e,i,u,t);om()&&fm(e,i,h,u),ua(h,i);let f=MI(h,i,h,u);return i[c]=f,gm(i,f),F5(f,u,i),tm(u)&&Rb(e,i,u),l!=null&&Lb(i,u,d),u}function G(i,e,t,n,r,s,o,a){let l=Bt(),d=Wn(),c=Ed(d.consts,s);return dB(l,d,i,e,t,n,r,c,o,a),G}var cB=uB;function uB(i,e,t,n){return am(!0),e[Bn].createComment("")}var gd=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(gd||{}),YI=(()=>{class i{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>new i})}}return i})(),Zw=class i{constructor(){this.ngZone=ve(rn),this.scheduler=ve(Cd),this.errorHandler=ve(Ns,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[gd.EarlyRead,gd.Write,gd.MixedReadWrite,gd.Read]}execute(){this.executing=!0;for(let e of i.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(n){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(n)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>new i})}},Yw=class{constructor(e,t,n,r){this.impl=e,this.hooks=t,this.once=n,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function jb(i,e){!e?.injector&&t2(jb);let t=e?.injector??ve(Ir);return s4(t)?(vl("NgAfterNextRender"),fB(i,t,e,!0)):pB}function hB(i,e){if(i instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=i,t}else return[i.earlyRead,i.write,i.mixedReadWrite,i.read]}function fB(i,e,t,n){let r=e.get(YI);r.impl??=e.get(Zw);let s=t?.phase??gd.MixedReadWrite,o=t?.manualCleanup!==!0?e.get(dm):null,a=new Yw(r.impl,hB(i,s),n,o);return r.impl.register(a),a}var pB={destroy(){}};function Rd(i,e,t,n){let r=Bt(),s=rm();if(ao(r,s,e)){let o=Wn(),a=sm();Y4(a,r,i,e,t,n)}return Rd}function XI(i,e,t,n){return ao(i,rm(),t)?e+wd(t)+n:as}function mB(i,e,t,n,r,s){let o=jF(),a=vu(i,o,t,r);return b2(2),a?e+wd(t)+n+wd(r)+s:as}function mp(i,e){return i<<17|e<<2}function pl(i){return i>>17&32767}function gB(i){return(i&2)==2}function vB(i,e){return i&131071|e<<17}function Xw(i){return i|2}function Id(i){return(i&131068)>>2}function Jx(i,e){return i&-131069|e<<2}function xB(i){return(i&1)===1}function Qw(i){return i|1}function wB(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=pl(o),l=Id(o);i[n]=t;let d=!1,c;if(Array.isArray(t)){let u=t;c=u[1],(c===null||bu(u,c)>0)&&(d=!0)}else c=t;if(r)if(l!==0){let h=pl(i[a+1]);i[n+1]=mp(h,a),h!==0&&(i[h+1]=Jx(i[h+1],n)),i[a+1]=vB(i[a+1],n)}else i[n+1]=mp(a,0),a!==0&&(i[a+1]=Jx(i[a+1],n)),a=n;else i[n+1]=mp(l,0),a===0?a=n:i[l+1]=Jx(i[l+1],n),l=n;d&&(i[n+1]=Xw(i[n+1])),yT(i,c,n,!0),yT(i,c,n,!1),bB(e,c,i,n,s),o=mp(a,l),s?e.classBindings=o:e.styleBindings=o}function bB(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&bu(s,e)>=0&&(t[n+1]=Qw(t[n+1]))}function yT(i,e,t,n){let r=i[t+1],s=e===null,o=n?pl(r):Id(r),a=!1;for(;o!==0&&(a===!1||s);){let l=i[o],d=i[o+1];yB(l,e)&&(a=!0,i[o+1]=n?Qw(d):Xw(d)),o=n?pl(d):Id(d)}a&&(i[t+1]=n?Xw(r):Qw(r))}function yB(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?bu(i,e)>=0:!1}function k(i,e,t){let n=Bt(),r=rm();if(ao(n,r,e)){let s=Wn(),o=sm();Nb(s,o,n,i,e,n[Bn],t,!1)}return k}function AT(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";Ob(i,t,s[o],o,n)}function Cu(i,e){return AB(i,e,null,!0),Cu}function AB(i,e,t,n){let r=Bt(),s=Wn(),o=b2(2);if(s.firstUpdatePass&&SB(s,i,o,n),e!==as&&ao(r,o,e)){let a=s.data[gl()];IB(s,a,r,r[Bn],i,r[o+1]=DB(e,t),n,o)}}function _B(i,e){return e>=i.expandoStartIndex}function SB(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[gl()],o=_B(i,t);PB(s,n)&&e===null&&!o&&(e=!1),e=EB(r,s,e,n),wB(r,s,e,t,o,n)}}function EB(i,e,t,n){let r=YF(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=$x(null,i,e,t,n),t=xu(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=$x(r,i,e,t,n),s===null){let l=CB(i,e,n);l!==void 0&&Array.isArray(l)&&(l=$x(null,i,e,l[1],n),l=xu(l,e.attrs,n),MB(i,e,n,l))}else s=TB(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function CB(i,e,t){let n=t?e.classBindings:e.styleBindings;if(Id(n)!==0)return i[pl(n)]}function MB(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[pl(r)]=n}function TB(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=xu(n,o,t)}return xu(n,e.attrs,t)}function $x(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=xu(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function xu(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),JN(i,o,t?!0:e[++s]))}return i===void 0?null:i}function IB(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let l=i.data,d=l[a+1],c=xB(d)?_T(l,e,t,r,Id(d),o):void 0;if(!Wp(c)){Wp(s)||gB(d)&&(s=_T(l,null,t,r,a,o));let u=d2(gl(),t);E4(n,o,u,r,s)}}function _T(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let l=i[r],d=Array.isArray(l),c=d?l[1]:l,u=c===null,h=t[r+1];h===as&&(h=u?Cr:void 0);let f=u?Gx(h,n):c===n?h:void 0;if(d&&!Wp(f)&&(f=Gx(l,n)),Wp(f)&&(a=f,o))return a;let p=i[r+1];r=o?pl(p):Id(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=Gx(l,n))}return a}function Wp(i){return i!==void 0}function DB(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=Oi(Fs(i)))),i}function PB(i,e){return(i.flags&(e?8:16))!==0}function RB(i,e,t,n,r,s){let o=e.consts,a=Ed(o,r),l=Su(e,i,2,n,a);return Fb(e,t,l,Ed(o,s)),l.attrs!==null&&Hp(l,l.attrs,!1),l.mergedAttrs!==null&&Hp(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function m(i,e,t,n){let r=Bt(),s=Wn(),o=Tr+i,a=r[Bn],l=s.firstCreatePass?RB(o,s,r,e,t,n):s.data[o],d=LB(s,r,l,a,e,i);r[o]=d;let c=tm(l);return ml(l,!0),xI(a,d,l),!aB(l)&&om()&&fm(s,r,d,l),NF()===0&&ua(d,r),FF(),c&&(Rb(s,r,l),Pb(s,l,r)),n!==null&&Lb(r,l),m}function w(){let i=vi();gb()?x2():(i=i.parent,ml(i,!1));let e=i;VF(e)&&UF(),OF();let t=Wn();return t.firstCreatePass&&(lm(t,i),pb(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&nO(e)&&AT(t,e,Bt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&iO(e)&&AT(t,e,Bt(),e.stylesWithoutHost,!1),w}function F(i,e,t,n){return m(i,e,t,n),w(),F}var LB=(i,e,t,n,r,s)=>(am(!0),cI(n,r,JF()));function kB(i,e,t,n,r){let s=e.consts,o=Ed(s,n),a=Su(e,i,8,"ng-container",o);o!==null&&Hp(a,o,!0);let l=Ed(s,r);return Fb(e,t,a,l),e.queries!==null&&e.queries.elementStart(e,a),a}function Gb(i,e,t){let n=Bt(),r=Wn(),s=i+Tr,o=r.firstCreatePass?kB(s,r,n,e,t):r.data[s];ml(o,!0);let a=NB(r,n,o,i);return n[s]=a,om()&&fm(r,n,a,o),ua(a,n),tm(o)&&(Rb(r,n,o),Pb(r,o,n)),t!=null&&Lb(n,o),Gb}function Wb(){let i=vi(),e=Wn();return gb()?x2():(i=i.parent,ml(i,!1)),e.firstCreatePass&&(lm(e,i),pb(i)&&e.queries.elementEnd(i)),Wb}var NB=(i,e,t,n)=>(am(!0),d4(e[Bn],""));function Ve(){return Bt()}var qp="en-US";var FB=qp;function OB(i){typeof i=="string"&&(FB=i.toLowerCase().replace(/_/g,"-"))}var BB=(i,e,t)=>{};function H(i,e,t,n){let r=Bt(),s=Wn(),o=vi();return QI(s,r,r[Bn],o,i,e,n),H}function VB(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[Ip],l=r[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function QI(i,e,t,n,r,s,o){let a=tm(n),d=i.firstCreatePass&&DI(i),c=e[is],u=II(e),h=!0;if(n.type&3||o){let x=Pr(n,e),v=o?o(x):x,g=u.length,y=o?A=>o(ks(A[n.index])):n.index,b=null;if(!o&&a&&(b=VB(i,e,r,n.index)),b!==null){let A=b.__ngLastListenerFn__||b;A.__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1}else{s=ET(n,e,c,s),BB(x,r,s);let A=t.listen(v,r,s);u.push(s,A),d&&d.push(r,y,g,g+1)}}else s=ET(n,e,c,s);let f=n.outputs,p;if(h&&f!==null&&(p=f[r])){let x=p.length;if(x)for(let v=0;v<x;v+=2){let g=p[v],y=p[v+1],M=e[g][y].subscribe(s),T=u.length;u.push(s,M),d&&d.push(r,n.index,T,-(T+1))}}}function ST(i,e,t,n){let r=Qt(null);try{return Is(6,e,t),t(n)!==!1}catch(s){return PI(i,s),!1}finally{Is(7,e,t),Qt(r)}}function ET(i,e,t,n){return function r(s){if(s===Function)return n;let o=i.componentOffset>-1?ma(i.index,e):e;Vb(o,5);let a=ST(e,t,n,s),l=r.__ngNextListenerFn__;for(;l;)a=ST(e,t,l,s)&&a,l=l.__ngNextListenerFn__;return a}}function U(i=1){return QF(i)}function ls(i,e,t){return Ci(i,"",e,"",t),ls}function Ci(i,e,t,n,r){let s=Bt(),o=XI(s,e,t,n);if(o!==as){let a=Wn(),l=sm();Nb(a,l,s,i,o,s[Bn],r,!1)}return Ci}function KI(i,e,t,n){G5(i,e,t,n)}function qn(i,e,t){j5(i,e,t)}function Rn(i){let e=Bt(),t=Wn(),n=y2();vb(n+1);let r=Hb(t,n);if(i.dirty&&PF(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let s=Z5(e,n);i.reset(s,SO),i.notifyOnChanges()}return!0}return!1}function Ln(){return z5(Bt(),y2())}function UB(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}function Ki(i){let e=zF();return u2(e,Tr+i)}function _(i,e=""){let t=Bt(),n=Wn(),r=i+Tr,s=n.firstCreatePass?Su(n,r,1,e,null):n.data[r],o=HB(n,t,s,e,i);t[r]=o,om()&&fm(n,t,o,s),ml(s,!1)}var HB=(i,e,t,n,r)=>(am(!0),a4(e[Bn],n));function ge(i){return ot("",i,""),ge}function ot(i,e,t){let n=Bt(),r=XI(n,i,e,t);return r!==as&&RI(n,gl(),r),ot}function Mu(i,e,t,n,r){let s=Bt(),o=mB(s,i,e,t,n,r);return o!==as&&RI(s,gl(),o),Mu}function Ze(i,e,t){qI(e)&&(e=e());let n=Bt(),r=rm();if(ao(n,r,e)){let s=Wn(),o=sm();Nb(s,o,n,i,e,n[Bn],t,!1)}return Ze}function Xe(i,e){let t=qI(i);return t&&i.set(e),t}function Ye(i,e){let t=Bt(),n=Wn(),r=vi();return QI(n,t,t[Bn],r,i,e),Ye}function zB(i,e,t){let n=Wn();if(n.firstCreatePass){let r=ca(i);Kw(t,n.data,n.blueprint,r,!0),Kw(e,n.data,n.blueprint,r,!1)}}function Kw(i,e,t,n,r){if(i=Fi(i),Array.isArray(i))for(let s=0;s<i.length;s++)Kw(i[s],e,t,n,r);else{let s=Wn(),o=Bt(),a=vi(),l=Ad(i)?i:Fi(i.provide),d=$T(i),c=a.providerIndexes&1048575,u=a.directiveStart,h=a.providerIndexes>>20;if(Ad(i)||!i.multi){let f=new ul(d,r,se),p=tw(l,e,r?c:c+h,u);p===-1?(mw(Np(a,o),s,l),ew(s,i,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{let f=tw(l,e,c+h,u),p=tw(l,e,c,c+h),x=f>=0&&t[f],v=p>=0&&t[p];if(r&&!v||!r&&!x){mw(Np(a,o),s,l);let g=WB(r?GB:jB,t.length,r,n,d);!r&&v&&(t[p].providerFactory=g),ew(s,i,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),o.push(g)}else{let g=JI(t[r?p:f],d,!r&&n);ew(s,i,f>-1?f:p,g)}!r&&n&&v&&t[p].componentProviders++}}}function ew(i,e,t,n){let r=Ad(e),s=wF(e);if(r||s){let l=(s?Fi(e.useClass):e).prototype.ngOnDestroy;if(l){let d=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let c=d.indexOf(t);c===-1?d.push(t,[n,l]):d[c+1].push(n,l)}else d.push(t,l)}}}function JI(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function tw(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function jB(i,e,t,n){return Jw(this.multi,[])}function GB(i,e,t,n){let r=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=hl(t,t[Tt],this.providerFactory.index,n);s=a.slice(0,o),Jw(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Jw(r,s);return s}function Jw(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function WB(i,e,t,n,r){let s=new ul(i,t,se);return s.multi=[],s.index=e,s.componentProviders=0,JI(s,r,n&&!t),s}function fo(i,e=[]){return t=>{t.providersResolver=(n,r)=>zB(n,r?r(i):i,e)}}var qB=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let n=QT(!1,t.type),r=n.length>0?xm([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Ee({token:i,providedIn:"environment",factory:()=>new i(Te(Bi))})}}return i})();function gt(i){vl("NgStandalone"),i.getStandaloneInjector=e=>e.get(qB).getOrCreateStandaloneInjector(i)}function Mi(i,e,t){let n=Au()+i,r=Bt();return r[n]===as?Eu(r,n,t?e.call(t):e()):rB(r,n)}function $I(i,e,t,n){return ZB(Bt(),Au(),i,e,t,n)}function wm(i,e,t,n,r){return YB(Bt(),Au(),i,e,t,n,r)}function eD(i,e,t,n,r,s,o){return QB(Bt(),Au(),i,e,t,n,r,s,o)}function bm(i,e){let t=i[e];return t===as?void 0:t}function ZB(i,e,t,n,r,s){let o=e+t;return ao(i,o,r)?Eu(i,o+1,s?n.call(s,r):n(r)):bm(i,o+1)}function YB(i,e,t,n,r,s,o){let a=e+t;return vu(i,a,r,s)?Eu(i,a+2,o?n.call(o,r,s):n(r,s)):bm(i,a+2)}function XB(i,e,t,n,r,s,o,a){let l=e+t;return sB(i,l,r,s,o)?Eu(i,l+3,a?n.call(a,r,s,o):n(r,s,o)):bm(i,l+3)}function QB(i,e,t,n,r,s,o,a,l){let d=e+t;return oB(i,d,r,s,o,a)?Eu(i,d+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):bm(i,d+4)}function Ti(i,e){let t=Wn(),n,r=i+Tr;t.firstCreatePass?(n=KB(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks??=[]).push(r,n.onDestroy)):n=t.data[r];let s=n.factory||(n.factory=ol(n.type,!0)),o,a=Qi(se);try{let l=kp(!1),d=s();return kp(l),UB(t,Bt(),r,d),d}finally{Qi(a)}}function KB(i,e){if(e)for(let t=e.length-1;t>=0;t--){let n=e[t];if(i===n.name)return n}}function Hi(i,e,t,n,r){let s=i+Tr,o=Bt(),a=u2(o,s);return JB(o,s)?XB(o,Au(),e,a.transform,t,n,r,a):a.transform(t,n,r)}function JB(i,e){return i[Tt].data[e].pure}function qb(i,e){return vm(i,e)}var ym=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"platform"})}}return i})();var tD=new rt("");function wl(i){return!!i&&typeof i.then=="function"}function nD(i){return!!i&&typeof i.subscribe=="function"}var Am=new rt(""),iD=(()=>{class i{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.appInits=ve(Am,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let s=r();if(wl(s))t.push(s);else if(nD(s)){let o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),t.length===0&&n(),this.initialized=!0}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Tu=new rt("");function $B(){uM(()=>{throw new qe(600,!1)})}function eV(i){return i.isBoundToModule}var tV=10;function nV(i,e,t){try{let n=t();return wl(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}var xa=(()=>{class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(AO),this.afterRenderManager=ve(YI),this.zonelessEnabled=ve(Ub),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new si,this.afterTick=new si,this.componentTypes=[],this.components=[],this.isStable=ve(uo).hasPendingTasks.pipe(St(t=>!t)),this._injector=ve(Bi)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(n=>{t=this.isStable.subscribe({next:r=>{r&&n()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,n){let r=t instanceof Up;if(!this._injector.get(iD).done){let h=!r&&qT(t),f=!1;throw new qe(405,f)}let o;r?o=t:o=this._injector.get(Md).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=eV(o)?void 0:this._injector.get(pa),l=n||o.selector,d=o.create(Ir.NULL,[],l,a),c=d.location.nativeElement,u=d.injector.get(tD,null);return u?.registerApplication(c),d.onDestroy(()=>{this.detachView(d.hostView),Ap(this.components,d),u?.unregisterApplication(c)}),this._loadComponent(d),d}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new qe(101,!1);let t=Qt(null);try{this._runningTick=!0,this.synchronize()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,Qt(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(fa,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<tV;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(n);for(let{_lView:r,notifyErrorHandler:s}of this._views)iV(r,s,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>nm(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){let n=t;Ap(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let n=this._injector.get(Tu,[]);[...this._bootstrapListeners,...n].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ap(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new qe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Ap(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function iV(i,e,t,n){if(!t&&!nm(i))return;NI(i,e,t&&!n?0:1)}var $w=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},_m=(()=>{class i{compileModuleSync(t){return new qw(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let n=this.compileModuleSync(t),r=ZT(t),s=dI(r.declarations).reduce((o,a)=>{let l=da(a);return l&&o.push(new Td(l)),o},[]);return new $w(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var rV=(()=>{class i{constructor(){this.zone=ve(rn),this.changeDetectionScheduler=ve(Cd),this.applicationRef=ve(xa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function sV({ngZoneFactory:i,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return i??=()=>new rn(We(ae({},oV()),{scheduleInRootZone:t})),[{provide:rn,useFactory:i},{provide:yd,multi:!0,useFactory:()=>{let n=ve(rV,{optional:!0});return()=>n.initialize()}},{provide:yd,multi:!0,useFactory:()=>{let n=ve(aV);return()=>{n.initialize()}}},e===!0?{provide:VI,useValue:!0}:[],{provide:UI,useValue:t??V2}]}function oV(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var aV=(()=>{class i{constructor(){this.subscription=new zn,this.initialized=!1,this.zone=ve(rn),this.pendingTasks=ve(uo)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{rn.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{rn.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var lV=(()=>{class i{constructor(){this.appRef=ve(xa),this.taskService=ve(uo),this.ngZone=ve(rn),this.zonelessEnabled=ve(Ub),this.disableScheduling=ve(VI,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new zn,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Op):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ve(UI,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof bw||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let n=this.useMicrotaskScheduler?iT:U2;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>n(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>n(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Op+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){throw this.taskService.remove(t),n}finally{this.cleanup()}this.useMicrotaskScheduler=!0,iT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function dV(){return typeof $localize<"u"&&$localize.locale||qp}var Zb=new rt("",{providedIn:"root",factory:()=>ve(Zb,Ft.Optional|Ft.SkipSelf)||dV()});var eb=new rt("");function gp(i){return!i.moduleRef}function cV(i){let e=gp(i)?i.r3Injector:i.moduleRef.injector,t=e.get(rn);return t.run(()=>{gp(i)?i.r3Injector.resolveInjectorInitializers():i.moduleRef.resolveInjectorInitializers();let n=e.get(Ns,null),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{n.handleError(s)}})}),gp(i)){let s=()=>e.destroy(),o=i.platformInjector.get(eb);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{let s=()=>i.moduleRef.destroy(),o=i.platformInjector.get(eb);o.add(s),i.moduleRef.onDestroy(()=>{Ap(i.allPlatformModules,i.moduleRef),r.unsubscribe(),o.delete(s)})}return nV(n,t,()=>{let s=e.get(iD);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(Zb,qp);if(OB(o||qp),gp(i)){let a=e.get(xa);return i.rootComponent!==void 0&&a.bootstrap(i.rootComponent),a}else return uV(i.moduleRef,i.allPlatformModules),i.moduleRef})})})}function uV(i,e){let t=i.injector.get(xa);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(n=>t.bootstrap(n));else if(i.instance.ngDoBootstrap)i.instance.ngDoBootstrap(t);else throw new qe(-403,!1);e.push(i)}var _p=null;function hV(i=[],e){return Ir.create({name:e,providers:[{provide:Jp,useValue:"platform"},{provide:eb,useValue:new Set([()=>_p=null])},...i]})}function fV(i=[]){if(_p)return _p;let e=hV(i);return _p=e,$B(),pV(e),e}function pV(i){i.get(Eb,null)?.forEach(t=>t())}var Bs=(()=>{class i{static{this.__NG_ELEMENT_ID__=mV}}return i})();function mV(i){return gV(vi(),Bt(),(i&16)===16)}function gV(i,e,t){if(em(i)&&!t){let n=ma(i.index,e);return new fl(n,n)}else if(i.type&175){let n=e[Ls];return new fl(n,e)}return null}var tb=class{constructor(){}supports(e){return ZI(e)}create(e){return new nb(e)}},vV=(i,e)=>e,nb=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||vV}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){let o=!n||t&&t.currentIndex<CT(n,r,s)?t:n,a=CT(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,o.previousIndex==null)r++;else{s||(s=[]);let d=a-r,c=l-r;if(d!=c){for(let h=0;h<d;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;c<=p&&p<d&&(s[h]=f+1)}let u=o.previousIndex;s[u]=c-d}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!ZI(e))throw new qe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,n=!1,r,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),n=!0):(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else r=0,nB(e,a=>{o=this._trackByFn(r,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,r),n=!0):(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(n,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new ib(t,n),s,r)),e}_verifyReinsertion(e,t,n,r){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null);return s!==null?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,s=e._nextRemoved;return r===null?this._removalsHead=s:r._nextRemoved=s,s===null?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Zp),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,n=e._next;return t===null?this._itHead=n:t._next=n,n===null?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Zp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},ib=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},rb=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;n!==null;n=n._nextDup)if((t===null||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){let t=e._prevDup,n=e._nextDup;return t===null?this._head=n:t._nextDup=n,n===null?this._tail=t:n._prevDup=t,this._head===null}},Zp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,n=this.map.get(t);n||(n=new rb,this.map.set(t,n)),n.add(e)}get(e,t){let n=e,r=this.map.get(n);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function CT(i,e,t){let n=i.previousIndex;if(n===null)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}function MT(){return new Yb([new tb])}var Yb=(()=>{class i{static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:MT})}constructor(t){this.factories=t}static create(t,n){if(n!=null){let r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||MT()),deps:[[i,new lb,new Kp]]}}find(t){let n=this.factories.find(r=>r.supports(t));if(n!=null)return n;throw new qe(901,!1)}}return i})();function rD(i){try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=fV(n),s=[sV({}),{provide:Cd,useExisting:lV},...t||[]],o=new Gp({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1});return cV({r3Injector:o.injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}function wa(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function Iu(i,e){vl("NgSignals");let t=lM(i);return e?.equal&&(t[Cs].equal=e.equal),t}function po(i){let e=Qt(null);try{return i()}finally{Qt(e)}}var xV=new rt("",{providedIn:"root",factory:()=>ve(wV)}),wV=(()=>{class i{static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>new sb})}}return i})(),sb=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=ve(uo),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),this.taskId===null){let t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){let t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);let n=this.queues.get(t);n.has(e)||(this.queuedEffectCount++,n.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},ob=class{constructor(e,t,n,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=n,this.injector=s,this.watcher=mM(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(Ns,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function Sm(i,e){vl("NgSignals"),!e?.injector&&t2(Sm);let t=e?.injector??ve(Ir),n=e?.manualCleanup!==!0?t.get(dm):null,r=new ob(t.get(xV),i,typeof Zone>"u"?null:Zone.current,n,t,e?.allowSignalWrites??!1),s=t.get(Bs,null,{optional:!0});return!s||!(s._lView[pt]&8)?r.watcher.notify():(s._lView[xp]??=[]).push(r.watcher.notify),r}function sD(i){let e=da(i);if(!e)return null;let t=new Td(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var uD=null;function go(){return uD}function hD(i){uD??=i}var Em=class{};var li=new rt(""),ty=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(AV),providedIn:"platform"})}}return i})(),fD=new rt(""),AV=(()=>{class i extends ty{constructor(){super(),this._doc=ve(li),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return go().getBaseHref(this._doc)}onPopState(t){let n=go().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){let n=go().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){this._history.pushState(t,n,r)}replaceState(t,n,r){this._history.replaceState(t,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>new i,providedIn:"platform"})}}return i})();function ny(i,e){if(i.length==0)return e;if(e.length==0)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?i+e.substring(1):t==1?i+e:i+"/"+e}function oD(i){let e=i.match(/#|\?|$/),t=e&&e.index||i.length,n=t-(i[t-1]==="/"?1:0);return i.slice(0,n)+i.slice(t)}function mo(i){return i&&i[0]!=="?"?"?"+i:i}var vo=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(iy),providedIn:"root"})}}return i})(),pD=new rt(""),iy=(()=>{class i extends vo{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??ve(li).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ny(this._baseHref,t)}path(t=!1){let n=this._platformLocation.pathname+mo(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+mo(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+mo(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(Te(ty),Te(pD,8))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),mD=(()=>{class i extends vo{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(t){let n=ny(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+mo(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+mo(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(Te(ty),Te(pD,8))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),kd=(()=>{class i{constructor(t){this._subject=new En,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let n=this._locationStrategy.getBaseHref();this._basePath=EV(oD(aD(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+mo(n))}normalize(t){return i.stripTrailingSlash(SV(this._basePath,aD(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+mo(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+mo(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}static{this.normalizeQueryParams=mo}static{this.joinWithSlash=ny}static{this.stripTrailingSlash=oD}static{this.\u0275fac=function(n){return new(n||i)(Te(vo))}}static{this.\u0275prov=Ee({token:i,factory:()=>_V(),providedIn:"root"})}}return i})();function _V(){return new kd(Te(vo))}function SV(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function aD(i){return i.replace(/\/index.html$/,"")}function EV(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}function Cm(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Xb=/\s+/,lD=[],Ji=(()=>{class i{constructor(t,n){this._ngEl=t,this._renderer=n,this.initialClasses=lD,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(Xb):lD}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Xb):t}ngDoCheck(){for(let n of this.initialClasses)this._updateState(n,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let n of t)this._updateState(n,!0);else if(t!=null)for(let n of Object.keys(t))this._updateState(n,!!t[n]);this._applyStateDiff()}_updateState(t,n){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(t,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let n=t[0],r=t[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(t,n){t=t.trim(),t.length>0&&t.split(Xb).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(n){return new(n||i)(se(xi),se(Ei))}}static{this.\u0275dir=hn({type:i,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return i})();var Qb=class{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},an=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(r.previousIndex==null)n.createEmbeddedView(this._template,new Qb(r.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)n.remove(s===null?void 0:s);else if(s!==null){let a=n.get(s);n.move(a,o),dD(a,r)}});for(let r=0,s=n.length;r<s;r++){let a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let s=n.get(r.currentIndex);dD(s,r)})}static ngTemplateContextGuard(t,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(se(va),se(ha),se(Yb))}}static{this.\u0275dir=hn({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return i})();function dD(i,e){i.context.$implicit=e.item}var kt=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new Kb,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){cD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){cD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(se(va),se(ha))}}static{this.\u0275dir=hn({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return i})(),Kb=class{constructor(){this.$implicit=null,this.ngIf=null}};function cD(i,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${i} must be a TemplateRef, but received '${Oi(e)}'.`)}function CV(i,e){return new qe(2100,!1)}var Lr=(()=>{class i{transform(t,n,r){if(t==null)return null;if(!this.supports(t))throw CV(i,t);return t.slice(n,r)}supports(t){return typeof t=="string"||Array.isArray(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275pipe=ub({name:"slice",type:i,pure:!1,standalone:!0})}}return i})();var xt=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})(),ry="browser",MV="server";function gD(i){return i===ry}function Mm(i){return i===MV}var vD=(()=>{class i{static{this.\u0275prov=Ee({token:i,providedIn:"root",factory:()=>gD(ve(os))?new Jb(ve(li),window):new $b})}}return i})(),Jb=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=TV(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}};function TV(i,e){let t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if(typeof i.createTreeWalker=="function"&&i.body&&typeof i.body.attachShadow=="function"){let n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT),r=n.currentNode;for(;r;){let s=r.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}var $b=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Ld=class{};var Pu=class{},Im=class{},xo=class i{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof i?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new i;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof i?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,n),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var oy=class{encodeKey(e){return xD(e)}encodeValue(e){return xD(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function IV(i,e){let t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,a]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}var DV=/%(\d[a-f0-9])/gi,PV={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function xD(i){return encodeURIComponent(i).replace(DV,(e,t)=>PV[t]??e)}function Tm(i){return`${i}`}var ya=class i{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new oy,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=IV(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],r=Array.isArray(n)?n.map(Tm):[Tm(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new i({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Tm(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],r=n.indexOf(Tm(e.value));r!==-1&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var ay=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function RV(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function wD(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function bD(i){return typeof Blob<"u"&&i instanceof Blob}function yD(i){return typeof FormData<"u"&&i instanceof FormData}function LV(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}var Du=class i{constructor(e,t,n,r){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(RV(this.method)||r?(this.body=n!==void 0?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new xo,this.context??=new ay,!this.params)this.params=new ya,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),l=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||wD(this.body)||bD(this.body)||yD(this.body)||LV(this.body)?this.body:this.body instanceof ya?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||yD(this.body)?null:bD(this.body)?this.body.type||null:wD(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ya?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,d=e.headers||this.headers,c=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(d=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),d)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),c)),new i(t,n,o,{params:c,headers:d,context:u,reportProgress:l,responseType:r,withCredentials:a,transferCache:s})}},Aa=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(Aa||{}),Ru=class{constructor(e,t=200,n="OK"){this.headers=e.headers||new xo,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Dm=class i extends Ru{constructor(e={}){super(e),this.type=Aa.ResponseHeader}clone(e={}){return new i({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Lu=class i extends Ru{constructor(e={}){super(e),this.type=Aa.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new i({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},ba=class extends Ru{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},ED=200,kV=204;function sy(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials,transferCache:i.transferCache}}var wo=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof Du)s=t;else{let l;r.headers instanceof xo?l=r.headers:l=new xo(r.headers);let d;r.params&&(r.params instanceof ya?d=r.params:d=new ya({fromObject:r.params})),s=new Du(t,n,r.body!==void 0?r.body:null,{headers:l,context:r.context,params:d,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let o=lt(s).pipe(no(l=>this.handler.handle(l)));if(t instanceof Du||r.observe==="events")return o;let a=o.pipe(Yi(l=>l instanceof Lu));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(St(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(St(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(St(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(St(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:new ya().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,sy(r,n))}post(t,n,r={}){return this.request("POST",t,sy(r,n))}put(t,n,r={}){return this.request("PUT",t,sy(r,n))}static{this.\u0275fac=function(n){return new(n||i)(Te(Pu))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),NV=/^\)\]\}',?\n/,FV="X-Request-URL";function AD(i){if(i.url)return i.url;let e=FV.toLocaleLowerCase();return i.headers.get(e)}var OV=(()=>{class i{constructor(){this.fetchImpl=ve(ly,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=ve(rn)}handle(t){return new qt(n=>{let r=new AbortController;return this.doRequest(t,r.signal,n).then(dy,s=>n.error(new ba({error:s}))),()=>r.abort()})}doRequest(t,n,r){return re(this,null,function*(){let s=this.createRequestInit(t),o;try{let f=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,ae({signal:n},s)));BV(f),r.next({type:Aa.Sent}),o=yield f}catch(f){r.error(new ba({error:f,status:f.status??0,statusText:f.statusText,url:t.urlWithParams,headers:f.headers}));return}let a=new xo(o.headers),l=o.statusText,d=AD(o)??t.urlWithParams,c=o.status,u=null;if(t.reportProgress&&r.next(new Dm({headers:a,status:c,statusText:l,url:d})),o.body){let f=o.headers.get("content-length"),p=[],x=o.body.getReader(),v=0,g,y,b=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>re(this,null,function*(){for(;;){let{done:M,value:T}=yield x.read();if(M)break;if(p.push(T),v+=T.length,t.reportProgress){y=t.responseType==="text"?(y??"")+(g??=new TextDecoder).decode(T,{stream:!0}):void 0;let I=()=>r.next({type:Aa.DownloadProgress,total:f?+f:void 0,loaded:v,partialText:y});b?b.run(I):I()}}}));let A=this.concatChunks(p,v);try{let M=o.headers.get("Content-Type")??"";u=this.parseBody(t,A,M)}catch(M){r.error(new ba({error:M,headers:new xo(o.headers),status:o.status,statusText:o.statusText,url:AD(o)??t.urlWithParams}));return}}c===0&&(c=u?ED:0),c>=200&&c<300?(r.next(new Lu({body:u,headers:a,status:c,statusText:l,url:d})),r.complete()):r.error(new ba({error:u,headers:a,status:c,statusText:l,url:d}))})}parseBody(t,n,r){switch(t.responseType){case"json":let s=new TextDecoder().decode(n).replace(NV,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(n);case"blob":return new Blob([n],{type:r});case"arraybuffer":return n.buffer}}createRequestInit(t){let n={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>n[s]=o.join(",")),t.headers.has("Accept")||(n.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(n["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:n,credentials:r}}concatChunks(t,n){let r=new Uint8Array(n),s=0;for(let o of t)r.set(o,s),s+=o.length;return r}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),ly=class{};function dy(){}function BV(i){i.then(dy,dy)}function VV(i,e){return e(i)}function UV(i,e,t){return(n,r)=>Dr(t,()=>e(n,s=>i(s,r)))}var CD=new rt(""),HV=new rt(""),zV=new rt("",{providedIn:"root",factory:()=>!0});var _D=(()=>{class i extends Pu{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null,this.pendingTasks=ve(uo),this.contributeToStability=ve(zV)}handle(t){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(CD),...this.injector.get(HV,[])]));this.chain=n.reduceRight((r,s)=>UV(r,s,this.injector),VV)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(rl(()=>this.pendingTasks.remove(n)))}else return this.chain(t,n=>this.backend.handle(n))}static{this.\u0275fac=function(n){return new(n||i)(Te(Im),Te(Bi))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})();var jV=/^\)\]\}',?\n/;function GV(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}var SD=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new qe(-2800,!1);let n=this.xhrFactory;return(n.\u0275loadImpl?gn(n.\u0275loadImpl()):lt(null)).pipe(Xi(()=>new qt(s=>{let o=n.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((x,v)=>o.setRequestHeader(x,v.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let x=t.detectContentTypeHeader();x!==null&&o.setRequestHeader("Content-Type",x)}if(t.responseType){let x=t.responseType.toLowerCase();o.responseType=x!=="json"?x:"text"}let a=t.serializeBody(),l=null,d=()=>{if(l!==null)return l;let x=o.statusText||"OK",v=new xo(o.getAllResponseHeaders()),g=GV(o)||t.url;return l=new Dm({headers:v,status:o.status,statusText:x,url:g}),l},c=()=>{let{headers:x,status:v,statusText:g,url:y}=d(),b=null;v!==kV&&(b=typeof o.response>"u"?o.responseText:o.response),v===0&&(v=b?ED:0);let A=v>=200&&v<300;if(t.responseType==="json"&&typeof b=="string"){let M=b;b=b.replace(jV,"");try{b=b!==""?JSON.parse(b):null}catch(T){b=M,A&&(A=!1,b={error:T,text:b})}}A?(s.next(new Lu({body:b,headers:x,status:v,statusText:g,url:y||void 0})),s.complete()):s.error(new ba({error:b,headers:x,status:v,statusText:g,url:y||void 0}))},u=x=>{let{url:v}=d(),g=new ba({error:x,status:o.status||0,statusText:o.statusText||"Unknown Error",url:v||void 0});s.error(g)},h=!1,f=x=>{h||(s.next(d()),h=!0);let v={type:Aa.DownloadProgress,loaded:x.loaded};x.lengthComputable&&(v.total=x.total),t.responseType==="text"&&o.responseText&&(v.partialText=o.responseText),s.next(v)},p=x=>{let v={type:Aa.UploadProgress,loaded:x.loaded};x.lengthComputable&&(v.total=x.total),s.next(v)};return o.addEventListener("load",c),o.addEventListener("error",u),o.addEventListener("timeout",u),o.addEventListener("abort",u),t.reportProgress&&(o.addEventListener("progress",f),a!==null&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:Aa.Sent}),()=>{o.removeEventListener("error",u),o.removeEventListener("abort",u),o.removeEventListener("load",c),o.removeEventListener("timeout",u),t.reportProgress&&(o.removeEventListener("progress",f),a!==null&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(n){return new(n||i)(Te(Ld))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),MD=new rt(""),WV="XSRF-TOKEN",qV=new rt("",{providedIn:"root",factory:()=>WV}),ZV="X-XSRF-TOKEN",YV=new rt("",{providedIn:"root",factory:()=>ZV}),Pm=class{},XV=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Cm(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(n){return new(n||i)(Te(li),Te(os),Te(qV))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})();function QV(i,e){let t=i.url.toLowerCase();if(!ve(MD)||i.method==="GET"||i.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(i);let n=ve(Pm).getToken(),r=ve(YV);return n!=null&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),e(i)}function TD(...i){let e=[wo,SD,_D,{provide:Pu,useExisting:_D},{provide:Im,useFactory:()=>ve(OV,{optional:!0})??ve(SD)},{provide:CD,useValue:QV,multi:!0},{provide:MD,useValue:!0},{provide:Pm,useClass:XV}];for(let t of i)e.push(...t.\u0275providers);return yu(e)}var hy=class extends Em{constructor(){super(...arguments),this.supportsDOMEvents=!0}},fy=class i extends hy{static makeCurrent(){hD(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=KV();return t==null?null:JV(t)}resetBaseElement(){ku=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Cm(document.cookie,e)}},ku=null;function KV(){return ku=ku||document.querySelector("base"),ku?ku.getAttribute("href"):null}function JV(i){return new URL(i,document.baseURI).pathname}var $V=(()=>{class i{build(){return new XMLHttpRequest}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),py=new rt(""),RD=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(s=>s.supports(t)),!n)throw new qe(5101,!1);return this._eventNameToPlugin.set(t,n),n}static{this.\u0275fac=function(n){return new(n||i)(Te(py),Te(rn))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),Lm=class{constructor(e){this._doc=e}},cy="ng-app-id",LD=(()=>{class i{constructor(t,n,r,s={}){this.doc=t,this.appId=n,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Mm(s),this.resetHostNodes()}addStyles(t){for(let n of t)this.changeUsageCount(n,1)===1&&this.onStyleAdded(n)}removeStyles(t){for(let n of t)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(n=>n.remove()),t.clear());for(let n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){let n=this.styleRef;n.get(t)?.elements?.forEach(r=>r.remove()),n.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${cy}="${this.appId}"]`);if(t?.length){let n=new Map;return t.forEach(r=>{r.textContent!=null&&n.set(r.textContent,r)}),n}return null}changeUsageCount(t,n){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=n,s.usage}return r.set(t,{usage:n,elements:[]}),n}getStyleElement(t,n){let r=this.styleNodesInDOM,s=r?.get(n);if(s?.parentNode===t)return r.delete(n),s.removeAttribute(cy),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=n,this.platformIsServer&&o.setAttribute(cy,this.appId),t.appendChild(o),o}}addStyleToHost(t,n){let r=this.getStyleElement(t,n),s=this.styleRef,o=s.get(n)?.elements;o?o.push(r):s.set(n,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(n){return new(n||i)(Te(li),Te(Sb),Te(cm,8),Te(os))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),uy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},gy=/%COMP%/g,kD="%COMP%",e8=`_nghost-${kD}`,t8=`_ngcontent-${kD}`,n8=!0,i8=new rt("",{providedIn:"root",factory:()=>n8});function r8(i){return t8.replace(gy,i)}function s8(i){return e8.replace(gy,i)}function ND(i,e){return e.map(t=>t.replace(gy,i))}var ID=(()=>{class i{constructor(t,n,r,s,o,a,l,d=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Mm(a),this.defaultRenderer=new Nu(t,o,l,this.platformIsServer)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Ps.ShadowDom&&(n=We(ae({},n),{encapsulation:Ps.Emulated}));let r=this.getOrCreateRenderer(t,n);return r instanceof km?r.applyToHost(t):r instanceof Fu&&r.applyStyles(),r}getOrCreateRenderer(t,n){let r=this.rendererByCompId,s=r.get(n.id);if(!s){let o=this.doc,a=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,c=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(n.encapsulation){case Ps.Emulated:s=new km(l,d,n,this.appId,c,o,a,u);break;case Ps.ShadowDom:return new my(l,d,t,n,o,a,this.nonce,u);default:s=new Fu(l,d,n,c,o,a,u);break}r.set(n.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(n){return new(n||i)(Te(RD),Te(LD),Te(Sb),Te(i8),Te(li),Te(os),Te(rn),Te(cm))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),Nu=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(uy[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(DD(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(DD(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new qe(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=uy[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=uy[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(oo.DashCase|oo.Important)?e.style.setProperty(t,n,r&oo.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&oo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=go().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function DD(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var my=class extends Nu{constructor(e,t,n,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=ND(r.id,r.styles);for(let c of d){let u=document.createElement("style");a&&u.setAttribute("nonce",a),u.textContent=c,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Fu=class extends Nu{constructor(e,t,n,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?ND(l,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},km=class extends Fu{constructor(e,t,n,r,s,o,a,l){let d=r+"-"+n.id;super(e,t,n,s,o,a,l,d),this.contentAttr=r8(d),this.hostAttr=s8(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},o8=(()=>{class i extends Lm{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}static{this.\u0275fac=function(n){return new(n||i)(Te(li))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})(),PD=["alt","control","meta","shift"],a8={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},l8={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},d8=(()=>{class i extends Lm{constructor(t){super(t)}supports(t){return i.parseEventName(t)!=null}addEventListener(t,n,r){let s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>go().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let n=t.toLowerCase().split("."),r=n.shift();if(n.length===0||!(r==="keydown"||r==="keyup"))return null;let s=i._normalizeKey(n.pop()),o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),PD.forEach(d=>{let c=n.indexOf(d);c>-1&&(n.splice(c,1),o+=d+".")}),o+=s,n.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,n){let r=a8[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),PD.forEach(o=>{if(o!==r){let a=l8[o];a(t)&&(s+=o+".")}}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(n){return new(n||i)(Te(li))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})();function Nm(i,e){return rD(ae({rootComponent:i},c8(e)))}function c8(i){return{appProviders:[...m8,...i?.providers??[]],platformProviders:p8}}function u8(){fy.makeCurrent()}function h8(){return new Ns}function f8(){return Z2(document),document}var p8=[{provide:os,useValue:ry},{provide:Eb,useValue:u8,multi:!0},{provide:li,useFactory:f8,deps:[]}];var m8=[{provide:Jp,useValue:"root"},{provide:Ns,useFactory:h8,deps:[]},{provide:py,useClass:o8,multi:!0,deps:[li,rn,os]},{provide:py,useClass:d8,multi:!0,deps:[li]},ID,LD,RD,{provide:fa,useExisting:ID},{provide:Ld,useClass:$V,deps:[]},[]];var FD=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(n){return new(n||i)(Te(li))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ds=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:function(n){let r=null;return n?r=new(n||i):r=Te(g8),r},providedIn:"root"})}}return i})(),g8=(()=>{class i extends ds{constructor(t){super(),this._doc=t}sanitize(t,n){if(n==null)return null;switch(t){case Os.NONE:return n;case Os.HTML:return ga(n,"HTML")?Fs(n):sI(this._doc,String(n)).toString();case Os.STYLE:return ga(n,"Style")?Fs(n):n;case Os.SCRIPT:if(ga(n,"Script"))return Fs(n);throw new qe(5200,!1);case Os.URL:return ga(n,"URL")?Fs(n):hm(String(n));case Os.RESOURCE_URL:if(ga(n,"ResourceURL"))return Fs(n);throw new qe(5201,!1);default:throw new qe(5202,!1)}}bypassSecurityTrustHtml(t){return X2(t)}bypassSecurityTrustStyle(t){return Q2(t)}bypassSecurityTrustScript(t){return K2(t)}bypassSecurityTrustUrl(t){return J2(t)}bypassSecurityTrustResourceUrl(t){return $2(t)}static{this.\u0275fac=function(n){return new(n||i)(Te(li))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Dt="primary",Ku=Symbol("RouteTitle"),yy=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Hd(i){return new yy(i)}function v8(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let s=0;s<n.length;s++){let o=n[s],a=i[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function x8(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Vs(i[t],e[t]))return!1;return!0}function Vs(i,e){let t=i?Ay(i):void 0,n=e?Ay(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!ZD(i[r],e[r]))return!1;return!0}function Ay(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function ZD(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}else return i===e}function YD(i){return i.length>0?i[i.length-1]:null}function Ea(i){return Ox(i)?i:wl(i)?gn(Promise.resolve(i)):lt(i)}var w8={exact:QD,subset:KD},XD={exact:b8,subset:y8,ignored:()=>!0};function OD(i,e,t){return w8[t.paths](i.root,e.root,t.matrixParams)&&XD[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function b8(i,e){return Vs(i,e)}function QD(i,e,t){if(!yl(i.segments,e.segments)||!Bm(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!QD(i.children[n],e.children[n],t))return!1;return!0}function y8(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>ZD(i[t],e[t]))}function KD(i,e,t){return JD(i,e,e.segments,t)}function JD(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!yl(r,t)||e.hasChildren()||!Bm(r,t,n))}else if(i.segments.length===t.length){if(!yl(i.segments,t)||!Bm(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!KD(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!yl(i.segments,r)||!Bm(i.segments,r,n)||!i.children[Dt]?!1:JD(i.children[Dt],e,s,n)}}function Bm(i,e,t){return e.every((n,r)=>XD[t](i[r].parameters,n.parameters))}var yo=class{constructor(e=new tn([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Hd(this.queryParams),this._queryParamMap}toString(){return S8.serialize(this)}},tn=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Vm(this)}},bl=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Hd(this.parameters),this._parameterMap}toString(){return eP(this)}};function A8(i,e){return yl(i,e)&&i.every((t,n)=>Vs(t.parameters,e[n].parameters))}function yl(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function _8(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===Dt&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==Dt&&(t=t.concat(e(r,n)))}),t}var Ju=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>new zd,providedIn:"root"})}}return i})(),zd=class{parse(e){let t=new Sy(e);return new yo(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ou(e.root,!0)}`,n=M8(e.queryParams),r=typeof e.fragment=="string"?`#${E8(e.fragment)}`:"";return`${t}${n}${r}`}},S8=new zd;function Vm(i){return i.segments.map(e=>eP(e)).join("/")}function Ou(i,e){if(!i.hasChildren())return Vm(i);if(e){let t=i.children[Dt]?Ou(i.children[Dt],!1):"",n=[];return Object.entries(i.children).forEach(([r,s])=>{r!==Dt&&n.push(`${r}:${Ou(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=_8(i,(n,r)=>r===Dt?[Ou(i.children[Dt],!1)]:[`${r}:${Ou(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[Dt]!=null?`${Vm(i)}/${t[0]}`:`${Vm(i)}/(${t.join("//")})`}}function $D(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fm(i){return $D(i).replace(/%3B/gi,";")}function E8(i){return encodeURI(i)}function _y(i){return $D(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Um(i){return decodeURIComponent(i)}function BD(i){return Um(i.replace(/\+/g,"%20"))}function eP(i){return`${_y(i.path)}${C8(i.parameters)}`}function C8(i){return Object.entries(i).map(([e,t])=>`;${_y(e)}=${_y(t)}`).join("")}function M8(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${Fm(t)}=${Fm(r)}`).join("&"):`${Fm(t)}=${Fm(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var T8=/^[^\/()?;#]+/;function vy(i){let e=i.match(T8);return e?e[0]:""}var I8=/^[^\/()?;=#]+/;function D8(i){let e=i.match(I8);return e?e[0]:""}var P8=/^[^=?&#]+/;function R8(i){let e=i.match(P8);return e?e[0]:""}var L8=/^[^&#]+/;function k8(i){let e=i.match(L8);return e?e[0]:""}var Sy=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new tn([],{}):new tn([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Dt]=new tn(e,t)),n}parseSegment(){let e=vy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new qe(4009,!1);return this.capture(e),new bl(Um(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=D8(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=vy(this.remaining);r&&(n=r,this.capture(n))}e[Um(t)]=Um(n)}parseQueryParam(e){let t=R8(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=k8(this.remaining);o&&(n=o,this.capture(n))}let r=BD(t),s=BD(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=vy(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new qe(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Dt);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[Dt]:new tn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new qe(4011,!1)}};function tP(i){return i.segments.length>0?new tn([],{[Dt]:i}):i}function nP(i){let e={};for(let[n,r]of Object.entries(i.children)){let s=nP(r);if(n===Dt&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new tn(i.segments,e);return N8(t)}function N8(i){if(i.numberOfChildren===1&&i.children[Dt]){let e=i.children[Dt];return new tn(i.segments.concat(e.segments),e.children)}return i}function Al(i){return i instanceof yo}function F8(i,e,t=null,n=null){let r=iP(i);return rP(r,e,t,n)}function iP(i){let e;function t(s){let o={};for(let l of s.children){let d=t(l);o[l.outlet]=d}let a=new tn(s.url,o);return s===i&&(e=a),a}let n=t(i.root),r=tP(n);return e??r}function rP(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return xy(r,r,r,t,n);let s=O8(e);if(s.toRoot())return xy(r,r,new tn([],{}),t,n);let o=B8(s,r,i),a=o.processChildren?Uu(o.segmentGroup,o.index,s.commands):oP(o.segmentGroup,o.index,s.commands);return xy(r,o.segmentGroup,a,t,n)}function Hm(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function ju(i){return typeof i=="object"&&i!=null&&i.outlets}function xy(i,e,t,n,r){let s={};n&&Object.entries(n).forEach(([l,d])=>{s[l]=Array.isArray(d)?d.map(c=>`${c}`):`${d}`});let o;i===e?o=t:o=sP(i,e,t);let a=tP(nP(o));return new yo(a,s,r)}function sP(i,e,t){let n={};return Object.entries(i.children).forEach(([r,s])=>{s===e?n[r]=t:n[r]=sP(s,e,t)}),new tn(i.segments,n)}var zm=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Hm(n[0]))throw new qe(4003,!1);let r=n.find(ju);if(r&&r!==YD(n))throw new qe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function O8(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new zm(!0,0,i);let e=0,t=!1,n=i.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,d])=>{a[l]=typeof d=="string"?d.split("/"):d}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new zm(t,e,n)}var Bd=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function B8(i,e,t){if(i.isAbsolute)return new Bd(e,!0,0);if(!t)return new Bd(e,!1,NaN);if(t.parent===null)return new Bd(t,!0,0);let n=Hm(i.commands[0])?0:1,r=t.segments.length-1+n;return V8(t,r,i.numberOfDoubleDots)}function V8(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new qe(4005,!1);r=n.segments.length}return new Bd(n,!1,r-s)}function U8(i){return ju(i[0])?i[0].outlets:{[Dt]:i}}function oP(i,e,t){if(i??=new tn([],{}),i.segments.length===0&&i.hasChildren())return Uu(i,e,t);let n=H8(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let s=new tn(i.segments.slice(0,n.pathIndex),{});return s.children[Dt]=new tn(i.segments.slice(n.pathIndex),i.children),Uu(s,0,r)}else return n.match&&r.length===0?new tn(i.segments,{}):n.match&&!i.hasChildren()?Ey(i,e,t):n.match?Uu(i,0,r):Ey(i,e,t)}function Uu(i,e,t){if(t.length===0)return new tn(i.segments,{});{let n=U8(t),r={};if(Object.keys(n).some(s=>s!==Dt)&&i.children[Dt]&&i.numberOfChildren===1&&i.children[Dt].segments.length===0){let s=Uu(i.children[Dt],e,t);return new tn(i.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=oP(i.children[s],e,o))}),Object.entries(i.children).forEach(([s,o])=>{n[s]===void 0&&(r[s]=o)}),new tn(i.segments,r)}}function H8(i,e,t){let n=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;let o=i.segments[r],a=t[n];if(ju(a))break;let l=`${a}`,d=n<t.length-1?t[n+1]:null;if(r>0&&l===void 0)break;if(l&&d&&typeof d=="object"&&d.outlets===void 0){if(!UD(l,d,o))return s;n+=2}else{if(!UD(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function Ey(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(ju(s)){let l=z8(s.outlets);return new tn(n,l)}if(r===0&&Hm(t[0])){let l=i.segments[e];n.push(new bl(l.path,VD(t[0]))),r++;continue}let o=ju(s)?s.outlets[Dt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Hm(a)?(n.push(new bl(o,VD(a))),r+=2):(n.push(new bl(o,{})),r++)}return new tn(n,{})}function z8(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Ey(new tn([],{}),0,n))}),e}function VD(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function UD(i,e,t){return i==t.path&&Vs(e,t.parameters)}var Hu="imperative",di=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(di||{}),kr=class{constructor(e,t){this.id=e,this.url=t}},jd=class extends kr{constructor(e,t,n="imperative",r=null){super(e,t),this.type=di.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},us=class extends kr{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=di.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},fr=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(fr||{}),jm=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(jm||{}),bo=class extends kr{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=di.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},_a=class extends kr{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=di.NavigationSkipped}},Gu=class extends kr{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=di.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Gm=class extends kr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=di.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cy=class extends kr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=di.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},My=class extends kr{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=di.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ty=class extends kr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=di.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Iy=class extends kr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=di.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dy=class{constructor(e){this.route=e,this.type=di.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Py=class{constructor(e){this.route=e,this.type=di.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ry=class{constructor(e){this.snapshot=e,this.type=di.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ly=class{constructor(e){this.snapshot=e,this.type=di.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ky=class{constructor(e){this.snapshot=e,this.type=di.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ny=class{constructor(e){this.snapshot=e,this.type=di.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Wm=class{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=di.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Wu=class{},Gd=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function j8(i,e){return i.providers&&!i._injector&&(i._injector=xm(i.providers,e,`Route: ${i.path}`)),i._injector??e}function cs(i){return i.outlet||Dt}function G8(i,e){let t=i.filter(n=>cs(n)===e);return t.push(...i.filter(n=>cs(n)!==e)),t}function $u(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Fy=class{get injector(){return $u(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new eh(this.rootInjector),this.attachRef=null}},eh=(()=>{class i{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,n){let r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new Fy(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(n){return new(n||i)(Te(Bi))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),qm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Oy(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=Oy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=By(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return By(e,this._root).map(t=>t.value)}};function Oy(i,e){if(i===e.value)return e;for(let t of e.children){let n=Oy(i,t);if(n)return n}return null}function By(i,e){if(i===e.value)return[e];for(let t of e.children){let n=By(i,t);if(n.length)return n.unshift(e),n}return[]}var hr=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Od(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var Zm=class extends qm{constructor(e,t){super(e),this.snapshot=t,Zy(this,e)}toString(){return this.snapshot.toString()}};function aP(i){let e=W8(i),t=new pi([new bl("",{})]),n=new pi({}),r=new pi({}),s=new pi({}),o=new pi(""),a=new Sa(t,n,s,o,r,Dt,i,e.root);return a.snapshot=e.root,new Zm(new hr(a,[]),e)}function W8(i){let e={},t={},n={},r="",s=new Vd([],e,n,r,t,Dt,i,null,{});return new Xm("",new hr(s,[]))}var Sa=class{constructor(e,t,n,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(St(d=>d[Ku]))??lt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(St(e=>Hd(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(St(e=>Hd(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ym(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:ae(ae({},e.params),i.params),data:ae(ae({},e.data),i.data),resolve:ae(ae(ae(ae({},i.data),e.data),r?.data),i._resolvedData)}:n={params:ae({},i.params),data:ae({},i.data),resolve:ae(ae({},i.data),i._resolvedData??{})},r&&dP(r)&&(n.resolve[Ku]=r.title),n}var Vd=class{get title(){return this.data?.[Ku]}constructor(e,t,n,r,s,o,a,l,d){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Hd(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Hd(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Xm=class extends qm{constructor(e,t){super(t),this.url=e,Zy(this,t)}toString(){return lP(this._root)}};function Zy(i,e){e.value._routerState=i,e.children.forEach(t=>Zy(i,t))}function lP(i){let e=i.children.length>0?` { ${i.children.map(lP).join(", ")} } `:"";return`${i.value}${e}`}function wy(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Vs(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),Vs(e.params,t.params)||i.paramsSubject.next(t.params),x8(e.url,t.url)||i.urlSubject.next(t.url),Vs(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function Vy(i,e){let t=Vs(i.params,e.params)&&A8(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||Vy(i.parent,e.parent))}function dP(i){return typeof i.title=="string"||i.title===null}var Yy=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=Dt,this.activateEvents=new En,this.deactivateEvents=new En,this.attachEvents=new En,this.detachEvents=new En,this.parentContexts=ve(eh),this.location=ve(va),this.changeDetector=ve(Bs),this.inputBinder=ve($m,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new qe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new qe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new qe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new qe(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Uy(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=hn({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Vi]})}}return i})(),Uy=class i{__ngOutletInjector(e){return new i(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Sa?this.route:e===eh?this.childContexts:this.parent.get(e,t)}},$m=new rt(""),HD=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:n}=t,r=il([n.queryParams,n.params,n.data]).pipe(Xi(([s,o,a],l)=>(a=ae(ae(ae({},s),o),a),l===0?lt(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(t);return}let o=sD(n.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})();function q8(i,e,t){let n=qu(i,e._root,t?t._root:void 0);return new Zm(n,e)}function qu(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=Z8(i,e,t);return new hr(n,r)}else{if(i.shouldAttach(e.value)){let s=i.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>qu(i,a)),o}}let n=Y8(e.value),r=e.children.map(s=>qu(i,s));return new hr(n,r)}}function Z8(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return qu(i,n,r);return qu(i,n)})}function Y8(i){return new Sa(new pi(i.url),new pi(i.params),new pi(i.queryParams),new pi(i.fragment),new pi(i.data),i.outlet,i.component,i)}var Zu=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},cP="ngNavigationCancelingError";function Qm(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=Al(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=uP(!1,fr.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function uP(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[cP]=!0,t.cancellationCode=e,t}function X8(i){return hP(i)&&Al(i.url)}function hP(i){return!!i&&i[cP]}var Q8=(i,e,t,n)=>St(r=>(new Hy(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),Hy=class{constructor(e,t,n,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),wy(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=Od(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Od(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(n&&n.outlet){let o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Od(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=Od(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new Ny(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Ly(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(wy(r),r===s)if(r.component){let o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),wy(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,n)}},Km=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ud=class{constructor(e,t){this.component=e,this.route=t}};function K8(i,e,t){let n=i._root,r=e?e._root:null;return Bu(n,r,t,[n.value])}function J8(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function Zd(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!PT(i)?i:e.get(i):n}function Bu(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Od(e);return i.children.forEach(o=>{$8(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>zu(a,t.getContext(o),r)),r}function $8(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=e6(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Km(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Bu(i,e,a?a.children:null,n,r):Bu(i,e,t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Ud(a.outlet.component,o))}else o&&zu(e,a,r),r.canActivateChecks.push(new Km(n)),s.component?Bu(i,null,a?a.children:null,n,r):Bu(i,null,t,n,r);return r}function e6(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!yl(i.url,e.url);case"pathParamsOrQueryParamsChange":return!yl(i.url,e.url)||!Vs(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Vy(i,e)||!Vs(i.queryParams,e.queryParams);case"paramsChange":default:return!Vy(i,e)}}function zu(i,e,t){let n=Od(i),r=i.value;Object.entries(n).forEach(([s,o])=>{r.component?e?zu(o,e.children.getContext(s),t):zu(o,null,t):zu(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ud(e.outlet.component,r)):t.canDeactivateChecks.push(new Ud(null,r)):t.canDeactivateChecks.push(new Ud(null,r))}function th(i){return typeof i=="function"}function t6(i){return typeof i=="boolean"}function n6(i){return i&&th(i.canLoad)}function i6(i){return i&&th(i.canActivate)}function r6(i){return i&&th(i.canActivateChild)}function s6(i){return i&&th(i.canDeactivate)}function o6(i){return i&&th(i.canMatch)}function fP(i){return i instanceof to||i?.name==="EmptyError"}var Om=Symbol("INITIAL_VALUE");function Wd(){return Xi(i=>il(i.map(e=>e.pipe(io(1),zx(Om)))).pipe(St(e=>{for(let t of e)if(t!==!0){if(t===Om)return Om;if(t===!1||a6(t))return t}return!0}),Yi(e=>e!==Om),io(1)))}function a6(i){return Al(i)||i instanceof Zu}function l6(i,e){return Gn(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?lt(We(ae({},t),{guardsResult:!0})):d6(o,n,r,i).pipe(Gn(a=>a&&t6(a)?c6(n,s,i,e):lt(a)),St(a=>We(ae({},t),{guardsResult:a})))})}function d6(i,e,t,n){return gn(i).pipe(Gn(r=>m6(r.component,r.route,t,e,n)),Ts(r=>r!==!0,!0))}function c6(i,e,t,n){return gn(e).pipe(no(r=>ud(h6(r.route.parent,n),u6(r.route,n),p6(i,r.path,t),f6(i,r.route,t))),Ts(r=>r!==!0,!0))}function u6(i,e){return i!==null&&e&&e(new ky(i)),lt(!0)}function h6(i,e){return i!==null&&e&&e(new Ry(i)),lt(!0)}function f6(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return lt(!0);let r=n.map(s=>lp(()=>{let o=$u(e)??t,a=Zd(s,o),l=i6(a)?a.canActivate(e,i):Dr(o,()=>a(e,i));return Ea(l).pipe(Ts())}));return lt(r).pipe(Wd())}function p6(i,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>J8(o)).filter(o=>o!==null).map(o=>lp(()=>{let a=o.guards.map(l=>{let d=$u(o.node)??t,c=Zd(l,d),u=r6(c)?c.canActivateChild(n,i):Dr(d,()=>c(n,i));return Ea(u).pipe(Ts())});return lt(a).pipe(Wd())}));return lt(s).pipe(Wd())}function m6(i,e,t,n,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return lt(!0);let o=s.map(a=>{let l=$u(e)??r,d=Zd(a,l),c=s6(d)?d.canDeactivate(i,e,t,n):Dr(l,()=>d(i,e,t,n));return Ea(c).pipe(Ts())});return lt(o).pipe(Wd())}function g6(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return lt(!0);let s=r.map(o=>{let a=Zd(o,i),l=n6(a)?a.canLoad(e,t):Dr(i,()=>a(e,t));return Ea(l)});return lt(s).pipe(Wd(),pP(n))}function pP(i){return Lx(oi(e=>{if(typeof e!="boolean")throw Qm(i,e)}),St(e=>e===!0))}function v6(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return lt(!0);let s=r.map(o=>{let a=Zd(o,i),l=o6(a)?a.canMatch(e,t):Dr(i,()=>a(e,t));return Ea(l)});return lt(s).pipe(Wd(),pP(n))}var Yu=class{constructor(e){this.segmentGroup=e||null}},Xu=class extends Error{constructor(e){super(),this.urlTree=e}};function Fd(i){return Ms(new Yu(i))}function x6(i){return Ms(new qe(4e3,!1))}function w6(i){return Ms(uP(!1,fr.GuardRejected))}var zy=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return lt(n);if(r.numberOfChildren>1||!r.children[Dt])return x6(`${e.redirectTo}`);r=r.children[Dt]}}applyRedirectCommands(e,t,n,r,s){if(typeof t!="string"){let a=t,{queryParams:l,fragment:d,routeConfig:c,url:u,outlet:h,params:f,data:p,title:x}=r,v=Dr(s,()=>a({params:f,data:p,queryParams:l,fragment:d,routeConfig:c,url:u,outlet:h,title:x}));if(v instanceof yo)throw new Xu(v);t=v}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t[0]==="/")throw new Xu(o);return o}applyRedirectCreateUrlTree(e,t,n,r){let s=this.createSegmentGroup(e,t.root,n,r);return new yo(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);n[r]=t[a]}else n[r]=s}),n}createSegmentGroup(e,t,n,r){let s=this.createSegments(e,t.segments,n,r),o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,n,r)}),new tn(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new qe(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}},jy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function b6(i,e,t,n,r){let s=mP(i,e,t);return s.matched?(n=j8(e,n),v6(n,e,t,r).pipe(St(o=>o===!0?s:ae({},jy)))):lt(s)}function mP(i,e,t){if(e.path==="**")return y6(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?ae({},jy):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||v8)(t,i,e);if(!r)return ae({},jy);let s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=r.consumed.length>0?ae(ae({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function y6(i){return{matched:!0,parameters:i.length>0?YD(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function zD(i,e,t,n){return t.length>0&&S6(i,t,n)?{segmentGroup:new tn(e,_6(n,new tn(t,i.children))),slicedSegments:[]}:t.length===0&&E6(i,t,n)?{segmentGroup:new tn(i.segments,A6(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new tn(i.segments,i.children),slicedSegments:t}}function A6(i,e,t,n){let r={};for(let s of t)if(eg(i,e,s)&&!n[cs(s)]){let o=new tn([],{});r[cs(s)]=o}return ae(ae({},n),r)}function _6(i,e){let t={};t[Dt]=e;for(let n of i)if(n.path===""&&cs(n)!==Dt){let r=new tn([],{});t[cs(n)]=r}return t}function S6(i,e,t){return t.some(n=>eg(i,e,n)&&cs(n)!==Dt)}function E6(i,e,t){return t.some(n=>eg(i,e,n))}function eg(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function C6(i,e,t){return e.length===0&&!i.children[t]}var Gy=class{};function M6(i,e,t,n,r,s,o="emptyOnly"){return new Wy(i,e,t,n,r,o,s).recognize()}var T6=31,Wy=class{constructor(e,t,n,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new zy(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new qe(4002,`'${e.segmentGroup}'`)}recognize(){let e=zD(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(St(({children:t,rootSnapshot:n})=>{let r=new hr(n,t),s=new Xm("",r),o=F8(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Vd([],Object.freeze({}),Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Dt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Dt,t).pipe(St(n=>({children:n,rootSnapshot:t})),Er(n=>{if(n instanceof Xu)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Yu?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,r,s){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,s):this.processSegment(e,t,n,n.segments,r,!0,s).pipe(St(o=>o instanceof hr?[o]:[]))}processChildren(e,t,n,r){let s=[];for(let o of Object.keys(n.children))o==="primary"?s.unshift(o):s.push(o);return gn(s).pipe(no(o=>{let a=n.children[o],l=G8(t,o);return this.processSegmentGroup(e,l,a,o,r)}),Hx((o,a)=>(o.push(...a),o)),ra(null),Ux(),Gn(o=>{if(o===null)return Fd(n);let a=gP(o);return I6(a),lt(a)}))}processSegment(e,t,n,r,s,o,a){return gn(t).pipe(no(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,n,r,s,o,a).pipe(Er(d=>{if(d instanceof Yu)return lt(null);throw d}))),Ts(l=>!!l),Er(l=>{if(fP(l))return C6(n,r,s)?lt(new Gy):Fd(n);throw l}))}processSegmentAgainstRoute(e,t,n,r,s,o,a,l){return cs(n)!==o&&(o===Dt||!eg(r,s,n))?Fd(r):n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,s,o,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,s,o,l):Fd(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o,a){let{matched:l,parameters:d,consumedSegments:c,positionalParamSegments:u,remainingSegments:h}=mP(t,r,s);if(!l)return Fd(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>T6&&(this.allowRedirects=!1));let f=new Vd(s,d,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,jD(r),cs(r),r.component??r._loadedComponent??null,r,GD(r)),p=Ym(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let x=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,u,f,e);return this.applyRedirects.lineralizeSegments(r,x).pipe(Gn(v=>this.processSegment(e,n,t,v.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,t,n,r,s,o){let a=b6(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),a.pipe(Xi(l=>l.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(Xi(({routes:d})=>{let c=n._loadedInjector??e,{parameters:u,consumedSegments:h,remainingSegments:f}=l,p=new Vd(h,u,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,jD(n),cs(n),n.component??n._loadedComponent??null,n,GD(n)),x=Ym(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(x.params),p.data=Object.freeze(x.data);let{segmentGroup:v,slicedSegments:g}=zD(t,h,f,d);if(g.length===0&&v.hasChildren())return this.processChildren(c,d,v,p).pipe(St(b=>new hr(p,b)));if(d.length===0&&g.length===0)return lt(new hr(p,[]));let y=cs(n)===s;return this.processSegment(c,d,v,g,y?Dt:s,!0,p).pipe(St(b=>new hr(p,b instanceof hr?[b]:[])))}))):Fd(t)))}getChildConfig(e,t,n){return t.children?lt({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?lt({routes:t._loadedRoutes,injector:t._loadedInjector}):g6(e,t,n,this.urlSerializer).pipe(Gn(r=>r?this.configLoader.loadChildren(e,t).pipe(oi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):w6(t))):lt({routes:[],injector:e})}};function I6(i){i.sort((e,t)=>e.value.outlet===Dt?-1:t.value.outlet===Dt?1:e.value.outlet.localeCompare(t.value.outlet))}function D6(i){let e=i.value.routeConfig;return e&&e.path===""}function gP(i){let e=[],t=new Set;for(let n of i){if(!D6(n)){e.push(n);continue}let r=e.find(s=>n.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=gP(n.children);e.push(new hr(n.value,r))}return e.filter(n=>!t.has(n))}function jD(i){return i.data||{}}function GD(i){return i.resolve||{}}function P6(i,e,t,n,r,s){return Gn(o=>M6(i,e,t,n,o.extractedUrl,r,s).pipe(St(({state:a,tree:l})=>We(ae({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function R6(i,e){return Gn(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return lt(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let d of vP(l))o.add(d);let a=0;return gn(o).pipe(no(l=>s.has(l)?L6(l,n,i,e):(l.data=Ym(l,l.parent,i).resolve,lt(void 0))),oi(()=>a++),hd(1),Gn(l=>a===o.size?lt(t):cr))})}function vP(i){let e=i.children.map(t=>vP(t)).flat();return[i,...e]}function L6(i,e,t,n){let r=i.routeConfig,s=i._resolve;return r?.title!==void 0&&!dP(r)&&(s[Ku]=r.title),k6(s,i,e,n).pipe(St(o=>(i._resolvedData=o,i.data=Ym(i,i.parent,t).resolve,null)))}function k6(i,e,t,n){let r=Ay(i);if(r.length===0)return lt({});let s={};return gn(r).pipe(Gn(o=>N6(i[o],e,t,n).pipe(Ts(),oi(a=>{if(a instanceof Zu)throw Qm(new zd,a);s[o]=a}))),hd(1),Vx(s),Er(o=>fP(o)?cr:Ms(o)))}function N6(i,e,t,n){let r=$u(e)??n,s=Zd(i,r),o=s.resolve?s.resolve(e,t):Dr(r,()=>s(e,t));return Ea(o)}function by(i){return Xi(e=>{let t=i(e);return t?gn(t).pipe(St(()=>e)):lt(e)})}var xP=(()=>{class i{buildTitle(t){let n,r=t.root;for(;r!==void 0;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===Dt);return n}getResolvedTitleForRoute(t){return t.data[Ku]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(F6),providedIn:"root"})}}return i})(),F6=(()=>{class i extends xP{constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static{this.\u0275fac=function(n){return new(n||i)(Te(FD))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),nh=new rt("",{providedIn:"root",factory:()=>({})}),O6=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=ft({type:i,selectors:[["ng-component"]],standalone:!0,features:[gt],decls:1,vars:0,template:function(n,r){n&1&&F(0,"router-outlet")},dependencies:[Yy],encapsulation:2})}}return i})();function Xy(i){let e=i.children&&i.children.map(Xy),t=e?We(ae({},i),{children:e}):ae({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Dt&&(t.component=O6),t}var Qu=new rt(""),Qy=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ve(_m)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return lt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let n=Ea(t.loadComponent()).pipe(St(wP),oi(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),rl(()=>{this.componentLoaders.delete(t)})),r=new cd(n,()=>new si).pipe(dd());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return lt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let s=B6(n,this.compiler,t,this.onLoadEndListener).pipe(rl(()=>{this.childrenLoaders.delete(n)})),o=new cd(s,()=>new si).pipe(dd());return this.childrenLoaders.set(n,o),o}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function B6(i,e,t,n){return Ea(i.loadChildren()).pipe(St(wP),Gn(r=>r instanceof gu||Array.isArray(r)?lt(r):gn(e.compileModuleAsync(r))),St(r=>{n&&n(i);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(Qu,[],{optional:!0,self:!0}).flat()),{routes:o.map(Xy),injector:s}}))}function V6(i){return i&&typeof i=="object"&&"default"in i}function wP(i){return V6(i)?i.default:i}var Ky=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(U6),providedIn:"root"})}}return i})(),U6=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),bP=new rt(""),yP=new rt("");function H6(i,e,t){let n=i.get(yP),r=i.get(li);return i.get(rn).runOutsideAngular(()=>{if(!r.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(d=>setTimeout(d));let s,o=new Promise(d=>{s=d}),a=r.startViewTransition(()=>(s(),z6(i))),{onViewTransitionCreated:l}=n;return l&&Dr(i,()=>l({transition:a,from:e,to:t})),o})}function z6(i){return new Promise(e=>{jb({read:()=>setTimeout(e)},{injector:i})})}var j6=new rt(""),Jy=(()=>{class i{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new si,this.transitionAbortSubject=new si,this.configLoader=ve(Qy),this.environmentInjector=ve(Bi),this.urlSerializer=ve(Ju),this.rootContexts=ve(eh),this.location=ve(kd),this.inputBindingEnabled=ve($m,{optional:!0})!==null,this.titleStrategy=ve(xP),this.options=ve(nh,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ve(Ky),this.createViewTransition=ve(bP,{optional:!0}),this.navigationErrorHandler=ve(j6,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>lt(void 0),this.rootComponentType=null;let t=r=>this.events.next(new Dy(r)),n=r=>this.events.next(new Py(r));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;this.transitions?.next(We(ae(ae({},this.transitions.value),t),{id:n}))}setupNavigations(t,n,r){return this.transitions=new pi({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Hu,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Yi(s=>s.id!==0),St(s=>We(ae({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Xi(s=>{let o=!1,a=!1;return lt(s).pipe(Xi(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",fr.SupersededByNewNavigation),cr;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?We(ae({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&c!=="reload"){let u="";return this.events.next(new _a(l.id,this.urlSerializer.serialize(l.rawUrl),u,jm.IgnoredSameUrlNavigation)),l.resolve(!1),cr}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return lt(l).pipe(Xi(u=>{let h=this.transitions?.getValue();return this.events.next(new jd(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?cr:Promise.resolve(u)}),P6(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),oi(u=>{s.targetSnapshot=u.targetSnapshot,s.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=We(ae({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let h=new Gm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:u,extractedUrl:h,source:f,restoredState:p,extras:x}=l,v=new jd(u,this.urlSerializer.serialize(h),f,p);this.events.next(v);let g=aP(this.rootComponentType).snapshot;return this.currentTransition=s=We(ae({},l),{targetSnapshot:g,urlAfterRedirects:h,extras:We(ae({},x),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,lt(s)}else{let u="";return this.events.next(new _a(l.id,this.urlSerializer.serialize(l.extractedUrl),u,jm.IgnoredByUrlHandlingStrategy)),l.resolve(!1),cr}}),oi(l=>{let d=new Cy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),St(l=>(this.currentTransition=s=We(ae({},l),{guards:K8(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),l6(this.environmentInjector,l=>this.events.next(l)),oi(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Qm(this.urlSerializer,l.guardsResult);let d=new My(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),Yi(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",fr.GuardRejected),!1)),by(l=>{if(l.guards.canActivateChecks.length)return lt(l).pipe(oi(d=>{let c=new Ty(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(c)}),Xi(d=>{let c=!1;return lt(d).pipe(R6(this.paramsInheritanceStrategy,this.environmentInjector),oi({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(d,"",fr.NoDataFromResolver)}}))}),oi(d=>{let c=new Iy(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(c)}))}),by(l=>{let d=c=>{let u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(oi(h=>{c.component=h}),St(()=>{})));for(let h of c.children)u.push(...d(h));return u};return il(d(l.targetSnapshot.root)).pipe(ra(null),io(1))}),by(()=>this.afterPreactivation()),Xi(()=>{let{currentSnapshot:l,targetSnapshot:d}=s,c=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return c?gn(c).pipe(St(()=>s)):lt(s)}),St(l=>{let d=q8(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=We(ae({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,s}),oi(()=>{this.events.next(new Wu)}),Q8(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),io(1),oi({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new us(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),jx(this.transitionAbortSubject.pipe(oi(l=>{throw l}))),rl(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",fr.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Er(l=>{if(a=!0,hP(l))this.events.next(new bo(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),X8(l)?this.events.next(new Gd(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let d=new Gu(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let c=Dr(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(c instanceof Zu){let{message:u,cancellationCode:h}=Qm(this.urlSerializer,c);this.events.next(new bo(s.id,this.urlSerializer.serialize(s.extractedUrl),u,h)),this.events.next(new Gd(c.redirectTo,c.navigationBehaviorOptions))}else{this.events.next(d);let u=t.errorHandler(l);s.resolve(!!u)}}catch(c){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(c)}}return cr}))}))}cancelNavigationTransition(t,n,r){let s=new bo(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function G6(i){return i!==Hu}var W6=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(q6),providedIn:"root"})}}return i})(),qy=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},q6=(()=>{class i extends qy{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),AP=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:()=>ve(Z6),providedIn:"root"})}}return i})(),Z6=(()=>{class i extends AP{constructor(){super(...arguments),this.location=ve(kd),this.urlSerializer=ve(Ju),this.options=ve(nh,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ve(Ky),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new yo,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=aP(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&t(n.url,n.state)})}handleRouterEvent(t,n){if(t instanceof jd)this.stateMemento=this.createStateMemento();else if(t instanceof _a)this.rawUrlTree=n.initialUrl;else if(t instanceof Gm){if(this.urlUpdateStrategy==="eager"&&!n.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(n.targetBrowserUrl??r,n)}}else t instanceof Wu?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(n.targetBrowserUrl??this.rawUrlTree,n)):t instanceof bo&&(t.code===fr.GuardRejected||t.code===fr.NoDataFromResolver)?this.restoreHistory(n):t instanceof Gu?this.restoreHistory(n,!0):t instanceof us&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,n){let r=t instanceof yo?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){let s=this.browserPageId,o=ae(ae({},n.extras.state),this.generateNgRouterState(n.id,s));this.location.replaceState(r,"",o)}else{let s=ae(ae({},n.extras.state),this.generateNgRouterState(n.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Vu=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(Vu||{});function _P(i,e){i.events.pipe(Yi(t=>t instanceof us||t instanceof bo||t instanceof Gu||t instanceof _a),St(t=>t instanceof us||t instanceof _a?Vu.COMPLETE:(t instanceof bo?t.code===fr.Redirect||t.code===fr.SupersededByNewNavigation:!1)?Vu.REDIRECTING:Vu.FAILED),Yi(t=>t!==Vu.REDIRECTING),io(1)).subscribe(()=>{e()})}function Y6(i){throw i}var X6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Q6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Qe=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ve(ym),this.stateManager=ve(AP),this.options=ve(nh,{optional:!0})||{},this.pendingTasks=ve(uo),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ve(Jy),this.urlSerializer=ve(Ju),this.location=ve(kd),this.urlHandlingStrategy=ve(Ky),this._events=new si,this.errorHandler=this.options.errorHandler||Y6,this.navigated=!1,this.routeReuseStrategy=ve(W6),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ve(Qu,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ve($m,{optional:!0}),this.eventsSubscription=new zn,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(n,s),n instanceof bo&&n.code!==fr.Redirect&&n.code!==fr.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof us)this.navigated=!0;else if(n instanceof Gd){let o=n.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),l=ae({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||G6(r.source)},o);this.scheduleNavigation(a,Hu,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}J6(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Hu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",n)},0)})}navigateToSyncWithBrowser(t,n,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=ae({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Xy),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,d=l?this.currentUrlTree.fragment:o,c=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":c=ae(ae({},this.currentUrlTree.queryParams),s);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=s||null}c!==null&&(c=this.removeEmptyProps(c));let u;try{let h=r?r.snapshot:this.routerState.snapshot.root;u=iP(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),u=this.currentUrlTree.root}return rP(u,t,c,d??null)}navigateByUrl(t,n={skipLocationChange:!1}){let r=Al(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Hu,null,n)}navigate(t,n={skipLocationChange:!1}){return K6(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let r;if(n===!0?r=ae({},X6):n===!1?r=ae({},Q6):r=n,Al(t))return OD(this.currentUrlTree,t,r);let s=this.parseUrl(t);return OD(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((n,[r,s])=>(s!=null&&(n[r]=s),n),{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,d;o?(a=o.resolve,l=o.reject,d=o.promise):d=new Promise((u,h)=>{a=u,l=h});let c=this.pendingTasks.add();return _P(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(c))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function K6(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new qe(4008,!1)}function J6(i){return!(i instanceof Wu)&&!(i instanceof Gd)}var qd=(()=>{class i{constructor(t,n,r,s,o,a){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.onChanges=new si,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(d=>{d instanceof us&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Al(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,n,r,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||n||r||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let n=this.href===null?null:oI(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(t,n){let r=this.renderer,s=this.el.nativeElement;n!==null?r.setAttribute(s,t,n):r.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:Al(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(n){return new(n||i)(se(Qe),se(Sa),yb("tabindex"),se(Ei),se(xi),se(vo))}}static{this.\u0275dir=hn({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,r){n&1&&H("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),n&2&&Rd("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",wa],skipLocationChange:[2,"skipLocationChange","skipLocationChange",wa],replaceUrl:[2,"replaceUrl","replaceUrl",wa],routerLink:"routerLink"},standalone:!0,features:[zb,Vi]})}}return i})(),tg=(()=>{class i{get isActive(){return this._isActive}constructor(t,n,r,s,o){this.router=t,this.element=n,this.renderer=r,this.cdr=s,this.link=o,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new En,this.routerEventsSubscription=t.events.subscribe(a=>{a instanceof us&&this.update()})}ngAfterContentInit(){lt(this.links.changes,lt(null)).pipe(ia()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(n=>!!n).map(n=>n.onChanges);this.linkInputChangesSubscription=gn(t).pipe(ia()).subscribe(n=>{this._isActive!==this.isLinkActive(this.router)(n)&&this.update()})}set routerLinkActive(t){let n=Array.isArray(t)?t:t.split(" ");this.classes=n.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(n=>{t?this.renderer.addClass(this.element.nativeElement,n):this.renderer.removeClass(this.element.nativeElement,n)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let n=$6(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let s=r.urlTree;return s?t.isActive(s,n):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static{this.\u0275fac=function(n){return new(n||i)(se(Qe),se(xi),se(Ei),se(Bs),se(qd,8))}}static{this.\u0275dir=hn({type:i,selectors:[["","routerLinkActive",""]],contentQueries:function(n,r,s){if(n&1&&KI(s,qd,5),n&2){let o;Rn(o=Ln())&&(r.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Vi]})}}return i})();function $6(i){return!!i.paths}var Jm=class{};var eU=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Yi(t=>t instanceof us),no(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){let r=[];for(let s of n){s.providers&&!s._injector&&(s._injector=xm(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return gn(r).pipe(ia())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;n.loadChildren&&n.canLoad===void 0?r=this.loader.loadChildren(t,n):r=lt(null);let s=r.pipe(Gn(o=>o===null?lt(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(n.loadComponent&&!n._loadedComponent){let o=this.loader.loadComponent(n);return gn([s,o]).pipe(ia())}else return s})}static{this.\u0275fac=function(n){return new(n||i)(Te(Qe),Te(_m),Te(Bi),Te(Jm),Te(Qy))}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),SP=new rt(""),tU=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof jd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof us?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof _a&&t.code===jm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Wm&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Wm(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(n){bI()}}static{this.\u0275prov=Ee({token:i,factory:i.\u0275fac})}}return i})();function EP(i,...e){return yu([{provide:Qu,multi:!0,useValue:i},[],{provide:Sa,useFactory:CP,deps:[Qe]},{provide:Tu,multi:!0,useFactory:MP},e.map(t=>t.\u0275providers)])}function CP(i){return i.routerState.root}function ih(i,e){return{\u0275kind:i,\u0275providers:e}}function MP(){let i=ve(Ir);return e=>{let t=i.get(xa);if(e!==t.components[0])return;let n=i.get(Qe),r=i.get(TP);i.get($y)===1&&n.initialNavigation(),i.get(IP,null,Ft.Optional)?.setUpPreloading(),i.get(SP,null,Ft.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var TP=new rt("",{factory:()=>new si}),$y=new rt("",{providedIn:"root",factory:()=>1});function nU(){return ih(2,[{provide:$y,useValue:0},{provide:Am,multi:!0,deps:[Ir],useFactory:e=>{let t=e.get(fD,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let r=e.get(Qe),s=e.get(TP);_P(r,()=>{n(!0)}),e.get(Jy).afterPreactivation=()=>(n(!0),s.closed?lt(void 0):s),r.initialNavigation()}))}}])}function iU(){return ih(3,[{provide:Am,multi:!0,useFactory:()=>{let e=ve(Qe);return()=>{e.setUpLocationChangeListener()}}},{provide:$y,useValue:2}])}var IP=new rt("");function rU(i){return ih(0,[{provide:IP,useExisting:eU},{provide:Jm,useExisting:i}])}function sU(){return ih(8,[HD,{provide:$m,useExisting:HD}])}function oU(i){let e=[{provide:bP,useValue:H6},{provide:yP,useValue:ae({skipNextTransition:!!i?.skipInitialTransition},i)}];return ih(9,e)}var WD=new rt("ROUTER_FORROOT_GUARD"),aU=[kd,{provide:Ju,useClass:zd},Qe,eh,{provide:Sa,useFactory:CP,deps:[Qe]},Qy,[]],rh=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[aU,[],{provide:Qu,multi:!0,useValue:t},{provide:WD,useFactory:uU,deps:[[Qe,new Kp,new lb]]},{provide:nh,useValue:n||{}},n?.useHash?dU():cU(),lU(),n?.preloadingStrategy?rU(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?hU(n):[],n?.bindToComponentInputs?sU().\u0275providers:[],n?.enableViewTransitions?oU().\u0275providers:[],fU()]}}static forChild(t){return{ngModule:i,providers:[{provide:Qu,multi:!0,useValue:t}]}}static{this.\u0275fac=function(n){return new(n||i)(Te(WD,8))}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})();function lU(){return{provide:SP,useFactory:()=>{let i=ve(vD),e=ve(rn),t=ve(nh),n=ve(Jy),r=ve(Ju);return t.scrollOffset&&i.setOffset(t.scrollOffset),new tU(r,n,i,e,t)}}}function dU(){return{provide:vo,useClass:mD}}function cU(){return{provide:vo,useClass:iy}}function uU(i){return"guarded"}function hU(i){return[i.initialNavigation==="disabled"?iU().\u0275providers:[],i.initialNavigation==="enabledBlocking"?nU().\u0275providers:[]]}var qD=new rt("");function fU(){return[{provide:qD,useFactory:MP},{provide:Tu,multi:!0,useExisting:qD}]}function DP(i){return i!==null&&typeof i=="object"&&"constructor"in i&&i.constructor===Object}function e1(i,e){i===void 0&&(i={}),e===void 0&&(e={}),Object.keys(e).forEach(t=>{typeof i[t]>"u"?i[t]=e[t]:DP(e[t])&&DP(i[t])&&Object.keys(e[t]).length>0&&e1(i[t],e[t])})}var PP={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function zi(){let i=typeof document<"u"?document:{};return e1(i,PP),i}var pU={document:PP,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(i){return typeof setTimeout>"u"?(i(),null):setTimeout(i,0)},cancelAnimationFrame(i){typeof setTimeout>"u"||clearTimeout(i)}};function Zn(){let i=typeof window<"u"?window:{};return e1(i,pU),i}function RP(i){return i===void 0&&(i=""),i.trim().split(" ").filter(e=>!!e.trim())}function LP(i){let e=i;Object.keys(e).forEach(t=>{try{e[t]=null}catch{}try{delete e[t]}catch{}})}function _l(i,e){return e===void 0&&(e=0),setTimeout(i,e)}function Sl(){return Date.now()}function mU(i){let e=Zn(),t;return e.getComputedStyle&&(t=e.getComputedStyle(i,null)),!t&&i.currentStyle&&(t=i.currentStyle),t||(t=i.style),t}function t1(i,e){e===void 0&&(e="x");let t=Zn(),n,r,s,o=mU(i);return t.WebKitCSSMatrix?(r=o.transform||o.webkitTransform,r.split(",").length>6&&(r=r.split(", ").map(a=>a.replace(",",".")).join(", ")),s=new t.WebKitCSSMatrix(r==="none"?"":r)):(s=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=s.toString().split(",")),e==="x"&&(t.WebKitCSSMatrix?r=s.m41:n.length===16?r=parseFloat(n[12]):r=parseFloat(n[4])),e==="y"&&(t.WebKitCSSMatrix?r=s.m42:n.length===16?r=parseFloat(n[13]):r=parseFloat(n[5])),r||0}function sh(i){return typeof i=="object"&&i!==null&&i.constructor&&Object.prototype.toString.call(i).slice(8,-1)==="Object"}function gU(i){return typeof window<"u"&&typeof window.HTMLElement<"u"?i instanceof HTMLElement:i&&(i.nodeType===1||i.nodeType===11)}function $i(){let i=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let t=1;t<arguments.length;t+=1){let n=t<0||arguments.length<=t?void 0:arguments[t];if(n!=null&&!gU(n)){let r=Object.keys(Object(n)).filter(s=>e.indexOf(s)<0);for(let s=0,o=r.length;s<o;s+=1){let a=r[s],l=Object.getOwnPropertyDescriptor(n,a);l!==void 0&&l.enumerable&&(sh(i[a])&&sh(n[a])?n[a].__swiper__?i[a]=n[a]:$i(i[a],n[a]):!sh(i[a])&&sh(n[a])?(i[a]={},n[a].__swiper__?i[a]=n[a]:$i(i[a],n[a])):i[a]=n[a])}}}return i}function Yd(i,e,t){i.style.setProperty(e,t)}function n1(i){let{swiper:e,targetPosition:t,side:n}=i,r=Zn(),s=-e.translate,o=null,a,l=e.params.speed;e.wrapperEl.style.scrollSnapType="none",r.cancelAnimationFrame(e.cssModeFrameID);let d=t>s?"next":"prev",c=(h,f)=>d==="next"&&h>=f||d==="prev"&&h<=f,u=()=>{a=new Date().getTime(),o===null&&(o=a);let h=Math.max(Math.min((a-o)/l,1),0),f=.5-Math.cos(h*Math.PI)/2,p=s+f*(t-s);if(c(p,t)&&(p=t),e.wrapperEl.scrollTo({[n]:p}),c(p,t)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[n]:p})}),r.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=r.requestAnimationFrame(u)};u()}function wi(i,e){e===void 0&&(e="");let t=[...i.children];return i instanceof HTMLSlotElement&&t.push(...i.assignedElements()),e?t.filter(n=>n.matches(e)):t}function kP(i,e){let t=e.contains(i);return!t&&e instanceof HTMLSlotElement?[...e.assignedElements()].includes(i):t}function oh(i){try{console.warn(i);return}catch{}}function hs(i,e){e===void 0&&(e=[]);let t=document.createElement(i);return t.classList.add(...Array.isArray(e)?e:RP(e)),t}function NP(i,e){let t=[];for(;i.previousElementSibling;){let n=i.previousElementSibling;e?n.matches(e)&&t.push(n):t.push(n),i=n}return t}function FP(i,e){let t=[];for(;i.nextElementSibling;){let n=i.nextElementSibling;e?n.matches(e)&&t.push(n):t.push(n),i=n}return t}function Ao(i,e){return Zn().getComputedStyle(i,null).getPropertyValue(e)}function El(i){let e=i,t;if(e){for(t=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(t+=1);return t}}function Xd(i,e){let t=[],n=i.parentElement;for(;n;)e?n.matches(e)&&t.push(n):t.push(n),n=n.parentElement;return t}function ah(i,e,t){let n=Zn();return t?i[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(n.getComputedStyle(i,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(n.getComputedStyle(i,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom")):i.offsetWidth}function Nn(i){return(Array.isArray(i)?i:[i]).filter(e=>!!e)}var i1;function vU(){let i=Zn(),e=zi();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in i||i.DocumentTouch&&e instanceof i.DocumentTouch)}}function zP(){return i1||(i1=vU()),i1}var r1;function xU(i){let{userAgent:e}=i===void 0?{}:i,t=zP(),n=Zn(),r=n.navigator.platform,s=e||n.navigator.userAgent,o={ios:!1,android:!1},a=n.screen.width,l=n.screen.height,d=s.match(/(Android);?[\s\/]+([\d.]+)?/),c=s.match(/(iPad).*OS\s([\d_]+)/),u=s.match(/(iPod)(.*OS\s([\d_]+))?/),h=!c&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),f=r==="Win32",p=r==="MacIntel",x=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!c&&p&&t.touch&&x.indexOf(`${a}x${l}`)>=0&&(c=s.match(/(Version)\/([\d.]+)/),c||(c=[0,1,"13_0_0"]),p=!1),d&&!f&&(o.os="android",o.android=!0),(c||h||u)&&(o.os="ios",o.ios=!0),o}function jP(i){return i===void 0&&(i={}),r1||(r1=xU(i)),r1}var s1;function wU(){let i=Zn(),e=jP(),t=!1;function n(){let a=i.navigator.userAgent.toLowerCase();return a.indexOf("safari")>=0&&a.indexOf("chrome")<0&&a.indexOf("android")<0}if(n()){let a=String(i.navigator.userAgent);if(a.includes("Version/")){let[l,d]=a.split("Version/")[1].split(" ")[0].split(".").map(c=>Number(c));t=l<16||l===16&&d<2}}let r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(i.navigator.userAgent),s=n(),o=s||r&&e.ios;return{isSafari:t||s,needPerspectiveFix:t,need3dFix:o,isWebView:r}}function bU(){return s1||(s1=wU()),s1}function yU(i){let{swiper:e,on:t,emit:n}=i,r=Zn(),s=null,o=null,a=()=>{!e||e.destroyed||!e.initialized||(n("beforeResize"),n("resize"))},l=()=>{!e||e.destroyed||!e.initialized||(s=new ResizeObserver(u=>{o=r.requestAnimationFrame(()=>{let{width:h,height:f}=e,p=h,x=f;u.forEach(v=>{let{contentBoxSize:g,contentRect:y,target:b}=v;b&&b!==e.el||(p=y?y.width:(g[0]||g).inlineSize,x=y?y.height:(g[0]||g).blockSize)}),(p!==h||x!==f)&&a()})}),s.observe(e.el))},d=()=>{o&&r.cancelAnimationFrame(o),s&&s.unobserve&&e.el&&(s.unobserve(e.el),s=null)},c=()=>{!e||e.destroyed||!e.initialized||n("orientationchange")};t("init",()=>{if(e.params.resizeObserver&&typeof r.ResizeObserver<"u"){l();return}r.addEventListener("resize",a),r.addEventListener("orientationchange",c)}),t("destroy",()=>{d(),r.removeEventListener("resize",a),r.removeEventListener("orientationchange",c)})}function AU(i){let{swiper:e,extendParams:t,on:n,emit:r}=i,s=[],o=Zn(),a=function(c,u){u===void 0&&(u={});let h=o.MutationObserver||o.WebkitMutationObserver,f=new h(p=>{if(e.__preventObserver__)return;if(p.length===1){r("observerUpdate",p[0]);return}let x=function(){r("observerUpdate",p[0])};o.requestAnimationFrame?o.requestAnimationFrame(x):o.setTimeout(x,0)});f.observe(c,{attributes:typeof u.attributes>"u"?!0:u.attributes,childList:e.isElement||(typeof u.childList>"u"?!0:u).childList,characterData:typeof u.characterData>"u"?!0:u.characterData}),s.push(f)},l=()=>{if(e.params.observer){if(e.params.observeParents){let c=Xd(e.hostEl);for(let u=0;u<c.length;u+=1)a(c[u])}a(e.hostEl,{childList:e.params.observeSlideChildren}),a(e.wrapperEl,{attributes:!1})}},d=()=>{s.forEach(c=>{c.disconnect()}),s.splice(0,s.length)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),n("init",l),n("destroy",d)}var _U={on(i,e,t){let n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;let r=t?"unshift":"push";return i.split(" ").forEach(s=>{n.eventsListeners[s]||(n.eventsListeners[s]=[]),n.eventsListeners[s][r](e)}),n},once(i,e,t){let n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;function r(){n.off(i,r),r.__emitterProxy&&delete r.__emitterProxy;for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];e.apply(n,o)}return r.__emitterProxy=e,n.on(i,r,t)},onAny(i,e){let t=this;if(!t.eventsListeners||t.destroyed||typeof i!="function")return t;let n=e?"unshift":"push";return t.eventsAnyListeners.indexOf(i)<0&&t.eventsAnyListeners[n](i),t},offAny(i){let e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;let t=e.eventsAnyListeners.indexOf(i);return t>=0&&e.eventsAnyListeners.splice(t,1),e},off(i,e){let t=this;return!t.eventsListeners||t.destroyed||!t.eventsListeners||i.split(" ").forEach(n=>{typeof e>"u"?t.eventsListeners[n]=[]:t.eventsListeners[n]&&t.eventsListeners[n].forEach((r,s)=>{(r===e||r.__emitterProxy&&r.__emitterProxy===e)&&t.eventsListeners[n].splice(s,1)})}),t},emit(){let i=this;if(!i.eventsListeners||i.destroyed||!i.eventsListeners)return i;let e,t,n;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return typeof s[0]=="string"||Array.isArray(s[0])?(e=s[0],t=s.slice(1,s.length),n=i):(e=s[0].events,t=s[0].data,n=s[0].context||i),t.unshift(n),(Array.isArray(e)?e:e.split(" ")).forEach(l=>{i.eventsAnyListeners&&i.eventsAnyListeners.length&&i.eventsAnyListeners.forEach(d=>{d.apply(n,[l,...t])}),i.eventsListeners&&i.eventsListeners[l]&&i.eventsListeners[l].forEach(d=>{d.apply(n,t)})}),i}};function SU(){let i=this,e,t,n=i.el;typeof i.params.width<"u"&&i.params.width!==null?e=i.params.width:e=n.clientWidth,typeof i.params.height<"u"&&i.params.height!==null?t=i.params.height:t=n.clientHeight,!(e===0&&i.isHorizontal()||t===0&&i.isVertical())&&(e=e-parseInt(Ao(n,"padding-left")||0,10)-parseInt(Ao(n,"padding-right")||0,10),t=t-parseInt(Ao(n,"padding-top")||0,10)-parseInt(Ao(n,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(t)&&(t=0),Object.assign(i,{width:e,height:t,size:i.isHorizontal()?e:t}))}function EU(){let i=this;function e(S,P){return parseFloat(S.getPropertyValue(i.getDirectionLabel(P))||0)}let t=i.params,{wrapperEl:n,slidesEl:r,size:s,rtlTranslate:o,wrongRTL:a}=i,l=i.virtual&&t.virtual.enabled,d=l?i.virtual.slides.length:i.slides.length,c=wi(r,`.${i.params.slideClass}, swiper-slide`),u=l?i.virtual.slides.length:c.length,h=[],f=[],p=[],x=t.slidesOffsetBefore;typeof x=="function"&&(x=t.slidesOffsetBefore.call(i));let v=t.slidesOffsetAfter;typeof v=="function"&&(v=t.slidesOffsetAfter.call(i));let g=i.snapGrid.length,y=i.slidesGrid.length,b=t.spaceBetween,A=-x,M=0,T=0;if(typeof s>"u")return;typeof b=="string"&&b.indexOf("%")>=0?b=parseFloat(b.replace("%",""))/100*s:typeof b=="string"&&(b=parseFloat(b)),i.virtualSize=-b,c.forEach(S=>{o?S.style.marginLeft="":S.style.marginRight="",S.style.marginBottom="",S.style.marginTop=""}),t.centeredSlides&&t.cssMode&&(Yd(n,"--swiper-centered-offset-before",""),Yd(n,"--swiper-centered-offset-after",""));let I=t.grid&&t.grid.rows>1&&i.grid;I?i.grid.initSlides(c):i.grid&&i.grid.unsetSlides();let L,E=t.slidesPerView==="auto"&&t.breakpoints&&Object.keys(t.breakpoints).filter(S=>typeof t.breakpoints[S].slidesPerView<"u").length>0;for(let S=0;S<u;S+=1){L=0;let P;if(c[S]&&(P=c[S]),I&&i.grid.updateSlide(S,P,c),!(c[S]&&Ao(P,"display")==="none")){if(t.slidesPerView==="auto"){E&&(c[S].style[i.getDirectionLabel("width")]="");let j=getComputedStyle(P),B=P.style.transform,z=P.style.webkitTransform;if(B&&(P.style.transform="none"),z&&(P.style.webkitTransform="none"),t.roundLengths)L=i.isHorizontal()?ah(P,"width",!0):ah(P,"height",!0);else{let X=e(j,"width"),Q=e(j,"padding-left"),K=e(j,"padding-right"),Y=e(j,"margin-left"),Ae=e(j,"margin-right"),Ce=j.getPropertyValue("box-sizing");if(Ce&&Ce==="border-box")L=X+Y+Ae;else{let{clientWidth:Ie,offsetWidth:He}=P;L=X+Q+K+Y+Ae+(He-Ie)}}B&&(P.style.transform=B),z&&(P.style.webkitTransform=z),t.roundLengths&&(L=Math.floor(L))}else L=(s-(t.slidesPerView-1)*b)/t.slidesPerView,t.roundLengths&&(L=Math.floor(L)),c[S]&&(c[S].style[i.getDirectionLabel("width")]=`${L}px`);c[S]&&(c[S].swiperSlideSize=L),p.push(L),t.centeredSlides?(A=A+L/2+M/2+b,M===0&&S!==0&&(A=A-s/2-b),S===0&&(A=A-s/2-b),Math.abs(A)<1/1e3&&(A=0),t.roundLengths&&(A=Math.floor(A)),T%t.slidesPerGroup===0&&h.push(A),f.push(A)):(t.roundLengths&&(A=Math.floor(A)),(T-Math.min(i.params.slidesPerGroupSkip,T))%i.params.slidesPerGroup===0&&h.push(A),f.push(A),A=A+L+b),i.virtualSize+=L+b,M=L,T+=1}}if(i.virtualSize=Math.max(i.virtualSize,s)+v,o&&a&&(t.effect==="slide"||t.effect==="coverflow")&&(n.style.width=`${i.virtualSize+b}px`),t.setWrapperSize&&(n.style[i.getDirectionLabel("width")]=`${i.virtualSize+b}px`),I&&i.grid.updateWrapperSize(L,h),!t.centeredSlides){let S=[];for(let P=0;P<h.length;P+=1){let j=h[P];t.roundLengths&&(j=Math.floor(j)),h[P]<=i.virtualSize-s&&S.push(j)}h=S,Math.floor(i.virtualSize-s)-Math.floor(h[h.length-1])>1&&h.push(i.virtualSize-s)}if(l&&t.loop){let S=p[0]+b;if(t.slidesPerGroup>1){let P=Math.ceil((i.virtual.slidesBefore+i.virtual.slidesAfter)/t.slidesPerGroup),j=S*t.slidesPerGroup;for(let B=0;B<P;B+=1)h.push(h[h.length-1]+j)}for(let P=0;P<i.virtual.slidesBefore+i.virtual.slidesAfter;P+=1)t.slidesPerGroup===1&&h.push(h[h.length-1]+S),f.push(f[f.length-1]+S),i.virtualSize+=S}if(h.length===0&&(h=[0]),b!==0){let S=i.isHorizontal()&&o?"marginLeft":i.getDirectionLabel("marginRight");c.filter((P,j)=>!t.cssMode||t.loop?!0:j!==c.length-1).forEach(P=>{P.style[S]=`${b}px`})}if(t.centeredSlides&&t.centeredSlidesBounds){let S=0;p.forEach(j=>{S+=j+(b||0)}),S-=b;let P=S>s?S-s:0;h=h.map(j=>j<=0?-x:j>P?P+v:j)}if(t.centerInsufficientSlides){let S=0;p.forEach(j=>{S+=j+(b||0)}),S-=b;let P=(t.slidesOffsetBefore||0)+(t.slidesOffsetAfter||0);if(S+P<s){let j=(s-S-P)/2;h.forEach((B,z)=>{h[z]=B-j}),f.forEach((B,z)=>{f[z]=B+j})}}if(Object.assign(i,{slides:c,snapGrid:h,slidesGrid:f,slidesSizesGrid:p}),t.centeredSlides&&t.cssMode&&!t.centeredSlidesBounds){Yd(n,"--swiper-centered-offset-before",`${-h[0]}px`),Yd(n,"--swiper-centered-offset-after",`${i.size/2-p[p.length-1]/2}px`);let S=-i.snapGrid[0],P=-i.slidesGrid[0];i.snapGrid=i.snapGrid.map(j=>j+S),i.slidesGrid=i.slidesGrid.map(j=>j+P)}if(u!==d&&i.emit("slidesLengthChange"),h.length!==g&&(i.params.watchOverflow&&i.checkOverflow(),i.emit("snapGridLengthChange")),f.length!==y&&i.emit("slidesGridLengthChange"),t.watchSlidesProgress&&i.updateSlidesOffset(),i.emit("slidesUpdated"),!l&&!t.cssMode&&(t.effect==="slide"||t.effect==="fade")){let S=`${t.containerModifierClass}backface-hidden`,P=i.el.classList.contains(S);u<=t.maxBackfaceHiddenSlides?P||i.el.classList.add(S):P&&i.el.classList.remove(S)}}function CU(i){let e=this,t=[],n=e.virtual&&e.params.virtual.enabled,r=0,s;typeof i=="number"?e.setTransition(i):i===!0&&e.setTransition(e.params.speed);let o=a=>n?e.slides[e.getSlideIndexByData(a)]:e.slides[a];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(a=>{t.push(a)});else for(s=0;s<Math.ceil(e.params.slidesPerView);s+=1){let a=e.activeIndex+s;if(a>e.slides.length&&!n)break;t.push(o(a))}else t.push(o(e.activeIndex));for(s=0;s<t.length;s+=1)if(typeof t[s]<"u"){let a=t[s].offsetHeight;r=a>r?a:r}(r||r===0)&&(e.wrapperEl.style.height=`${r}px`)}function MU(){let i=this,e=i.slides,t=i.isElement?i.isHorizontal()?i.wrapperEl.offsetLeft:i.wrapperEl.offsetTop:0;for(let n=0;n<e.length;n+=1)e[n].swiperSlideOffset=(i.isHorizontal()?e[n].offsetLeft:e[n].offsetTop)-t-i.cssOverflowAdjustment()}var OP=(i,e,t)=>{e&&!i.classList.contains(t)?i.classList.add(t):!e&&i.classList.contains(t)&&i.classList.remove(t)};function TU(i){i===void 0&&(i=this&&this.translate||0);let e=this,t=e.params,{slides:n,rtlTranslate:r,snapGrid:s}=e;if(n.length===0)return;typeof n[0].swiperSlideOffset>"u"&&e.updateSlidesOffset();let o=-i;r&&(o=i),e.visibleSlidesIndexes=[],e.visibleSlides=[];let a=t.spaceBetween;typeof a=="string"&&a.indexOf("%")>=0?a=parseFloat(a.replace("%",""))/100*e.size:typeof a=="string"&&(a=parseFloat(a));for(let l=0;l<n.length;l+=1){let d=n[l],c=d.swiperSlideOffset;t.cssMode&&t.centeredSlides&&(c-=n[0].swiperSlideOffset);let u=(o+(t.centeredSlides?e.minTranslate():0)-c)/(d.swiperSlideSize+a),h=(o-s[0]+(t.centeredSlides?e.minTranslate():0)-c)/(d.swiperSlideSize+a),f=-(o-c),p=f+e.slidesSizesGrid[l],x=f>=0&&f<=e.size-e.slidesSizesGrid[l],v=f>=0&&f<e.size-1||p>1&&p<=e.size||f<=0&&p>=e.size;v&&(e.visibleSlides.push(d),e.visibleSlidesIndexes.push(l)),OP(d,v,t.slideVisibleClass),OP(d,x,t.slideFullyVisibleClass),d.progress=r?-u:u,d.originalProgress=r?-h:h}}function IU(i){let e=this;if(typeof i>"u"){let c=e.rtlTranslate?-1:1;i=e&&e.translate&&e.translate*c||0}let t=e.params,n=e.maxTranslate()-e.minTranslate(),{progress:r,isBeginning:s,isEnd:o,progressLoop:a}=e,l=s,d=o;if(n===0)r=0,s=!0,o=!0;else{r=(i-e.minTranslate())/n;let c=Math.abs(i-e.minTranslate())<1,u=Math.abs(i-e.maxTranslate())<1;s=c||r<=0,o=u||r>=1,c&&(r=0),u&&(r=1)}if(t.loop){let c=e.getSlideIndexByData(0),u=e.getSlideIndexByData(e.slides.length-1),h=e.slidesGrid[c],f=e.slidesGrid[u],p=e.slidesGrid[e.slidesGrid.length-1],x=Math.abs(i);x>=h?a=(x-h)/p:a=(x+p-f)/p,a>1&&(a-=1)}Object.assign(e,{progress:r,progressLoop:a,isBeginning:s,isEnd:o}),(t.watchSlidesProgress||t.centeredSlides&&t.autoHeight)&&e.updateSlidesProgress(i),s&&!l&&e.emit("reachBeginning toEdge"),o&&!d&&e.emit("reachEnd toEdge"),(l&&!s||d&&!o)&&e.emit("fromEdge"),e.emit("progress",r)}var o1=(i,e,t)=>{e&&!i.classList.contains(t)?i.classList.add(t):!e&&i.classList.contains(t)&&i.classList.remove(t)};function DU(){let i=this,{slides:e,params:t,slidesEl:n,activeIndex:r}=i,s=i.virtual&&t.virtual.enabled,o=i.grid&&t.grid&&t.grid.rows>1,a=u=>wi(n,`.${t.slideClass}${u}, swiper-slide${u}`)[0],l,d,c;if(s)if(t.loop){let u=r-i.virtual.slidesBefore;u<0&&(u=i.virtual.slides.length+u),u>=i.virtual.slides.length&&(u-=i.virtual.slides.length),l=a(`[data-swiper-slide-index="${u}"]`)}else l=a(`[data-swiper-slide-index="${r}"]`);else o?(l=e.filter(u=>u.column===r)[0],c=e.filter(u=>u.column===r+1)[0],d=e.filter(u=>u.column===r-1)[0]):l=e[r];l&&(o||(c=FP(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!c&&(c=e[0]),d=NP(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!d===0&&(d=e[e.length-1]))),e.forEach(u=>{o1(u,u===l,t.slideActiveClass),o1(u,u===c,t.slideNextClass),o1(u,u===d,t.slidePrevClass)}),i.emitSlidesClasses()}var ng=(i,e)=>{if(!i||i.destroyed||!i.params)return;let t=()=>i.isElement?"swiper-slide":`.${i.params.slideClass}`,n=e.closest(t());if(n){let r=n.querySelector(`.${i.params.lazyPreloaderClass}`);!r&&i.isElement&&(n.shadowRoot?r=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{n.shadowRoot&&(r=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`),r&&r.remove())})),r&&r.remove()}},a1=(i,e)=>{if(!i.slides[e])return;let t=i.slides[e].querySelector('[loading="lazy"]');t&&t.removeAttribute("loading")},c1=i=>{if(!i||i.destroyed||!i.params)return;let e=i.params.lazyPreloadPrevNext,t=i.slides.length;if(!t||!e||e<0)return;e=Math.min(e,t);let n=i.params.slidesPerView==="auto"?i.slidesPerViewDynamic():Math.ceil(i.params.slidesPerView),r=i.activeIndex;if(i.params.grid&&i.params.grid.rows>1){let o=r,a=[o-e];a.push(...Array.from({length:e}).map((l,d)=>o+n+d)),i.slides.forEach((l,d)=>{a.includes(l.column)&&a1(i,d)});return}let s=r+n-1;if(i.params.rewind||i.params.loop)for(let o=r-e;o<=s+e;o+=1){let a=(o%t+t)%t;(a<r||a>s)&&a1(i,a)}else for(let o=Math.max(r-e,0);o<=Math.min(s+e,t-1);o+=1)o!==r&&(o>s||o<r)&&a1(i,o)};function PU(i){let{slidesGrid:e,params:t}=i,n=i.rtlTranslate?i.translate:-i.translate,r;for(let s=0;s<e.length;s+=1)typeof e[s+1]<"u"?n>=e[s]&&n<e[s+1]-(e[s+1]-e[s])/2?r=s:n>=e[s]&&n<e[s+1]&&(r=s+1):n>=e[s]&&(r=s);return t.normalizeSlideIndex&&(r<0||typeof r>"u")&&(r=0),r}function RU(i){let e=this,t=e.rtlTranslate?e.translate:-e.translate,{snapGrid:n,params:r,activeIndex:s,realIndex:o,snapIndex:a}=e,l=i,d,c=f=>{let p=f-e.virtual.slidesBefore;return p<0&&(p=e.virtual.slides.length+p),p>=e.virtual.slides.length&&(p-=e.virtual.slides.length),p};if(typeof l>"u"&&(l=PU(e)),n.indexOf(t)>=0)d=n.indexOf(t);else{let f=Math.min(r.slidesPerGroupSkip,l);d=f+Math.floor((l-f)/r.slidesPerGroup)}if(d>=n.length&&(d=n.length-1),l===s&&!e.params.loop){d!==a&&(e.snapIndex=d,e.emit("snapIndexChange"));return}if(l===s&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=c(l);return}let u=e.grid&&r.grid&&r.grid.rows>1,h;if(e.virtual&&r.virtual.enabled&&r.loop)h=c(l);else if(u){let f=e.slides.filter(x=>x.column===l)[0],p=parseInt(f.getAttribute("data-swiper-slide-index"),10);Number.isNaN(p)&&(p=Math.max(e.slides.indexOf(f),0)),h=Math.floor(p/r.grid.rows)}else if(e.slides[l]){let f=e.slides[l].getAttribute("data-swiper-slide-index");f?h=parseInt(f,10):h=l}else h=l;Object.assign(e,{previousSnapIndex:a,snapIndex:d,previousRealIndex:o,realIndex:h,previousIndex:s,activeIndex:l}),e.initialized&&c1(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(o!==h&&e.emit("realIndexChange"),e.emit("slideChange"))}function LU(i,e){let t=this,n=t.params,r=i.closest(`.${n.slideClass}, swiper-slide`);!r&&t.isElement&&e&&e.length>1&&e.includes(i)&&[...e.slice(e.indexOf(i)+1,e.length)].forEach(a=>{!r&&a.matches&&a.matches(`.${n.slideClass}, swiper-slide`)&&(r=a)});let s=!1,o;if(r){for(let a=0;a<t.slides.length;a+=1)if(t.slides[a]===r){s=!0,o=a;break}}if(r&&s)t.clickedSlide=r,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(r.getAttribute("data-swiper-slide-index"),10):t.clickedIndex=o;else{t.clickedSlide=void 0,t.clickedIndex=void 0;return}n.slideToClickedSlide&&t.clickedIndex!==void 0&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}var kU={updateSize:SU,updateSlides:EU,updateAutoHeight:CU,updateSlidesOffset:MU,updateSlidesProgress:TU,updateProgress:IU,updateSlidesClasses:DU,updateActiveIndex:RU,updateClickedSlide:LU};function NU(i){i===void 0&&(i=this.isHorizontal()?"x":"y");let e=this,{params:t,rtlTranslate:n,translate:r,wrapperEl:s}=e;if(t.virtualTranslate)return n?-r:r;if(t.cssMode)return r;let o=t1(s,i);return o+=e.cssOverflowAdjustment(),n&&(o=-o),o||0}function FU(i,e){let t=this,{rtlTranslate:n,params:r,wrapperEl:s,progress:o}=t,a=0,l=0,d=0;t.isHorizontal()?a=n?-i:i:l=i,r.roundLengths&&(a=Math.floor(a),l=Math.floor(l)),t.previousTranslate=t.translate,t.translate=t.isHorizontal()?a:l,r.cssMode?s[t.isHorizontal()?"scrollLeft":"scrollTop"]=t.isHorizontal()?-a:-l:r.virtualTranslate||(t.isHorizontal()?a-=t.cssOverflowAdjustment():l-=t.cssOverflowAdjustment(),s.style.transform=`translate3d(${a}px, ${l}px, ${d}px)`);let c,u=t.maxTranslate()-t.minTranslate();u===0?c=0:c=(i-t.minTranslate())/u,c!==o&&t.updateProgress(i),t.emit("setTranslate",t.translate,e)}function OU(){return-this.snapGrid[0]}function BU(){return-this.snapGrid[this.snapGrid.length-1]}function VU(i,e,t,n,r){i===void 0&&(i=0),e===void 0&&(e=this.params.speed),t===void 0&&(t=!0),n===void 0&&(n=!0);let s=this,{params:o,wrapperEl:a}=s;if(s.animating&&o.preventInteractionOnTransition)return!1;let l=s.minTranslate(),d=s.maxTranslate(),c;if(n&&i>l?c=l:n&&i<d?c=d:c=i,s.updateProgress(c),o.cssMode){let u=s.isHorizontal();if(e===0)a[u?"scrollLeft":"scrollTop"]=-c;else{if(!s.support.smoothScroll)return n1({swiper:s,targetPosition:-c,side:u?"left":"top"}),!0;a.scrollTo({[u?"left":"top"]:-c,behavior:"smooth"})}return!0}return e===0?(s.setTransition(0),s.setTranslate(c),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionEnd"))):(s.setTransition(e),s.setTranslate(c),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(h){!s||s.destroyed||h.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,t&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}var UU={getTranslate:NU,setTranslate:FU,minTranslate:OU,maxTranslate:BU,translateTo:VU};function HU(i,e){let t=this;t.params.cssMode||(t.wrapperEl.style.transitionDuration=`${i}ms`,t.wrapperEl.style.transitionDelay=i===0?"0ms":""),t.emit("setTransition",i,e)}function GP(i){let{swiper:e,runCallbacks:t,direction:n,step:r}=i,{activeIndex:s,previousIndex:o}=e,a=n;if(a||(s>o?a="next":s<o?a="prev":a="reset"),e.emit(`transition${r}`),t&&s!==o){if(a==="reset"){e.emit(`slideResetTransition${r}`);return}e.emit(`slideChangeTransition${r}`),a==="next"?e.emit(`slideNextTransition${r}`):e.emit(`slidePrevTransition${r}`)}}function zU(i,e){i===void 0&&(i=!0);let t=this,{params:n}=t;n.cssMode||(n.autoHeight&&t.updateAutoHeight(),GP({swiper:t,runCallbacks:i,direction:e,step:"Start"}))}function jU(i,e){i===void 0&&(i=!0);let t=this,{params:n}=t;t.animating=!1,!n.cssMode&&(t.setTransition(0),GP({swiper:t,runCallbacks:i,direction:e,step:"End"}))}var GU={setTransition:HU,transitionStart:zU,transitionEnd:jU};function WU(i,e,t,n,r){i===void 0&&(i=0),t===void 0&&(t=!0),typeof i=="string"&&(i=parseInt(i,10));let s=this,o=i;o<0&&(o=0);let{params:a,snapGrid:l,slidesGrid:d,previousIndex:c,activeIndex:u,rtlTranslate:h,wrapperEl:f,enabled:p}=s;if(!p&&!n&&!r||s.destroyed||s.animating&&a.preventInteractionOnTransition)return!1;typeof e>"u"&&(e=s.params.speed);let x=Math.min(s.params.slidesPerGroupSkip,o),v=x+Math.floor((o-x)/s.params.slidesPerGroup);v>=l.length&&(v=l.length-1);let g=-l[v];if(a.normalizeSlideIndex)for(let M=0;M<d.length;M+=1){let T=-Math.floor(g*100),I=Math.floor(d[M]*100),L=Math.floor(d[M+1]*100);typeof d[M+1]<"u"?T>=I&&T<L-(L-I)/2?o=M:T>=I&&T<L&&(o=M+1):T>=I&&(o=M)}if(s.initialized&&o!==u&&(!s.allowSlideNext&&(h?g>s.translate&&g>s.minTranslate():g<s.translate&&g<s.minTranslate())||!s.allowSlidePrev&&g>s.translate&&g>s.maxTranslate()&&(u||0)!==o))return!1;o!==(c||0)&&t&&s.emit("beforeSlideChangeStart"),s.updateProgress(g);let y;o>u?y="next":o<u?y="prev":y="reset";let b=s.virtual&&s.params.virtual.enabled;if(!(b&&r)&&(h&&-g===s.translate||!h&&g===s.translate))return s.updateActiveIndex(o),a.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),a.effect!=="slide"&&s.setTranslate(g),y!=="reset"&&(s.transitionStart(t,y),s.transitionEnd(t,y)),!1;if(a.cssMode){let M=s.isHorizontal(),T=h?g:-g;if(e===0)b&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),b&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{f[M?"scrollLeft":"scrollTop"]=T})):f[M?"scrollLeft":"scrollTop"]=T,b&&requestAnimationFrame(()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1});else{if(!s.support.smoothScroll)return n1({swiper:s,targetPosition:T,side:M?"left":"top"}),!0;f.scrollTo({[M?"left":"top"]:T,behavior:"smooth"})}return!0}return s.setTransition(e),s.setTranslate(g),s.updateActiveIndex(o),s.updateSlidesClasses(),s.emit("beforeTransitionStart",e,n),s.transitionStart(t,y),e===0?s.transitionEnd(t,y):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(T){!s||s.destroyed||T.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(t,y))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0}function qU(i,e,t,n){i===void 0&&(i=0),t===void 0&&(t=!0),typeof i=="string"&&(i=parseInt(i,10));let r=this;if(r.destroyed)return;typeof e>"u"&&(e=r.params.speed);let s=r.grid&&r.params.grid&&r.params.grid.rows>1,o=i;if(r.params.loop)if(r.virtual&&r.params.virtual.enabled)o=o+r.virtual.slidesBefore;else{let a;if(s){let h=o*r.params.grid.rows;a=r.slides.filter(f=>f.getAttribute("data-swiper-slide-index")*1===h)[0].column}else a=r.getSlideIndexByData(o);let l=s?Math.ceil(r.slides.length/r.params.grid.rows):r.slides.length,{centeredSlides:d}=r.params,c=r.params.slidesPerView;c==="auto"?c=r.slidesPerViewDynamic():(c=Math.ceil(parseFloat(r.params.slidesPerView,10)),d&&c%2===0&&(c=c+1));let u=l-a<c;if(d&&(u=u||a<Math.ceil(c/2)),n&&d&&r.params.slidesPerView!=="auto"&&!s&&(u=!1),u){let h=d?a<r.activeIndex?"prev":"next":a-r.activeIndex-1<r.params.slidesPerView?"next":"prev";r.loopFix({direction:h,slideTo:!0,activeSlideIndex:h==="next"?a+1:a-l+1,slideRealIndex:h==="next"?r.realIndex:void 0})}if(s){let h=o*r.params.grid.rows;o=r.slides.filter(f=>f.getAttribute("data-swiper-slide-index")*1===h)[0].column}else o=r.getSlideIndexByData(o)}return requestAnimationFrame(()=>{r.slideTo(o,e,t,n)}),r}function ZU(i,e,t){e===void 0&&(e=!0);let n=this,{enabled:r,params:s,animating:o}=n;if(!r||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let a=s.slidesPerGroup;s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(a=Math.max(n.slidesPerViewDynamic("current",!0),1));let l=n.activeIndex<s.slidesPerGroupSkip?1:a,d=n.virtual&&s.virtual.enabled;if(s.loop){if(o&&!d&&s.loopPreventsSliding)return!1;if(n.loopFix({direction:"next"}),n._clientLeft=n.wrapperEl.clientLeft,n.activeIndex===n.slides.length-1&&s.cssMode)return requestAnimationFrame(()=>{n.slideTo(n.activeIndex+l,i,e,t)}),!0}return s.rewind&&n.isEnd?n.slideTo(0,i,e,t):n.slideTo(n.activeIndex+l,i,e,t)}function YU(i,e,t){e===void 0&&(e=!0);let n=this,{params:r,snapGrid:s,slidesGrid:o,rtlTranslate:a,enabled:l,animating:d}=n;if(!l||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let c=n.virtual&&r.virtual.enabled;if(r.loop){if(d&&!c&&r.loopPreventsSliding)return!1;n.loopFix({direction:"prev"}),n._clientLeft=n.wrapperEl.clientLeft}let u=a?n.translate:-n.translate;function h(g){return g<0?-Math.floor(Math.abs(g)):Math.floor(g)}let f=h(u),p=s.map(g=>h(g)),x=s[p.indexOf(f)-1];if(typeof x>"u"&&r.cssMode){let g;s.forEach((y,b)=>{f>=y&&(g=b)}),typeof g<"u"&&(x=s[g>0?g-1:g])}let v=0;if(typeof x<"u"&&(v=o.indexOf(x),v<0&&(v=n.activeIndex-1),r.slidesPerView==="auto"&&r.slidesPerGroup===1&&r.slidesPerGroupAuto&&(v=v-n.slidesPerViewDynamic("previous",!0)+1,v=Math.max(v,0))),r.rewind&&n.isBeginning){let g=n.params.virtual&&n.params.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1;return n.slideTo(g,i,e,t)}else if(r.loop&&n.activeIndex===0&&r.cssMode)return requestAnimationFrame(()=>{n.slideTo(v,i,e,t)}),!0;return n.slideTo(v,i,e,t)}function XU(i,e,t){e===void 0&&(e=!0);let n=this;if(!n.destroyed)return typeof i>"u"&&(i=n.params.speed),n.slideTo(n.activeIndex,i,e,t)}function QU(i,e,t,n){e===void 0&&(e=!0),n===void 0&&(n=.5);let r=this;if(r.destroyed)return;typeof i>"u"&&(i=r.params.speed);let s=r.activeIndex,o=Math.min(r.params.slidesPerGroupSkip,s),a=o+Math.floor((s-o)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[a]){let d=r.snapGrid[a],c=r.snapGrid[a+1];l-d>(c-d)*n&&(s+=r.params.slidesPerGroup)}else{let d=r.snapGrid[a-1],c=r.snapGrid[a];l-d<=(c-d)*n&&(s-=r.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,r.slidesGrid.length-1),r.slideTo(s,i,e,t)}function KU(){let i=this;if(i.destroyed)return;let{params:e,slidesEl:t}=i,n=e.slidesPerView==="auto"?i.slidesPerViewDynamic():e.slidesPerView,r=i.clickedIndex,s,o=i.isElement?"swiper-slide":`.${e.slideClass}`;if(e.loop){if(i.animating)return;s=parseInt(i.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?r<i.loopedSlides-n/2||r>i.slides.length-i.loopedSlides+n/2?(i.loopFix(),r=i.getSlideIndex(wi(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),_l(()=>{i.slideTo(r)})):i.slideTo(r):r>i.slides.length-n?(i.loopFix(),r=i.getSlideIndex(wi(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),_l(()=>{i.slideTo(r)})):i.slideTo(r)}else i.slideTo(r)}var JU={slideTo:WU,slideToLoop:qU,slideNext:ZU,slidePrev:YU,slideReset:XU,slideToClosest:QU,slideToClickedSlide:KU};function $U(i){let e=this,{params:t,slidesEl:n}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;let r=()=>{wi(n,`.${t.slideClass}, swiper-slide`).forEach((u,h)=>{u.setAttribute("data-swiper-slide-index",h)})},s=e.grid&&t.grid&&t.grid.rows>1,o=t.slidesPerGroup*(s?t.grid.rows:1),a=e.slides.length%o!==0,l=s&&e.slides.length%t.grid.rows!==0,d=c=>{for(let u=0;u<c;u+=1){let h=e.isElement?hs("swiper-slide",[t.slideBlankClass]):hs("div",[t.slideClass,t.slideBlankClass]);e.slidesEl.append(h)}};if(a){if(t.loopAddBlankSlides){let c=o-e.slides.length%o;d(c),e.recalcSlides(),e.updateSlides()}else oh("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(l){if(t.loopAddBlankSlides){let c=t.grid.rows-e.slides.length%t.grid.rows;d(c),e.recalcSlides(),e.updateSlides()}else oh("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();e.loopFix({slideRealIndex:i,direction:t.centeredSlides?void 0:"next"})}function eH(i){let{slideRealIndex:e,slideTo:t=!0,direction:n,setTranslate:r,activeSlideIndex:s,byController:o,byMousewheel:a}=i===void 0?{}:i,l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");let{slides:d,allowSlidePrev:c,allowSlideNext:u,slidesEl:h,params:f}=l,{centeredSlides:p}=f;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&f.virtual.enabled){t&&(!f.centeredSlides&&l.snapIndex===0?l.slideTo(l.virtual.slides.length,0,!1,!0):f.centeredSlides&&l.snapIndex<f.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0)),l.allowSlidePrev=c,l.allowSlideNext=u,l.emit("loopFix");return}let x=f.slidesPerView;x==="auto"?x=l.slidesPerViewDynamic():(x=Math.ceil(parseFloat(f.slidesPerView,10)),p&&x%2===0&&(x=x+1));let v=f.slidesPerGroupAuto?x:f.slidesPerGroup,g=v;g%v!==0&&(g+=v-g%v),g+=f.loopAdditionalSlides,l.loopedSlides=g;let y=l.grid&&f.grid&&f.grid.rows>1;d.length<x+g?oh("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):y&&f.grid.fill==="row"&&oh("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");let b=[],A=[],M=l.activeIndex;typeof s>"u"?s=l.getSlideIndex(d.filter(B=>B.classList.contains(f.slideActiveClass))[0]):M=s;let T=n==="next"||!n,I=n==="prev"||!n,L=0,E=0,S=y?Math.ceil(d.length/f.grid.rows):d.length,j=(y?d[s].column:s)+(p&&typeof r>"u"?-x/2+.5:0);if(j<g){L=Math.max(g-j,v);for(let B=0;B<g-j;B+=1){let z=B-Math.floor(B/S)*S;if(y){let X=S-z-1;for(let Q=d.length-1;Q>=0;Q-=1)d[Q].column===X&&b.push(Q)}else b.push(S-z-1)}}else if(j+x>S-g){E=Math.max(j-(S-g*2),v);for(let B=0;B<E;B+=1){let z=B-Math.floor(B/S)*S;y?d.forEach((X,Q)=>{X.column===z&&A.push(Q)}):A.push(z)}}if(l.__preventObserver__=!0,requestAnimationFrame(()=>{l.__preventObserver__=!1}),I&&b.forEach(B=>{d[B].swiperLoopMoveDOM=!0,h.prepend(d[B]),d[B].swiperLoopMoveDOM=!1}),T&&A.forEach(B=>{d[B].swiperLoopMoveDOM=!0,h.append(d[B]),d[B].swiperLoopMoveDOM=!1}),l.recalcSlides(),f.slidesPerView==="auto"?l.updateSlides():y&&(b.length>0&&I||A.length>0&&T)&&l.slides.forEach((B,z)=>{l.grid.updateSlide(z,B,l.slides)}),f.watchSlidesProgress&&l.updateSlidesOffset(),t){if(b.length>0&&I){if(typeof e>"u"){let B=l.slidesGrid[M],X=l.slidesGrid[M+L]-B;a?l.setTranslate(l.translate-X):(l.slideTo(M+Math.ceil(L),0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-X,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-X))}else if(r){let B=y?b.length/f.grid.rows:b.length;l.slideTo(l.activeIndex+B,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(A.length>0&&T)if(typeof e>"u"){let B=l.slidesGrid[M],X=l.slidesGrid[M-E]-B;a?l.setTranslate(l.translate-X):(l.slideTo(M-E,0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-X,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-X))}else{let B=y?A.length/f.grid.rows:A.length;l.slideTo(l.activeIndex-B,0,!1,!0)}}if(l.allowSlidePrev=c,l.allowSlideNext=u,l.controller&&l.controller.control&&!o){let B={slideRealIndex:e,direction:n,setTranslate:r,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach(z=>{!z.destroyed&&z.params.loop&&z.loopFix(We(ae({},B),{slideTo:z.params.slidesPerView===f.slidesPerView?t:!1}))}):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix(We(ae({},B),{slideTo:l.controller.control.params.slidesPerView===f.slidesPerView?t:!1}))}l.emit("loopFix")}function tH(){let i=this,{params:e,slidesEl:t}=i;if(!e.loop||i.virtual&&i.params.virtual.enabled)return;i.recalcSlides();let n=[];i.slides.forEach(r=>{let s=typeof r.swiperSlideIndex>"u"?r.getAttribute("data-swiper-slide-index")*1:r.swiperSlideIndex;n[s]=r}),i.slides.forEach(r=>{r.removeAttribute("data-swiper-slide-index")}),n.forEach(r=>{t.append(r)}),i.recalcSlides(),i.slideTo(i.realIndex,0)}var nH={loopCreate:$U,loopFix:eH,loopDestroy:tH};function iH(i){let e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;let t=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),t.style.cursor="move",t.style.cursor=i?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function rH(){let i=this;i.params.watchOverflow&&i.isLocked||i.params.cssMode||(i.isElement&&(i.__preventObserver__=!0),i[i.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",i.isElement&&requestAnimationFrame(()=>{i.__preventObserver__=!1}))}var sH={setGrabCursor:iH,unsetGrabCursor:rH};function oH(i,e){e===void 0&&(e=this);function t(n){if(!n||n===zi()||n===Zn())return null;n.assignedSlot&&(n=n.assignedSlot);let r=n.closest(i);return!r&&!n.getRootNode?null:r||t(n.getRootNode().host)}return t(e)}function BP(i,e,t){let n=Zn(),{params:r}=i,s=r.edgeSwipeDetection,o=r.edgeSwipeThreshold;return s&&(t<=o||t>=n.innerWidth-o)?s==="prevent"?(e.preventDefault(),!0):!1:!0}function aH(i){let e=this,t=zi(),n=i;n.originalEvent&&(n=n.originalEvent);let r=e.touchEventsData;if(n.type==="pointerdown"){if(r.pointerId!==null&&r.pointerId!==n.pointerId)return;r.pointerId=n.pointerId}else n.type==="touchstart"&&n.targetTouches.length===1&&(r.touchId=n.targetTouches[0].identifier);if(n.type==="touchstart"){BP(e,n,n.targetTouches[0].pageX);return}let{params:s,touches:o,enabled:a}=e;if(!a||!s.simulateTouch&&n.pointerType==="mouse"||e.animating&&s.preventInteractionOnTransition)return;!e.animating&&s.cssMode&&s.loop&&e.loopFix();let l=n.target;if(s.touchEventsTarget==="wrapper"&&!kP(l,e.wrapperEl)||"which"in n&&n.which===3||"button"in n&&n.button>0||r.isTouched&&r.isMoved)return;let d=!!s.noSwipingClass&&s.noSwipingClass!=="",c=n.composedPath?n.composedPath():n.path;d&&n.target&&n.target.shadowRoot&&c&&(l=c[0]);let u=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,h=!!(n.target&&n.target.shadowRoot);if(s.noSwiping&&(h?oH(u,l):l.closest(u))){e.allowClick=!0;return}if(s.swipeHandler&&!l.closest(s.swipeHandler))return;o.currentX=n.pageX,o.currentY=n.pageY;let f=o.currentX,p=o.currentY;if(!BP(e,n,f))return;Object.assign(r,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),o.startX=f,o.startY=p,r.touchStartTime=Sl(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,s.threshold>0&&(r.allowThresholdMove=!1);let x=!0;l.matches(r.focusableElements)&&(x=!1,l.nodeName==="SELECT"&&(r.isTouched=!1)),t.activeElement&&t.activeElement.matches(r.focusableElements)&&t.activeElement!==l&&(n.pointerType==="mouse"||n.pointerType!=="mouse"&&!l.matches(r.focusableElements))&&t.activeElement.blur();let v=x&&e.allowTouchMove&&s.touchStartPreventDefault;(s.touchStartForcePreventDefault||v)&&!l.isContentEditable&&n.preventDefault(),s.freeMode&&s.freeMode.enabled&&e.freeMode&&e.animating&&!s.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",n)}function lH(i){let e=zi(),t=this,n=t.touchEventsData,{params:r,touches:s,rtlTranslate:o,enabled:a}=t;if(!a||!r.simulateTouch&&i.pointerType==="mouse")return;let l=i;if(l.originalEvent&&(l=l.originalEvent),l.type==="pointermove"&&(n.touchId!==null||l.pointerId!==n.pointerId))return;let d;if(l.type==="touchmove"){if(d=[...l.changedTouches].filter(T=>T.identifier===n.touchId)[0],!d||d.identifier!==n.touchId)return}else d=l;if(!n.isTouched){n.startMoving&&n.isScrolling&&t.emit("touchMoveOpposite",l);return}let c=d.pageX,u=d.pageY;if(l.preventedByNestedSwiper){s.startX=c,s.startY=u;return}if(!t.allowTouchMove){l.target.matches(n.focusableElements)||(t.allowClick=!1),n.isTouched&&(Object.assign(s,{startX:c,startY:u,currentX:c,currentY:u}),n.touchStartTime=Sl());return}if(r.touchReleaseOnEdges&&!r.loop){if(t.isVertical()){if(u<s.startY&&t.translate<=t.maxTranslate()||u>s.startY&&t.translate>=t.minTranslate()){n.isTouched=!1,n.isMoved=!1;return}}else if(c<s.startX&&t.translate<=t.maxTranslate()||c>s.startX&&t.translate>=t.minTranslate())return}if(e.activeElement&&e.activeElement.matches(n.focusableElements)&&e.activeElement!==l.target&&l.pointerType!=="mouse"&&e.activeElement.blur(),e.activeElement&&l.target===e.activeElement&&l.target.matches(n.focusableElements)){n.isMoved=!0,t.allowClick=!1;return}n.allowTouchCallbacks&&t.emit("touchMove",l),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=c,s.currentY=u;let h=s.currentX-s.startX,f=s.currentY-s.startY;if(t.params.threshold&&Math.sqrt(h**2+f**2)<t.params.threshold)return;if(typeof n.isScrolling>"u"){let T;t.isHorizontal()&&s.currentY===s.startY||t.isVertical()&&s.currentX===s.startX?n.isScrolling=!1:h*h+f*f>=25&&(T=Math.atan2(Math.abs(f),Math.abs(h))*180/Math.PI,n.isScrolling=t.isHorizontal()?T>r.touchAngle:90-T>r.touchAngle)}if(n.isScrolling&&t.emit("touchMoveOpposite",l),typeof n.startMoving>"u"&&(s.currentX!==s.startX||s.currentY!==s.startY)&&(n.startMoving=!0),n.isScrolling||l.type==="touchmove"&&n.preventTouchMoveFromPointerMove){n.isTouched=!1;return}if(!n.startMoving)return;t.allowClick=!1,!r.cssMode&&l.cancelable&&l.preventDefault(),r.touchMoveStopPropagation&&!r.nested&&l.stopPropagation();let p=t.isHorizontal()?h:f,x=t.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;r.oneWayMovement&&(p=Math.abs(p)*(o?1:-1),x=Math.abs(x)*(o?1:-1)),s.diff=p,p*=r.touchRatio,o&&(p=-p,x=-x);let v=t.touchesDirection;t.swipeDirection=p>0?"prev":"next",t.touchesDirection=x>0?"prev":"next";let g=t.params.loop&&!r.cssMode,y=t.touchesDirection==="next"&&t.allowSlideNext||t.touchesDirection==="prev"&&t.allowSlidePrev;if(!n.isMoved){if(g&&y&&t.loopFix({direction:t.swipeDirection}),n.startTranslate=t.getTranslate(),t.setTransition(0),t.animating){let T=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});t.wrapperEl.dispatchEvent(T)}n.allowMomentumBounce=!1,r.grabCursor&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!0),t.emit("sliderFirstMove",l)}let b;if(new Date().getTime(),n.isMoved&&n.allowThresholdMove&&v!==t.touchesDirection&&g&&y&&Math.abs(p)>=1){Object.assign(s,{startX:c,startY:u,currentX:c,currentY:u,startTranslate:n.currentTranslate}),n.loopSwapReset=!0,n.startTranslate=n.currentTranslate;return}t.emit("sliderMove",l),n.isMoved=!0,n.currentTranslate=p+n.startTranslate;let A=!0,M=r.resistanceRatio;if(r.touchReleaseOnEdges&&(M=0),p>0?(g&&y&&!b&&n.allowThresholdMove&&n.currentTranslate>(r.centeredSlides?t.minTranslate()-t.slidesSizesGrid[t.activeIndex+1]-(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.activeIndex+1]+t.params.spaceBetween:0)-t.params.spaceBetween:t.minTranslate())&&t.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),n.currentTranslate>t.minTranslate()&&(A=!1,r.resistance&&(n.currentTranslate=t.minTranslate()-1+(-t.minTranslate()+n.startTranslate+p)**M))):p<0&&(g&&y&&!b&&n.allowThresholdMove&&n.currentTranslate<(r.centeredSlides?t.maxTranslate()+t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween+(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween:0):t.maxTranslate())&&t.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:t.slides.length-(r.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(parseFloat(r.slidesPerView,10)))}),n.currentTranslate<t.maxTranslate()&&(A=!1,r.resistance&&(n.currentTranslate=t.maxTranslate()+1-(t.maxTranslate()-n.startTranslate-p)**M))),A&&(l.preventedByNestedSwiper=!0),!t.allowSlideNext&&t.swipeDirection==="next"&&n.currentTranslate<n.startTranslate&&(n.currentTranslate=n.startTranslate),!t.allowSlidePrev&&t.swipeDirection==="prev"&&n.currentTranslate>n.startTranslate&&(n.currentTranslate=n.startTranslate),!t.allowSlidePrev&&!t.allowSlideNext&&(n.currentTranslate=n.startTranslate),r.threshold>0)if(Math.abs(p)>r.threshold||n.allowThresholdMove){if(!n.allowThresholdMove){n.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,n.currentTranslate=n.startTranslate,s.diff=t.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY;return}}else{n.currentTranslate=n.startTranslate;return}!r.followFinger||r.cssMode||((r.freeMode&&r.freeMode.enabled&&t.freeMode||r.watchSlidesProgress)&&(t.updateActiveIndex(),t.updateSlidesClasses()),r.freeMode&&r.freeMode.enabled&&t.freeMode&&t.freeMode.onTouchMove(),t.updateProgress(n.currentTranslate),t.setTranslate(n.currentTranslate))}function dH(i){let e=this,t=e.touchEventsData,n=i;n.originalEvent&&(n=n.originalEvent);let r;if(n.type==="touchend"||n.type==="touchcancel"){if(r=[...n.changedTouches].filter(M=>M.identifier===t.touchId)[0],!r||r.identifier!==t.touchId)return}else{if(t.touchId!==null||n.pointerId!==t.pointerId)return;r=n}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(n.type)&&!(["pointercancel","contextmenu"].includes(n.type)&&(e.browser.isSafari||e.browser.isWebView)))return;t.pointerId=null,t.touchId=null;let{params:o,touches:a,rtlTranslate:l,slidesGrid:d,enabled:c}=e;if(!c||!o.simulateTouch&&n.pointerType==="mouse")return;if(t.allowTouchCallbacks&&e.emit("touchEnd",n),t.allowTouchCallbacks=!1,!t.isTouched){t.isMoved&&o.grabCursor&&e.setGrabCursor(!1),t.isMoved=!1,t.startMoving=!1;return}o.grabCursor&&t.isMoved&&t.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);let u=Sl(),h=u-t.touchStartTime;if(e.allowClick){let M=n.path||n.composedPath&&n.composedPath();e.updateClickedSlide(M&&M[0]||n.target,M),e.emit("tap click",n),h<300&&u-t.lastClickTime<300&&e.emit("doubleTap doubleClick",n)}if(t.lastClickTime=Sl(),_l(()=>{e.destroyed||(e.allowClick=!0)}),!t.isTouched||!t.isMoved||!e.swipeDirection||a.diff===0&&!t.loopSwapReset||t.currentTranslate===t.startTranslate&&!t.loopSwapReset){t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;return}t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;let f;if(o.followFinger?f=l?e.translate:-e.translate:f=-t.currentTranslate,o.cssMode)return;if(o.freeMode&&o.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:f});return}let p=f>=-e.maxTranslate()&&!e.params.loop,x=0,v=e.slidesSizesGrid[0];for(let M=0;M<d.length;M+=M<o.slidesPerGroupSkip?1:o.slidesPerGroup){let T=M<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;typeof d[M+T]<"u"?(p||f>=d[M]&&f<d[M+T])&&(x=M,v=d[M+T]-d[M]):(p||f>=d[M])&&(x=M,v=d[d.length-1]-d[d.length-2])}let g=null,y=null;o.rewind&&(e.isBeginning?y=o.virtual&&o.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(g=0));let b=(f-d[x])/v,A=x<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;if(h>o.longSwipesMs){if(!o.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(b>=o.longSwipesRatio?e.slideTo(o.rewind&&e.isEnd?g:x+A):e.slideTo(x)),e.swipeDirection==="prev"&&(b>1-o.longSwipesRatio?e.slideTo(x+A):y!==null&&b<0&&Math.abs(b)>o.longSwipesRatio?e.slideTo(y):e.slideTo(x))}else{if(!o.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(n.target===e.navigation.nextEl||n.target===e.navigation.prevEl)?n.target===e.navigation.nextEl?e.slideTo(x+A):e.slideTo(x):(e.swipeDirection==="next"&&e.slideTo(g!==null?g:x+A),e.swipeDirection==="prev"&&e.slideTo(y!==null?y:x))}}function VP(){let i=this,{params:e,el:t}=i;if(t&&t.offsetWidth===0)return;e.breakpoints&&i.setBreakpoint();let{allowSlideNext:n,allowSlidePrev:r,snapGrid:s}=i,o=i.virtual&&i.params.virtual.enabled;i.allowSlideNext=!0,i.allowSlidePrev=!0,i.updateSize(),i.updateSlides(),i.updateSlidesClasses();let a=o&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&i.isEnd&&!i.isBeginning&&!i.params.centeredSlides&&!a?i.slideTo(i.slides.length-1,0,!1,!0):i.params.loop&&!o?i.slideToLoop(i.realIndex,0,!1,!0):i.slideTo(i.activeIndex,0,!1,!0),i.autoplay&&i.autoplay.running&&i.autoplay.paused&&(clearTimeout(i.autoplay.resizeTimeout),i.autoplay.resizeTimeout=setTimeout(()=>{i.autoplay&&i.autoplay.running&&i.autoplay.paused&&i.autoplay.resume()},500)),i.allowSlidePrev=r,i.allowSlideNext=n,i.params.watchOverflow&&s!==i.snapGrid&&i.checkOverflow()}function cH(i){let e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&i.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(i.stopPropagation(),i.stopImmediatePropagation())))}function uH(){let i=this,{wrapperEl:e,rtlTranslate:t,enabled:n}=i;if(!n)return;i.previousTranslate=i.translate,i.isHorizontal()?i.translate=-e.scrollLeft:i.translate=-e.scrollTop,i.translate===0&&(i.translate=0),i.updateActiveIndex(),i.updateSlidesClasses();let r,s=i.maxTranslate()-i.minTranslate();s===0?r=0:r=(i.translate-i.minTranslate())/s,r!==i.progress&&i.updateProgress(t?-i.translate:i.translate),i.emit("setTranslate",i.translate,!1)}function hH(i){let e=this;ng(e,i.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function fH(){let i=this;i.documentTouchHandlerProceeded||(i.documentTouchHandlerProceeded=!0,i.params.touchReleaseOnEdges&&(i.el.style.touchAction="auto"))}var WP=(i,e)=>{let t=zi(),{params:n,el:r,wrapperEl:s,device:o}=i,a=!!n.nested,l=e==="on"?"addEventListener":"removeEventListener",d=e;!r||typeof r=="string"||(t[l]("touchstart",i.onDocumentTouchStart,{passive:!1,capture:a}),r[l]("touchstart",i.onTouchStart,{passive:!1}),r[l]("pointerdown",i.onTouchStart,{passive:!1}),t[l]("touchmove",i.onTouchMove,{passive:!1,capture:a}),t[l]("pointermove",i.onTouchMove,{passive:!1,capture:a}),t[l]("touchend",i.onTouchEnd,{passive:!0}),t[l]("pointerup",i.onTouchEnd,{passive:!0}),t[l]("pointercancel",i.onTouchEnd,{passive:!0}),t[l]("touchcancel",i.onTouchEnd,{passive:!0}),t[l]("pointerout",i.onTouchEnd,{passive:!0}),t[l]("pointerleave",i.onTouchEnd,{passive:!0}),t[l]("contextmenu",i.onTouchEnd,{passive:!0}),(n.preventClicks||n.preventClicksPropagation)&&r[l]("click",i.onClick,!0),n.cssMode&&s[l]("scroll",i.onScroll),n.updateOnWindowResize?i[d](o.ios||o.android?"resize orientationchange observerUpdate":"resize observerUpdate",VP,!0):i[d]("observerUpdate",VP,!0),r[l]("load",i.onLoad,{capture:!0}))};function pH(){let i=this,{params:e}=i;i.onTouchStart=aH.bind(i),i.onTouchMove=lH.bind(i),i.onTouchEnd=dH.bind(i),i.onDocumentTouchStart=fH.bind(i),e.cssMode&&(i.onScroll=uH.bind(i)),i.onClick=cH.bind(i),i.onLoad=hH.bind(i),WP(i,"on")}function mH(){WP(this,"off")}var gH={attachEvents:pH,detachEvents:mH},UP=(i,e)=>i.grid&&e.grid&&e.grid.rows>1;function vH(){let i=this,{realIndex:e,initialized:t,params:n,el:r}=i,s=n.breakpoints;if(!s||s&&Object.keys(s).length===0)return;let o=i.getBreakpoint(s,i.params.breakpointsBase,i.el);if(!o||i.currentBreakpoint===o)return;let l=(o in s?s[o]:void 0)||i.originalParams,d=UP(i,n),c=UP(i,l),u=i.params.grabCursor,h=l.grabCursor,f=n.enabled;d&&!c?(r.classList.remove(`${n.containerModifierClass}grid`,`${n.containerModifierClass}grid-column`),i.emitContainerClasses()):!d&&c&&(r.classList.add(`${n.containerModifierClass}grid`),(l.grid.fill&&l.grid.fill==="column"||!l.grid.fill&&n.grid.fill==="column")&&r.classList.add(`${n.containerModifierClass}grid-column`),i.emitContainerClasses()),u&&!h?i.unsetGrabCursor():!u&&h&&i.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(b=>{if(typeof l[b]>"u")return;let A=n[b]&&n[b].enabled,M=l[b]&&l[b].enabled;A&&!M&&i[b].disable(),!A&&M&&i[b].enable()});let p=l.direction&&l.direction!==n.direction,x=n.loop&&(l.slidesPerView!==n.slidesPerView||p),v=n.loop;p&&t&&i.changeDirection(),$i(i.params,l);let g=i.params.enabled,y=i.params.loop;Object.assign(i,{allowTouchMove:i.params.allowTouchMove,allowSlideNext:i.params.allowSlideNext,allowSlidePrev:i.params.allowSlidePrev}),f&&!g?i.disable():!f&&g&&i.enable(),i.currentBreakpoint=o,i.emit("_beforeBreakpoint",l),t&&(x?(i.loopDestroy(),i.loopCreate(e),i.updateSlides()):!v&&y?(i.loopCreate(e),i.updateSlides()):v&&!y&&i.loopDestroy()),i.emit("breakpoint",l)}function xH(i,e,t){if(e===void 0&&(e="window"),!i||e==="container"&&!t)return;let n=!1,r=Zn(),s=e==="window"?r.innerHeight:t.clientHeight,o=Object.keys(i).map(a=>{if(typeof a=="string"&&a.indexOf("@")===0){let l=parseFloat(a.substr(1));return{value:s*l,point:a}}return{value:a,point:a}});o.sort((a,l)=>parseInt(a.value,10)-parseInt(l.value,10));for(let a=0;a<o.length;a+=1){let{point:l,value:d}=o[a];e==="window"?r.matchMedia(`(min-width: ${d}px)`).matches&&(n=l):d<=t.clientWidth&&(n=l)}return n||"max"}var wH={setBreakpoint:vH,getBreakpoint:xH};function bH(i,e){let t=[];return i.forEach(n=>{typeof n=="object"?Object.keys(n).forEach(r=>{n[r]&&t.push(e+r)}):typeof n=="string"&&t.push(e+n)}),t}function yH(){let i=this,{classNames:e,params:t,rtl:n,el:r,device:s}=i,o=bH(["initialized",t.direction,{"free-mode":i.params.freeMode&&t.freeMode.enabled},{autoheight:t.autoHeight},{rtl:n},{grid:t.grid&&t.grid.rows>1},{"grid-column":t.grid&&t.grid.rows>1&&t.grid.fill==="column"},{android:s.android},{ios:s.ios},{"css-mode":t.cssMode},{centered:t.cssMode&&t.centeredSlides},{"watch-progress":t.watchSlidesProgress}],t.containerModifierClass);e.push(...o),r.classList.add(...e),i.emitContainerClasses()}function AH(){let i=this,{el:e,classNames:t}=i;!e||typeof e=="string"||(e.classList.remove(...t),i.emitContainerClasses())}var _H={addClasses:yH,removeClasses:AH};function SH(){let i=this,{isLocked:e,params:t}=i,{slidesOffsetBefore:n}=t;if(n){let r=i.slides.length-1,s=i.slidesGrid[r]+i.slidesSizesGrid[r]+n*2;i.isLocked=i.size>s}else i.isLocked=i.snapGrid.length===1;t.allowSlideNext===!0&&(i.allowSlideNext=!i.isLocked),t.allowSlidePrev===!0&&(i.allowSlidePrev=!i.isLocked),e&&e!==i.isLocked&&(i.isEnd=!1),e!==i.isLocked&&i.emit(i.isLocked?"lock":"unlock")}var EH={checkOverflow:SH},HP={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function CH(i,e){return function(n){n===void 0&&(n={});let r=Object.keys(n)[0],s=n[r];if(typeof s!="object"||s===null){$i(e,n);return}if(i[r]===!0&&(i[r]={enabled:!0}),r==="navigation"&&i[r]&&i[r].enabled&&!i[r].prevEl&&!i[r].nextEl&&(i[r].auto=!0),["pagination","scrollbar"].indexOf(r)>=0&&i[r]&&i[r].enabled&&!i[r].el&&(i[r].auto=!0),!(r in i&&"enabled"in s)){$i(e,n);return}typeof i[r]=="object"&&!("enabled"in i[r])&&(i[r].enabled=!0),i[r]||(i[r]={enabled:!1}),$i(e,n)}}var l1={eventsEmitter:_U,update:kU,translate:UU,transition:GU,slide:JU,loop:nH,grabCursor:sH,events:gH,breakpoints:wH,checkOverflow:EH,classes:_H},d1={},fs=class i{constructor(){let e,t;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];r.length===1&&r[0].constructor&&Object.prototype.toString.call(r[0]).slice(8,-1)==="Object"?t=r[0]:[e,t]=r,t||(t={}),t=$i({},t),e&&!t.el&&(t.el=e);let o=zi();if(t.el&&typeof t.el=="string"&&o.querySelectorAll(t.el).length>1){let c=[];return o.querySelectorAll(t.el).forEach(u=>{let h=$i({},t,{el:u});c.push(new i(h))}),c}let a=this;a.__swiper__=!0,a.support=zP(),a.device=jP({userAgent:t.userAgent}),a.browser=bU(),a.eventsListeners={},a.eventsAnyListeners=[],a.modules=[...a.__modules__],t.modules&&Array.isArray(t.modules)&&a.modules.push(...t.modules);let l={};a.modules.forEach(c=>{c({params:t,swiper:a,extendParams:CH(t,l),on:a.on.bind(a),once:a.once.bind(a),off:a.off.bind(a),emit:a.emit.bind(a)})});let d=$i({},HP,l);return a.params=$i({},d,d1,t),a.originalParams=$i({},a.params),a.passedParams=$i({},t),a.params&&a.params.on&&Object.keys(a.params.on).forEach(c=>{a.on(c,a.params.on[c])}),a.params&&a.params.onAny&&a.onAny(a.params.onAny),Object.assign(a,{enabled:a.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return a.params.direction==="horizontal"},isVertical(){return a.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:a.params.allowSlideNext,allowSlidePrev:a.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:a.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:a.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),a.emit("_swiper"),a.params.init&&a.init(),a}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){let{slidesEl:t,params:n}=this,r=wi(t,`.${n.slideClass}, swiper-slide`),s=El(r[0]);return El(e)-s}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter(t=>t.getAttribute("data-swiper-slide-index")*1===e)[0])}recalcSlides(){let e=this,{slidesEl:t,params:n}=e;e.slides=wi(t,`.${n.slideClass}, swiper-slide`)}enable(){let e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){let e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){let n=this;e=Math.min(Math.max(e,0),1);let r=n.minTranslate(),o=(n.maxTranslate()-r)*e+r;n.translateTo(o,typeof t>"u"?0:t),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=e.el.className.split(" ").filter(n=>n.indexOf("swiper")===0||n.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){let t=this;return t.destroyed?"":e.className.split(" ").filter(n=>n.indexOf("swiper-slide")===0||n.indexOf(t.params.slideClass)===0).join(" ")}emitSlidesClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=[];e.slides.forEach(n=>{let r=e.getSlideClasses(n);t.push({slideEl:n,classNames:r}),e.emit("_slideClass",n,r)}),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){e===void 0&&(e="current"),t===void 0&&(t=!1);let n=this,{params:r,slides:s,slidesGrid:o,slidesSizesGrid:a,size:l,activeIndex:d}=n,c=1;if(typeof r.slidesPerView=="number")return r.slidesPerView;if(r.centeredSlides){let u=s[d]?Math.ceil(s[d].swiperSlideSize):0,h;for(let f=d+1;f<s.length;f+=1)s[f]&&!h&&(u+=Math.ceil(s[f].swiperSlideSize),c+=1,u>l&&(h=!0));for(let f=d-1;f>=0;f-=1)s[f]&&!h&&(u+=s[f].swiperSlideSize,c+=1,u>l&&(h=!0))}else if(e==="current")for(let u=d+1;u<s.length;u+=1)(t?o[u]+a[u]-o[d]<l:o[u]-o[d]<l)&&(c+=1);else for(let u=d-1;u>=0;u-=1)o[d]-o[u]<l&&(c+=1);return c}update(){let e=this;if(!e||e.destroyed)return;let{snapGrid:t,params:n}=e;n.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(o=>{o.complete&&ng(e,o)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function r(){let o=e.rtlTranslate?e.translate*-1:e.translate,a=Math.min(Math.max(o,e.maxTranslate()),e.minTranslate());e.setTranslate(a),e.updateActiveIndex(),e.updateSlidesClasses()}let s;if(n.freeMode&&n.freeMode.enabled&&!n.cssMode)r(),n.autoHeight&&e.updateAutoHeight();else{if((n.slidesPerView==="auto"||n.slidesPerView>1)&&e.isEnd&&!n.centeredSlides){let o=e.virtual&&n.virtual.enabled?e.virtual.slides:e.slides;s=e.slideTo(o.length-1,0,!1,!0)}else s=e.slideTo(e.activeIndex,0,!1,!0);s||r()}n.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){t===void 0&&(t=!0);let n=this,r=n.params.direction;return e||(e=r==="horizontal"?"vertical":"horizontal"),e===r||e!=="horizontal"&&e!=="vertical"||(n.el.classList.remove(`${n.params.containerModifierClass}${r}`),n.el.classList.add(`${n.params.containerModifierClass}${e}`),n.emitContainerClasses(),n.params.direction=e,n.slides.forEach(s=>{e==="vertical"?s.style.width="":s.style.height=""}),n.emit("changeDirection"),t&&n.update()),n}changeLanguageDirection(e){let t=this;t.rtl&&e==="rtl"||!t.rtl&&e==="ltr"||(t.rtl=e==="rtl",t.rtlTranslate=t.params.direction==="horizontal"&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){let t=this;if(t.mounted)return!0;let n=e||t.params.el;if(typeof n=="string"&&(n=document.querySelector(n)),!n)return!1;n.swiper=t,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);let r=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`,o=n&&n.shadowRoot&&n.shadowRoot.querySelector?n.shadowRoot.querySelector(r()):wi(n,r())[0];return!o&&t.params.createElements&&(o=hs("div",t.params.wrapperClass),n.append(o),wi(n,`.${t.params.slideClass}`).forEach(a=>{o.append(a)})),Object.assign(t,{el:n,wrapperEl:o,slidesEl:t.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:o,hostEl:t.isElement?n.parentNode.host:n,mounted:!0,rtl:n.dir.toLowerCase()==="rtl"||Ao(n,"direction")==="rtl",rtlTranslate:t.params.direction==="horizontal"&&(n.dir.toLowerCase()==="rtl"||Ao(n,"direction")==="rtl"),wrongRTL:Ao(o,"display")==="-webkit-box"}),!0}init(e){let t=this;if(t.initialized||t.mount(e)===!1)return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();let r=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&r.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),r.forEach(s=>{s.complete?ng(t,s):s.addEventListener("load",o=>{ng(t,o.target)})}),c1(t),t.initialized=!0,c1(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);let n=this,{params:r,el:s,wrapperEl:o,slides:a}=n;return typeof n.params>"u"||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),r.loop&&n.loopDestroy(),t&&(n.removeClasses(),s&&typeof s!="string"&&s.removeAttribute("style"),o&&o.removeAttribute("style"),a&&a.length&&a.forEach(l=>{l.classList.remove(r.slideVisibleClass,r.slideFullyVisibleClass,r.slideActiveClass,r.slideNextClass,r.slidePrevClass),l.removeAttribute("style"),l.removeAttribute("data-swiper-slide-index")})),n.emit("destroy"),Object.keys(n.eventsListeners).forEach(l=>{n.off(l)}),e!==!1&&(n.el&&typeof n.el!="string"&&(n.el.swiper=null),LP(n)),n.destroyed=!0),null}static extendDefaults(e){$i(d1,e)}static get extendedDefaults(){return d1}static get defaults(){return HP}static installModule(e){i.prototype.__modules__||(i.prototype.__modules__=[]);let t=i.prototype.__modules__;typeof e=="function"&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach(t=>i.installModule(t)),i):(i.installModule(e),i)}};Object.keys(l1).forEach(i=>{Object.keys(l1[i]).forEach(e=>{fs.prototype[e]=l1[i][e]})});fs.use([yU,AU]);function lh(i,e,t,n){return i.params.createElements&&Object.keys(n).forEach(r=>{if(!t[r]&&t.auto===!0){let s=wi(i.el,`.${n[r]}`)[0];s||(s=hs("div",n[r]),s.className=n[r],i.el.append(s)),t[r]=s,e[r]=s}}),t}function u1(i){let{swiper:e,extendParams:t,on:n,emit:r}=i;t({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};function s(p){let x;return p&&typeof p=="string"&&e.isElement&&(x=e.el.querySelector(p)||e.hostEl.querySelector(p),x)?x:(p&&(typeof p=="string"&&(x=[...document.querySelectorAll(p)]),e.params.uniqueNavElements&&typeof p=="string"&&x&&x.length>1&&e.el.querySelectorAll(p).length===1?x=e.el.querySelector(p):x&&x.length===1&&(x=x[0])),p&&!x?p:x)}function o(p,x){let v=e.params.navigation;p=Nn(p),p.forEach(g=>{g&&(g.classList[x?"add":"remove"](...v.disabledClass.split(" ")),g.tagName==="BUTTON"&&(g.disabled=x),e.params.watchOverflow&&e.enabled&&g.classList[e.isLocked?"add":"remove"](v.lockClass))})}function a(){let{nextEl:p,prevEl:x}=e.navigation;if(e.params.loop){o(x,!1),o(p,!1);return}o(x,e.isBeginning&&!e.params.rewind),o(p,e.isEnd&&!e.params.rewind)}function l(p){p.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),r("navigationPrev"))}function d(p){p.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),r("navigationNext"))}function c(){let p=e.params.navigation;if(e.params.navigation=lh(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(p.nextEl||p.prevEl))return;let x=s(p.nextEl),v=s(p.prevEl);Object.assign(e.navigation,{nextEl:x,prevEl:v}),x=Nn(x),v=Nn(v);let g=(y,b)=>{y&&y.addEventListener("click",b==="next"?d:l),!e.enabled&&y&&y.classList.add(...p.lockClass.split(" "))};x.forEach(y=>g(y,"next")),v.forEach(y=>g(y,"prev"))}function u(){let{nextEl:p,prevEl:x}=e.navigation;p=Nn(p),x=Nn(x);let v=(g,y)=>{g.removeEventListener("click",y==="next"?d:l),g.classList.remove(...e.params.navigation.disabledClass.split(" "))};p.forEach(g=>v(g,"next")),x.forEach(g=>v(g,"prev"))}n("init",()=>{e.params.navigation.enabled===!1?f():(c(),a())}),n("toEdge fromEdge lock unlock",()=>{a()}),n("destroy",()=>{u()}),n("enable disable",()=>{let{nextEl:p,prevEl:x}=e.navigation;if(p=Nn(p),x=Nn(x),e.enabled){a();return}[...p,...x].filter(v=>!!v).forEach(v=>v.classList.add(e.params.navigation.lockClass))}),n("click",(p,x)=>{let{nextEl:v,prevEl:g}=e.navigation;v=Nn(v),g=Nn(g);let y=x.target,b=g.includes(y)||v.includes(y);if(e.isElement&&!b){let A=x.path||x.composedPath&&x.composedPath();A&&(b=A.find(M=>v.includes(M)||g.includes(M)))}if(e.params.navigation.hideOnClick&&!b){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===y||e.pagination.el.contains(y)))return;let A;v.length?A=v[0].classList.contains(e.params.navigation.hiddenClass):g.length&&(A=g[0].classList.contains(e.params.navigation.hiddenClass)),r(A===!0?"navigationShow":"navigationHide"),[...v,...g].filter(M=>!!M).forEach(M=>M.classList.toggle(e.params.navigation.hiddenClass))}});let h=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),c(),a()},f=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),u()};Object.assign(e.navigation,{enable:h,disable:f,update:a,init:c,destroy:u})}function Ca(i){return i===void 0&&(i=""),`.${i.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function h1(i){let{swiper:e,extendParams:t,on:n,emit:r}=i,s="swiper-pagination";t({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:y=>y,formatFractionTotal:y=>y,bulletClass:`${s}-bullet`,bulletActiveClass:`${s}-bullet-active`,modifierClass:`${s}-`,currentClass:`${s}-current`,totalClass:`${s}-total`,hiddenClass:`${s}-hidden`,progressbarFillClass:`${s}-progressbar-fill`,progressbarOppositeClass:`${s}-progressbar-opposite`,clickableClass:`${s}-clickable`,lockClass:`${s}-lock`,horizontalClass:`${s}-horizontal`,verticalClass:`${s}-vertical`,paginationDisabledClass:`${s}-disabled`}}),e.pagination={el:null,bullets:[]};let o,a=0;function l(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function d(y,b){let{bulletActiveClass:A}=e.params.pagination;y&&(y=y[`${b==="prev"?"previous":"next"}ElementSibling`],y&&(y.classList.add(`${A}-${b}`),y=y[`${b==="prev"?"previous":"next"}ElementSibling`],y&&y.classList.add(`${A}-${b}-${b}`)))}function c(y,b,A){if(y=y%A,b=b%A,b===y+1)return"next";if(b===y-1)return"previous"}function u(y){let b=y.target.closest(Ca(e.params.pagination.bulletClass));if(!b)return;y.preventDefault();let A=El(b)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===A)return;let M=c(e.realIndex,A,e.slides.length);M==="next"?e.slideNext():M==="previous"?e.slidePrev():e.slideToLoop(A)}else e.slideTo(A)}function h(){let y=e.rtl,b=e.params.pagination;if(l())return;let A=e.pagination.el;A=Nn(A);let M,T,I=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,L=e.params.loop?Math.ceil(I/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(T=e.previousRealIndex||0,M=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(M=e.snapIndex,T=e.previousSnapIndex):(T=e.previousIndex||0,M=e.activeIndex||0),b.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){let E=e.pagination.bullets,S,P,j;if(b.dynamicBullets&&(o=ah(E[0],e.isHorizontal()?"width":"height",!0),A.forEach(B=>{B.style[e.isHorizontal()?"width":"height"]=`${o*(b.dynamicMainBullets+4)}px`}),b.dynamicMainBullets>1&&T!==void 0&&(a+=M-(T||0),a>b.dynamicMainBullets-1?a=b.dynamicMainBullets-1:a<0&&(a=0)),S=Math.max(M-a,0),P=S+(Math.min(E.length,b.dynamicMainBullets)-1),j=(P+S)/2),E.forEach(B=>{let z=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(X=>`${b.bulletActiveClass}${X}`)].map(X=>typeof X=="string"&&X.includes(" ")?X.split(" "):X).flat();B.classList.remove(...z)}),A.length>1)E.forEach(B=>{let z=El(B);z===M?B.classList.add(...b.bulletActiveClass.split(" ")):e.isElement&&B.setAttribute("part","bullet"),b.dynamicBullets&&(z>=S&&z<=P&&B.classList.add(...`${b.bulletActiveClass}-main`.split(" ")),z===S&&d(B,"prev"),z===P&&d(B,"next"))});else{let B=E[M];if(B&&B.classList.add(...b.bulletActiveClass.split(" ")),e.isElement&&E.forEach((z,X)=>{z.setAttribute("part",X===M?"bullet-active":"bullet")}),b.dynamicBullets){let z=E[S],X=E[P];for(let Q=S;Q<=P;Q+=1)E[Q]&&E[Q].classList.add(...`${b.bulletActiveClass}-main`.split(" "));d(z,"prev"),d(X,"next")}}if(b.dynamicBullets){let B=Math.min(E.length,b.dynamicMainBullets+4),z=(o*B-o)/2-j*o,X=y?"right":"left";E.forEach(Q=>{Q.style[e.isHorizontal()?X:"top"]=`${z}px`})}}A.forEach((E,S)=>{if(b.type==="fraction"&&(E.querySelectorAll(Ca(b.currentClass)).forEach(P=>{P.textContent=b.formatFractionCurrent(M+1)}),E.querySelectorAll(Ca(b.totalClass)).forEach(P=>{P.textContent=b.formatFractionTotal(L)})),b.type==="progressbar"){let P;b.progressbarOpposite?P=e.isHorizontal()?"vertical":"horizontal":P=e.isHorizontal()?"horizontal":"vertical";let j=(M+1)/L,B=1,z=1;P==="horizontal"?B=j:z=j,E.querySelectorAll(Ca(b.progressbarFillClass)).forEach(X=>{X.style.transform=`translate3d(0,0,0) scaleX(${B}) scaleY(${z})`,X.style.transitionDuration=`${e.params.speed}ms`})}b.type==="custom"&&b.renderCustom?(E.innerHTML=b.renderCustom(e,M+1,L),S===0&&r("paginationRender",E)):(S===0&&r("paginationRender",E),r("paginationUpdate",E)),e.params.watchOverflow&&e.enabled&&E.classList[e.isLocked?"add":"remove"](b.lockClass)})}function f(){let y=e.params.pagination;if(l())return;let b=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length,A=e.pagination.el;A=Nn(A);let M="";if(y.type==="bullets"){let T=e.params.loop?Math.ceil(b/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&T>b&&(T=b);for(let I=0;I<T;I+=1)y.renderBullet?M+=y.renderBullet.call(e,I,y.bulletClass):M+=`<${y.bulletElement} ${e.isElement?'part="bullet"':""} class="${y.bulletClass}"></${y.bulletElement}>`}y.type==="fraction"&&(y.renderFraction?M=y.renderFraction.call(e,y.currentClass,y.totalClass):M=`<span class="${y.currentClass}"></span> / <span class="${y.totalClass}"></span>`),y.type==="progressbar"&&(y.renderProgressbar?M=y.renderProgressbar.call(e,y.progressbarFillClass):M=`<span class="${y.progressbarFillClass}"></span>`),e.pagination.bullets=[],A.forEach(T=>{y.type!=="custom"&&(T.innerHTML=M||""),y.type==="bullets"&&e.pagination.bullets.push(...T.querySelectorAll(Ca(y.bulletClass)))}),y.type!=="custom"&&r("paginationRender",A[0])}function p(){e.params.pagination=lh(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});let y=e.params.pagination;if(!y.el)return;let b;typeof y.el=="string"&&e.isElement&&(b=e.el.querySelector(y.el)),!b&&typeof y.el=="string"&&(b=[...document.querySelectorAll(y.el)]),b||(b=y.el),!(!b||b.length===0)&&(e.params.uniqueNavElements&&typeof y.el=="string"&&Array.isArray(b)&&b.length>1&&(b=[...e.el.querySelectorAll(y.el)],b.length>1&&(b=b.filter(A=>Xd(A,".swiper")[0]===e.el)[0])),Array.isArray(b)&&b.length===1&&(b=b[0]),Object.assign(e.pagination,{el:b}),b=Nn(b),b.forEach(A=>{y.type==="bullets"&&y.clickable&&A.classList.add(...(y.clickableClass||"").split(" ")),A.classList.add(y.modifierClass+y.type),A.classList.add(e.isHorizontal()?y.horizontalClass:y.verticalClass),y.type==="bullets"&&y.dynamicBullets&&(A.classList.add(`${y.modifierClass}${y.type}-dynamic`),a=0,y.dynamicMainBullets<1&&(y.dynamicMainBullets=1)),y.type==="progressbar"&&y.progressbarOpposite&&A.classList.add(y.progressbarOppositeClass),y.clickable&&A.addEventListener("click",u),e.enabled||A.classList.add(y.lockClass)}))}function x(){let y=e.params.pagination;if(l())return;let b=e.pagination.el;b&&(b=Nn(b),b.forEach(A=>{A.classList.remove(y.hiddenClass),A.classList.remove(y.modifierClass+y.type),A.classList.remove(e.isHorizontal()?y.horizontalClass:y.verticalClass),y.clickable&&(A.classList.remove(...(y.clickableClass||"").split(" ")),A.removeEventListener("click",u))})),e.pagination.bullets&&e.pagination.bullets.forEach(A=>A.classList.remove(...y.bulletActiveClass.split(" ")))}n("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;let y=e.params.pagination,{el:b}=e.pagination;b=Nn(b),b.forEach(A=>{A.classList.remove(y.horizontalClass,y.verticalClass),A.classList.add(e.isHorizontal()?y.horizontalClass:y.verticalClass)})}),n("init",()=>{e.params.pagination.enabled===!1?g():(p(),f(),h())}),n("activeIndexChange",()=>{typeof e.snapIndex>"u"&&h()}),n("snapIndexChange",()=>{h()}),n("snapGridLengthChange",()=>{f(),h()}),n("destroy",()=>{x()}),n("enable disable",()=>{let{el:y}=e.pagination;y&&(y=Nn(y),y.forEach(b=>b.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),n("lock unlock",()=>{h()}),n("click",(y,b)=>{let A=b.target,M=Nn(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&M&&M.length>0&&!A.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&A===e.navigation.nextEl||e.navigation.prevEl&&A===e.navigation.prevEl))return;let T=M[0].classList.contains(e.params.pagination.hiddenClass);r(T===!0?"paginationShow":"paginationHide"),M.forEach(I=>I.classList.toggle(e.params.pagination.hiddenClass))}});let v=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:y}=e.pagination;y&&(y=Nn(y),y.forEach(b=>b.classList.remove(e.params.pagination.paginationDisabledClass))),p(),f(),h()},g=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:y}=e.pagination;y&&(y=Nn(y),y.forEach(b=>b.classList.add(e.params.pagination.paginationDisabledClass))),x()};Object.assign(e.pagination,{enable:v,disable:g,render:f,update:h,init:p,destroy:x})}var ci=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files";getKioskMap(e){let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-kiosk-map.php`,t)}getEvents(){return this.http.get(this.apiUrl+"/fetch-events.php")}getKiosk(){return this.http.get(`${this.apiUrl}/fetch-kiosk.php`)}downloadForm(e,t,n){let r=`${this.apiUrl}/create-form.php`,s={formId:e,firstName:t,lastName:n};this.http.post(r,s,{responseType:"blob"}).subscribe(o=>{let a=new Blob([o],{type:"application/pdf"}),l=window.URL.createObjectURL(a),d=document.createElement("a");d.href=l,d.download=`${t}_${n}_application_form.pdf`,d.click(),window.URL.revokeObjectURL(l)},o=>{console.error("Error downloading the form:",o),alert("Failed to download the form. Please try again later.")})}static \u0275fac=function(t){return new(t||i)(Te(wo))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};function MH(i,e){i&1&&(m(0,"div",23)(1,"div",24)(2,"div",25),F(3,"div",26),m(4,"p",27),_(5,"Events"),w()()()())}function TH(i,e){if(i&1&&(m(0,"div",28)(1,"div",29),F(2,"img",30),w()()),i&2){let t=e.$implicit,n=U();C(2),k("src",n.urlImage+t.event_image,ai)}}function IH(i,e){i&1&&(m(0,"span"),_(1,"..."),w())}function DH(i,e){if(i&1){let t=Ve();m(0,"div",50)(1,"div",51),F(2,"img",52),w(),m(3,"div",53),_(4),w(),F(5,"hr",54),m(6,"div",55)(7,"p",56),_(8,"Start:"),w(),m(9,"p"),_(10),w(),m(11,"p",57),_(12,"End:"),w(),m(13,"p"),_(14),w(),m(15,"p",57),_(16,"Details:"),w(),m(17,"p",58),_(18),Ti(19,"slice"),G(20,IH,2,0,"span",22),w()(),m(21,"div",59)(22,"button",60),H("click",function(){let r=$(t).$implicit,s=U(2);return ee(s.eventSelected(r.event_id,r.event_name,r.status,r.event_start,r.event_end))}),_(23," Select This Event "),w()()()}if(i&2){let t=e.$implicit,n=U(2);C(2),k("src",n.urlImage+t.event_image,ai),C(2),ot(" ",n.toTitleCase(t.event_name)," "),C(6),ge(n.formatDate(t.event_start)),C(4),ge(t.event_end),C(4),ge(Hi(19,6,t.details,0,100)),C(2),k("ngIf",t.details.length>100)}}function PH(i,e){i&1&&(m(0,"div",61)(1,"div",62),F(2,"div",63),m(3,"p",64),_(4,"Event"),w()()())}function RH(i,e){i&1&&(m(0,"div",65)(1,"div",62),F(2,"div",63),m(3,"p",64),_(4,"Events"),w()()())}function LH(i,e){i&1&&(m(0,"div",65)(1,"div",62),F(2,"div",63),m(3,"p",64),_(4,"Events"),w()()())}function kH(i,e){if(i&1){let t=Ve();m(0,"div",31)(1,"div",32)(2,"div",33)(3,"button",34),H("click",function(){$(t);let r=U();return ee(r.isEvent=!r.isEvent)}),ie(),m(4,"svg",35),F(5,"path",36),w()()(),Je(),m(6,"div",37),F(7,"div",38),m(8,"div",39)(9,"p",40),_(10," STEP 3 "),m(11,"span",41),F(12,"br"),_(13,"Application"),w()()(),m(14,"div",42)(15,"p",40),_(16," STEP 2 "),m(17,"span",41),F(18,"br"),_(19,"Kiosk Selection"),w()()(),m(20,"div",43)(21,"p",40),_(22," STEP 1 "),m(23,"span",44),F(24,"br"),_(25,"Event Selection"),w()()()(),m(26,"div",45),_(27," Upcoming Events: "),w(),m(28,"div",46),G(29,DH,24,10,"div",47)(30,PH,5,0,"div",48)(31,RH,5,0,"div",49)(32,LH,5,0,"div",49),w()()()}if(i&2){let t=U();C(29),k("ngForOf",t.events),C(),k("ngIf",t.events.length%2==1),C(),k("ngIf",t.events.length==0),C(),k("ngIf",t.events.length==0)}}function NH(i,e){i&1&&(m(0,"div",68),F(1,"div",63),m(2,"p",64),_(3,"loading..."),w()())}function FH(i,e){if(i&1&&(m(0,"div")(1,"div",66),G(2,NH,4,0,"div",67),w()()),i&2){let t=U();C(2),k("ngIf",t.loading)}}fs.use([u1,h1]);var rg=class i{constructor(e,t){this.eventService=e;this.router=t}events=[];loading=!1;urlImage="https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/";isEvent=!1;runOnce=!1;ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.fetchEvents(),sessionStorage.setItem("eventName",""),sessionStorage.setItem("kioskName",""),sessionStorage.setItem("eventId",""),sessionStorage.setItem("kioskId",""),sessionStorage.getItem("runOnce")=="false"&&(window.location.reload(),sessionStorage.setItem("runOnce","true"))}fetchEvents(){this.eventService.getEvents().subscribe(e=>{this.events=e})}ngAfterViewInit(){let e=new fs(".default-carousel",{loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swipe-next",prevEl:".swipe-prev"}});setInterval(()=>{e.slideNext()},3e3)}toTitleCase(e){return e.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}formatDate(e){let t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}toggleKiosk(){this.isEvent=!this.isEvent}eventSelected(e,t,n,r,s){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("eventId",e),sessionStorage.setItem("eventName",t),sessionStorage.setItem("status",n),sessionStorage.setItem("eventStart",r),sessionStorage.setItem("eventEnd",s),this.router.navigate(["/map-viewer"]).then(()=>{window.location.reload()})},200)}static \u0275fac=function(t){return new(t||i)(se(ci),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[gt],decls:27,vars:4,consts:[[1,"h-full","max-w-full","pt-20","justify-center","flex","items-center","z-0","overflow-y-hidden"],[1,"grid","grid-cols-1","md:grid-cols-2","pt-2","z-10"],[1,"h-full","justify-center","itens-center","flex","bg-black"],[1,"swiper","justify-center","itens-center","default-carousel"],[1,"swiper-wrapper","bg-green-900"],["class","swiper-slide w-full h-full bg-customDarkGreen opacity-85",4,"ngIf"],["class","swiper-slide ",4,"ngFor","ngForOf"],[1,"swipe-prev","absolute","top-72","z-10","left-1","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-14","w-14","text-gray-600","hover:text-gray-900"],["points","15 18 9 12 15 6"],[1,"swipe-next","absolute","top-72","z-[10]","right-1","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["points","9 18 15 12 9 6"],[1,"relative","-top-2"],[1,"swiper-pagination"],[1,"flex","justify-center","items-center","space-y-9","w-full","h-full","bg-customDarkGreen","l-0","py-24","md:py-0"],[1,"flex","flex-col","justify-center","items-center","md:justify-start","md:items-start","md:py-0","py-20","space-y-2","w-full","pl-4"],[1,"text-left","text-white","text-7xl","font-bold"],[1,"text-left","text-gray-300","text-sm","font-semibold","pt-2","w-3/4"],[1,"pt-4"],[1,"bg-gray-300","w-40","h-12","rounded-xl","text-gray-600","font-bold","shadow-sm","shadow-gray-400","hover:text-gray-800","hover-bg-gray-400","hover:shadow-md","hover:shadow-green-900",3,"click"],[1,"max-w-screen-lg"],["class","animate-fadeIn fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-[100]",4,"ngIf"],[4,"ngIf"],[1,"swiper-slide","w-full","h-full","bg-customDarkGreen","opacity-85"],[1,"h-[70vh]","w-full","flex","justify-center","items-center"],[1,"flex","flex-col","items-center","justify-center","w-screen","h-full"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-gray-50"],[1,"mt-4","font-bold","text-gray-50","text-lg"],[1,"swiper-slide"],[1,"h-full","w-full","flex"],[1,"h-full","w-full","object-cover",3,"src"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-[100]"],[1,"relative","bg-customDarkGreen","max-w-screen-md","h-5/6","w-full","md:w-5/6","md:h-3/4","px-8","py-4","rounded-xl","shadow-black","shadow-[4px]","overflow-y-auto","overflow-x-hidden","z-[200]"],[1,"absolute","top-4","right-4"],[1,"text-white","hover:text-gray-700","p-2","rounded-full","hover:bg-gray-200","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"w-full","h-[75px]","md:h-20","mt-8","flex","flex-col","items-center","md:flex-row","md:justify-center","md:top-0","top-10","relative"],[1,"w-[15rem]","md:w-[29rem]","h-16","pt-5","border-b-4","px-4","md:px-20","relative"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[1.75rem]","left-32","md:top-[1.90rem]","md:left-0","mt-4","md:mt-0"],[1,"relative","text-sm","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold"],[1,"text-xs","text-gray-300"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[4.0rem]","md:top-[1.90rem]","md:right-[16rem]","mt-4","md:mt-0"],[1,"size-8","bg-gray-50","rounded-full","relative","-top-[6.5rem]","-left-[8rem]","md:top-[2rem]","md:-left-[32rem]","mt-4","md:mt-0"],[1,"text-xs","text-gray-50"],[1,"w-full","text-left","text-white","text-3xl","font-bold","border-white","border-b-2","pt-4","pb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-2","justify-center","items-center","gap-4","pt-4"],["class","h-full flex flex-col w-full bg-green-50 rounded-xl shadow-green-700 shadow-md px-3",4,"ngFor","ngForOf"],["class","md:flex hidden h-96 w-full flex items-center justify-center bg-gray-300 opacity-50 inset-0 rounded-xl shadow-green-700 shadow-md",4,"ngIf"],["class","h-96 w-full flex items-center justify-center bg-gray-300 opacity-50 inset-0 rounded-xl shadow-green-700 shadow-md",4,"ngIf"],[1,"h-full","flex","flex-col","w-full","bg-green-50","rounded-xl","shadow-green-700","shadow-md","px-3"],[1,"flex","justify-center","items-center"],[1,"size-28","rounded-full","object-contain","mt-4","justify-self-center","align-center","border-gray-300","border-2",3,"src"],[1,"text-center","text-xl","py-2","font-bold","block"],[1,"border-t-2","border-black","w-full"],[1,"text-center","text-xs","pt-2","block"],[1,"text-md","font-bold"],[1,"text-md","font-bold","pt-2"],[1,"block","w-full","min-h-full"],[1,"flex","align-center","justify-center","pt-3","pb-4","mt-auto"],[1,"flex","align-center","justify-center","font-bold","text-gray-900","text-center","h-12","w-40","pt-3","bg-gray-300","shadow-sm","shadow-gray-400","rounded-full","hover:bg-gray-400","hover:shadow-gray-900","hover:shadow-md",3,"click"],[1,"md:flex","hidden","h-96","w-full","flex","items-center","justify-center","bg-gray-300","opacity-50","inset-0","rounded-xl","shadow-green-700","shadow-md"],[1,"flex","flex-col","items-center","justify-center"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"],[1,"h-96","w-full","flex","items-center","justify-center","bg-gray-300","opacity-50","inset-0","rounded-xl","shadow-green-700","shadow-md"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),G(5,MH,6,0,"div",5)(6,TH,3,1,"div",6),w(),m(7,"button",7),ie(),m(8,"svg",8),F(9,"polyline",9),w()(),Je(),m(10,"button",10),ie(),m(11,"svg",8),F(12,"polyline",11),w()(),Je(),m(13,"div",12),F(14,"div",13),w()()(),m(15,"div",14)(16,"div",15)(17,"div",16),_(18,"EVENTS"),w(),m(19,"div",17),_(20,'"Streamline your event experience with our kiosk system\u2014effortlessly browse, select, and stay updated on the latest happenings! Discover events that match your interests, view real-time details, and plan with ease. Our intuitive system ensures a hassle-free way to stay connected and make the most of every event opportunity."'),w(),m(21,"div",18)(22,"button",19),H("click",function(){return n.toggleKiosk()}),_(23,"EXPLORE EVENTS!"),w()()()()(),m(24,"div",20),G(25,kH,33,4,"div",21),w()(),G(26,FH,3,1,"div",22)),t&2&&(C(5),k("ngIf",n.events.length==0),C(),k("ngForOf",n.events),C(19),k("ngIf",n.isEvent),C(),k("ngIf",n.loading))},dependencies:[xt,an,kt,Lr],styles:['*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.swiper-wrapper[_ngcontent-%COMP%]{width:100%;height:max-content!important;padding-bottom:0!important;-webkit-transition-timing-function:linear!important;transition-timing-function:linear!important;position:relative}.swiper-pagination-bullet[_ngcontent-%COMP%]{background:#4f46e5}.swiper-button-next[_ngcontent-%COMP%]:before{content:"";color:#4a5568;font-size:1.5rem;font-weight:700}.swiper-button-next[_ngcontent-%COMP%]:hover:before{color:#1a202c}']})};var iR=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(n){return new(n||i)(se(Ei),se(xi))}}static{this.\u0275dir=hn({type:i})}}return i})(),gh=(()=>{class i extends iR{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,features:[Ui]})}}return i})(),tc=new rt(""),OH={provide:tc,useExisting:rs(()=>v1),multi:!0},v1=(()=>{class i extends gh{writeValue(t){this.setProperty("checked",t)}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,r){n&1&&H("change",function(o){return r.onChange(o.target.checked)})("blur",function(){return r.onTouched()})},features:[fo([OH]),Ui]})}}return i})(),BH={provide:tc,useExisting:rs(()=>_n),multi:!0};function VH(){let i=go()?go().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var UH=new rt(""),_n=(()=>{class i extends iR{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!VH())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(n){return new(n||i)(se(Ei),se(xi),se(UH,8))}}static{this.\u0275dir=hn({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&H("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[fo([BH]),Ui]})}}return i})();function HH(i){return i==null||(typeof i=="string"||Array.isArray(i))&&i.length===0}var x1=new rt(""),rR=new rt("");function zH(i){return HH(i.value)?{required:!0}:null}function YP(i){return null}function sR(i){return i!=null}function oR(i){return wl(i)?gn(i):i}function aR(i){let e={};return i.forEach(t=>{e=t!=null?ae(ae({},e),t):e}),Object.keys(e).length===0?null:e}function lR(i,e){return e.map(t=>t(i))}function jH(i){return!i.validate}function dR(i){return i.map(e=>jH(e)?e:t=>e.validate(t))}function GH(i){if(!i)return null;let e=i.filter(sR);return e.length==0?null:function(t){return aR(lR(t,e))}}function w1(i){return i!=null?GH(dR(i)):null}function WH(i){if(!i)return null;let e=i.filter(sR);return e.length==0?null:function(t){let n=lR(t,e).map(oR);return Bx(n).pipe(St(aR))}}function b1(i){return i!=null?WH(dR(i)):null}function XP(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function qH(i){return i._rawValidators}function ZH(i){return i._rawAsyncValidators}function g1(i){return i?Array.isArray(i)?i:[i]:[]}function og(i,e){return Array.isArray(i)?i.includes(e):i===e}function QP(i,e){let t=g1(e);return g1(i).forEach(r=>{og(t,r)||t.push(r)}),t}function KP(i,e){return g1(e).filter(t=>!og(i,t))}var ag=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=w1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=b1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},$d=class extends ag{get formDirective(){return null}get path(){return null}},mh=class extends ag{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},lg=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},YH={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Fhe=We(ae({},YH),{"[class.ng-submitted]":"isSubmitted"}),Sn=(()=>{class i extends lg{constructor(t){super(t)}static{this.\u0275fac=function(n){return new(n||i)(se(mh,2))}}static{this.\u0275dir=hn({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&Cu("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Ui]})}}return i})(),Nr=(()=>{class i extends lg{constructor(t){super(t)}static{this.\u0275fac=function(n){return new(n||i)(se($d,10))}}static{this.\u0275dir=hn({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){n&2&&Cu("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Ui]})}}return i})();var ch="VALID",sg="INVALID",Kd="PENDING",uh="DISABLED",ec=class{},dg=class extends ec{constructor(e,t){super(),this.value=e,this.source=t}},fh=class extends ec{constructor(e,t){super(),this.pristine=e,this.source=t}},ph=class extends ec{constructor(e,t){super(),this.touched=e,this.source=t}},Jd=class extends ec{constructor(e,t){super(),this.status=e,this.source=t}};function cR(i){return(hg(i)?i.validators:i)||null}function XH(i){return Array.isArray(i)?w1(i):i||null}function uR(i,e){return(hg(e)?e.asyncValidators:i)||null}function QH(i){return Array.isArray(i)?b1(i):i||null}function hg(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function KH(i,e,t){let n=i.controls;if(!(e?Object.keys(n):n).length)throw new qe(1e3,"");if(!n[t])throw new qe(1001,"")}function JH(i,e,t){i._forEachChild((n,r)=>{if(t[r]===void 0)throw new qe(1002,"")})}var cg=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Iu(()=>this.statusReactive()),this.statusReactive=xl(void 0),this._pristine=Iu(()=>this.pristineReactive()),this.pristineReactive=xl(!0),this._touched=Iu(()=>this.touchedReactive()),this.touchedReactive=xl(!1),this._events=new si,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return po(this.statusReactive)}set status(e){po(()=>this.statusReactive.set(e))}get valid(){return this.status===ch}get invalid(){return this.status===sg}get pending(){return this.status==Kd}get disabled(){return this.status===uh}get enabled(){return this.status!==uh}get pristine(){return po(this.pristineReactive)}set pristine(e){po(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return po(this.touchedReactive)}set touched(e){po(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(QP(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(QP(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(KP(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(KP(e,this._rawAsyncValidators))}hasValidator(e){return og(this._rawValidators,e)}hasAsyncValidator(e){return og(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(We(ae({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new ph(!0,n))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new ph(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(We(ae({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new fh(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new fh(!0,n))}markAsPending(e={}){this.status=Kd;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Jd(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(We(ae({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=uh,this.errors=null,this._forEachChild(r=>{r.disable(We(ae({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new dg(this.value,n)),this._events.next(new Jd(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(We(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ch,this._forEachChild(n=>{n.enable(We(ae({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(We(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ch||this.status===Kd)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new dg(this.value,t)),this._events.next(new Jd(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(We(ae({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?uh:ch}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Kd,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=oR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new Jd(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new En,this.statusChanges=new En}_calculateStatus(){return this._allControlsDisabled()?uh:this.errors?sg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Kd)?Kd:this._anyControlsHaveStatus(sg)?sg:ch}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new fh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ph(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){hg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=XH(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=QH(this._rawAsyncValidators)}},ug=class extends cg{constructor(e,t,n){super(cR(t),uR(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){JH(this,!0,e),Object.keys(e).forEach(n=>{KH(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,r)=>((n.enabled||this.disabled)&&(t[r]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var y1=new rt("CallSetDisabledState",{providedIn:"root",factory:()=>A1}),A1="always";function $H(i,e){return[...e.path,i]}function hR(i,e,t=A1){fR(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),tz(i,e),iz(i,e),nz(i,e),ez(i,e)}function JP(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function ez(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function fR(i,e){let t=qH(i);e.validator!==null?i.setValidators(XP(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=ZH(i);e.asyncValidator!==null?i.setAsyncValidators(XP(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();JP(e._rawValidators,r),JP(e._rawAsyncValidators,r)}function tz(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&pR(i,e)})}function nz(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&pR(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function pR(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function iz(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function rz(i,e){i==null,fR(i,e)}function sz(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function oz(i){return Object.getPrototypeOf(i.constructor)===gh}function az(i,e){i._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function lz(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(s=>{s.constructor===_n?t=s:oz(s)?n=s:r=s}),r||n||t||null}var dz={provide:$d,useExisting:rs(()=>pr)},hh=Promise.resolve(),pr=(()=>{class i extends $d{get submitted(){return po(this.submittedReactive)}constructor(t,n,r){super(),this.callSetDisabledState=r,this._submitted=Iu(()=>this.submittedReactive()),this.submittedReactive=xl(!1),this._directives=new Set,this.ngSubmit=new En,this.form=new ug({},w1(t),b1(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){hh.then(()=>{let n=this._findContainer(t.path);t.control=n.registerControl(t.name,t.control),hR(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){hh.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){hh.then(()=>{let n=this._findContainer(t.path),r=new ug({});rz(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){hh.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,n){hh.then(()=>{this.form.get(t.path).setValue(n)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),az(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(n){return new(n||i)(se(x1,10),se(rR,10),se(y1,8))}}static{this.\u0275dir=hn({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,r){n&1&&H("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[fo([dz]),Ui]})}}return i})();function $P(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function eR(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var cz=class extends cg{constructor(e=null,t,n){super(cR(t),uR(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(eR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){$P(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){$P(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var uz={provide:mh,useExisting:rs(()=>yn)},tR=Promise.resolve(),yn=(()=>{class i extends mh{constructor(t,n,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new cz,this._registered=!1,this.name="",this.update=new En,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=lz(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),sz(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){hR(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){tR.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,r=n!==0&&wa(n);tR.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?$H(t,this._parent):[t]}static{this.\u0275fac=function(n){return new(n||i)(se($d,9),se(x1,10),se(rR,10),se(tc,10),se(Bs,8),se(y1,8))}}static{this.\u0275dir=hn({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[fo([uz]),Ui,Vi]})}}return i})(),Fr=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=hn({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return i})();var hz={provide:tc,useExisting:rs(()=>_1),multi:!0},_1=(()=>{class i extends gh{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(n==""?null:parseFloat(n))}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,r){n&1&&H("change",function(o){return r.onChange(o.target.value)})("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[fo([hz]),Ui]})}}return i})();var fz={provide:tc,useExisting:rs(()=>Ta),multi:!0};function mR(i,e){return i==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function pz(i){return i.split(":")[0]}var Ta=(()=>{class i extends gh{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let n=this._getOptionId(t),r=mR(n,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){let n=pz(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&H("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[fo([fz]),Ui]})}}return i})(),Us=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(mR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(n){return new(n||i)(se(xi),se(Ei),se(Ta,9))}}static{this.\u0275dir=hn({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return i})(),mz={provide:tc,useExisting:rs(()=>gR),multi:!0};function nR(i,e){return i==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function gz(i){return i.split(":")[0]}var gR=(()=>{class i extends gh{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let n;if(Array.isArray(t)){let r=t.map(s=>this._getOptionId(s));n=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else n=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{let r=[],s=n.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let l=o[a],d=this._getOptionValue(l.value);r.push(d)}}else{let o=n.options;for(let a=0;a<o.length;a++){let l=o[a];if(l.selected){let d=this._getOptionValue(l.value);r.push(d)}}}this.value=r,t(r)}}_registerOption(t){let n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){let n=gz(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&H("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[fo([mz]),Ui]})}}return i})(),Hs=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(nR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(nR(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(n){return new(n||i)(se(xi),se(Ei),se(gR,9))}}static{this.\u0275dir=hn({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return i})();var vz=(()=>{class i{constructor(){this._validator=YP}ngOnChanges(t){if(this.inputName in t){let n=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):YP,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=hn({type:i,features:[Vi]})}}return i})();var xz={provide:x1,useExisting:rs(()=>_o),multi:!0};var _o=(()=>{class i extends vz{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=wa,this.createValidator=t=>zH}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})()}static{this.\u0275dir=hn({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,r){n&2&&Rd("required",r._enabled?"":null)},inputs:{required:"required"},features:[fo([xz]),Ui]})}}return i})();var wz=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})();var vn=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:y1,useValue:t.callSetDisabledState??A1}]}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({imports:[wz]})}}return i})();var ui=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files";isLoggedIn(){return!!sessionStorage.getItem("tokenId")}isApplied(){let e=sessionStorage.getItem("tokenId"),t=sessionStorage.getItem("userId"),n=sessionStorage.getItem("eventId"),r=sessionStorage.getItem("kioskId");return!!(e&&t&&n&&r)}isSelectedEvent(){let e=sessionStorage.getItem("tokenId"),t=sessionStorage.getItem("userId"),n=sessionStorage.getItem("eventId");return!!(e&&t&&n)}isTokenValid(){return!!sessionStorage.getItem("tokenId")}checkUserLogin(){return this.isLoggedIn()&&this.isTokenValid()}register(e,t,n,r,s,o,a,l){let d={email:e,password:t,username:n,fname:r,lname:s,businessName:o,contactNumber:a,tokenId:l};return this.http.post(`${this.apiUrl}/validation_registration.php`,d)}login(e,t){let n={email:e,password:t};return this.http.post(`${this.apiUrl}/users_authentication.php`,n)}static \u0275fac=function(t){return new(t||i)(Te(wo))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};function bz(i,e){if(i&1&&(m(0,"p",23),_(1),w()),i&2){let t=U();C(),ge(t.errorMessage)}}function yz(i,e){i&1&&(m(0,"div",26),F(1,"div",27),m(2,"p",28),_(3,"loading..."),w()())}function Az(i,e){if(i&1&&(m(0,"div")(1,"div",24),G(2,yz,4,0,"div",25),w()()),i&2){let t=U();C(2),k("ngIf",t.signingIn)}}var fg=class i{constructor(e,t){this.authService=e;this.router=t}password="";errorMessage="";signingIn=!1;email="";rememberMe=!1;tokenIdTemp="";userName="";firstName="";lastName="";userId="";userType="";showPassword=!1;change(){this.rememberMe=!this.rememberMe}togglePasswordVisibility(){this.showPassword=!this.showPassword}goToSignup(){this.router.navigate(["../register"])}onLogin(){this.errorMessage="",this.signingIn=!0,sessionStorage.setItem("runOnce","false"),this.email==""||this.password==""?(this.errorMessage="Email and password must not be empty",this.signingIn=!1):this.authService.login(this.email,this.password).subscribe({next:e=>{if(this.signingIn=!1,e.success&&e.tokenId)if(e.userType=="user"&&e.status==1)this.tokenIdTemp=e.tokenId,this.userName=e.user.username,this.firstName=e.user.firstname,this.lastName=e.user.lastname,this.userId=e.user.userId,this.userType=e.userType,sessionStorage.setItem("tokenId",this.tokenIdTemp.toString()),sessionStorage.setItem("userName",this.userName.toString()),sessionStorage.setItem("firstName",this.firstName.toString()),sessionStorage.setItem("lastName",this.lastName.toString()),sessionStorage.setItem("userId",this.userId.toString()),sessionStorage.setItem("email",e.user.email.toString()),sessionStorage.setItem("userType",this.userType.toString()),sessionStorage.setItem("runOnce","false"),sessionStorage.setItem("isLoggedIn","login"),this.router.navigate(["/dashboard"]);else if(e.userType=="admin"&&e.status==1||e.userType=="IGP"&&e.status==1||e.userType=="EX-Director"&&e.status==1){this.tokenIdTemp=e.tokenId,this.userName=e.user.username,this.firstName=e.user.firstname,this.lastName=e.user.lastname,this.userId=e.user.userId,this.userType=e.userType;let t=e.events,n=e.transactions,r=e.reports,s=e.settings,o=e.control,a=e.history;sessionStorage.setItem("events",t),sessionStorage.setItem("transactions",n),sessionStorage.setItem("reports",r),sessionStorage.setItem("settings",s),sessionStorage.setItem("control",o),sessionStorage.setItem("history",a),sessionStorage.setItem("tokenId",this.tokenIdTemp.toString()),sessionStorage.setItem("userName",this.userName.toString()),sessionStorage.setItem("firstName",this.firstName.toString()),sessionStorage.setItem("lastName",this.lastName.toString()),sessionStorage.setItem("userId",this.userId.toString()),sessionStorage.setItem("userId",this.userId.toString()),sessionStorage.setItem("userType",this.userType.toString()),sessionStorage.setItem("runOnce","false"),sessionStorage.setItem("isLoggedIn","login"),this.router.navigate(["/dashboard-admin"])}else setInterval(()=>{this.signingIn=!1,e.status==0?this.errorMessage="Request is still pending":e.status==2&&(this.errorMessage="Request denied")},200);else this.signingIn=!1,this.errorMessage=e.message,console.log(this.errorMessage)},error:e=>{},complete:()=>{}})}ngOnInit(){console.log("check")}static \u0275fac=function(t){return new(t||i)(se(ui),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-login"]],standalone:!0,features:[gt],decls:27,vars:6,consts:[[1,"min-h-screen","top-0","left-0","flex","items-center","justify-center","bg-customGreen"],[1,"grid","grid-cols-1","md:grid-cols-2","justify-center","shadow-bottom","shadow-black","items-center","h-[520px]","w-full","md:w-[1000px]","bg-white","md:rounded-xl"],[1,"justify-center","items-center","h-full","w-full","p-8","hidden","md:flex","bg-gray-50","rounded-l-xl"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"md:size-[400px]","xl:size-[400px]","align-center"],[1,"h-full","w-full","p-4","md:p-16","justify-center","items-center","flex","bg-gray-200","rounded-xl","md:rounded-l-[0px]","md:rounded-r-xl"],[1,"w-full"],[1,"text-center","overflow-hidden","text-3xl","text-gray-700"],[1,"pt-4",3,"ngSubmit"],[1,"form-group","mb-4"],["type","text","id","email","name","email","required","","placeholder","Enter email or username",1,"mt-2","h-14","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","mb-4","relative"],["id","password","name","password","required","","placeholder","Enter password",1,"h-14","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","type","ngModel"],["type","button",1,"absolute","inset-y-0","right-3","flex","items-center","text-gray-500","hover:text-gray-700","px-1","focus:outline-none",3,"click"],["aria-hidden","true",3,"ngClass"],[1,"form-group"],["type","submit","id","submit","name","submit",1,"h-12","rounded-full","text-white","text-sm","px-4","py-2","bg-blue-600","hover:bg-blue-900","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue"],[1,"form-group","col-span-2","h-2","py-4"],["class","text-center text-red-700 text-sm ",4,"ngIf"],[1,"hidden","text-center","mt-4","overflow-hidden"],[1,"text-blue-500","text-sm","overflow-hidden"],[1,"text-center","overflow-hidden","mt-4"],[1,"text-blue-500","text-sm",3,"click"],[4,"ngIf"],[1,"text-center","text-red-700","text-sm"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),F(3,"img",3),w(),m(4,"div",4)(5,"div",5)(6,"h6",6),_(7," Welcome Back! "),w(),m(8,"form",7),H("ngSubmit",function(){return n.onLogin()}),m(9,"div",8)(10,"input",9),Ye("ngModelChange",function(s){return Xe(n.email,s)||(n.email=s),s}),w()(),m(11,"div",10)(12,"input",11),Ye("ngModelChange",function(s){return Xe(n.password,s)||(n.password=s),s}),w(),m(13,"button",12),H("click",function(){return n.togglePasswordVisibility()}),F(14,"i",13),w()(),m(15,"div",14)(16,"button",15),_(17,"Login"),w()(),m(18,"div",16),G(19,bz,2,1,"p",17),w()(),m(20,"div",18)(21,"button",19),_(22," Forgot Password ? "),w()(),m(23,"div",20)(24,"button",21),H("click",function(){return n.goToSignup()}),_(25," Don't have an account? Sign Up "),w()()()()(),G(26,Az,3,1,"div",22),w()),t&2&&(C(10),Ze("ngModel",n.email),C(2),k("type",n.showPassword?"text":"password"),Ze("ngModel",n.password),C(2),k("ngClass",n.showPassword?"fas fa-eye-slash":"fas fa-eye"),C(5),k("ngIf",n.errorMessage),C(7),k("ngIf",n.signingIn))},dependencies:[xt,Ji,kt,vn,Fr,_n,Sn,Nr,_o,yn,pr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var pg,_z=new Uint8Array(16);function S1(){if(!pg&&(pg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!pg))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pg(_z)}var vR=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Sz(i){return typeof i=="string"&&vR.test(i)}var xR=Sz;var bi=[];for(mg=0;mg<256;++mg)bi.push((mg+256).toString(16).substr(1));var mg;function Ez(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(bi[i[e+0]]+bi[i[e+1]]+bi[i[e+2]]+bi[i[e+3]]+"-"+bi[i[e+4]]+bi[i[e+5]]+"-"+bi[i[e+6]]+bi[i[e+7]]+"-"+bi[i[e+8]]+bi[i[e+9]]+"-"+bi[i[e+10]]+bi[i[e+11]]+bi[i[e+12]]+bi[i[e+13]]+bi[i[e+14]]+bi[i[e+15]]).toLowerCase();if(!xR(t))throw TypeError("Stringified UUID is invalid");return t}var wR=Ez;function Cz(i,e,t){i=i||{};var n=i.random||(i.rng||S1)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=n[r];return e}return wR(n)}var E1=Cz;var So={_origin:"https://api.emailjs.com"};var bR=(i,e="https://api.emailjs.com")=>{So._userID=i,So._origin=e};var gg=(i,e,t)=>{if(!i)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};var vh=class{constructor(e){this.status=e.status,this.text=e.responseText}};var vg=(i,e,t={})=>new Promise((n,r)=>{let s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{let a=new vh(o);a.status===200||a.text==="OK"?n(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new vh(o))}),s.open("POST",So._origin+i,!0),Object.keys(t).forEach(o=>{s.setRequestHeader(o,t[o])}),s.send(e)});var yR=(i,e,t,n)=>{let r=n||So._userID;return gg(r,i,e),vg("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:r,service_id:i,template_id:e,template_params:t}),{"Content-type":"application/json"})};var Mz=i=>{let e;if(typeof i=="string"?e=document.querySelector(i):e=i,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},AR=(i,e,t,n)=>{let r=n||So._userID,s=Mz(t);gg(r,i,e);let o=new FormData(s);return o.append("lib_version","3.2.0"),o.append("service_id",i),o.append("template_id",e),o.append("user_id",r),vg("/api/v1.0/email/send-form",o)};var ps={init:bR,send:yR,sendForm:AR};function Tz(i,e){if(i&1&&(m(0,"p",30),_(1),w()),i&2){let t=U();C(),ge(t.successMessage)}}function Iz(i,e){if(i&1&&(m(0,"p",31),_(1),w()),i&2){let t=U();C(),ge(t.errorMessage)}}function Dz(i,e){i&1&&(m(0,"div",34),F(1,"div",35),m(2,"p",36),_(3,"loading..."),w()())}function Pz(i,e){if(i&1&&(m(0,"div")(1,"div",32),G(2,Dz,4,0,"div",33),w()()),i&2){let t=U();C(2),k("ngIf",t.signingUp)}}var xg=class i{constructor(e,t){this.authService=e;this.router=t}email="";password="";fname="";lname="";businessName="";contactNumber="";username="";confirmPassword="";successMessage="";errorMessage="";tokenId="";signingUp=!1;currentTime="";showPassword=!1;showConfirmPassword=!1;templateParams={from_name:"John Doe",from_email:"john.doe@example.com",message:"User has signed up and is now trying to log in."};goToSignIn(){this.router.navigate(["/login"])}emailPattern=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;passwordPatterm=/^(?=.*\d)(?=.*[!@#$%^&*(),.?":{}|<>])[A-Za-z\d!@#$%^&*(),.?":{}|<>]{6,}$/;phoneNumberPattern=/^(?:639\d{9}|09\d{9})$/;generateUUID(){let e=E1();this.tokenId=e}togglePasswordVisibility(e){e==="password"?this.showPassword=!this.showPassword:e==="confirmPassword"&&(this.showConfirmPassword=!this.showConfirmPassword)}onSignUp(){if(this.signingUp=!0,this.email==""||this.password==""||this.fname==""||this.lname==""||this.businessName==""||this.contactNumber==""||this.username==""||this.confirmPassword==""){this.errorMessage="All fields are required!",this.signingUp=!1;return}if(this.contactNumber.startsWith("639")&&this.contactNumber.length!==12||this.contactNumber.startsWith("09")&&this.contactNumber.length!==11||!this.phoneNumberPattern.test(this.contactNumber)){this.errorMessage="Invalid phone number",console.log(this.errorMessage),this.signingUp=!1;return}if(this.password.length<6){this.errorMessage="Passwords must be 6 characters long!",this.signingUp=!1;return}if(this.password!==this.confirmPassword){this.errorMessage="Passwords do not match!",this.signingUp=!1;return}if(!this.passwordPatterm.test(this.password)){this.errorMessage="Include atleast one symbos and number!",this.signingUp=!1;return}if(this.emailPattern.test(this.email))this.generateUUID(),this.authService.register(this.email,this.password,this.username,this.fname,this.lname,this.businessName,this.contactNumber,this.tokenId).subscribe({next:e=>{do this.signingUp=!1;while(!e);if(e.success){let t=new Date;this.currentTime=t.toLocaleString(),ps.send("service_l1qrwc6","template_spu6fzu",{from_name:this.fname+this.lname,from_email:this.email,creation_date:this.currentTime},"Tv0xOXxLvWH60MEV_").then(n=>{console.log("Email sent successfully!",n.text)}).catch(n=>{console.error("Email sending failed:",n)}),console.log("Registration request success"),this.errorMessage="",this.successMessage="Registration success!",this.email="",this.password="",this.fname="",this.lname="",this.businessName="",this.contactNumber="",this.username="",this.confirmPassword=""}else this.errorMessage=e.message,console.log(this.errorMessage)},error:e=>{console.log(e)},complete:()=>{console.log("Registration request completed")}});else{this.errorMessage="Invalid Email Format!",this.signingUp=!1;return}}static \u0275fac=function(t){return new(t||i)(se(ui),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-register"]],standalone:!0,features:[gt],decls:39,vars:15,consts:[[1,"h-screen","flex","items-center","justify-center","bg-customGreen"],[1,"sm:grid","grid-cols-1","lg:grid-cols-2","items-start","md:px-20","shadow-bottom","shadow-black","min-h-screen-sm","w-full","md:rounded-xl"],[1,"justify-center","items-center","h-full","w-full","p-5","hidden","lg:flex","bg-gray-50","rounded-l-xl"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"lg:size-4/5","object-contain","object-center"],[1,"h-full","w-full","px-5","py-20","md:p-10","justify-center","items-center","bg-gray-200","lg:rounded-l-none","rounded-l-xl","rounded-r-xl"],[1,"text-center","text-3xl","text-gray-700"],[1,"pt-4",3,"ngSubmit"],[1,"grid","grid-cols-2","col-span-1","gap-2"],[1,"form-group"],["type","text","id","fname","name","fname","required","","placeholder","First Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-1"],["type","text","id","lname","name","lname","required","","placeholder","Last Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-2"],["type","text","id","email","name","email","required","","placeholder","Enter Email",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","businessName","name","businessName","required","","placeholder","Business Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","contactNumber","name","contactNumber","required","","placeholder","Contact number",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","username","name","username","required","","placeholder","Username",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-1","relative"],["id","password","name","password","required","","placeholder","Password",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","type","ngModel"],["type","button",1,"absolute","inset-y-0","right-3","flex","items-center","text-gray-500","hover:text-gray-700","px-1","focus:outline-none",3,"click"],["aria-hidden","true",3,"ngClass"],["id","confirmpassword","name","confirmpassword","required","","placeholder","Confirm Password",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","type","ngModel"],[1,"form-group","col-span-2","p-1"],["type","submit","id","submit","name","submit",1,"h-12","rounded-full","text-white","text-sm","px-4","py-2","bg-blue-600","hover:bg-blue-900","w-full","border","border-gray-300","focus:outline-none","hover:ring-[3px]","hover:ring-customSkyBlue"],[1,"form-group","col-span-2","h-2","p-1"],["class","text-center text-green-700 text-sm ",4,"ngIf"],["class","text-center text-red-700 text-sm ",4,"ngIf"],[1,"text-center","pt-4"],[1,"text-blue-500","text-sm",3,"click"],[4,"ngIf"],[1,"text-center","text-green-700","text-sm"],[1,"text-center","text-red-700","text-sm"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),F(3,"img",3),w(),m(4,"div",4)(5,"h6",5),_(6,"Create an account!"),w(),m(7,"form",6),H("ngSubmit",function(){return n.onSignUp()}),m(8,"div",7)(9,"div",8)(10,"input",9),Ye("ngModelChange",function(s){return Xe(n.fname,s)||(n.fname=s),s}),w()(),m(11,"div",10)(12,"input",11),Ye("ngModelChange",function(s){return Xe(n.lname,s)||(n.lname=s),s}),w()(),m(13,"div",12)(14,"input",13),Ye("ngModelChange",function(s){return Xe(n.email,s)||(n.email=s),s}),w()(),m(15,"div",10)(16,"input",14),Ye("ngModelChange",function(s){return Xe(n.businessName,s)||(n.businessName=s),s}),w()(),m(17,"div",10)(18,"input",15),Ye("ngModelChange",function(s){return Xe(n.contactNumber,s)||(n.contactNumber=s),s}),w()(),m(19,"div",12)(20,"input",16),Ye("ngModelChange",function(s){return Xe(n.username,s)||(n.username=s),s}),w()(),m(21,"div",17)(22,"input",18),Ye("ngModelChange",function(s){return Xe(n.password,s)||(n.password=s),s}),w(),m(23,"button",19),H("click",function(){return n.togglePasswordVisibility("password")}),F(24,"i",20),w()(),m(25,"div",17)(26,"input",21),Ye("ngModelChange",function(s){return Xe(n.confirmPassword,s)||(n.confirmPassword=s),s}),w(),m(27,"button",19),H("click",function(){return n.togglePasswordVisibility("confirmPassword")}),F(28,"i",20),w()(),m(29,"div",22)(30,"button",23),_(31," Register "),w()(),m(32,"div",24),G(33,Tz,2,1,"p",25)(34,Iz,2,1,"p",26),w()()(),m(35,"div",27)(36,"button",28),H("click",function(){return n.goToSignIn()}),_(37,"Already have an account? Sign In"),w()()()()(),G(38,Pz,3,1,"div",29)),t&2&&(C(10),Ze("ngModel",n.fname),C(2),Ze("ngModel",n.lname),C(2),Ze("ngModel",n.email),C(2),Ze("ngModel",n.businessName),C(2),Ze("ngModel",n.contactNumber),C(2),Ze("ngModel",n.username),C(2),k("type",n.showPassword?"text":"password"),Ze("ngModel",n.password),C(2),k("ngClass",n.showPassword?"fas fa-eye-slash":"fas fa-eye"),C(2),k("type",n.showConfirmPassword?"text":"password"),Ze("ngModel",n.confirmPassword),C(2),k("ngClass",n.showConfirmPassword?"fas fa-eye-slash":"fas fa-eye"),C(5),k("ngIf",n.successMessage),C(),k("ngIf",n.errorMessage),C(4),k("ngIf",n.signingUp))},dependencies:[xt,Ji,kt,vn,Fr,_n,Sn,Nr,_o,yn,pr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var xh=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){let e=sessionStorage.getItem("userType");return this.authService.checkUserLogin()&&e=="user"?!0:(this.router.navigate(["/login"]),!1)}cantLogin(){return this.authService.checkUserLogin()?(this.router.navigate(["/dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Te(ui),Te(Qe))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var wh=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.checkUserLogin()?(this.router.navigate(["/dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Te(ui),Te(Qe))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var I_="170",zl={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},jl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Rz=0,_R=1,Lz=2;var XL=1,kz=2,Po=3,Ws=0,tr=1,ws=2,Ba=0,bc=1,SR=2,ER=3,CR=4,Nz=5,Ll=100,Fz=101,Oz=102,Bz=103,Vz=104,Uz=200,Hz=201,zz=202,jz=203,aA=204,lA=205,Gz=206,Wz=207,qz=208,Zz=209,Yz=210,Xz=211,Qz=212,Kz=213,Jz=214,dA=0,cA=1,uA=2,Cc=3,hA=4,fA=5,pA=6,mA=7,QL=0,$z=1,e7=2,Va=0,t7=1,n7=2,i7=3,r7=4,s7=5,o7=6,a7=7,MR="attached",l7="detached",TR=300,Mc=301,Tc=302,gA=303,vA=304,R0=306,Fl=1e3,Ro=1001,Fh=1002,Pi=1003,D_=1004;var vc=1005;var er=1006,Dh=1007;var js=1008;var No=1009,KL=1010,JL=1011,Oh=1012,P_=1013,Ol=1014,ys=1015,$h=1016,R_=1017,L_=1018,Ic=1020,$L=35902,e3=1021,t3=1022,Vr=1023,n3=1024,i3=1025,yc=1026,Dc=1027,k_=1028,N_=1029,r3=1030,F_=1031;var O_=1033,Xg=33776,Qg=33777,Kg=33778,Jg=33779,xA=35840,wA=35841,bA=35842,yA=35843,AA=36196,_A=37492,SA=37496,EA=37808,CA=37809,MA=37810,TA=37811,IA=37812,DA=37813,PA=37814,RA=37815,LA=37816,kA=37817,NA=37818,FA=37819,OA=37820,BA=37821,$g=36492,VA=36494,UA=36495,s3=36283,HA=36284,zA=36285,jA=36286;var Pc=2300,Rc=2301,C1=2302,IR=2400,DR=2401,PR=2402,d7=2500;var o3=0,L0=1,ef=2,c7=3200,u7=3201;var a3=0,h7=1,Fa="",fi="srgb",Ri="srgb-linear",k0="linear",ln="srgb";var nc=7680;var RR=519,f7=512,p7=513,m7=514,l3=515,g7=516,v7=517,x7=518,w7=519,GA=35044;var LR="300 es",Lo=2e3,e0=2001,Fo=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},Ii=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],kR=1234567,Ph=Math.PI/180,Lc=180/Math.PI;function Ur(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ii[i&255]+Ii[i>>8&255]+Ii[i>>16&255]+Ii[i>>24&255]+"-"+Ii[e&255]+Ii[e>>8&255]+"-"+Ii[e>>16&15|64]+Ii[e>>24&255]+"-"+Ii[t&63|128]+Ii[t>>8&255]+"-"+Ii[t>>16&255]+Ii[t>>24&255]+Ii[n&255]+Ii[n>>8&255]+Ii[n>>16&255]+Ii[n>>24&255]).toLowerCase()}function Jn(i,e,t){return Math.max(e,Math.min(t,i))}function B_(i,e){return(i%e+e)%e}function b7(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function y7(i,e,t){return i!==e?(t-i)/(e-i):0}function Rh(i,e,t){return(1-t)*i+t*e}function A7(i,e,t,n){return Rh(i,e,1-Math.exp(-t*n))}function _7(i,e=1){return e-Math.abs(B_(i,e*2)-e)}function S7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function E7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function C7(i,e){return i+Math.floor(Math.random()*(e-i+1))}function M7(i,e){return i+Math.random()*(e-i)}function T7(i){return i*(.5-Math.random())}function I7(i){i!==void 0&&(kR=i);let e=kR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function D7(i){return i*Ph}function P7(i){return i*Lc}function R7(i){return(i&i-1)===0&&i!==0}function L7(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function k7(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function N7(i,e,t,n,r){let s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),d=s((e+n)/2),c=o((e+n)/2),u=s((e-n)/2),h=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":i.set(a*c,l*u,l*h,a*d);break;case"YZY":i.set(l*h,a*c,l*u,a*d);break;case"ZXZ":i.set(l*u,l*h,a*c,a*d);break;case"XZX":i.set(a*c,l*p,l*f,a*d);break;case"YXY":i.set(l*f,a*c,l*p,a*d);break;case"ZYZ":i.set(l*p,l*f,a*c,a*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function bs(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function sn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var N0={DEG2RAD:Ph,RAD2DEG:Lc,generateUUID:Ur,clamp:Jn,euclideanModulo:B_,mapLinear:b7,inverseLerp:y7,lerp:Rh,damp:A7,pingpong:_7,smoothstep:S7,smootherstep:E7,randInt:C7,randFloat:M7,randFloatSpread:T7,seededRandom:I7,degToRad:D7,radToDeg:P7,isPowerOfTwo:R7,ceilPowerOfTwo:L7,floorPowerOfTwo:k7,setQuaternionFromProperEuler:N7,normalize:sn,denormalize:bs},we=class i{constructor(e=0,t=0){i.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Jn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Pt=class i{constructor(e,t,n,r,s,o,a,l,d){i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,d)}set(e,t,n,r,s,o,a,l,d){let c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=n,c[7]=o,c[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],d=n[1],c=n[4],u=n[7],h=n[2],f=n[5],p=n[8],x=r[0],v=r[3],g=r[6],y=r[1],b=r[4],A=r[7],M=r[2],T=r[5],I=r[8];return s[0]=o*x+a*y+l*M,s[3]=o*v+a*b+l*T,s[6]=o*g+a*A+l*I,s[1]=d*x+c*y+u*M,s[4]=d*v+c*b+u*T,s[7]=d*g+c*A+u*I,s[2]=h*x+f*y+p*M,s[5]=h*v+f*b+p*T,s[8]=h*g+f*A+p*I,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],d=e[7],c=e[8];return t*o*c-t*a*d-n*s*c+n*a*l+r*s*d-r*o*l}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],d=e[7],c=e[8],u=c*o-a*d,h=a*l-c*s,f=d*s-o*l,p=t*u+n*h+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let x=1/p;return e[0]=u*x,e[1]=(r*d-c*n)*x,e[2]=(a*n-r*o)*x,e[3]=h*x,e[4]=(c*t-r*l)*x,e[5]=(r*s-a*t)*x,e[6]=f*x,e[7]=(n*l-d*t)*x,e[8]=(o*t-n*s)*x,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){let l=Math.cos(s),d=Math.sin(s);return this.set(n*l,n*d,-n*(l*o+d*a)+o+e,-r*d,r*l,-r*(-d*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(M1.makeScale(e,t)),this}rotate(e){return this.premultiply(M1.makeRotation(-e)),this}translate(e,t){return this.premultiply(M1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},M1=new Pt;function d3(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function Bh(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function F7(){let i=Bh("canvas");return i.style.display="block",i}var NR={};function Th(i){i in NR||(NR[i]=!0,console.warn(i))}function O7(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}function B7(i){let e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function V7(i){let e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}var zt={enabled:!0,workingColorSpace:Ri,spaces:{},convert:function(i,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===ln&&(i.r=ko(i.r),i.g=ko(i.g),i.b=ko(i.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(i.applyMatrix3(this.spaces[e].toXYZ),i.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===ln&&(i.r=Ac(i.r),i.g=Ac(i.g),i.b=Ac(i.b))),i},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Fa?k0:this.spaces[i].transfer},getLuminanceCoefficients:function(i,e=this.workingColorSpace){return i.fromArray(this.spaces[e].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,e,t){return i.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}};function ko(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Ac(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var FR=[.64,.33,.3,.6,.15,.06],OR=[.2126,.7152,.0722],BR=[.3127,.329],VR=new Pt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),UR=new Pt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);zt.define({[Ri]:{primaries:FR,whitePoint:BR,transfer:k0,toXYZ:VR,fromXYZ:UR,luminanceCoefficients:OR,workingColorSpaceConfig:{unpackColorSpace:fi},outputColorSpaceConfig:{drawingBufferColorSpace:fi}},[fi]:{primaries:FR,whitePoint:BR,transfer:ln,toXYZ:VR,fromXYZ:UR,luminanceCoefficients:OR,outputColorSpaceConfig:{drawingBufferColorSpace:fi}}});var ic,WA=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ic===void 0&&(ic=Bh("canvas")),ic.width=e.width,ic.height=e.height;let n=ic.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ic}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Bh("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=ko(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ko(t[n]/255)*255):t[n]=ko(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},U7=0,t0=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:U7++}),this.uuid=Ur(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(T1(r[o].image)):s.push(T1(r[o]))}else s=T1(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function T1(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?WA.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var H7=0,Gr=(()=>{class i extends Fo{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Ro,s=Ro,o=er,a=js,l=Vr,d=No,c=i.DEFAULT_ANISOTROPY,u=Fa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:H7++}),this.uuid=Ur(),this.name="",this.source=new t0(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=c,this.format=l,this.internalFormat=null,this.type=d,this.offset=new we(0,0),this.repeat=new we(1,1),this.center=new we(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==TR)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Fl:t.x=t.x-Math.floor(t.x);break;case Ro:t.x=t.x<0?0:1;break;case Fh:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Fl:t.y=t.y-Math.floor(t.y);break;case Ro:t.y=t.y<0?0:1;break;case Fh:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=TR,i.DEFAULT_ANISOTROPY=1,i})(),Jt=class i{constructor(e=0,t=0,n=0,r=1){i.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s,l=e.elements,d=l[0],c=l[4],u=l[8],h=l[1],f=l[5],p=l[9],x=l[2],v=l[6],g=l[10];if(Math.abs(c-h)<.01&&Math.abs(u-x)<.01&&Math.abs(p-v)<.01){if(Math.abs(c+h)<.1&&Math.abs(u+x)<.1&&Math.abs(p+v)<.1&&Math.abs(d+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let b=(d+1)/2,A=(f+1)/2,M=(g+1)/2,T=(c+h)/4,I=(u+x)/4,L=(p+v)/4;return b>A&&b>M?b<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(b),r=T/n,s=I/n):A>M?A<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(A),n=T/r,s=L/r):M<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),n=I/s,r=L/s),this.set(n,r,s,t),this}let y=Math.sqrt((v-p)*(v-p)+(u-x)*(u-x)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(v-p)/y,this.y=(u-x)/y,this.z=(h-c)/y,this.w=Math.acos((d+f+g-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},qA=class extends Fo{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Jt(0,0,e,t),this.scissorTest=!1,this.viewport=new Jt(0,0,e,t);let r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:er,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let s=new Gr(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new t0(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Oo=class extends qA{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},n0=class extends Gr{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Pi,this.minFilter=Pi,this.wrapR=Ro,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};var ZA=class extends Gr{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Pi,this.minFilter=Pi,this.wrapR=Ro,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var ir=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],d=n[r+1],c=n[r+2],u=n[r+3],h=s[o+0],f=s[o+1],p=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=d,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=f,e[t+2]=p,e[t+3]=x;return}if(u!==x||l!==h||d!==f||c!==p){let v=1-a,g=l*h+d*f+c*p+u*x,y=g>=0?1:-1,b=1-g*g;if(b>Number.EPSILON){let M=Math.sqrt(b),T=Math.atan2(M,g*y);v=Math.sin(v*T)/M,a=Math.sin(a*T)/M}let A=a*y;if(l=l*v+h*A,d=d*v+f*A,c=c*v+p*A,u=u*v+x*A,v===1-a){let M=1/Math.sqrt(l*l+d*d+c*c+u*u);l*=M,d*=M,c*=M,u*=M}}e[t]=l,e[t+1]=d,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,s,o){let a=n[r],l=n[r+1],d=n[r+2],c=n[r+3],u=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+c*u+l*f-d*h,e[t+1]=l*p+c*h+d*u-a*f,e[t+2]=d*p+c*f+a*h-l*u,e[t+3]=c*p-a*u-l*h-d*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,d=a(n/2),c=a(r/2),u=a(s/2),h=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*c*u+d*f*p,this._y=d*f*u-h*c*p,this._z=d*c*p+h*f*u,this._w=d*c*u-h*f*p;break;case"YXZ":this._x=h*c*u+d*f*p,this._y=d*f*u-h*c*p,this._z=d*c*p-h*f*u,this._w=d*c*u+h*f*p;break;case"ZXY":this._x=h*c*u-d*f*p,this._y=d*f*u+h*c*p,this._z=d*c*p+h*f*u,this._w=d*c*u-h*f*p;break;case"ZYX":this._x=h*c*u-d*f*p,this._y=d*f*u+h*c*p,this._z=d*c*p-h*f*u,this._w=d*c*u+h*f*p;break;case"YZX":this._x=h*c*u+d*f*p,this._y=d*f*u+h*c*p,this._z=d*c*p-h*f*u,this._w=d*c*u-h*f*p;break;case"XZY":this._x=h*c*u-d*f*p,this._y=d*f*u-h*c*p,this._z=d*c*p+h*f*u,this._w=d*c*u+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],d=t[2],c=t[6],u=t[10],h=n+a+u;if(h>0){let f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(c-l)*f,this._y=(s-d)*f,this._z=(o-r)*f}else if(n>a&&n>u){let f=2*Math.sqrt(1+n-a-u);this._w=(c-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+d)/f}else if(a>u){let f=2*Math.sqrt(1+a-n-u);this._w=(s-d)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+c)/f}else{let f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+d)/f,this._y=(l+c)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Jn(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,d=t._z,c=t._w;return this._x=n*c+o*a+r*d-s*l,this._y=r*c+o*l+s*a-n*d,this._z=s*c+o*d+n*l-r*a,this._w=o*c-n*a-r*l-s*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;let l=1-a*a;if(l<=Number.EPSILON){let f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}let d=Math.sqrt(l),c=Math.atan2(d,a),u=Math.sin((1-t)*c)/d,h=Math.sin(t*c)/d;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},V=class i{constructor(e=0,t=0,n=0){i.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HR.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,d=2*(o*r-a*n),c=2*(a*t-s*r),u=2*(s*n-o*t);return this.x=t+l*d+o*u-a*c,this.y=n+l*c+a*d-s*u,this.z=r+l*u+s*c-o*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return I1.copy(this).projectOnVector(e),this.sub(I1)}reflect(e){return this.sub(I1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Jn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},I1=new V,HR=new ir,Hr=class{constructor(e=new V(1/0,1/0,1/0),t=new V(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(ms.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(ms.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=ms.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ms):ms.fromBufferAttribute(s,o),ms.applyMatrix4(e.matrixWorld),this.expandByPoint(ms);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),wg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),wg.copy(n.boundingBox)),wg.applyMatrix4(e.matrixWorld),this.union(wg)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ms),ms.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(bh),bg.subVectors(this.max,bh),rc.subVectors(e.a,bh),sc.subVectors(e.b,bh),oc.subVectors(e.c,bh),Da.subVectors(sc,rc),Pa.subVectors(oc,sc),Cl.subVectors(rc,oc);let t=[0,-Da.z,Da.y,0,-Pa.z,Pa.y,0,-Cl.z,Cl.y,Da.z,0,-Da.x,Pa.z,0,-Pa.x,Cl.z,0,-Cl.x,-Da.y,Da.x,0,-Pa.y,Pa.x,0,-Cl.y,Cl.x,0];return!D1(t,rc,sc,oc,bg)||(t=[1,0,0,0,1,0,0,0,1],!D1(t,rc,sc,oc,bg))?!1:(yg.crossVectors(Da,Pa),t=[yg.x,yg.y,yg.z],D1(t,rc,sc,oc,bg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ms).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ms).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Eo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Eo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Eo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Eo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Eo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Eo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Eo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Eo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Eo),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Eo=[new V,new V,new V,new V,new V,new V,new V,new V],ms=new V,wg=new Hr,rc=new V,sc=new V,oc=new V,Da=new V,Pa=new V,Cl=new V,bh=new V,bg=new V,yg=new V,Ml=new V;function D1(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Ml.fromArray(i,s);let a=r.x*Math.abs(Ml.x)+r.y*Math.abs(Ml.y)+r.z*Math.abs(Ml.z),l=e.dot(Ml),d=t.dot(Ml),c=n.dot(Ml);if(Math.max(-Math.max(l,d,c),Math.min(l,d,c))>a)return!1}return!0}var z7=new Hr,yh=new V,P1=new V,vr=class{constructor(e=new V,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):z7.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;yh.subVectors(e,this.center);let t=yh.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(yh,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(P1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(yh.copy(e.center).add(P1)),this.expandByPoint(yh.copy(e.center).sub(P1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Co=new V,R1=new V,Ag=new V,Ra=new V,L1=new V,_g=new V,k1=new V,Bo=class{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Co)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Co.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Co.copy(this.origin).addScaledVector(this.direction,t),Co.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){R1.copy(e).add(t).multiplyScalar(.5),Ag.copy(t).sub(e).normalize(),Ra.copy(this.origin).sub(R1);let s=e.distanceTo(t)*.5,o=-this.direction.dot(Ag),a=Ra.dot(this.direction),l=-Ra.dot(Ag),d=Ra.lengthSq(),c=Math.abs(1-o*o),u,h,f,p;if(c>0)if(u=o*l-a,h=o*a-l,p=s*c,u>=0)if(h>=-p)if(h<=p){let x=1/c;u*=x,h*=x,f=u*(u+o*h+2*a)+h*(o*u+h+2*l)+d}else h=s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+d;else h=-s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+d;else h<=-p?(u=Math.max(0,-(-o*s+a)),h=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+d):h<=p?(u=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+d):(u=Math.max(0,-(o*s+a)),h=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+d);else h=o>0?-s:s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(R1).addScaledVector(Ag,h),f}intersectSphere(e,t){Co.subVectors(e.center,this.origin);let n=Co.dot(this.direction),r=Co.dot(Co)-n*n,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l,d=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return d>=0?(n=(e.min.x-h.x)*d,r=(e.max.x-h.x)*d):(n=(e.max.x-h.x)*d,r=(e.min.x-h.x)*d),c>=0?(s=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(s=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-h.z)*u,l=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,l=(e.min.z-h.z)*u),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Co)!==null}intersectTriangle(e,t,n,r,s){L1.subVectors(t,e),_g.subVectors(n,e),k1.crossVectors(L1,_g);let o=this.direction.dot(k1),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ra.subVectors(this.origin,e);let l=a*this.direction.dot(_g.crossVectors(Ra,_g));if(l<0)return null;let d=a*this.direction.dot(L1.cross(Ra));if(d<0||l+d>o)return null;let c=-a*Ra.dot(k1);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},_t=class i{constructor(e,t,n,r,s,o,a,l,d,c,u,h,f,p,x,v){i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,d,c,u,h,f,p,x,v)}set(e,t,n,r,s,o,a,l,d,c,u,h,f,p,x,v){let g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=d,g[6]=c,g[10]=u,g[14]=h,g[3]=f,g[7]=p,g[11]=x,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new i().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/ac.setFromMatrixColumn(e,0).length(),s=1/ac.setFromMatrixColumn(e,1).length(),o=1/ac.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),d=Math.sin(r),c=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){let h=o*c,f=o*u,p=a*c,x=a*u;t[0]=l*c,t[4]=-l*u,t[8]=d,t[1]=f+p*d,t[5]=h-x*d,t[9]=-a*l,t[2]=x-h*d,t[6]=p+f*d,t[10]=o*l}else if(e.order==="YXZ"){let h=l*c,f=l*u,p=d*c,x=d*u;t[0]=h+x*a,t[4]=p*a-f,t[8]=o*d,t[1]=o*u,t[5]=o*c,t[9]=-a,t[2]=f*a-p,t[6]=x+h*a,t[10]=o*l}else if(e.order==="ZXY"){let h=l*c,f=l*u,p=d*c,x=d*u;t[0]=h-x*a,t[4]=-o*u,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*c,t[9]=x-h*a,t[2]=-o*d,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){let h=o*c,f=o*u,p=a*c,x=a*u;t[0]=l*c,t[4]=p*d-f,t[8]=h*d+x,t[1]=l*u,t[5]=x*d+h,t[9]=f*d-p,t[2]=-d,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){let h=o*l,f=o*d,p=a*l,x=a*d;t[0]=l*c,t[4]=x-h*u,t[8]=p*u+f,t[1]=u,t[5]=o*c,t[9]=-a*c,t[2]=-d*c,t[6]=f*u+p,t[10]=h-x*u}else if(e.order==="XZY"){let h=o*l,f=o*d,p=a*l,x=a*d;t[0]=l*c,t[4]=-u,t[8]=d*c,t[1]=h*u+x,t[5]=o*c,t[9]=f*u-p,t[2]=p*u-f,t[6]=a*c,t[10]=x*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(j7,e,G7)}lookAt(e,t,n){let r=this.elements;return mr.subVectors(e,t),mr.lengthSq()===0&&(mr.z=1),mr.normalize(),La.crossVectors(n,mr),La.lengthSq()===0&&(Math.abs(n.z)===1?mr.x+=1e-4:mr.z+=1e-4,mr.normalize(),La.crossVectors(n,mr)),La.normalize(),Sg.crossVectors(mr,La),r[0]=La.x,r[4]=Sg.x,r[8]=mr.x,r[1]=La.y,r[5]=Sg.y,r[9]=mr.y,r[2]=La.z,r[6]=Sg.z,r[10]=mr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],d=n[12],c=n[1],u=n[5],h=n[9],f=n[13],p=n[2],x=n[6],v=n[10],g=n[14],y=n[3],b=n[7],A=n[11],M=n[15],T=r[0],I=r[4],L=r[8],E=r[12],S=r[1],P=r[5],j=r[9],B=r[13],z=r[2],X=r[6],Q=r[10],K=r[14],Y=r[3],Ae=r[7],Ce=r[11],Ie=r[15];return s[0]=o*T+a*S+l*z+d*Y,s[4]=o*I+a*P+l*X+d*Ae,s[8]=o*L+a*j+l*Q+d*Ce,s[12]=o*E+a*B+l*K+d*Ie,s[1]=c*T+u*S+h*z+f*Y,s[5]=c*I+u*P+h*X+f*Ae,s[9]=c*L+u*j+h*Q+f*Ce,s[13]=c*E+u*B+h*K+f*Ie,s[2]=p*T+x*S+v*z+g*Y,s[6]=p*I+x*P+v*X+g*Ae,s[10]=p*L+x*j+v*Q+g*Ce,s[14]=p*E+x*B+v*K+g*Ie,s[3]=y*T+b*S+A*z+M*Y,s[7]=y*I+b*P+A*X+M*Ae,s[11]=y*L+b*j+A*Q+M*Ce,s[15]=y*E+b*B+A*K+M*Ie,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],d=e[13],c=e[2],u=e[6],h=e[10],f=e[14],p=e[3],x=e[7],v=e[11],g=e[15];return p*(+s*l*u-r*d*u-s*a*h+n*d*h+r*a*f-n*l*f)+x*(+t*l*f-t*d*h+s*o*h-r*o*f+r*d*c-s*l*c)+v*(+t*d*u-t*a*f-s*o*u+n*o*f+s*a*c-n*d*c)+g*(-r*a*c-t*l*u+t*a*h+r*o*u-n*o*h+n*l*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],d=e[7],c=e[8],u=e[9],h=e[10],f=e[11],p=e[12],x=e[13],v=e[14],g=e[15],y=u*v*d-x*h*d+x*l*f-a*v*f-u*l*g+a*h*g,b=p*h*d-c*v*d-p*l*f+o*v*f+c*l*g-o*h*g,A=c*x*d-p*u*d+p*a*f-o*x*f-c*a*g+o*u*g,M=p*u*l-c*x*l-p*a*h+o*x*h+c*a*v-o*u*v,T=t*y+n*b+r*A+s*M;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let I=1/T;return e[0]=y*I,e[1]=(x*h*s-u*v*s-x*r*f+n*v*f+u*r*g-n*h*g)*I,e[2]=(a*v*s-x*l*s+x*r*d-n*v*d-a*r*g+n*l*g)*I,e[3]=(u*l*s-a*h*s-u*r*d+n*h*d+a*r*f-n*l*f)*I,e[4]=b*I,e[5]=(c*v*s-p*h*s+p*r*f-t*v*f-c*r*g+t*h*g)*I,e[6]=(p*l*s-o*v*s-p*r*d+t*v*d+o*r*g-t*l*g)*I,e[7]=(o*h*s-c*l*s+c*r*d-t*h*d-o*r*f+t*l*f)*I,e[8]=A*I,e[9]=(p*u*s-c*x*s-p*n*f+t*x*f+c*n*g-t*u*g)*I,e[10]=(o*x*s-p*a*s+p*n*d-t*x*d-o*n*g+t*a*g)*I,e[11]=(c*a*s-o*u*s-c*n*d+t*u*d+o*n*f-t*a*f)*I,e[12]=M*I,e[13]=(c*x*r-p*u*r+p*n*h-t*x*h-c*n*v+t*u*v)*I,e[14]=(p*a*r-o*x*r-p*n*l+t*x*l+o*n*v-t*a*v)*I,e[15]=(o*u*r-c*a*r+c*n*l-t*u*l-o*n*h+t*a*h)*I,this}scale(e){let t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,d=s*o,c=s*a;return this.set(d*o+n,d*a-r*l,d*l+r*a,0,d*a+r*l,c*a+n,c*l-r*o,0,d*l-r*a,c*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,d=s+s,c=o+o,u=a+a,h=s*d,f=s*c,p=s*u,x=o*c,v=o*u,g=a*u,y=l*d,b=l*c,A=l*u,M=n.x,T=n.y,I=n.z;return r[0]=(1-(x+g))*M,r[1]=(f+A)*M,r[2]=(p-b)*M,r[3]=0,r[4]=(f-A)*T,r[5]=(1-(h+g))*T,r[6]=(v+y)*T,r[7]=0,r[8]=(p+b)*I,r[9]=(v-y)*I,r[10]=(1-(h+x))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,s=ac.set(r[0],r[1],r[2]).length(),o=ac.set(r[4],r[5],r[6]).length(),a=ac.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],gs.copy(this);let d=1/s,c=1/o,u=1/a;return gs.elements[0]*=d,gs.elements[1]*=d,gs.elements[2]*=d,gs.elements[4]*=c,gs.elements[5]*=c,gs.elements[6]*=c,gs.elements[8]*=u,gs.elements[9]*=u,gs.elements[10]*=u,t.setFromRotationMatrix(gs),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=Lo){let l=this.elements,d=2*s/(t-e),c=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),f,p;if(a===Lo)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===e0)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=d,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=c,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=Lo){let l=this.elements,d=1/(t-e),c=1/(n-r),u=1/(o-s),h=(t+e)*d,f=(n+r)*c,p,x;if(a===Lo)p=(o+s)*u,x=-2*u;else if(a===e0)p=s*u,x=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*d,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=x,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},ac=new V,gs=new _t,j7=new V(0,0,0),G7=new V(1,1,1),La=new V,Sg=new V,mr=new V,zR=new _t,jR=new ir,Bl=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){let s=t.elements,o=s[0],a=s[4],l=s[8],d=s[1],c=s[5],u=s[9],h=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Jn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Jn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(d,c)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Jn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(d,o));break;case"ZYX":this._y=Math.asin(-Jn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(d,o)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Jn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Jn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return zR.makeRotationFromQuaternion(t),this.setFromRotationMatrix(zR,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return jR.setFromEuler(this),this.setFromQuaternion(jR,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})(),Vh=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},W7=0,GR=new V,lc=new ir,Mo=new _t,Eg=new V,Ah=new V,q7=new V,Z7=new ir,WR=new V(1,0,0),qR=new V(0,1,0),ZR=new V(0,0,1),YR={type:"added"},Y7={type:"removed"},dc={type:"childadded",child:null},N1={type:"childremoved",child:null},yi=(()=>{class i extends Fo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:W7++}),this.uuid=Ur(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();let t=new V,n=new Bl,r=new ir,s=new V(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new _t},normalMatrix:{value:new Pt}}),this.matrix=new _t,this.matrixWorld=new _t,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Vh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return lc.setFromAxisAngle(t,n),this.quaternion.multiply(lc),this}rotateOnWorldAxis(t,n){return lc.setFromAxisAngle(t,n),this.quaternion.premultiply(lc),this}rotateX(t){return this.rotateOnAxis(WR,t)}rotateY(t){return this.rotateOnAxis(qR,t)}rotateZ(t){return this.rotateOnAxis(ZR,t)}translateOnAxis(t,n){return GR.copy(t).applyQuaternion(this.quaternion),this.position.add(GR.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(WR,t)}translateY(t){return this.translateOnAxis(qR,t)}translateZ(t){return this.translateOnAxis(ZR,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Mo.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Eg.copy(t):Eg.set(t,n,r);let s=this.parent;this.updateWorldMatrix(!0,!1),Ah.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mo.lookAt(Ah,Eg,this.up):Mo.lookAt(Eg,Ah,this.up),this.quaternion.setFromRotationMatrix(Mo),s&&(Mo.extractRotation(s.matrixWorld),lc.setFromRotationMatrix(Mo),this.quaternion.premultiply(lc.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(YR),dc.child=t,this.dispatchEvent(dc),dc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Y7),N1.child=t,this.dispatchEvent(N1),N1.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Mo.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Mo.multiply(t.parent.matrixWorld)),t.applyMatrix4(Mo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(YR),dc.child=t,this.dispatchEvent(dc),dc.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(t,n);if(a!==void 0)return a}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ah,t,q7),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ah,Z7,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){let n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){let r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){let n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(l,d){return l[d.uuid]===void 0&&(l[d.uuid]=d.toJSON(t)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);let l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){let d=l.shapes;if(Array.isArray(d))for(let c=0,u=d.length;c<u;c++){let h=d[c];o(t.shapes,h)}else o(t.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let l=[];for(let d=0,c=this.material.length;d<c;d++)l.push(o(t.materials,this.material[d]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){let d=this.animations[l];s.animations.push(o(t.animations,d))}}if(n){let l=a(t.geometries),d=a(t.materials),c=a(t.textures),u=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),x=a(t.nodes);l.length>0&&(r.geometries=l),d.length>0&&(r.materials=d),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),x.length>0&&(r.nodes=x)}return r.object=s,r;function a(l){let d=[];for(let c in l){let u=l[c];delete u.metadata,d.push(u)}return d}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){let s=t.children[r];this.add(s.clone())}return this}}return i.DEFAULT_UP=new V(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})(),vs=new V,To=new V,F1=new V,Io=new V,cc=new V,uc=new V,XR=new V,O1=new V,B1=new V,V1=new V,U1=new Jt,H1=new Jt,z1=new Jt,kl=class i{constructor(e=new V,t=new V,n=new V){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),vs.subVectors(e,t),r.cross(vs);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){vs.subVectors(r,t),To.subVectors(n,t),F1.subVectors(e,t);let o=vs.dot(vs),a=vs.dot(To),l=vs.dot(F1),d=To.dot(To),c=To.dot(F1),u=o*d-a*a;if(u===0)return s.set(0,0,0),null;let h=1/u,f=(d*l-a*c)*h,p=(o*c-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Io)===null?!1:Io.x>=0&&Io.y>=0&&Io.x+Io.y<=1}static getInterpolation(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Io)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Io.x),l.addScaledVector(o,Io.y),l.addScaledVector(a,Io.z),l)}static getInterpolatedAttribute(e,t,n,r,s,o){return U1.setScalar(0),H1.setScalar(0),z1.setScalar(0),U1.fromBufferAttribute(e,t),H1.fromBufferAttribute(e,n),z1.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(U1,s.x),o.addScaledVector(H1,s.y),o.addScaledVector(z1,s.z),o}static isFrontFacing(e,t,n,r){return vs.subVectors(n,t),To.subVectors(e,t),vs.cross(To).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vs.subVectors(this.c,this.b),To.subVectors(this.a,this.b),vs.cross(To).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return i.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return i.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,s=this.c,o,a;cc.subVectors(r,n),uc.subVectors(s,n),O1.subVectors(e,n);let l=cc.dot(O1),d=uc.dot(O1);if(l<=0&&d<=0)return t.copy(n);B1.subVectors(e,r);let c=cc.dot(B1),u=uc.dot(B1);if(c>=0&&u<=c)return t.copy(r);let h=l*u-c*d;if(h<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(n).addScaledVector(cc,o);V1.subVectors(e,s);let f=cc.dot(V1),p=uc.dot(V1);if(p>=0&&f<=p)return t.copy(s);let x=f*d-l*p;if(x<=0&&d>=0&&p<=0)return a=d/(d-p),t.copy(n).addScaledVector(uc,a);let v=c*p-f*u;if(v<=0&&u-c>=0&&f-p>=0)return XR.subVectors(s,r),a=(u-c)/(u-c+(f-p)),t.copy(r).addScaledVector(XR,a);let g=1/(v+x+h);return o=x*g,a=h*g,t.copy(n).addScaledVector(cc,o).addScaledVector(uc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},c3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ka={h:0,s:0,l:0},Cg={h:0,s:0,l:0};function j1(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var mt=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,zt.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=zt.workingColorSpace){return this.r=e,this.g=t,this.b=n,zt.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=zt.workingColorSpace){if(e=B_(e,1),t=Jn(t,0,1),n=Jn(n,0,1),t===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=j1(o,s,e+1/3),this.g=j1(o,s,e),this.b=j1(o,s,e-1/3)}return zt.toWorkingColorSpace(this,r),this}setStyle(e,t=fi){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fi){let n=c3[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ko(e.r),this.g=ko(e.g),this.b=ko(e.b),this}copyLinearToSRGB(e){return this.r=Ac(e.r),this.g=Ac(e.g),this.b=Ac(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fi){return zt.fromWorkingColorSpace(Di.copy(this),e),Math.round(Jn(Di.r*255,0,255))*65536+Math.round(Jn(Di.g*255,0,255))*256+Math.round(Jn(Di.b*255,0,255))}getHexString(e=fi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=zt.workingColorSpace){zt.fromWorkingColorSpace(Di.copy(this),t);let n=Di.r,r=Di.g,s=Di.b,o=Math.max(n,r,s),a=Math.min(n,r,s),l,d,c=(a+o)/2;if(a===o)l=0,d=0;else{let u=o-a;switch(d=c<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return e.h=l,e.s=d,e.l=c,e}getRGB(e,t=zt.workingColorSpace){return zt.fromWorkingColorSpace(Di.copy(this),t),e.r=Di.r,e.g=Di.g,e.b=Di.b,e}getStyle(e=fi){zt.fromWorkingColorSpace(Di.copy(this),e);let t=Di.r,n=Di.g,r=Di.b;return e!==fi?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(ka),this.setHSL(ka.h+e,ka.s+t,ka.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ka),e.getHSL(Cg);let n=Rh(ka.h,Cg.h,t),r=Rh(ka.s,Cg.s,t),s=Rh(ka.l,Cg.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},Di=new mt;mt.NAMES=c3;var X7=0,Tn=class extends Fo{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:X7++}),this.uuid=Ur(),this.name="",this.blending=bc,this.side=Ws,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=aA,this.blendDst=lA,this.blendEquation=Ll,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new mt(0,0,0),this.blendAlpha=0,this.depthFunc=Cc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=RR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=nc,this.stencilZFail=nc,this.stencilZPass=nc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==bc&&(n.blending=this.blending),this.side!==Ws&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==aA&&(n.blendSrc=this.blendSrc),this.blendDst!==lA&&(n.blendDst=this.blendDst),this.blendEquation!==Ll&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Cc&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==RR&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==nc&&(n.stencilFail=this.stencilFail),this.stencilZFail!==nc&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==nc&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){let o=[];for(let a in s){let l=s[a];delete l.metadata,o.push(l)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},fn=class extends Tn{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new mt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bl,this.combine=QL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var Yn=new V,Mg=new we,$n=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=GA,this.updateRanges=[],this.gpuType=ys,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Mg.fromBufferAttribute(this,t),Mg.applyMatrix3(e),this.setXY(t,Mg.x,Mg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix3(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix4(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyNormalMatrix(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.transformDirection(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=bs(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=sn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=bs(t,this.array)),t}setX(e,t){return this.normalized&&(t=sn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=bs(t,this.array)),t}setY(e,t){return this.normalized&&(t=sn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=bs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=sn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=bs(t,this.array)),t}setW(e,t){return this.normalized&&(t=sn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array),r=sn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array),r=sn(r,this.array),s=sn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==GA&&(e.usage=this.usage),e}};var i0=class extends $n{constructor(e,t,n){super(new Uint16Array(e),t,n)}};var r0=class extends $n{constructor(e,t,n){super(new Uint32Array(e),t,n)}};var nr=class extends $n{constructor(e,t,n){super(new Float32Array(e),t,n)}},Q7=0,Br=new _t,G1=new yi,hc=new V,gr=new Hr,_h=new Hr,hi=new V,xr=class i extends Fo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Q7++}),this.uuid=Ur(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(d3(e)?r0:i0)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let s=new Pt().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Br.makeRotationFromQuaternion(e),this.applyMatrix4(Br),this}rotateX(e){return Br.makeRotationX(e),this.applyMatrix4(Br),this}rotateY(e){return Br.makeRotationY(e),this.applyMatrix4(Br),this}rotateZ(e){return Br.makeRotationZ(e),this.applyMatrix4(Br),this}translate(e,t,n){return Br.makeTranslation(e,t,n),this.applyMatrix4(Br),this}scale(e,t,n){return Br.makeScale(e,t,n),this.applyMatrix4(Br),this}lookAt(e){return G1.lookAt(e),G1.updateMatrix(),this.applyMatrix4(G1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(hc).negate(),this.translate(hc.x,hc.y,hc.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let n=[];for(let r=0,s=e.length;r<s;r++){let o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new nr(n,3))}else{for(let n=0,r=t.count;n<r;n++){let s=e[n];t.setXYZ(n,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let s=t[n];gr.setFromBufferAttribute(s),this.morphTargetsRelative?(hi.addVectors(this.boundingBox.min,gr.min),this.boundingBox.expandByPoint(hi),hi.addVectors(this.boundingBox.max,gr.max),this.boundingBox.expandByPoint(hi)):(this.boundingBox.expandByPoint(gr.min),this.boundingBox.expandByPoint(gr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new vr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new V,1/0);return}if(e){let n=this.boundingSphere.center;if(gr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];_h.setFromBufferAttribute(a),this.morphTargetsRelative?(hi.addVectors(gr.min,_h.min),gr.expandByPoint(hi),hi.addVectors(gr.max,_h.max),gr.expandByPoint(hi)):(gr.expandByPoint(_h.min),gr.expandByPoint(_h.max))}gr.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)hi.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(hi));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],l=this.morphTargetsRelative;for(let d=0,c=a.count;d<c;d++)hi.fromBufferAttribute(a,d),l&&(hc.fromBufferAttribute(e,d),hi.add(hc)),r=Math.max(r,n.distanceToSquared(hi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $n(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),a=[],l=[];for(let L=0;L<n.count;L++)a[L]=new V,l[L]=new V;let d=new V,c=new V,u=new V,h=new we,f=new we,p=new we,x=new V,v=new V;function g(L,E,S){d.fromBufferAttribute(n,L),c.fromBufferAttribute(n,E),u.fromBufferAttribute(n,S),h.fromBufferAttribute(s,L),f.fromBufferAttribute(s,E),p.fromBufferAttribute(s,S),c.sub(d),u.sub(d),f.sub(h),p.sub(h);let P=1/(f.x*p.y-p.x*f.y);isFinite(P)&&(x.copy(c).multiplyScalar(p.y).addScaledVector(u,-f.y).multiplyScalar(P),v.copy(u).multiplyScalar(f.x).addScaledVector(c,-p.x).multiplyScalar(P),a[L].add(x),a[E].add(x),a[S].add(x),l[L].add(v),l[E].add(v),l[S].add(v))}let y=this.groups;y.length===0&&(y=[{start:0,count:e.count}]);for(let L=0,E=y.length;L<E;++L){let S=y[L],P=S.start,j=S.count;for(let B=P,z=P+j;B<z;B+=3)g(e.getX(B+0),e.getX(B+1),e.getX(B+2))}let b=new V,A=new V,M=new V,T=new V;function I(L){M.fromBufferAttribute(r,L),T.copy(M);let E=a[L];b.copy(E),b.sub(M.multiplyScalar(M.dot(E))).normalize(),A.crossVectors(T,E);let P=A.dot(l[L])<0?-1:1;o.setXYZW(L,b.x,b.y,b.z,P)}for(let L=0,E=y.length;L<E;++L){let S=y[L],P=S.start,j=S.count;for(let B=P,z=P+j;B<z;B+=3)I(e.getX(B+0)),I(e.getX(B+1)),I(e.getX(B+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new $n(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let h=0,f=n.count;h<f;h++)n.setXYZ(h,0,0,0);let r=new V,s=new V,o=new V,a=new V,l=new V,d=new V,c=new V,u=new V;if(e)for(let h=0,f=e.count;h<f;h+=3){let p=e.getX(h+0),x=e.getX(h+1),v=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,v),c.subVectors(o,s),u.subVectors(r,s),c.cross(u),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,x),d.fromBufferAttribute(n,v),a.add(c),l.add(c),d.add(c),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(v,d.x,d.y,d.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),c.subVectors(o,s),u.subVectors(r,s),c.cross(u),n.setXYZ(h+0,c.x,c.y,c.z),n.setXYZ(h+1,c.x,c.y,c.z),n.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)hi.fromBufferAttribute(e,t),hi.normalize(),e.setXYZ(t,hi.x,hi.y,hi.z)}toNonIndexed(){function e(a,l){let d=a.array,c=a.itemSize,u=a.normalized,h=new d.constructor(l.length*c),f=0,p=0;for(let x=0,v=l.length;x<v;x++){a.isInterleavedBufferAttribute?f=l[x]*a.data.stride+a.offset:f=l[x]*c;for(let g=0;g<c;g++)h[p++]=d[f++]}return new $n(h,c,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new i,n=this.index.array,r=this.attributes;for(let a in r){let l=r[a],d=e(l,n);t.setAttribute(a,d)}let s=this.morphAttributes;for(let a in s){let l=[],d=s[a];for(let c=0,u=d.length;c<u;c++){let h=d[c],f=e(h,n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let d=o[a];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let d in l)l[d]!==void 0&&(e[d]=l[d]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let l in n){let d=n[l];e.data.attributes[l]=d.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let d=this.morphAttributes[l],c=[];for(let u=0,h=d.length;u<h;u++){let f=d[u];c.push(f.toJSON(e.data))}c.length>0&&(r[l]=c,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let d in r){let c=r[d];this.setAttribute(d,c.clone(t))}let s=e.morphAttributes;for(let d in s){let c=[],u=s[d];for(let h=0,f=u.length;h<f;h++)c.push(u[h].clone(t));this.morphAttributes[d]=c}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let d=0,c=o.length;d<c;d++){let u=o[d];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},QR=new _t,Tl=new Bo,Tg=new vr,KR=new V,Ig=new V,Dg=new V,Pg=new V,W1=new V,Rg=new V,JR=new V,Lg=new V,jt=class extends yi{constructor(e=new xr,t=new fn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){Rg.set(0,0,0);for(let l=0,d=s.length;l<d;l++){let c=a[l],u=s[l];c!==0&&(W1.fromBufferAttribute(u,e),o?Rg.addScaledVector(W1,c):Rg.addScaledVector(W1.sub(t),c))}t.add(Rg)}return t}raycast(e,t){let n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Tg.copy(n.boundingSphere),Tg.applyMatrix4(s),Tl.copy(e.ray).recast(e.near),!(Tg.containsPoint(Tl.origin)===!1&&(Tl.intersectSphere(Tg,KR)===null||Tl.origin.distanceToSquared(KR)>(e.far-e.near)**2))&&(QR.copy(s).invert(),Tl.copy(e.ray).applyMatrix4(QR),!(n.boundingBox!==null&&Tl.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Tl)))}_computeIntersections(e,t,n){let r,s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,d=s.attributes.uv,c=s.attributes.uv1,u=s.attributes.normal,h=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,x=h.length;p<x;p++){let v=h[p],g=o[v.materialIndex],y=Math.max(v.start,f.start),b=Math.min(a.count,Math.min(v.start+v.count,f.start+f.count));for(let A=y,M=b;A<M;A+=3){let T=a.getX(A),I=a.getX(A+1),L=a.getX(A+2);r=kg(this,g,e,n,d,c,u,T,I,L),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{let p=Math.max(0,f.start),x=Math.min(a.count,f.start+f.count);for(let v=p,g=x;v<g;v+=3){let y=a.getX(v),b=a.getX(v+1),A=a.getX(v+2);r=kg(this,o,e,n,d,c,u,y,b,A),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,x=h.length;p<x;p++){let v=h[p],g=o[v.materialIndex],y=Math.max(v.start,f.start),b=Math.min(l.count,Math.min(v.start+v.count,f.start+f.count));for(let A=y,M=b;A<M;A+=3){let T=A,I=A+1,L=A+2;r=kg(this,g,e,n,d,c,u,T,I,L),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{let p=Math.max(0,f.start),x=Math.min(l.count,f.start+f.count);for(let v=p,g=x;v<g;v+=3){let y=v,b=v+1,A=v+2;r=kg(this,o,e,n,d,c,u,y,b,A),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}}};function K7(i,e,t,n,r,s,o,a){let l;if(e.side===tr?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Ws,a),l===null)return null;Lg.copy(a),Lg.applyMatrix4(i.matrixWorld);let d=t.ray.origin.distanceTo(Lg);return d<t.near||d>t.far?null:{distance:d,point:Lg.clone(),object:i}}function kg(i,e,t,n,r,s,o,a,l,d){i.getVertexPosition(a,Ig),i.getVertexPosition(l,Dg),i.getVertexPosition(d,Pg);let c=K7(i,e,t,n,Ig,Dg,Pg,JR);if(c){let u=new V;kl.getBarycoord(JR,Ig,Dg,Pg,u),r&&(c.uv=kl.getInterpolatedAttribute(r,a,l,d,u,new we)),s&&(c.uv1=kl.getInterpolatedAttribute(s,a,l,d,u,new we)),o&&(c.normal=kl.getInterpolatedAttribute(o,a,l,d,u,new V),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));let h={a,b:l,c:d,normal:new V,materialIndex:0};kl.getNormal(Ig,Dg,Pg,h.normal),c.face=h,c.barycoord=u}return c}var qs=class i extends xr{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let l=[],d=[],c=[],u=[],h=0,f=0;p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new nr(d,3)),this.setAttribute("normal",new nr(c,3)),this.setAttribute("uv",new nr(u,2));function p(x,v,g,y,b,A,M,T,I,L,E){let S=A/I,P=M/L,j=A/2,B=M/2,z=T/2,X=I+1,Q=L+1,K=0,Y=0,Ae=new V;for(let Ce=0;Ce<Q;Ce++){let Ie=Ce*P-B;for(let He=0;He<X;He++){let at=He*S-j;Ae[x]=at*y,Ae[v]=Ie*b,Ae[g]=z,d.push(Ae.x,Ae.y,Ae.z),Ae[x]=0,Ae[v]=0,Ae[g]=T>0?1:-1,c.push(Ae.x,Ae.y,Ae.z),u.push(He/I),u.push(1-Ce/L),K+=1}}for(let Ce=0;Ce<L;Ce++)for(let Ie=0;Ie<I;Ie++){let He=h+Ie+X*Ce,at=h+Ie+X*(Ce+1),le=h+(Ie+1)+X*(Ce+1),be=h+(Ie+1)+X*Ce;l.push(He,at,be),l.push(at,le,be),Y+=6}a.addGroup(f,Y,E),f+=Y,h+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function kc(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Gi(i){let e={};for(let t=0;t<i.length;t++){let n=kc(i[t]);for(let r in n)e[r]=n[r]}return e}function J7(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function u3(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:zt.workingColorSpace}var $7={clone:kc,merge:Gi},e9=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,t9=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Zs=class extends Tn{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=e9,this.fragmentShader=t9,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=kc(e.uniforms),this.uniformsGroups=J7(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},s0=class extends yi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _t,this.projectionMatrix=new _t,this.projectionMatrixInverse=new _t,this.coordinateSystem=Lo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Na=new V,$R=new we,eL=new we,Un=class extends s0{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Lc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Ph*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Lc*2*Math.atan(Math.tan(Ph*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Na.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Na.x,Na.y).multiplyScalar(-e/Na.z),Na.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Na.x,Na.y).multiplyScalar(-e/Na.z)}getViewSize(e,t){return this.getViewBounds(e,$R,eL),t.subVectors(eL,$R)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Ph*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,d=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/d,r*=o.width/l,n*=o.height/d}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},fc=-90,pc=1,YA=class extends yi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Un(fc,pc,e,t);r.layers=this.layers,this.add(r);let s=new Un(fc,pc,e,t);s.layers=this.layers,this.add(s);let o=new Un(fc,pc,e,t);o.layers=this.layers,this.add(o);let a=new Un(fc,pc,e,t);a.layers=this.layers,this.add(a);let l=new Un(fc,pc,e,t);l.layers=this.layers,this.add(l);let d=new Un(fc,pc,e,t);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,l]=t;for(let d of t)this.remove(d);if(e===Lo)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===e0)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let d of t)this.add(d),d.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,l,d,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;let x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,d),n.texture.generateMipmaps=x,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,h,f),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}},o0=class extends Gr{constructor(e,t,n,r,s,o,a,l,d,c){e=e!==void 0?e:[],t=t!==void 0?t:Mc,super(e,t,n,r,s,o,a,l,d,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},XA=class extends Oo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new o0(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:er}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new qs(5,5,5),s=new Zs({name:"CubemapFromEquirect",uniforms:kc(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:tr,blending:Ba});s.uniforms.tEquirect.value=t;let o=new jt(r,s),a=t.minFilter;return t.minFilter===js&&(t.minFilter=er),new YA(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}},q1=new V,n9=new V,i9=new Pt,xs=class{constructor(e=new V(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=q1.subVectors(n,t).cross(n9.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(q1),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||i9.getNormalMatrix(e),r=this.coplanarPoint(q1).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Il=new vr,Ng=new V,Uh=class{constructor(e=new xs,t=new xs,n=new xs,r=new xs,s=new xs,o=new xs){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Lo){let n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],d=r[4],c=r[5],u=r[6],h=r[7],f=r[8],p=r[9],x=r[10],v=r[11],g=r[12],y=r[13],b=r[14],A=r[15];if(n[0].setComponents(l-s,h-d,v-f,A-g).normalize(),n[1].setComponents(l+s,h+d,v+f,A+g).normalize(),n[2].setComponents(l+o,h+c,v+p,A+y).normalize(),n[3].setComponents(l-o,h-c,v-p,A-y).normalize(),n[4].setComponents(l-a,h-u,v-x,A-b).normalize(),t===Lo)n[5].setComponents(l+a,h+u,v+x,A+b).normalize();else if(t===e0)n[5].setComponents(a,u,x,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Il.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Il.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Il)}intersectsSprite(e){return Il.center.set(0,0,0),Il.radius=.7071067811865476,Il.applyMatrix4(e.matrixWorld),this.intersectsSphere(Il)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(Ng.x=r.normal.x>0?e.max.x:e.min.x,Ng.y=r.normal.y>0?e.max.y:e.min.y,Ng.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Ng)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function h3(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function r9(i){let e=new WeakMap;function t(a,l){let d=a.array,c=a.usage,u=d.byteLength,h=i.createBuffer();i.bindBuffer(l,h),i.bufferData(l,d,c),a.onUploadCallback();let f;if(d instanceof Float32Array)f=i.FLOAT;else if(d instanceof Uint16Array)a.isFloat16BufferAttribute?f=i.HALF_FLOAT:f=i.UNSIGNED_SHORT;else if(d instanceof Int16Array)f=i.SHORT;else if(d instanceof Uint32Array)f=i.UNSIGNED_INT;else if(d instanceof Int32Array)f=i.INT;else if(d instanceof Int8Array)f=i.BYTE;else if(d instanceof Uint8Array)f=i.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)f=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:h,type:f,bytesPerElement:d.BYTES_PER_ELEMENT,version:a.version,size:u}}function n(a,l,d){let c=l.array,u=l.updateRanges;if(i.bindBuffer(d,a),u.length===0)i.bufferSubData(d,0,c);else{u.sort((f,p)=>f.start-p.start);let h=0;for(let f=1;f<u.length;f++){let p=u[h],x=u[f];x.start<=p.start+p.count+1?p.count=Math.max(p.count,x.start+x.count-p.start):(++h,u[h]=x)}u.length=h+1;for(let f=0,p=u.length;f<p;f++){let x=u[f];i.bufferSubData(d,x.start*c.BYTES_PER_ELEMENT,c,x.start,x.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let l=e.get(a);l&&(i.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let c=e.get(a);(!c||c.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let d=e.get(a);if(d===void 0)e.set(a,t(a,l));else if(d.version<a.version){if(d.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(d.buffer,a,l),d.version=a.version}}return{get:r,remove:s,update:o}}var a0=class i extends xr{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),d=a+1,c=l+1,u=e/a,h=t/l,f=[],p=[],x=[],v=[];for(let g=0;g<c;g++){let y=g*h-o;for(let b=0;b<d;b++){let A=b*u-s;p.push(A,-y,0),x.push(0,0,1),v.push(b/a),v.push(1-g/l)}}for(let g=0;g<l;g++)for(let y=0;y<a;y++){let b=y+d*g,A=y+d*(g+1),M=y+1+d*(g+1),T=y+1+d*g;f.push(b,A,T),f.push(A,M,T)}this.setIndex(f),this.setAttribute("position",new nr(p,3)),this.setAttribute("normal",new nr(x,3)),this.setAttribute("uv",new nr(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.widthSegments,e.heightSegments)}},s9=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,o9=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,a9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,l9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,d9=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,c9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,u9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,h9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,f9=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,p9=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,m9=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,g9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,v9=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,x9=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,w9=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,b9=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,y9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,A9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,_9=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,S9=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,E9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,C9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,M9=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,T9=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,I9=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,D9=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,P9=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,R9=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,L9=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,k9=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,N9="gl_FragColor = linearToOutputTexel( gl_FragColor );",F9=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,O9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,B9=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,V9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,U9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,H9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,z9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,j9=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,G9=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,W9=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,q9=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Z9=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Y9=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,X9=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Q9=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,K9=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,J9=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$9=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ej=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tj=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,nj=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,ij=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,rj=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,sj=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,oj=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,aj=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lj=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,dj=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cj=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,uj=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,hj=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,fj=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,pj=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mj=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,gj=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,vj=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,xj=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,wj=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,bj=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,yj=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Aj=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,_j=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Sj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Ej=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Cj=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Mj=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Tj=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Ij=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Dj=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Pj=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Rj=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Lj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,kj=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Nj=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Fj=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Oj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Bj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Vj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Uj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Hj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,zj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,jj=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Gj=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Wj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,qj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Zj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Yj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Xj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Qj=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Kj=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Jj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,$j=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,eG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,nG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,iG=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,rG=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,sG=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,oG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,aG=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,dG=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,uG=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,hG=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fG=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,pG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,mG=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gG=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,vG=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,wG=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bG=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yG=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AG=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,_G=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SG=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,EG=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,CG=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MG=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TG=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,IG=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,DG=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,PG=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RG=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,LG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kG=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NG=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,FG=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,OG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Nt={alphahash_fragment:s9,alphahash_pars_fragment:o9,alphamap_fragment:a9,alphamap_pars_fragment:l9,alphatest_fragment:d9,alphatest_pars_fragment:c9,aomap_fragment:u9,aomap_pars_fragment:h9,batching_pars_vertex:f9,batching_vertex:p9,begin_vertex:m9,beginnormal_vertex:g9,bsdfs:v9,iridescence_fragment:x9,bumpmap_pars_fragment:w9,clipping_planes_fragment:b9,clipping_planes_pars_fragment:y9,clipping_planes_pars_vertex:A9,clipping_planes_vertex:_9,color_fragment:S9,color_pars_fragment:E9,color_pars_vertex:C9,color_vertex:M9,common:T9,cube_uv_reflection_fragment:I9,defaultnormal_vertex:D9,displacementmap_pars_vertex:P9,displacementmap_vertex:R9,emissivemap_fragment:L9,emissivemap_pars_fragment:k9,colorspace_fragment:N9,colorspace_pars_fragment:F9,envmap_fragment:O9,envmap_common_pars_fragment:B9,envmap_pars_fragment:V9,envmap_pars_vertex:U9,envmap_physical_pars_fragment:K9,envmap_vertex:H9,fog_vertex:z9,fog_pars_vertex:j9,fog_fragment:G9,fog_pars_fragment:W9,gradientmap_pars_fragment:q9,lightmap_pars_fragment:Z9,lights_lambert_fragment:Y9,lights_lambert_pars_fragment:X9,lights_pars_begin:Q9,lights_toon_fragment:J9,lights_toon_pars_fragment:$9,lights_phong_fragment:ej,lights_phong_pars_fragment:tj,lights_physical_fragment:nj,lights_physical_pars_fragment:ij,lights_fragment_begin:rj,lights_fragment_maps:sj,lights_fragment_end:oj,logdepthbuf_fragment:aj,logdepthbuf_pars_fragment:lj,logdepthbuf_pars_vertex:dj,logdepthbuf_vertex:cj,map_fragment:uj,map_pars_fragment:hj,map_particle_fragment:fj,map_particle_pars_fragment:pj,metalnessmap_fragment:mj,metalnessmap_pars_fragment:gj,morphinstance_vertex:vj,morphcolor_vertex:xj,morphnormal_vertex:wj,morphtarget_pars_vertex:bj,morphtarget_vertex:yj,normal_fragment_begin:Aj,normal_fragment_maps:_j,normal_pars_fragment:Sj,normal_pars_vertex:Ej,normal_vertex:Cj,normalmap_pars_fragment:Mj,clearcoat_normal_fragment_begin:Tj,clearcoat_normal_fragment_maps:Ij,clearcoat_pars_fragment:Dj,iridescence_pars_fragment:Pj,opaque_fragment:Rj,packing:Lj,premultiplied_alpha_fragment:kj,project_vertex:Nj,dithering_fragment:Fj,dithering_pars_fragment:Oj,roughnessmap_fragment:Bj,roughnessmap_pars_fragment:Vj,shadowmap_pars_fragment:Uj,shadowmap_pars_vertex:Hj,shadowmap_vertex:zj,shadowmask_pars_fragment:jj,skinbase_vertex:Gj,skinning_pars_vertex:Wj,skinning_vertex:qj,skinnormal_vertex:Zj,specularmap_fragment:Yj,specularmap_pars_fragment:Xj,tonemapping_fragment:Qj,tonemapping_pars_fragment:Kj,transmission_fragment:Jj,transmission_pars_fragment:$j,uv_pars_fragment:eG,uv_pars_vertex:tG,uv_vertex:nG,worldpos_vertex:iG,background_vert:rG,background_frag:sG,backgroundCube_vert:oG,backgroundCube_frag:aG,cube_vert:lG,cube_frag:dG,depth_vert:cG,depth_frag:uG,distanceRGBA_vert:hG,distanceRGBA_frag:fG,equirect_vert:pG,equirect_frag:mG,linedashed_vert:gG,linedashed_frag:vG,meshbasic_vert:xG,meshbasic_frag:wG,meshlambert_vert:bG,meshlambert_frag:yG,meshmatcap_vert:AG,meshmatcap_frag:_G,meshnormal_vert:SG,meshnormal_frag:EG,meshphong_vert:CG,meshphong_frag:MG,meshphysical_vert:TG,meshphysical_frag:IG,meshtoon_vert:DG,meshtoon_frag:PG,points_vert:RG,points_frag:LG,shadow_vert:kG,shadow_frag:NG,sprite_vert:FG,sprite_frag:OG},De={common:{diffuse:{value:new mt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Pt},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Pt}},envmap:{envMap:{value:null},envMapRotation:{value:new Pt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Pt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Pt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Pt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Pt},normalScale:{value:new we(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Pt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Pt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Pt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Pt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new mt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new mt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0},uvTransform:{value:new Pt}},sprite:{diffuse:{value:new mt(16777215)},opacity:{value:1},center:{value:new we(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Pt},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0}}},zs={basic:{uniforms:Gi([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.fog]),vertexShader:Nt.meshbasic_vert,fragmentShader:Nt.meshbasic_frag},lambert:{uniforms:Gi([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.fog,De.lights,{emissive:{value:new mt(0)}}]),vertexShader:Nt.meshlambert_vert,fragmentShader:Nt.meshlambert_frag},phong:{uniforms:Gi([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.fog,De.lights,{emissive:{value:new mt(0)},specular:{value:new mt(1118481)},shininess:{value:30}}]),vertexShader:Nt.meshphong_vert,fragmentShader:Nt.meshphong_frag},standard:{uniforms:Gi([De.common,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.roughnessmap,De.metalnessmap,De.fog,De.lights,{emissive:{value:new mt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Nt.meshphysical_vert,fragmentShader:Nt.meshphysical_frag},toon:{uniforms:Gi([De.common,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.gradientmap,De.fog,De.lights,{emissive:{value:new mt(0)}}]),vertexShader:Nt.meshtoon_vert,fragmentShader:Nt.meshtoon_frag},matcap:{uniforms:Gi([De.common,De.bumpmap,De.normalmap,De.displacementmap,De.fog,{matcap:{value:null}}]),vertexShader:Nt.meshmatcap_vert,fragmentShader:Nt.meshmatcap_frag},points:{uniforms:Gi([De.points,De.fog]),vertexShader:Nt.points_vert,fragmentShader:Nt.points_frag},dashed:{uniforms:Gi([De.common,De.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Nt.linedashed_vert,fragmentShader:Nt.linedashed_frag},depth:{uniforms:Gi([De.common,De.displacementmap]),vertexShader:Nt.depth_vert,fragmentShader:Nt.depth_frag},normal:{uniforms:Gi([De.common,De.bumpmap,De.normalmap,De.displacementmap,{opacity:{value:1}}]),vertexShader:Nt.meshnormal_vert,fragmentShader:Nt.meshnormal_frag},sprite:{uniforms:Gi([De.sprite,De.fog]),vertexShader:Nt.sprite_vert,fragmentShader:Nt.sprite_frag},background:{uniforms:{uvTransform:{value:new Pt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Nt.background_vert,fragmentShader:Nt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Pt}},vertexShader:Nt.backgroundCube_vert,fragmentShader:Nt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Nt.cube_vert,fragmentShader:Nt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Nt.equirect_vert,fragmentShader:Nt.equirect_frag},distanceRGBA:{uniforms:Gi([De.common,De.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Nt.distanceRGBA_vert,fragmentShader:Nt.distanceRGBA_frag},shadow:{uniforms:Gi([De.lights,De.fog,{color:{value:new mt(0)},opacity:{value:1}}]),vertexShader:Nt.shadow_vert,fragmentShader:Nt.shadow_frag}};zs.physical={uniforms:Gi([zs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Pt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Pt},clearcoatNormalScale:{value:new we(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Pt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Pt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Pt},sheen:{value:0},sheenColor:{value:new mt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Pt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Pt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Pt},transmissionSamplerSize:{value:new we},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Pt},attenuationDistance:{value:0},attenuationColor:{value:new mt(0)},specularColor:{value:new mt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Pt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Pt},anisotropyVector:{value:new we},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Pt}}]),vertexShader:Nt.meshphysical_vert,fragmentShader:Nt.meshphysical_frag};var Fg={r:0,b:0,g:0},Dl=new Bl,BG=new _t;function VG(i,e,t,n,r,s,o){let a=new mt(0),l=s===!0?0:1,d,c,u=null,h=0,f=null;function p(y){let b=y.isScene===!0?y.background:null;return b&&b.isTexture&&(b=(y.backgroundBlurriness>0?t:e).get(b)),b}function x(y){let b=!1,A=p(y);A===null?g(a,l):A&&A.isColor&&(g(A,1),b=!0);let M=i.xr.getEnvironmentBlendMode();M==="additive"?n.buffers.color.setClear(0,0,0,1,o):M==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||b)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function v(y,b){let A=p(b);A&&(A.isCubeTexture||A.mapping===R0)?(c===void 0&&(c=new jt(new qs(1,1,1),new Zs({name:"BackgroundCubeMaterial",uniforms:kc(zs.backgroundCube.uniforms),vertexShader:zs.backgroundCube.vertexShader,fragmentShader:zs.backgroundCube.fragmentShader,side:tr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(M,T,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),Dl.copy(b.backgroundRotation),Dl.x*=-1,Dl.y*=-1,Dl.z*=-1,A.isCubeTexture&&A.isRenderTargetTexture===!1&&(Dl.y*=-1,Dl.z*=-1),c.material.uniforms.envMap.value=A,c.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(BG.makeRotationFromEuler(Dl)),c.material.toneMapped=zt.getTransfer(A.colorSpace)!==ln,(u!==A||h!==A.version||f!==i.toneMapping)&&(c.material.needsUpdate=!0,u=A,h=A.version,f=i.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null)):A&&A.isTexture&&(d===void 0&&(d=new jt(new a0(2,2),new Zs({name:"BackgroundMaterial",uniforms:kc(zs.background.uniforms),vertexShader:zs.background.vertexShader,fragmentShader:zs.background.fragmentShader,side:Ws,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(d)),d.material.uniforms.t2D.value=A,d.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,d.material.toneMapped=zt.getTransfer(A.colorSpace)!==ln,A.matrixAutoUpdate===!0&&A.updateMatrix(),d.material.uniforms.uvTransform.value.copy(A.matrix),(u!==A||h!==A.version||f!==i.toneMapping)&&(d.material.needsUpdate=!0,u=A,h=A.version,f=i.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null))}function g(y,b){y.getRGB(Fg,u3(i)),n.buffers.color.setClear(Fg.r,Fg.g,Fg.b,b,o)}return{getClearColor:function(){return a},setClearColor:function(y,b=1){a.set(y),l=b,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,g(a,l)},render:x,addToRenderList:v}}function UG(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=h(null),s=r,o=!1;function a(S,P,j,B,z){let X=!1,Q=u(B,j,P);s!==Q&&(s=Q,d(s.object)),X=f(S,B,j,z),X&&p(S,B,j,z),z!==null&&e.update(z,i.ELEMENT_ARRAY_BUFFER),(X||o)&&(o=!1,A(S,P,j,B),z!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function l(){return i.createVertexArray()}function d(S){return i.bindVertexArray(S)}function c(S){return i.deleteVertexArray(S)}function u(S,P,j){let B=j.wireframe===!0,z=n[S.id];z===void 0&&(z={},n[S.id]=z);let X=z[P.id];X===void 0&&(X={},z[P.id]=X);let Q=X[B];return Q===void 0&&(Q=h(l()),X[B]=Q),Q}function h(S){let P=[],j=[],B=[];for(let z=0;z<t;z++)P[z]=0,j[z]=0,B[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:j,attributeDivisors:B,object:S,attributes:{},index:null}}function f(S,P,j,B){let z=s.attributes,X=P.attributes,Q=0,K=j.getAttributes();for(let Y in K)if(K[Y].location>=0){let Ce=z[Y],Ie=X[Y];if(Ie===void 0&&(Y==="instanceMatrix"&&S.instanceMatrix&&(Ie=S.instanceMatrix),Y==="instanceColor"&&S.instanceColor&&(Ie=S.instanceColor)),Ce===void 0||Ce.attribute!==Ie||Ie&&Ce.data!==Ie.data)return!0;Q++}return s.attributesNum!==Q||s.index!==B}function p(S,P,j,B){let z={},X=P.attributes,Q=0,K=j.getAttributes();for(let Y in K)if(K[Y].location>=0){let Ce=X[Y];Ce===void 0&&(Y==="instanceMatrix"&&S.instanceMatrix&&(Ce=S.instanceMatrix),Y==="instanceColor"&&S.instanceColor&&(Ce=S.instanceColor));let Ie={};Ie.attribute=Ce,Ce&&Ce.data&&(Ie.data=Ce.data),z[Y]=Ie,Q++}s.attributes=z,s.attributesNum=Q,s.index=B}function x(){let S=s.newAttributes;for(let P=0,j=S.length;P<j;P++)S[P]=0}function v(S){g(S,0)}function g(S,P){let j=s.newAttributes,B=s.enabledAttributes,z=s.attributeDivisors;j[S]=1,B[S]===0&&(i.enableVertexAttribArray(S),B[S]=1),z[S]!==P&&(i.vertexAttribDivisor(S,P),z[S]=P)}function y(){let S=s.newAttributes,P=s.enabledAttributes;for(let j=0,B=P.length;j<B;j++)P[j]!==S[j]&&(i.disableVertexAttribArray(j),P[j]=0)}function b(S,P,j,B,z,X,Q){Q===!0?i.vertexAttribIPointer(S,P,j,z,X):i.vertexAttribPointer(S,P,j,B,z,X)}function A(S,P,j,B){x();let z=B.attributes,X=j.getAttributes(),Q=P.defaultAttributeValues;for(let K in X){let Y=X[K];if(Y.location>=0){let Ae=z[K];if(Ae===void 0&&(K==="instanceMatrix"&&S.instanceMatrix&&(Ae=S.instanceMatrix),K==="instanceColor"&&S.instanceColor&&(Ae=S.instanceColor)),Ae!==void 0){let Ce=Ae.normalized,Ie=Ae.itemSize,He=e.get(Ae);if(He===void 0)continue;let at=He.buffer,le=He.type,be=He.bytesPerElement,Pe=le===i.INT||le===i.UNSIGNED_INT||Ae.gpuType===P_;if(Ae.isInterleavedBufferAttribute){let he=Ae.data,Ge=he.stride,ct=Ae.offset;if(he.isInstancedInterleavedBuffer){for(let dt=0;dt<Y.locationSize;dt++)g(Y.location+dt,he.meshPerAttribute);S.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let dt=0;dt<Y.locationSize;dt++)v(Y.location+dt);i.bindBuffer(i.ARRAY_BUFFER,at);for(let dt=0;dt<Y.locationSize;dt++)b(Y.location+dt,Ie/Y.locationSize,le,Ce,Ge*be,(ct+Ie/Y.locationSize*dt)*be,Pe)}else{if(Ae.isInstancedBufferAttribute){for(let he=0;he<Y.locationSize;he++)g(Y.location+he,Ae.meshPerAttribute);S.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let he=0;he<Y.locationSize;he++)v(Y.location+he);i.bindBuffer(i.ARRAY_BUFFER,at);for(let he=0;he<Y.locationSize;he++)b(Y.location+he,Ie/Y.locationSize,le,Ce,Ie*be,Ie/Y.locationSize*he*be,Pe)}}else if(Q!==void 0){let Ce=Q[K];if(Ce!==void 0)switch(Ce.length){case 2:i.vertexAttrib2fv(Y.location,Ce);break;case 3:i.vertexAttrib3fv(Y.location,Ce);break;case 4:i.vertexAttrib4fv(Y.location,Ce);break;default:i.vertexAttrib1fv(Y.location,Ce)}}}}y()}function M(){L();for(let S in n){let P=n[S];for(let j in P){let B=P[j];for(let z in B)c(B[z].object),delete B[z];delete P[j]}delete n[S]}}function T(S){if(n[S.id]===void 0)return;let P=n[S.id];for(let j in P){let B=P[j];for(let z in B)c(B[z].object),delete B[z];delete P[j]}delete n[S.id]}function I(S){for(let P in n){let j=n[P];if(j[S.id]===void 0)continue;let B=j[S.id];for(let z in B)c(B[z].object),delete B[z];delete j[S.id]}}function L(){E(),o=!0,s!==r&&(s=r,d(s.object))}function E(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:L,resetDefaultState:E,dispose:M,releaseStatesOfGeometry:T,releaseStatesOfProgram:I,initAttributes:x,enableAttribute:v,disableUnusedAttributes:y}}function HG(i,e,t){let n;function r(d){n=d}function s(d,c){i.drawArrays(n,d,c),t.update(c,n,1)}function o(d,c,u){u!==0&&(i.drawArraysInstanced(n,d,c,u),t.update(c,n,u))}function a(d,c,u){if(u===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,d,0,c,0,u);let f=0;for(let p=0;p<u;p++)f+=c[p];t.update(f,n,1)}function l(d,c,u,h){if(u===0)return;let f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<d.length;p++)o(d[p],c[p],h[p]);else{f.multiDrawArraysInstancedWEBGL(n,d,0,c,0,h,0,u);let p=0;for(let x=0;x<u;x++)p+=c[x]*h[x];t.update(p,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function zG(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let I=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(I){return!(I!==Vr&&n.convert(I)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(I){let L=I===$h&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==No&&n.convert(I)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==ys&&!L)}function l(I){if(I==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let d=t.precision!==void 0?t.precision:"highp",c=l(d);c!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",c,"instead."),d=c);let u=t.logarithmicDepthBuffer===!0,h=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),f=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),p=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=i.getParameter(i.MAX_TEXTURE_SIZE),v=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),g=i.getParameter(i.MAX_VERTEX_ATTRIBS),y=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),b=i.getParameter(i.MAX_VARYING_VECTORS),A=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),M=p>0,T=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:d,logarithmicDepthBuffer:u,reverseDepthBuffer:h,maxTextures:f,maxVertexTextures:p,maxTextureSize:x,maxCubemapSize:v,maxAttributes:g,maxVertexUniforms:y,maxVaryings:b,maxFragmentUniforms:A,vertexTextures:M,maxSamples:T}}function jG(i){let e=this,t=null,n=0,r=!1,s=!1,o=new xs,a=new Pt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){let f=u.length!==0||h||n!==0||r;return r=h,n=u.length,f},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,h){t=c(u,h,0)},this.setState=function(u,h,f){let p=u.clippingPlanes,x=u.clipIntersection,v=u.clipShadows,g=i.get(u);if(!r||p===null||p.length===0||s&&!v)s?c(null):d();else{let y=s?0:n,b=y*4,A=g.clippingState||null;l.value=A,A=c(p,h,b,f);for(let M=0;M!==b;++M)A[M]=t[M];g.clippingState=A,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=y}};function d(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function c(u,h,f,p){let x=u!==null?u.length:0,v=null;if(x!==0){if(v=l.value,p!==!0||v===null){let g=f+x*4,y=h.matrixWorldInverse;a.getNormalMatrix(y),(v===null||v.length<g)&&(v=new Float32Array(g));for(let b=0,A=f;b!==x;++b,A+=4)o.copy(u[b]).applyMatrix4(y,a),o.normal.toArray(v,A),v[A+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,v}}function GG(i){let e=new WeakMap;function t(o,a){return a===gA?o.mapping=Mc:a===vA&&(o.mapping=Tc),o}function n(o){if(o&&o.isTexture){let a=o.mapping;if(a===gA||a===vA)if(e.has(o)){let l=e.get(o).texture;return t(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let d=new XA(l.height);return d.fromEquirectangularTexture(i,o),e.set(o,d),o.addEventListener("dispose",r),t(d.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var Nc=class extends s0{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=n-e,o=n+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){let d=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=d*this.view.offsetX,o=s+d*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},xc=4,tL=[.125,.215,.35,.446,.526,.582],Nl=20,Z1=new Nc,nL=new mt,Y1=null,X1=0,Q1=0,K1=!1,Rl=(1+Math.sqrt(5))/2,mc=1/Rl,iL=[new V(-Rl,mc,0),new V(Rl,mc,0),new V(-mc,0,Rl),new V(mc,0,Rl),new V(0,Rl,-mc),new V(0,Rl,mc),new V(-1,1,-1),new V(1,1,-1),new V(-1,1,1),new V(1,1,1)],l0=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Y1=this._renderer.getRenderTarget(),X1=this._renderer.getActiveCubeFace(),Q1=this._renderer.getActiveMipmapLevel(),K1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=oL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=sL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Y1,X1,Q1),this._renderer.xr.enabled=K1,e.scissorTest=!1,Og(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Mc||e.mapping===Tc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Y1=this._renderer.getRenderTarget(),X1=this._renderer.getActiveCubeFace(),Q1=this._renderer.getActiveMipmapLevel(),K1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:er,minFilter:er,generateMipmaps:!1,type:$h,format:Vr,colorSpace:Ri,depthBuffer:!1},r=rL(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=rL(e,t,n);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=WG(s)),this._blurMaterial=qG(s,e,t)}return r}_compileMaterial(e){let t=new jt(this._lodPlanes[0],e);this._renderer.compile(t,Z1)}_sceneToCubeUV(e,t,n,r){let a=new Un(90,1,t,n),l=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,h=c.toneMapping;c.getClearColor(nL),c.toneMapping=Va,c.autoClear=!1;let f=new fn({name:"PMREM.Background",side:tr,depthWrite:!1,depthTest:!1}),p=new jt(new qs,f),x=!1,v=e.background;v?v.isColor&&(f.color.copy(v),e.background=null,x=!0):(f.color.copy(nL),x=!0);for(let g=0;g<6;g++){let y=g%3;y===0?(a.up.set(0,l[g],0),a.lookAt(d[g],0,0)):y===1?(a.up.set(0,0,l[g]),a.lookAt(0,d[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,d[g]));let b=this._cubeSize;Og(r,y*b,g>2?b:0,b,b),c.setRenderTarget(r),x&&c.render(p,a),c.render(e,a)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=h,c.autoClear=u,e.background=v}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===Mc||e.mapping===Tc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=oL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=sL());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new jt(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let l=this._cubeSize;Og(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,Z1)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let s=1;s<r;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=iL[(r-s-1)%iL.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){let l=this._renderer,d=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new jt(this._lodPlanes[r],d),h=d.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Nl-1),x=s/p,v=isFinite(s)?1+Math.floor(c*x):Nl;v>Nl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Nl}`);let g=[],y=0;for(let I=0;I<Nl;++I){let L=I/x,E=Math.exp(-L*L/2);g.push(E),I===0?y+=E:I<v&&(y+=2*E)}for(let I=0;I<g.length;I++)g[I]=g[I]/y;h.envMap.value=e.texture,h.samples.value=v,h.weights.value=g,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:b}=this;h.dTheta.value=p,h.mipInt.value=b-n;let A=this._sizeLods[r],M=3*A*(r>b-xc?r-b+xc:0),T=4*(this._cubeSize-A);Og(t,M,T,3*A,2*A),l.setRenderTarget(t),l.render(u,Z1)}};function WG(i){let e=[],t=[],n=[],r=i,s=i-xc+1+tL.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let l=1/a;o>i-xc?l=tL[o-i+xc-1]:o===0&&(l=0),n.push(l);let d=1/(a-2),c=-d,u=1+d,h=[c,c,u,c,u,u,c,c,u,u,c,u],f=6,p=6,x=3,v=2,g=1,y=new Float32Array(x*p*f),b=new Float32Array(v*p*f),A=new Float32Array(g*p*f);for(let T=0;T<f;T++){let I=T%3*2/3-1,L=T>2?0:-1,E=[I,L,0,I+2/3,L,0,I+2/3,L+1,0,I,L,0,I+2/3,L+1,0,I,L+1,0];y.set(E,x*p*T),b.set(h,v*p*T);let S=[T,T,T,T,T,T];A.set(S,g*p*T)}let M=new xr;M.setAttribute("position",new $n(y,x)),M.setAttribute("uv",new $n(b,v)),M.setAttribute("faceIndex",new $n(A,g)),e.push(M),r>xc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function rL(i,e,t){let n=new Oo(i,e,t);return n.texture.mapping=R0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Og(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function qG(i,e,t){let n=new Float32Array(Nl),r=new V(0,1,0);return new Zs({name:"SphericalGaussianBlur",defines:{n:Nl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:V_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function sL(){return new Zs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:V_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function oL(){return new Zs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:V_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ba,depthTest:!1,depthWrite:!1})}function V_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ZG(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let l=a.mapping,d=l===gA||l===vA,c=l===Mc||l===Tc;if(d||c){let u=e.get(a),h=u!==void 0?u.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return t===null&&(t=new l0(i)),u=d?t.fromEquirectangular(a,u):t.fromCubemap(a,u),u.texture.pmremVersion=a.pmremVersion,e.set(a,u),u.texture;if(u!==void 0)return u.texture;{let f=a.image;return d&&f&&f.height>0||c&&f&&r(f)?(t===null&&(t=new l0(i)),u=d?t.fromEquirectangular(a):t.fromCubemap(a),u.texture.pmremVersion=a.pmremVersion,e.set(a,u),a.addEventListener("dispose",s),u.texture):null}}}return a}function r(a){let l=0,d=6;for(let c=0;c<d;c++)a[c]!==void 0&&l++;return l===d}function s(a){let l=a.target;l.removeEventListener("dispose",s);let d=e.get(l);d!==void 0&&(e.delete(l),d.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function YG(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let r=t(n);return r===null&&Th("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function XG(i,e,t,n){let r={},s=new WeakMap;function o(u){let h=u.target;h.index!==null&&e.remove(h.index);for(let p in h.attributes)e.remove(h.attributes[p]);for(let p in h.morphAttributes){let x=h.morphAttributes[p];for(let v=0,g=x.length;v<g;v++)e.remove(x[v])}h.removeEventListener("dispose",o),delete r[h.id];let f=s.get(h);f&&(e.remove(f),s.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(u,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h}function l(u){let h=u.attributes;for(let p in h)e.update(h[p],i.ARRAY_BUFFER);let f=u.morphAttributes;for(let p in f){let x=f[p];for(let v=0,g=x.length;v<g;v++)e.update(x[v],i.ARRAY_BUFFER)}}function d(u){let h=[],f=u.index,p=u.attributes.position,x=0;if(f!==null){let y=f.array;x=f.version;for(let b=0,A=y.length;b<A;b+=3){let M=y[b+0],T=y[b+1],I=y[b+2];h.push(M,T,T,I,I,M)}}else if(p!==void 0){let y=p.array;x=p.version;for(let b=0,A=y.length/3-1;b<A;b+=3){let M=b+0,T=b+1,I=b+2;h.push(M,T,T,I,I,M)}}else return;let v=new(d3(h)?r0:i0)(h,1);v.version=x;let g=s.get(u);g&&e.remove(g),s.set(u,v)}function c(u){let h=s.get(u);if(h){let f=u.index;f!==null&&h.version<f.version&&d(u)}else d(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:c}}function QG(i,e,t){let n;function r(h){n=h}let s,o;function a(h){s=h.type,o=h.bytesPerElement}function l(h,f){i.drawElements(n,f,s,h*o),t.update(f,n,1)}function d(h,f,p){p!==0&&(i.drawElementsInstanced(n,f,s,h*o,p),t.update(f,n,p))}function c(h,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,f,0,s,h,0,p);let v=0;for(let g=0;g<p;g++)v+=f[g];t.update(v,n,1)}function u(h,f,p,x){if(p===0)return;let v=e.get("WEBGL_multi_draw");if(v===null)for(let g=0;g<h.length;g++)d(h[g]/o,f[g],x[g]);else{v.multiDrawElementsInstancedWEBGL(n,f,0,s,h,0,x,0,p);let g=0;for(let y=0;y<p;y++)g+=f[y]*x[y];t.update(g,n,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=d,this.renderMultiDraw=c,this.renderMultiDrawInstances=u}function KG(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function JG(i,e,t){let n=new WeakMap,r=new Jt;function s(o,a,l){let d=o.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=c!==void 0?c.length:0,h=n.get(a);if(h===void 0||h.count!==u){let S=function(){L.dispose(),n.delete(a),a.removeEventListener("dispose",S)};var f=S;h!==void 0&&h.texture.dispose();let p=a.morphAttributes.position!==void 0,x=a.morphAttributes.normal!==void 0,v=a.morphAttributes.color!==void 0,g=a.morphAttributes.position||[],y=a.morphAttributes.normal||[],b=a.morphAttributes.color||[],A=0;p===!0&&(A=1),x===!0&&(A=2),v===!0&&(A=3);let M=a.attributes.position.count*A,T=1;M>e.maxTextureSize&&(T=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);let I=new Float32Array(M*T*4*u),L=new n0(I,M,T,u);L.type=ys,L.needsUpdate=!0;let E=A*4;for(let P=0;P<u;P++){let j=g[P],B=y[P],z=b[P],X=M*T*4*P;for(let Q=0;Q<j.count;Q++){let K=Q*E;p===!0&&(r.fromBufferAttribute(j,Q),I[X+K+0]=r.x,I[X+K+1]=r.y,I[X+K+2]=r.z,I[X+K+3]=0),x===!0&&(r.fromBufferAttribute(B,Q),I[X+K+4]=r.x,I[X+K+5]=r.y,I[X+K+6]=r.z,I[X+K+7]=0),v===!0&&(r.fromBufferAttribute(z,Q),I[X+K+8]=r.x,I[X+K+9]=r.y,I[X+K+10]=r.z,I[X+K+11]=z.itemSize===4?r.w:1)}}h={count:u,texture:L,size:new we(M,T)},n.set(a,h),a.addEventListener("dispose",S)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let p=0;for(let v=0;v<d.length;v++)p+=d[v];let x=a.morphTargetsRelative?1:1-p;l.getUniforms().setValue(i,"morphTargetBaseInfluence",x),l.getUniforms().setValue(i,"morphTargetInfluences",d)}l.getUniforms().setValue(i,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",h.size)}return{update:s}}function $G(i,e,t,n){let r=new WeakMap;function s(l){let d=n.render.frame,c=l.geometry,u=e.get(l,c);if(r.get(u)!==d&&(e.update(u),r.set(u,d)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==d&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,d))),l.isSkinnedMesh){let h=l.skeleton;r.get(h)!==d&&(h.update(),r.set(h,d))}return u}function o(){r=new WeakMap}function a(l){let d=l.target;d.removeEventListener("dispose",a),t.remove(d.instanceMatrix),d.instanceColor!==null&&t.remove(d.instanceColor)}return{update:s,dispose:o}}var d0=class extends Gr{constructor(e,t,n,r,s,o,a,l,d,c=yc){if(c!==yc&&c!==Dc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===yc&&(n=Ol),n===void 0&&c===Dc&&(n=Ic),super(null,r,s,o,a,l,c,n,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Pi,this.minFilter=l!==void 0?l:Pi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},f3=new Gr,aL=new d0(1,1),p3=new n0,m3=new ZA,g3=new o0,lL=[],dL=[],cL=new Float32Array(16),uL=new Float32Array(9),hL=new Float32Array(4);function zc(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,s=lL[r];if(s===void 0&&(s=new Float32Array(r),lL[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function ei(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ti(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function F0(i,e){let t=dL[e];t===void 0&&(t=new Int32Array(e),dL[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function eW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function tW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;i.uniform2fv(this.addr,e),ti(t,e)}}function nW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ei(t,e))return;i.uniform3fv(this.addr,e),ti(t,e)}}function iW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;i.uniform4fv(this.addr,e),ti(t,e)}}function rW(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ei(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,n))return;hL.set(n),i.uniformMatrix2fv(this.addr,!1,hL),ti(t,n)}}function sW(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ei(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,n))return;uL.set(n),i.uniformMatrix3fv(this.addr,!1,uL),ti(t,n)}}function oW(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(ei(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,n))return;cL.set(n),i.uniformMatrix4fv(this.addr,!1,cL),ti(t,n)}}function aW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function lW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;i.uniform2iv(this.addr,e),ti(t,e)}}function dW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ei(t,e))return;i.uniform3iv(this.addr,e),ti(t,e)}}function cW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;i.uniform4iv(this.addr,e),ti(t,e)}}function uW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function hW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;i.uniform2uiv(this.addr,e),ti(t,e)}}function fW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ei(t,e))return;i.uniform3uiv(this.addr,e),ti(t,e)}}function pW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;i.uniform4uiv(this.addr,e),ti(t,e)}}function mW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(aL.compareFunction=l3,s=aL):s=f3,t.setTexture2D(e||s,r)}function gW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||m3,r)}function vW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||g3,r)}function xW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||p3,r)}function wW(i){switch(i){case 5126:return eW;case 35664:return tW;case 35665:return nW;case 35666:return iW;case 35674:return rW;case 35675:return sW;case 35676:return oW;case 5124:case 35670:return aW;case 35667:case 35671:return lW;case 35668:case 35672:return dW;case 35669:case 35673:return cW;case 5125:return uW;case 36294:return hW;case 36295:return fW;case 36296:return pW;case 35678:case 36198:case 36298:case 36306:case 35682:return mW;case 35679:case 36299:case 36307:return gW;case 35680:case 36300:case 36308:case 36293:return vW;case 36289:case 36303:case 36311:case 36292:return xW}}function bW(i,e){i.uniform1fv(this.addr,e)}function yW(i,e){let t=zc(e,this.size,2);i.uniform2fv(this.addr,t)}function AW(i,e){let t=zc(e,this.size,3);i.uniform3fv(this.addr,t)}function _W(i,e){let t=zc(e,this.size,4);i.uniform4fv(this.addr,t)}function SW(i,e){let t=zc(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function EW(i,e){let t=zc(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function CW(i,e){let t=zc(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function MW(i,e){i.uniform1iv(this.addr,e)}function TW(i,e){i.uniform2iv(this.addr,e)}function IW(i,e){i.uniform3iv(this.addr,e)}function DW(i,e){i.uniform4iv(this.addr,e)}function PW(i,e){i.uniform1uiv(this.addr,e)}function RW(i,e){i.uniform2uiv(this.addr,e)}function LW(i,e){i.uniform3uiv(this.addr,e)}function kW(i,e){i.uniform4uiv(this.addr,e)}function NW(i,e,t){let n=this.cache,r=e.length,s=F0(t,r);ei(n,s)||(i.uniform1iv(this.addr,s),ti(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||f3,s[o])}function FW(i,e,t){let n=this.cache,r=e.length,s=F0(t,r);ei(n,s)||(i.uniform1iv(this.addr,s),ti(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||m3,s[o])}function OW(i,e,t){let n=this.cache,r=e.length,s=F0(t,r);ei(n,s)||(i.uniform1iv(this.addr,s),ti(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||g3,s[o])}function BW(i,e,t){let n=this.cache,r=e.length,s=F0(t,r);ei(n,s)||(i.uniform1iv(this.addr,s),ti(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||p3,s[o])}function VW(i){switch(i){case 5126:return bW;case 35664:return yW;case 35665:return AW;case 35666:return _W;case 35674:return SW;case 35675:return EW;case 35676:return CW;case 5124:case 35670:return MW;case 35667:case 35671:return TW;case 35668:case 35672:return IW;case 35669:case 35673:return DW;case 5125:return PW;case 36294:return RW;case 36295:return LW;case 36296:return kW;case 35678:case 36198:case 36298:case 36306:case 35682:return NW;case 35679:case 36299:case 36307:return FW;case 35680:case 36300:case 36308:case 36293:return OW;case 36289:case 36303:case 36311:case 36292:return BW}}var QA=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=wW(t.type)}},KA=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=VW(t.type)}},JA=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],n)}}},J1=/(\w+)(\])?(\[|\.)?/g;function fL(i,e){i.seq.push(e),i.map[e.id]=e}function UW(i,e,t){let n=i.name,r=n.length;for(J1.lastIndex=0;;){let s=J1.exec(n),o=J1.lastIndex,a=s[1],l=s[2]==="]",d=s[3];if(l&&(a=a|0),d===void 0||d==="["&&o+2===r){fL(t,d===void 0?new QA(a,i,e):new KA(a,i,e));break}else{let u=t.map[a];u===void 0&&(u=new JA(a),fL(t,u)),t=u}}}var _c=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);UW(s,o,this)}}setValue(e,t,n,r){let s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&n.push(o)}return n}};function pL(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}var HW=37297,zW=0;function jW(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}var mL=new Pt;function GW(i){zt._getMatrix(mL,zt.workingColorSpace,i);let e=`mat3( ${mL.elements.map(t=>t.toFixed(4))} )`;switch(zt.getTransfer(i)){case k0:return[e,"LinearTransferOETF"];case ln:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function gL(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+jW(i.getShaderSource(e),o)}else return r}function WW(i,e){let t=GW(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function qW(i,e){let t;switch(e){case t7:t="Linear";break;case n7:t="Reinhard";break;case i7:t="Cineon";break;case r7:t="ACESFilmic";break;case o7:t="AgX";break;case a7:t="Neutral";break;case s7:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var Bg=new V;function ZW(){zt.getLuminanceCoefficients(Bg);let i=Bg.x.toFixed(4),e=Bg.y.toFixed(4),t=Bg.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function YW(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ih).join(`
`)}function XW(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function QW(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let s=i.getActiveAttrib(e,r),o=s.name,a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function Ih(i){return i!==""}function vL(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function xL(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var KW=/^[ \t]*#include +<([\w\d./]+)>/gm;function $A(i){return i.replace(KW,$W)}var JW=new Map;function $W(i,e){let t=Nt[e];if(t===void 0){let n=JW.get(e);if(n!==void 0)t=Nt[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return $A(t)}var eq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wL(i){return i.replace(eq,tq)}function tq(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function bL(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function nq(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===XL?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===kz?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Po&&(e="SHADOWMAP_TYPE_VSM"),e}function iq(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Mc:case Tc:e="ENVMAP_TYPE_CUBE";break;case R0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function rq(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Tc:e="ENVMAP_MODE_REFRACTION";break}return e}function sq(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case QL:e="ENVMAP_BLENDING_MULTIPLY";break;case $z:e="ENVMAP_BLENDING_MIX";break;case e7:e="ENVMAP_BLENDING_ADD";break}return e}function oq(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function aq(i,e,t,n){let r=i.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,l=nq(t),d=iq(t),c=rq(t),u=sq(t),h=oq(t),f=YW(t),p=XW(s),x=r.createProgram(),v,g,y=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Ih).join(`
`),v.length>0&&(v+=`
`),g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Ih).join(`
`),g.length>0&&(g+=`
`)):(v=[bL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ih).join(`
`),g=[bL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Va?"#define TONE_MAPPING":"",t.toneMapping!==Va?Nt.tonemapping_pars_fragment:"",t.toneMapping!==Va?qW("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Nt.colorspace_pars_fragment,WW("linearToOutputTexel",t.outputColorSpace),ZW(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Ih).join(`
`)),o=$A(o),o=vL(o,t),o=xL(o,t),a=$A(a),a=vL(a,t),a=xL(a,t),o=wL(o),a=wL(a),t.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,v=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,g=["#define varying in",t.glslVersion===LR?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===LR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);let b=y+v+o,A=y+g+a,M=pL(r,r.VERTEX_SHADER,b),T=pL(r,r.FRAGMENT_SHADER,A);r.attachShader(x,M),r.attachShader(x,T),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function I(P){if(i.debug.checkShaderErrors){let j=r.getProgramInfoLog(x).trim(),B=r.getShaderInfoLog(M).trim(),z=r.getShaderInfoLog(T).trim(),X=!0,Q=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(X=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,x,M,T);else{let K=gL(r,M,"vertex"),Y=gL(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Material Name: `+P.name+`
Material Type: `+P.type+`

Program Info Log: `+j+`
`+K+`
`+Y)}else j!==""?console.warn("THREE.WebGLProgram: Program Info Log:",j):(B===""||z==="")&&(Q=!1);Q&&(P.diagnostics={runnable:X,programLog:j,vertexShader:{log:B,prefix:v},fragmentShader:{log:z,prefix:g}})}r.deleteShader(M),r.deleteShader(T),L=new _c(r,x),E=QW(r,x)}let L;this.getUniforms=function(){return L===void 0&&I(this),L};let E;this.getAttributes=function(){return E===void 0&&I(this),E};let S=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return S===!1&&(S=r.getProgramParameter(x,HW)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=zW++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=T,this}var lq=0,e_=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new t_(e),t.set(e,n)),n}},t_=class{constructor(e){this.id=lq++,this.code=e,this.usedTimes=0}};function dq(i,e,t,n,r,s,o){let a=new Vh,l=new e_,d=new Set,c=[],u=r.logarithmicDepthBuffer,h=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(E){return d.add(E),E===0?"uv":`uv${E}`}function v(E,S,P,j,B){let z=j.fog,X=B.geometry,Q=E.isMeshStandardMaterial?j.environment:null,K=(E.isMeshStandardMaterial?t:e).get(E.envMap||Q),Y=K&&K.mapping===R0?K.image.height:null,Ae=p[E.type];E.precision!==null&&(f=r.getMaxPrecision(E.precision),f!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",f,"instead."));let Ce=X.morphAttributes.position||X.morphAttributes.normal||X.morphAttributes.color,Ie=Ce!==void 0?Ce.length:0,He=0;X.morphAttributes.position!==void 0&&(He=1),X.morphAttributes.normal!==void 0&&(He=2),X.morphAttributes.color!==void 0&&(He=3);let at,le,be,Pe;if(Ae){let nn=zs[Ae];at=nn.vertexShader,le=nn.fragmentShader}else at=E.vertexShader,le=E.fragmentShader,l.update(E),be=l.getVertexShaderID(E),Pe=l.getFragmentShaderID(E);let he=i.getRenderTarget(),Ge=i.state.buffers.depth.getReversed(),ct=B.isInstancedMesh===!0,dt=B.isBatchedMesh===!0,Xt=!!E.map,pe=!!E.matcap,_e=!!K,O=!!E.aoMap,it=!!E.lightMap,xe=!!E.bumpMap,Ue=!!E.normalMap,Me=!!E.displacementMap,ut=!!E.emissiveMap,Oe=!!E.metalnessMap,N=!!E.roughnessMap,D=E.anisotropy>0,J=E.clearcoat>0,de=E.dispersion>0,me=E.iridescence>0,ce=E.sheen>0,Ke=E.transmission>0,Re=D&&!!E.anisotropyMap,Be=J&&!!E.clearcoatMap,Ut=J&&!!E.clearcoatNormalMap,ye=J&&!!E.clearcoatRoughnessMap,ze=me&&!!E.iridescenceMap,ht=me&&!!E.iridescenceThicknessMap,vt=ce&&!!E.sheenColorMap,je=ce&&!!E.sheenRoughnessMap,Wt=!!E.specularMap,Lt=!!E.specularColorMap,pn=!!E.specularIntensityMap,W=Ke&&!!E.transmissionMap,Le=Ke&&!!E.thicknessMap,oe=!!E.gradientMap,fe=!!E.alphaMap,Fe=E.alphaTest>0,ke=!!E.alphaHash,Ct=!!E.extensions,Pn=Va;E.toneMapped&&(he===null||he.isXRRenderTarget===!0)&&(Pn=i.toneMapping);let _i={shaderID:Ae,shaderType:E.type,shaderName:E.name,vertexShader:at,fragmentShader:le,defines:E.defines,customVertexShaderID:be,customFragmentShaderID:Pe,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:f,batching:dt,batchingColor:dt&&B._colorsTexture!==null,instancing:ct,instancingColor:ct&&B.instanceColor!==null,instancingMorph:ct&&B.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:he===null?i.outputColorSpace:he.isXRRenderTarget===!0?he.texture.colorSpace:Ri,alphaToCoverage:!!E.alphaToCoverage,map:Xt,matcap:pe,envMap:_e,envMapMode:_e&&K.mapping,envMapCubeUVHeight:Y,aoMap:O,lightMap:it,bumpMap:xe,normalMap:Ue,displacementMap:h&&Me,emissiveMap:ut,normalMapObjectSpace:Ue&&E.normalMapType===h7,normalMapTangentSpace:Ue&&E.normalMapType===a3,metalnessMap:Oe,roughnessMap:N,anisotropy:D,anisotropyMap:Re,clearcoat:J,clearcoatMap:Be,clearcoatNormalMap:Ut,clearcoatRoughnessMap:ye,dispersion:de,iridescence:me,iridescenceMap:ze,iridescenceThicknessMap:ht,sheen:ce,sheenColorMap:vt,sheenRoughnessMap:je,specularMap:Wt,specularColorMap:Lt,specularIntensityMap:pn,transmission:Ke,transmissionMap:W,thicknessMap:Le,gradientMap:oe,opaque:E.transparent===!1&&E.blending===bc&&E.alphaToCoverage===!1,alphaMap:fe,alphaTest:Fe,alphaHash:ke,combine:E.combine,mapUv:Xt&&x(E.map.channel),aoMapUv:O&&x(E.aoMap.channel),lightMapUv:it&&x(E.lightMap.channel),bumpMapUv:xe&&x(E.bumpMap.channel),normalMapUv:Ue&&x(E.normalMap.channel),displacementMapUv:Me&&x(E.displacementMap.channel),emissiveMapUv:ut&&x(E.emissiveMap.channel),metalnessMapUv:Oe&&x(E.metalnessMap.channel),roughnessMapUv:N&&x(E.roughnessMap.channel),anisotropyMapUv:Re&&x(E.anisotropyMap.channel),clearcoatMapUv:Be&&x(E.clearcoatMap.channel),clearcoatNormalMapUv:Ut&&x(E.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ye&&x(E.clearcoatRoughnessMap.channel),iridescenceMapUv:ze&&x(E.iridescenceMap.channel),iridescenceThicknessMapUv:ht&&x(E.iridescenceThicknessMap.channel),sheenColorMapUv:vt&&x(E.sheenColorMap.channel),sheenRoughnessMapUv:je&&x(E.sheenRoughnessMap.channel),specularMapUv:Wt&&x(E.specularMap.channel),specularColorMapUv:Lt&&x(E.specularColorMap.channel),specularIntensityMapUv:pn&&x(E.specularIntensityMap.channel),transmissionMapUv:W&&x(E.transmissionMap.channel),thicknessMapUv:Le&&x(E.thicknessMap.channel),alphaMapUv:fe&&x(E.alphaMap.channel),vertexTangents:!!X.attributes.tangent&&(Ue||D),vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!X.attributes.color&&X.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!X.attributes.uv&&(Xt||fe),fog:!!z,useFog:E.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:E.flatShading===!0,sizeAttenuation:E.sizeAttenuation===!0,logarithmicDepthBuffer:u,reverseDepthBuffer:Ge,skinning:B.isSkinnedMesh===!0,morphTargets:X.morphAttributes.position!==void 0,morphNormals:X.morphAttributes.normal!==void 0,morphColors:X.morphAttributes.color!==void 0,morphTargetsCount:Ie,morphTextureStride:He,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numLightProbes:S.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:E.dithering,shadowMapEnabled:i.shadowMap.enabled&&P.length>0,shadowMapType:i.shadowMap.type,toneMapping:Pn,decodeVideoTexture:Xt&&E.map.isVideoTexture===!0&&zt.getTransfer(E.map.colorSpace)===ln,decodeVideoTextureEmissive:ut&&E.emissiveMap.isVideoTexture===!0&&zt.getTransfer(E.emissiveMap.colorSpace)===ln,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===ws,flipSided:E.side===tr,useDepthPacking:E.depthPacking>=0,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionClipCullDistance:Ct&&E.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ct&&E.extensions.multiDraw===!0||dt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:E.customProgramCacheKey()};return _i.vertexUv1s=d.has(1),_i.vertexUv2s=d.has(2),_i.vertexUv3s=d.has(3),d.clear(),_i}function g(E){let S=[];if(E.shaderID?S.push(E.shaderID):(S.push(E.customVertexShaderID),S.push(E.customFragmentShaderID)),E.defines!==void 0)for(let P in E.defines)S.push(P),S.push(E.defines[P]);return E.isRawShaderMaterial===!1&&(y(S,E),b(S,E),S.push(i.outputColorSpace)),S.push(E.customProgramCacheKey),S.join()}function y(E,S){E.push(S.precision),E.push(S.outputColorSpace),E.push(S.envMapMode),E.push(S.envMapCubeUVHeight),E.push(S.mapUv),E.push(S.alphaMapUv),E.push(S.lightMapUv),E.push(S.aoMapUv),E.push(S.bumpMapUv),E.push(S.normalMapUv),E.push(S.displacementMapUv),E.push(S.emissiveMapUv),E.push(S.metalnessMapUv),E.push(S.roughnessMapUv),E.push(S.anisotropyMapUv),E.push(S.clearcoatMapUv),E.push(S.clearcoatNormalMapUv),E.push(S.clearcoatRoughnessMapUv),E.push(S.iridescenceMapUv),E.push(S.iridescenceThicknessMapUv),E.push(S.sheenColorMapUv),E.push(S.sheenRoughnessMapUv),E.push(S.specularMapUv),E.push(S.specularColorMapUv),E.push(S.specularIntensityMapUv),E.push(S.transmissionMapUv),E.push(S.thicknessMapUv),E.push(S.combine),E.push(S.fogExp2),E.push(S.sizeAttenuation),E.push(S.morphTargetsCount),E.push(S.morphAttributeCount),E.push(S.numDirLights),E.push(S.numPointLights),E.push(S.numSpotLights),E.push(S.numSpotLightMaps),E.push(S.numHemiLights),E.push(S.numRectAreaLights),E.push(S.numDirLightShadows),E.push(S.numPointLightShadows),E.push(S.numSpotLightShadows),E.push(S.numSpotLightShadowsWithMaps),E.push(S.numLightProbes),E.push(S.shadowMapType),E.push(S.toneMapping),E.push(S.numClippingPlanes),E.push(S.numClipIntersection),E.push(S.depthPacking)}function b(E,S){a.disableAll(),S.supportsVertexTextures&&a.enable(0),S.instancing&&a.enable(1),S.instancingColor&&a.enable(2),S.instancingMorph&&a.enable(3),S.matcap&&a.enable(4),S.envMap&&a.enable(5),S.normalMapObjectSpace&&a.enable(6),S.normalMapTangentSpace&&a.enable(7),S.clearcoat&&a.enable(8),S.iridescence&&a.enable(9),S.alphaTest&&a.enable(10),S.vertexColors&&a.enable(11),S.vertexAlphas&&a.enable(12),S.vertexUv1s&&a.enable(13),S.vertexUv2s&&a.enable(14),S.vertexUv3s&&a.enable(15),S.vertexTangents&&a.enable(16),S.anisotropy&&a.enable(17),S.alphaHash&&a.enable(18),S.batching&&a.enable(19),S.dispersion&&a.enable(20),S.batchingColor&&a.enable(21),E.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.reverseDepthBuffer&&a.enable(4),S.skinning&&a.enable(5),S.morphTargets&&a.enable(6),S.morphNormals&&a.enable(7),S.morphColors&&a.enable(8),S.premultipliedAlpha&&a.enable(9),S.shadowMapEnabled&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.transmission&&a.enable(15),S.sheen&&a.enable(16),S.opaque&&a.enable(17),S.pointsUvs&&a.enable(18),S.decodeVideoTexture&&a.enable(19),S.decodeVideoTextureEmissive&&a.enable(20),S.alphaToCoverage&&a.enable(21),E.push(a.mask)}function A(E){let S=p[E.type],P;if(S){let j=zs[S];P=$7.clone(j.uniforms)}else P=E.uniforms;return P}function M(E,S){let P;for(let j=0,B=c.length;j<B;j++){let z=c[j];if(z.cacheKey===S){P=z,++P.usedTimes;break}}return P===void 0&&(P=new aq(i,S,E,s),c.push(P)),P}function T(E){if(--E.usedTimes===0){let S=c.indexOf(E);c[S]=c[c.length-1],c.pop(),E.destroy()}}function I(E){l.remove(E)}function L(){l.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:A,acquireProgram:M,releaseProgram:T,releaseShaderCache:I,programs:c,dispose:L}}function cq(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let a=i.get(o);return a===void 0&&(a={},i.set(o,a)),a}function n(o){i.delete(o)}function r(o,a,l){i.get(o)[a]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function uq(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function yL(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function AL(){let i=[],e=0,t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(u,h,f,p,x,v){let g=i[e];return g===void 0?(g={id:u.id,object:u,geometry:h,material:f,groupOrder:p,renderOrder:u.renderOrder,z:x,group:v},i[e]=g):(g.id=u.id,g.object=u,g.geometry=h,g.material=f,g.groupOrder=p,g.renderOrder=u.renderOrder,g.z=x,g.group=v),e++,g}function a(u,h,f,p,x,v){let g=o(u,h,f,p,x,v);f.transmission>0?n.push(g):f.transparent===!0?r.push(g):t.push(g)}function l(u,h,f,p,x,v){let g=o(u,h,f,p,x,v);f.transmission>0?n.unshift(g):f.transparent===!0?r.unshift(g):t.unshift(g)}function d(u,h){t.length>1&&t.sort(u||uq),n.length>1&&n.sort(h||yL),r.length>1&&r.sort(h||yL)}function c(){for(let u=e,h=i.length;u<h;u++){let f=i[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:c,sort:d}}function hq(){let i=new WeakMap;function e(n,r){let s=i.get(n),o;return s===void 0?(o=new AL,i.set(n,[o])):r>=s.length?(o=new AL,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function fq(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new V,color:new mt};break;case"SpotLight":t={position:new V,direction:new V,color:new mt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new V,color:new mt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new V,skyColor:new mt,groundColor:new mt};break;case"RectAreaLight":t={color:new mt,position:new V,halfWidth:new V,halfHeight:new V};break}return i[e.id]=t,t}}}function pq(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new we};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new we};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new we,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var mq=0;function gq(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function vq(i){let e=new fq,t=pq(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)n.probe.push(new V);let r=new V,s=new _t,o=new _t;function a(d){let c=0,u=0,h=0;for(let E=0;E<9;E++)n.probe[E].set(0,0,0);let f=0,p=0,x=0,v=0,g=0,y=0,b=0,A=0,M=0,T=0,I=0;d.sort(gq);for(let E=0,S=d.length;E<S;E++){let P=d[E],j=P.color,B=P.intensity,z=P.distance,X=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)c+=j.r*B,u+=j.g*B,h+=j.b*B;else if(P.isLightProbe){for(let Q=0;Q<9;Q++)n.probe[Q].addScaledVector(P.sh.coefficients[Q],B);I++}else if(P.isDirectionalLight){let Q=e.get(P);if(Q.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){let K=P.shadow,Y=t.get(P);Y.shadowIntensity=K.intensity,Y.shadowBias=K.bias,Y.shadowNormalBias=K.normalBias,Y.shadowRadius=K.radius,Y.shadowMapSize=K.mapSize,n.directionalShadow[f]=Y,n.directionalShadowMap[f]=X,n.directionalShadowMatrix[f]=P.shadow.matrix,y++}n.directional[f]=Q,f++}else if(P.isSpotLight){let Q=e.get(P);Q.position.setFromMatrixPosition(P.matrixWorld),Q.color.copy(j).multiplyScalar(B),Q.distance=z,Q.coneCos=Math.cos(P.angle),Q.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),Q.decay=P.decay,n.spot[x]=Q;let K=P.shadow;if(P.map&&(n.spotLightMap[M]=P.map,M++,K.updateMatrices(P),P.castShadow&&T++),n.spotLightMatrix[x]=K.matrix,P.castShadow){let Y=t.get(P);Y.shadowIntensity=K.intensity,Y.shadowBias=K.bias,Y.shadowNormalBias=K.normalBias,Y.shadowRadius=K.radius,Y.shadowMapSize=K.mapSize,n.spotShadow[x]=Y,n.spotShadowMap[x]=X,A++}x++}else if(P.isRectAreaLight){let Q=e.get(P);Q.color.copy(j).multiplyScalar(B),Q.halfWidth.set(P.width*.5,0,0),Q.halfHeight.set(0,P.height*.5,0),n.rectArea[v]=Q,v++}else if(P.isPointLight){let Q=e.get(P);if(Q.color.copy(P.color).multiplyScalar(P.intensity),Q.distance=P.distance,Q.decay=P.decay,P.castShadow){let K=P.shadow,Y=t.get(P);Y.shadowIntensity=K.intensity,Y.shadowBias=K.bias,Y.shadowNormalBias=K.normalBias,Y.shadowRadius=K.radius,Y.shadowMapSize=K.mapSize,Y.shadowCameraNear=K.camera.near,Y.shadowCameraFar=K.camera.far,n.pointShadow[p]=Y,n.pointShadowMap[p]=X,n.pointShadowMatrix[p]=P.shadow.matrix,b++}n.point[p]=Q,p++}else if(P.isHemisphereLight){let Q=e.get(P);Q.skyColor.copy(P.color).multiplyScalar(B),Q.groundColor.copy(P.groundColor).multiplyScalar(B),n.hemi[g]=Q,g++}}v>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=De.LTC_FLOAT_1,n.rectAreaLTC2=De.LTC_FLOAT_2):(n.rectAreaLTC1=De.LTC_HALF_1,n.rectAreaLTC2=De.LTC_HALF_2)),n.ambient[0]=c,n.ambient[1]=u,n.ambient[2]=h;let L=n.hash;(L.directionalLength!==f||L.pointLength!==p||L.spotLength!==x||L.rectAreaLength!==v||L.hemiLength!==g||L.numDirectionalShadows!==y||L.numPointShadows!==b||L.numSpotShadows!==A||L.numSpotMaps!==M||L.numLightProbes!==I)&&(n.directional.length=f,n.spot.length=x,n.rectArea.length=v,n.point.length=p,n.hemi.length=g,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=b,n.pointShadowMap.length=b,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=b,n.spotLightMatrix.length=A+M-T,n.spotLightMap.length=M,n.numSpotLightShadowsWithMaps=T,n.numLightProbes=I,L.directionalLength=f,L.pointLength=p,L.spotLength=x,L.rectAreaLength=v,L.hemiLength=g,L.numDirectionalShadows=y,L.numPointShadows=b,L.numSpotShadows=A,L.numSpotMaps=M,L.numLightProbes=I,n.version=mq++)}function l(d,c){let u=0,h=0,f=0,p=0,x=0,v=c.matrixWorldInverse;for(let g=0,y=d.length;g<y;g++){let b=d[g];if(b.isDirectionalLight){let A=n.directional[u];A.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(v),u++}else if(b.isSpotLight){let A=n.spot[f];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),A.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(v),f++}else if(b.isRectAreaLight){let A=n.rectArea[p];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),o.identity(),s.copy(b.matrixWorld),s.premultiply(v),o.extractRotation(s),A.halfWidth.set(b.width*.5,0,0),A.halfHeight.set(0,b.height*.5,0),A.halfWidth.applyMatrix4(o),A.halfHeight.applyMatrix4(o),p++}else if(b.isPointLight){let A=n.point[h];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(v),h++}else if(b.isHemisphereLight){let A=n.hemi[x];A.direction.setFromMatrixPosition(b.matrixWorld),A.direction.transformDirection(v),x++}}}return{setup:a,setupView:l,state:n}}function _L(i){let e=new vq(i),t=[],n=[];function r(c){d.camera=c,t.length=0,n.length=0}function s(c){t.push(c)}function o(c){n.push(c)}function a(){e.setup(t)}function l(c){e.setupView(t,c)}let d={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:d,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function xq(i){let e=new WeakMap;function t(r,s=0){let o=e.get(r),a;return o===void 0?(a=new _L(i),e.set(r,[a])):s>=o.length?(a=new _L(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}var n_=class extends Tn{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=c7,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},i_=class extends Tn{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},wq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,bq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function yq(i,e,t){let n=new Uh,r=new we,s=new we,o=new Jt,a=new n_({depthPacking:u7}),l=new i_,d={},c=t.maxTextureSize,u={[Ws]:tr,[tr]:Ws,[ws]:ws},h=new Zs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new we},radius:{value:4}},vertexShader:wq,fragmentShader:bq}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new xr;p.setAttribute("position",new $n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let x=new jt(p,h),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=XL;let g=this.type;this.render=function(T,I,L){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||T.length===0)return;let E=i.getRenderTarget(),S=i.getActiveCubeFace(),P=i.getActiveMipmapLevel(),j=i.state;j.setBlending(Ba),j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);let B=g!==Po&&this.type===Po,z=g===Po&&this.type!==Po;for(let X=0,Q=T.length;X<Q;X++){let K=T[X],Y=K.shadow;if(Y===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(Y.autoUpdate===!1&&Y.needsUpdate===!1)continue;r.copy(Y.mapSize);let Ae=Y.getFrameExtents();if(r.multiply(Ae),s.copy(Y.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/Ae.x),r.x=s.x*Ae.x,Y.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/Ae.y),r.y=s.y*Ae.y,Y.mapSize.y=s.y)),Y.map===null||B===!0||z===!0){let Ie=this.type!==Po?{minFilter:Pi,magFilter:Pi}:{};Y.map!==null&&Y.map.dispose(),Y.map=new Oo(r.x,r.y,Ie),Y.map.texture.name=K.name+".shadowMap",Y.camera.updateProjectionMatrix()}i.setRenderTarget(Y.map),i.clear();let Ce=Y.getViewportCount();for(let Ie=0;Ie<Ce;Ie++){let He=Y.getViewport(Ie);o.set(s.x*He.x,s.y*He.y,s.x*He.z,s.y*He.w),j.viewport(o),Y.updateMatrices(K,Ie),n=Y.getFrustum(),A(I,L,Y.camera,K,this.type)}Y.isPointLightShadow!==!0&&this.type===Po&&y(Y,L),Y.needsUpdate=!1}g=this.type,v.needsUpdate=!1,i.setRenderTarget(E,S,P)};function y(T,I){let L=e.update(x);h.defines.VSM_SAMPLES!==T.blurSamples&&(h.defines.VSM_SAMPLES=T.blurSamples,f.defines.VSM_SAMPLES=T.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new Oo(r.x,r.y)),h.uniforms.shadow_pass.value=T.map.texture,h.uniforms.resolution.value=T.mapSize,h.uniforms.radius.value=T.radius,i.setRenderTarget(T.mapPass),i.clear(),i.renderBufferDirect(I,null,L,h,x,null),f.uniforms.shadow_pass.value=T.mapPass.texture,f.uniforms.resolution.value=T.mapSize,f.uniforms.radius.value=T.radius,i.setRenderTarget(T.map),i.clear(),i.renderBufferDirect(I,null,L,f,x,null)}function b(T,I,L,E){let S=null,P=L.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(P!==void 0)S=P;else if(S=L.isPointLight===!0?l:a,i.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){let j=S.uuid,B=I.uuid,z=d[j];z===void 0&&(z={},d[j]=z);let X=z[B];X===void 0&&(X=S.clone(),z[B]=X,I.addEventListener("dispose",M)),S=X}if(S.visible=I.visible,S.wireframe=I.wireframe,E===Po?S.side=I.shadowSide!==null?I.shadowSide:I.side:S.side=I.shadowSide!==null?I.shadowSide:u[I.side],S.alphaMap=I.alphaMap,S.alphaTest=I.alphaTest,S.map=I.map,S.clipShadows=I.clipShadows,S.clippingPlanes=I.clippingPlanes,S.clipIntersection=I.clipIntersection,S.displacementMap=I.displacementMap,S.displacementScale=I.displacementScale,S.displacementBias=I.displacementBias,S.wireframeLinewidth=I.wireframeLinewidth,S.linewidth=I.linewidth,L.isPointLight===!0&&S.isMeshDistanceMaterial===!0){let j=i.properties.get(S);j.light=L}return S}function A(T,I,L,E,S){if(T.visible===!1)return;if(T.layers.test(I.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&S===Po)&&(!T.frustumCulled||n.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,T.matrixWorld);let B=e.update(T),z=T.material;if(Array.isArray(z)){let X=B.groups;for(let Q=0,K=X.length;Q<K;Q++){let Y=X[Q],Ae=z[Y.materialIndex];if(Ae&&Ae.visible){let Ce=b(T,Ae,E,S);T.onBeforeShadow(i,T,I,L,B,Ce,Y),i.renderBufferDirect(L,null,B,Ce,T,Y),T.onAfterShadow(i,T,I,L,B,Ce,Y)}}}else if(z.visible){let X=b(T,z,E,S);T.onBeforeShadow(i,T,I,L,B,X,null),i.renderBufferDirect(L,null,B,X,T,null),T.onAfterShadow(i,T,I,L,B,X,null)}}let j=T.children;for(let B=0,z=j.length;B<z;B++)A(j[B],I,L,E,S)}function M(T){T.target.removeEventListener("dispose",M);for(let L in d){let E=d[L],S=T.target.uuid;S in E&&(E[S].dispose(),delete E[S])}}}var Aq={[dA]:cA,[uA]:pA,[hA]:mA,[Cc]:fA,[cA]:dA,[pA]:uA,[mA]:hA,[fA]:Cc};function _q(i,e){function t(){let W=!1,Le=new Jt,oe=null,fe=new Jt(0,0,0,0);return{setMask:function(Fe){oe!==Fe&&!W&&(i.colorMask(Fe,Fe,Fe,Fe),oe=Fe)},setLocked:function(Fe){W=Fe},setClear:function(Fe,ke,Ct,Pn,_i){_i===!0&&(Fe*=Pn,ke*=Pn,Ct*=Pn),Le.set(Fe,ke,Ct,Pn),fe.equals(Le)===!1&&(i.clearColor(Fe,ke,Ct,Pn),fe.copy(Le))},reset:function(){W=!1,oe=null,fe.set(-1,0,0,0)}}}function n(){let W=!1,Le=!1,oe=null,fe=null,Fe=null;return{setReversed:function(ke){if(Le!==ke){let Ct=e.get("EXT_clip_control");Le?Ct.clipControlEXT(Ct.LOWER_LEFT_EXT,Ct.ZERO_TO_ONE_EXT):Ct.clipControlEXT(Ct.LOWER_LEFT_EXT,Ct.NEGATIVE_ONE_TO_ONE_EXT);let Pn=Fe;Fe=null,this.setClear(Pn)}Le=ke},getReversed:function(){return Le},setTest:function(ke){ke?he(i.DEPTH_TEST):Ge(i.DEPTH_TEST)},setMask:function(ke){oe!==ke&&!W&&(i.depthMask(ke),oe=ke)},setFunc:function(ke){if(Le&&(ke=Aq[ke]),fe!==ke){switch(ke){case dA:i.depthFunc(i.NEVER);break;case cA:i.depthFunc(i.ALWAYS);break;case uA:i.depthFunc(i.LESS);break;case Cc:i.depthFunc(i.LEQUAL);break;case hA:i.depthFunc(i.EQUAL);break;case fA:i.depthFunc(i.GEQUAL);break;case pA:i.depthFunc(i.GREATER);break;case mA:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}fe=ke}},setLocked:function(ke){W=ke},setClear:function(ke){Fe!==ke&&(Le&&(ke=1-ke),i.clearDepth(ke),Fe=ke)},reset:function(){W=!1,oe=null,fe=null,Fe=null,Le=!1}}}function r(){let W=!1,Le=null,oe=null,fe=null,Fe=null,ke=null,Ct=null,Pn=null,_i=null;return{setTest:function(nn){W||(nn?he(i.STENCIL_TEST):Ge(i.STENCIL_TEST))},setMask:function(nn){Le!==nn&&!W&&(i.stencilMask(nn),Le=nn)},setFunc:function(nn,Jr,$s){(oe!==nn||fe!==Jr||Fe!==$s)&&(i.stencilFunc(nn,Jr,$s),oe=nn,fe=Jr,Fe=$s)},setOp:function(nn,Jr,$s){(ke!==nn||Ct!==Jr||Pn!==$s)&&(i.stencilOp(nn,Jr,$s),ke=nn,Ct=Jr,Pn=$s)},setLocked:function(nn){W=nn},setClear:function(nn){_i!==nn&&(i.clearStencil(nn),_i=nn)},reset:function(){W=!1,Le=null,oe=null,fe=null,Fe=null,ke=null,Ct=null,Pn=null,_i=null}}}let s=new t,o=new n,a=new r,l=new WeakMap,d=new WeakMap,c={},u={},h=new WeakMap,f=[],p=null,x=!1,v=null,g=null,y=null,b=null,A=null,M=null,T=null,I=new mt(0,0,0),L=0,E=!1,S=null,P=null,j=null,B=null,z=null,X=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Q=!1,K=0,Y=i.getParameter(i.VERSION);Y.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(Y)[1]),Q=K>=1):Y.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),Q=K>=2);let Ae=null,Ce={},Ie=i.getParameter(i.SCISSOR_BOX),He=i.getParameter(i.VIEWPORT),at=new Jt().fromArray(Ie),le=new Jt().fromArray(He);function be(W,Le,oe,fe){let Fe=new Uint8Array(4),ke=i.createTexture();i.bindTexture(W,ke),i.texParameteri(W,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(W,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Ct=0;Ct<oe;Ct++)W===i.TEXTURE_3D||W===i.TEXTURE_2D_ARRAY?i.texImage3D(Le,0,i.RGBA,1,1,fe,0,i.RGBA,i.UNSIGNED_BYTE,Fe):i.texImage2D(Le+Ct,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Fe);return ke}let Pe={};Pe[i.TEXTURE_2D]=be(i.TEXTURE_2D,i.TEXTURE_2D,1),Pe[i.TEXTURE_CUBE_MAP]=be(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Pe[i.TEXTURE_2D_ARRAY]=be(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Pe[i.TEXTURE_3D]=be(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),he(i.DEPTH_TEST),o.setFunc(Cc),xe(!1),Ue(_R),he(i.CULL_FACE),O(Ba);function he(W){c[W]!==!0&&(i.enable(W),c[W]=!0)}function Ge(W){c[W]!==!1&&(i.disable(W),c[W]=!1)}function ct(W,Le){return u[W]!==Le?(i.bindFramebuffer(W,Le),u[W]=Le,W===i.DRAW_FRAMEBUFFER&&(u[i.FRAMEBUFFER]=Le),W===i.FRAMEBUFFER&&(u[i.DRAW_FRAMEBUFFER]=Le),!0):!1}function dt(W,Le){let oe=f,fe=!1;if(W){oe=h.get(Le),oe===void 0&&(oe=[],h.set(Le,oe));let Fe=W.textures;if(oe.length!==Fe.length||oe[0]!==i.COLOR_ATTACHMENT0){for(let ke=0,Ct=Fe.length;ke<Ct;ke++)oe[ke]=i.COLOR_ATTACHMENT0+ke;oe.length=Fe.length,fe=!0}}else oe[0]!==i.BACK&&(oe[0]=i.BACK,fe=!0);fe&&i.drawBuffers(oe)}function Xt(W){return p!==W?(i.useProgram(W),p=W,!0):!1}let pe={[Ll]:i.FUNC_ADD,[Fz]:i.FUNC_SUBTRACT,[Oz]:i.FUNC_REVERSE_SUBTRACT};pe[Bz]=i.MIN,pe[Vz]=i.MAX;let _e={[Uz]:i.ZERO,[Hz]:i.ONE,[zz]:i.SRC_COLOR,[aA]:i.SRC_ALPHA,[Yz]:i.SRC_ALPHA_SATURATE,[qz]:i.DST_COLOR,[Gz]:i.DST_ALPHA,[jz]:i.ONE_MINUS_SRC_COLOR,[lA]:i.ONE_MINUS_SRC_ALPHA,[Zz]:i.ONE_MINUS_DST_COLOR,[Wz]:i.ONE_MINUS_DST_ALPHA,[Xz]:i.CONSTANT_COLOR,[Qz]:i.ONE_MINUS_CONSTANT_COLOR,[Kz]:i.CONSTANT_ALPHA,[Jz]:i.ONE_MINUS_CONSTANT_ALPHA};function O(W,Le,oe,fe,Fe,ke,Ct,Pn,_i,nn){if(W===Ba){x===!0&&(Ge(i.BLEND),x=!1);return}if(x===!1&&(he(i.BLEND),x=!0),W!==Nz){if(W!==v||nn!==E){if((g!==Ll||A!==Ll)&&(i.blendEquation(i.FUNC_ADD),g=Ll,A=Ll),nn)switch(W){case bc:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case SR:i.blendFunc(i.ONE,i.ONE);break;case ER:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case CR:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}else switch(W){case bc:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case SR:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case ER:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case CR:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}y=null,b=null,M=null,T=null,I.set(0,0,0),L=0,v=W,E=nn}return}Fe=Fe||Le,ke=ke||oe,Ct=Ct||fe,(Le!==g||Fe!==A)&&(i.blendEquationSeparate(pe[Le],pe[Fe]),g=Le,A=Fe),(oe!==y||fe!==b||ke!==M||Ct!==T)&&(i.blendFuncSeparate(_e[oe],_e[fe],_e[ke],_e[Ct]),y=oe,b=fe,M=ke,T=Ct),(Pn.equals(I)===!1||_i!==L)&&(i.blendColor(Pn.r,Pn.g,Pn.b,_i),I.copy(Pn),L=_i),v=W,E=!1}function it(W,Le){W.side===ws?Ge(i.CULL_FACE):he(i.CULL_FACE);let oe=W.side===tr;Le&&(oe=!oe),xe(oe),W.blending===bc&&W.transparent===!1?O(Ba):O(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.blendColor,W.blendAlpha,W.premultipliedAlpha),o.setFunc(W.depthFunc),o.setTest(W.depthTest),o.setMask(W.depthWrite),s.setMask(W.colorWrite);let fe=W.stencilWrite;a.setTest(fe),fe&&(a.setMask(W.stencilWriteMask),a.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),a.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),ut(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?he(i.SAMPLE_ALPHA_TO_COVERAGE):Ge(i.SAMPLE_ALPHA_TO_COVERAGE)}function xe(W){S!==W&&(W?i.frontFace(i.CW):i.frontFace(i.CCW),S=W)}function Ue(W){W!==Rz?(he(i.CULL_FACE),W!==P&&(W===_R?i.cullFace(i.BACK):W===Lz?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Ge(i.CULL_FACE),P=W}function Me(W){W!==j&&(Q&&i.lineWidth(W),j=W)}function ut(W,Le,oe){W?(he(i.POLYGON_OFFSET_FILL),(B!==Le||z!==oe)&&(i.polygonOffset(Le,oe),B=Le,z=oe)):Ge(i.POLYGON_OFFSET_FILL)}function Oe(W){W?he(i.SCISSOR_TEST):Ge(i.SCISSOR_TEST)}function N(W){W===void 0&&(W=i.TEXTURE0+X-1),Ae!==W&&(i.activeTexture(W),Ae=W)}function D(W,Le,oe){oe===void 0&&(Ae===null?oe=i.TEXTURE0+X-1:oe=Ae);let fe=Ce[oe];fe===void 0&&(fe={type:void 0,texture:void 0},Ce[oe]=fe),(fe.type!==W||fe.texture!==Le)&&(Ae!==oe&&(i.activeTexture(oe),Ae=oe),i.bindTexture(W,Le||Pe[W]),fe.type=W,fe.texture=Le)}function J(){let W=Ce[Ae];W!==void 0&&W.type!==void 0&&(i.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function de(){try{i.compressedTexImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function me(){try{i.compressedTexImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ce(){try{i.texSubImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Ke(){try{i.texSubImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Re(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Be(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Ut(){try{i.texStorage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ye(){try{i.texStorage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ze(){try{i.texImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ht(){try{i.texImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function vt(W){at.equals(W)===!1&&(i.scissor(W.x,W.y,W.z,W.w),at.copy(W))}function je(W){le.equals(W)===!1&&(i.viewport(W.x,W.y,W.z,W.w),le.copy(W))}function Wt(W,Le){let oe=d.get(Le);oe===void 0&&(oe=new WeakMap,d.set(Le,oe));let fe=oe.get(W);fe===void 0&&(fe=i.getUniformBlockIndex(Le,W.name),oe.set(W,fe))}function Lt(W,Le){let fe=d.get(Le).get(W);l.get(Le)!==fe&&(i.uniformBlockBinding(Le,fe,W.__bindingPointIndex),l.set(Le,fe))}function pn(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),c={},Ae=null,Ce={},u={},h=new WeakMap,f=[],p=null,x=!1,v=null,g=null,y=null,b=null,A=null,M=null,T=null,I=new mt(0,0,0),L=0,E=!1,S=null,P=null,j=null,B=null,z=null,at.set(0,0,i.canvas.width,i.canvas.height),le.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:he,disable:Ge,bindFramebuffer:ct,drawBuffers:dt,useProgram:Xt,setBlending:O,setMaterial:it,setFlipSided:xe,setCullFace:Ue,setLineWidth:Me,setPolygonOffset:ut,setScissorTest:Oe,activeTexture:N,bindTexture:D,unbindTexture:J,compressedTexImage2D:de,compressedTexImage3D:me,texImage2D:ze,texImage3D:ht,updateUBOMapping:Wt,uniformBlockBinding:Lt,texStorage2D:Ut,texStorage3D:ye,texSubImage2D:ce,texSubImage3D:Ke,compressedTexSubImage2D:Re,compressedTexSubImage3D:Be,scissor:vt,viewport:je,reset:pn}}function SL(i,e,t,n){let r=Sq(n);switch(t){case e3:return i*e;case n3:return i*e;case i3:return i*e*2;case k_:return i*e/r.components*r.byteLength;case N_:return i*e/r.components*r.byteLength;case r3:return i*e*2/r.components*r.byteLength;case F_:return i*e*2/r.components*r.byteLength;case t3:return i*e*3/r.components*r.byteLength;case Vr:return i*e*4/r.components*r.byteLength;case O_:return i*e*4/r.components*r.byteLength;case Xg:case Qg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Kg:case Jg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case wA:case yA:return Math.max(i,16)*Math.max(e,8)/4;case xA:case bA:return Math.max(i,8)*Math.max(e,8)/2;case AA:case _A:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case SA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case EA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case CA:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case MA:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case TA:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case IA:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case DA:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case PA:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case RA:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case LA:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case kA:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case NA:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case FA:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case OA:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case BA:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case $g:case VA:case UA:return Math.ceil(i/4)*Math.ceil(e/4)*16;case s3:case HA:return Math.ceil(i/4)*Math.ceil(e/4)*8;case zA:case jA:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Sq(i){switch(i){case No:case KL:return{byteLength:1,components:1};case Oh:case JL:case $h:return{byteLength:2,components:1};case R_:case L_:return{byteLength:2,components:4};case Ol:case P_:case ys:return{byteLength:4,components:1};case $L:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}function Eq(i,e,t,n,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new we,c=new WeakMap,u,h=new WeakMap,f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(N,D){return f?new OffscreenCanvas(N,D):Bh("canvas")}function x(N,D,J){let de=1,me=Oe(N);if((me.width>J||me.height>J)&&(de=J/Math.max(me.width,me.height)),de<1)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap||typeof VideoFrame<"u"&&N instanceof VideoFrame){let ce=Math.floor(de*me.width),Ke=Math.floor(de*me.height);u===void 0&&(u=p(ce,Ke));let Re=D?p(ce,Ke):u;return Re.width=ce,Re.height=Ke,Re.getContext("2d").drawImage(N,0,0,ce,Ke),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+me.width+"x"+me.height+") to ("+ce+"x"+Ke+")."),Re}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+me.width+"x"+me.height+")."),N;return N}function v(N){return N.generateMipmaps}function g(N){i.generateMipmap(N)}function y(N){return N.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:N.isWebGL3DRenderTarget?i.TEXTURE_3D:N.isWebGLArrayRenderTarget||N.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function b(N,D,J,de,me=!1){if(N!==null){if(i[N]!==void 0)return i[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let ce=D;if(D===i.RED&&(J===i.FLOAT&&(ce=i.R32F),J===i.HALF_FLOAT&&(ce=i.R16F),J===i.UNSIGNED_BYTE&&(ce=i.R8)),D===i.RED_INTEGER&&(J===i.UNSIGNED_BYTE&&(ce=i.R8UI),J===i.UNSIGNED_SHORT&&(ce=i.R16UI),J===i.UNSIGNED_INT&&(ce=i.R32UI),J===i.BYTE&&(ce=i.R8I),J===i.SHORT&&(ce=i.R16I),J===i.INT&&(ce=i.R32I)),D===i.RG&&(J===i.FLOAT&&(ce=i.RG32F),J===i.HALF_FLOAT&&(ce=i.RG16F),J===i.UNSIGNED_BYTE&&(ce=i.RG8)),D===i.RG_INTEGER&&(J===i.UNSIGNED_BYTE&&(ce=i.RG8UI),J===i.UNSIGNED_SHORT&&(ce=i.RG16UI),J===i.UNSIGNED_INT&&(ce=i.RG32UI),J===i.BYTE&&(ce=i.RG8I),J===i.SHORT&&(ce=i.RG16I),J===i.INT&&(ce=i.RG32I)),D===i.RGB_INTEGER&&(J===i.UNSIGNED_BYTE&&(ce=i.RGB8UI),J===i.UNSIGNED_SHORT&&(ce=i.RGB16UI),J===i.UNSIGNED_INT&&(ce=i.RGB32UI),J===i.BYTE&&(ce=i.RGB8I),J===i.SHORT&&(ce=i.RGB16I),J===i.INT&&(ce=i.RGB32I)),D===i.RGBA_INTEGER&&(J===i.UNSIGNED_BYTE&&(ce=i.RGBA8UI),J===i.UNSIGNED_SHORT&&(ce=i.RGBA16UI),J===i.UNSIGNED_INT&&(ce=i.RGBA32UI),J===i.BYTE&&(ce=i.RGBA8I),J===i.SHORT&&(ce=i.RGBA16I),J===i.INT&&(ce=i.RGBA32I)),D===i.RGB&&J===i.UNSIGNED_INT_5_9_9_9_REV&&(ce=i.RGB9_E5),D===i.RGBA){let Ke=me?k0:zt.getTransfer(de);J===i.FLOAT&&(ce=i.RGBA32F),J===i.HALF_FLOAT&&(ce=i.RGBA16F),J===i.UNSIGNED_BYTE&&(ce=Ke===ln?i.SRGB8_ALPHA8:i.RGBA8),J===i.UNSIGNED_SHORT_4_4_4_4&&(ce=i.RGBA4),J===i.UNSIGNED_SHORT_5_5_5_1&&(ce=i.RGB5_A1)}return(ce===i.R16F||ce===i.R32F||ce===i.RG16F||ce===i.RG32F||ce===i.RGBA16F||ce===i.RGBA32F)&&e.get("EXT_color_buffer_float"),ce}function A(N,D){let J;return N?D===null||D===Ol||D===Ic?J=i.DEPTH24_STENCIL8:D===ys?J=i.DEPTH32F_STENCIL8:D===Oh&&(J=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):D===null||D===Ol||D===Ic?J=i.DEPTH_COMPONENT24:D===ys?J=i.DEPTH_COMPONENT32F:D===Oh&&(J=i.DEPTH_COMPONENT16),J}function M(N,D){return v(N)===!0||N.isFramebufferTexture&&N.minFilter!==Pi&&N.minFilter!==er?Math.log2(Math.max(D.width,D.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?D.mipmaps.length:1}function T(N){let D=N.target;D.removeEventListener("dispose",T),L(D),D.isVideoTexture&&c.delete(D)}function I(N){let D=N.target;D.removeEventListener("dispose",I),S(D)}function L(N){let D=n.get(N);if(D.__webglInit===void 0)return;let J=N.source,de=h.get(J);if(de){let me=de[D.__cacheKey];me.usedTimes--,me.usedTimes===0&&E(N),Object.keys(de).length===0&&h.delete(J)}n.remove(N)}function E(N){let D=n.get(N);i.deleteTexture(D.__webglTexture);let J=N.source,de=h.get(J);delete de[D.__cacheKey],o.memory.textures--}function S(N){let D=n.get(N);if(N.depthTexture&&(N.depthTexture.dispose(),n.remove(N.depthTexture)),N.isWebGLCubeRenderTarget)for(let de=0;de<6;de++){if(Array.isArray(D.__webglFramebuffer[de]))for(let me=0;me<D.__webglFramebuffer[de].length;me++)i.deleteFramebuffer(D.__webglFramebuffer[de][me]);else i.deleteFramebuffer(D.__webglFramebuffer[de]);D.__webglDepthbuffer&&i.deleteRenderbuffer(D.__webglDepthbuffer[de])}else{if(Array.isArray(D.__webglFramebuffer))for(let de=0;de<D.__webglFramebuffer.length;de++)i.deleteFramebuffer(D.__webglFramebuffer[de]);else i.deleteFramebuffer(D.__webglFramebuffer);if(D.__webglDepthbuffer&&i.deleteRenderbuffer(D.__webglDepthbuffer),D.__webglMultisampledFramebuffer&&i.deleteFramebuffer(D.__webglMultisampledFramebuffer),D.__webglColorRenderbuffer)for(let de=0;de<D.__webglColorRenderbuffer.length;de++)D.__webglColorRenderbuffer[de]&&i.deleteRenderbuffer(D.__webglColorRenderbuffer[de]);D.__webglDepthRenderbuffer&&i.deleteRenderbuffer(D.__webglDepthRenderbuffer)}let J=N.textures;for(let de=0,me=J.length;de<me;de++){let ce=n.get(J[de]);ce.__webglTexture&&(i.deleteTexture(ce.__webglTexture),o.memory.textures--),n.remove(J[de])}n.remove(N)}let P=0;function j(){P=0}function B(){let N=P;return N>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+r.maxTextures),P+=1,N}function z(N){let D=[];return D.push(N.wrapS),D.push(N.wrapT),D.push(N.wrapR||0),D.push(N.magFilter),D.push(N.minFilter),D.push(N.anisotropy),D.push(N.internalFormat),D.push(N.format),D.push(N.type),D.push(N.generateMipmaps),D.push(N.premultiplyAlpha),D.push(N.flipY),D.push(N.unpackAlignment),D.push(N.colorSpace),D.join()}function X(N,D){let J=n.get(N);if(N.isVideoTexture&&Me(N),N.isRenderTargetTexture===!1&&N.version>0&&J.__version!==N.version){let de=N.image;if(de===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(de.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(J,N,D);return}}t.bindTexture(i.TEXTURE_2D,J.__webglTexture,i.TEXTURE0+D)}function Q(N,D){let J=n.get(N);if(N.version>0&&J.__version!==N.version){le(J,N,D);return}t.bindTexture(i.TEXTURE_2D_ARRAY,J.__webglTexture,i.TEXTURE0+D)}function K(N,D){let J=n.get(N);if(N.version>0&&J.__version!==N.version){le(J,N,D);return}t.bindTexture(i.TEXTURE_3D,J.__webglTexture,i.TEXTURE0+D)}function Y(N,D){let J=n.get(N);if(N.version>0&&J.__version!==N.version){be(J,N,D);return}t.bindTexture(i.TEXTURE_CUBE_MAP,J.__webglTexture,i.TEXTURE0+D)}let Ae={[Fl]:i.REPEAT,[Ro]:i.CLAMP_TO_EDGE,[Fh]:i.MIRRORED_REPEAT},Ce={[Pi]:i.NEAREST,[D_]:i.NEAREST_MIPMAP_NEAREST,[vc]:i.NEAREST_MIPMAP_LINEAR,[er]:i.LINEAR,[Dh]:i.LINEAR_MIPMAP_NEAREST,[js]:i.LINEAR_MIPMAP_LINEAR},Ie={[f7]:i.NEVER,[w7]:i.ALWAYS,[p7]:i.LESS,[l3]:i.LEQUAL,[m7]:i.EQUAL,[x7]:i.GEQUAL,[g7]:i.GREATER,[v7]:i.NOTEQUAL};function He(N,D){if(D.type===ys&&e.has("OES_texture_float_linear")===!1&&(D.magFilter===er||D.magFilter===Dh||D.magFilter===vc||D.magFilter===js||D.minFilter===er||D.minFilter===Dh||D.minFilter===vc||D.minFilter===js)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(N,i.TEXTURE_WRAP_S,Ae[D.wrapS]),i.texParameteri(N,i.TEXTURE_WRAP_T,Ae[D.wrapT]),(N===i.TEXTURE_3D||N===i.TEXTURE_2D_ARRAY)&&i.texParameteri(N,i.TEXTURE_WRAP_R,Ae[D.wrapR]),i.texParameteri(N,i.TEXTURE_MAG_FILTER,Ce[D.magFilter]),i.texParameteri(N,i.TEXTURE_MIN_FILTER,Ce[D.minFilter]),D.compareFunction&&(i.texParameteri(N,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(N,i.TEXTURE_COMPARE_FUNC,Ie[D.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(D.magFilter===Pi||D.minFilter!==vc&&D.minFilter!==js||D.type===ys&&e.has("OES_texture_float_linear")===!1)return;if(D.anisotropy>1||n.get(D).__currentAnisotropy){let J=e.get("EXT_texture_filter_anisotropic");i.texParameterf(N,J.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,r.getMaxAnisotropy())),n.get(D).__currentAnisotropy=D.anisotropy}}}function at(N,D){let J=!1;N.__webglInit===void 0&&(N.__webglInit=!0,D.addEventListener("dispose",T));let de=D.source,me=h.get(de);me===void 0&&(me={},h.set(de,me));let ce=z(D);if(ce!==N.__cacheKey){me[ce]===void 0&&(me[ce]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,J=!0),me[ce].usedTimes++;let Ke=me[N.__cacheKey];Ke!==void 0&&(me[N.__cacheKey].usedTimes--,Ke.usedTimes===0&&E(D)),N.__cacheKey=ce,N.__webglTexture=me[ce].texture}return J}function le(N,D,J){let de=i.TEXTURE_2D;(D.isDataArrayTexture||D.isCompressedArrayTexture)&&(de=i.TEXTURE_2D_ARRAY),D.isData3DTexture&&(de=i.TEXTURE_3D);let me=at(N,D),ce=D.source;t.bindTexture(de,N.__webglTexture,i.TEXTURE0+J);let Ke=n.get(ce);if(ce.version!==Ke.__version||me===!0){t.activeTexture(i.TEXTURE0+J);let Re=zt.getPrimaries(zt.workingColorSpace),Be=D.colorSpace===Fa?null:zt.getPrimaries(D.colorSpace),Ut=D.colorSpace===Fa||Re===Be?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,D.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,D.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);let ye=x(D.image,!1,r.maxTextureSize);ye=ut(D,ye);let ze=s.convert(D.format,D.colorSpace),ht=s.convert(D.type),vt=b(D.internalFormat,ze,ht,D.colorSpace,D.isVideoTexture);He(de,D);let je,Wt=D.mipmaps,Lt=D.isVideoTexture!==!0,pn=Ke.__version===void 0||me===!0,W=ce.dataReady,Le=M(D,ye);if(D.isDepthTexture)vt=A(D.format===Dc,D.type),pn&&(Lt?t.texStorage2D(i.TEXTURE_2D,1,vt,ye.width,ye.height):t.texImage2D(i.TEXTURE_2D,0,vt,ye.width,ye.height,0,ze,ht,null));else if(D.isDataTexture)if(Wt.length>0){Lt&&pn&&t.texStorage2D(i.TEXTURE_2D,Le,vt,Wt[0].width,Wt[0].height);for(let oe=0,fe=Wt.length;oe<fe;oe++)je=Wt[oe],Lt?W&&t.texSubImage2D(i.TEXTURE_2D,oe,0,0,je.width,je.height,ze,ht,je.data):t.texImage2D(i.TEXTURE_2D,oe,vt,je.width,je.height,0,ze,ht,je.data);D.generateMipmaps=!1}else Lt?(pn&&t.texStorage2D(i.TEXTURE_2D,Le,vt,ye.width,ye.height),W&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,ye.width,ye.height,ze,ht,ye.data)):t.texImage2D(i.TEXTURE_2D,0,vt,ye.width,ye.height,0,ze,ht,ye.data);else if(D.isCompressedTexture)if(D.isCompressedArrayTexture){Lt&&pn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Le,vt,Wt[0].width,Wt[0].height,ye.depth);for(let oe=0,fe=Wt.length;oe<fe;oe++)if(je=Wt[oe],D.format!==Vr)if(ze!==null)if(Lt){if(W)if(D.layerUpdates.size>0){let Fe=SL(je.width,je.height,D.format,D.type);for(let ke of D.layerUpdates){let Ct=je.data.subarray(ke*Fe/je.data.BYTES_PER_ELEMENT,(ke+1)*Fe/je.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,oe,0,0,ke,je.width,je.height,1,ze,Ct)}D.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,oe,0,0,0,je.width,je.height,ye.depth,ze,je.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,oe,vt,je.width,je.height,ye.depth,0,je.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Lt?W&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,oe,0,0,0,je.width,je.height,ye.depth,ze,ht,je.data):t.texImage3D(i.TEXTURE_2D_ARRAY,oe,vt,je.width,je.height,ye.depth,0,ze,ht,je.data)}else{Lt&&pn&&t.texStorage2D(i.TEXTURE_2D,Le,vt,Wt[0].width,Wt[0].height);for(let oe=0,fe=Wt.length;oe<fe;oe++)je=Wt[oe],D.format!==Vr?ze!==null?Lt?W&&t.compressedTexSubImage2D(i.TEXTURE_2D,oe,0,0,je.width,je.height,ze,je.data):t.compressedTexImage2D(i.TEXTURE_2D,oe,vt,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Lt?W&&t.texSubImage2D(i.TEXTURE_2D,oe,0,0,je.width,je.height,ze,ht,je.data):t.texImage2D(i.TEXTURE_2D,oe,vt,je.width,je.height,0,ze,ht,je.data)}else if(D.isDataArrayTexture)if(Lt){if(pn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Le,vt,ye.width,ye.height,ye.depth),W)if(D.layerUpdates.size>0){let oe=SL(ye.width,ye.height,D.format,D.type);for(let fe of D.layerUpdates){let Fe=ye.data.subarray(fe*oe/ye.data.BYTES_PER_ELEMENT,(fe+1)*oe/ye.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,fe,ye.width,ye.height,1,ze,ht,Fe)}D.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,ye.width,ye.height,ye.depth,ze,ht,ye.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,vt,ye.width,ye.height,ye.depth,0,ze,ht,ye.data);else if(D.isData3DTexture)Lt?(pn&&t.texStorage3D(i.TEXTURE_3D,Le,vt,ye.width,ye.height,ye.depth),W&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,ye.width,ye.height,ye.depth,ze,ht,ye.data)):t.texImage3D(i.TEXTURE_3D,0,vt,ye.width,ye.height,ye.depth,0,ze,ht,ye.data);else if(D.isFramebufferTexture){if(pn)if(Lt)t.texStorage2D(i.TEXTURE_2D,Le,vt,ye.width,ye.height);else{let oe=ye.width,fe=ye.height;for(let Fe=0;Fe<Le;Fe++)t.texImage2D(i.TEXTURE_2D,Fe,vt,oe,fe,0,ze,ht,null),oe>>=1,fe>>=1}}else if(Wt.length>0){if(Lt&&pn){let oe=Oe(Wt[0]);t.texStorage2D(i.TEXTURE_2D,Le,vt,oe.width,oe.height)}for(let oe=0,fe=Wt.length;oe<fe;oe++)je=Wt[oe],Lt?W&&t.texSubImage2D(i.TEXTURE_2D,oe,0,0,ze,ht,je):t.texImage2D(i.TEXTURE_2D,oe,vt,ze,ht,je);D.generateMipmaps=!1}else if(Lt){if(pn){let oe=Oe(ye);t.texStorage2D(i.TEXTURE_2D,Le,vt,oe.width,oe.height)}W&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,ze,ht,ye)}else t.texImage2D(i.TEXTURE_2D,0,vt,ze,ht,ye);v(D)&&g(de),Ke.__version=ce.version,D.onUpdate&&D.onUpdate(D)}N.__version=D.version}function be(N,D,J){if(D.image.length!==6)return;let de=at(N,D),me=D.source;t.bindTexture(i.TEXTURE_CUBE_MAP,N.__webglTexture,i.TEXTURE0+J);let ce=n.get(me);if(me.version!==ce.__version||de===!0){t.activeTexture(i.TEXTURE0+J);let Ke=zt.getPrimaries(zt.workingColorSpace),Re=D.colorSpace===Fa?null:zt.getPrimaries(D.colorSpace),Be=D.colorSpace===Fa||Ke===Re?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,D.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,D.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Be);let Ut=D.isCompressedTexture||D.image[0].isCompressedTexture,ye=D.image[0]&&D.image[0].isDataTexture,ze=[];for(let fe=0;fe<6;fe++)!Ut&&!ye?ze[fe]=x(D.image[fe],!0,r.maxCubemapSize):ze[fe]=ye?D.image[fe].image:D.image[fe],ze[fe]=ut(D,ze[fe]);let ht=ze[0],vt=s.convert(D.format,D.colorSpace),je=s.convert(D.type),Wt=b(D.internalFormat,vt,je,D.colorSpace),Lt=D.isVideoTexture!==!0,pn=ce.__version===void 0||de===!0,W=me.dataReady,Le=M(D,ht);He(i.TEXTURE_CUBE_MAP,D);let oe;if(Ut){Lt&&pn&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Le,Wt,ht.width,ht.height);for(let fe=0;fe<6;fe++){oe=ze[fe].mipmaps;for(let Fe=0;Fe<oe.length;Fe++){let ke=oe[Fe];D.format!==Vr?vt!==null?Lt?W&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe,0,0,ke.width,ke.height,vt,ke.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe,Wt,ke.width,ke.height,0,ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Lt?W&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe,0,0,ke.width,ke.height,vt,je,ke.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe,Wt,ke.width,ke.height,0,vt,je,ke.data)}}}else{if(oe=D.mipmaps,Lt&&pn){oe.length>0&&Le++;let fe=Oe(ze[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Le,Wt,fe.width,fe.height)}for(let fe=0;fe<6;fe++)if(ye){Lt?W&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,ze[fe].width,ze[fe].height,vt,je,ze[fe].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,Wt,ze[fe].width,ze[fe].height,0,vt,je,ze[fe].data);for(let Fe=0;Fe<oe.length;Fe++){let Ct=oe[Fe].image[fe].image;Lt?W&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe+1,0,0,Ct.width,Ct.height,vt,je,Ct.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe+1,Wt,Ct.width,Ct.height,0,vt,je,Ct.data)}}else{Lt?W&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,vt,je,ze[fe]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,Wt,vt,je,ze[fe]);for(let Fe=0;Fe<oe.length;Fe++){let ke=oe[Fe];Lt?W&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe+1,0,0,vt,je,ke.image[fe]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Fe+1,Wt,vt,je,ke.image[fe])}}}v(D)&&g(i.TEXTURE_CUBE_MAP),ce.__version=me.version,D.onUpdate&&D.onUpdate(D)}N.__version=D.version}function Pe(N,D,J,de,me,ce){let Ke=s.convert(J.format,J.colorSpace),Re=s.convert(J.type),Be=b(J.internalFormat,Ke,Re,J.colorSpace),Ut=n.get(D),ye=n.get(J);if(ye.__renderTarget=D,!Ut.__hasExternalTextures){let ze=Math.max(1,D.width>>ce),ht=Math.max(1,D.height>>ce);me===i.TEXTURE_3D||me===i.TEXTURE_2D_ARRAY?t.texImage3D(me,ce,Be,ze,ht,D.depth,0,Ke,Re,null):t.texImage2D(me,ce,Be,ze,ht,0,Ke,Re,null)}t.bindFramebuffer(i.FRAMEBUFFER,N),Ue(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,de,me,ye.__webglTexture,0,xe(D)):(me===i.TEXTURE_2D||me>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&me<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,de,me,ye.__webglTexture,ce),t.bindFramebuffer(i.FRAMEBUFFER,null)}function he(N,D,J){if(i.bindRenderbuffer(i.RENDERBUFFER,N),D.depthBuffer){let de=D.depthTexture,me=de&&de.isDepthTexture?de.type:null,ce=A(D.stencilBuffer,me),Ke=D.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Re=xe(D);Ue(D)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Re,ce,D.width,D.height):J?i.renderbufferStorageMultisample(i.RENDERBUFFER,Re,ce,D.width,D.height):i.renderbufferStorage(i.RENDERBUFFER,ce,D.width,D.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ke,i.RENDERBUFFER,N)}else{let de=D.textures;for(let me=0;me<de.length;me++){let ce=de[me],Ke=s.convert(ce.format,ce.colorSpace),Re=s.convert(ce.type),Be=b(ce.internalFormat,Ke,Re,ce.colorSpace),Ut=xe(D);J&&Ue(D)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Ut,Be,D.width,D.height):Ue(D)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Ut,Be,D.width,D.height):i.renderbufferStorage(i.RENDERBUFFER,Be,D.width,D.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Ge(N,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,N),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let de=n.get(D.depthTexture);de.__renderTarget=D,(!de.__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),X(D.depthTexture,0);let me=de.__webglTexture,ce=xe(D);if(D.depthTexture.format===yc)Ue(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0,ce):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0);else if(D.depthTexture.format===Dc)Ue(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0,ce):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0);else throw new Error("Unknown depthTexture format")}function ct(N){let D=n.get(N),J=N.isWebGLCubeRenderTarget===!0;if(D.__boundDepthTexture!==N.depthTexture){let de=N.depthTexture;if(D.__depthDisposeCallback&&D.__depthDisposeCallback(),de){let me=()=>{delete D.__boundDepthTexture,delete D.__depthDisposeCallback,de.removeEventListener("dispose",me)};de.addEventListener("dispose",me),D.__depthDisposeCallback=me}D.__boundDepthTexture=de}if(N.depthTexture&&!D.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");Ge(D.__webglFramebuffer,N)}else if(J){D.__webglDepthbuffer=[];for(let de=0;de<6;de++)if(t.bindFramebuffer(i.FRAMEBUFFER,D.__webglFramebuffer[de]),D.__webglDepthbuffer[de]===void 0)D.__webglDepthbuffer[de]=i.createRenderbuffer(),he(D.__webglDepthbuffer[de],N,!1);else{let me=N.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ce=D.__webglDepthbuffer[de];i.bindRenderbuffer(i.RENDERBUFFER,ce),i.framebufferRenderbuffer(i.FRAMEBUFFER,me,i.RENDERBUFFER,ce)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,D.__webglFramebuffer),D.__webglDepthbuffer===void 0)D.__webglDepthbuffer=i.createRenderbuffer(),he(D.__webglDepthbuffer,N,!1);else{let de=N.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,me=D.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,me),i.framebufferRenderbuffer(i.FRAMEBUFFER,de,i.RENDERBUFFER,me)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function dt(N,D,J){let de=n.get(N);D!==void 0&&Pe(de.__webglFramebuffer,N,N.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),J!==void 0&&ct(N)}function Xt(N){let D=N.texture,J=n.get(N),de=n.get(D);N.addEventListener("dispose",I);let me=N.textures,ce=N.isWebGLCubeRenderTarget===!0,Ke=me.length>1;if(Ke||(de.__webglTexture===void 0&&(de.__webglTexture=i.createTexture()),de.__version=D.version,o.memory.textures++),ce){J.__webglFramebuffer=[];for(let Re=0;Re<6;Re++)if(D.mipmaps&&D.mipmaps.length>0){J.__webglFramebuffer[Re]=[];for(let Be=0;Be<D.mipmaps.length;Be++)J.__webglFramebuffer[Re][Be]=i.createFramebuffer()}else J.__webglFramebuffer[Re]=i.createFramebuffer()}else{if(D.mipmaps&&D.mipmaps.length>0){J.__webglFramebuffer=[];for(let Re=0;Re<D.mipmaps.length;Re++)J.__webglFramebuffer[Re]=i.createFramebuffer()}else J.__webglFramebuffer=i.createFramebuffer();if(Ke)for(let Re=0,Be=me.length;Re<Be;Re++){let Ut=n.get(me[Re]);Ut.__webglTexture===void 0&&(Ut.__webglTexture=i.createTexture(),o.memory.textures++)}if(N.samples>0&&Ue(N)===!1){J.__webglMultisampledFramebuffer=i.createFramebuffer(),J.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,J.__webglMultisampledFramebuffer);for(let Re=0;Re<me.length;Re++){let Be=me[Re];J.__webglColorRenderbuffer[Re]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,J.__webglColorRenderbuffer[Re]);let Ut=s.convert(Be.format,Be.colorSpace),ye=s.convert(Be.type),ze=b(Be.internalFormat,Ut,ye,Be.colorSpace,N.isXRRenderTarget===!0),ht=xe(N);i.renderbufferStorageMultisample(i.RENDERBUFFER,ht,ze,N.width,N.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Re,i.RENDERBUFFER,J.__webglColorRenderbuffer[Re])}i.bindRenderbuffer(i.RENDERBUFFER,null),N.depthBuffer&&(J.__webglDepthRenderbuffer=i.createRenderbuffer(),he(J.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(ce){t.bindTexture(i.TEXTURE_CUBE_MAP,de.__webglTexture),He(i.TEXTURE_CUBE_MAP,D);for(let Re=0;Re<6;Re++)if(D.mipmaps&&D.mipmaps.length>0)for(let Be=0;Be<D.mipmaps.length;Be++)Pe(J.__webglFramebuffer[Re][Be],N,D,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Be);else Pe(J.__webglFramebuffer[Re],N,D,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0);v(D)&&g(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ke){for(let Re=0,Be=me.length;Re<Be;Re++){let Ut=me[Re],ye=n.get(Ut);t.bindTexture(i.TEXTURE_2D,ye.__webglTexture),He(i.TEXTURE_2D,Ut),Pe(J.__webglFramebuffer,N,Ut,i.COLOR_ATTACHMENT0+Re,i.TEXTURE_2D,0),v(Ut)&&g(i.TEXTURE_2D)}t.unbindTexture()}else{let Re=i.TEXTURE_2D;if((N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(Re=N.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Re,de.__webglTexture),He(Re,D),D.mipmaps&&D.mipmaps.length>0)for(let Be=0;Be<D.mipmaps.length;Be++)Pe(J.__webglFramebuffer[Be],N,D,i.COLOR_ATTACHMENT0,Re,Be);else Pe(J.__webglFramebuffer,N,D,i.COLOR_ATTACHMENT0,Re,0);v(D)&&g(Re),t.unbindTexture()}N.depthBuffer&&ct(N)}function pe(N){let D=N.textures;for(let J=0,de=D.length;J<de;J++){let me=D[J];if(v(me)){let ce=y(N),Ke=n.get(me).__webglTexture;t.bindTexture(ce,Ke),g(ce),t.unbindTexture()}}}let _e=[],O=[];function it(N){if(N.samples>0){if(Ue(N)===!1){let D=N.textures,J=N.width,de=N.height,me=i.COLOR_BUFFER_BIT,ce=N.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ke=n.get(N),Re=D.length>1;if(Re)for(let Be=0;Be<D.length;Be++)t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ke.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ke.__webglFramebuffer);for(let Be=0;Be<D.length;Be++){if(N.resolveDepthBuffer&&(N.depthBuffer&&(me|=i.DEPTH_BUFFER_BIT),N.stencilBuffer&&N.resolveStencilBuffer&&(me|=i.STENCIL_BUFFER_BIT)),Re){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ke.__webglColorRenderbuffer[Be]);let Ut=n.get(D[Be]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ut,0)}i.blitFramebuffer(0,0,J,de,0,0,J,de,me,i.NEAREST),l===!0&&(_e.length=0,O.length=0,_e.push(i.COLOR_ATTACHMENT0+Be),N.depthBuffer&&N.resolveDepthBuffer===!1&&(_e.push(ce),O.push(ce),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,O)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,_e))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Re)for(let Be=0;Be<D.length;Be++){t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.RENDERBUFFER,Ke.__webglColorRenderbuffer[Be]);let Ut=n.get(D[Be]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.TEXTURE_2D,Ut,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ke.__webglMultisampledFramebuffer)}else if(N.depthBuffer&&N.resolveDepthBuffer===!1&&l){let D=N.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[D])}}}function xe(N){return Math.min(r.maxSamples,N.samples)}function Ue(N){let D=n.get(N);return N.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&D.__useRenderToTexture!==!1}function Me(N){let D=o.render.frame;c.get(N)!==D&&(c.set(N,D),N.update())}function ut(N,D){let J=N.colorSpace,de=N.format,me=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||J!==Ri&&J!==Fa&&(zt.getTransfer(J)===ln?(de!==Vr||me!==No)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",J)),D}function Oe(N){return typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement?(d.width=N.naturalWidth||N.width,d.height=N.naturalHeight||N.height):typeof VideoFrame<"u"&&N instanceof VideoFrame?(d.width=N.displayWidth,d.height=N.displayHeight):(d.width=N.width,d.height=N.height),d}this.allocateTextureUnit=B,this.resetTextureUnits=j,this.setTexture2D=X,this.setTexture2DArray=Q,this.setTexture3D=K,this.setTextureCube=Y,this.rebindTextures=dt,this.setupRenderTarget=Xt,this.updateRenderTargetMipmap=pe,this.updateMultisampleRenderTarget=it,this.setupDepthRenderbuffer=ct,this.setupFrameBufferTexture=Pe,this.useMultisampledRTT=Ue}function Cq(i,e){function t(n,r=Fa){let s,o=zt.getTransfer(r);if(n===No)return i.UNSIGNED_BYTE;if(n===R_)return i.UNSIGNED_SHORT_4_4_4_4;if(n===L_)return i.UNSIGNED_SHORT_5_5_5_1;if(n===$L)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===KL)return i.BYTE;if(n===JL)return i.SHORT;if(n===Oh)return i.UNSIGNED_SHORT;if(n===P_)return i.INT;if(n===Ol)return i.UNSIGNED_INT;if(n===ys)return i.FLOAT;if(n===$h)return i.HALF_FLOAT;if(n===e3)return i.ALPHA;if(n===t3)return i.RGB;if(n===Vr)return i.RGBA;if(n===n3)return i.LUMINANCE;if(n===i3)return i.LUMINANCE_ALPHA;if(n===yc)return i.DEPTH_COMPONENT;if(n===Dc)return i.DEPTH_STENCIL;if(n===k_)return i.RED;if(n===N_)return i.RED_INTEGER;if(n===r3)return i.RG;if(n===F_)return i.RG_INTEGER;if(n===O_)return i.RGBA_INTEGER;if(n===Xg||n===Qg||n===Kg||n===Jg)if(o===ln)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===Xg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Qg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Kg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Jg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===Xg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Qg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Kg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Jg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===xA||n===wA||n===bA||n===yA)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===xA)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===wA)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===bA)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===yA)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===AA||n===_A||n===SA)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===AA||n===_A)return o===ln?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===SA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===EA||n===CA||n===MA||n===TA||n===IA||n===DA||n===PA||n===RA||n===LA||n===kA||n===NA||n===FA||n===OA||n===BA)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===EA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===CA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===MA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===TA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===IA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===DA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===PA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===RA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===LA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===kA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===NA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===FA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===OA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===BA)return o===ln?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===$g||n===VA||n===UA)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===$g)return o===ln?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===VA)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===UA)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===s3||n===HA||n===zA||n===jA)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===$g)return s.COMPRESSED_RED_RGTC1_EXT;if(n===HA)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===zA)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===jA)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Ic?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}var r_=class extends Un{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Gs=class extends yi{constructor(){super(),this.isGroup=!0,this.type="Group"}},Mq={type:"move"},Lh=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Gs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Gs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new V,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new V),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Gs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new V,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new V),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null,a=this._targetRay,l=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){o=!0;for(let x of e.hand.values()){let v=t.getJointPose(x,n),g=this._getHandJoint(d,x);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=v.radius),g.visible=v!==null}let c=d.joints["index-finger-tip"],u=d.joints["thumb-tip"],h=c.position.distanceTo(u.position),f=.02,p=.005;d.inputState.pinching&&h>f+p?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&h<=f-p&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Mq)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),d!==null&&(d.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new Gs;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},Tq=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Iq=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,s_=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let r=new Gr,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,n=new Zs({vertexShader:Tq,fragmentShader:Iq,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new jt(new a0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},o_=class extends Fo{constructor(e,t){super();let n=this,r=null,s=1,o=null,a="local-floor",l=1,d=null,c=null,u=null,h=null,f=null,p=null,x=new s_,v=t.getContextAttributes(),g=null,y=null,b=[],A=[],M=new we,T=null,I=new Un;I.viewport=new Jt;let L=new Un;L.viewport=new Jt;let E=[I,L],S=new r_,P=null,j=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let be=b[le];return be===void 0&&(be=new Lh,b[le]=be),be.getTargetRaySpace()},this.getControllerGrip=function(le){let be=b[le];return be===void 0&&(be=new Lh,b[le]=be),be.getGripSpace()},this.getHand=function(le){let be=b[le];return be===void 0&&(be=new Lh,b[le]=be),be.getHandSpace()};function B(le){let be=A.indexOf(le.inputSource);if(be===-1)return;let Pe=b[be];Pe!==void 0&&(Pe.update(le.inputSource,le.frame,d||o),Pe.dispatchEvent({type:le.type,data:le.inputSource}))}function z(){r.removeEventListener("select",B),r.removeEventListener("selectstart",B),r.removeEventListener("selectend",B),r.removeEventListener("squeeze",B),r.removeEventListener("squeezestart",B),r.removeEventListener("squeezeend",B),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",X);for(let le=0;le<b.length;le++){let be=A[le];be!==null&&(A[le]=null,b[le].disconnect(be))}P=null,j=null,x.reset(),e.setRenderTarget(g),f=null,h=null,u=null,r=null,y=null,at.stop(),n.isPresenting=!1,e.setPixelRatio(T),e.setSize(M.width,M.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){s=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){a=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||o},this.setReferenceSpace=function(le){d=le},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(le){return re(this,null,function*(){if(r=le,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",B),r.addEventListener("selectstart",B),r.addEventListener("selectend",B),r.addEventListener("squeeze",B),r.addEventListener("squeezestart",B),r.addEventListener("squeezeend",B),r.addEventListener("end",z),r.addEventListener("inputsourceschange",X),v.xrCompatible!==!0&&(yield t.makeXRCompatible()),T=e.getPixelRatio(),e.getSize(M),r.renderState.layers===void 0){let be={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,be),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new Oo(f.framebufferWidth,f.framebufferHeight,{format:Vr,type:No,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let be=null,Pe=null,he=null;v.depth&&(he=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,be=v.stencil?Dc:yc,Pe=v.stencil?Ic:Ol);let Ge={colorFormat:t.RGBA8,depthFormat:he,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(Ge),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),y=new Oo(h.textureWidth,h.textureHeight,{format:Vr,type:No,depthTexture:new d0(h.textureWidth,h.textureHeight,Pe,void 0,void 0,void 0,void 0,void 0,void 0,be),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1})}y.isXRRenderTarget=!0,this.setFoveation(l),d=null,o=yield r.requestReferenceSpace(a),at.setContext(r),at.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return x.getDepthTexture()};function X(le){for(let be=0;be<le.removed.length;be++){let Pe=le.removed[be],he=A.indexOf(Pe);he>=0&&(A[he]=null,b[he].disconnect(Pe))}for(let be=0;be<le.added.length;be++){let Pe=le.added[be],he=A.indexOf(Pe);if(he===-1){for(let ct=0;ct<b.length;ct++)if(ct>=A.length){A.push(Pe),he=ct;break}else if(A[ct]===null){A[ct]=Pe,he=ct;break}if(he===-1)break}let Ge=b[he];Ge&&Ge.connect(Pe)}}let Q=new V,K=new V;function Y(le,be,Pe){Q.setFromMatrixPosition(be.matrixWorld),K.setFromMatrixPosition(Pe.matrixWorld);let he=Q.distanceTo(K),Ge=be.projectionMatrix.elements,ct=Pe.projectionMatrix.elements,dt=Ge[14]/(Ge[10]-1),Xt=Ge[14]/(Ge[10]+1),pe=(Ge[9]+1)/Ge[5],_e=(Ge[9]-1)/Ge[5],O=(Ge[8]-1)/Ge[0],it=(ct[8]+1)/ct[0],xe=dt*O,Ue=dt*it,Me=he/(-O+it),ut=Me*-O;if(be.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(ut),le.translateZ(Me),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),Ge[10]===-1)le.projectionMatrix.copy(be.projectionMatrix),le.projectionMatrixInverse.copy(be.projectionMatrixInverse);else{let Oe=dt+Me,N=Xt+Me,D=xe-ut,J=Ue+(he-ut),de=pe*Xt/N*Oe,me=_e*Xt/N*Oe;le.projectionMatrix.makePerspective(D,J,de,me,Oe,N),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function Ae(le,be){be===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(be.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(r===null)return;let be=le.near,Pe=le.far;x.texture!==null&&(x.depthNear>0&&(be=x.depthNear),x.depthFar>0&&(Pe=x.depthFar)),S.near=L.near=I.near=be,S.far=L.far=I.far=Pe,(P!==S.near||j!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),P=S.near,j=S.far),I.layers.mask=le.layers.mask|2,L.layers.mask=le.layers.mask|4,S.layers.mask=I.layers.mask|L.layers.mask;let he=le.parent,Ge=S.cameras;Ae(S,he);for(let ct=0;ct<Ge.length;ct++)Ae(Ge[ct],he);Ge.length===2?Y(S,I,L):S.projectionMatrix.copy(I.projectionMatrix),Ce(le,S,he)};function Ce(le,be,Pe){Pe===null?le.matrix.copy(be.matrixWorld):(le.matrix.copy(Pe.matrixWorld),le.matrix.invert(),le.matrix.multiply(be.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(be.projectionMatrix),le.projectionMatrixInverse.copy(be.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=Lc*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return S},this.getFoveation=function(){if(!(h===null&&f===null))return l},this.setFoveation=function(le){l=le,h!==null&&(h.fixedFoveation=le),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=le)},this.hasDepthSensing=function(){return x.texture!==null},this.getDepthSensingMesh=function(){return x.getMesh(S)};let Ie=null;function He(le,be){if(c=be.getViewerPose(d||o),p=be,c!==null){let Pe=c.views;f!==null&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let he=!1;Pe.length!==S.cameras.length&&(S.cameras.length=0,he=!0);for(let ct=0;ct<Pe.length;ct++){let dt=Pe[ct],Xt=null;if(f!==null)Xt=f.getViewport(dt);else{let _e=u.getViewSubImage(h,dt);Xt=_e.viewport,ct===0&&(e.setRenderTargetTextures(y,_e.colorTexture,h.ignoreDepthValues?void 0:_e.depthStencilTexture),e.setRenderTarget(y))}let pe=E[ct];pe===void 0&&(pe=new Un,pe.layers.enable(ct),pe.viewport=new Jt,E[ct]=pe),pe.matrix.fromArray(dt.transform.matrix),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.projectionMatrix.fromArray(dt.projectionMatrix),pe.projectionMatrixInverse.copy(pe.projectionMatrix).invert(),pe.viewport.set(Xt.x,Xt.y,Xt.width,Xt.height),ct===0&&(S.matrix.copy(pe.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),he===!0&&S.cameras.push(pe)}let Ge=r.enabledFeatures;if(Ge&&Ge.includes("depth-sensing")){let ct=u.getDepthInformation(Pe[0]);ct&&ct.isValid&&ct.texture&&x.init(e,ct,r.renderState)}}for(let Pe=0;Pe<b.length;Pe++){let he=A[Pe],Ge=b[Pe];he!==null&&Ge!==void 0&&Ge.update(he,be,d||o)}Ie&&Ie(le,be),be.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:be}),p=null}let at=new h3;at.setAnimationLoop(He),this.setAnimationLoop=function(le){Ie=le},this.dispose=function(){}}},Pl=new Bl,Dq=new _t;function Pq(i,e){function t(v,g){v.matrixAutoUpdate===!0&&v.updateMatrix(),g.value.copy(v.matrix)}function n(v,g){g.color.getRGB(v.fogColor.value,u3(i)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function r(v,g,y,b,A){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(v,g):g.isMeshToonMaterial?(s(v,g),u(v,g)):g.isMeshPhongMaterial?(s(v,g),c(v,g)):g.isMeshStandardMaterial?(s(v,g),h(v,g),g.isMeshPhysicalMaterial&&f(v,g,A)):g.isMeshMatcapMaterial?(s(v,g),p(v,g)):g.isMeshDepthMaterial?s(v,g):g.isMeshDistanceMaterial?(s(v,g),x(v,g)):g.isMeshNormalMaterial?s(v,g):g.isLineBasicMaterial?(o(v,g),g.isLineDashedMaterial&&a(v,g)):g.isPointsMaterial?l(v,g,y,b):g.isSpriteMaterial?d(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map,t(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.bumpMap&&(v.bumpMap.value=g.bumpMap,t(g.bumpMap,v.bumpMapTransform),v.bumpScale.value=g.bumpScale,g.side===tr&&(v.bumpScale.value*=-1)),g.normalMap&&(v.normalMap.value=g.normalMap,t(g.normalMap,v.normalMapTransform),v.normalScale.value.copy(g.normalScale),g.side===tr&&v.normalScale.value.negate()),g.displacementMap&&(v.displacementMap.value=g.displacementMap,t(g.displacementMap,v.displacementMapTransform),v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,v.emissiveMapTransform)),g.specularMap&&(v.specularMap.value=g.specularMap,t(g.specularMap,v.specularMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let y=e.get(g),b=y.envMap,A=y.envMapRotation;b&&(v.envMap.value=b,Pl.copy(A),Pl.x*=-1,Pl.y*=-1,Pl.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(Pl.y*=-1,Pl.z*=-1),v.envMapRotation.value.setFromMatrix4(Dq.makeRotationFromEuler(Pl)),v.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap&&(v.lightMap.value=g.lightMap,v.lightMapIntensity.value=g.lightMapIntensity,t(g.lightMap,v.lightMapTransform)),g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,v.aoMapTransform))}function o(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,g.map&&(v.map.value=g.map,t(g.map,v.mapTransform))}function a(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function l(v,g,y,b){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*y,v.scale.value=b*.5,g.map&&(v.map.value=g.map,t(g.map,v.uvTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function d(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map,t(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function c(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function u(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function h(v,g){v.metalness.value=g.metalness,g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,v.metalnessMapTransform)),v.roughness.value=g.roughness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,v.roughnessMapTransform)),g.envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function f(v,g,y){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,v.sheenColorMapTransform)),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,v.sheenRoughnessMapTransform))),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,v.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(v.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===tr&&v.clearcoatNormalScale.value.negate())),g.dispersion>0&&(v.dispersion.value=g.dispersion),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,v.iridescenceMapTransform)),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=y.texture,v.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,v.transmissionMapTransform)),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(v.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(v.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,v.specularColorMapTransform)),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,v.specularIntensityMapTransform))}function p(v,g){g.matcap&&(v.matcap.value=g.matcap)}function x(v,g){let y=e.get(g).light;v.referencePosition.value.setFromMatrixPosition(y.matrixWorld),v.nearDistance.value=y.shadow.camera.near,v.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Rq(i,e,t,n){let r={},s={},o=[],a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(y,b){let A=b.program;n.uniformBlockBinding(y,A)}function d(y,b){let A=r[y.id];A===void 0&&(p(y),A=c(y),r[y.id]=A,y.addEventListener("dispose",v));let M=b.program;n.updateUBOMapping(y,M);let T=e.render.frame;s[y.id]!==T&&(h(y),s[y.id]=T)}function c(y){let b=u();y.__bindingPointIndex=b;let A=i.createBuffer(),M=y.__size,T=y.usage;return i.bindBuffer(i.UNIFORM_BUFFER,A),i.bufferData(i.UNIFORM_BUFFER,M,T),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,b,A),A}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){let b=r[y.id],A=y.uniforms,M=y.__cache;i.bindBuffer(i.UNIFORM_BUFFER,b);for(let T=0,I=A.length;T<I;T++){let L=Array.isArray(A[T])?A[T]:[A[T]];for(let E=0,S=L.length;E<S;E++){let P=L[E];if(f(P,T,E,M)===!0){let j=P.__offset,B=Array.isArray(P.value)?P.value:[P.value],z=0;for(let X=0;X<B.length;X++){let Q=B[X],K=x(Q);typeof Q=="number"||typeof Q=="boolean"?(P.__data[0]=Q,i.bufferSubData(i.UNIFORM_BUFFER,j+z,P.__data)):Q.isMatrix3?(P.__data[0]=Q.elements[0],P.__data[1]=Q.elements[1],P.__data[2]=Q.elements[2],P.__data[3]=0,P.__data[4]=Q.elements[3],P.__data[5]=Q.elements[4],P.__data[6]=Q.elements[5],P.__data[7]=0,P.__data[8]=Q.elements[6],P.__data[9]=Q.elements[7],P.__data[10]=Q.elements[8],P.__data[11]=0):(Q.toArray(P.__data,z),z+=K.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,j,P.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function f(y,b,A,M){let T=y.value,I=b+"_"+A;if(M[I]===void 0)return typeof T=="number"||typeof T=="boolean"?M[I]=T:M[I]=T.clone(),!0;{let L=M[I];if(typeof T=="number"||typeof T=="boolean"){if(L!==T)return M[I]=T,!0}else if(L.equals(T)===!1)return L.copy(T),!0}return!1}function p(y){let b=y.uniforms,A=0,M=16;for(let I=0,L=b.length;I<L;I++){let E=Array.isArray(b[I])?b[I]:[b[I]];for(let S=0,P=E.length;S<P;S++){let j=E[S],B=Array.isArray(j.value)?j.value:[j.value];for(let z=0,X=B.length;z<X;z++){let Q=B[z],K=x(Q),Y=A%M,Ae=Y%K.boundary,Ce=Y+Ae;A+=Ae,Ce!==0&&M-Ce<K.storage&&(A+=M-Ce),j.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=A,A+=K.storage}}}let T=A%M;return T>0&&(A+=M-T),y.__size=A,y.__cache={},this}function x(y){let b={boundary:0,storage:0};return typeof y=="number"||typeof y=="boolean"?(b.boundary=4,b.storage=4):y.isVector2?(b.boundary=8,b.storage=8):y.isVector3||y.isColor?(b.boundary=16,b.storage=12):y.isVector4?(b.boundary=16,b.storage=16):y.isMatrix3?(b.boundary=48,b.storage=48):y.isMatrix4?(b.boundary=64,b.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),b}function v(y){let b=y.target;b.removeEventListener("dispose",v);let A=o.indexOf(b.__bindingPointIndex);o.splice(A,1),i.deleteBuffer(r[b.id]),delete r[b.id],delete s[b.id]}function g(){for(let y in r)i.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:d,dispose:g}}var Fc=class{constructor(e={}){let{canvas:t=F7(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:d=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reverseDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let f;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=o;let p=new Uint32Array(4),x=new Int32Array(4),v=null,g=null,y=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fi,this.toneMapping=Va,this.toneMappingExposure=1;let A=this,M=!1,T=0,I=0,L=null,E=-1,S=null,P=new Jt,j=new Jt,B=null,z=new mt(0),X=0,Q=t.width,K=t.height,Y=1,Ae=null,Ce=null,Ie=new Jt(0,0,Q,K),He=new Jt(0,0,Q,K),at=!1,le=new Uh,be=!1,Pe=!1,he=new _t,Ge=new _t,ct=new V,dt=new Jt,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},pe=!1;function _e(){return L===null?Y:1}let O=n;function it(R,q){return t.getContext(R,q)}try{let R={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:d,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${I_}`),t.addEventListener("webglcontextlost",fe,!1),t.addEventListener("webglcontextrestored",Fe,!1),t.addEventListener("webglcontextcreationerror",ke,!1),O===null){let q="webgl2";if(O=it(q,R),O===null)throw it(q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(R){throw console.error("THREE.WebGLRenderer: "+R.message),R}let xe,Ue,Me,ut,Oe,N,D,J,de,me,ce,Ke,Re,Be,Ut,ye,ze,ht,vt,je,Wt,Lt,pn,W;function Le(){xe=new YG(O),xe.init(),Lt=new Cq(O,xe),Ue=new zG(O,xe,e,Lt),Me=new _q(O,xe),Ue.reverseDepthBuffer&&h&&Me.buffers.depth.setReversed(!0),ut=new KG(O),Oe=new cq,N=new Eq(O,xe,Me,Oe,Ue,Lt,ut),D=new GG(A),J=new ZG(A),de=new r9(O),pn=new UG(O,de),me=new XG(O,de,ut,pn),ce=new $G(O,me,de,ut),vt=new JG(O,Ue,N),ye=new jG(Oe),Ke=new dq(A,D,J,xe,Ue,pn,ye),Re=new Pq(A,Oe),Be=new hq,Ut=new xq(xe),ht=new VG(A,D,J,Me,ce,f,l),ze=new yq(A,ce,Ue),W=new Rq(O,ut,Ue,Me),je=new HG(O,xe,ut),Wt=new QG(O,xe,ut),ut.programs=Ke.programs,A.capabilities=Ue,A.extensions=xe,A.properties=Oe,A.renderLists=Be,A.shadowMap=ze,A.state=Me,A.info=ut}Le();let oe=new o_(A,O);this.xr=oe,this.getContext=function(){return O},this.getContextAttributes=function(){return O.getContextAttributes()},this.forceContextLoss=function(){let R=xe.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){let R=xe.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(R){R!==void 0&&(Y=R,this.setSize(Q,K,!1))},this.getSize=function(R){return R.set(Q,K)},this.setSize=function(R,q,te=!0){if(oe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Q=R,K=q,t.width=Math.floor(R*Y),t.height=Math.floor(q*Y),te===!0&&(t.style.width=R+"px",t.style.height=q+"px"),this.setViewport(0,0,R,q)},this.getDrawingBufferSize=function(R){return R.set(Q*Y,K*Y).floor()},this.setDrawingBufferSize=function(R,q,te){Q=R,K=q,Y=te,t.width=Math.floor(R*te),t.height=Math.floor(q*te),this.setViewport(0,0,R,q)},this.getCurrentViewport=function(R){return R.copy(P)},this.getViewport=function(R){return R.copy(Ie)},this.setViewport=function(R,q,te,ne){R.isVector4?Ie.set(R.x,R.y,R.z,R.w):Ie.set(R,q,te,ne),Me.viewport(P.copy(Ie).multiplyScalar(Y).round())},this.getScissor=function(R){return R.copy(He)},this.setScissor=function(R,q,te,ne){R.isVector4?He.set(R.x,R.y,R.z,R.w):He.set(R,q,te,ne),Me.scissor(j.copy(He).multiplyScalar(Y).round())},this.getScissorTest=function(){return at},this.setScissorTest=function(R){Me.setScissorTest(at=R)},this.setOpaqueSort=function(R){Ae=R},this.setTransparentSort=function(R){Ce=R},this.getClearColor=function(R){return R.copy(ht.getClearColor())},this.setClearColor=function(){ht.setClearColor.apply(ht,arguments)},this.getClearAlpha=function(){return ht.getClearAlpha()},this.setClearAlpha=function(){ht.setClearAlpha.apply(ht,arguments)},this.clear=function(R=!0,q=!0,te=!0){let ne=0;if(R){let Z=!1;if(L!==null){let Se=L.texture.format;Z=Se===O_||Se===F_||Se===N_}if(Z){let Se=L.texture.type,Ne=Se===No||Se===Ol||Se===Oh||Se===Ic||Se===R_||Se===L_,et=ht.getClearColor(),tt=ht.getClearAlpha(),bt=et.r,Mt=et.g,nt=et.b;Ne?(p[0]=bt,p[1]=Mt,p[2]=nt,p[3]=tt,O.clearBufferuiv(O.COLOR,0,p)):(x[0]=bt,x[1]=Mt,x[2]=nt,x[3]=tt,O.clearBufferiv(O.COLOR,0,x))}else ne|=O.COLOR_BUFFER_BIT}q&&(ne|=O.DEPTH_BUFFER_BIT),te&&(ne|=O.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),O.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",fe,!1),t.removeEventListener("webglcontextrestored",Fe,!1),t.removeEventListener("webglcontextcreationerror",ke,!1),Be.dispose(),Ut.dispose(),Oe.dispose(),D.dispose(),J.dispose(),ce.dispose(),pn.dispose(),W.dispose(),Ke.dispose(),oe.dispose(),oe.removeEventListener("sessionstart",UC),oe.removeEventListener("sessionend",HC),$a.stop()};function fe(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;let R=ut.autoReset,q=ze.enabled,te=ze.autoUpdate,ne=ze.needsUpdate,Z=ze.type;Le(),ut.autoReset=R,ze.enabled=q,ze.autoUpdate=te,ze.needsUpdate=ne,ze.type=Z}function ke(R){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",R.statusMessage)}function Ct(R){let q=R.target;q.removeEventListener("dispose",Ct),Pn(q)}function Pn(R){_i(R),Oe.remove(R)}function _i(R){let q=Oe.get(R).programs;q!==void 0&&(q.forEach(function(te){Ke.releaseProgram(te)}),R.isShaderMaterial&&Ke.releaseShaderCache(R))}this.renderBufferDirect=function(R,q,te,ne,Z,Se){q===null&&(q=Xt);let Ne=Z.isMesh&&Z.matrixWorld.determinant()<0,et=Zk(R,q,te,ne,Z);Me.setMaterial(ne,Ne);let tt=te.index,bt=1;if(ne.wireframe===!0){if(tt=me.getWireframeAttribute(te),tt===void 0)return;bt=2}let Mt=te.drawRange,nt=te.attributes.position,Kt=Mt.start*bt,mn=(Mt.start+Mt.count)*bt;Se!==null&&(Kt=Math.max(Kt,Se.start*bt),mn=Math.min(mn,(Se.start+Se.count)*bt)),tt!==null?(Kt=Math.max(Kt,0),mn=Math.min(mn,tt.count)):nt!=null&&(Kt=Math.max(Kt,0),mn=Math.min(mn,nt.count));let xn=mn-Kt;if(xn<0||xn===1/0)return;pn.setup(Z,ne,et,te,tt);let qi,$t=je;if(tt!==null&&(qi=de.get(tt),$t=Wt,$t.setIndex(qi)),Z.isMesh)ne.wireframe===!0?(Me.setLineWidth(ne.wireframeLinewidth*_e()),$t.setMode(O.LINES)):$t.setMode(O.TRIANGLES);else if(Z.isLine){let st=ne.linewidth;st===void 0&&(st=1),Me.setLineWidth(st*_e()),Z.isLineSegments?$t.setMode(O.LINES):Z.isLineLoop?$t.setMode(O.LINE_LOOP):$t.setMode(O.LINE_STRIP)}else Z.isPoints?$t.setMode(O.POINTS):Z.isSprite&&$t.setMode(O.TRIANGLES);if(Z.isBatchedMesh)if(Z._multiDrawInstances!==null)$t.renderMultiDrawInstances(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount,Z._multiDrawInstances);else if(xe.get("WEBGL_multi_draw"))$t.renderMultiDraw(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount);else{let st=Z._multiDrawStarts,eo=Z._multiDrawCounts,en=Z._multiDrawCount,$r=tt?de.get(tt).bytesPerElement:1,td=Oe.get(ne).currentProgram.getUniforms();for(let lr=0;lr<en;lr++)td.setValue(O,"_gl_DrawID",lr),$t.render(st[lr]/$r,eo[lr])}else if(Z.isInstancedMesh)$t.renderInstances(Kt,xn,Z.count);else if(te.isInstancedBufferGeometry){let st=te._maxInstanceCount!==void 0?te._maxInstanceCount:1/0,eo=Math.min(te.instanceCount,st);$t.renderInstances(Kt,xn,eo)}else $t.render(Kt,xn)};function nn(R,q,te){R.transparent===!0&&R.side===ws&&R.forceSinglePass===!1?(R.side=tr,R.needsUpdate=!0,Pf(R,q,te),R.side=Ws,R.needsUpdate=!0,Pf(R,q,te),R.side=ws):Pf(R,q,te)}this.compile=function(R,q,te=null){te===null&&(te=R),g=Ut.get(te),g.init(q),b.push(g),te.traverseVisible(function(Z){Z.isLight&&Z.layers.test(q.layers)&&(g.pushLight(Z),Z.castShadow&&g.pushShadow(Z))}),R!==te&&R.traverseVisible(function(Z){Z.isLight&&Z.layers.test(q.layers)&&(g.pushLight(Z),Z.castShadow&&g.pushShadow(Z))}),g.setupLights();let ne=new Set;return R.traverse(function(Z){if(!(Z.isMesh||Z.isPoints||Z.isLine||Z.isSprite))return;let Se=Z.material;if(Se)if(Array.isArray(Se))for(let Ne=0;Ne<Se.length;Ne++){let et=Se[Ne];nn(et,te,Z),ne.add(et)}else nn(Se,te,Z),ne.add(Se)}),b.pop(),g=null,ne},this.compileAsync=function(R,q,te=null){let ne=this.compile(R,q,te);return new Promise(Z=>{function Se(){if(ne.forEach(function(Ne){Oe.get(Ne).currentProgram.isReady()&&ne.delete(Ne)}),ne.size===0){Z(R);return}setTimeout(Se,10)}xe.get("KHR_parallel_shader_compile")!==null?Se():setTimeout(Se,10)})};let Jr=null;function $s(R){Jr&&Jr(R)}function UC(){$a.stop()}function HC(){$a.start()}let $a=new h3;$a.setAnimationLoop($s),typeof self<"u"&&$a.setContext(self),this.setAnimationLoop=function(R){Jr=R,oe.setAnimationLoop(R),R===null?$a.stop():$a.start()},oe.addEventListener("sessionstart",UC),oe.addEventListener("sessionend",HC),this.render=function(R,q){if(q!==void 0&&q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;if(R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),q.parent===null&&q.matrixWorldAutoUpdate===!0&&q.updateMatrixWorld(),oe.enabled===!0&&oe.isPresenting===!0&&(oe.cameraAutoUpdate===!0&&oe.updateCamera(q),q=oe.getCamera()),R.isScene===!0&&R.onBeforeRender(A,R,q,L),g=Ut.get(R,b.length),g.init(q),b.push(g),Ge.multiplyMatrices(q.projectionMatrix,q.matrixWorldInverse),le.setFromProjectionMatrix(Ge),Pe=this.localClippingEnabled,be=ye.init(this.clippingPlanes,Pe),v=Be.get(R,y.length),v.init(),y.push(v),oe.enabled===!0&&oe.isPresenting===!0){let Se=A.xr.getDepthSensingMesh();Se!==null&&wx(Se,q,-1/0,A.sortObjects)}wx(R,q,0,A.sortObjects),v.finish(),A.sortObjects===!0&&v.sort(Ae,Ce),pe=oe.enabled===!1||oe.isPresenting===!1||oe.hasDepthSensing()===!1,pe&&ht.addToRenderList(v,R),this.info.render.frame++,be===!0&&ye.beginShadows();let te=g.state.shadowsArray;ze.render(te,R,q),be===!0&&ye.endShadows(),this.info.autoReset===!0&&this.info.reset();let ne=v.opaque,Z=v.transmissive;if(g.setupLights(),q.isArrayCamera){let Se=q.cameras;if(Z.length>0)for(let Ne=0,et=Se.length;Ne<et;Ne++){let tt=Se[Ne];jC(ne,Z,R,tt)}pe&&ht.render(R);for(let Ne=0,et=Se.length;Ne<et;Ne++){let tt=Se[Ne];zC(v,R,tt,tt.viewport)}}else Z.length>0&&jC(ne,Z,R,q),pe&&ht.render(R),zC(v,R,q);L!==null&&(N.updateMultisampleRenderTarget(L),N.updateRenderTargetMipmap(L)),R.isScene===!0&&R.onAfterRender(A,R,q),pn.resetDefaultState(),E=-1,S=null,b.pop(),b.length>0?(g=b[b.length-1],be===!0&&ye.setGlobalState(A.clippingPlanes,g.state.camera)):g=null,y.pop(),y.length>0?v=y[y.length-1]:v=null};function wx(R,q,te,ne){if(R.visible===!1)return;if(R.layers.test(q.layers)){if(R.isGroup)te=R.renderOrder;else if(R.isLOD)R.autoUpdate===!0&&R.update(q);else if(R.isLight)g.pushLight(R),R.castShadow&&g.pushShadow(R);else if(R.isSprite){if(!R.frustumCulled||le.intersectsSprite(R)){ne&&dt.setFromMatrixPosition(R.matrixWorld).applyMatrix4(Ge);let Ne=ce.update(R),et=R.material;et.visible&&v.push(R,Ne,et,te,dt.z,null)}}else if((R.isMesh||R.isLine||R.isPoints)&&(!R.frustumCulled||le.intersectsObject(R))){let Ne=ce.update(R),et=R.material;if(ne&&(R.boundingSphere!==void 0?(R.boundingSphere===null&&R.computeBoundingSphere(),dt.copy(R.boundingSphere.center)):(Ne.boundingSphere===null&&Ne.computeBoundingSphere(),dt.copy(Ne.boundingSphere.center)),dt.applyMatrix4(R.matrixWorld).applyMatrix4(Ge)),Array.isArray(et)){let tt=Ne.groups;for(let bt=0,Mt=tt.length;bt<Mt;bt++){let nt=tt[bt],Kt=et[nt.materialIndex];Kt&&Kt.visible&&v.push(R,Ne,Kt,te,dt.z,nt)}}else et.visible&&v.push(R,Ne,et,te,dt.z,null)}}let Se=R.children;for(let Ne=0,et=Se.length;Ne<et;Ne++)wx(Se[Ne],q,te,ne)}function zC(R,q,te,ne){let Z=R.opaque,Se=R.transmissive,Ne=R.transparent;g.setupLightsView(te),be===!0&&ye.setGlobalState(A.clippingPlanes,te),ne&&Me.viewport(P.copy(ne)),Z.length>0&&Df(Z,q,te),Se.length>0&&Df(Se,q,te),Ne.length>0&&Df(Ne,q,te),Me.buffers.depth.setTest(!0),Me.buffers.depth.setMask(!0),Me.buffers.color.setMask(!0),Me.setPolygonOffset(!1)}function jC(R,q,te,ne){if((te.isScene===!0?te.overrideMaterial:null)!==null)return;g.state.transmissionRenderTarget[ne.id]===void 0&&(g.state.transmissionRenderTarget[ne.id]=new Oo(1,1,{generateMipmaps:!0,type:xe.has("EXT_color_buffer_half_float")||xe.has("EXT_color_buffer_float")?$h:No,minFilter:js,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:zt.workingColorSpace}));let Se=g.state.transmissionRenderTarget[ne.id],Ne=ne.viewport||P;Se.setSize(Ne.z,Ne.w);let et=A.getRenderTarget();A.setRenderTarget(Se),A.getClearColor(z),X=A.getClearAlpha(),X<1&&A.setClearColor(16777215,.5),A.clear(),pe&&ht.render(te);let tt=A.toneMapping;A.toneMapping=Va;let bt=ne.viewport;if(ne.viewport!==void 0&&(ne.viewport=void 0),g.setupLightsView(ne),be===!0&&ye.setGlobalState(A.clippingPlanes,ne),Df(R,te,ne),N.updateMultisampleRenderTarget(Se),N.updateRenderTargetMipmap(Se),xe.has("WEBGL_multisampled_render_to_texture")===!1){let Mt=!1;for(let nt=0,Kt=q.length;nt<Kt;nt++){let mn=q[nt],xn=mn.object,qi=mn.geometry,$t=mn.material,st=mn.group;if($t.side===ws&&xn.layers.test(ne.layers)){let eo=$t.side;$t.side=tr,$t.needsUpdate=!0,GC(xn,te,ne,qi,$t,st),$t.side=eo,$t.needsUpdate=!0,Mt=!0}}Mt===!0&&(N.updateMultisampleRenderTarget(Se),N.updateRenderTargetMipmap(Se))}A.setRenderTarget(et),A.setClearColor(z,X),bt!==void 0&&(ne.viewport=bt),A.toneMapping=tt}function Df(R,q,te){let ne=q.isScene===!0?q.overrideMaterial:null;for(let Z=0,Se=R.length;Z<Se;Z++){let Ne=R[Z],et=Ne.object,tt=Ne.geometry,bt=ne===null?Ne.material:ne,Mt=Ne.group;et.layers.test(te.layers)&&GC(et,q,te,tt,bt,Mt)}}function GC(R,q,te,ne,Z,Se){R.onBeforeRender(A,q,te,ne,Z,Se),R.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),Z.onBeforeRender(A,q,te,ne,R,Se),Z.transparent===!0&&Z.side===ws&&Z.forceSinglePass===!1?(Z.side=tr,Z.needsUpdate=!0,A.renderBufferDirect(te,q,ne,Z,R,Se),Z.side=Ws,Z.needsUpdate=!0,A.renderBufferDirect(te,q,ne,Z,R,Se),Z.side=ws):A.renderBufferDirect(te,q,ne,Z,R,Se),R.onAfterRender(A,q,te,ne,Z,Se)}function Pf(R,q,te){q.isScene!==!0&&(q=Xt);let ne=Oe.get(R),Z=g.state.lights,Se=g.state.shadowsArray,Ne=Z.state.version,et=Ke.getParameters(R,Z.state,Se,q,te),tt=Ke.getProgramCacheKey(et),bt=ne.programs;ne.environment=R.isMeshStandardMaterial?q.environment:null,ne.fog=q.fog,ne.envMap=(R.isMeshStandardMaterial?J:D).get(R.envMap||ne.environment),ne.envMapRotation=ne.environment!==null&&R.envMap===null?q.environmentRotation:R.envMapRotation,bt===void 0&&(R.addEventListener("dispose",Ct),bt=new Map,ne.programs=bt);let Mt=bt.get(tt);if(Mt!==void 0){if(ne.currentProgram===Mt&&ne.lightsStateVersion===Ne)return qC(R,et),Mt}else et.uniforms=Ke.getUniforms(R),R.onBeforeCompile(et,A),Mt=Ke.acquireProgram(et,tt),bt.set(tt,Mt),ne.uniforms=et.uniforms;let nt=ne.uniforms;return(!R.isShaderMaterial&&!R.isRawShaderMaterial||R.clipping===!0)&&(nt.clippingPlanes=ye.uniform),qC(R,et),ne.needsLights=Xk(R),ne.lightsStateVersion=Ne,ne.needsLights&&(nt.ambientLightColor.value=Z.state.ambient,nt.lightProbe.value=Z.state.probe,nt.directionalLights.value=Z.state.directional,nt.directionalLightShadows.value=Z.state.directionalShadow,nt.spotLights.value=Z.state.spot,nt.spotLightShadows.value=Z.state.spotShadow,nt.rectAreaLights.value=Z.state.rectArea,nt.ltc_1.value=Z.state.rectAreaLTC1,nt.ltc_2.value=Z.state.rectAreaLTC2,nt.pointLights.value=Z.state.point,nt.pointLightShadows.value=Z.state.pointShadow,nt.hemisphereLights.value=Z.state.hemi,nt.directionalShadowMap.value=Z.state.directionalShadowMap,nt.directionalShadowMatrix.value=Z.state.directionalShadowMatrix,nt.spotShadowMap.value=Z.state.spotShadowMap,nt.spotLightMatrix.value=Z.state.spotLightMatrix,nt.spotLightMap.value=Z.state.spotLightMap,nt.pointShadowMap.value=Z.state.pointShadowMap,nt.pointShadowMatrix.value=Z.state.pointShadowMatrix),ne.currentProgram=Mt,ne.uniformsList=null,Mt}function WC(R){if(R.uniformsList===null){let q=R.currentProgram.getUniforms();R.uniformsList=_c.seqWithValue(q.seq,R.uniforms)}return R.uniformsList}function qC(R,q){let te=Oe.get(R);te.outputColorSpace=q.outputColorSpace,te.batching=q.batching,te.batchingColor=q.batchingColor,te.instancing=q.instancing,te.instancingColor=q.instancingColor,te.instancingMorph=q.instancingMorph,te.skinning=q.skinning,te.morphTargets=q.morphTargets,te.morphNormals=q.morphNormals,te.morphColors=q.morphColors,te.morphTargetsCount=q.morphTargetsCount,te.numClippingPlanes=q.numClippingPlanes,te.numIntersection=q.numClipIntersection,te.vertexAlphas=q.vertexAlphas,te.vertexTangents=q.vertexTangents,te.toneMapping=q.toneMapping}function Zk(R,q,te,ne,Z){q.isScene!==!0&&(q=Xt),N.resetTextureUnits();let Se=q.fog,Ne=ne.isMeshStandardMaterial?q.environment:null,et=L===null?A.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:Ri,tt=(ne.isMeshStandardMaterial?J:D).get(ne.envMap||Ne),bt=ne.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,Mt=!!te.attributes.tangent&&(!!ne.normalMap||ne.anisotropy>0),nt=!!te.morphAttributes.position,Kt=!!te.morphAttributes.normal,mn=!!te.morphAttributes.color,xn=Va;ne.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(xn=A.toneMapping);let qi=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,$t=qi!==void 0?qi.length:0,st=Oe.get(ne),eo=g.state.lights;if(be===!0&&(Pe===!0||R!==S)){let Sr=R===S&&ne.id===E;ye.setState(ne,R,Sr)}let en=!1;ne.version===st.__version?(st.needsLights&&st.lightsStateVersion!==eo.state.version||st.outputColorSpace!==et||Z.isBatchedMesh&&st.batching===!1||!Z.isBatchedMesh&&st.batching===!0||Z.isBatchedMesh&&st.batchingColor===!0&&Z.colorTexture===null||Z.isBatchedMesh&&st.batchingColor===!1&&Z.colorTexture!==null||Z.isInstancedMesh&&st.instancing===!1||!Z.isInstancedMesh&&st.instancing===!0||Z.isSkinnedMesh&&st.skinning===!1||!Z.isSkinnedMesh&&st.skinning===!0||Z.isInstancedMesh&&st.instancingColor===!0&&Z.instanceColor===null||Z.isInstancedMesh&&st.instancingColor===!1&&Z.instanceColor!==null||Z.isInstancedMesh&&st.instancingMorph===!0&&Z.morphTexture===null||Z.isInstancedMesh&&st.instancingMorph===!1&&Z.morphTexture!==null||st.envMap!==tt||ne.fog===!0&&st.fog!==Se||st.numClippingPlanes!==void 0&&(st.numClippingPlanes!==ye.numPlanes||st.numIntersection!==ye.numIntersection)||st.vertexAlphas!==bt||st.vertexTangents!==Mt||st.morphTargets!==nt||st.morphNormals!==Kt||st.morphColors!==mn||st.toneMapping!==xn||st.morphTargetsCount!==$t)&&(en=!0):(en=!0,st.__version=ne.version);let $r=st.currentProgram;en===!0&&($r=Pf(ne,q,Z));let td=!1,lr=!1,nu=!1,wn=$r.getUniforms(),Es=st.uniforms;if(Me.useProgram($r.program)&&(td=!0,lr=!0,nu=!0),ne.id!==E&&(E=ne.id,lr=!0),td||S!==R){Me.buffers.depth.getReversed()?(he.copy(R.projectionMatrix),B7(he),V7(he),wn.setValue(O,"projectionMatrix",he)):wn.setValue(O,"projectionMatrix",R.projectionMatrix),wn.setValue(O,"viewMatrix",R.matrixWorldInverse);let ea=wn.map.cameraPosition;ea!==void 0&&ea.setValue(O,ct.setFromMatrixPosition(R.matrixWorld)),Ue.logarithmicDepthBuffer&&wn.setValue(O,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&wn.setValue(O,"isOrthographic",R.isOrthographicCamera===!0),S!==R&&(S=R,lr=!0,nu=!0)}if(Z.isSkinnedMesh){wn.setOptional(O,Z,"bindMatrix"),wn.setOptional(O,Z,"bindMatrixInverse");let Sr=Z.skeleton;Sr&&(Sr.boneTexture===null&&Sr.computeBoneTexture(),wn.setValue(O,"boneTexture",Sr.boneTexture,N))}Z.isBatchedMesh&&(wn.setOptional(O,Z,"batchingTexture"),wn.setValue(O,"batchingTexture",Z._matricesTexture,N),wn.setOptional(O,Z,"batchingIdTexture"),wn.setValue(O,"batchingIdTexture",Z._indirectTexture,N),wn.setOptional(O,Z,"batchingColorTexture"),Z._colorsTexture!==null&&wn.setValue(O,"batchingColorTexture",Z._colorsTexture,N));let iu=te.morphAttributes;if((iu.position!==void 0||iu.normal!==void 0||iu.color!==void 0)&&vt.update(Z,te,$r),(lr||st.receiveShadow!==Z.receiveShadow)&&(st.receiveShadow=Z.receiveShadow,wn.setValue(O,"receiveShadow",Z.receiveShadow)),ne.isMeshGouraudMaterial&&ne.envMap!==null&&(Es.envMap.value=tt,Es.flipEnvMap.value=tt.isCubeTexture&&tt.isRenderTargetTexture===!1?-1:1),ne.isMeshStandardMaterial&&ne.envMap===null&&q.environment!==null&&(Es.envMapIntensity.value=q.environmentIntensity),lr&&(wn.setValue(O,"toneMappingExposure",A.toneMappingExposure),st.needsLights&&Yk(Es,nu),Se&&ne.fog===!0&&Re.refreshFogUniforms(Es,Se),Re.refreshMaterialUniforms(Es,ne,Y,K,g.state.transmissionRenderTarget[R.id]),_c.upload(O,WC(st),Es,N)),ne.isShaderMaterial&&ne.uniformsNeedUpdate===!0&&(_c.upload(O,WC(st),Es,N),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&wn.setValue(O,"center",Z.center),wn.setValue(O,"modelViewMatrix",Z.modelViewMatrix),wn.setValue(O,"normalMatrix",Z.normalMatrix),wn.setValue(O,"modelMatrix",Z.matrixWorld),ne.isShaderMaterial||ne.isRawShaderMaterial){let Sr=ne.uniformsGroups;for(let ea=0,ta=Sr.length;ea<ta;ea++){let ZC=Sr[ea];W.update(ZC,$r),W.bind(ZC,$r)}}return $r}function Yk(R,q){R.ambientLightColor.needsUpdate=q,R.lightProbe.needsUpdate=q,R.directionalLights.needsUpdate=q,R.directionalLightShadows.needsUpdate=q,R.pointLights.needsUpdate=q,R.pointLightShadows.needsUpdate=q,R.spotLights.needsUpdate=q,R.spotLightShadows.needsUpdate=q,R.rectAreaLights.needsUpdate=q,R.hemisphereLights.needsUpdate=q}function Xk(R){return R.isMeshLambertMaterial||R.isMeshToonMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isShadowMaterial||R.isShaderMaterial&&R.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(R,q,te){Oe.get(R.texture).__webglTexture=q,Oe.get(R.depthTexture).__webglTexture=te;let ne=Oe.get(R);ne.__hasExternalTextures=!0,ne.__autoAllocateDepthBuffer=te===void 0,ne.__autoAllocateDepthBuffer||xe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ne.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(R,q){let te=Oe.get(R);te.__webglFramebuffer=q,te.__useDefaultFramebuffer=q===void 0},this.setRenderTarget=function(R,q=0,te=0){L=R,T=q,I=te;let ne=!0,Z=null,Se=!1,Ne=!1;if(R){let tt=Oe.get(R);if(tt.__useDefaultFramebuffer!==void 0)Me.bindFramebuffer(O.FRAMEBUFFER,null),ne=!1;else if(tt.__webglFramebuffer===void 0)N.setupRenderTarget(R);else if(tt.__hasExternalTextures)N.rebindTextures(R,Oe.get(R.texture).__webglTexture,Oe.get(R.depthTexture).__webglTexture);else if(R.depthBuffer){let nt=R.depthTexture;if(tt.__boundDepthTexture!==nt){if(nt!==null&&Oe.has(nt)&&(R.width!==nt.image.width||R.height!==nt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");N.setupDepthRenderbuffer(R)}}let bt=R.texture;(bt.isData3DTexture||bt.isDataArrayTexture||bt.isCompressedArrayTexture)&&(Ne=!0);let Mt=Oe.get(R).__webglFramebuffer;R.isWebGLCubeRenderTarget?(Array.isArray(Mt[q])?Z=Mt[q][te]:Z=Mt[q],Se=!0):R.samples>0&&N.useMultisampledRTT(R)===!1?Z=Oe.get(R).__webglMultisampledFramebuffer:Array.isArray(Mt)?Z=Mt[te]:Z=Mt,P.copy(R.viewport),j.copy(R.scissor),B=R.scissorTest}else P.copy(Ie).multiplyScalar(Y).floor(),j.copy(He).multiplyScalar(Y).floor(),B=at;if(Me.bindFramebuffer(O.FRAMEBUFFER,Z)&&ne&&Me.drawBuffers(R,Z),Me.viewport(P),Me.scissor(j),Me.setScissorTest(B),Se){let tt=Oe.get(R.texture);O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_CUBE_MAP_POSITIVE_X+q,tt.__webglTexture,te)}else if(Ne){let tt=Oe.get(R.texture),bt=q||0;O.framebufferTextureLayer(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,tt.__webglTexture,te||0,bt)}E=-1},this.readRenderTargetPixels=function(R,q,te,ne,Z,Se,Ne){if(!(R&&R.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let et=Oe.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&Ne!==void 0&&(et=et[Ne]),et){Me.bindFramebuffer(O.FRAMEBUFFER,et);try{let tt=R.texture,bt=tt.format,Mt=tt.type;if(!Ue.textureFormatReadable(bt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ue.textureTypeReadable(Mt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}q>=0&&q<=R.width-ne&&te>=0&&te<=R.height-Z&&O.readPixels(q,te,ne,Z,Lt.convert(bt),Lt.convert(Mt),Se)}finally{let tt=L!==null?Oe.get(L).__webglFramebuffer:null;Me.bindFramebuffer(O.FRAMEBUFFER,tt)}}},this.readRenderTargetPixelsAsync=function(R,q,te,ne,Z,Se,Ne){return re(this,null,function*(){if(!(R&&R.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let et=Oe.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&Ne!==void 0&&(et=et[Ne]),et){let tt=R.texture,bt=tt.format,Mt=tt.type;if(!Ue.textureFormatReadable(bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ue.textureTypeReadable(Mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(q>=0&&q<=R.width-ne&&te>=0&&te<=R.height-Z){Me.bindFramebuffer(O.FRAMEBUFFER,et);let nt=O.createBuffer();O.bindBuffer(O.PIXEL_PACK_BUFFER,nt),O.bufferData(O.PIXEL_PACK_BUFFER,Se.byteLength,O.STREAM_READ),O.readPixels(q,te,ne,Z,Lt.convert(bt),Lt.convert(Mt),0);let Kt=L!==null?Oe.get(L).__webglFramebuffer:null;Me.bindFramebuffer(O.FRAMEBUFFER,Kt);let mn=O.fenceSync(O.SYNC_GPU_COMMANDS_COMPLETE,0);return O.flush(),yield O7(O,mn,4),O.bindBuffer(O.PIXEL_PACK_BUFFER,nt),O.getBufferSubData(O.PIXEL_PACK_BUFFER,0,Se),O.deleteBuffer(nt),O.deleteSync(mn),Se}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}})},this.copyFramebufferToTexture=function(R,q=null,te=0){R.isTexture!==!0&&(Th("WebGLRenderer: copyFramebufferToTexture function signature has changed."),q=arguments[0]||null,R=arguments[1]);let ne=Math.pow(2,-te),Z=Math.floor(R.image.width*ne),Se=Math.floor(R.image.height*ne),Ne=q!==null?q.x:0,et=q!==null?q.y:0;N.setTexture2D(R,0),O.copyTexSubImage2D(O.TEXTURE_2D,te,0,0,Ne,et,Z,Se),Me.unbindTexture()},this.copyTextureToTexture=function(R,q,te=null,ne=null,Z=0){R.isTexture!==!0&&(Th("WebGLRenderer: copyTextureToTexture function signature has changed."),ne=arguments[0]||null,R=arguments[1],q=arguments[2],Z=arguments[3]||0,te=null);let Se,Ne,et,tt,bt,Mt,nt,Kt,mn,xn=R.isCompressedTexture?R.mipmaps[Z]:R.image;te!==null?(Se=te.max.x-te.min.x,Ne=te.max.y-te.min.y,et=te.isBox3?te.max.z-te.min.z:1,tt=te.min.x,bt=te.min.y,Mt=te.isBox3?te.min.z:0):(Se=xn.width,Ne=xn.height,et=xn.depth||1,tt=0,bt=0,Mt=0),ne!==null?(nt=ne.x,Kt=ne.y,mn=ne.z):(nt=0,Kt=0,mn=0);let qi=Lt.convert(q.format),$t=Lt.convert(q.type),st;q.isData3DTexture?(N.setTexture3D(q,0),st=O.TEXTURE_3D):q.isDataArrayTexture||q.isCompressedArrayTexture?(N.setTexture2DArray(q,0),st=O.TEXTURE_2D_ARRAY):(N.setTexture2D(q,0),st=O.TEXTURE_2D),O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,q.flipY),O.pixelStorei(O.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),O.pixelStorei(O.UNPACK_ALIGNMENT,q.unpackAlignment);let eo=O.getParameter(O.UNPACK_ROW_LENGTH),en=O.getParameter(O.UNPACK_IMAGE_HEIGHT),$r=O.getParameter(O.UNPACK_SKIP_PIXELS),td=O.getParameter(O.UNPACK_SKIP_ROWS),lr=O.getParameter(O.UNPACK_SKIP_IMAGES);O.pixelStorei(O.UNPACK_ROW_LENGTH,xn.width),O.pixelStorei(O.UNPACK_IMAGE_HEIGHT,xn.height),O.pixelStorei(O.UNPACK_SKIP_PIXELS,tt),O.pixelStorei(O.UNPACK_SKIP_ROWS,bt),O.pixelStorei(O.UNPACK_SKIP_IMAGES,Mt);let nu=R.isDataArrayTexture||R.isData3DTexture,wn=q.isDataArrayTexture||q.isData3DTexture;if(R.isRenderTargetTexture||R.isDepthTexture){let Es=Oe.get(R),iu=Oe.get(q),Sr=Oe.get(Es.__renderTarget),ea=Oe.get(iu.__renderTarget);Me.bindFramebuffer(O.READ_FRAMEBUFFER,Sr.__webglFramebuffer),Me.bindFramebuffer(O.DRAW_FRAMEBUFFER,ea.__webglFramebuffer);for(let ta=0;ta<et;ta++)nu&&O.framebufferTextureLayer(O.READ_FRAMEBUFFER,O.COLOR_ATTACHMENT0,Oe.get(R).__webglTexture,Z,Mt+ta),R.isDepthTexture?(wn&&O.framebufferTextureLayer(O.DRAW_FRAMEBUFFER,O.COLOR_ATTACHMENT0,Oe.get(q).__webglTexture,Z,mn+ta),O.blitFramebuffer(tt,bt,Se,Ne,nt,Kt,Se,Ne,O.DEPTH_BUFFER_BIT,O.NEAREST)):wn?O.copyTexSubImage3D(st,Z,nt,Kt,mn+ta,tt,bt,Se,Ne):O.copyTexSubImage2D(st,Z,nt,Kt,mn+ta,tt,bt,Se,Ne);Me.bindFramebuffer(O.READ_FRAMEBUFFER,null),Me.bindFramebuffer(O.DRAW_FRAMEBUFFER,null)}else wn?R.isDataTexture||R.isData3DTexture?O.texSubImage3D(st,Z,nt,Kt,mn,Se,Ne,et,qi,$t,xn.data):q.isCompressedArrayTexture?O.compressedTexSubImage3D(st,Z,nt,Kt,mn,Se,Ne,et,qi,xn.data):O.texSubImage3D(st,Z,nt,Kt,mn,Se,Ne,et,qi,$t,xn):R.isDataTexture?O.texSubImage2D(O.TEXTURE_2D,Z,nt,Kt,Se,Ne,qi,$t,xn.data):R.isCompressedTexture?O.compressedTexSubImage2D(O.TEXTURE_2D,Z,nt,Kt,xn.width,xn.height,qi,xn.data):O.texSubImage2D(O.TEXTURE_2D,Z,nt,Kt,Se,Ne,qi,$t,xn);O.pixelStorei(O.UNPACK_ROW_LENGTH,eo),O.pixelStorei(O.UNPACK_IMAGE_HEIGHT,en),O.pixelStorei(O.UNPACK_SKIP_PIXELS,$r),O.pixelStorei(O.UNPACK_SKIP_ROWS,td),O.pixelStorei(O.UNPACK_SKIP_IMAGES,lr),Z===0&&q.generateMipmaps&&O.generateMipmap(st),Me.unbindTexture()},this.copyTextureToTexture3D=function(R,q,te=null,ne=null,Z=0){return R.isTexture!==!0&&(Th("WebGLRenderer: copyTextureToTexture3D function signature has changed."),te=arguments[0]||null,ne=arguments[1]||null,R=arguments[2],q=arguments[3],Z=arguments[4]||0),Th('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(R,q,te,ne,Z)},this.initRenderTarget=function(R){Oe.get(R).__webglFramebuffer===void 0&&N.setupRenderTarget(R)},this.initTexture=function(R){R.isCubeTexture?N.setTextureCube(R,0):R.isData3DTexture?N.setTexture3D(R,0):R.isDataArrayTexture||R.isCompressedArrayTexture?N.setTexture2DArray(R,0):N.setTexture2D(R,0),Me.unbindTexture()},this.resetState=function(){T=0,I=0,L=null,Me.reset(),pn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Lo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=zt._getDrawingBufferColorSpace(e),t.unpackColorSpace=zt._getUnpackColorSpace()}};var Oc=class extends yi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Bl,this.environmentIntensity=1,this.environmentRotation=new Bl,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},Hh=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=GA,this.updateRanges=[],this.version=0,this.uuid=Ur()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ur()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ur()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},ji=new V,zh=class i{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ji.fromBufferAttribute(this,t),ji.applyMatrix4(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ji.fromBufferAttribute(this,t),ji.applyNormalMatrix(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ji.fromBufferAttribute(this,t),ji.transformDirection(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=bs(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=sn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=sn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=bs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=bs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=bs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=bs(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array),r=sn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=sn(t,this.array),n=sn(n,this.array),r=sn(r,this.array),s=sn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new $n(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new i(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};var EL=new V,CL=new Jt,ML=new Jt,Lq=new V,TL=new _t,Vg=new V,$1=new vr,IL=new _t,eA=new Bo,c0=class extends jt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=MR,this.bindMatrix=new _t,this.bindMatrixInverse=new _t,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Hr),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Vg),this.boundingBox.expandByPoint(Vg)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new vr),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Vg),this.boundingSphere.expandByPoint(Vg)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),$1.copy(this.boundingSphere),$1.applyMatrix4(r),e.ray.intersectsSphere($1)!==!1&&(IL.copy(r).invert(),eA.copy(e.ray).applyMatrix4(IL),!(this.boundingBox!==null&&eA.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,eA)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Jt,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===MR?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===l7?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,r=this.geometry;CL.fromBufferAttribute(r.attributes.skinIndex,e),ML.fromBufferAttribute(r.attributes.skinWeight,e),EL.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){let o=ML.getComponent(s);if(o!==0){let a=CL.getComponent(s);TL.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Lq.copy(EL).applyMatrix4(TL),o)}}return t.applyMatrix4(this.bindMatrixInverse)}},jh=class extends yi{constructor(){super(),this.isBone=!0,this.type="Bone"}},u0=class extends Gr{constructor(e=null,t=1,n=1,r,s,o,a,l,d=Pi,c=Pi,u,h){super(null,o,a,l,d,c,r,s,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},DL=new _t,kq=new _t,h0=class i{constructor(e=[],t=[]){this.uuid=Ur(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new _t)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new _t;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){let a=e[s]?e[s].matrixWorld:kq;DL.multiplyMatrices(a,t[s]),DL.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new i(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new u0(t,e,e,Vr,ys);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let s=e.bones[n],o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new jh),this.bones.push(o),this.boneInverses.push(new _t().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){let o=t[r];e.bones.push(o.uuid);let a=n[r];e.boneInverses.push(a.toArray())}return e}},Vl=class extends $n{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},gc=new _t,PL=new _t,Ug=[],RL=new Hr,Nq=new _t,Sh=new jt,Eh=new vr,f0=class extends jt{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vl(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Nq)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Hr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,gc),RL.copy(e.boundingBox).applyMatrix4(gc),this.boundingBox.union(RL)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new vr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,gc),Eh.copy(e.boundingSphere).applyMatrix4(gc),this.boundingSphere.union(Eh)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let a=0;a<n.length;a++)n[a]=r[o+a]}raycast(e,t){let n=this.matrixWorld,r=this.count;if(Sh.geometry=this.geometry,Sh.material=this.material,Sh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Eh.copy(this.boundingSphere),Eh.applyMatrix4(n),e.ray.intersectsSphere(Eh)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,gc),PL.multiplyMatrices(n,gc),Sh.matrixWorld=PL,Sh.raycast(e,Ug);for(let o=0,a=Ug.length;o<a;o++){let l=Ug[o];l.instanceId=s,l.object=this,t.push(l)}Ug.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Vl(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new u0(new Float32Array(r*this.count),r,this.count,k_,ys));let s=this.morphTexture.source.data.data,o=0;for(let d=0;d<n.length;d++)o+=n[d];let a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};var Gh=class extends Tn{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new mt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},p0=new V,m0=new V,LL=new _t,Ch=new Bo,Hg=new vr,tA=new V,kL=new V,Bc=class extends yi{constructor(e=new xr,t=new Gh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)p0.fromBufferAttribute(t,r-1),m0.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=p0.distanceTo(m0);e.setAttribute("lineDistance",new nr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Hg.copy(n.boundingSphere),Hg.applyMatrix4(r),Hg.radius+=s,e.ray.intersectsSphere(Hg)===!1)return;LL.copy(r).invert(),Ch.copy(e.ray).applyMatrix4(LL);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,d=this.isLineSegments?2:1,c=n.index,h=n.attributes.position;if(c!==null){let f=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);for(let x=f,v=p-1;x<v;x+=d){let g=c.getX(x),y=c.getX(x+1),b=zg(this,e,Ch,l,g,y);b&&t.push(b)}if(this.isLineLoop){let x=c.getX(p-1),v=c.getX(f),g=zg(this,e,Ch,l,x,v);g&&t.push(g)}}else{let f=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let x=f,v=p-1;x<v;x+=d){let g=zg(this,e,Ch,l,x,x+1);g&&t.push(g)}if(this.isLineLoop){let x=zg(this,e,Ch,l,p-1,f);x&&t.push(x)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function zg(i,e,t,n,r,s){let o=i.geometry.attributes.position;if(p0.fromBufferAttribute(o,r),m0.fromBufferAttribute(o,s),t.distanceSqToSegment(p0,m0,tA,kL)>n)return;tA.applyMatrix4(i.matrixWorld);let l=e.ray.origin.distanceTo(tA);if(!(l<e.near||l>e.far))return{distance:l,point:kL.clone().applyMatrix4(i.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:i}}var NL=new V,FL=new V,g0=class extends Bc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)NL.fromBufferAttribute(t,r),FL.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+NL.distanceTo(FL);e.setAttribute("lineDistance",new nr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},v0=class extends Bc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},Wh=class extends Tn{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new mt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},OL=new _t,a_=new Bo,jg=new vr,Gg=new V,x0=class extends yi{constructor(e=new xr,t=new Wh){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),jg.copy(n.boundingSphere),jg.applyMatrix4(r),jg.radius+=s,e.ray.intersectsSphere(jg)===!1)return;OL.copy(r).invert(),a_.copy(e.ray).applyMatrix4(OL);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,d=n.index,u=n.attributes.position;if(d!==null){let h=Math.max(0,o.start),f=Math.min(d.count,o.start+o.count);for(let p=h,x=f;p<x;p++){let v=d.getX(p);Gg.fromBufferAttribute(u,v),BL(Gg,v,l,r,e,t,this)}}else{let h=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=h,x=f;p<x;p++)Gg.fromBufferAttribute(u,p),BL(Gg,p,l,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function BL(i,e,t,n,r,s,o){let a=a_.distanceSqToPoint(i);if(a<t){let l=new V;a_.closestPointToPoint(i,l),l.applyMatrix4(n);let d=r.ray.origin.distanceTo(l);if(d<r.near||d>r.far)return;s.push({distance:d,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}var zr=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,s=n.length,o;t?o=t:o=e*n[s-1];let a=0,l=s-1,d;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),d=n[r]-o,d<0)a=r+1;else if(d>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);let c=n[r],h=n[r+1]-c,f=(o-c)/h;return(r+f)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);let o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new we:new V);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new V,r=[],s=[],o=[],a=new V,l=new _t;for(let f=0;f<=e;f++){let p=f/e;r[f]=this.getTangentAt(p,new V)}s[0]=new V,o[0]=new V;let d=Number.MAX_VALUE,c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=d&&(d=c,n.set(1,0,0)),u<=d&&(d=u,n.set(0,1,0)),h<=d&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(Jn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(t===!0){let f=Math.acos(Jn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},qh=class extends zr{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new we){let n=t,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,l=this.aX+this.xRadius*Math.cos(a),d=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=l-this.aX,f=d-this.aY;l=h*c-f*u+this.aX,d=h*u+f*c+this.aY}return n.set(l,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},l_=class extends qh{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}};function U_(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,d){r(o,a,d*(a-s),d*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,d,c,u){let h=(o-s)/d-(a-s)/(d+c)+(a-o)/c,f=(a-o)/c-(l-o)/(c+u)+(l-a)/u;h*=c,f*=c,r(o,a,h,f)},calc:function(s){let o=s*s,a=o*s;return i+e*s+t*o+n*a}}}var Wg=new V,nA=new U_,iA=new U_,rA=new U_,d_=class extends zr{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new V){let n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let d,c;this.closed||a>0?d=r[(a-1)%s]:(Wg.subVectors(r[0],r[1]).add(r[0]),d=Wg);let u=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?c=r[(a+2)%s]:(Wg.subVectors(r[s-1],r[s-2]).add(r[s-1]),c=Wg),this.curveType==="centripetal"||this.curveType==="chordal"){let f=this.curveType==="chordal"?.5:.25,p=Math.pow(d.distanceToSquared(u),f),x=Math.pow(u.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(c),f);x<1e-4&&(x=1),p<1e-4&&(p=x),v<1e-4&&(v=x),nA.initNonuniformCatmullRom(d.x,u.x,h.x,c.x,p,x,v),iA.initNonuniformCatmullRom(d.y,u.y,h.y,c.y,p,x,v),rA.initNonuniformCatmullRom(d.z,u.z,h.z,c.z,p,x,v)}else this.curveType==="catmullrom"&&(nA.initCatmullRom(d.x,u.x,h.x,c.x,this.tension),iA.initCatmullRom(d.y,u.y,h.y,c.y,this.tension),rA.initCatmullRom(d.z,u.z,h.z,c.z,this.tension));return n.set(nA.calc(l),iA.calc(l),rA.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new V().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function VL(i,e,t,n,r){let s=(n-e)*.5,o=(r-t)*.5,a=i*i,l=i*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*i+t}function Fq(i,e){let t=1-i;return t*t*e}function Oq(i,e){return 2*(1-i)*i*e}function Bq(i,e){return i*i*e}function kh(i,e,t,n){return Fq(i,e)+Oq(i,t)+Bq(i,n)}function Vq(i,e){let t=1-i;return t*t*t*e}function Uq(i,e){let t=1-i;return 3*t*t*i*e}function Hq(i,e){return 3*(1-i)*i*i*e}function zq(i,e){return i*i*i*e}function Nh(i,e,t,n,r){return Vq(i,e)+Uq(i,t)+Hq(i,n)+zq(i,r)}var w0=class extends zr{constructor(e=new we,t=new we,n=new we,r=new we){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new we){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Nh(e,r.x,s.x,o.x,a.x),Nh(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},c_=class extends zr{constructor(e=new V,t=new V,n=new V,r=new V){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new V){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Nh(e,r.x,s.x,o.x,a.x),Nh(e,r.y,s.y,o.y,a.y),Nh(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},b0=class extends zr{constructor(e=new we,t=new we){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new we){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new we){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},u_=class extends zr{constructor(e=new V,t=new V){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new V){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new V){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},y0=class extends zr{constructor(e=new we,t=new we,n=new we){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new we){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(kh(e,r.x,s.x,o.x),kh(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},h_=class extends zr{constructor(e=new V,t=new V,n=new V){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new V){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(kh(e,r.x,s.x,o.x),kh(e,r.y,s.y,o.y),kh(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},A0=class extends zr{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new we){let n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],d=r[o],c=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(VL(a,l.x,d.x,c.x,u.x),VL(a,l.y,d.y,c.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new we().fromArray(r))}return this}},f_=Object.freeze({__proto__:null,ArcCurve:l_,CatmullRomCurve3:d_,CubicBezierCurve:w0,CubicBezierCurve3:c_,EllipseCurve:qh,LineCurve:b0,LineCurve3:u_,QuadraticBezierCurve:y0,QuadraticBezierCurve3:h_,SplineCurve:A0}),p_=class extends zr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new f_[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=n){let o=r[s]-n,a=this.curves[s],l=a.getLength(),d=l===0?0:1-o/l;return a.getPointAt(d,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,s=this.curves;r<s.length;r++){let o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let d=0;d<l.length;d++){let c=l[d];n&&n.equals(c)||(t.push(c),n=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(new f_[r.type]().fromJSON(r))}return this}},Zh=class extends p_{constructor(e){super(),this.type="Path",this.currentPoint=new we,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new b0(this.currentPoint.clone(),new we(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let s=new y0(this.currentPoint.clone(),new we(e,t),new we(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){let a=new w0(this.currentPoint.clone(),new we(e,t),new we(n,r),new we(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new A0(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){let a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){let d=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+d,t+c,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){let d=new qh(e,t,n,r,s,o,a,l);if(this.curves.length>0){let u=d.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(d);let c=d.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};var Sc=class extends Zh{constructor(e){super(e),this.uuid=Ur(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(new Zh().fromJSON(r))}return this}},jq={triangulate:function(i,e,t=2){let n=e&&e.length,r=n?e[0]*t:i.length,s=v3(i,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,d,c,u,h,f;if(n&&(s=Yq(i,e,s,t)),i.length>80*t){a=d=i[0],l=c=i[1];for(let p=t;p<r;p+=t)u=i[p],h=i[p+1],u<a&&(a=u),h<l&&(l=h),u>d&&(d=u),h>c&&(c=h);f=Math.max(d-a,c-l),f=f!==0?32767/f:0}return Yh(s,o,t,a,l,f,0),o}};function v3(i,e,t,n,r){let s,o;if(r===sZ(i,e,t,n)>0)for(s=e;s<t;s+=n)o=UL(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=UL(s,i[s],i[s+1],o);return o&&O0(o,o.next)&&(Qh(o),o=o.next),o}function Ul(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(O0(t,t.next)||Mn(t.prev,t,t.next)===0)){if(Qh(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Yh(i,e,t,n,r,s,o){if(!i)return;!o&&s&&$q(i,n,r,s);let a=i,l,d;for(;i.prev!==i.next;){if(l=i.prev,d=i.next,s?Wq(i,n,r,s):Gq(i)){e.push(l.i/t|0),e.push(i.i/t|0),e.push(d.i/t|0),Qh(i),i=d.next,a=d.next;continue}if(i=d,i===a){o?o===1?(i=qq(Ul(i),e,t),Yh(i,e,t,n,r,s,2)):o===2&&Zq(i,e,t,n,r,s):Yh(Ul(i),e,t,n,r,s,1);break}}}function Gq(i){let e=i.prev,t=i,n=i.next;if(Mn(e,t,n)>=0)return!1;let r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,d=n.y,c=r<s?r<o?r:o:s<o?s:o,u=a<l?a<d?a:d:l<d?l:d,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>d?a:d:l>d?l:d,p=n.next;for(;p!==e;){if(p.x>=c&&p.x<=h&&p.y>=u&&p.y<=f&&wc(r,a,s,l,o,d,p.x,p.y)&&Mn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Wq(i,e,t,n){let r=i.prev,s=i,o=i.next;if(Mn(r,s,o)>=0)return!1;let a=r.x,l=s.x,d=o.x,c=r.y,u=s.y,h=o.y,f=a<l?a<d?a:d:l<d?l:d,p=c<u?c<h?c:h:u<h?u:h,x=a>l?a>d?a:d:l>d?l:d,v=c>u?c>h?c:h:u>h?u:h,g=m_(f,p,e,t,n),y=m_(x,v,e,t,n),b=i.prevZ,A=i.nextZ;for(;b&&b.z>=g&&A&&A.z<=y;){if(b.x>=f&&b.x<=x&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&wc(a,c,l,u,d,h,b.x,b.y)&&Mn(b.prev,b,b.next)>=0||(b=b.prevZ,A.x>=f&&A.x<=x&&A.y>=p&&A.y<=v&&A!==r&&A!==o&&wc(a,c,l,u,d,h,A.x,A.y)&&Mn(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=x&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&wc(a,c,l,u,d,h,b.x,b.y)&&Mn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=y;){if(A.x>=f&&A.x<=x&&A.y>=p&&A.y<=v&&A!==r&&A!==o&&wc(a,c,l,u,d,h,A.x,A.y)&&Mn(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function qq(i,e,t){let n=i;do{let r=n.prev,s=n.next.next;!O0(r,s)&&x3(r,n,n.next,s)&&Xh(r,s)&&Xh(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Qh(n),Qh(n.next),n=i=s),n=n.next}while(n!==i);return Ul(n)}function Zq(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&nZ(o,a)){let l=w3(o,a);o=Ul(o,o.next),l=Ul(l,l.next),Yh(o,e,t,n,r,s,0),Yh(l,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function Yq(i,e,t,n){let r=[],s,o,a,l,d;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,d=v3(i,a,l,n,!1),d===d.next&&(d.steiner=!0),r.push(tZ(d));for(r.sort(Xq),s=0;s<r.length;s++)t=Qq(r[s],t);return t}function Xq(i,e){return i.x-e.x}function Qq(i,e){let t=Kq(i,e);if(!t)return e;let n=w3(t,i);return Ul(n,n.next),Ul(t,t.next)}function Kq(i,e){let t=e,n=-1/0,r,s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>n&&(n=h,r=t.x<t.next.x?t:t.next,h===s))return r}t=t.next}while(t!==e);if(!r)return null;let a=r,l=r.x,d=r.y,c=1/0,u;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&wc(o<d?s:n,o,l,d,o<d?n:s,o,t.x,t.y)&&(u=Math.abs(o-t.y)/(s-t.x),Xh(t,i)&&(u<c||u===c&&(t.x>r.x||t.x===r.x&&Jq(r,t)))&&(r=t,c=u)),t=t.next;while(t!==a);return r}function Jq(i,e){return Mn(i.prev,i,e.prev)<0&&Mn(e.next,i,i.next)<0}function $q(i,e,t,n){let r=i;do r.z===0&&(r.z=m_(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,eZ(r)}function eZ(i){let e,t,n,r,s,o,a,l,d=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<d&&(a++,n=n.nextZ,!!n);e++);for(l=d;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,d*=2}while(o>1);return i}function m_(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function tZ(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function wc(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function nZ(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!iZ(i,e)&&(Xh(i,e)&&Xh(e,i)&&rZ(i,e)&&(Mn(i.prev,i,e.prev)||Mn(i,e.prev,e))||O0(i,e)&&Mn(i.prev,i,i.next)>0&&Mn(e.prev,e,e.next)>0)}function Mn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function O0(i,e){return i.x===e.x&&i.y===e.y}function x3(i,e,t,n){let r=Zg(Mn(i,e,t)),s=Zg(Mn(i,e,n)),o=Zg(Mn(t,n,i)),a=Zg(Mn(t,n,e));return!!(r!==s&&o!==a||r===0&&qg(i,t,e)||s===0&&qg(i,n,e)||o===0&&qg(t,i,n)||a===0&&qg(t,e,n))}function qg(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Zg(i){return i>0?1:i<0?-1:0}function iZ(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&x3(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Xh(i,e){return Mn(i.prev,i,i.next)<0?Mn(i,e,i.next)>=0&&Mn(i,i.prev,e)>=0:Mn(i,e,i.prev)<0||Mn(i,i.next,e)<0}function rZ(i,e){let t=i,n=!1,r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function w3(i,e){let t=new g_(i.i,i.x,i.y),n=new g_(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function UL(i,e,t,n){let r=new g_(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Qh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function g_(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function sZ(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}var Ec=class i{static area(e){let t=e.length,n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return i.area(e)<0}static triangulateShape(e,t){let n=[],r=[],s=[];HL(e),zL(n,e);let o=e.length;t.forEach(HL);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,zL(n,t[l]);let a=jq.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}};function HL(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function zL(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var _0=class i extends xr{constructor(e=new Sc([new we(.5,.5),new we(-.5,.5),new we(-.5,-.5),new we(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){let d=e[a];o(d)}this.setAttribute("position",new nr(r,3)),this.setAttribute("uv",new nr(s,2)),this.computeVertexNormals();function o(a){let l=[],d=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,u=t.depth!==void 0?t.depth:1,h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,f=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:f-.1,x=t.bevelOffset!==void 0?t.bevelOffset:0,v=t.bevelSegments!==void 0?t.bevelSegments:3,g=t.extrudePath,y=t.UVGenerator!==void 0?t.UVGenerator:oZ,b,A=!1,M,T,I,L;g&&(b=g.getSpacedPoints(c),A=!0,h=!1,M=g.computeFrenetFrames(c,!1),T=new V,I=new V,L=new V),h||(v=0,f=0,p=0,x=0);let E=a.extractPoints(d),S=E.shape,P=E.holes;if(!Ec.isClockWise(S)){S=S.reverse();for(let pe=0,_e=P.length;pe<_e;pe++){let O=P[pe];Ec.isClockWise(O)&&(P[pe]=O.reverse())}}let B=Ec.triangulateShape(S,P),z=S;for(let pe=0,_e=P.length;pe<_e;pe++){let O=P[pe];S=S.concat(O)}function X(pe,_e,O){return _e||console.error("THREE.ExtrudeGeometry: vec does not exist"),pe.clone().addScaledVector(_e,O)}let Q=S.length,K=B.length;function Y(pe,_e,O){let it,xe,Ue,Me=pe.x-_e.x,ut=pe.y-_e.y,Oe=O.x-pe.x,N=O.y-pe.y,D=Me*Me+ut*ut,J=Me*N-ut*Oe;if(Math.abs(J)>Number.EPSILON){let de=Math.sqrt(D),me=Math.sqrt(Oe*Oe+N*N),ce=_e.x-ut/de,Ke=_e.y+Me/de,Re=O.x-N/me,Be=O.y+Oe/me,Ut=((Re-ce)*N-(Be-Ke)*Oe)/(Me*N-ut*Oe);it=ce+Me*Ut-pe.x,xe=Ke+ut*Ut-pe.y;let ye=it*it+xe*xe;if(ye<=2)return new we(it,xe);Ue=Math.sqrt(ye/2)}else{let de=!1;Me>Number.EPSILON?Oe>Number.EPSILON&&(de=!0):Me<-Number.EPSILON?Oe<-Number.EPSILON&&(de=!0):Math.sign(ut)===Math.sign(N)&&(de=!0),de?(it=-ut,xe=Me,Ue=Math.sqrt(D)):(it=Me,xe=ut,Ue=Math.sqrt(D/2))}return new we(it/Ue,xe/Ue)}let Ae=[];for(let pe=0,_e=z.length,O=_e-1,it=pe+1;pe<_e;pe++,O++,it++)O===_e&&(O=0),it===_e&&(it=0),Ae[pe]=Y(z[pe],z[O],z[it]);let Ce=[],Ie,He=Ae.concat();for(let pe=0,_e=P.length;pe<_e;pe++){let O=P[pe];Ie=[];for(let it=0,xe=O.length,Ue=xe-1,Me=it+1;it<xe;it++,Ue++,Me++)Ue===xe&&(Ue=0),Me===xe&&(Me=0),Ie[it]=Y(O[it],O[Ue],O[Me]);Ce.push(Ie),He=He.concat(Ie)}for(let pe=0;pe<v;pe++){let _e=pe/v,O=f*Math.cos(_e*Math.PI/2),it=p*Math.sin(_e*Math.PI/2)+x;for(let xe=0,Ue=z.length;xe<Ue;xe++){let Me=X(z[xe],Ae[xe],it);he(Me.x,Me.y,-O)}for(let xe=0,Ue=P.length;xe<Ue;xe++){let Me=P[xe];Ie=Ce[xe];for(let ut=0,Oe=Me.length;ut<Oe;ut++){let N=X(Me[ut],Ie[ut],it);he(N.x,N.y,-O)}}}let at=p+x;for(let pe=0;pe<Q;pe++){let _e=h?X(S[pe],He[pe],at):S[pe];A?(I.copy(M.normals[0]).multiplyScalar(_e.x),T.copy(M.binormals[0]).multiplyScalar(_e.y),L.copy(b[0]).add(I).add(T),he(L.x,L.y,L.z)):he(_e.x,_e.y,0)}for(let pe=1;pe<=c;pe++)for(let _e=0;_e<Q;_e++){let O=h?X(S[_e],He[_e],at):S[_e];A?(I.copy(M.normals[pe]).multiplyScalar(O.x),T.copy(M.binormals[pe]).multiplyScalar(O.y),L.copy(b[pe]).add(I).add(T),he(L.x,L.y,L.z)):he(O.x,O.y,u/c*pe)}for(let pe=v-1;pe>=0;pe--){let _e=pe/v,O=f*Math.cos(_e*Math.PI/2),it=p*Math.sin(_e*Math.PI/2)+x;for(let xe=0,Ue=z.length;xe<Ue;xe++){let Me=X(z[xe],Ae[xe],it);he(Me.x,Me.y,u+O)}for(let xe=0,Ue=P.length;xe<Ue;xe++){let Me=P[xe];Ie=Ce[xe];for(let ut=0,Oe=Me.length;ut<Oe;ut++){let N=X(Me[ut],Ie[ut],it);A?he(N.x,N.y+b[c-1].y,b[c-1].x+O):he(N.x,N.y,u+O)}}}le(),be();function le(){let pe=r.length/3;if(h){let _e=0,O=Q*_e;for(let it=0;it<K;it++){let xe=B[it];Ge(xe[2]+O,xe[1]+O,xe[0]+O)}_e=c+v*2,O=Q*_e;for(let it=0;it<K;it++){let xe=B[it];Ge(xe[0]+O,xe[1]+O,xe[2]+O)}}else{for(let _e=0;_e<K;_e++){let O=B[_e];Ge(O[2],O[1],O[0])}for(let _e=0;_e<K;_e++){let O=B[_e];Ge(O[0]+Q*c,O[1]+Q*c,O[2]+Q*c)}}n.addGroup(pe,r.length/3-pe,0)}function be(){let pe=r.length/3,_e=0;Pe(z,_e),_e+=z.length;for(let O=0,it=P.length;O<it;O++){let xe=P[O];Pe(xe,_e),_e+=xe.length}n.addGroup(pe,r.length/3-pe,1)}function Pe(pe,_e){let O=pe.length;for(;--O>=0;){let it=O,xe=O-1;xe<0&&(xe=pe.length-1);for(let Ue=0,Me=c+v*2;Ue<Me;Ue++){let ut=Q*Ue,Oe=Q*(Ue+1),N=_e+it+ut,D=_e+xe+ut,J=_e+xe+Oe,de=_e+it+Oe;ct(N,D,J,de)}}}function he(pe,_e,O){l.push(pe),l.push(_e),l.push(O)}function Ge(pe,_e,O){dt(pe),dt(_e),dt(O);let it=r.length/3,xe=y.generateTopUV(n,r,it-3,it-2,it-1);Xt(xe[0]),Xt(xe[1]),Xt(xe[2])}function ct(pe,_e,O,it){dt(pe),dt(_e),dt(it),dt(_e),dt(O),dt(it);let xe=r.length/3,Ue=y.generateSideWallUV(n,r,xe-6,xe-3,xe-2,xe-1);Xt(Ue[0]),Xt(Ue[1]),Xt(Ue[3]),Xt(Ue[1]),Xt(Ue[2]),Xt(Ue[3])}function dt(pe){r.push(l[pe*3+0]),r.push(l[pe*3+1]),r.push(l[pe*3+2])}function Xt(pe){s.push(pe.x),s.push(pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return aZ(t,n,e)}static fromJSON(e,t){let n=[];for(let s=0,o=e.shapes.length;s<o;s++){let a=t[e.shapes[s]];n.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new f_[r.type]().fromJSON(r)),new i(n,e.options)}},oZ={generateTopUV:function(i,e,t,n,r){let s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],d=e[r*3],c=e[r*3+1];return[new we(s,o),new we(a,l),new we(d,c)]},generateSideWallUV:function(i,e,t,n,r,s){let o=e[t*3],a=e[t*3+1],l=e[t*3+2],d=e[n*3],c=e[n*3+1],u=e[n*3+2],h=e[r*3],f=e[r*3+1],p=e[r*3+2],x=e[s*3],v=e[s*3+1],g=e[s*3+2];return Math.abs(a-c)<Math.abs(o-d)?[new we(o,1-l),new we(d,1-u),new we(h,1-p),new we(x,1-g)]:[new we(a,1-l),new we(c,1-u),new we(f,1-p),new we(v,1-g)]}};function aZ(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var Vc=class extends Tn{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new mt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=a3,this.normalScale=new we(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bl,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},wr=class extends Vc{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new we(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Jn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new mt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new mt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new mt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};function Yg(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function lZ(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function dZ(i){function e(r,s){return i[r]-i[s]}let t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function jL(i,e,t){let n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){let a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function b3(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}var Ua=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],s=t[n-1];n:{e:{let o;t:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break e}o=t.length;break t}if(!(e>=s)){let a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break e}o=n,n=0;break t}break n}for(;n<o;){let a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},v_=class extends Ua{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:IR,endingEnd:IR}}intervalChanged_(e,t,n){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case DR:s=e,a=2*t-n;break;case PR:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case DR:o=e,l=2*n-t;break;case PR:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}let d=(n-t)*.5,c=this.valueSize;this._weightPrev=d/(t-a),this._weightNext=d/(l-n),this._offsetPrev=s*c,this._offsetNext=o*c}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,d=l-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),x=p*p,v=x*p,g=-h*v+2*h*x-h*p,y=(1+h)*v+(-1.5-2*h)*x+(-.5+h)*p+1,b=(-1-f)*v+(1.5+f)*x+.5*p,A=f*v-f*x;for(let M=0;M!==a;++M)s[M]=g*o[c+M]+y*o[d+M]+b*o[l+M]+A*o[u+M];return s}},x_=class extends Ua{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,d=l-a,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==a;++h)s[h]=o[d+h]*u+o[l+h]*c;return s}},w_=class extends Ua{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},jr=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Yg(t,this.TimeBufferType),this.values=Yg(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Yg(e.times,Array),values:Yg(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new w_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new x_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new v_(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Pc:t=this.InterpolantFactoryMethodDiscrete;break;case Rc:t=this.InterpolantFactoryMethodLinear;break;case C1:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Pc;case this.InterpolantFactoryMethodLinear:return Rc;case this.InterpolantFactoryMethodSmooth:return C1}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&lZ(r))for(let a=0,l=r.length;a!==l;++a){let d=r[a];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,d),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===C1,s=e.length-1,o=1;for(let a=1;a<s;++a){let l=!1,d=e[a],c=e[a+1];if(d!==c&&(a!==1||d!==e[0]))if(r)l=!0;else{let u=a*n,h=u-n,f=u+n;for(let p=0;p!==n;++p){let x=t[u+p];if(x!==t[h+p]||x!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];let u=a*n,h=o*n;for(let f=0;f!==n;++f)t[h+f]=t[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,d=0;d!==n;++d)t[l+d]=t[a+d];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};jr.prototype.TimeBufferType=Float32Array;jr.prototype.ValueBufferType=Float32Array;jr.prototype.DefaultInterpolation=Rc;var Ha=class extends jr{constructor(e,t,n){super(e,t,n)}};Ha.prototype.ValueTypeName="bool";Ha.prototype.ValueBufferType=Array;Ha.prototype.DefaultInterpolation=Pc;Ha.prototype.InterpolantFactoryMethodLinear=void 0;Ha.prototype.InterpolantFactoryMethodSmooth=void 0;var S0=class extends jr{};S0.prototype.ValueTypeName="color";var Vo=class extends jr{};Vo.prototype.ValueTypeName="number";var b_=class extends Ua{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t),d=e*a;for(let c=d+a;d!==c;d+=4)ir.slerpFlat(s,0,o,d-a,o,d,l);return s}},Uo=class extends jr{InterpolantFactoryMethodLinear(e){return new b_(this.times,this.values,this.getValueSize(),e)}};Uo.prototype.ValueTypeName="quaternion";Uo.prototype.InterpolantFactoryMethodSmooth=void 0;var za=class extends jr{constructor(e,t,n){super(e,t,n)}};za.prototype.ValueTypeName="string";za.prototype.ValueBufferType=Array;za.prototype.DefaultInterpolation=Pc;za.prototype.InterpolantFactoryMethodLinear=void 0;za.prototype.InterpolantFactoryMethodSmooth=void 0;var Ho=class extends jr{};Ho.prototype.ValueTypeName="vector";var E0=class{constructor(e="",t=-1,n=[],r=d7){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Ur(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(uZ(n[o]).scale(r));let s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(jr.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){let s=t.length,o=[];for(let a=0;a<s;a++){let l=[],d=[];l.push((a+s-1)%s,a,(a+1)%s),d.push(0,1,0);let c=dZ(l);l=jL(l,1,c),d=jL(d,1,c),!r&&l[0]===0&&(l.push(s),d.push(d[0])),o.push(new Vo(".morphTargetInfluences["+t[a].name+"]",l,d).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.name.match(s);if(c&&c.length>1){let u=c[1],h=r[u];h||(r[u]=h=[]),h.push(d)}}let o=[];for(let a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(u,h,f,p,x){if(f.length!==0){let v=[],g=[];b3(f,v,g,p),v.length!==0&&x.push(new u(h,v,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode,l=e.length||-1,d=e.hierarchy||[];for(let u=0;u<d.length;u++){let h=d[u].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let f={},p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let x=0;x<h[p].morphTargets.length;x++)f[h[p].morphTargets[x]]=-1;for(let x in f){let v=[],g=[];for(let y=0;y!==h[p].morphTargets.length;++y){let b=h[p];v.push(b.time),g.push(b.morphTarget===x?1:0)}r.push(new Vo(".morphTargetInfluence["+x+"]",v,g))}l=f.length*o}else{let f=".bones["+t[u].name+"]";n(Ho,f+".position",h,"pos",r),n(Uo,f+".quaternion",h,"rot",r),n(Ho,f+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function cZ(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vo;case"vector":case"vector2":case"vector3":case"vector4":return Ho;case"color":return S0;case"quaternion":return Uo;case"bool":case"boolean":return Ha;case"string":return za}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function uZ(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=cZ(i.type);if(i.times===void 0){let t=[],n=[];b3(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var Oa={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},y_=class{constructor(e,t,n){let r=this,s=!1,o=0,a=0,l,d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(c){a++,s===!1&&r.onStart!==void 0&&r.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,r.onProgress!==void 0&&r.onProgress(c,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,u){return d.push(c,u),this},this.removeHandler=function(c){let u=d.indexOf(c);return u!==-1&&d.splice(u,2),this},this.getHandler=function(c){for(let u=0,h=d.length;u<h;u+=2){let f=d[u],p=d[u+1];if(f.global&&(f.lastIndex=0),f.test(c))return p}return null}}},hZ=new y_,Wa=(()=>{class i{constructor(t){this.manager=t!==void 0?t:hZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){let r=this;return new Promise(function(s,o){r.load(t,s,n,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return i.DEFAULT_MATERIAL_NAME="__DEFAULT",i})(),Do={},A_=class extends Error{constructor(e,t){super(e),this.response=t}},Hl=class extends Wa{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=Oa.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Do[e]!==void 0){Do[e].push({onLoad:t,onProgress:n,onError:r});return}Do[e]=[],Do[e].push({onLoad:t,onProgress:n,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;let c=Do[e],u=d.body.getReader(),h=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),f=h?parseInt(h):0,p=f!==0,x=0,v=new ReadableStream({start(g){y();function y(){u.read().then(({done:b,value:A})=>{if(b)g.close();else{x+=A.byteLength;let M=new ProgressEvent("progress",{lengthComputable:p,loaded:x,total:f});for(let T=0,I=c.length;T<I;T++){let L=c[T];L.onProgress&&L.onProgress(M)}g.enqueue(A),y()}},b=>{g.error(b)})}}});return new Response(v)}else throw new A_(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(l){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return d.json();default:if(a===void 0)return d.text();{let u=/charset="?([^;"\s]*)"?/i.exec(a),h=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(h);return d.arrayBuffer().then(p=>f.decode(p))}}}).then(d=>{Oa.add(e,d);let c=Do[e];delete Do[e];for(let u=0,h=c.length;u<h;u++){let f=c[u];f.onLoad&&f.onLoad(d)}}).catch(d=>{let c=Do[e];if(c===void 0)throw this.manager.itemError(e),d;delete Do[e];for(let u=0,h=c.length;u<h;u++){let f=c[u];f.onError&&f.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};var __=class extends Wa{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=Oa.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;let a=Bh("img");function l(){c(),Oa.add(e,this),t&&t(this),s.manager.itemEnd(e)}function d(u){c(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",d,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}};var C0=class extends Wa{constructor(e){super(e)}load(e,t,n,r){let s=new Gr,o=new __(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}},Uc=class extends yi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new mt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}};var sA=new _t,GL=new V,WL=new V,Kh=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new we(512,512),this.map=null,this.mapPass=null,this.matrix=new _t,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Uh,this._frameExtents=new we(1,1),this._viewportCount=1,this._viewports=[new Jt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;GL.setFromMatrixPosition(e.matrixWorld),t.position.copy(GL),WL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(WL),t.updateMatrixWorld(),sA.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sA),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(sA)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},S_=class extends Kh{constructor(){super(new Un(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=Lc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},M0=class extends Uc{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(yi.DEFAULT_UP),this.updateMatrix(),this.target=new yi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new S_}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},qL=new _t,Mh=new V,oA=new V,E_=class extends Kh{constructor(){super(new Un(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new we(4,2),this._viewportCount=6,this._viewports=[new Jt(2,1,1,1),new Jt(0,1,1,1),new Jt(3,1,1,1),new Jt(1,1,1,1),new Jt(3,0,1,1),new Jt(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Mh.setFromMatrixPosition(e.matrixWorld),n.position.copy(Mh),oA.copy(n.position),oA.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(oA),n.updateMatrixWorld(),r.makeTranslation(-Mh.x,-Mh.y,-Mh.z),qL.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qL)}},T0=class extends Uc{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new E_}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},C_=class extends Kh{constructor(){super(new Nc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Ys=class extends Uc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(yi.DEFAULT_UP),this.updateMatrix(),this.target=new yi,this.shadow=new C_}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},ja=class extends Uc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};var Ga=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var I0=class extends Wa{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=Oa.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(d=>{t&&t(d),s.manager.itemEnd(e)}).catch(d=>{r&&r(d)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;let l=fetch(e,a).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(d){return Oa.add(e,d),t&&t(d),s.manager.itemEnd(e),d}).catch(function(d){r&&r(d),Oa.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Oa.add(e,l),s.manager.itemStart(e)}};var H_="\\[\\]\\.:\\/",fZ=new RegExp("["+H_+"]","g"),z_="[^"+H_+"]",pZ="[^"+H_.replace("\\.","")+"]",mZ=/((?:WC+[\/:])*)/.source.replace("WC",z_),gZ=/(WCOD+)?/.source.replace("WCOD",pZ),vZ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",z_),xZ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",z_),wZ=new RegExp("^"+mZ+gZ+vZ+xZ+"$"),bZ=["material","materials","bones","map"],M_=class{constructor(e,t,n){let r=n||Cn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Cn=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(fZ,"")}static parseTrackName(t){let n=wZ.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);bZ.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){let r=function(o){for(let a=0;a<o.length;a++){let l=o[a];if(l.name===n||l.uuid===n)return l;let d=r(l.children);if(d)return d}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,s=n.propertyName,o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===c){c=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}let a=t[s];if(a===void 0){let c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+s+" but it wasn't found.",t);return}let l=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}d=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(d=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=M_,i})();Cn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Cn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Cn.prototype.GetterByBindingType=[Cn.prototype._getValue_direct,Cn.prototype._getValue_array,Cn.prototype._getValue_arrayElement,Cn.prototype._getValue_toArray];Cn.prototype.SetterByBindingTypeAndVersioning=[[Cn.prototype._setValue_direct,Cn.prototype._setValue_direct_setNeedsUpdate,Cn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Cn.prototype._setValue_array,Cn.prototype._setValue_array_setNeedsUpdate,Cn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Cn.prototype._setValue_arrayElement,Cn.prototype._setValue_arrayElement_setNeedsUpdate,Cn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Cn.prototype._setValue_fromArray,Cn.prototype._setValue_fromArray_setNeedsUpdate,Cn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Cfe=new Float32Array(1);var ZL=new _t,Hc=class{constructor(e,t,n=0,r=1/0){this.ray=new Bo(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Vh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ZL.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ZL),this}intersectObject(e,t=!0,n=[]){return T_(e,this,n,t),n.sort(YL),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)T_(e[r],this,n,t);return n.sort(YL),n}};function YL(i,e){return i.distance-e.distance}function T_(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){let s=i.children;for(let o=0,a=s.length;o<a;o++)T_(s[o],e,t,!0)}}var Jh=class{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Jn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var D0=class{constructor(){this.type="ShapePath",this.color=new mt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Zh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(g){let y=[];for(let b=0,A=g.length;b<A;b++){let M=g[b],T=new Sc;T.curves=M.curves,y.push(T)}return y}function n(g,y){let b=y.length,A=!1;for(let M=b-1,T=0;T<b;M=T++){let I=y[M],L=y[T],E=L.x-I.x,S=L.y-I.y;if(Math.abs(S)>Number.EPSILON){if(S<0&&(I=y[T],E=-E,L=y[M],S=-S),g.y<I.y||g.y>L.y)continue;if(g.y===I.y){if(g.x===I.x)return!0}else{let P=S*(g.x-I.x)-E*(g.y-I.y);if(P===0)return!0;if(P<0)continue;A=!A}}else{if(g.y!==I.y)continue;if(L.x<=g.x&&g.x<=I.x||I.x<=g.x&&g.x<=L.x)return!0}}return A}let r=Ec.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l,d=[];if(s.length===1)return a=s[0],l=new Sc,l.curves=a.curves,d.push(l),d;let c=!r(s[0].getPoints());c=e?!c:c;let u=[],h=[],f=[],p=0,x;h[p]=void 0,f[p]=[];for(let g=0,y=s.length;g<y;g++)a=s[g],x=a.getPoints(),o=r(x),o=e?!o:o,o?(!c&&h[p]&&p++,h[p]={s:new Sc,p:x},h[p].s.curves=a.curves,c&&p++,f[p]=[]):f[p].push({h:a,p:x[0]});if(!h[0])return t(s);if(h.length>1){let g=!1,y=0;for(let b=0,A=h.length;b<A;b++)u[b]=[];for(let b=0,A=h.length;b<A;b++){let M=f[b];for(let T=0;T<M.length;T++){let I=M[T],L=!0;for(let E=0;E<h.length;E++)n(I.p,h[E].p)&&(b!==E&&y++,L?(L=!1,u[E].push(I)):g=!0);L&&u[b].push(I)}}y>0&&g===!1&&(f=u)}let v;for(let g=0,y=h.length;g<y;g++){l=h[g].s,d.push(l),v=f[g];for(let b=0,A=v.length;b<A;b++)l.holes.push(v[b].h)}return d}},P0=class extends Fo{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:I_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=I_);function j_(i,e){if(e===o3)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===ef||e===L0){let t=i.getIndex();if(t===null){let o=[],a=i.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let n=t.count-2,r=[];if(e===ef)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var Wl=class extends Wa{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Q_(t)}),this.register(function(t){return new K_(t)}),this.register(function(t){return new oS(t)}),this.register(function(t){return new aS(t)}),this.register(function(t){return new lS(t)}),this.register(function(t){return new $_(t)}),this.register(function(t){return new eS(t)}),this.register(function(t){return new tS(t)}),this.register(function(t){return new nS(t)}),this.register(function(t){return new X_(t)}),this.register(function(t){return new iS(t)}),this.register(function(t){return new J_(t)}),this.register(function(t){return new sS(t)}),this.register(function(t){return new rS(t)}),this.register(function(t){return new Z_(t)}),this.register(function(t){return new dS(t)}),this.register(function(t){return new cS(t)})}load(e,t,n,r){let s=this,o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){let d=Ga.extractUrlBase(e);o=Ga.resolveURL(d,this.path)}else o=Ga.extractUrlBase(e);this.manager.itemStart(e);let a=function(d){r?r(d):console.error(d),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Hl(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(d){try{s.parse(d,o,function(c){t(c),s.manager.itemEnd(e)},a)}catch(c){a(c)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s,o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===C3){try{o[Vt.KHR_BINARY_GLTF]=new uS(e)}catch(u){r&&r(u);return}s=JSON.parse(o[Vt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let d=new xS(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){let u=this.pluginCallbacks[c](d);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){let u=s.extensionsUsed[c],h=s.extensionsRequired||[];switch(u){case Vt.KHR_MATERIALS_UNLIT:o[u]=new Y_;break;case Vt.KHR_DRACO_MESH_COMPRESSION:o[u]=new hS(s,this.dracoLoader);break;case Vt.KHR_TEXTURE_TRANSFORM:o[u]=new fS;break;case Vt.KHR_MESH_QUANTIZATION:o[u]=new pS;break;default:h.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}d.setExtensions(o),d.setPlugins(a),d.parse(n,r)}parseAsync(e,t){let n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}};function yZ(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var Vt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},Z_=class{constructor(e){this.parser=e,this.name=Vt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){let s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;let s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],d,c=new mt(16777215);l.color!==void 0&&c.setRGB(l.color[0],l.color[1],l.color[2],Ri);let u=l.range!==void 0?l.range:0;switch(l.type){case"directional":d=new Ys(c),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new T0(c),d.distance=u;break;case"spot":d=new M0(c),d.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,d.angle=l.spot.outerConeAngle,d.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return d.position.set(0,0,0),d.decay=2,zo(d,l),l.intensity!==void 0&&(d.intensity=l.intensity),d.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(d),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}},Y_=class{constructor(){this.name=Vt.KHR_MATERIALS_UNLIT}getMaterialType(){return fn}extendParams(e,t,n){let r=[];e.color=new mt(1,1,1),e.opacity=1;let s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Ri),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,fi))}return Promise.all(r)}},X_=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},Q_=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){let a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new we(a,a)}return Promise.all(s)}},K_=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_DISPERSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},J_=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},$_=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_SHEEN}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[];t.sheenColor=new mt(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){let a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Ri)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,fi)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},eS=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},tS=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_VOLUME}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new mt().setRGB(a[0],a[1],a[2],Ri),Promise.all(s)}},nS=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_IOR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},iS=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_SPECULAR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new mt().setRGB(a[0],a[1],a[2],Ri),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,fi)),Promise.all(s)}},rS=class{constructor(e){this.parser=e,this.name=Vt.EXT_MATERIALS_BUMP}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}},sS=class{constructor(e){this.parser=e,this.name=Vt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},oS=class{constructor(e){this.parser=e,this.name=Vt.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;let s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}},aS=class{constructor(e){this.parser=e,this.name=Vt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=n.textureLoader;if(a.uri){let d=n.options.manager.getHandler(a.uri);d!==null&&(l=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},lS=class{constructor(e){this.parser=e,this.name=Vt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=n.textureLoader;if(a.uri){let d=n.options.manager.getHandler(a.uri);d!==null&&(l=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},dS=class{constructor(e){this.name=Vt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){let r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){let l=r.byteOffset||0,d=r.byteLength||0,c=r.count,u=r.byteStride,h=new Uint8Array(a,l,d);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(c,u,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){let f=new ArrayBuffer(c*u);return o.decodeGltfBuffer(new Uint8Array(f),c,u,h,r.mode,r.filter),f})})}else return null}},cS=class{constructor(e){this.name=Vt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;let r=t.meshes[n.mesh];for(let d of r.primitives)if(d.mode!==Wr.TRIANGLES&&d.mode!==Wr.TRIANGLE_STRIP&&d.mode!==Wr.TRIANGLE_FAN&&d.mode!==void 0)return null;let o=n.extensions[this.name].attributes,a=[],l={};for(let d in o)a.push(this.parser.getDependency("accessor",o[d]).then(c=>(l[d]=c,l[d])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(d=>{let c=d.pop(),u=c.isGroup?c.children:[c],h=d[0].count,f=[];for(let p of u){let x=new _t,v=new V,g=new ir,y=new V(1,1,1),b=new f0(p.geometry,p.material,h);for(let A=0;A<h;A++)l.TRANSLATION&&v.fromBufferAttribute(l.TRANSLATION,A),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,A),l.SCALE&&y.fromBufferAttribute(l.SCALE,A),b.setMatrixAt(A,x.compose(v,g,y));for(let A in l)if(A==="_COLOR_0"){let M=l[A];b.instanceColor=new Vl(M.array,M.itemSize,M.normalized)}else A!=="TRANSLATION"&&A!=="ROTATION"&&A!=="SCALE"&&p.geometry.setAttribute(A,l[A]);yi.prototype.copy.call(b,p),this.parser.assignFinalMaterial(b),f.push(b)}return c.isGroup?(c.clear(),c.add(...f),c):f[0]}))}},C3="glTF",tf=12,A3={JSON:1313821514,BIN:5130562},uS=class{constructor(e){this.name=Vt.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,tf),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==C3)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-tf,s=new DataView(e,tf),o=0;for(;o<r;){let a=s.getUint32(o,!0);o+=4;let l=s.getUint32(o,!0);if(o+=4,l===A3.JSON){let d=new Uint8Array(e,tf+o,a);this.content=n.decode(d)}else if(l===A3.BIN){let d=tf+o;this.body=e.slice(d,d+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},hS=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Vt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},d={};for(let c in o){let u=gS[c]||c.toLowerCase();a[u]=o[c]}for(let c in e.attributes){let u=gS[c]||c.toLowerCase();if(o[c]!==void 0){let h=n.accessors[e.attributes[c]],f=jc[h.componentType];d[u]=f.name,l[u]=h.normalized===!0}}return t.getDependency("bufferView",s).then(function(c){return new Promise(function(u,h){r.decodeDracoFile(c,function(f){for(let p in f.attributes){let x=f.attributes[p],v=l[p];v!==void 0&&(x.normalized=v)}u(f)},a,d,Ri,h)})})}},fS=class{constructor(){this.name=Vt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},pS=class{constructor(){this.name=Vt.KHR_MESH_QUANTIZATION}},B0=class extends Ua{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,d=a*3,c=r-t,u=(n-t)/c,h=u*u,f=h*u,p=e*d,x=p-d,v=-2*f+3*h,g=f-h,y=1-v,b=g-h+u;for(let A=0;A!==a;A++){let M=o[x+A+a],T=o[x+A+l]*c,I=o[p+A+a],L=o[p+A]*c;s[A]=y*M+b*T+v*I+g*L}return s}},AZ=new ir,mS=class extends B0{interpolate_(e,t,n,r){let s=super.interpolate_(e,t,n,r);return AZ.fromArray(s).normalize().toArray(s),s}},Wr={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},jc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_3={9728:Pi,9729:er,9984:D_,9985:Dh,9986:vc,9987:js},S3={33071:Ro,33648:Fh,10497:Fl},G_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},gS={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qa={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},_Z={CUBICSPLINE:void 0,LINEAR:Rc,STEP:Pc},W_={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function SZ(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Vc({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ws})),i.DefaultMaterial}function Gl(i,e,t){for(let n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function zo(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function EZ(i,e,t){let n=!1,r=!1,s=!1;for(let d=0,c=e.length;d<c;d++){let u=e[d];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);let o=[],a=[],l=[];for(let d=0,c=e.length;d<c;d++){let u=e[d];if(n){let h=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):i.attributes.position;o.push(h)}if(r){let h=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):i.attributes.normal;a.push(h)}if(s){let h=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):i.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(d){let c=d[0],u=d[1],h=d[2];return n&&(i.morphAttributes.position=c),r&&(i.morphAttributes.normal=u),s&&(i.morphAttributes.color=h),i.morphTargetsRelative=!0,i})}function CZ(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function MZ(i){let e,t=i.extensions&&i.extensions[Vt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+q_(t.attributes):e=i.indices+":"+q_(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+q_(i.targets[n]);return e}function q_(i){let e="",t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function vS(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function TZ(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":i.search(/\.ktx2($|\?)/i)>0||i.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}var IZ=new _t,xS=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new yZ,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,s=!1,o=-1;if(typeof navigator<"u"){let a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;let l=a.match(/Version\/(\d+)/);r=n&&l?parseInt(l[1],10):-1,s=a.indexOf("Firefox")>-1,o=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||s&&o<98?this.textureLoader=new C0(this.options.manager):this.textureLoader=new I0(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Hl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){let a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return Gl(s,a,r),zo(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(let l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){let o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;let r=n.clone(),s=(o,a)=>{let l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(let[d,c]of o.children.entries())s(c,a.children[d])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let r=e(t[n]);if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let r=0;r<t.length;r++){let s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){let n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Vt.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(s,o){n.load(Ga.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){let r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){let t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){let o=G_[r.type],a=jc[r.componentType],l=r.normalized===!0,d=new a(r.count*o);return Promise.resolve(new $n(d,o,l))}let s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){let a=o[0],l=G_[r.type],d=jc[r.componentType],c=d.BYTES_PER_ELEMENT,u=c*l,h=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0,x,v;if(f&&f!==u){let g=Math.floor(h/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count,b=t.cache.get(y);b||(x=new d(a,g*f,r.count*f/c),b=new Hh(x,f/c),t.cache.add(y,b)),v=new zh(b,l,h%f/c,p)}else a===null?x=new d(r.count*l):x=new d(a,h,r.count*l),v=new $n(x,l,p);if(r.sparse!==void 0){let g=G_.SCALAR,y=jc[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,A=r.sparse.values.byteOffset||0,M=new y(o[1],b,r.sparse.count*g),T=new d(o[2],A,r.sparse.count*l);a!==null&&(v=new $n(v.array.slice(),v.itemSize,v.normalized)),v.normalized=!1;for(let I=0,L=M.length;I<L;I++){let E=M[I];if(v.setX(E,T[I*l]),l>=2&&v.setY(E,T[I*l+1]),l>=3&&v.setZ(E,T[I*l+2]),l>=4&&v.setW(E,T[I*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}v.normalized=p}return v})}loadTexture(e){let t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s],a=this.textureLoader;if(o.uri){let l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){let r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let d=this.loadImageSource(t,n).then(function(c){c.flipY=!1,c.name=o.name||a.name||"",c.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(c.name=a.uri);let h=(s.samplers||{})[o.sampler]||{};return c.magFilter=_3[h.magFilter]||er,c.minFilter=_3[h.minFilter]||js,c.wrapS=S3[h.wrapS]||Fl,c.wrapT=S3[h.wrapT]||Fl,c.generateMipmaps=!c.isCompressedTexture&&c.minFilter!==Pi&&c.minFilter!==er,r.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=d,d}loadImageSource(e,t){let n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());let o=r.images[e],a=self.URL||self.webkitURL,l=o.uri||"",d=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(u){d=!0;let h=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let c=Promise.resolve(l).then(function(u){return new Promise(function(h,f){let p=h;t.isImageBitmapLoader===!0&&(p=function(x){let v=new Gr(x);v.needsUpdate=!0,h(v)}),t.load(Ga.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return d===!0&&a.revokeObjectURL(l),zo(u,o),u.userData.mimeType=o.mimeType||TZ(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=c,c}assignTexture(e,t,n,r){let s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[Vt.KHR_TEXTURE_TRANSFORM]){let a=n.extensions!==void 0?n.extensions[Vt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){let l=s.associations.get(o);o=s.extensions[Vt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){let t=e.geometry,n=e.material,r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+n.uuid,l=this.cache.get(a);l||(l=new Wh,Tn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){let a="LineBasicMaterial:"+n.uuid,l=this.cache.get(a);l||(l=new Gh,Tn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return Vc}loadMaterial(e){let t=this,n=this.json,r=this.extensions,s=n.materials[e],o,a={},l=s.extensions||{},d=[];if(l[Vt.KHR_MATERIALS_UNLIT]){let u=r[Vt.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),d.push(u.extendParams(a,s,t))}else{let u=s.pbrMetallicRoughness||{};if(a.color=new mt(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){let h=u.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],Ri),a.opacity=h[3]}u.baseColorTexture!==void 0&&d.push(t.assignTexture(a,"map",u.baseColorTexture,fi)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(d.push(t.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),d.push(t.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=ws);let c=s.alphaMode||W_.OPAQUE;if(c===W_.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===W_.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==fn&&(d.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new we(1,1),s.normalTexture.scale!==void 0)){let u=s.normalTexture.scale;a.normalScale.set(u,u)}if(s.occlusionTexture!==void 0&&o!==fn&&(d.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==fn){let u=s.emissiveFactor;a.emissive=new mt().setRGB(u[0],u[1],u[2],Ri)}return s.emissiveTexture!==void 0&&o!==fn&&d.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,fi)),Promise.all(d).then(function(){let u=new o(a);return s.name&&(u.name=s.name),zo(u,s),t.associations.set(u,{materials:e}),s.extensions&&Gl(r,u,s),u})}createUniqueName(e){let t=Cn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[Vt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return E3(l,a,t)})}let o=[];for(let a=0,l=e.length;a<l;a++){let d=e[a],c=MZ(d),u=r[c];if(u)o.push(u.promise);else{let h;d.extensions&&d.extensions[Vt.KHR_DRACO_MESH_COMPRESSION]?h=s(d):h=E3(new xr,d,t),r[c]={primitive:d,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){let t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,d=o.length;l<d;l++){let c=o[l].material===void 0?SZ(this.cache):this.getDependency("material",o[l].material);a.push(c)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){let d=l.slice(0,l.length-1),c=l[l.length-1],u=[];for(let f=0,p=c.length;f<p;f++){let x=c[f],v=o[f],g,y=d[f];if(v.mode===Wr.TRIANGLES||v.mode===Wr.TRIANGLE_STRIP||v.mode===Wr.TRIANGLE_FAN||v.mode===void 0)g=s.isSkinnedMesh===!0?new c0(x,y):new jt(x,y),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),v.mode===Wr.TRIANGLE_STRIP?g.geometry=j_(g.geometry,L0):v.mode===Wr.TRIANGLE_FAN&&(g.geometry=j_(g.geometry,ef));else if(v.mode===Wr.LINES)g=new g0(x,y);else if(v.mode===Wr.LINE_STRIP)g=new Bc(x,y);else if(v.mode===Wr.LINE_LOOP)g=new v0(x,y);else if(v.mode===Wr.POINTS)g=new x0(x,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(g.geometry.morphAttributes).length>0&&CZ(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),zo(g,s),v.extensions&&Gl(r,g,v),t.assignFinalMaterial(g),u.push(g)}for(let f=0,p=u.length;f<p;f++)t.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return s.extensions&&Gl(r,u[0],s),u[0];let h=new Gs;s.extensions&&Gl(r,h,s),t.associations.set(h,{meshes:e});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}loadCamera(e){let t,n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Un(N0.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Nc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),zo(t,n),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){let s=r.pop(),o=r,a=[],l=[];for(let d=0,c=o.length;d<c;d++){let u=o[d];if(u){a.push(u);let h=new _t;s!==null&&h.fromArray(s.array,d*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new h0(a,l)})}loadAnimation(e){let t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],d=[],c=[];for(let u=0,h=r.channels.length;u<h;u++){let f=r.channels[u],p=r.samplers[f.sampler],x=f.target,v=x.node,g=r.parameters!==void 0?r.parameters[p.input]:p.input,y=r.parameters!==void 0?r.parameters[p.output]:p.output;x.node!==void 0&&(o.push(this.getDependency("node",v)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",y)),d.push(p),c.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(d),Promise.all(c)]).then(function(u){let h=u[0],f=u[1],p=u[2],x=u[3],v=u[4],g=[];for(let y=0,b=h.length;y<b;y++){let A=h[y],M=f[y],T=p[y],I=x[y],L=v[y];if(A===void 0)continue;A.updateMatrix&&A.updateMatrix();let E=n._createAnimationTracks(A,M,T,I,L);if(E)for(let S=0;S<E.length;S++)g.push(E[S])}return new E0(s,void 0,g)})}createNodeMesh(e){let t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){let o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,d=r.weights.length;l<d;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){let t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let d=0,c=a.length;d<c;d++)o.push(n.getDependency("node",a[d]));let l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(d){let c=d[0],u=d[1],h=d[2];h!==null&&c.traverse(function(f){f.isSkinnedMesh&&f.bind(h,IZ)});for(let f=0,p=u.length;f<p;f++)c.add(u[f]);return c})}_loadNodeShallow(e){let t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(d){return r._getNodeRef(r.cameraCache,s.camera,d)})),r._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){a.push(d)}),this.nodeCache[e]=Promise.all(a).then(function(d){let c;if(s.isBone===!0?c=new jh:d.length>1?c=new Gs:d.length===1?c=d[0]:c=new yi,c!==d[0])for(let u=0,h=d.length;u<h;u++)c.add(d[u]);if(s.name&&(c.userData.name=s.name,c.name=o),zo(c,s),s.extensions&&Gl(n,c,s),s.matrix!==void 0){let u=new _t;u.fromArray(s.matrix),c.applyMatrix4(u)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){let t=this.extensions,n=this.json.scenes[e],r=this,s=new Gs;n.name&&(s.name=r.createUniqueName(n.name)),zo(s,n),n.extensions&&Gl(t,s,n);let o=n.nodes||[],a=[];for(let l=0,d=o.length;l<d;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let c=0,u=l.length;c<u;c++)s.add(l[c]);let d=c=>{let u=new Map;for(let[h,f]of r.associations)(h instanceof Tn||h instanceof Gr)&&u.set(h,f);return c.traverse(h=>{let f=r.associations.get(h);f!=null&&u.set(h,f)}),u};return r.associations=d(s),s})}_createAnimationTracks(e,t,n,r,s){let o=[],a=e.name?e.name:e.uuid,l=[];qa[s.path]===qa.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(a);let d;switch(qa[s.path]){case qa.weights:d=Vo;break;case qa.rotation:d=Uo;break;case qa.position:case qa.scale:d=Ho;break;default:switch(n.itemSize){case 1:d=Vo;break;case 2:case 3:default:d=Ho;break}break}let c=r.interpolation!==void 0?_Z[r.interpolation]:Rc,u=this._getArrayFromAccessor(n);for(let h=0,f=l.length;h<f;h++){let p=new d(l[h]+"."+qa[s.path],t.array,u,c);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let n=vS(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){let r=this instanceof Uo?mS:B0;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function DZ(i,e,t){let n=e.attributes,r=new Hr;if(n.POSITION!==void 0){let a=t.json.accessors[n.POSITION],l=a.min,d=a.max;if(l!==void 0&&d!==void 0){if(r.set(new V(l[0],l[1],l[2]),new V(d[0],d[1],d[2])),a.normalized){let c=vS(jc[a.componentType]);r.min.multiplyScalar(c),r.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let s=e.targets;if(s!==void 0){let a=new V,l=new V;for(let d=0,c=s.length;d<c;d++){let u=s[d];if(u.POSITION!==void 0){let h=t.json.accessors[u.POSITION],f=h.min,p=h.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),h.normalized){let x=vS(jc[h.componentType]);l.multiplyScalar(x)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;let o=new vr;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function E3(i,e,t){let n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(let o in n){let a=gS[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!i.index){let o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return zt.workingColorSpace!==Ri&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${zt.workingColorSpace}" not supported.`),zo(i,e),DZ(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?EZ(i,e.targets,t):i})}var M3={type:"change"},bS={type:"start"},I3={type:"end"},V0=new Bo,T3=new xs,PZ=Math.cos(70*N0.DEG2RAD),ni=new V,rr=2*Math.PI,dn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},wS=1e-6,Za=class extends P0{constructor(e,t=null){super(e,t),this.state=dn.NONE,this.enabled=!0,this.target=new V,this.cursor=new V,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:zl.ROTATE,MIDDLE:zl.DOLLY,RIGHT:zl.PAN},this.touches={ONE:jl.ROTATE,TWO:jl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new V,this._lastQuaternion=new ir,this._lastTargetPosition=new V,this._quat=new ir().setFromUnitVectors(e.up,new V(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Jh,this._sphericalDelta=new Jh,this._scale=1,this._panOffset=new V,this._rotateStart=new we,this._rotateEnd=new we,this._rotateDelta=new we,this._panStart=new we,this._panEnd=new we,this._panDelta=new we,this._dollyStart=new we,this._dollyEnd=new we,this._dollyDelta=new we,this._dollyDirection=new V,this._mouse=new we,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=LZ.bind(this),this._onPointerDown=RZ.bind(this),this._onPointerUp=kZ.bind(this),this._onContextMenu=HZ.bind(this),this._onMouseWheel=OZ.bind(this),this._onKeyDown=BZ.bind(this),this._onTouchStart=VZ.bind(this),this._onTouchMove=UZ.bind(this),this._onMouseDown=NZ.bind(this),this._onMouseMove=FZ.bind(this),this._interceptControlDown=zZ.bind(this),this._interceptControlUp=jZ.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(M3),this.update(),this.state=dn.NONE}update(e=null){let t=this.object.position;ni.copy(t).sub(this.target),ni.applyQuaternion(this._quat),this._spherical.setFromVector3(ni),this.autoRotate&&this.state===dn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=rr:n>Math.PI&&(n-=rr),r<-Math.PI?r+=rr:r>Math.PI&&(r-=rr),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(ni.setFromSpherical(this._spherical),ni.applyQuaternion(this._quatInverse),t.copy(this.target).add(ni),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){let a=ni.length();o=this._clampDistance(a*this._scale);let l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){let a=new V(this._mouse.x,this._mouse.y,0);a.unproject(this.object);let l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;let d=new V(this._mouse.x,this._mouse.y,0);d.unproject(this.object),this.object.position.sub(d).add(a),this.object.updateMatrixWorld(),o=ni.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(V0.origin.copy(this.object.position),V0.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(V0.direction))<PZ?this.object.lookAt(this.target):(T3.setFromNormalAndCoplanarPoint(this.object.up,this.target),V0.intersectPlane(T3,this.target))))}else if(this.object.isOrthographicCamera){let o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>wS||8*(1-this._lastQuaternion.dot(this.object.quaternion))>wS||this._lastTargetPosition.distanceToSquared(this.target)>wS?(this.dispatchEvent(M3),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?rr/60*this.autoRotateSpeed*e:rr/60/60*this.autoRotateSpeed}_getZoomScale(e){let t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){ni.setFromMatrixColumn(t,0),ni.multiplyScalar(-e),this._panOffset.add(ni)}_panUp(e,t){this.screenSpacePanning===!0?ni.setFromMatrixColumn(t,1):(ni.setFromMatrixColumn(t,0),ni.crossVectors(this.object.up,ni)),ni.multiplyScalar(e),this._panOffset.add(ni)}_pan(e,t){let n=this.domElement;if(this.object.isPerspectiveCamera){let r=this.object.position;ni.copy(r).sub(this.target);let s=ni.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,o=n.width,a=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(rr*this._rotateDelta.x/t.clientHeight),this._rotateUp(rr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(rr*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-rr*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(rr*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-rr*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{let n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(rr*this._rotateDelta.x/t.clientHeight),this._rotateUp(rr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new we,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}};function RZ(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function LZ(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function kZ(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(I3),this.state=dn.NONE;break;case 1:let e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function NZ(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case zl.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=dn.DOLLY;break;case zl.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=dn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=dn.ROTATE}break;case zl.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=dn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=dn.PAN}break;default:this.state=dn.NONE}this.state!==dn.NONE&&this.dispatchEvent(bS)}function FZ(i){switch(this.state){case dn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case dn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case dn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function OZ(i){this.enabled===!1||this.enableZoom===!1||this.state!==dn.NONE||(i.preventDefault(),this.dispatchEvent(bS),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(I3))}function BZ(i){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(i)}function VZ(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case jl.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=dn.TOUCH_ROTATE;break;case jl.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=dn.TOUCH_PAN;break;default:this.state=dn.NONE}break;case 2:switch(this.touches.TWO){case jl.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=dn.TOUCH_DOLLY_PAN;break;case jl.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=dn.TOUCH_DOLLY_ROTATE;break;default:this.state=dn.NONE}break;default:this.state=dn.NONE}this.state!==dn.NONE&&this.dispatchEvent(bS)}function UZ(i){switch(this._trackPointer(i),this.state){case dn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case dn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case dn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case dn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=dn.NONE}}function HZ(i){this.enabled!==!1&&i.preventDefault()}function zZ(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function jZ(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var qr=class extends _0{constructor(e,t={}){let h=t,{bevelEnabled:n=!1,bevelSize:r=8,bevelThickness:s=10,font:o,height:a=50,size:l=100,lineHeight:d=1,letterSpacing:c=0}=h,u=yx(h,["bevelEnabled","bevelSize","bevelThickness","font","height","size","lineHeight","letterSpacing"]);if(o===void 0)super();else{let f=o.generateShapes(e,l,{lineHeight:d,letterSpacing:c});super(f,We(ae({},u),{bevelEnabled:n,bevelSize:r,bevelThickness:s,depth:a}))}this.type="TextGeometry"}};var GZ=Object.defineProperty,WZ=(i,e,t)=>e in i?GZ(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,yS=(i,e,t)=>(WZ(i,typeof e!="symbol"?e+"":e,t),t),ql=class extends Wa{constructor(e){super(e)}load(e,t,n,r){let s=new Hl(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{if(typeof o!="string")throw new Error("unsupported data type");let a=JSON.parse(o),l=this.parse(a);t&&t(l)},n,r)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new Gc(e)}},Gc=class{constructor(e){yS(this,"data"),this.data=e}generateShapes(e,t=100,n){let r=[],s=ae({letterSpacing:0,lineHeight:1},n),o=qZ(e,t,this.data,s);for(let a=0,l=o.length;a<l;a++)Array.prototype.push.apply(r,o[a].toShapes(!1));return r}};yS(Gc,"isFont");yS(Gc,"type");function qZ(i,e,t,n){let r=Array.from(i),s=e/t.resolution,o=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*s,a=[],l=0,d=0;for(let c=0;c<r.length;c++){let u=r[c];if(u===`
`)l=0,d-=o*n.lineHeight;else{let h=ZZ(u,s,l,d,t);h&&(l+=h.offsetX+n.letterSpacing,a.push(h.path))}}return a}function ZZ(i,e,t,n,r){let s=r.glyphs[i]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+i+'" does not exists in font family '+r.familyName+".");return}let o=new D0,a,l,d,c,u,h,f,p;if(s.o){let x=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let v=0,g=x.length;v<g;)switch(x[v++]){case"m":a=parseInt(x[v++])*e+t,l=parseInt(x[v++])*e+n,o.moveTo(a,l);break;case"l":a=parseInt(x[v++])*e+t,l=parseInt(x[v++])*e+n,o.lineTo(a,l);break;case"q":d=parseInt(x[v++])*e+t,c=parseInt(x[v++])*e+n,u=parseInt(x[v++])*e+t,h=parseInt(x[v++])*e+n,o.quadraticCurveTo(u,h,d,c);break;case"b":d=parseInt(x[v++])*e+t,c=parseInt(x[v++])*e+n,u=parseInt(x[v++])*e+t,h=parseInt(x[v++])*e+n,f=parseInt(x[v++])*e+t,p=parseInt(x[v++])*e+n,o.bezierCurveTo(u,h,f,p,d,c);break}}return{offsetX:s.ha*e,path:o}}var Wc=class i{constructor(){this.checkScreenSize()}checkScreenSize(){window.addEventListener("resize",this.onResize.bind(this))}onResize(){location.reload()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var YZ=["modelContainer"];function XZ(i,e){if(i&1){let t=Ve();m(0,"button",20),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/mapTerrain.glb"),ee(r.mapTerrain=!0)}),m(1,"div",21),ie(),m(2,"svg",22),F(3,"path",23),w()()()}}function QZ(i,e){if(i&1){let t=Ve();m(0,"button",24),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/map.glb"),ee(r.mapTerrain=!1)}),m(1,"div",25),ie(),m(2,"svg",22),F(3,"path",23),w()()()}}function KZ(i,e){if(i&1){let t=Ve();m(0,"div",29)(1,"div",30)(2,"p",31),_(3," Kiosk "),m(4,"b"),_(5),w(),_(6," already occupied, please select other kiosk!"),w()(),m(7,"div",32)(8,"button",33),H("click",function(){$(t);let r=U(2);return ee(r.router.navigate(["/dashboard"]))}),_(9,"Go back"),w(),m(10,"button",34),H("click",function(){$(t);let r=U(2);return ee(r.errorMessage="")}),_(11,"Okay"),w()()()}if(i&2){let t=U(2);C(5),ge(t.kioskName)}}function JZ(i,e){if(i&1){let t=Ve();m(0,"div",35)(1,"div",36)(2,"div",37),F(3,"img",38),w(),m(4,"div",39)(5,"p",40),_(6," Are you willing to book "),m(7,"b"),_(8),w(),_(9,"?"),w(),m(10,"p",41),_(11," Description:"),m(12,"textarea",42),_(13),w()()(),m(14,"div",43)(15,"button",33),H("click",function(){$(t);let r=U(2);return ee(r.errorMessage="")}),_(16,"No"),w(),m(17,"button",34),H("click",function(){$(t);let r=U(2);return ee(r.toApplication())}),_(18,"Yes"),w()()()()}if(i&2){let t=U(2);C(3),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/kioskImages/",t.kioskImage,"",ai),C(5),ot("",t.kioskName," "),C(5),ge(t.kioskDescription)}}function $Z(i,e){if(i&1&&(m(0,"div",26),G(1,KZ,12,1,"div",27)(2,JZ,19,4,"div",28),w()),i&2){let t=U();C(),k("ngIf",t.errorMessage!="done"&&t.errorMessage!=""),C(),k("ngIf",t.errorMessage=="done")}}var U0=class i{constructor(e,t,n){this.router=e;this.screenSizeService=t;this.eventService=n;this.scene=new Oc,this.camera=new Un(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new Fc({antialias:!0}),this.fontLoader=new ql}kioskData=[];scene;camera;renderer;model;controls;raycaster=new Hc;pointer=new we;clickableObjects=[];errorMessage="";fontLoader;isMap=!1;kioskName="";eventId="";kioskId="";kioskStatus="";kioskDescription="";mapTerrain=!1;kioskImage="";kisokx=0;kisoky=0;myKiosk;currentModel;modelContainer;ngOnChanges(e){}goToDashBoard(){this.router.navigate(["/dashboard"])}ngOnInit(){this.renderer.domElement.addEventListener("click",s=>this.onMouseClick(s)),this.controls=new Za(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let e=new ja(4210752);this.scene.add(e);let t=new Ys(16777215,1);t.position.set(20,20,20).normalize(),this.scene.add(t);let n=sessionStorage.getItem("eventId")??"",r=new fn({color:16760331});this.eventService.getKioskMap(n).subscribe(s=>{this.kioskData=s,s.forEach(o=>{let a=new qs(.15,.15,.15);if(o.status=="available"){let l=new fn({color:5405039}),d=new jt(a,l);d.position.set(o.position_x,.65,o.position_y),d.userData={name:o.kiosk_name,eventsId:n,kioskId:o.kiosk_id,kioskStatus:o.status,kioskDescription:o.kiosk_description,kioskImage:o.kiosk_image},this.scene.add(d),this.clickableObjects.push(d)}else if(o.status=="pending"){let l=new fn({color:16760331}),d=new jt(a,l);d.position.set(o.position_x,.65,o.position_y),d.userData={name:o.kiosk_name,eventsId:o.event_id,kioskId:o.kiosk_id,kioskStatus:o.status,kioskDescription:o.kiosk_description,kioskImage:o.kiosk_image},this.scene.add(d),this.clickableObjects.push(d)}else if(o.status=="unavailable"){let l=new fn({color:10289672}),d=new jt(a,l);d.position.set(o.position_x,.65,o.position_y),d.userData={name:o.kiosk_name,eventsId:o.event_id,kioskId:o.kiosk_id,kioskStatus:o.status,kioskDescription:o.kiosk_description,kioskImage:o.kiosk_image,kiosk:o},this.scene.add(d),this.clickableObjects.push(d)}o.status!="disable"&&this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",l=>{let d=new qr(o.kiosk_name.replace(/\D/g,""),{font:l,size:.08,height:.05,curveSegments:12}),c=new fn({color:16381939}),u=new jt(d,c);this.scene.add(u),u.position.set(o.position_x,.8,o.position_y),u.scale.z=-1})}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",o=>{let a=new qr("Gym",{font:o,size:.5,height:.05,curveSegments:12}),l=new fn({color:3096134}),d=new jt(a,l);this.scene.add(d),d.position.set(1,1.8,1),d.scale.z=-1}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",o=>{let a=new qr("Field",{font:o,size:.5,height:.05,curveSegments:12}),l=new fn({color:3096134}),d=new jt(a,l);this.scene.add(d),d.position.set(-1.5,1.8,0),d.scale.z=-1})}),this.loadModel("assets/model/map.glb")}loadModel(e){let t=new Wl;this.removeModel(),t.load(e,n=>{this.currentModel=n.scene,this.scene.add(this.currentModel)},void 0,n=>{console.error("An error occurred while loading the model:",n)})}removeModel(){this.currentModel&&(this.scene.remove(this.currentModel),this.currentModel.traverse(e=>{e instanceof jt&&(e.geometry&&e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(t=>{t instanceof Tn&&t.dispose()}):e.material instanceof Tn&&e.material.dispose())}),this.currentModel=void 0)}changeModel(e){this.removeModel(),this.loadModel(e),this.renderer.domElement.addEventListener("click",r=>this.onMouseClick(r)),this.controls=new Za(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let t=new ja(4210752);this.scene.add(t);let n=new Ys(16777215,1);n.position.set(20,20,20).normalize(),this.scene.add(n)}onMouseClick(e){this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);let t=this.raycaster.intersectObjects(this.clickableObjects);if(t.length>0){let n=t[0].object,r=n.position.y,s=n.userData;if(s.kioskStatus=="available"){let o=s.kioskId,a=s.name,l=s.eventsId,d=s.kioskStatus,c=s.kioskDescription,u=s.kioskImage;this.errorMessage="done",this.eventId=l,this.kioskId=o,this.kioskName=a,this.kioskStatus=d,this.kioskDescription=c,this.kioskImage=u}else{let o=s.name;this.kioskName=o,this.errorMessage="occupied"}}}toApplication(){sessionStorage.setItem("kioskStatus",this.kioskStatus),sessionStorage.setItem("kioskName",this.kioskName),sessionStorage.setItem("kioskId",this.kioskId),this.router.navigate(["/application-form"])}ngAfterViewInit(){this.modelContainer.nativeElement.appendChild(this.renderer.domElement),this.animate()}loadModelTerrain(){new Wl().load("assets/model/mapTerrain.glb",t=>{this.model=t.scene,this.model.scale.set(1,1,1),this.model.position.set(0,0,0),this.scene.add(this.model)},void 0,t=>{console.error("An error occurred while loading the model:",t)})}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}ngOnDestroy(){this.model&&(this.scene.remove(this.model),this.model.traverse(t=>{t instanceof jt&&(t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(n=>{n instanceof Tn&&n.dispose()}):t.material instanceof Tn&&t.material.dispose())})),this.renderer&&this.renderer.dispose();let e=this.renderer.domElement;e.parentElement&&e.parentElement.removeChild(e),this.controls&&this.controls.dispose()}static \u0275fac=function(t){return new(t||i)(se(Qe),se(Wc),se(ci))};static \u0275cmp=ft({type:i,selectors:[["app-map-viewer"]],viewQuery:function(t,n){if(t&1&&qn(YZ,7),t&2){let r;Rn(r=Ln())&&(n.modelContainer=r.first)}},standalone:!0,features:[Vi,gt],decls:28,vars:3,consts:[["modelContainer",""],[1,"max-w-screen-xl"],[1,"max-w-screen-xl","h-full","fixed"],[1,"w-full","h-full","overflow-x-hidden"],[1,"z-10","fixed","md:top-20","bottom-10","right-0","w-full","md:w-[350px]","bg-transparent","p-4"],[1,"absolute","top-[5rem]","left-8","flex","justify-center","align-center","text-xl","text-gray-50","w-20","bg-red-400","rounded-md","mb-4",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","white","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"flex","justify-center","align-center","mt-1","h-5","w-5"],["d","M19 12H5"],["d","M12 19l-7-7 7-7"],[1,"w-full","grid","grid-cols-2","bg-gray-400","p-4","rounded-xl","gap-2"],[1,"flex-cols","justify-center","align-center","w-full","h-full","pt-8","mt-12"],["class","size-20 hover:bg-green-700 hover:text-gray-50 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],["class","size-20  hover:bg-green-700 hover:text-gray-200 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],[1,"grid","grid-cols-2","gap-y-1","mt-4"],[1,"text-gray-50","text-lg","col-span-2","text-center"],[1,"size-6","bg-green-500","rounded-lg"],[1,"text-gray-50","text-xs","mt-1"],[1,"size-6","bg-yellow-500","rounded-lg"],[1,"size-6","bg-blue-500","rounded-lg"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-screen w-full z-[1000] overflow-hidden",4,"ngIf"],[1,"size-20","hover:bg-green-700","hover:text-gray-50","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-6","justify-center","text-gray-50"],["width","24px","height","24px","viewBox","0 0 100 100","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","aria-hidden","true","role","img","preserveAspectRatio","xMidYMid meet",1,"iconify","iconify--gis"],["d","M50 5L24.637 30.469H41.34v20.705h17.32V30.469h16.703zM28.135 37.309a3.5 3.5 0 0 0-2.668 1.234L.832 67.559a3.5 3.5 0 0 0 2.67 5.765l93-.064a3.5 3.5 0 0 0 2.666-5.766L74.59 38.543a3.5 3.5 0 0 0-2.668-1.234H64.66c-.002 2.333-.008 4.666-.008 7h5.649l18.64 21.957l-77.873.052l18.686-22.01h5.586c.002-2.333.003-4.666 0-7zM89.91 78.264l-9.178.007l8.211 9.67l-77.875.053l8.22-9.682l-9.188.008L.832 89.234A3.5 3.5 0 0 0 3.502 95l93-.064a3.5 3.5 0 0 0 2.666-5.766z","fill","#161a1d"],[1,"size-20","hover:bg-green-700","hover:text-gray-200","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-6","justify-center","text-gray-300"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-screen","w-full","z-[1000]","overflow-hidden"],["class","animate-fadeIn overflow-hidden px-4 md:px-8 grid justify-center items-center w-full h-[380px] md:h-[380px] md:w-[580px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden px-4 md:px-8 py-4 grid justify-center items-center w-full h-[400px] md:h-[480px] md:w-[580px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],[1,"animate-fadeIn","overflow-hidden","px-4","md:px-8","grid","justify-center","items-center","w-full","h-[380px]","md:h-[380px]","md:w-[580px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","px-4","md:px-8","py-4","grid","justify-center","items-center","w-full","h-[400px]","md:h-[480px]","md:w-[580px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"grid","grid-cols-[55%_45%]","md:grid-cols-[60%_40%]","gap-2"],[1,"row-span-2","py-4"],[1,"rounded-xl","h-80","w-full","md:size-full","object-cover",3,"src"],[1,"flex-cols","items-center","h-full","w-full","mt-4","md:my-8"],[1,"text-gray-50","text-left","text-xl"],[1,"md:pt-8","py-5","text-gray-50","text-left","leading-none","h-68","md:h-44"],["readonly","",1,"h-32","bg-inherit","min-h-32","max-h-32","w-full","text-xs","mt-2","focus:outline-none","outline-none","overflow-y-scroll"],[1,"relative","-top-4","flex","justify-between","space-x-2","w-full"]],template:function(t,n){if(t&1){let r=Ve();m(0,"div",1)(1,"div",2),F(2,"div",3,0),w(),m(4,"div",4)(5,"button",5),H("click",function(){return $(r),ee(n.goToDashBoard())}),ie(),m(6,"svg",6),F(7,"path",7)(8,"path",8),w(),Je(),m(9,"span"),_(10,"Back"),w()(),m(11,"div",9)(12,"div",10),G(13,XZ,4,0,"button",11)(14,QZ,4,0,"button",12),w(),m(15,"div",13)(16,"p",14),_(17,"Legend:"),w(),F(18,"div",15),m(19,"p",16),_(20,"Available"),w(),F(21,"div",17),m(22,"p",16),_(23,"Pending"),w(),F(24,"div",18),m(25,"p",16),_(26,"Disable"),w()()()(),G(27,$Z,3,2,"div",19),w()}t&2&&(C(13),k("ngIf",!n.mapTerrain),C(),k("ngIf",n.mapTerrain),C(13),k("ngIf",n.errorMessage))},dependencies:[xt,kt],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var cn=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files-admin";getUsers(){return this.http.get(this.apiUrl+"/fetch-user.php")}getKiosk(){return this.http.get(`${this.apiUrl}/fetch-kiosk.php`)}getEvent(){return this.http.get(`${this.apiUrl}/fetch-events.php`)}getPastEvent(){return this.http.get(`${this.apiUrl}/fetch-past-events.php`)}getSelectedEvent(e){let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-selected-events.php`,t)}getTransaction(){return this.http.get(`${this.apiUrl}/fetch-transaction.php`)}getNotification(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-notification.php`,t)}updateStatus(e,t,n,r,s,o){let a={status:e,userId:t,eventId:n,kioskId:r,formId:s,dateRequested:o};return this.http.post(`${this.apiUrl}/update-status.php`,a)}updateUserStatus(e,t){let n={userId:t,status:e};return this.http.post(`${this.apiUrl}/update-user-status.php`,n)}updateUserType(e,t){let n={userId:t,userType:e};return this.http.post(`${this.apiUrl}/update-user-type.php`,n)}dynamicController(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/dynamic-control.php`,t)}userControl(e,t,n){let r={userId:e,permission:t,value:n};return this.http.post(`${this.apiUrl}/user-control.php`,r)}updateEvents(e){return console.log(e.get("eventId")),console.log("checked"),this.http.post(`${this.apiUrl}/update-events.php`,e).pipe(Er(t=>(console.error("HTTP error:",t),Ms(()=>new Error("Submission failed.")))))}updateKiosk(e){return this.http.post(`${this.apiUrl}/update-kiosk.php`,e).pipe(Er(t=>(console.error("HTTP error:",t),Ms(()=>new Error("Submission failed.")))))}getKioskMap(e){let t={eventId:e};return console.log(e),this.http.post(`${this.apiUrl}/fetch-kiosks-map.php`,t)}disableEvent(e){let t={eventId:e};return this.http.post(`${this.apiUrl}/update-event-status.php`,t)}createEvents(e){return this.http.post(`${this.apiUrl}/add-events.php`,e).pipe(Er(t=>(console.error("HTTP error:",t),Ms(()=>new Error("Submission failed.")))))}getEventsReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-events-report.php`,t)}getBusinessReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-business.php`,t)}getKioskReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-kiosk-business.php`,t)}static \u0275fac=function(t){return new(t||i)(Te(wo))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};function eY(i,e){if(i&1&&(m(0,"div",8),_(1),w()),i&2){let t=e.$implicit;C(),ge(t)}}function tY(i,e){if(i&1&&(m(0,"div",12),_(1),w()),i&2){let t=U().$implicit;C(),ot(" ",t.date," ")}}function nY(i,e){if(i&1){let t=Ve();m(0,"div",13),H("change",function(){let r;$(t);let s=U().$implicit,o=U();return ee(o.checkDate((r=s.date)!==null&&r!==void 0?r:0,s.checkbox,s.exactDate))}),F(1,"input",14),w()}if(i&2){let t=U().$implicit;C(),ls("value",t.exactDate),Ci("id","checkbox-",t.date,"")}}function iY(i,e){if(i&1&&(m(0,"div",9),G(1,tY,2,1,"div",10)(2,nY,2,3,"div",11),w()),i&2){let t=e.$implicit;C(),k("ngIf",t.date),C(),k("ngIf",t.checkbox!=2)}}var H0=class i{constructor(e,t){this.adminService=e;this.router=t;this.generateCalendarDays()}currentYear=new Date().getFullYear();currentMonth=new Date().getMonth();currentDay=new Date().getDate();daysOfWeek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];months=["January","February","March","April","May","June","July","August","September","October","November","December"];calendarDays=[];listOfDates=[];events=[];temporaryDate=null;formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}generateCalendarDays(){if(this.router.url.startsWith("/application-form")){let e=new Date(this.currentYear,this.currentMonth,1).getDay(),t=new Date(this.currentYear,this.currentMonth+1,0).getDate(),n=sessionStorage.getItem("eventStart")??"",r=sessionStorage.getItem("eventEnd")??"",s=new Date(n),o=new Date(r);s.setDate(s.getDate()-1),this.calendarDays=[];for(let a=0;a<e;a++){let l=new Date(this.currentYear,this.currentMonth,a);this.calendarDays.push({date:null,checkbox:2,exactDate:l})}for(let a=1;a<=t;a++){let l=new Date(this.currentYear,this.currentMonth,a);l>=s&&l<=o?this.calendarDays.push({date:a,checkbox:1,exactDate:l}):this.calendarDays.push({date:a,checkbox:2,exactDate:l})}}}checkDate(e,t,n){if(this.router.url.startsWith("/application-form")){let r=this.calendarDays.find(s=>s.exactDate===n);if(t==1&&(r&&(r.checkbox=0),this.listOfDates.push(this.formatDate(n.toString()))),t==0){r&&(r.checkbox=1);let s=this.listOfDates.indexOf(n.toString());this.listOfDates.splice(s,1)}console.log(this.listOfDates.toString()),sessionStorage.setItem("listOfDates",this.listOfDates.toString())}}prevMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--,this.generateCalendarDays()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++,this.generateCalendarDays()}handleDayClick(e){e&&console.log(`Clicked date: ${this.currentYear}-${this.currentMonth+1}-${e}`)}ngOnInit(){sessionStorage.setItem("listOfDates","")}static \u0275fac=function(t){return new(t||i)(se(cn),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-calendar-user"]],standalone:!0,features:[gt],decls:12,vars:4,consts:[[1,"w-full","h-full","grid","p-1","bg-white","shadow","rounded-md","overflow-hidden"],[1,"flex","justify-between","items-center","space-x-10","w-full","mb-4","bg-[#006d77]","text-gray-50"],[1,"text-lg","font-bold","px-4","py-2","hover:text-gray-400","rounded",3,"click"],[1,"text-xs","font-bold"],[1,"grid","grid-cols-7","gap-1","text-[8px]","w-full","text-center","font-semibold","text-gray-50"],["class","bg-[#246a73] py-1",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],["class","relative py-2 text-center text-xs h-12 w-full flex flex-col items-center justify-start bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-[#246a73]","py-1"],[1,"relative","py-2","text-center","text-xs","h-12","w-full","flex","flex-col","items-center","justify-start","bg-gray-50"],["class","text-gray-50 w-full bg-[#368f8b] font-bold justify-center align-center border",4,"ngIf"],["class","flex justify-center items-center mt-2",3,"change",4,"ngIf"],[1,"text-gray-50","w-full","bg-[#368f8b]","font-bold","justify-center","align-center","border"],[1,"flex","justify-center","items-center","mt-2",3,"change"],["type","checkbox",1,"md:","cursor-pointer",3,"value","id"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"button",2),H("click",function(){return n.prevMonth()}),_(3," < "),w(),m(4,"span",3),_(5),w(),m(6,"button",2),H("click",function(){return n.nextMonth()}),_(7," > "),w()(),m(8,"div",4),G(9,eY,2,1,"div",5),w(),m(10,"div",6),G(11,iY,3,2,"div",7),w()()),t&2&&(C(5),Mu(" ",n.months[n.currentMonth]," ",n.currentYear," "),C(4),k("ngForOf",n.daysOfWeek),C(2),k("ngForOf",n.calendarDays))},dependencies:[xt,an,kt]})};var Xn=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files";getUser(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-user.php`,t)}getNotification(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-notification.php`,t)}getTransaction(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-transaction.php`,t)}updateMessage(e,t){let n={notificationId:e,status:t};return this.http.post(`${this.apiUrl}/update-message.php`,n)}submitApplication(e){return this.http.post(`${this.apiUrl}/submit-application.php`,e)}submitReference(e,t){let n={formId:e,receiptNumber:t};return this.http.post(`${this.apiUrl}/submitReferenceNumber.php`,n)}static \u0275fac=function(t){return new(t||i)(Te(wo))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var rY=["calendar"],AS=()=>({standalone:!0});function sY(i,e){i&1&&(m(0,"div",77),F(1,"app-calendar-user"),w())}function oY(i,e){i&1&&(m(0,"span",78),_(1,"..."),w())}function aY(i,e){if(i&1&&(m(0,"span",78),_(1),Ti(2,"slice"),G(3,oY,2,0,"span",40),w()),i&2){let t=U();C(),ot("",Hi(2,2,t.loiFileName,0,36)," "),C(2),k("ngIf",t.loiFileName&&t.loiFileName.length>36)}}function lY(i,e){i&1&&(m(0,"span",78),_(1,"Upload a file"),w())}function dY(i,e){i&1&&(m(0,"span",78),_(1,"..."),w())}function cY(i,e){if(i&1&&(m(0,"span",78),_(1),Ti(2,"slice"),G(3,dY,2,0,"span",40),w()),i&2){let t=U();C(),ot("",Hi(2,2,t.businessPermitName,0,8)," "),C(2),k("ngIf",t.businessPermitName&&t.businessPermitName.length>8)}}function uY(i,e){i&1&&(m(0,"span",79),_(1,"Upload an image"),w())}function hY(i,e){i&1&&(m(0,"span",78),_(1,"..."),w())}function fY(i,e){if(i&1&&(m(0,"span",78),_(1),Ti(2,"slice"),G(3,hY,2,0,"span",40),w()),i&2){let t=U();C(),ot("",Hi(2,2,t.mayorsPermitName,0,8)," "),C(2),k("ngIf",t.mayorsPermitName&&t.mayorsPermitName.length>8)}}function pY(i,e){i&1&&(m(0,"span",79),_(1,"Upload an image"),w())}function mY(i,e){i&1&&(m(0,"span",78),_(1,"..."),w())}function gY(i,e){if(i&1&&(m(0,"span",78),_(1),Ti(2,"slice"),G(3,mY,2,0,"span",40),w()),i&2){let t=U();C(),ot("",Hi(2,2,t.sanitaryPermitName,0,8)," "),C(2),k("ngIf",t.sanitaryPermitName&&t.sanitaryPermitName.length>8)}}function vY(i,e){i&1&&(m(0,"span",79),_(1,"Upload an image"),w())}function xY(i,e){if(i&1){let t=Ve();m(0,"input",80),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.othersValue,r)||(s.othersValue=r),ee(r)}),w()}if(i&2){let t=U();Ze("ngModel",t.othersValue),k("ngModelOptions",Mi(2,AS))}}function wY(i,e){if(i&1&&(m(0,"p",81),_(1),w()),i&2){let t=U();C(),ge(t.errorMessage)}}function bY(i,e){if(i&1){let t=Ve();m(0,"div",86)(1,"div",87)(2,"p",88),_(3," Thank you for using our kiosk!, Admin has been notified!"),F(4,"br"),_(5," Select okay to view transaction. "),w()(),m(6,"div",89)(7,"button",90),H("click",function(){$(t);let r=U(2);return ee(r.router.navigate(["/dashboard"]))}),_(8,"Back"),w(),m(9,"button",91),H("click",function(){$(t);let r=U(2);return ee(r.router.navigate(["/transaction"]))}),_(10,"Okay"),w()()()}}function yY(i,e){i&1&&(m(0,"div",92),F(1,"div",93),m(2,"p",94),_(3,"loading..."),w()())}function AY(i,e){if(i&1&&(m(0,"div",82)(1,"div",83),G(2,bY,11,0,"div",84)(3,yY,4,0,"div",85),w()()),i&2){let t=U();C(2),k("ngIf",t.successMessage=="success"),C(),k("ngIf",t.load)}}var z0=class i{constructor(e,t,n,r){this.authService=e;this.router=t;this.userService=n;this.renderer=r}userName="";eventName="";kioskName="";purpose="";loiFile=null;loiFileName="initial";mayorsPermit=null;mayorsPermitName="initial";businessPermit=null;businessPermitName="initial";sanitaryPermit=null;sanitaryPermitName="initial";dateRequested="";successMessage="";errorMessage="";tokenId="";userId="";eventId="";kioskId="";othersValue="";startDate="";endDate="";check1=!1;check2=!1;check3=!1;check4=!1;others=!1;fileChecker=!1;load=!1;calendarVisible=!1;minDate="";maxDate="";numberOfDates=0;listOfDates="";listOfRequirements=[];calendar;ngAfterViewInit(){this.renderer.listen("document","click",e=>this.onClickOutside(e))}dateFormatter(e){let t=new Date(e),n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${n}-${r}-${s}`}onClickOutside(e){this.calendar&&!this.calendar.nativeElement.contains(e.target)&&this.calendarVisible==!0?this.calendarVisible=!1:e.stopPropagation()}ngOnInit(){sessionStorage.setItem("listOfDates",""),this.userName=sessionStorage.getItem("userName")??"",this.eventName=sessionStorage.getItem("eventName")??"",this.kioskName=sessionStorage.getItem("kioskName")??"",this.userId=sessionStorage.getItem("userId")??"",this.kioskId=sessionStorage.getItem("kioskId")??"",this.eventId=sessionStorage.getItem("eventId")??"",this.startDate=sessionStorage.getItem("eventStart")??"",this.endDate=sessionStorage.getItem("eventEnd")??"",this.minDate=this.dateFormatter(this.startDate),this.maxDate=this.dateFormatter(this.endDate)}handleFileChange(e,t){let n=e.target;console.log(t),n&&n.files&&n.files.length>0&&(t=="1"&&(this.loiFile=n.files[0],this.loiFileName=n.files[0].name,console.log("loiFileName")),t=="2"&&(this.businessPermit=n.files[0],this.businessPermitName=n.files[0].name,console.log("businessPermit")),t=="3"&&(this.mayorsPermit=n.files[0],this.mayorsPermitName=n.files[0].name,console.log("mayorsPermit")),t=="4"&&(this.sanitaryPermit=n.files[0],this.sanitaryPermitName=n.files[0].name,console.log("sanitaryPermit"))),this.fileChecker=!1}ngDoCheck(){this.calendarVisible&&(this.listOfDates=sessionStorage.getItem("listOfDates")??"",this.listOfDates?this.numberOfDates=this.listOfDates.split(",").length:this.numberOfDates=0)}checkBox(e){let t=e.target,n=t.checked;if(n&&t.value!="others"&&this.listOfRequirements.push(t.value),!n&&t.value!="others"){let r=this.listOfRequirements.indexOf(t.value);this.listOfRequirements.splice(r,1)}console.log(this.listOfRequirements.toString()),this.fileChecker=!1}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}formatSelectDate(e){let t={year:"numeric",month:"long"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}onSubmit(){if(this.errorMessage="",this.listOfDates=sessionStorage.getItem("listOfDates")??"",this.fileChecker==!1){if(!this.userId||!this.kioskId||!this.eventId||!this.loiFileName||!this.purpose||!this.listOfDates||this.others&&!this.othersValue){this.errorMessage="All fields are required!",this.load=!1;return}let e=new Date,t=new Date(this.dateRequested),n=new Date(this.startDate),r=new Date(this.endDate);if(t<e){this.errorMessage="The requested date must be in the future!",this.load=!1;return}if(console.log(n),console.log(t>=r),console.log(t<=n),t<=n||t>=r){this.errorMessage="The requested date must between "+this.formatDate(this.startDate).toString()+" and "+this.formatDate(this.endDate).toString(),this.load=!1;return}this.listOfRequirements.push(this.othersValue);let s=new FormData;s.append("userId",this.userId),s.append("eventId",this.eventId),s.append("userName",this.userName),s.append("kioskName",this.kioskName),s.append("kioskId",this.kioskId),s.append("rentDate",this.listOfDates),s.append("requirements",this.listOfRequirements.toString()),s.append("purpose",this.purpose),this.loiFile&&s.append("loi",this.loiFile,this.loiFile.name),this.businessPermit&&s.append("businessPermit",this.businessPermit,this.businessPermit.name),this.mayorsPermit&&s.append("mayorsPermit",this.mayorsPermit,this.mayorsPermit.name),this.sanitaryPermit&&s.append("sanitaryPermit",this.sanitaryPermit,this.sanitaryPermit.name),this.load=!0,this.userService.submitApplication(s).subscribe({next:o=>{this.load=!1,console.log(o.message,o.success),o.success&&(this.successMessage="success",ps.send("service_l1qrwc6","template_bm2axpf",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",from_kiosk:this.kioskName,from_event:this.eventName,from_email:sessionStorage.getItem("email")??"",submission_date:new Date().toLocaleString()},"Tv0xOXxLvWH60MEV_").then(a=>{console.log("Email sent successfully!",a.text)}).catch(a=>{console.error("Email sending failed:",a)}),this.resetForm())},error:o=>{this.errorMessage="Error submitting the application. Please try again.",console.error(o)}})}}backMap(){sessionStorage.removeItem("kioskId"),sessionStorage.removeItem("kioskName"),this.router.navigate(["/map-viewer"])}resetForm(){sessionStorage.removeItem("eventId"),sessionStorage.removeItem("kioskId"),sessionStorage.removeItem("eventName"),sessionStorage.removeItem("kioskName"),this.userName="",this.eventName="",this.kioskName="",this.purpose="",this.loiFile=null,this.loiFileName="",this.dateRequested="",this.tokenId="",this.userId="",this.eventId="",this.kioskId=""}static \u0275fac=function(t){return new(t||i)(se(ui),se(Qe),se(Xn),se(Ei))};static \u0275cmp=ft({type:i,selectors:[["app-application-form"]],viewQuery:function(t,n){if(t&1&&qn(rY,5),t&2){let r;Rn(r=Ln())&&(n.calendar=r.first)}},standalone:!0,features:[gt],decls:157,vars:28,consts:[["calendar",""],["fileInput",""],["fileInputBusiness",""],["fileInputMayors",""],["fileInputSanitary",""],[1,"h-full","flex","items-center","justify-center","overflow-hidden","px-2"],[1,"grid","grid-cols-1","md:grid-cols-2","items-start","shadow-bottom","shadow-black","pt-24","min-h-screen-sm","w-full","md:max-w-screen-xl","md:rounded-l-xl"],[1,"justify-center","items-center","h-full","w-full","bg-gray-50"],["src","assets/images/rulesRegulation.jpg",1,"size-full","md:rounded-l-xl","object-full","object-center"],[1,"h-full","w-full","md:px-5","px-2","py-2","justify-center","items-center","bg-customDarkGreen","rounded-r-none","md:rounded-r-xl"],[1,"w-full","h-28","md:pt-0","pt-8","flex","flex-col","px-16","items-center","md:flex-row","md:justify-center","md:top-0","top-8:-left-0","md:-left-4","relative"],[1,"w-[100%]","md:w-[100%]","h-16","pt-5","border-b-4","px-4","md:px-20","relative"],[1,"size-8","bg-gray-50","rounded-full","absolute","top-[4.8rem]","md:top-[4.4rem]","right-[2rem]","md:right-[2rem]"],[1,"relative","text-md","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold","leading-none"],[1,"text-xs","text-gray-50"],[1,"size-5","bg-green-300","rounded-full","absolute","top-[5.2rem]","md:top-[4.8rem]","left-1/2","md:left-1/2"],[1,"relative","text-sm","w-40","text-center","-top-10","-left-[4.0rem]","lg:-left-16","text-white","font-bold","leading-none"],[1,"text-xs","text-gray-300"],[1,"size-5","bg-green-300","rounded-full","absolute","top-[5.2rem]","md:top-[4.8rem]","left-12","md:left-12"],[1,"relative","text-sm","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold","leading-none"],[1,"text-center","text-3xl","text-gray-50","md:pt-0","pt-10"],[1,"pt-4","px-4","space-y-2","h-full","pb-10",3,"ngSubmit"],[1,"form-group","col-span-1","pt-2"],[1,"text-white"],["readonly","","type","text","id","userName","name","userName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],[1,"grid","grid-cols-2","gap-x-2"],[1,"form-group","col-span-1"],["readonly","","type","text","id","eventName","name","eventName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],["readonly","","type","text","id","kioskName","name","kioskName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],[1,"form-group","col-span-1","hidden"],["type","date","id","dateRequested","name","dateRequested","required","","placeholder","Date requested",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","max","min","ngModelOptions"],[1,"form-group","col-span-1","w-full"],[1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","bg-gray-50","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","justify-between","items-center",3,"click"],[1,""],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-4"],["d","M6 2a1 1 0 011 1v1h10V3a1 1 0 112 0v1h1.5A2.5 2.5 0 0123 6.5v15A2.5 2.5 0 0120.5 24h-17A2.5 2.5 0 011 21.5v-15A2.5 2.5 0 013.5 4H5V3a1 1 0 011-1zM4 8v13.5c0 .275.225.5.5.5h17a.5.5 0 00.5-.5V8H4zm2-2h12V5H6v1z"],["x","12","y","16","font-size","8","text-anchor","middle","fill","black"],["class","z-[1000] mt-1 absolute flex ",4,"ngIf"],["type","text","id","purpose","name","purpose","required","","placeholder","Purpose",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","ngModelOptions"],[1,"relative","h-12","bg-white","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","loiFile","accept",".pdf","name","loiFile","required","",1,"hidden",3,"change"],[1,"grid","grid-cols-3","gap-x-2"],[1,"flex","flex-col"],[1,"relative","h-12","bg-white","rounded-xl","text-xs","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700 text-[8px] md:text-xs leading-none",4,"ngIf"],["type","file","accept","image/*","id","businessPermit","name","businessPermit","required","",1,"hidden",3,"change"],["type","file","accept","image/*","id","mayorsPermit","name","mayorsPermit","required","",1,"hidden",3,"change"],["accept","image/*","type","file","id","loi","name","loi","required","",1,"hidden",3,"change"],[1,"flex","flex-col","items-start","mt-2","bg-gray-50","px-4","py-2","rounded-xl"],[1,"flex","justify-center","align-center","h-7"],["for","check1",1,"flex","items-center","cursor-pointer","relative"],["type","checkbox","value","Tables, and Chairs","id","check1",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-black","checked:bg-slate-800","checked:border-slate-800",3,"change"],[1,"absolute","text-white","opacity-0","peer-checked:opacity-100","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","stroke","currentColor","stroke-width","1",1,"h-3.5","w-3.5"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["for","check1",1,"cursor-pointer","ml-2","text-black","text-sm","align-center","m-auto"],["for","check2",1,"flex","items-center","cursor-pointer","relative"],["type","checkbox","value","Canopy","id","check2",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-black","checked:bg-slate-800","checked:border-slate-800",3,"change"],["for","check2",1,"cursor-pointer","ml-2","text-black","text-sm","align-center","m-auto"],["for","check3",1,"flex","items-center","cursor-pointer","relative"],["type","checkbox","value","Partitions","id","check3",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-black","checked:bg-slate-800","checked:border-slate-800",3,"change"],["for","check3",1,"cursor-pointer","ml-2","text-black","text-sm","align-center","m-auto"],["for","check4",1,"flex","items-center","cursor-pointer","relative"],["type","checkbox","value","Pegboards, Hooks, or Stands","id","check4",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-black","checked:bg-slate-800","checked:border-slate-800",3,"change"],["for","check4",1,"cursor-pointer","ml-2","text-black","text-sm","align-center","m-auto"],["for","others",1,"flex","items-center","cursor-pointer","relative"],["type","checkbox","value","others","id","others",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-black","checked:bg-slate-800","checked:border-slate-800",3,"change"],["for","others",1,"cursor-pointer","ml-2","text-black","text-sm","align-center","m-auto"],["type","text","id","othersValue","name","othersValue","required","","placeholder","Others","class","ml-2 h-full rounded-md text-sm px-2 py-2 w-full border border-black focus:outline-none focus:ring-[1px] focus:ring-customSkyBlue",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"form-group","col-span-2","h-2","py-4"],["class","text-center text-red-700 text-sm ",4,"ngIf"],[1,"form-group","col-span-2","py-1","flex","justify-between"],[1,"h-12","w-32","rounded-xl","text-white","text-sm","px-4","py-2","bg-red-400","hover:bg-red-600","border","border-gray-300","focus:outline-none","hover:ring-[3px]","hover:ring-red-300",3,"click"],["type","submit","id","submit","name","submit",1,"h-12","w-32","rounded-xl","text-white","text-sm","px-4","py-2","bg-green-800","hover:bg-green-900","border","border-gray-300","focus:outline-none","hover:ring-[3px]","hover:ring-green-300"],["class","max-w-screen-lg",4,"ngIf"],[1,"z-[1000]","mt-1","absolute","flex"],[1,"text-gray-700"],[1,"text-gray-700","text-[8px]","md:text-xs","leading-none"],["type","text","id","othersValue","name","othersValue","required","","placeholder","Others",1,"ml-2","h-full","rounded-md","text-sm","px-2","py-2","w-full","border","border-black","focus:outline-none","focus:ring-[1px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","ngModelOptions"],[1,"text-center","text-red-700","text-sm"],[1,"max-w-screen-lg"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","animate-fadeIn absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"animate-fadeIn","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"]],template:function(t,n){if(t&1){let r=Ve();m(0,"div",5)(1,"div",6)(2,"div",7),F(3,"img",8),w(),m(4,"div",9)(5,"div",10),F(6,"div",11),m(7,"div",12)(8,"p",13),_(9," STEP 3 "),m(10,"span",14),F(11,"br"),_(12,"Application"),w()()(),m(13,"div",15)(14,"p",16),_(15," STEP 2 "),m(16,"span",17),F(17,"br"),_(18,"Kiosk Selection"),w()()(),m(19,"div",18)(20,"p",19),_(21," STEP 1 "),m(22,"span",17),F(23,"br"),_(24,"Event Selection"),w()()()(),m(25,"h6",20),_(26,"Application form"),w(),m(27,"form",21),H("ngSubmit",function(){return $(r),ee(n.onSubmit())}),m(28,"div",22)(29,"label",23),_(30,"Username*"),w(),m(31,"input",24),Ye("ngModelChange",function(o){return $(r),Xe(n.userName,o)||(n.userName=o),ee(o)}),w()(),m(32,"div",25)(33,"div",26)(34,"label",23),_(35,"Event Name*"),w(),m(36,"input",27),Ye("ngModelChange",function(o){return $(r),Xe(n.eventName,o)||(n.eventName=o),ee(o)}),w()(),m(37,"div",26)(38,"label",23),_(39,"Kiosk Name*"),w(),m(40,"input",28),Ye("ngModelChange",function(o){return $(r),Xe(n.kioskName,o)||(n.kioskName=o),ee(o)}),w()()(),m(41,"div",29)(42,"label",23),_(43,"Date Requested*"),w(),m(44,"input",30),Ye("ngModelChange",function(o){return $(r),Xe(n.dateRequested,o)||(n.dateRequested=o),ee(o)}),w()(),m(45,"div",31,0)(47,"label",23),_(48,"Days to Rent*"),w(),m(49,"button",32),H("click",function(){return $(r),n.fileChecker=!0,n.calendarVisible=!n.calendarVisible,ee(n.fileChecker=!1)}),m(50,"p"),_(51),w(),m(52,"div",33),ie(),m(53,"svg",34),F(54,"path",35),m(55,"text",36),_(56),w()()()(),G(57,sY,2,0,"div",37),w(),Je(),m(58,"div",26)(59,"label",23),_(60,"Purpose*"),w(),m(61,"input",38),Ye("ngModelChange",function(o){return $(r),Xe(n.purpose,o)||(n.purpose=o),ee(o)}),w()(),m(62,"div",26)(63,"label",23),_(64,"Letter Of Intent*"),w(),m(65,"div",39),H("click",function(){$(r);let o=Ki(71);return n.fileChecker=!0,ee(o.click())}),G(66,aY,4,6,"span",40)(67,lY,2,0,"span",40),m(68,"button",41),_(69," Browse "),w()(),m(70,"input",42,1),H("change",function(o){return $(r),n.fileChecker=!0,ee(n.handleFileChange(o,"1"))}),w()(),m(72,"div",26)(73,"div",43)(74,"div",44)(75,"label",23),_(76,"Business Permit"),w(),m(77,"div",45),H("click",function(){$(r);let o=Ki(83);return n.fileChecker=!0,ee(o.click())}),G(78,cY,4,6,"span",40)(79,uY,2,0,"span",46),m(80,"button",41),_(81," Browse "),w()(),m(82,"input",47,2),H("change",function(o){return $(r),n.fileChecker=!0,ee(n.handleFileChange(o,"2"))}),w()(),m(84,"div",44)(85,"label",23),_(86,"Mayors Permit"),w(),m(87,"div",45),H("click",function(){$(r);let o=Ki(93);return n.fileChecker=!0,ee(o.click())}),G(88,fY,4,6,"span",40)(89,pY,2,0,"span",46),m(90,"button",41),_(91," Browse "),w()(),m(92,"input",48,3),H("change",function(o){return $(r),n.fileChecker=!0,ee(n.handleFileChange(o,"3"))}),w()(),m(94,"div",44)(95,"label",23),_(96,"Sanitary Permit"),w(),m(97,"div",45),H("click",function(){$(r);let o=Ki(103);return n.fileChecker=!0,ee(o.click())}),G(98,gY,4,6,"span",40)(99,vY,2,0,"span",46),m(100,"button",41),_(101," Browse "),w()(),m(102,"input",49,4),H("change",function(o){return $(r),n.fileChecker=!0,ee(n.handleFileChange(o,"4"))}),w()()()(),m(104,"div",26)(105,"label",23),_(106,"Things to bring "),w(),m(107,"div",50)(108,"div",51)(109,"label",52)(110,"input",53),H("change",function(o){return $(r),n.checkBox(o),ee(n.check1=!n.check1)}),w(),m(111,"span",54),ie(),m(112,"svg",55),F(113,"path",56),w()()(),Je(),m(114,"label",57),_(115," Tables, and Chairs "),w()(),m(116,"div",51)(117,"label",58)(118,"input",59),H("change",function(o){return $(r),n.checkBox(o),ee(n.check2=!n.check2)}),w(),m(119,"span",54),ie(),m(120,"svg",55),F(121,"path",56),w()()(),Je(),m(122,"label",60),_(123," Canopy "),w()(),m(124,"div",51)(125,"label",61)(126,"input",62),H("change",function(o){return $(r),n.checkBox(o),ee(n.check3=!n.check3)}),w(),m(127,"span",54),ie(),m(128,"svg",55),F(129,"path",56),w()()(),Je(),m(130,"label",63),_(131," Partitions "),w()(),m(132,"div",51)(133,"label",64)(134,"input",65),H("change",function(o){return $(r),n.checkBox(o),ee(n.check4=!n.check4)}),w(),m(135,"span",54),ie(),m(136,"svg",55),F(137,"path",56),w()()(),Je(),m(138,"label",66),_(139," Pegboards, Hooks, or Stands "),w()(),m(140,"div",51)(141,"label",67)(142,"input",68),H("change",function(o){return $(r),n.checkBox(o),ee(n.others=!n.others)}),w(),m(143,"span",54),ie(),m(144,"svg",55),F(145,"path",56),w()()(),Je(),m(146,"label",69),_(147," Others "),w(),G(148,xY,1,3,"input",70),w()()(),m(149,"div",71),G(150,wY,2,1,"p",72),w(),m(151,"div",73)(152,"button",74),H("click",function(){return $(r),ee(n.backMap())}),_(153," Back "),w(),m(154,"button",75),_(155," Submit "),w()()()()()(),G(156,AY,4,2,"div",76)}t&2&&(C(31),ls("placeholder",n.userName),Ze("ngModel",n.userName),C(5),ls("placeholder",n.eventName),Ze("ngModel",n.eventName),C(4),ls("placeholder",n.kioskName),Ze("ngModel",n.kioskName),C(4),Ze("ngModel",n.dateRequested),k("max",n.maxDate)("min",n.minDate)("ngModelOptions",Mi(26,AS)),C(7),ot(" ",n.numberOfDates," Days "),C(5),ot(" ",n.numberOfDates," "),C(),k("ngIf",n.calendarVisible),C(4),Ze("ngModel",n.purpose),k("ngModelOptions",Mi(27,AS)),C(5),k("ngIf",n.loiFile),C(),k("ngIf",!n.loiFile),C(11),k("ngIf",n.businessPermit),C(),k("ngIf",!n.businessPermit),C(9),k("ngIf",n.mayorsPermit),C(),k("ngIf",!n.mayorsPermit),C(9),k("ngIf",n.sanitaryPermit),C(),k("ngIf",!n.sanitaryPermit),C(49),k("ngIf",n.others),C(2),k("ngIf",n.errorMessage),C(6),k("ngIf",n.successMessage=="success"||n.load))},dependencies:[vn,Fr,_n,Sn,Nr,_o,yn,pr,xt,kt,Lr,H0],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var _Y=(i,e,t,n)=>({"text-green-300":i,"text-orange-300":e,"text-red-300":t,"text-yellow-300":n});function SY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",29)(2,"line",30)(3,"line",31),w())}function EY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",32)(2,"line",33)(3,"line",34),w())}function CY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",29)(2,"line",30)(3,"line",31),w())}function MY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",32)(2,"line",33)(3,"line",34),w())}function TY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",29)(2,"line",30)(3,"line",31),w())}function IY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",32)(2,"line",33)(3,"line",34),w())}function DY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",29)(2,"line",30)(3,"line",31),w())}function PY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",32)(2,"line",33)(3,"line",34),w())}function RY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",29)(2,"line",30)(3,"line",31),w())}function LY(i,e){i&1&&(ie(),m(0,"svg",28),F(1,"path",32)(2,"line",33)(3,"line",34),w())}function kY(i,e){i&1&&(m(0,"div",35)(1,"div",36),_(2,"No results found"),w()())}function NY(i,e){if(i&1){let t=Ve();m(0,"button",45),H("click",function(){$(t);let r=U().$implicit,s=U();return s.referenceNumber=!s.referenceNumber,ee(s.formId=r.form_id)}),ie(),m(1,"svg",46),F(2,"path",47)(3,"polygon",48),w()()}}function FY(i,e){i&1&&(m(0,"p",49),_(1,"(Missed Date)"),w())}function OY(i,e){if(i&1){let t=Ve();m(0,"button",50),H("click",function(){$(t);let r=U().$implicit,s=U();return ee(s.downloadForm(r.form_id))}),_(1," Download forms "),w()}}function BY(i,e){i&1&&(m(0,"div",51),_(1," Not scheduled "),w())}function VY(i,e){if(i&1&&(m(0,"div",37)(1,"div",17),_(2),w(),m(3,"div",17),_(4),w(),m(5,"div",17),_(6),w(),m(7,"div",38),_(8),w(),m(9,"div",39),G(10,NY,4,0,"button",40),_(11),G(12,FY,2,0,"p",41),w(),m(13,"div",42),G(14,OY,2,0,"button",43)(15,BY,2,0,"div",44),w()()),i&2){let t=e.$implicit,n=U();C(2),ot("",n.formatDate(t.date_created)," "),C(2),ge(t.event_name),C(2),ge(t.kiosk_name),C(2),ot("",t.purpose?t.purpose:"----"," "),C(),k("ngClass",eD(10,_Y,t.status==="finished"||t.status==="approved",t.status==="pending",t.status==="denied"||n.dateVerifier(t.date_req),t.status==="paid")),C(),k("ngIf",t.status==="pending"),C(),ot(" ",n.statusViewer(t.status)," "),C(),k("ngIf",n.dateVerifier(t.date_req)&&t.date_req!="0000-00-00 00:00:00"&&t.status=="approved"),C(2),k("ngIf",t.date_req!="0000-00-00 00:00:00"),C(),k("ngIf",t.date_req=="0000-00-00 00:00:00")}}function UY(i,e){if(i&1){let t=Ve();m(0,"div",56)(1,"div",57)(2,"p",58),_(3," Thank you for paying, reference number is already submitted! "),w()(),m(4,"div",59)(5,"button",60),H("click",function(){$(t);let r=U(2);return r.checkerReference=!1,ee(r.changeValue())}),_(6,"Okay "),w()()()}}function HY(i,e){if(i&1){let t=Ve();m(0,"div",61)(1,"div",57)(2,"p",58),_(3," Error please input valid reference number! "),w()(),m(4,"div",59)(5,"button",60),H("click",function(){$(t);let r=U(2);return r.errorMessage="",r.checkerReference=!1,ee(r.referenceNumber=!0)}),_(6,"Okay "),w()()()}}function zY(i,e){if(i&1){let t=Ve();m(0,"div",61)(1,"div",57)(2,"p",58),_(3," Are you sure your Reference Number: "),m(4,"b"),_(5),w(),_(6," is correct ? "),w()(),m(7,"div",62)(8,"button",63),H("click",function(){$(t);let r=U(2);return r.checkerReference=!1,ee(r.referenceNumber=!0)}),_(9,"No "),w(),m(10,"button",64),H("click",function(){$(t);let r=U(2);return ee(r.submitReference())}),_(11,"Yes"),w()()()}if(i&2){let t=U(2);C(5),ge(t.reference)}}function jY(i,e){if(i&1){let t=Ve();m(0,"div",65)(1,"div",57)(2,"div",66)(3,"p",67),_(4,"Please input your"),m(5,"b"),_(6," Reference Number "),w(),F(7,"br"),_(8,"in the field provided!"),w(),m(9,"input",68),Ye("ngModelChange",function(r){$(t);let s=U(2);return Xe(s.reference,r)||(s.reference=r),ee(r)}),w()()(),m(10,"div",62)(11,"button",63),H("click",function(){$(t);let r=U(2);return r.referenceNumber=!1,ee(r.reference="")}),_(12,"Cancel"),w(),m(13,"button",64),H("click",function(){$(t);let r=U(2);return r.checkerReference=!r.checkerReference,r.referenceNumber=!r.referenceNumber,ee(r.reference=r.reference)}),_(14,"Submit"),w()()()}if(i&2){let t=U(2);C(9),Ze("ngModel",t.reference)}}function GY(i,e){if(i&1&&(m(0,"div")(1,"div",52),G(2,UY,7,0,"div",53),w(),G(3,HY,7,0,"div",54)(4,zY,12,1,"div",54)(5,jY,15,1,"div",55),w()),i&2){let t=U();C(2),k("ngIf",t.errorMessage=="none"),C(),k("ngIf",t.errorMessage=="error"),C(),k("ngIf",t.checkerReference),C(),k("ngIf",t.referenceNumber)}}var j0=class i{constructor(e,t,n){this.router=e;this.userService=t;this.eventService=n}userTransaction=[];eventData=[];kioskData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascStatus=!1;ascEvent=!1;ascKiosk=!1;reference="";checkerReference=!1;ascPurpose=!1;ascDate=!1;referenceNumber=!1;formId="";errorMessage="";submitReference(){!this.formId||!this.reference?this.errorMessage="error":this.userService.submitReference(this.formId,this.reference).subscribe(e=>{e.success&&(sessionStorage.setItem("errorMessageTransac","none"),this.errorMessage="none",ps.send("service_yb4nng9","template_5dtjkq9",{referenceNumber:this.reference,from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(t=>{console.log("Email sent successfully!",t.text),window.location.reload()}))})}getTransaction(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getTransaction(this.token).subscribe(e=>{this.userTransaction=e})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getKioskName(e){let t=this.kioskData.find(n=>n.kiosk_id==e);return t?t.kiosk_name:"Unknown Kiosk"}getKiosk(){this.eventService.getKiosk().subscribe(e=>{this.kioskData=e})}getEvent(){this.eventService.getEvents().subscribe(e=>{this.eventData=e})}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}dateVerifier(e){let t=new Date,n=new Date(e),r=new Date(n);return r.setDate(r.getDate()+3),t>r}toLowerCaseSafe(e){return e?e.toLowerCase():""}getTransactionsToDisplay(){let e=this.userTransaction.filter(r=>this.toLowerCaseSafe(this.formatDate(r.date_created)).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.kiosk_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.purpose).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userTransaction.length&&(console.log(this.userTransaction.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.firstName=sessionStorage.getItem("firstName")??"",this.lastName=sessionStorage.getItem("lastName")??"",this.eventService.downloadForm(e,this.firstName,this.lastName)}statusViewer(e){return e=="approved"?"Approved":e=="pending"?"Booked":e=="finished"?"Completed":e=="paid"?e:"Cancelled"}changeValue(){this.errorMessage="",sessionStorage.setItem("errorMessageTransac","")}ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.errorMessage=sessionStorage.getItem("errorMessageTransac")??"",this.getEvent(),this.getKiosk(),this.getTransaction()}static \u0275fac=function(t){return new(t||i)(se(Qe),se(Xn),se(ci))};static \u0275cmp=ft({type:i,selectors:[["app-transaction"]],standalone:!0,features:[gt],decls:75,vars:17,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","pt-24","md:px-8","text-black"],[1,"block"],[1,"flex","justify-between","h-full","w-full","px-1","md:px-8","items-center"],[1,"bg-green-200","size-28","md:size-36","px-2","text-center","rounded-xl","shadow-md","shadow-gray-500","justify-center","grid","items-center","leading-none"],[1,"md:text-8xl","text-7xl","text-gray-600"],[1,"md:text-md","text-sm","text-gray-600","font-bold"],[1,"bg-green-200","size-28","md:size-36","px-2","text-center","rounded-xl","shadow-md","shadow-gray-500","justify-center","grid","items-center"],[1,"md:text-md","text-sm","text-gray-600","font-bold","w-full"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1"],[1,"text-gray-700","text-xl","md:text-2xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","leading-none","grid-cols-6","bg-customDarkGreen","text-center","w-full","h-full","px-1","md:px-2","py-2","text-[10px]","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","class","svgTable","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"border-r-2","border-green-900","col-span-2","flex","justify-center","items-center"],[1,"block",3,"click"],[1,"w-full","flex","justify-center","items-center"],[1,"hidden","justify-center","items-center"],["class","grid grid-cols-6 overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngIf"],["class","grid grid-cols-6 overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-[10px] md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"svgTable"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-6","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-md","col-span-7","md:text-lg","flex","justify-center","items-center"],[1,"grid","grid-cols-6","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","md:text-lg","font-semibold","text-gray-200"],[1,"flex","justify-center","col-span-2","items-center"],[1,"flex","flex-col","justify-center","items-center",3,"ngClass"],["class","pr-2",3,"click",4,"ngIf"],["class","text-red-300",4,"ngIf"],[1,"hidden","justify-between","items-center"],["class","bg-green-800 h-8 w-full text-xs md:text-sm rounded-lg hover:bg-green-900 hover:text-white",3,"click",4,"ngIf"],["class","flex justify-center items-center bg-green-800 h-8 w-full text-xs md:text-sm rounded-lg ",4,"ngIf"],[1,"pr-2",3,"click"],["width","18px","height","18px","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M20,16v4a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4H8","fill","none","stroke","#ffe5ec","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["fill","none","points","12.5 15.8 22 6.2 17.8 2 8.3 11.5 8 16 12.5 15.8","stroke","#ffe5ec","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"text-red-300"],[1,"bg-green-800","h-8","w-full","text-xs","md:text-sm","rounded-lg","hover:bg-green-900","hover:text-white",3,"click"],[1,"flex","justify-center","items-center","bg-green-800","h-8","w-full","text-xs","md:text-sm","rounded-lg"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-1/4 left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],[1,"overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-1/4","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"block","w-80"],[1,"text-lg","text-center","text-gray-200","pb-4"],["type","text","placeholder","Reference Number:","name","reference",1,"w-full","h-12","rounded-lg","outline-none","px-2",3,"ngModelChange","ngModel"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),_(5),w(),m(6,"div",5),_(7,"PAID"),w()(),m(8,"div",6)(9,"div",4),_(10),w(),m(11,"div",7),_(12,"FINISHED"),w()(),m(13,"div",6)(14,"div",4),_(15),w(),m(16,"div",7),_(17,"TRANSACTION"),w()()(),m(18,"div",8)(19,"div",9)(20,"p"),_(21," Transaction History:"),w()(),m(22,"div",10),ie(),m(23,"svg",11)(24,"g")(25,"g"),F(26,"path",12),w()()(),Je(),m(27,"input",13),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(28,"div",14)(29,"div",15)(30,"button",16),H("click",function(){return n.onSortChange("date_req"),n.ascDate=!n.ascDate}),m(31,"div",17),G(32,SY,4,0,"svg",18)(33,EY,4,0,"svg",18),m(34,"p"),_(35,"Date"),w()()()(),m(36,"div",15)(37,"button",16),H("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),m(38,"div",17),G(39,CY,4,0,"svg",18)(40,MY,4,0,"svg",18),m(41,"p"),_(42,"Event"),w()()()(),m(43,"div",15)(44,"button",16),H("click",function(){return n.onSortChange("kiosk_name"),n.ascKiosk=!n.ascKiosk}),m(45,"div",17),G(46,TY,4,0,"svg",18)(47,IY,4,0,"svg",18),m(48,"p"),_(49,"Kiosk"),w()()()(),m(50,"div",19)(51,"button",20),H("click",function(){return n.onSortChange("purpose"),n.ascPurpose=!n.ascPurpose}),m(52,"div",17),G(53,DY,4,0,"svg",18)(54,PY,4,0,"svg",18),m(55,"p"),_(56,"Purpose"),w()()()(),m(57,"div",21)(58,"button",16),H("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),m(59,"div",17),G(60,RY,4,0,"svg",18)(61,LY,4,0,"svg",18),m(62,"p"),_(63,"Status"),w()()()(),m(64,"div",22),_(65,"Forms"),w()(),G(66,kY,3,0,"div",23)(67,VY,16,15,"div",24),m(68,"div",25)(69,"button",26),H("click",function(){return n.prevTransaction()}),_(70," Prev "),w(),m(71,"button",26),H("click",function(){return n.nextTransaction()}),_(72," Next "),w()()(),F(73,"div"),G(74,GY,6,4,"div",27),w()),t&2&&(C(5),ge(n.counterPaid(n.userTransaction)),C(5),ge(n.counterFinished(n.userTransaction)),C(5),ge(n.userTransaction.length),C(12),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascDate),C(),k("ngIf",!n.ascDate),C(6),k("ngIf",n.ascEvent),C(),k("ngIf",!n.ascEvent),C(6),k("ngIf",n.ascKiosk),C(),k("ngIf",!n.ascKiosk),C(6),k("ngIf",n.ascPurpose),C(),k("ngIf",!n.ascPurpose),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(5),k("ngIf",n.getTransactionsToDisplay().length==0),C(),k("ngForOf",n.getTransactionsToDisplay()),C(7),k("ngIf",n.errorMessage=="none"||n.errorMessage=="error"||n.checkerReference||n.referenceNumber))},dependencies:[xt,Ji,an,kt,vn,_n,Sn,yn],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.svgTable[_ngcontent-%COMP%]{height:1rem;width:1rem}@media (min-width: 768px){.svgTable[_ngcontent-%COMP%]{height:2rem;width:2rem}}"]})};var G0=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isSelectedEvent()?!0:(this.router.navigate(["/dashboard"]),!1)}static \u0275fac=function(t){return new(t||i)(Te(ui),Te(Qe))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var W0=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isApplied()?!0:(this.router.navigate(["/dashboard"]),!1)}static \u0275fac=function(t){return new(t||i)(Te(ui),Te(Qe))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};function WY(i,e){if(i&1&&(m(0,"div",9),_(1),w()),i&2){let t=e.$implicit;C(),ge(t)}}function qY(i,e){if(i&1&&(m(0,"div",13),_(1),w()),i&2){let t=U().$implicit;C(),ot(" ",t.date," ")}}function ZY(i,e){if(i&1&&(m(0,"div",14)(1,"div",15),_(2),w()()),i&2){let t=e.$implicit;C(2),ot(" ",t.title," ")}}function YY(i,e){if(i&1&&(m(0,"div",10),G(1,qY,2,1,"div",11)(2,ZY,3,1,"div",12),w()),i&2){let t=e.$implicit;C(),k("ngIf",t.date),C(),k("ngForOf",t.events)}}var q0=class i{constructor(e){this.adminService=e;this.generateCalendarDays()}currentYear=new Date().getFullYear();currentMonth=new Date().getMonth();daysOfWeek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];months=["January","February","March","April","May","June","July","August","September","October","November","December"];calendarDays=[];events=[];fetchEvents(){this.adminService.getEvent().subscribe(e=>{this.events=e.map(t=>{let n=new Date(t.event_start);return n.setDate(n.getDate()-1),{title:t.event_name,startDate:n,endDate:new Date(t.event_end),color:"bg-blue-500"}}),this.generateCalendarDays()})}generateCalendarDays(){let e=new Date(this.currentYear,this.currentMonth,1).getDay(),t=new Date(this.currentYear,this.currentMonth+1,0).getDate();this.calendarDays=[];for(let n=0;n<e;n++)this.calendarDays.push({date:null,events:[]});for(let n=1;n<=t;n++){let r=new Date(this.currentYear,this.currentMonth,n),s=this.events.filter(o=>r>=o.startDate&&r<=o.endDate);this.calendarDays.push({date:n,events:s})}}prevMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--,this.generateCalendarDays()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++,this.generateCalendarDays()}handleDayClick(e){e&&console.log(`Clicked date: ${this.currentYear}-${this.currentMonth+1}-${e}`)}getEventCenterPosition(e,t){if(!e)return null;let n=t.startDate.getDate(),r=t.endDate.getDate();return e%2===0?(n+r)/2:null}isEventMiddle(e,t){if(!e)return!1;let n=t.startDate.getDate(),r=t.endDate.getDate();return Math.floor((n+r)/2)===e}ngOnInit(){this.fetchEvents()}static \u0275fac=function(t){return new(t||i)(se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-calendar"]],standalone:!0,features:[gt],decls:15,vars:4,consts:[[1,"w-full","max-w-full","p-4","bg-white","shadow","rounded-3xl"],[1,"text-gray-700","text-2xl"],[1,"flex","justify-between","items-center","mt-4","mb-4","bg-[#006d77]","text-gray-50"],[1,"text-lg","font-bold","px-4","py-2","hover:text-gray-400","rounded",3,"click"],[1,"text-xl","font-bold"],[1,"grid","grid-cols-7","gap-1","text-center","font-semibold","text-gray-50"],["class","bg-[#246a73] py-1  md:px-2",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],["class","relative py-2 text-center text-xs sm:text-sm md:text-md h-20 w-full flex flex-col items-center justify-start bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-[#246a73]","py-1","md:px-2"],[1,"relative","py-2","text-center","text-xs","sm:text-sm","md:text-md","h-20","w-full","flex","flex-col","items-center","justify-start","bg-gray-50"],["class","text-gray-50 w-full bg-[#368f8b] font-bold justify-center align-center border  ",4,"ngIf"],["class","text-gray-50 font-bold w-full flex-col justify-self-center align-center bg-[#3c6e71] mt-4",4,"ngFor","ngForOf"],[1,"text-gray-50","w-full","bg-[#368f8b]","font-bold","justify-center","align-center","border"],[1,"text-gray-50","font-bold","w-full","flex-col","justify-self-center","align-center","bg-[#3c6e71]","mt-4"],[1,"h-6","font-bold","md:text-sm","text-[7px]","text-gray-50","bg-[#3c6e71]"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"p",1),_(2,"Event Calendar"),w(),F(3,"hr"),m(4,"div",2)(5,"button",3),H("click",function(){return n.prevMonth()}),_(6,"<"),w(),m(7,"span",4),_(8),w(),m(9,"button",3),H("click",function(){return n.nextMonth()}),_(10,">"),w()(),m(11,"div",5),G(12,WY,2,1,"div",6),w(),m(13,"div",7),G(14,YY,3,2,"div",8),w()()),t&2&&(C(8),Mu("",n.months[n.currentMonth]," ",n.currentYear,""),C(4),k("ngForOf",n.daysOfWeek),C(2),k("ngForOf",n.calendarDays))},dependencies:[xt,an,kt],styles:[".calendar[_ngcontent-%COMP%]{width:300px;margin:20px auto;font-family:Arial,sans-serif}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function XY(i,e){i&1&&(m(0,"div",35)(1,"div",36)(2,"div",37),F(3,"div",38),m(4,"p",39),_(5,"Events"),w()()()())}function QY(i,e){if(i&1&&(m(0,"div",40)(1,"div",36),F(2,"img",41),w()()),i&2){let t=e.$implicit,n=U();C(2),k("src",n.urlImage+t.event_image,ai)}}var Z0=class i{constructor(e,t){this.adminService=e;this.router=t}events=[];kiosk=[];user=[];transaction=[];urlImage="https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/";ngOnInit(){sessionStorage.getItem("runOnce")=="false"&&(sessionStorage.setItem("runOnce","true"),window.location.reload()),this.fetchTransaction(),this.fetchEvents(),this.fetchUser(),this.fetchKiosk()}getAvailableKioskCount(){return this.kiosk.filter(e=>e.status==="available").length}getUnavailableKioskCount(){return this.kiosk.filter(e=>e.status==="unavailable").length}fetchTransaction(){this.adminService.getTransaction().subscribe(e=>{this.transaction=e})}fetchEvents(){this.adminService.getEvent().subscribe(e=>{this.events=e})}fetchUser(){this.adminService.getUsers().subscribe(e=>{this.user=e})}fetchKiosk(){this.adminService.getKiosk().subscribe(e=>{this.kiosk=e})}ngAfterViewInit(){let e=new fs(".default-carousel",{loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swipe-next",prevEl:".swipe-prev"}});setInterval(()=>{e.slideNext()},3e3)}static \u0275fac=function(t){return new(t||i)(se(cn),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-admin-dashboard"]],standalone:!0,features:[gt],decls:61,vars:6,consts:[[1,"w-full","flex","flex-cols","justify-center","align-center"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-2"],[1,"col-span-1","md:col-span-3","md:rounded-3xl","text-gray-500","grid","grid-cols-2","md:grid-cols-4","gap-2","p-2","justify-center","align-center","h-full","w-full","border","border-gray-300","shadow-md","shadow-gray-400"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#62b6cb]","justify-center","items-center","rounded-xl"],[1,"w-full","flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#62b6cb","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","8","r","4"],["d","M12 14c-5 0-7 3-7 3v2h14v-2s-2-3-7-3z"],[1,"text-center","text-sm","font-semibold"],[1,"text-xl"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#ff4d6d]","justify-center","items-center","rounded-xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#ff4d6d","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["d","M12 2C8.13 2 5 5.13 5 8c0 3.75 7 10 7 10s7-6.25 7-10c0-2.87-3.13-6-7-6z"],["cx","12","cy","8","r","3"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#80ed99]","justify-center","items-center","rounded-xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#80ed99","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#f28f3b]","justify-center","items-center","rounded-xl"],["fill","#f28f3b","width","96","height","96","stroke","#e3d5ca","stroke-width","1","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],[1,"col-span-1","md:col-span-2","w-full","border","border-gray-300","shadow-md","shadow-gray-400","md:rounded-3xl"],[1,"col-span-1","md:rounded-3xl","h-full","w-full","border","border-gray-300","shadow-md","shadow-gray-400"],[1,"text-gray-700","text-2xl","mt-4","px-4"],[1,"text-gray-700","text-xl","mx-4"],[1,"h-5/6","justify-center","itens-center","flex","bg-transparent","mt-2"],[1,"swiper","justify-center","itens-center","default-carousel"],[1,"swiper-wrapper"],["class","swiper-slide w-full h-[70vh] bg-gray-50",4,"ngIf"],["class","swiper-slide",4,"ngFor","ngForOf"],[1,"swipe-prev","absolute","top-72","z-10","-left-4","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-10","w-10","text-gray-600","hover:text-gray-900"],["points","15 18 9 12 15 6"],[1,"swipe-next","absolute","top-72","z-[10]","-right-4","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["points","9 18 15 12 9 6"],[1,"relative","-top-2"],[1,"swiper-pagination"],[1,"swiper-slide","w-full","h-[70vh]","bg-gray-50"],[1,"h-full","w-full","flex","justify-center","items-center"],[1,"flex","flex-col","items-center","justify-center","w-screen","h-full"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-gray-500"],[1,"mt-4","font-bold","text-gray-500","text-lg"],[1,"swiper-slide"],[1,"h-full","w-full","object-contain",3,"src"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),ie(),m(5,"svg",5),F(6,"circle",6)(7,"path",7),w()(),Je(),m(8,"div",8)(9,"p"),_(10,"Total Registered Users"),w(),m(11,"p",9),_(12),w()()(),m(13,"div",10)(14,"div",4),ie(),m(15,"svg",11),F(16,"path",12)(17,"circle",13),w()(),Je(),m(18,"div",8)(19,"p"),_(20,"Total Available Kiosk"),w(),m(21,"p",9),_(22),w()()(),m(23,"div",14)(24,"div",4),ie(),m(25,"svg",15),F(26,"path",12)(27,"circle",13),w()(),Je(),m(28,"div",8)(29,"p"),_(30,"Total Unavailable Kiosk"),w(),m(31,"p",9),_(32),w()()(),m(33,"div",16)(34,"div",4),ie(),m(35,"svg",17),F(36,"path",18),w()(),Je(),m(37,"div",8)(38,"p"),_(39,"Total Transaction"),w(),m(40,"p",9),_(41),w()()()(),m(42,"div",19),F(43,"app-calendar"),w(),m(44,"div",20)(45,"p",21),_(46,"Upcoming Events"),w(),F(47,"hr",22),m(48,"div",23)(49,"div",24)(50,"div",25),G(51,XY,6,0,"div",26)(52,QY,3,1,"div",27),w(),m(53,"button",28),ie(),m(54,"svg",29),F(55,"polyline",30),w()(),Je(),m(56,"button",31),ie(),m(57,"svg",29),F(58,"polyline",32),w()(),Je(),m(59,"div",33),F(60,"div",34),w()()()()()()),t&2&&(C(12),ge(n.user.length),C(10),ge(n.getAvailableKioskCount()),C(10),ge(n.getUnavailableKioskCount()),C(9),ge(n.transaction.length),C(10),k("ngIf",n.events.length==0),C(),k("ngForOf",n.events))},dependencies:[q0,xt,an,kt],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var Zr=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){let e=sessionStorage.getItem("userType");return this.authService.checkUserLogin()&&e!="user"?!0:(this.router.navigate(["/login"]),!1)}cantLogin(){return this.authService.checkUserLogin()?(this.router.navigate(["/admin-dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Te(ui),Te(Qe))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})};var eC={};eN(eC,{AbortException:()=>YX,AnnotationEditorLayer:()=>XX,AnnotationEditorParamsType:()=>QX,AnnotationEditorType:()=>$3,AnnotationEditorUIManager:()=>KX,AnnotationLayer:()=>JX,AnnotationMode:()=>$X,ColorPicker:()=>eQ,DOMSVGFactory:()=>tQ,DrawLayer:()=>nQ,FeatureTest:()=>iQ,GlobalWorkerOptions:()=>ek,ImageKind:()=>rQ,InvalidPDFException:()=>sQ,MissingPDFException:()=>oQ,OPS:()=>aQ,OutputScale:()=>lQ,PDFDataRangeTransport:()=>dQ,PDFDateString:()=>cQ,PDFWorker:()=>uQ,PasswordResponses:()=>hQ,PermissionFlag:()=>fQ,PixelsPerInch:()=>pQ,RenderingCancelledException:()=>mQ,TextLayer:()=>gQ,UnexpectedResponseException:()=>vQ,Util:()=>xQ,VerbosityLevel:()=>$E,XfaLayer:()=>wQ,build:()=>bQ,createValidAbsoluteUrl:()=>yQ,fetchData:()=>AQ,getDocument:()=>tk,getFilenameFromUrl:()=>_Q,getPdfFilenameFromUrl:()=>SQ,getXfaPageViewport:()=>EQ,isDataScheme:()=>CQ,isPdfFile:()=>MQ,noContextMenu:()=>TQ,normalizeUnicode:()=>IQ,setLayerDimensions:()=>DQ,shadow:()=>PQ,version:()=>nk});var af={};af.d=(i,e)=>{for(var t in e)af.o(e,t)&&!af.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};af.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var yt=globalThis.pdfjsLib={};af.d(yt,{AbortException:()=>Xo,AnnotationEditorLayer:()=>ZX,AnnotationEditorParamsType:()=>wt,AnnotationEditorType:()=>Rt,AnnotationEditorUIManager:()=>ff,AnnotationLayer:()=>VE,AnnotationMode:()=>Ya,ColorPicker:()=>Lv,DOMSVGFactory:()=>xf,DrawLayer:()=>WE,FeatureTest:()=>Ai,GlobalWorkerOptions:()=>Yl,ImageKind:()=>ev,InvalidPDFException:()=>iv,MissingPDFException:()=>Yo,OPS:()=>As,OutputScale:()=>hf,PDFDataRangeTransport:()=>wv,PDFDateString:()=>sv,PDFWorker:()=>Yc,PasswordResponses:()=>tX,PermissionFlag:()=>eX,PixelsPerInch:()=>Xa,RenderingCancelledException:()=>uf,TextLayer:()=>gf,UnexpectedResponseException:()=>Xc,Util:()=>$e,VerbosityLevel:()=>Nv,XfaLayer:()=>Av,build:()=>WX,createValidAbsoluteUrl:()=>sX,fetchData:()=>Vv,getDocument:()=>HX,getFilenameFromUrl:()=>fX,getPdfFilenameFromUrl:()=>pX,getXfaPageViewport:()=>mX,isDataScheme:()=>Uv,isPdfFile:()=>YE,noContextMenu:()=>Xr,normalizeUnicode:()=>cX,setLayerDimensions:()=>Xl,shadow:()=>Gt,version:()=>GX});var ki=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),q3=[1,0,0,1,0,0],TS=[.001,0,0,.001,0,0],KY=1e7,$0=1.35,JY=.35,wpe=JY/$0,Ar={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ya={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},$Y="pdfjs_internal_editor_",Rt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},wt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},eX={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Li={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ev={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ii={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var nf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var Nv={ERRORS:0,WARNINGS:1,INFOS:5},As={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},tX={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Fv=Nv.WARNINGS;function nX(i){Number.isInteger(i)&&(Fv=i)}function iX(){return Fv}function Ov(i){Fv>=Nv.INFOS&&console.log(`Info: ${i}`)}function Ot(i){Fv>=Nv.WARNINGS&&console.log(`Warning: ${i}`)}function An(i){throw new Error(i)}function ri(i,e){i||An(e)}function rX(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sX(i,e=null,t=null){if(!i)return null;try{if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=dX(i)}catch{}let n=e?new URL(i,e):new URL(i);if(rX(n))return n}catch{}return null}function Gt(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}var Qa=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}(),lf=class extends Qa{constructor(e,t){super(e,"PasswordException"),this.code=t}},df=class extends Qa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},iv=class extends Qa{constructor(e){super(e,"InvalidPDFException")}},Yo=class extends Qa{constructor(e){super(e,"MissingPDFException")}},Xc=class extends Qa{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},IS=class extends Qa{constructor(e){super(e,"FormatError")}},Xo=class extends Qa{constructor(e){super(e,"AbortException")}};function Z3(i){(typeof i!="object"||i?.length===void 0)&&An("Invalid argument for bytesToString");let e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);let n=[];for(let r=0;r<e;r+=t){let s=Math.min(r+t,e),o=i.subarray(r,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function Bv(i){typeof i!="string"&&An("Invalid argument for stringToBytes");let e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function oX(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function qE(i){let e=Object.create(null);for(let[t,n]of i)e[t]=n;return e}function aX(){let i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function lX(){try{return new Function(""),!0}catch{return!1}}var Ai=class{static get isLittleEndian(){return Gt(this,"isLittleEndian",aX())}static get isEvalSupported(){return Gt(this,"isEvalSupported",lX())}static get isOffscreenCanvasSupported(){return Gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Gt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Gt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Gt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},_S=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0")),$e=class{static makeHexColor(e,t,n){return`#${_S[e]}${_S[t]}${_S[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let n=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[n,r]}static applyInverseTransform(e,t){let n=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[r,s]}static getAxialAlignedBoundingBox(e,t){let n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],s[0],o[0]),Math.min(n[1],r[1],s[1],o[1]),Math.max(n[0],r[0],s[0],o[0]),Math.max(n[1],r[1],s[1],o[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(n+o)/2,l=Math.sqrt((n+o)**2-4*(n*o-s*r))/2,d=a+l||1,c=a-l||1;return[Math.sqrt(d),Math.sqrt(c)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;let s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[n,s,r,o]}static#e(e,t,n,r,s,o,a,l,d,c){if(d<=0||d>=1)return;let u=1-d,h=d*d,f=h*d,p=u*(u*(u*e+3*d*t)+3*h*n)+f*r,x=u*(u*(u*s+3*d*o)+3*h*a)+f*l;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],x),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],x)}static#t(e,t,n,r,s,o,a,l,d,c,u,h){if(Math.abs(d)<1e-12){Math.abs(c)>=1e-12&&this.#e(e,t,n,r,s,o,a,l,-u/c,h);return}let f=c**2-4*u*d;if(f<0)return;let p=Math.sqrt(f),x=2*d;this.#e(e,t,n,r,s,o,a,l,(-c+p)/x,h),this.#e(e,t,n,r,s,o,a,l,(-c-p)/x,h)}static bezierBoundingBox(e,t,n,r,s,o,a,l,d){return d?(d[0]=Math.min(d[0],e,a),d[1]=Math.min(d[1],t,l),d[2]=Math.max(d[2],e,a),d[3]=Math.max(d[3],t,l)):d=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],this.#t(e,n,s,a,t,r,o,l,3*(-e+3*(n-s)+a),6*(e-2*n+s),3*(n-e),d),this.#t(e,n,s,a,t,r,o,l,3*(-t+3*(r-o)+l),6*(t-2*r+o),3*(r-t),d),d}};function dX(i){return decodeURIComponent(escape(i))}var SS=null,P3=null;function cX(i){return SS||(SS=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,P3=new Map([["\uFB05","\u017Ft"]])),i.replaceAll(SS,(e,t,n)=>t?t.normalize("NFKC"):P3.get(n))}function uX(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let i=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(i);else for(let e=0;e<32;e++)i[e]=Math.floor(Math.random()*255);return Z3(i)}var ZE="pdfjs_internal_id_",Go={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function hX(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(Z3(i))}var qo="http://www.w3.org/2000/svg",Xa=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};function Vv(i,e="text"){return re(this,null,function*(){if(of(i,document.baseURI)){let t=yield fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{let r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})})}var cf=class i{constructor({viewBox:e,scale:t,rotation:n,offsetX:r=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=r,this.offsetY=s;let a=(e[2]+e[0])/2,l=(e[3]+e[1])/2,d,c,u,h;switch(n%=360,n<0&&(n+=360),n){case 180:d=-1,c=0,u=0,h=1;break;case 90:d=0,c=1,u=1,h=0;break;case 270:d=0,c=-1,u=-1,h=0;break;case 0:d=1,c=0,u=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(u=-u,h=-h);let f,p,x,v;d===0?(f=Math.abs(l-e[1])*t+r,p=Math.abs(a-e[0])*t+s,x=(e[3]-e[1])*t,v=(e[2]-e[0])*t):(f=Math.abs(a-e[0])*t+r,p=Math.abs(l-e[1])*t+s,x=(e[2]-e[0])*t,v=(e[3]-e[1])*t),this.transform=[d*t,c*t,u*t,h*t,f-d*t*a-u*t*l,p-c*t*a-h*t*l],this.width=x,this.height=v}get rawDims(){let{viewBox:e}=this;return Gt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new i({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){return $e.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=$e.applyTransform([e[0],e[1]],this.transform),n=$e.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return $e.applyInverseTransform([e,t],this.transform)}},uf=class extends Qa{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function Uv(i){let e=i.length,t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function YE(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function fX(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function pX(i,e="document.pdf"){if(typeof i!="string")return e;if(Uv(i))return Ot('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(i),s=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||e}var rv=class{started=Object.create(null);times=[];time(e){e in this.started&&Ot(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ot(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:n}of this.times)t=Math.max(n.length,t);for(let{name:n,start:r,end:s}of this.times)e.push(`${n.padEnd(t)} ${s-r}ms
`);return e.join("")}};function of(i,e){try{let{protocol:t}=e?new URL(i,e):new URL(i);return t==="http:"||t==="https:"}catch{return!1}}function Xr(i){i.preventDefault()}function R3(i){console.log("Deprecated API usage: "+i)}var sv=class{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=this.#e.exec(e);if(!t)return null;let n=parseInt(t[1],10),r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;let d=t[7]||"Z",c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,d==="-"?(o+=c,a+=u):d==="+"&&(o-=c,a-=u),new Date(Date.UTC(n,r,s,o,a,l))}};function mX(i,{scale:e=1,rotation:t=0}){let{width:n,height:r}=i.attributes.style,s=[0,0,parseInt(n),parseInt(r)];return new cf({viewBox:s,scale:e,rotation:t})}function XE(i){if(i.startsWith("#")){let e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ot(`Not a valid color format: "${i}"`),[0,0,0])}function gX(i){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of i.keys()){e.style.color=t;let n=window.getComputedStyle(e).color;i.set(t,XE(n))}e.remove()}function In(i){let{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform();return[e,t,n,r,s,o]}function Wo(i){let{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform().invertSelf();return[e,t,n,r,s,o]}function Xl(i,e,t=!1,n=!0){if(e instanceof cf){let{pageWidth:r,pageHeight:s}=e.rawDims,{style:o}=i,a=Ai.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,d=`var(--scale-factor) * ${s}px`,c=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,u=a?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!t||e.rotation%180===0?(o.width=c,o.height=u):(o.width=u,o.height=c)}n&&i.setAttribute("data-main-rotation",e.rotation)}var hf=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}},DS=class i{#e=null;#t=null;#n;#i=null;#r=null;static#s=null;constructor(e){this.#n=e,i.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");let t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Xr,{signal:t}),e.addEventListener("pointerdown",i.#l,{signal:t});let n=this.#i=document.createElement("div");n.className="buttons",e.append(n);let r=this.#n.toolbarPosition;if(r){let{style:s}=e,o=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#d(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#c(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#a(e){let t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Xr,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#u(){let{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",i.#s[e]),this.#a(n),n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#i.append(n)}get#o(){let e=document.createElement("div");return e.className="divider",e}addAltText(e){return re(this,null,function*(){let t=yield e.render();this.#a(t),this.#i.prepend(t,this.#o),this.#r=e})}addColorPicker(e){this.#t=e;let t=e.renderButton();this.#a(t),this.#i.prepend(t,this.#o)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}},PS=class{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){let e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Xr,{signal:this.#n._signal});let t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#r(e,t){let n=0,r=0;for(let s of e){let o=s.y+s.height;if(o<n)continue;let a=s.x+(t?s.width:0);if(o>n){r=a,n=o;continue}t?a>r&&(r=a):a<r&&(r=a)}return[t?1-r:r,n]}show(e,t,n){let[r,s]=this.#r(t,n),{style:o}=this.#t||=this.#i();e.append(this.#t),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let n=this.#n._signal;e.addEventListener("contextmenu",Xr,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}};function ov(i,e,t){for(let n of t)e.addEventListener(n,i[n].bind(i))}function vX(i){return Math.round(Math.min(255,Math.max(1,255*i))).toString(16).padStart(2,"0")}var RS=class{#e=0;get id(){return`${$Y}${this.#e++}`}},LS=class i{#e=uX();#t=0;#n=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;let s=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Gt(this,"_isSVGFittingCanvas",s)}#i(e,t){return re(this,null,function*(){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(n.url=t,r=yield Vv(t,"blob")):t instanceof File?r=n.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){let s=i._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((d,c)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,d()},o.onload=()=>re(this,null,function*(){let u=n.svgUrl=o.result;a.src=(yield s)?`${u}#svgView(preserveAspectRatio(none))`:u}),a.onerror=o.onerror=c});o.readAsDataURL(r),yield l}else n.bitmap=yield createImageBitmap(r);n.refCounter=1}catch(r){console.error(r),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n})}getFromFile(e){return re(this,null,function*(){let{lastModified:t,name:n,size:r,type:s}=e;return this.#i(`${t}_${n}_${r}_${s}`,e)})}getFromUrl(e){return re(this,null,function*(){return this.#i(e,e)})}getFromBlob(e,t){return re(this,null,function*(){let n=yield t;return this.#i(e,n)})}getFromId(e){return re(this,null,function*(){this.#n||=new Map;let t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)})}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;let r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){let t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;let t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;let{bitmap:n}=t;if(!t.url&&!t.file){let r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=r.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}},kS=class{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:r,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(r&&e(),this.#t)return;let l={cmd:e,undo:t,post:n,type:s};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(o&&this.#e[this.#i].type===s){a&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}let d=this.#i+1;d===this.#n?this.#e.splice(0,1):(this.#i=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;let{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;let{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}destroy(){this.#e=null}},Ql=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Ai.platform;for(let[n,r,s={}]of e)for(let o of n){let a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let n=this.callbacks.get(this.#e(t));if(!n)return;let{callback:r,options:{bubbles:s=!1,args:o=[],checker:a=null}}=n;a&&!a(e,t)||(r.bind(e,...o,t)(),s||(t.stopPropagation(),t.preventDefault()))}},NS=class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return gX(e),Gt(this,"_colors",e)}convert(e){let t=XE(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[n,r]of this._colors)if(r.every((s,o)=>s===t[o]))return i._colorsMapping.get(n);return t}getHexCode(e){let t=this._colors.get(e);return t?$e.makeHexColor(...t):e}},ff=(()=>{class i{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#r=null;#s=null;#l=null;#d=new kS;#c=null;#a=0;#u=new Set;#o=null;#h=null;#p=new Set;#f=!1;#m=!1;#v=!1;#g=null;#x=null;#b=null;#_=null;#y=!1;#A=null;#D=new RS;#M=!1;#S=!1;#T=null;#C=null;#P=null;#L=null;#E=Rt.NONE;#w=new Set;#I=null;#R=null;#O=null;#H={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#U=[0,0];#F=null;#B=null;#V=null;#k=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=i.prototype,n=a=>a.#B.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:l})=>{if(l instanceof HTMLInputElement){let{type:d}=l;return d!=="text"&&d!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new Ql([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#B.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#B.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:n}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:n}]]))}constructor(t,n,r,s,o,a,l,d,c,u,h){let f=this._signal=this.#e.signal;this.#B=t,this.#V=n,this.#r=r,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:f}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:f}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:f}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:f}),s._on("setpreference",this.onSetPreference.bind(this),{signal:f}),s._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:f}),this.#ee(),this.#re(),this.#Z(),this.#s=o.annotationStorage,this.#g=o.filterFactory,this.#R=a,this.#_=l||null,this.#f=d,this.#m=c,this.#v=u,this.#L=h||null,this.viewParameters={realScale:Xa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#k?.resolve(),this.#k=null,this.#e?.abort(),this.#e=null,this._signal=null;for(let t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#w.clear(),this.#d.destroy(),this.#r?.destroy(),this.#A?.hide(),this.#A=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#F&&(clearTimeout(this.#F),this.#F=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#L}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Gt(this,"hcmFilter",this.#R?this.#g.addHCMFilter(this.#R.foreground,this.#R.background):"none")}get direction(){return Gt(this,"direction",getComputedStyle(this.#B).direction)}get highlightColors(){return Gt(this,"highlightColors",this.#_?new Map(this.#_.split(",").map(t=>t.split("=").map(n=>n.trim()))):null)}get highlightColorNames(){return Gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#P=t}editAltText(t,n=!1){this.#r?.editAltText(this,t,n)}switchToMode(t,n){this._eventBus.on("annotationeditormodechanged",n,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,n){this._eventBus.dispatch("setpreference",{source:this,name:t,value:n})}onSetPreference({name:t,value:n}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=n;break}}onPageChanging({pageNumber:t}){this.#a=t-1}focusMainContainer(){this.#B.focus()}findParent(t,n){for(let r of this.#i.values()){let{x:s,y:o,width:a,height:l}=r.div.getBoundingClientRect();if(t>=s&&t<=s+a&&n>=o&&n<=o+l)return r}return null}disableUserSelect(t=!1){this.#V.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Xa.PDF_TO_CSS_UNITS;for(let n of this.#p)n.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#G({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#q(t){let{currentLayer:n}=this;if(n.hasTextLayer(t))return n;for(let r of this.#i.values())if(r.hasTextLayer(t))return r;return null}highlightSelection(t=""){let n=document.getSelection();if(!n||n.isCollapsed)return;let{anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a}=n,l=n.toString(),c=this.#G(n).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;n.empty();let h=this.#q(c),f=this.#E===Rt.NONE,p=()=>{h?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a,text:l}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(Rt.HIGHLIGHT,p);return}p()}#J(){let t=document.getSelection();if(!t||t.isCollapsed)return;let r=this.#G(t).closest(".textLayer"),s=this.getSelectionBoxes(r);s&&(this.#A||=new PS(this),this.#A.show(r,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#$(){let t=document.getSelection();if(!t||t.isCollapsed){this.#I&&(this.#A?.hide(),this.#I=null,this.#N({hasSelectedText:!1}));return}let{anchorNode:n}=t;if(n===this.#I)return;let s=this.#G(t).closest(".textLayer");if(!s){this.#I&&(this.#A?.hide(),this.#I=null,this.#N({hasSelectedText:!1}));return}if(this.#A?.hide(),this.#I=n,this.#N({hasSelectedText:!0}),!(this.#E!==Rt.HIGHLIGHT&&this.#E!==Rt.NONE)&&(this.#E===Rt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#y=this.isShiftKeyDown,!this.isShiftKeyDown)){let o=this.#E===Rt.HIGHLIGHT?this.#q(s):null;o?.toggleDrawing();let a=new AbortController,l=this.combinedSignal(a),d=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),o?.toggleDrawing(!0),c.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}}#W(t=""){this.#E===Rt.HIGHLIGHT?this.highlightSelection(t):this.#f&&this.#J()}#ee(){document.addEventListener("selectionchange",this.#$.bind(this),{signal:this._signal})}#te(){if(this.#b)return;this.#b=new AbortController;let t=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ne(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#y&&(this.#y=!1,this.#W("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let n of this.#w)if(n.div.contains(t)){this.#C=[n,t],n._focusEventsAllowed=!1;break}}focus(){if(!this.#C)return;let[t,n]=this.#C;this.#C=null,n.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),n.focus()}#Z(){if(this.#T)return;this.#T=new AbortController;let t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ie(){this.#T?.abort(),this.#T=null}#Y(){if(this.#c)return;this.#c=new AbortController;let t=this.combinedSignal(this.#c);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#X(){this.#c?.abort(),this.#c=null}#re(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#Z(),this.#Y()}removeEditListeners(){this.#ie(),this.#X()}dragOver(t){for(let{type:n}of t.dataTransfer.items)for(let r of this.#h)if(r.isHandlingMimeForPasting(n)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let n of t.dataTransfer.items)for(let r of this.#h)if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let n=[];for(let r of this.#w){let s=r.serialize(!0);s&&n.push(s)}n.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(t){this.copy(t),this.delete()}paste(t){return re(this,null,function*(){t.preventDefault();let{clipboardData:n}=t;for(let o of n.items)for(let a of this.#h)if(a.isHandlingMimeForPasting(o.type)){a.paste(o,this.currentLayer);return}let r=n.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(o){Ot(`paste: "${o.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();let s=this.currentLayer;try{let o=[];for(let d of r){let c=yield s.deserialize(d);if(!c)return;o.push(c)}let a=()=>{for(let d of o)this.#Q(d);this.#K(o)},l=()=>{for(let d of o)d.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(o){Ot(`paste: "${o.message}".`)}})}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==Rt.NONE&&!this.isEditorHandlingKeyboard&&i._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#y&&(this.#y=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#N(t){Object.entries(t).some(([r,s])=>this.#H[r]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#H,t)}),this.#E===Rt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#z([[wt.HIGHLIGHT_FREE,!0]]))}#z(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#te(),this.#Y(),this.#N({isEditing:this.#E!==Rt.NONE,isEmpty:this.#j(),hasSomethingToUndo:this.#d.hasSomethingToUndo(),hasSomethingToRedo:this.#d.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#X(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(let n of this.#h)this.#z(n.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#i.get(this.#a)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#a}addLayer(t){this.#i.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}updateMode(t,n=null,r=!1){return re(this,null,function*(){if(this.#E!==t&&!(this.#k&&(yield this.#k.promise,!this.#k))){if(this.#k=Promise.withResolvers(),this.#E=t,t===Rt.NONE){this.setEditingState(!1),this.#oe(),this.#k.resolve();return}this.setEditingState(!0),yield this.#se(),this.unselectAll();for(let s of this.#i.values())s.updateMode(t);if(!n){r&&this.addNewEditorFromKeyboard(),this.#k.resolve();return}for(let s of this.#n.values())s.annotationElementId===n?(this.setSelected(s),s.enterInEditMode()):s.unselect();this.#k.resolve()}})}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,n){if(this.#h){switch(t){case wt.CREATE:this.currentLayer.addNewEditor();return;case wt.HIGHLIGHT_DEFAULT_COLOR:this.#P?.updateColor(n);break;case wt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#O||=new Map).set(t,n),this.showAllEditors("highlight",n);break}for(let r of this.#w)r.updateParams(t,n);for(let r of this.#h)r.updateDefaultParams(t,n)}}showAllEditors(t,n,r=!1){for(let o of this.#n.values())o.editorType===t&&o.show(n);(this.#O?.get(wt.HIGHLIGHT_SHOW_ALL)??!0)!==n&&this.#z([[wt.HIGHLIGHT_SHOW_ALL,n]])}enableWaiting(t=!1){if(this.#S!==t){this.#S=t;for(let n of this.#i.values())t?n.disableClick():n.enableClick(),n.div.classList.toggle("waiting",t)}}#se(){return re(this,null,function*(){if(!this.#M){this.#M=!0;let t=[];for(let n of this.#i.values())t.push(n.enable());yield Promise.all(t);for(let n of this.#n.values())n.enable()}})}#oe(){if(this.unselectAll(),this.#M){this.#M=!1;for(let t of this.#i.values())t.disable();for(let t of this.#n.values())t.disable()}}getEditors(t){let n=[];for(let r of this.#n.values())r.pageIndex===t&&n.push(r);return n}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Q(t){let n=this.#i.get(t.pageIndex);n?n.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#z(t.propertiesToUpdate))}get#ae(){let t=null;for(t of this.#w);return t}updateUI(t){this.#ae===t&&this.#z(t.propertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){for(let n of this.#w)n!==t&&n.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#d.undo(),this.#N({hasSomethingToUndo:this.#d.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#j()})}redo(){this.#d.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#d.hasSomethingToRedo(),isEmpty:this.#j()})}addCommands(t){this.#d.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#j()})}#j(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(let t of this.#n.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let t=[...this.#w],n=()=>{for(let s of t)s.remove()},r=()=>{for(let s of t)this.#Q(s)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#K(t){for(let n of this.#w)n.unselect();this.#w.clear();for(let n of t)n.isEmpty()||(this.#w.add(n),n.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#w)t.commit();this.#K(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#E!==Rt.NONE))&&this.hasSelection){for(let t of this.#w)t.unselect();this.#w.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,n,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;this.#U[0]+=t,this.#U[1]+=n;let[s,o]=this.#U,a=[...this.#w],l=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#U[0]=this.#U[1]=0,this.addCommands({cmd:()=>{for(let d of a)this.#n.has(d.id)&&d.translateInPage(s,o)},undo:()=>{for(let d of a)this.#n.has(d.id)&&d.translateInPage(-s,-o)},mustExec:!1})},l);for(let d of a)d.translateInPage(t,n)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#o=new Map;for(let t of this.#w)this.#o.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#o)return!1;this.disableUserSelect(!1);let t=this.#o;this.#o=null;let n=!1;for(let[{x:s,y:o,pageIndex:a},l]of t)l.newX=s,l.newY=o,l.newPageIndex=a,n||=s!==l.savedX||o!==l.savedY||a!==l.savedPageIndex;if(!n)return!1;let r=(s,o,a,l)=>{if(this.#n.has(s.id)){let d=this.#i.get(l);d?s._setParentAndPosition(d,o,a):(s.pageIndex=l,s.x=o,s.y=a)}};return this.addCommands({cmd:()=>{for(let[s,{newX:o,newY:a,newPageIndex:l}]of t)r(s,o,a,l)},undo:()=>{for(let[s,{savedX:o,savedY:a,savedPageIndex:l}]of t)r(s,o,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,n){if(this.#o)for(let r of this.#o.keys())r.drag(t,n)}rebuild(t){if(t.parent===null){let n=this.getLayer(t.pageIndex);n?(n.changeParent(t),n.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#E}get imageManager(){return Gt(this,"imageManager",new LS)}getSelectionBoxes(t){if(!t)return null;let n=document.getSelection();for(let c=0,u=n.rangeCount;c<u;c++)if(!t.contains(n.getRangeAt(c).commonAncestorContainer))return null;let{x:r,y:s,width:o,height:a}=t.getBoundingClientRect(),l;switch(t.getAttribute("data-main-rotation")){case"90":l=(c,u,h,f)=>({x:(u-s)/a,y:1-(c+h-r)/o,width:f/a,height:h/o});break;case"180":l=(c,u,h,f)=>({x:1-(c+h-r)/o,y:1-(u+f-s)/a,width:h/o,height:f/a});break;case"270":l=(c,u,h,f)=>({x:1-(u+f-s)/a,y:(c-r)/o,width:f/a,height:h/o});break;default:l=(c,u,h,f)=>({x:(c-r)/o,y:(u-s)/a,width:h/o,height:f/a});break}let d=[];for(let c=0,u=n.rangeCount;c<u;c++){let h=n.getRangeAt(c);if(!h.collapsed)for(let{x:f,y:p,width:x,height:v}of h.getClientRects())x===0||v===0||d.push(l(f,p,x,v))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:n}){(this.#l||=new Map).set(t,n)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){let n=this.#l?.get(t.data.id);if(!n)return;let r=this.#s.getRawValue(n);r&&(this.#E===Rt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}}return i})(),L3=(()=>{class i{#e=null;#t=!1;#n=null;#i=null;#r=null;#s=null;#l=!1;#d=null;#c=null;#a=null;#u=null;#o=!1;static#h=null;static _l10n=null;constructor(t){this.#c=t,this.#o=t._uiManager.useNewAltTextFlow,i.#h||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){i._l10n??=t}render(){return re(this,null,function*(){let t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";let n=this.#i=document.createElement("span");t.append(n),this.#o?(t.classList.add("new"),t.setAttribute("data-l10n-id",i.#h.missing),n.setAttribute("data-l10n-id",i.#h["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));let r=this.#c._uiManager._signal;t.addEventListener("contextmenu",Xr,{signal:r}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:r});let s=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#o&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",s,{capture:!0,signal:r}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#l=!0,s(o))},{signal:r}),yield this.#f(),t})}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#o?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#o?this.#e!==null||!!this.#a:this.isEmpty()}get guessedText(){return this.#a}setGuessedText(t){return re(this,null,function*(){this.#e===null&&(this.#a=t,this.#u=yield i._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#f())})}toggleAltTextBadge(t=!1){if(!this.#o||this.#e){this.#d?.remove(),this.#d=null;return}if(!this.#d){let n=this.#d=document.createElement("div");n.className="noAltTextBadge",this.#c.div.append(n)}this.#d.classList.toggle("hidden",!t)}serialize(t){let n=this.#e;return!t&&this.#a===n&&(n=this.#u),{altText:n,decorative:this.#t,guessedText:this.#a,textWithDisclaimer:this.#u}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:t,decorative:n,guessedText:r,textWithDisclaimer:s,cancel:o=!1}){r&&(this.#a=r,this.#u=s),!(this.#e===t&&this.#t===n)&&(o||(this.#e=t,this.#t=n),this.#f())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#d?.remove(),this.#d=null}#f(){return re(this,null,function*(){let t=this.#n;if(!t)return;if(this.#o){if(t.classList.toggle("done",!!this.#e),t.setAttribute("data-l10n-id",i.#h[this.#p]),this.#i?.setAttribute("data-l10n-id",i.#h[`${this.#p}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let n=this.#r;if(!n){this.#r=n=document.createElement("span"),n.className="tooltip",n.setAttribute("role","tooltip"),n.id=`alt-text-tooltip-${this.#c.id}`;let s=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:o})}this.#t?n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(n.removeAttribute("data-l10n-id"),n.textContent=this.#e),n.parentNode||t.append(n),this.#c.getImageForAltText()?.setAttribute("aria-describedby",n.id)})}}return i})(),on=class i{#e=null;#t=null;#n=null;#i=!1;#r=!1;#s=null;#l=null;#d=null;#c="";#a=!1;#u=null;#o=!1;#h=!1;#p=!1;#f=null;#m=0;#v=0;#g=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#b=i._zIndex++;static _borderLineWidth=-1;static _colorManager=new NS;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=i.prototype._resizeWithKeyboard,t=ff.TRANSLATE_SMALL,n=ff.TRANSLATE_BIG;return Gt(this,"_resizerKeyboardManager",new Ql([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],i.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[s,o];let[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new FS({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(i._l10n??=e,i._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),i._borderLineWidth!==-1)return;let n=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){An("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(e){this.#x=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#b}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#O(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#a?this.#a=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){let[s,o]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/s,this.y=(t+r)/o,this.fixAndSetPosition()}#_([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this.fixAndSetPosition()}translate(e,t){this.#_(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y],this.#_(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#u||=[this.x,this.y];let[n,r]=this.parentDimensions;if(this.x+=e/n,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:d,y:c}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,c)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this,[a,l]=this.getBaseTranslation();s+=a,o+=l,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:n}=i,r=n/e,s=n/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let[t,n]=this.pageDimensions,{x:r,y:s,width:o,height:a}=this;if(o*=t,a*=n,r*=t,s*=n,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(t-o,r)),s=Math.max(0,Math.min(n-a,s));break;case 90:r=Math.max(0,Math.min(t-a,r)),s=Math.min(n,Math.max(o,s));break;case 180:r=Math.min(t,Math.max(o,r)),s=Math.min(n,Math.max(a,s));break;case 270:r=Math.min(t,Math.max(a,r)),s=Math.max(0,Math.min(n-o,s));break}this.x=r/=t,this.y=s/=n;let[l,d]=this.getBaseTranslation();r+=l,s+=d;let{style:c}=this.div;c.left=`${(100*r).toFixed(2)}%`,c.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#y(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return i.#y(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return i.#y(e,t,360-this.parentRotation)}#A(e){switch(e){case 90:{let[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){let[n,r]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#r||(this.div.style.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),s=!this.#r&&t.endsWith("%");if(r&&s)return;let[o,a]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!this.#r&&!s&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#D(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let n of e){let r=document.createElement("div");this.#s.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#M.bind(this,n),{signal:t}),r.addEventListener("contextmenu",Xr,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#s)}#M(e,t){t.preventDefault();let{isMac:n}=Ai.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);let r=this._isDraggable;this._isDraggable=!1;let s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#T.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("contextmenu",Xr,{signal:o});let a=this.x,l=this.y,d=this.width,c=this.height,u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#S(a,l,d,c)};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#S(e,t,n,r){let s=this.x,o=this.y,a=this.width,l=this.height;s===e&&o===t&&a===n&&l===r||this.addCommands({cmd:()=>{this.width=a,this.height=l,this.x=s,this.y=o;let[d,c]=this.parentDimensions;this.setDims(d*a,c*l),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=r,this.x=e,this.y=t;let[d,c]=this.parentDimensions;this.setDims(d*n,c*r),this.fixAndSetPosition()},mustExec:!0})}#T(e,t){let[n,r]=this.parentDimensions,s=this.x,o=this.y,a=this.width,l=this.height,d=i.MIN_SIZE/n,c=i.MIN_SIZE/r,u=K=>Math.round(K*1e4)/1e4,h=this.#A(this.rotation),f=(K,Y)=>[h[0]*K+h[2]*Y,h[1]*K+h[3]*Y],p=this.#A(360-this.rotation),x=(K,Y)=>[p[0]*K+p[2]*Y,p[1]*K+p[3]*Y],v,g,y=!1,b=!1;switch(e){case"topLeft":y=!0,v=(K,Y)=>[0,0],g=(K,Y)=>[K,Y];break;case"topMiddle":v=(K,Y)=>[K/2,0],g=(K,Y)=>[K/2,Y];break;case"topRight":y=!0,v=(K,Y)=>[K,0],g=(K,Y)=>[0,Y];break;case"middleRight":b=!0,v=(K,Y)=>[K,Y/2],g=(K,Y)=>[0,Y/2];break;case"bottomRight":y=!0,v=(K,Y)=>[K,Y],g=(K,Y)=>[0,0];break;case"bottomMiddle":v=(K,Y)=>[K/2,Y],g=(K,Y)=>[K/2,0];break;case"bottomLeft":y=!0,v=(K,Y)=>[0,Y],g=(K,Y)=>[K,0];break;case"middleLeft":b=!0,v=(K,Y)=>[0,Y/2],g=(K,Y)=>[K,Y/2];break}let A=v(a,l),M=g(a,l),T=f(...M),I=u(s+T[0]),L=u(o+T[1]),E=1,S=1,[P,j]=this.screenToPageTranslation(t.movementX,t.movementY);if([P,j]=x(P/n,j/r),y){let K=Math.hypot(a,l);E=S=Math.max(Math.min(Math.hypot(M[0]-A[0]-P,M[1]-A[1]-j)/K,1/a,1/l),d/a,c/l)}else b?E=Math.max(d,Math.min(1,Math.abs(M[0]-A[0]-P)))/a:S=Math.max(c,Math.min(1,Math.abs(M[1]-A[1]-j)))/l;let B=u(a*E),z=u(l*S);T=f(...g(B,z));let X=I-T[0],Q=L-T[1];this.width=B,this.height=z,this.x=X,this.y=Q,this.setDims(n*B,r*z),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}addEditToolbar(){return re(this,null,function*(){return this._editToolbar||this.#h?this._editToolbar:(this._editToolbar=new DS(this),this.div.append(this._editToolbar.render()),this.#n&&(yield this._editToolbar.addAltText(this.#n)),this._editToolbar)})}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return re(this,null,function*(){this.#n||(L3.initialize(i._l10n),this.#n=new L3(this),this.#e&&(this.#n.data=this.#e,this.#e=null),yield this.addEditToolbar())})}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}setGuessedAltText(e){return re(this,null,function*(){yield this.#n?.setGuessedText(e)})}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#L();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[n,r]=this.getInitialTranslation();return this.translate(n,r),ov(this,this.div,["pointerdown"]),this.div}pointerdown(e){let{isMac:t}=Ai.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#a=!0,this._isDraggable){this.#P(e);return}this.#C(e)}get isSelected(){return this._uiManager.isSelected(this)}#C(e){let{isMac:t}=Ai.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let n=new AbortController,r=this._uiManager.combinedSignal(n);if(t){this.div.classList.add("moving"),this.#m=e.clientX,this.#v=e.clientY;let o=a=>{let{clientX:l,clientY:d}=a,[c,u]=this.screenToPageTranslation(l-this.#m,d-this.#v);this.#m=l,this.#v=d,this._uiManager.dragSelectedEditors(c,u)};window.addEventListener("pointermove",o,{passive:!0,capture:!0,signal:r})}let s=()=>{n.abort(),t&&this.div.classList.remove("moving"),this.#a=!1,this._uiManager.endDragSession()||this.#C(e)};window.addEventListener("pointerup",s,{signal:r}),window.addEventListener("blur",s,{signal:r})}moveInDOM(){this.#f&&clearTimeout(this.#f),this.#f=setTimeout(()=>{this.#f=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t,n=this.rotation){let r=this.parentScale,[s,o]=this.pageDimensions,[a,l]=this.pageTranslation,d=e/r,c=t/r,u=this.x*s,h=this.y*o,f=this.width*s,p=this.height*o;switch(n){case 0:return[u+d+a,o-h-c-p+l,u+d+f+a,o-h-c+l];case 90:return[u+c+a,o-h+d+l,u+c+p+a,o-h+d+f+l];case 180:return[u-d-f+a,o-h+c+l,u-d+a,o-h+c+p+l];case 270:return[u-c-p+a,o-h-d-f+l,u-c+a,o-h-d+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[n,r,s,o]=e,a=s-n,l=o-r;switch(this.rotation){case 0:return[n,t-o,a,l];case 90:return[n,t-r,l,a];case 180:return[s,t-r,a,l];case 270:return[s,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#L(){if(this.#d||!this.div)return;this.#d=new AbortController;let e=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#L()}rotate(e){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){An("An editor must be serializable")}static deserialize(e,t,n){return re(this,null,function*(){let r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation,r.#e=e.accessibilityData;let[s,o]=r.pageDimensions,[a,l,d,c]=r.getRectInCurrentCoords(e.rect,o);return r.x=a/s,r.y=l/o,r.width=d/s,r.height=c/o,r})}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#f&&(clearTimeout(this.#f),this.#f=null),this.#O(),this.removeEditToolbar(),this.#g){for(let e of this.#g.values())clearTimeout(e);this.#g=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#D(),this.#s.classList.remove("hidden"),ov(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#s.children;if(!this.#t){this.#t=Array.from(t);let o=this.#E.bind(this),a=this.#w.bind(this),l=this._uiManager._signal;for(let d of this.#t){let c=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:l}),d.addEventListener("blur",a,{signal:l}),d.addEventListener("focus",this.#I.bind(this,c),{signal:l}),d.setAttribute("data-l10n-id",i._l10nResizer[c])}}let n=this.#t[0],r=0;for(let o of t){if(o===n)break;r++}let s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==r){if(s<r)for(let a=0;a<r-s;a++)this.#s.append(this.#s.firstChild);else if(s>r)for(let a=0;a<s-r;a++)this.#s.firstChild.before(this.#s.lastChild);let o=0;for(let a of t){let d=this.#t[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",i._l10nResizer[d])}}this.#R(0),this.#p=!0,this.#s.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#E(e){i._resizerKeyboardManager.exec(this,e)}#w(e){this.#p&&e.relatedTarget?.parentNode!==this.#s&&this.#O()}#I(e){this.#c=this.#p?e:""}#R(e){if(this.#t)for(let t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#T(this.#c,{movementX:e,movementY:t})}#O(){if(this.#p=!1,this.#R(-1),this.#l){let{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=this.#l;this.#S(e,t,n,r),this.#l=null}}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#o}set isEditing(e){this.#o=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#r=!0;let n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#g||=new Map;let{action:n}=e,r=this.#g.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#g.delete(n),this.#g.size===0&&(this.#g=null)},i._telemetryTimeout),this.#g.set(n,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},FS=class extends on{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},k3=3285377520,Yr=4294901760,Xs=65535,av=class{constructor(e){this.h1=e?e&4294967295:k3,this.h2=e?e&4294967295:k3}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,v=e.length;x<v;x++){let g=e.charCodeAt(x);g<=255?t[n++]=g:(t[n++]=g>>>8,t[n++]=g&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let r=n>>2,s=n-r*4,o=new Uint32Array(t.buffer,0,r),a=0,l=0,d=this.h1,c=this.h2,u=3432918353,h=461845907,f=u&Xs,p=h&Xs;for(let x=0;x<r;x++)x&1?(a=o[x],a=a*u&Yr|a*f&Xs,a=a<<15|a>>>17,a=a*h&Yr|a*p&Xs,d^=a,d=d<<13|d>>>19,d=d*5+3864292196):(l=o[x],l=l*u&Yr|l*f&Xs,l=l<<15|l>>>17,l=l*h&Yr|l*p&Xs,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(a=0,s){case 3:a^=t[r*4+2]<<16;case 2:a^=t[r*4+1]<<8;case 1:a^=t[r*4],a=a*u&Yr|a*f&Xs,a=a<<15|a>>>17,a=a*h&Yr|a*p&Xs,r&1?d^=a:c^=a}this.h1=d,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Yr|e*36045&Xs,t=t*4283543511&Yr|((t<<16|e>>>16)*2950163797&Yr)>>>16,e^=t>>>1,e=e*444984403&Yr|e*60499&Xs,t=t*3301882366&Yr|((t<<16|e>>>16)*3120437893&Yr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},OS=Object.freeze({map:null,hash:"",transfer:void 0}),pf=class{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#n.values())if(t instanceof on)return;this.onAnnotationEditor(null)}}setValue(e,t){let n=this.#n.get(e),r=!1;if(n!==void 0)for(let[s,o]of Object.entries(t))n[s]!==o&&(r=!0,n[s]=o);else r=!0,this.#n.set(e,t);r&&this.#i(),t instanceof on&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?qE(this.#n):null}setAll(e){for(let[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new lv(this)}get serializable(){if(this.#n.size===0)return OS;let e=new Map,t=new av,n=[],r=Object.create(null),s=!1;for(let[o,a]of this.#n){let l=a instanceof on?a.serialize(!1,r):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(let o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:OS}get editorStats(){let e=null,t=new Map;for(let n of this.#n.values()){if(!(n instanceof on))continue;let r=n.telemetryFinalData;if(!r)continue;let{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(n).constructor),e||=Object.create(null);let o=e[s]||=new Map;for(let[a,l]of Object.entries(r)){if(a==="type")continue;let d=o.get(a);d||(d=new Map,o.set(a,d));let c=d.get(l)??0;d.set(l,c+1)}}for(let[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;let e=[];for(let t of this.#n.values())!(t instanceof on)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}},lv=class extends pf{#e;constructor(e){super();let{map:t,hash:n,transfer:r}=e.serializable,s=structuredClone(t,r?{transfer:r}:null);this.#e={map:s,hash:n,transfer:r}}get print(){An("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Gt(this,"modifiedIds",{ids:new Set,hash:""})}},BS=class{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(n){return re(this,arguments,function*({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(ri(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:r,src:s,style:o}=e,a=new FontFace(r,s,o);this.addNativeFontFace(a);try{yield a.load(),this.#e.add(r),t?.(e)}catch{Ot(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}An("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(e){return re(this,null,function*(){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){yield this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{yield n.loaded}catch(r){throw Ot(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;yield new Promise(n=>{let r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}})}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return Gt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(ki||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Gt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(ri(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){let s=n.shift();setTimeout(s.callback,0)}}let{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Gt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(A,M){return A.charCodeAt(M)<<24|A.charCodeAt(M+1)<<16|A.charCodeAt(M+2)<<8|A.charCodeAt(M+3)&255}function r(A,M,T,I){let L=A.substring(0,M),E=A.substring(M+T);return L+I+E}let s,o,a=this._document.createElement("canvas");a.width=1,a.height=1;let l=a.getContext("2d"),d=0;function c(A,M){if(++d>30){Ot("Load test font never loaded."),M();return}if(l.font="30px "+A,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(c.bind(null,A,M))}let u=`lt${Date.now()}${this.loadTestFontId++}`,h=this._loadTestFont;h=r(h,976,u.length,u);let p=16,x=1482184792,v=n(h,p);for(s=0,o=u.length-3;s<o;s+=4)v=v-x+n(u,s)|0;s<u.length&&(v=v-x+n(u+"XXX",s)|0),h=r(h,p,4,oX(v));let g=`url(data:font/opentype;base64,${btoa(h)});`,y=`@font-face {font-family:"${u}";src:${g}}`;this.insertRule(y);let b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(let A of[e.loadedName,u]){let M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=A,b.append(M)}this._document.body.append(b),c(u,()=>{b.remove(),t.complete()})}},VS=class{constructor(e,{disableFontFace:t=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(let r in e)this[r]=e[r];this.disableFontFace=t===!0,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${hX(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(s){Ot(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[t]=function(s,o){};let r=[];for(let s=0,o=n.length;s<o;)switch(n[s++]){case Go.BEZIER_CURVE_TO:{let[a,l,d,c,u,h]=n.slice(s,s+6);r.push(f=>f.bezierCurveTo(a,l,d,c,u,h)),s+=6}break;case Go.MOVE_TO:{let[a,l]=n.slice(s,s+2);r.push(d=>d.moveTo(a,l)),s+=2}break;case Go.LINE_TO:{let[a,l]=n.slice(s,s+2);r.push(d=>d.lineTo(a,l)),s+=2}break;case Go.QUADRATIC_CURVE_TO:{let[a,l,d,c]=n.slice(s,s+4);r.push(u=>u.quadraticCurveTo(a,l,d,c)),s+=4}break;case Go.RESTORE:r.push(a=>a.restore());break;case Go.SAVE:r.push(a=>a.save());break;case Go.SCALE:ri(r.length===2,"Scale command is only valid at the third position.");break;case Go.TRANSFORM:{let[a,l,d,c,u,h]=n.slice(s,s+6);r.push(f=>f.transform(a,l,d,c,u,h)),s+=6}break;case Go.TRANSLATE:{let[a,l]=n.slice(s,s+2);r.push(d=>d.translate(a,l)),s+=2}break}return this.compiledGlyphs[t]=function(o,a){r[0](o),r[1](o),o.scale(a,-a);for(let l=2,d=r.length;l<d;l++)r[l](o)}}},dv=class{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){An("Abstract method `_createCanvas` called.")}},US=class extends dv{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let n=this._document.createElement("canvas");return n.width=e,n.height=t,n}},cv=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}fetch(t){return re(this,arguments,function*({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let n=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(n).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${n}`)})})}_fetch(e){return re(this,null,function*(){An("Abstract method `_fetch` called.")})}},uv=class extends cv{_fetch(e){return re(this,null,function*(){let t=yield Vv(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Bv(t)})}},hv=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,s){return"none"}destroy(e=!1){}},HS=class extends hv{#e;#t;#n;#i;#r;#s;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#r=t}get#d(){return this.#t||=new Map}get#c(){return this.#s||=new Map}get#a(){if(!this.#n){let e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let n=this.#r.createElementNS(qo,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#r.createElementNS(qo,"defs"),e.append(n),n.append(this.#n),this.#r.body.append(e)}return this.#n}#u(e){if(e.length===1){let l=e[0],d=new Array(256);for(let u=0;u<256;u++)d[u]=l[u]/255;let c=d.join(",");return[c,c,c]}let[t,n,r]=e,s=new Array(256),o=new Array(256),a=new Array(256);for(let l=0;l<256;l++)s[l]=t[l]/255,o[l]=n[l]/255,a[l]=r[l]/255;return[s.join(","),o.join(","),a.join(",")]}#o(e){if(this.#e===void 0){this.#e="";let t=this.#r.URL;t!==this.#r.baseURI&&(Uv(t)?Ot('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#d.get(e);if(t)return t;let[n,r,s]=this.#u(e),o=e.length===1?n:`${n}${r}${s}`;if(t=this.#d.get(o),t)return this.#d.set(e,t),t;let a=`g_${this.#i}_transfer_map_${this.#l++}`,l=this.#o(a);this.#d.set(e,l),this.#d.set(o,l);let d=this.#f(a);return this.#v(n,r,s,d),l}addHCMFilter(e,t){let n=`${e}-${t}`,r="base",s=this.#c.get(r);if(s?.key===n||(s?(s.filter?.remove(),s.key=n,s.url="none",s.filter=null):(s={key:n,url:"none",filter:null},this.#c.set(r,s)),!e||!t))return s.url;let o=this.#x(e);e=$e.makeHexColor(...o);let a=this.#x(t);if(t=$e.makeHexColor(...a),this.#a.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;let l=new Array(256);for(let f=0;f<=255;f++){let p=f/255;l[f]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}let d=l.join(","),c=`g_${this.#i}_hcm_filter`,u=s.filter=this.#f(c);this.#v(d,d,d,u),this.#p(u);let h=(f,p)=>{let x=o[f]/255,v=a[f]/255,g=new Array(p+1);for(let y=0;y<=p;y++)g[y]=x+y/p*(v-x);return g.join(",")};return this.#v(h(0,5),h(1,5),h(2,5),u),s.url=this.#o(c),s.url}addAlphaFilter(e){let t=this.#d.get(e);if(t)return t;let[n]=this.#u([e]),r=`alpha_${n}`;if(t=this.#d.get(r),t)return this.#d.set(e,t),t;let s=`g_${this.#i}_alpha_map_${this.#l++}`,o=this.#o(s);this.#d.set(e,o),this.#d.set(r,o);let a=this.#f(s);return this.#g(n,a),o}addLuminosityFilter(e){let t=this.#d.get(e||"luminosity");if(t)return t;let n,r;if(e?([n]=this.#u([e]),r=`luminosity_${n}`):r="luminosity",t=this.#d.get(r),t)return this.#d.set(e,t),t;let s=`g_${this.#i}_luminosity_map_${this.#l++}`,o=this.#o(s);this.#d.set(e,o),this.#d.set(r,o);let a=this.#f(s);return this.#h(a),e&&this.#g(n,a),o}addHighlightHCMFilter(e,t,n,r,s){let o=`${t}-${n}-${r}-${s}`,a=this.#c.get(e);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#c.set(e,a)),!t||!n))return a.url;let[l,d]=[t,n].map(this.#x.bind(this)),c=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),u=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[h,f]=[r,s].map(this.#x.bind(this));u<c&&([c,u,h,f]=[u,c,f,h]),this.#a.style.color="";let p=(g,y,b)=>{let A=new Array(256),M=(u-c)/b,T=g/255,I=(y-g)/(255*b),L=0;for(let E=0;E<=b;E++){let S=Math.round(c+E*M),P=T+E*I;for(let j=L;j<=S;j++)A[j]=P;L=S+1}for(let E=L;E<256;E++)A[E]=A[L-1];return A.join(",")},x=`g_${this.#i}_hcm_${e}_filter`,v=a.filter=this.#f(x);return this.#p(v),this.#v(p(h[0],f[0],5),p(h[1],f[1],5),p(h[2],f[2],5),v),a.url=this.#o(x),a.url}destroy(e=!1){e&&this.#c.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#l=0)}#h(e){let t=this.#r.createElementNS(qo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){let t=this.#r.createElementNS(qo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){let t=this.#r.createElementNS(qo,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#a.append(t),t}#m(e,t,n){let r=this.#r.createElementNS(qo,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)}#v(e,t,n,r){let s=this.#r.createElementNS(qo,"feComponentTransfer");r.append(s),this.#m(s,"feFuncR",e),this.#m(s,"feFuncG",t),this.#m(s,"feFuncB",n)}#g(e,t){let n=this.#r.createElementNS(qo,"feComponentTransfer");t.append(n),this.#m(n,"feFuncA",e)}#x(e){return this.#a.style.color=e,XE(getComputedStyle(this.#a).getPropertyValue("color"))}},fv=class{constructor({baseUrl:e=null}){this.baseUrl=e}fetch(t){return re(this,arguments,function*({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let n=`${this.baseUrl}${e}`;return this._fetch(n).catch(r=>{throw new Error(`Unable to load font data at: ${n}`)})})}_fetch(e){return re(this,null,function*(){An("Abstract method `_fetch` called.")})}},pv=class extends fv{_fetch(e){return re(this,null,function*(){let t=yield Vv(e,"arraybuffer");return new Uint8Array(t)})}};ki&&(tv=Promise.withResolvers(),nv=null,re(void 0,null,function*(){let e=yield import("./chunk-L2HEV66R.js"),t=yield import("./chunk-BMBYILCS.js"),n=yield import("./chunk-ALIQTIYY.js"),r=yield import("./chunk-NYZOWURK.js"),s,o;return new Map(Object.entries({fs:e,http:t,https:n,url:r,canvas:s,path2d:o}))}).then(e=>{nv=e,tv.resolve()},e=>{Ot(`loadPackages: ${e}`),nv=new Map,tv.resolve()}));var tv,nv,Qs=class{static get promise(){return tv.promise}static get(e){return nv?.get(e)}};function Y3(i){return re(this,null,function*(){let t=yield Qs.get("fs").promises.readFile(i);return new Uint8Array(t)})}var zS=class extends hv{},jS=class extends dv{_createCanvas(e,t){return Qs.get("canvas").createCanvas(e,t)}},GS=class extends cv{_fetch(e){return re(this,null,function*(){return Y3(e)})}},WS=class extends fv{_fetch(e){return re(this,null,function*(){return Y3(e)})}},Wi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function qS(i,e){if(!e)return;let t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),i.clip(r)}var mf=class{getPattern(){An("Abstract method `getPattern` called.")}},ZS=class extends mf{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,r){let s;if(r===Wi.STROKE||r===Wi.FILL){let o=t.current.getClippedPathBoundingBox(r,In(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,d=t.cachedCanvases.getCanvas("pattern",a,l),c=d.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-o[0],-o[1]),n=$e.transform(n,[1,0,0,1,o[0],o[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),qS(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(d.canvas,"no-repeat");let u=new DOMMatrix(n);s.setTransform(u)}else qS(e,this._bbox),s=this._createGradient(e);return s}};function ES(i,e,t,n,r,s,o,a){let l=e.coords,d=e.colors,c=i.data,u=i.width*4,h;l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=s,s=o,o=h),l[n+1]>l[r+1]&&(h=n,n=r,r=h,h=o,o=a,a=h),l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=s,s=o,o=h);let f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,x=(l[n]+e.offsetX)*e.scaleX,v=(l[n+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY;if(p>=y)return;let b=d[s],A=d[s+1],M=d[s+2],T=d[o],I=d[o+1],L=d[o+2],E=d[a],S=d[a+1],P=d[a+2],j=Math.round(p),B=Math.round(y),z,X,Q,K,Y,Ae,Ce,Ie;for(let He=j;He<=B;He++){if(He<v){let he=He<p?0:(p-He)/(p-v);z=f-(f-x)*he,X=b-(b-T)*he,Q=A-(A-I)*he,K=M-(M-L)*he}else{let he;He>y?he=1:v===y?he=0:he=(v-He)/(v-y),z=x-(x-g)*he,X=T-(T-E)*he,Q=I-(I-S)*he,K=L-(L-P)*he}let at;He<p?at=0:He>y?at=1:at=(p-He)/(p-y),Y=f-(f-g)*at,Ae=b-(b-E)*at,Ce=A-(A-S)*at,Ie=M-(M-P)*at;let le=Math.round(Math.min(z,Y)),be=Math.round(Math.max(z,Y)),Pe=u*He+le*4;for(let he=le;he<=be;he++)at=(z-he)/(z-Y),at<0?at=0:at>1&&(at=1),c[Pe++]=X-(X-Ae)*at|0,c[Pe++]=Q-(Q-Ce)*at|0,c[Pe++]=K-(K-Ie)*at|0,c[Pe++]=255}}function xX(i,e,t){let n=e.coords,r=e.colors,s,o;switch(e.type){case"lattice":let a=e.verticesPerRow,l=Math.floor(n.length/a)-1,d=a-1;for(s=0;s<l;s++){let c=s*a;for(let u=0;u<d;u++,c++)ES(i,t,n[c],n[c+1],n[c+a],r[c],r[c+1],r[c+a]),ES(i,t,n[c+a+1],n[c+1],n[c+a],r[c+a+1],r[c+1],r[c+a])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)ES(i,t,n[s],n[s+1],n[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}var YS=class extends mf{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){let a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-a,c=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),f=d/u,p=c/h,x={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/f,scaleY:1/p},v=u+2*2,g=h+2*2,y=n.getCanvas("mesh",v,g),b=y.context,A=b.createImageData(u,h);if(t){let T=A.data;for(let I=0,L=T.length;I<L;I+=4)T[I]=t[0],T[I+1]=t[1],T[I+2]=t[2],T[I+3]=255}for(let T of this._figures)xX(A,T,x);return b.putImageData(A,2,2),{canvas:y.canvas,offsetX:a-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}getPattern(e,t,n,r){qS(e,this._bbox);let s;if(r===Wi.SHADING)s=$e.singularValueDecompose2dScale(In(e));else if(s=$e.singularValueDecompose2dScale(t.baseTransform),this.matrix){let a=$e.singularValueDecompose2dScale(this.matrix);s=[s[0]*a[0],s[1]*a[1]]}let o=this._createMeshCanvas(s,r===Wi.SHADING?null:this._background,t.cachedCanvases);return r!==Wi.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}},XS=class extends mf{getPattern(){return"hotpink"}};function wX(i){switch(i[0]){case"RadialAxial":return new ZS(i);case"Mesh":return new YS(i);case"Dummy":return new XS}throw new Error(`Unknown IR type: ${i[0]}`)}var N3={COLORED:1,UNCOLORED:2},bX=(()=>{class i{static MAX_PATTERN_SIZE=3e3;constructor(t,n,r,s,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=n,this.ctx=r,this.canvasGraphicsFactory=s,this.baseTransform=o}createPatternCanvas(t){let{bbox:n,operatorList:r,paintType:s,tilingType:o,color:a,canvasGraphicsFactory:l}=this,{xstep:d,ystep:c}=this;d=Math.abs(d),c=Math.abs(c),Ov("TilingType: "+o);let u=n[0],h=n[1],f=n[2],p=n[3],x=f-u,v=p-h,g=$e.singularValueDecompose2dScale(this.matrix),y=$e.singularValueDecompose2dScale(this.baseTransform),b=g[0]*y[0],A=g[1]*y[1],M=x,T=v,I=!1,L=!1,E=Math.ceil(d*b),S=Math.ceil(c*A),P=Math.ceil(x*b),j=Math.ceil(v*A);E>=P?M=d:I=!0,S>=j?T=c:L=!0;let B=this.getSizeAndScale(M,this.ctx.canvas.width,b),z=this.getSizeAndScale(T,this.ctx.canvas.height,A),X=t.cachedCanvases.getCanvas("pattern",B.size,z.size),Q=X.context,K=l.createCanvasGraphics(Q);if(K.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(K,s,a),Q.translate(-B.scale*u,-z.scale*h),K.transform(B.scale,0,0,z.scale,0,0),Q.save(),this.clipBbox(K,u,h,f,p),K.baseTransform=In(K.ctx),K.executeOperatorList(r),K.endDrawing(),Q.restore(),I||L){let Y=X.canvas;I&&(M=d),L&&(T=c);let Ae=this.getSizeAndScale(M,this.ctx.canvas.width,b),Ce=this.getSizeAndScale(T,this.ctx.canvas.height,A),Ie=Ae.size,He=Ce.size,at=t.cachedCanvases.getCanvas("pattern-workaround",Ie,He),le=at.context,be=I?Math.floor(x/d):0,Pe=L?Math.floor(v/c):0;for(let he=0;he<=be;he++)for(let Ge=0;Ge<=Pe;Ge++)le.drawImage(Y,Ie*he,He*Ge,Ie,He,0,0,Ie,He);return{canvas:at.canvas,scaleX:Ae.scale,scaleY:Ce.scale,offsetX:u,offsetY:h}}return{canvas:X.canvas,scaleX:B.scale,scaleY:z.scale,offsetX:u,offsetY:h}}getSizeAndScale(t,n,r){let s=Math.max(i.MAX_PATTERN_SIZE,n),o=Math.ceil(t*r);return o>=s?o=s:r=o/t,{scale:r,size:o}}clipBbox(t,n,r,s,o){let a=s-n,l=o-r;t.ctx.rect(n,r,a,l),t.current.updateRectMinMax(In(t.ctx),[n,r,s,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,n,r){let s=t.ctx,o=t.current;switch(n){case N3.COLORED:let a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,o.fillColor=a.fillStyle,o.strokeColor=a.strokeStyle;break;case N3.UNCOLORED:let l=$e.makeHexColor(r[0],r[1],r[2]);s.fillStyle=l,s.strokeStyle=l,o.fillColor=l,o.strokeColor=l;break;default:throw new IS(`Unsupported paint type: ${n}`)}}getPattern(t,n,r,s){let o=r;s!==Wi.SHADING&&(o=$e.transform(o,n.baseTransform),this.matrix&&(o=$e.transform(o,this.matrix)));let a=this.createPatternCanvas(n),l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);let d=t.createPattern(a.canvas,"repeat");return d.setTransform(l),d}}return i})();function yX({src:i,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:s=4294967295,inverseDecode:o=!1}){let a=Ai.isLittleEndian?4278190080:255,[l,d]=o?[s,a]:[a,s],c=n>>3,u=n&7,h=i.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<r;p++){for(let v=e+c;e<v;e++){let g=e<h?i[e]:255;t[f++]=g&128?d:l,t[f++]=g&64?d:l,t[f++]=g&32?d:l,t[f++]=g&16?d:l,t[f++]=g&8?d:l,t[f++]=g&4?d:l,t[f++]=g&2?d:l,t[f++]=g&1?d:l}if(u===0)continue;let x=e<h?i[e++]:255;for(let v=0;v<u;v++)t[f++]=x&1<<7-v?d:l}return{srcPos:e,destPos:f}}var F3=16,O3=100,AX=15,B3=10,V3=1e3,or=16;function _X(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(n,r){e.translate(n,r),this.__originalTranslate(n,r)},i.scale=function(n,r){e.scale(n,r),this.__originalScale(n,r)},i.transform=function(n,r,s,o,a,l){e.transform(n,r,s,o,a,l),this.__originalTransform(n,r,s,o,a,l)},i.setTransform=function(n,r,s,o,a,l){e.setTransform(n,r,s,o,a,l),this.__originalSetTransform(n,r,s,o,a,l)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(n){e.rotate(n),this.__originalRotate(n)},i.clip=function(n){e.clip(n),this.__originalClip(n)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,r,s,o,a){e.bezierCurveTo(t,n,r,s,o,a),this.__originalBezierCurveTo(t,n,r,s,o,a)},i.rect=function(t,n,r,s){e.rect(t,n,r,s),this.__originalRect(t,n,r,s)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var QS=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function Y0(i,e,t,n,r,s,o,a,l,d){let[c,u,h,f,p,x]=In(i);if(u===0&&h===0){let y=o*c+p,b=Math.round(y),A=a*f+x,M=Math.round(A),T=(o+l)*c+p,I=Math.abs(Math.round(T)-b)||1,L=(a+d)*f+x,E=Math.abs(Math.round(L)-M)||1;return i.setTransform(Math.sign(c),0,0,Math.sign(f),b,M),i.drawImage(e,t,n,r,s,0,0,I,E),i.setTransform(c,u,h,f,p,x),[I,E]}if(c===0&&f===0){let y=a*h+p,b=Math.round(y),A=o*u+x,M=Math.round(A),T=(a+d)*h+p,I=Math.abs(Math.round(T)-b)||1,L=(o+l)*u+x,E=Math.abs(Math.round(L)-M)||1;return i.setTransform(0,Math.sign(u),Math.sign(h),0,b,M),i.drawImage(e,t,n,r,s,0,0,E,I),i.setTransform(c,u,h,f,p,x),[E,I]}i.drawImage(e,t,n,r,s,o,a,l,d);let v=Math.hypot(c,u),g=Math.hypot(h,f);return[v*l,g*d]}function SX(i){let{width:e,height:t}=i;if(e>V3||t>V3)return null;let n=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1,o=new Uint8Array(s*(t+1)),a,l,d,c=e+7&-8,u=new Uint8Array(c*t),h=0;for(let g of i.data){let y=128;for(;y>0;)u[h++]=g&y?0:255,y>>=1}let f=0;for(h=0,u[h]!==0&&(o[0]=1,++f),l=1;l<e;l++)u[h]!==u[h+1]&&(o[l]=u[h]?2:1,++f),h++;for(u[h]!==0&&(o[l]=2,++f),a=1;a<t;a++){h=a*c,d=a*s,u[h-c]!==u[h]&&(o[d]=u[h]?1:8,++f);let g=(u[h]?4:0)+(u[h-c]?8:0);for(l=1;l<e;l++)g=(g>>2)+(u[h+1]?4:0)+(u[h-c+1]?8:0),r[g]&&(o[d+l]=r[g],++f),h++;if(u[h-c]!==u[h]&&(o[d+l]=u[h]?2:4,++f),f>n)return null}for(h=c*(t-1),d=a*s,u[h]!==0&&(o[d]=8,++f),l=1;l<e;l++)u[h]!==u[h+1]&&(o[d+l]=u[h]?4:8,++f),h++;if(u[h]!==0&&(o[d+l]=4,++f),f>n)return null;let p=new Int32Array([0,s,-1,0,-s,0,0,0,1]),x=new Path2D;for(a=0;f&&a<=t;a++){let g=a*s,y=g+e;for(;g<y&&!o[g];)g++;if(g===y)continue;x.moveTo(g%s,a);let b=g,A=o[g];do{let M=p[A];do g+=M;while(!o[g]);let T=o[g];T!==5&&T!==10?(A=T,o[g]=0):(A=T&51*A>>4,o[g]&=A>>2|A<<2),x.lineTo(g%s,g/s|0),o[g]||--f}while(b!==g);--a}return u=null,o=null,function(g){g.save(),g.scale(1/e,-1/t),g.translate(0,-t),g.fill(x),g.beginPath(),g.restore()}}var mv=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=q3,this.textMatrixScale=1,this.fontMatrix=TS,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Li.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=$e.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){let n=$e.applyTransform(t,e),r=$e.applyTransform(t.slice(2),e),s=$e.applyTransform([t[0],t[3]],e),o=$e.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],r[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],r[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],r[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],r[1],s[1],o[1])}updateScalingPathMinMax(e,t){$e.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,r,s,o,a,l,d,c){let u=$e.bezierBoundingBox(t,n,r,s,o,a,l,d,c);c||this.updateRectMinMax(e,u)}getPathBoundingBox(e=Wi.FILL,t=null){let n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Wi.STROKE){t||An("Stroke bounding box must include transform.");let r=$e.singularValueDecompose2dScale(t),s=r[0]*this.lineWidth/2,o=r[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){let e=$e.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Wi.FILL,t=null){return $e.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function U3(i,e){if(typeof ImageData<"u"&&e instanceof ImageData){i.putImageData(e,0,0);return}let t=e.height,n=e.width,r=t%or,s=(t-r)/or,o=r===0?s:s+1,a=i.createImageData(n,or),l=0,d,c=e.data,u=a.data,h,f,p,x;if(e.kind===ev.GRAYSCALE_1BPP){let v=c.byteLength,g=new Uint32Array(u.buffer,0,u.byteLength>>2),y=g.length,b=n+7>>3,A=4294967295,M=Ai.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(p=h<s?or:r,d=0,f=0;f<p;f++){let T=v-l,I=0,L=T>b?n:T*8-7,E=L&-8,S=0,P=0;for(;I<E;I+=8)P=c[l++],g[d++]=P&128?A:M,g[d++]=P&64?A:M,g[d++]=P&32?A:M,g[d++]=P&16?A:M,g[d++]=P&8?A:M,g[d++]=P&4?A:M,g[d++]=P&2?A:M,g[d++]=P&1?A:M;for(;I<L;I++)S===0&&(P=c[l++],S=128),g[d++]=P&S?A:M,S>>=1}for(;d<y;)g[d++]=0;i.putImageData(a,0,h*or)}}else if(e.kind===ev.RGBA_32BPP){for(f=0,x=n*or*4,h=0;h<s;h++)u.set(c.subarray(l,l+x)),l+=x,i.putImageData(a,0,f),f+=or;h<o&&(x=n*r*4,u.set(c.subarray(l,l+x)),i.putImageData(a,0,f))}else if(e.kind===ev.RGB_24BPP)for(p=or,x=n*p,h=0;h<o;h++){for(h>=s&&(p=r,x=n*p),d=0,f=x;f--;)u[d++]=c[l++],u[d++]=c[l++],u[d++]=c[l++],u[d++]=255;i.putImageData(a,0,h*or)}else throw new Error(`bad image kind: ${e.kind}`)}function H3(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}let t=e.height,n=e.width,r=t%or,s=(t-r)/or,o=r===0?s:s+1,a=i.createImageData(n,or),l=0,d=e.data,c=a.data;for(let u=0;u<o;u++){let h=u<s?or:r;({srcPos:l}=yX({src:d,srcPos:l,dest:c,width:n,height:h,nonBlackColor:0})),i.putImageData(a,0,u*or)}}function rf(i,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function X0(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!ki){let{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}}function z3(i,e){if(e)return!0;let t=$e.singularValueDecompose2dScale(i);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let n=Math.fround((globalThis.devicePixelRatio||1)*Xa.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}var EX=["butt","round","square"],CX=["miter","round","bevel"],MX={},j3={},Zc=class i{constructor(e,t,n,r,s,{optionalContentConfig:o,markedContentStack:a=null},l,d){this.ctx=e,this.current=new mv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new QS(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){let s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,n){let l=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...In(this.compositeCtx))}this.ctx.save(),X0(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=In(this.ctx)}executeOperatorList(e,t,n,r){let s=e.argsArray,o=e.fnArray,a=t||0,l=s.length;if(l===a)return a;let d=l-a>B3&&typeof n=="function",c=d?Date.now()+AX:0,u=0,h=this.commonObjs,f=this.objs,p;for(;;){if(r!==void 0&&a===r.nextBreakPoint)return r.breakIt(a,n),a;if(p=o[a],p!==As.dependency)this[p].apply(this,s[a]);else for(let x of s[a]){let v=x.startsWith("g_")?h:f;if(!v.has(x))return v.get(x,n),a}if(a++,a===l)return a;if(d&&++u>B3){if(Date.now()>c)return n(),a;u=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let n=e.width??e.displayWidth,r=e.height??e.displayHeight,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=n,l=r,d="prescale1",c,u;for(;s>2&&a>1||o>2&&l>1;){let h=a,f=l;s>2&&a>1&&(h=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/h),o>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/f),c=this.cachedCanvases.getCanvas(d,h,f),u=c.context,u.clearRect(0,0,h,f),u.drawImage(e,0,0,a,l,0,0,h,f),e=c.canvas,a=h,l=f,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){let t=this.ctx,{width:n,height:r}=e,s=this.current.fillColor,o=this.current.patternFill,a=In(t),l,d,c,u;if((e.bitmap||e.data)&&e.count>1){let L=e.bitmap||e.data.buffer;d=JSON.stringify(o?a:[a.slice(0,4),s]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));let E=l.get(d);if(E&&!o){let S=Math.round(Math.min(a[0],a[2])+a[4]),P=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:E,offsetX:S,offsetY:P}}c=E}c||(u=this.cachedCanvases.getCanvas("maskCanvas",n,r),H3(u.context,e));let h=$e.transform(a,[1/n,0,0,-1/r,0,0]);h=$e.transform(h,[1,0,0,1,0,-r]);let[f,p,x,v]=$e.getAxialAlignedBoundingBox([0,0,n,r],h),g=Math.round(x-f)||1,y=Math.round(v-p)||1,b=this.cachedCanvases.getCanvas("fillCanvas",g,y),A=b.context,M=f,T=p;A.translate(-M,-T),A.transform(...h),c||(c=this._scaleImage(u.canvas,Wo(A)),c=c.img,l&&o&&l.set(d,c)),A.imageSmoothingEnabled=z3(In(A),e.interpolate),Y0(A,c,0,0,c.width,c.height,0,0,n,r),A.globalCompositeOperation="source-in";let I=$e.transform(Wo(A),[1,0,0,1,-M,-T]);return A.fillStyle=o?s.getPattern(t,this,I,Wi.FILL):s,A.fillRect(0,0,n,r),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(d,b.canvas)),{canvas:b.canvas,offsetX:Math.round(M),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=EX[e]}setLineJoin(e){this.ctx.lineJoin=CX[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;let s=this.ctx;s.setTransform(...In(this.suspendedCtx)),rf(this.suspendedCtx,s),_X(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),rf(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){let s=r[0],o=r[1],a=r[2]-s,l=r[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,n,a,l,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,s,o,a,l,d,c,u){let h=e.canvas,f=l-c,p=d-u;if(o){let v=$e.makeHexColor(...o);if(f<0||p<0||f+n>h.width||p+r>h.height){let g=this.cachedCanvases.getCanvas("maskExtension",n,r),y=g.context;y.drawImage(h,-f,-p),y.globalCompositeOperation="destination-atop",y.fillStyle=v,y.fillRect(0,0,n,r),y.globalCompositeOperation="source-over",h=g.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let g=new Path2D;g.rect(f,p,n,r),e.clip(g),e.globalCompositeOperation="destination-atop",e.fillStyle=v,e.fillRect(f,p,n,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));let x=new Path2D;x.rect(l,d,n,r),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(h,f,p,n,r,l,d,n,r),t.restore()}save(){this.inSMaskMode?(rf(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),rf(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,s,o){this.ctx.transform(e,t,n,r,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let r=this.ctx,s=this.current,o=s.x,a=s.y,l,d,c=In(r),u=c[0]===0&&c[3]===0||c[1]===0&&c[2]===0,h=u?n.slice(0):null;for(let f=0,p=0,x=e.length;f<x;f++)switch(e[f]|0){case As.rectangle:o=t[p++],a=t[p++];let v=t[p++],g=t[p++],y=o+v,b=a+g;r.moveTo(o,a),v===0||g===0?r.lineTo(y,b):(r.lineTo(y,a),r.lineTo(y,b),r.lineTo(o,b)),u||s.updateRectMinMax(c,[o,a,y,b]),r.closePath();break;case As.moveTo:o=t[p++],a=t[p++],r.moveTo(o,a),u||s.updatePathMinMax(c,o,a);break;case As.lineTo:o=t[p++],a=t[p++],r.lineTo(o,a),u||s.updatePathMinMax(c,o,a);break;case As.curveTo:l=o,d=a,o=t[p+4],a=t[p+5],r.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],o,a),s.updateCurvePathMinMax(c,l,d,t[p],t[p+1],t[p+2],t[p+3],o,a,h),p+=6;break;case As.curveTo2:l=o,d=a,r.bezierCurveTo(o,a,t[p],t[p+1],t[p+2],t[p+3]),s.updateCurvePathMinMax(c,l,d,o,a,t[p],t[p+1],t[p+2],t[p+3],h),o=t[p+2],a=t[p+3],p+=4;break;case As.curveTo3:l=o,d=a,o=t[p+2],a=t[p+3],r.bezierCurveTo(t[p],t[p+1],o,a,o,a),s.updateCurvePathMinMax(c,l,d,t[p],t[p+1],o,a,o,a,h),p+=4;break;case As.closePath:r.closePath();break}u&&s.updateScalingPathMinMax(c,h),s.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,Wo(t),Wi.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,n=this.current.fillColor,r=this.current.patternFill,s=!1;r&&(t.save(),t.fillStyle=n.getPattern(t,this,Wo(t),Wi.FILL),s=!0);let o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=MX}eoClip(){this.pendingClip=j3}beginText(){this.current.textMatrix=q3,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(let n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||TS,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ot("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;let s=n.loadedName||"sans-serif",o=n.systemFontInfo?.css||`"${s}", ${n.fallbackName}`,a="normal";n.black?a="900":n.bold&&(a="bold");let l=n.italic?"italic":"normal",d=t;t<F3?d=F3:t>O3&&(d=O3),this.current.fontSizeScale=t/d,this.ctx.font=`${l} ${a} ${d}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,s,o){this.current.textMatrix=[e,t,n,r,s,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,r){let s=this.ctx,o=this.current,a=o.font,l=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,c=l&Li.FILL_STROKE_MASK,u=!!(l&Li.ADD_TO_PATH_FLAG),h=o.patternFill&&!a.missingFile,f;(a.disableFontFace||u||h)&&(f=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||h?(s.save(),s.translate(t,n),s.beginPath(),f(s,d),r&&s.setTransform(...r),(c===Li.FILL||c===Li.FILL_STROKE)&&s.fill(),(c===Li.STROKE||c===Li.FILL_STROKE)&&s.stroke(),s.restore()):((c===Li.FILL||c===Li.FILL_STROKE)&&s.fillText(e,t,n),(c===Li.STROKE||c===Li.FILL_STROKE)&&s.strokeText(e,t,n)),u&&(this.pendingTextPaths||=[]).push({transform:In(s),x:t,y:n,fontSize:d,addToPath:f})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return Gt(this,"isFontSubpixelAAEnabled",n)}showText(e){let t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);let r=t.fontSize;if(r===0)return;let s=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,d=t.fontDirection,c=t.textHScale*d,u=e.length,h=n.vertical,f=h?1:-1,p=n.defaultVMetrics,x=r*t.fontMatrix[0],v=t.textRenderingMode===Li.FILL&&!n.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),d>0?s.scale(c,-1):s.scale(c,1);let g;if(t.patternFill){s.save();let T=t.fillColor.getPattern(s,this,Wo(s),Wi.FILL);g=In(s),s.restore(),s.fillStyle=T}let y=t.lineWidth,b=t.textMatrixScale;if(b===0||y===0){let T=t.textRenderingMode&Li.FILL_STROKE_MASK;(T===Li.STROKE||T===Li.FILL_STROKE)&&(y=this.getSinglePixelWidth())}else y/=b;if(o!==1&&(s.scale(o,o),y/=o),s.lineWidth=y,n.isInvalidPDFjsFont){let T=[],I=0;for(let L of e)T.push(L.unicode),I+=L.width;s.fillText(T.join(""),0,0),t.x+=I*x*c,s.restore(),this.compose();return}let A=0,M;for(M=0;M<u;++M){let T=e[M];if(typeof T=="number"){A+=f*T*r/1e3;continue}let I=!1,L=(T.isSpace?l:0)+a,E=T.fontChar,S=T.accent,P,j,B=T.width;if(h){let X=T.vmetric||p,Q=-(T.vmetric?X[1]:B*.5)*x,K=X[2]*x;B=X?-X[0]:B,P=Q/o,j=(A+K)/o}else P=A/o,j=0;if(n.remeasure&&B>0){let X=s.measureText(E).width*1e3/r*o;if(B<X&&this.isFontSubpixelAAEnabled){let Q=B/X;I=!0,s.save(),s.scale(Q,1),P/=Q}else B!==X&&(P+=(B-X)/2e3*r/o)}if(this.contentVisible&&(T.isInFont||n.missingFile)){if(v&&!S)s.fillText(E,P,j);else if(this.paintChar(E,P,j,g),S){let X=P+r*S.offset.x/o,Q=j-r*S.offset.y/o;this.paintChar(S.fontChar,X,Q,g)}}let z=h?B*x-L*d:B*x+L*d;A+=z,I&&s.restore()}h?t.y-=A:t.x+=A*c,s.restore(),this.compose()}showType3Text(e){let t=this.ctx,n=this.current,r=n.font,s=n.fontSize,o=n.fontDirection,a=r.vertical?1:-1,l=n.charSpacing,d=n.wordSpacing,c=n.textHScale*o,u=n.fontMatrix||TS,h=e.length,f=n.textRenderingMode===Li.INVISIBLE,p,x,v,g;if(!(f||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(c,o),p=0;p<h;++p){if(x=e[p],typeof x=="number"){g=a*x*s/1e3,this.ctx.translate(g,0),n.x+=g*c;continue}let y=(x.isSpace?d:0)+l,b=r.charProcOperatorList[x.operatorListId];if(!b){Ot(`Type3 character "${x.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=x,this.save(),t.scale(s,s),t.transform(...u),this.executeOperatorList(b),this.restore()),v=$e.applyTransform([x.width,0],u)[0]*s+y,t.translate(v,0),n.x+=v*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,s,o){this.ctx.rect(n,r,s-n,o-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let n=e[1],r=this.baseTransform||In(this.ctx),s={createCanvasGraphics:o=>new i(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new bX(e,n,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=$e.makeHexColor(e,t,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=$e.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=wX(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Wo(t),Wi.SHADING);let r=Wo(t);if(r){let{width:s,height:o}=t.canvas,[a,l,d,c]=$e.getAxialAlignedBoundingBox([0,0,s,o],r);this.ctx.fillRect(a,l,d-a,c-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){An("Should not call beginInlineImage")}beginImageData(){An("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=In(this.ctx),t)){let n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.current.updateRectMinMax(In(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||Ov("TODO: Support non-isolated groups."),e.knockout&&Ot("Knockout groups not supported.");let n=In(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=$e.getAxialAlignedBoundingBox(e.bbox,In(t)),s=[0,0,t.canvas.width,t.canvas.height];r=$e.intersect(r,s)||[0,0,0,0];let o=Math.floor(r[0]),a=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-o,1),d=Math.max(Math.ceil(r[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,d]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);let u=this.cachedCanvases.getCanvas(c,l,d),h=u.context;h.translate(-o,-a),h.transform(...n),e.smask?this.smaskStack.push({canvas:u.canvas,context:h,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),rf(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let r=In(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);let s=$e.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,n,r,s){if(this.#e(),X0(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let o=t[2]-t[0],a=t[3]-t[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;let[l,d]=$e.singularValueDecompose2dScale(In(this.ctx)),{viewportScale:c}=this,u=Math.ceil(o*this.outputScaleX*c),h=Math.ceil(a*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,h);let{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-d,0,a*d),X0(this.ctx)}else X0(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new mv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let n=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=SX(e)),r.compiled)){r.compiled(n);return}let s=this._createMaskCanvas(e),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,r=0,s,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);let a=this.ctx;a.save();let l=In(a);a.transform(t,n,r,s,0,0);let d=this._createMaskCanvas(e);a.setTransform(1,0,0,1,d.offsetX-l[4],d.offsetY-l[5]);for(let c=0,u=o.length;c<u;c+=2){let h=$e.transform(l,[t,n,r,s,o[c],o[c+1]]),[f,p]=$e.applyTransform([0,0],h);a.drawImage(d.canvas,f,p)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(let s of e){let{data:o,width:a,height:l,transform:d}=s,c=this.cachedCanvases.getCanvas("maskCanvas",a,l),u=c.context;u.save();let h=this.getObject(o,s);H3(u,h),u.globalCompositeOperation="source-in",u.fillStyle=r?n.getPattern(u,this,Wo(t),Wi.FILL):n,u.fillRect(0,0,a,l),u.restore(),t.save(),t.transform(...d),t.scale(1,-1),Y0(t,c.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){Ot("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,r){if(!this.contentVisible)return;let s=this.getObject(e);if(!s){Ot("Dependent image isn't ready yet");return}let o=s.width,a=s.height,l=[];for(let d=0,c=r.length;d<c;d+=2)l.push({transform:[t,0,0,n,r[d],r[d+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:n,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,r),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,n=e.height,r=this.ctx;if(this.save(),!ki){let{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none")}r.scale(1/t,-1/n);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{let l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;U3(l,e),s=this.applyTransferMapsToCanvas(l)}let o=this._scaleImage(s,Wo(r));r.imageSmoothingEnabled=z3(In(r),e.interpolate),Y0(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let n=this.ctx,r;if(e.bitmap)r=e.bitmap;else{let s=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,o).context;U3(l,e),r=this.applyTransferMapsToCanvas(l)}for(let s of t)n.save(),n.transform(...s.transform),n.scale(1,-1),Y0(n,r,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let n=this.ctx;this.pendingClip&&(t||(this.pendingClip===j3?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=In(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:n,c:r,d:s}=this.ctx.getTransform(),o,a;if(n===0&&r===0){let l=Math.abs(t),d=Math.abs(s);if(l===d)if(e===0)o=a=1/l;else{let c=l*e;o=a=c<1?1/c:1}else if(e===0)o=1/l,a=1/d;else{let c=l*e,u=d*e;o=c<1?1/c:1,a=u<1?1/u:1}}else{let l=Math.abs(t*s-n*r),d=Math.hypot(t,n),c=Math.hypot(r,s);if(e===0)o=c/l,a=d/l;else{let u=e*l;o=c>u?c/u:1,a=d>u?d/u:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:n}=this.current,[r,s]=this.getScaleForStroking();if(t.lineWidth=n||1,r===1&&s===1){t.stroke();return}let o=t.getLineDash();if(e&&t.save(),t.scale(r,s),o.length>0){let a=Math.max(r,s);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let i in As)Zc.prototype[i]!==void 0&&(Zc.prototype[As[i]]=Zc.prototype[i]);var Yl=class{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}},Q0={UNKNOWN:0,DATA:1,ERROR:2},Qn={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function yr(i){switch(i instanceof Error||typeof i=="object"&&i!==null||An('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Xo(i.message);case"MissingPDFException":return new Yo(i.message);case"PasswordException":return new lf(i.message,i.code);case"UnexpectedResponseException":return new Xc(i.message,i.status);case"UnknownErrorException":return new df(i.message,i.details);default:return new df(i.message,i.toString())}}var Zl=class{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){let n=e.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Q0.DATA)r.resolve(e.data);else if(e.callback===Q0.ERROR)r.reject(yr(e.reason));else throw new Error("Unexpected callback case");return}let t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let n=this.sourceName,r=e.sourceName,s=this.comObj;new Promise(function(o){o(t(e.data))}).then(function(o){s.postMessage({sourceName:n,targetName:r,callback:Q0.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:r,callback:Q0.ERROR,callbackId:e.callbackId,reason:yr(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){let n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){let r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,n,r){let s=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:d=>{let c=Promise.withResolvers();return this.streamControllers[s]={controller:d,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:d.desiredSize},r),c.promise},pull:d=>{let c=Promise.withResolvers();return this.streamControllers[s].pullCall=c,l.postMessage({sourceName:o,targetName:a,stream:Qn.PULL,streamId:s,desiredSize:d.desiredSize}),c.promise},cancel:d=>{ri(d instanceof Error,"cancel must have a valid reason");let c=Promise.withResolvers();return this.streamControllers[s].cancelCall=c,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Qn.CANCEL,streamId:s,reason:yr(d)}),c.promise}},n)}#n(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(d,c=1,u){if(this.isCancelled)return;let h=this.desiredSize;this.desiredSize-=c,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:r,stream:Qn.ENQUEUE,streamId:t,chunk:d},u)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Qn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(d){ri(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Qn.ERROR,streamId:t,reason:yr(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(d){d(a(e.data,l))}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Qn.START_COMPLETE,streamId:t,success:!0})},function(d){s.postMessage({sourceName:n,targetName:r,stream:Qn.START_COMPLETE,streamId:t,reason:yr(d)})})}#i(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Qn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(yr(e.reason));break;case Qn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(yr(e.reason));break;case Qn.PULL:if(!a){s.postMessage({sourceName:n,targetName:r,stream:Qn.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(l){l(a.onPull?.())}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Qn.PULL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:n,targetName:r,stream:Qn.PULL_COMPLETE,streamId:t,reason:yr(l)})});break;case Qn.ENQUEUE:if(ri(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Qn.CLOSE:if(ri(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#r(o,t);break;case Qn.ERROR:ri(o,"error should have stream controller"),o.controller.error(yr(e.reason)),this.#r(o,t);break;case Qn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(yr(e.reason)),this.#r(o,t);break;case Qn.CANCEL:if(!a)break;new Promise(function(l){l(a.onCancel?.(yr(e.reason)))}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Qn.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:n,targetName:r,stream:Qn.CANCEL_COMPLETE,streamId:t,reason:yr(l)})}),a.sinkCapability.reject(yr(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}#r(e,t){return re(this,null,function*(){yield Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]})}destroy(){this.#e?.abort(),this.#e=null}},KS=class{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return qE(this.#e)}has(e){return this.#e.has(e)}},qc=Symbol("INTERNAL"),JS=class{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:n,usage:r,rbGroups:s}){this.#e=!!(e&Ar.DISPLAY),this.#t=!!(e&Ar.PRINT),this.name=t,this.intent=n,this.usage=r,this.rbGroups=s}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;let{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==qc&&An("Internal method `_setVisible` called."),this.#n=n,this.#i=t}},$S=class{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=Ar.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(let n of e.groups)this.#t.set(n.id,new JS(t,n));if(e.baseState==="OFF")for(let n of this.#t.values())n._setVisible(qc,!1);for(let n of e.on)this.#t.get(n)._setVisible(qc,!0);for(let n of e.off)this.#t.get(n)._setVisible(qc,!1);this.#n=this.getHash()}}#r(e){let t=e.length;if(t<2)return!0;let n=e[0];for(let r=1;r<t;r++){let s=e[r],o;if(Array.isArray(s))o=this.#r(s);else if(this.#t.has(s))o=this.#t.get(s).visible;else return Ot(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Ov("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ot(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#t.has(t))return Ot(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#t.has(t))return Ot(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#t.has(t))return Ot(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#t.has(t))return Ot(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ot(`Unknown optional content policy ${e.policy}.`),!0}return Ot(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){let r=this.#t.get(e);if(!r){Ot(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(let s of r.rbGroups)for(let o of s)o!==e&&this.#t.get(o)?._setVisible(qc,!1,!0);r._setVisible(qc,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(let r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}let s=this.#t.get(r);if(s)switch(n){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!s.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?qE(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;let e=new av;for(let[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}},eE=class{constructor(e,{disableRange:t=!1,disableStream:n=!1}){ri(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:r,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,s?.length>0){let l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,d)=>{this._onReceiveData({begin:l,chunk:d})}),e.addProgressListener((l,d)=>{this._onProgress({loaded:l,total:d})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{let r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(n),!0)});ri(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ri(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new tE(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new nE(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},tE=class{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=YE(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(let s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return re(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},nE=class{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return re(this,null,function*(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function TX(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let c=a(t);return c=unescape(c),c=l(c),c=d(c),s(c)}if(t=o(i),t){let c=d(t);return s(c)}if(t=n("filename","i").exec(i),t){t=t[1];let c=a(t);return c=d(c),s(c)}function n(c,u){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function r(c,u){if(c){if(!/^[\x00-\xFF]+$/.test(u))return u;try{let h=new TextDecoder(c,{fatal:!0}),f=Bv(u);u=h.decode(f),e=!1}catch{}}return u}function s(c){return e&&/[\x80-\xff]/.test(c)&&(c=r("utf-8",c),e&&(c=r("iso-8859-1",c))),c}function o(c){let u=[],h,f=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=f.exec(c))!==null;){let[,x,v,g]=h;if(x=parseInt(x,10),x in u){if(x===0)break;continue}u[x]=[v,g]}let p=[];for(let x=0;x<u.length&&x in u;++x){let[v,g]=u[x];g=a(g),v&&(g=unescape(g),x===0&&(g=l(g))),p.push(g)}return p.join("")}function a(c){if(c.startsWith('"')){let u=c.slice(1).split('\\"');for(let h=0;h<u.length;++h){let f=u[h].indexOf('"');f!==-1&&(u[h]=u[h].slice(0,f),u.length=h+1),u[h]=u[h].replaceAll(/\\(.)/g,"$1")}c=u.join('"')}return c}function l(c){let u=c.indexOf("'");if(u===-1)return c;let h=c.slice(0,u),p=c.slice(u+1).replace(/^[^']*'/,"");return r(h,p)}function d(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,h,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,v){return String.fromCharCode(parseInt(v,16))}),r(h,p);try{p=atob(p)}catch{}return r(h,p)})}return""}function QE(i,e){let t=new Headers;if(!i||!e||typeof e!="object")return t;for(let n in e){let r=e[n];r!==void 0&&t.append(n,r)}return t}function KE({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){let r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(i.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function JE(i){let e=i.get("Content-Disposition");if(e){let t=TX(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(YE(t))return t}return null}function Hv(i,e){return i===404||i===0&&e.startsWith("file:")?new Yo('Missing PDF "'+e+'".'):new Xc(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i)}function X3(i){return i===200||i===206}function Q3(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function K3(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Ot(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}var gv=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=QE(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ri(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new iE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new rE(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},iE=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let n=new Headers(e.headers),r=t.url;fetch(r,Q3(n,this._withCredentials,this._abortController)).then(s=>{if(!X3(s.status))throw Hv(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();let o=s.headers,{allowRangeRequests:a,suggestedLength:l}=KE({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=JE(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return re(this,null,function*(){yield this._headersCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:K3(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},rE=class{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;let r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;let s=new Headers(e.headers);s.append("Range",`bytes=${t}-${n-1}`);let o=r.url;fetch(o,Q3(s,this._withCredentials,this._abortController)).then(a=>{if(!X3(a.status))throw Hv(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return re(this,null,function*(){yield this._readCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:K3(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},CS=200,MS=206;function IX(i){let e=i.response;return typeof e!="string"?e:Bv(e).buffer}var sE=class{constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=QE(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){let r={begin:e,end:t};for(let s in n)r[s]=n[s];return this.request(r)}requestFull(e){return this.request(e)}request(e){let t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=MS):r.expectedStatus=CS,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){let n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){let n=this.pendingRequests[e];if(!n)return;let r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError?.(r.status);return}let s=r.status||CS;if(!(s===CS&&n.expectedStatus===MS)&&s!==n.expectedStatus){n.onError?.(r.status);return}let a=IX(r);if(s===MS){let l=r.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);n.onDone({begin:parseInt(d[1],10),chunk:a})}else a?n.onDone({begin:0,chunk:a}):n.onError?.(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},oE=class{constructor(e){this._source=e,this._manager=new sE(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ri(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new aE(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let n=new lE(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},aE=class{constructor(e,t){this._manager=e;let n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(o=>{let[a,...l]=o.split(": ");return[a,l.join(": ")]})),{allowRangeRequests:r,suggestedLength:s}=KE({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=JE(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Hv(e,this._url),this._headersCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}read(){return re(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},lE=class{constructor(e,t,n){this._manager=e;let r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=Hv(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}read(){return re(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},DX=/^[a-z][a-z0-9\-+.]+:/i;function PX(i){if(DX.test(i))return new URL(i);let e=Qs.get("url");return new URL(e.pathToFileURL(i))}function J3(i,e,t){return i.protocol==="http:"?Qs.get("http").request(i,{headers:e},t):Qs.get("https").request(i,{headers:e},t)}var dE=class{constructor(e){this.source=e,this.url=PX(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=QE(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ri(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new hE(this):new cE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=this.isFsUrl?new fE(this,e,t):new uE(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},vv=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return re(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Xo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},xv=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return re(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},cE=class extends vv{constructor(e){super(e);let t=Object.fromEntries(e.headers),n=r=>{if(r.statusCode===404){let l=new Yo(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(r);let s=new Headers(this._readableStream.headers),{allowRangeRequests:o,suggestedLength:a}=KE({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=JE(s)};this._request=J3(this._url,t,n),this._request.on("error",r=>{this._storedError=r,this._headersCapability.reject(r)}),this._request.end()}},uE=class extends xv{constructor(e,t,n){super(e);let r=Object.fromEntries(e.headers);r.Range=`bytes=${t}-${n-1}`;let s=o=>{if(o.statusCode===404){let a=new Yo(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(o)};this._request=J3(this._url,r,s),this._request.on("error",o=>{this._storedError=o}),this._request.end()}},hE=class extends vv{constructor(e){super(e);let t=Qs.get("fs");t.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Yo(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}},fE=class extends xv{constructor(e,t,n){super(e);let r=Qs.get("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:n-1}))}},RX=1e5,sr=30,LX=.8,gf=class i{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#l=0;#d=0;#c=null;#a=null;#u=0;#o=0;#h=Object.create(null);#p=[];#f=null;#m=[];#v=new WeakMap;#g=null;static#x=new Map;static#b=new Map;static#_=new WeakMap;static#y=null;static#A=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#a=t,this.#o=n.scale*(globalThis.devicePixelRatio||1),this.#u=n.rotation,this.#s={div:null,properties:null,ctx:null};let{pageWidth:r,pageHeight:s,pageX:o,pageY:a}=n.rawDims;this.#g=[1,0,0,-1,-o,a+s],this.#d=r,this.#l=s,i.#P(),Xl(t,n),this.#e.promise.finally(()=>{i.#A.delete(this),this.#s=null,this.#h=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=Ai.platform;return Gt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){let e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#h,t.styles),this.#D(t.items),e()},this.#e.reject)};return this.#c=this.#f.getReader(),i.#A.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){let n=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#u&&(t?.(),this.#u=r,Xl(this.#a,{rotation:r})),n!==this.#o){t?.(),this.#o=n;let s={div:null,properties:null,ctx:i.#T(this.#r)};for(let o of this.#m)s.properties=this.#v.get(o),s.div=o,this.#S(s)}}cancel(){let e=new Xo("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#p}#D(e){if(this.#n)return;this.#s.ctx??=i.#T(this.#r);let t=this.#m,n=this.#p;for(let r of e){if(t.length>RX){Ot("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){let s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),s.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(r.str),this.#M(r)}}#M(e){let t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#m.push(t);let r=$e.transform(this.#g,e.transform),s=Math.atan2(r[1],r[0]),o=this.#h[e.fontName];o.vertical&&(s+=Math.PI/2);let a=this.#i&&o.fontSubstitution||o.fontFamily;a=i.fontFamilyMap.get(a)||a;let l=Math.hypot(r[2],r[3]),d=l*i.#L(a,this.#r),c,u;s===0?(c=r[4],u=r[5]-d):(c=r[4]+d*Math.sin(s),u=r[5]-d*Math.cos(s));let h="calc(var(--scale-factor)*",f=t.style;this.#t===this.#a?(f.left=`${(100*c/this.#d).toFixed(2)}%`,f.top=`${(100*u/this.#l).toFixed(2)}%`):(f.left=`${h}${c.toFixed(2)}px)`,f.top=`${h}${u.toFixed(2)}px)`),f.fontSize=`${h}${(i.#y*l).toFixed(2)}px)`,f.fontFamily=a,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(n.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let x=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);x!==v&&Math.max(x,v)/Math.min(x,v)>1.5&&(p=!0)}if(p&&(n.canvasWidth=o.vertical?e.height:e.width),this.#v.set(t,n),this.#s.div=t,this.#s.properties=n,this.#S(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){let x=document.createElement("br");x.setAttribute("role","presentation"),this.#t.append(x)}}#S(e){let{div:t,properties:n,ctx:r}=e,{style:s}=t,o="";if(i.#y>1&&(o=`scale(${1/i.#y})`),n.canvasWidth!==0&&n.hasText){let{fontFamily:a}=s,{canvasWidth:l,fontSize:d}=n;i.#C(r,d*this.#o,a);let{width:c}=r.measureText(t.textContent);c>0&&(o=`scaleX(${l*this.#o/c}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)}static cleanup(){if(!(this.#A.size>0)){this.#x.clear();for(let{canvas:e}of this.#b.values())e.remove();this.#b.clear()}}static#T(e=null){let t=this.#b.get(e||="");if(!t){let n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(e,t),this.#_.set(t,{size:0,family:""})}return t}static#C(e,t,n){let r=this.#_.get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)}static#P(){if(this.#y!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#y=e.getBoundingClientRect().height,e.remove()}static#L(e,t){let n=this.#x.get(e);if(n)return n;let r=this.#T(t);r.canvas.width=r.canvas.height=sr,this.#C(r,sr,e);let s=r.measureText(""),o=s.fontBoundingBoxAscent,a=Math.abs(s.fontBoundingBoxDescent);if(o){let c=o/(o+a);return this.#x.set(e,c),r.canvas.width=r.canvas.height=0,c}r.strokeStyle="red",r.clearRect(0,0,sr,sr),r.strokeText("g",0,0);let l=r.getImageData(0,0,sr,sr).data;a=0;for(let c=l.length-1-3;c>=0;c-=4)if(l[c]>0){a=Math.ceil(c/4/sr);break}r.clearRect(0,0,sr,sr),r.strokeText("A",0,sr),l=r.getImageData(0,0,sr,sr).data,o=0;for(let c=0,u=l.length;c<u;c+=4)if(l[c]>0){o=sr-Math.floor(c/4/sr);break}r.canvas.width=r.canvas.height=0;let d=o?o/(o+a):LX;return this.#x.set(e,d),d}},vf=class i{static textContent(e){let t=[],n={items:t,styles:Object.create(null)};function r(s){if(!s)return;let o=null,a=s.name;if(a==="#text")o=s.value;else if(i.shouldBuildText(a))s?.attributes?.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(let l of s.children)r(l)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},kX=65536,NX=100,FX=5e3,OX=ki?jS:US,BX=ki?GS:uv,VX=ki?zS:HS,UX=ki?WS:pv;function HX(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});let e=new pE,{docId:t}=e,n=i.url?zX(i.url):null,r=i.data?jX(i.data):null,s=i.httpHeaders||null,o=i.withCredentials===!0,a=i.password??null,l=i.range instanceof wv?i.range:null,d=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:kX,c=i.worker instanceof Yc?i.worker:null,u=i.verbosity,h=typeof i.docBaseUrl=="string"&&!Uv(i.docBaseUrl)?i.docBaseUrl:null,f=typeof i.cMapUrl=="string"?i.cMapUrl:null,p=i.cMapPacked!==!1,x=i.CMapReaderFactory||BX,v=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,g=i.StandardFontDataFactory||UX,y=i.stopAtErrors!==!0,b=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,A=i.isEvalSupported!==!1,M=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!ki,T=typeof i.isChrome=="boolean"?i.isChrome:!Ai.platform.isFirefox&&typeof window<"u"&&!!window?.chrome,I=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,L=typeof i.disableFontFace=="boolean"?i.disableFontFace:ki,E=i.fontExtraProperties===!0,S=i.enableXfa===!0,P=i.ownerDocument||globalThis.document,j=i.disableRange===!0,B=i.disableStream===!0,z=i.disableAutoFetch===!0,X=i.pdfBug===!0,Q=i.CanvasFactory||OX,K=i.FilterFactory||VX,Y=i.enableHWA===!0,Ae=l?l.length:i.length??NaN,Ce=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!ki&&!L,Ie=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:x===uv&&g===pv&&f&&v&&of(f,document.baseURI)&&of(v,document.baseURI);i.canvasFactory&&R3("`canvasFactory`-instance option, please use `CanvasFactory` instead."),i.filterFactory&&R3("`filterFactory`-instance option, please use `FilterFactory` instead.");let He=null;nX(u);let at={canvasFactory:new Q({ownerDocument:P,enableHWA:Y}),filterFactory:new K({docId:t,ownerDocument:P}),cMapReaderFactory:Ie?null:new x({baseUrl:f,isCompressed:p}),standardFontDataFactory:Ie?null:new g({baseUrl:v})};if(!c){let Pe={verbosity:u,port:Yl.workerPort};c=Pe.port?Yc.fromPort(Pe):new Yc(Pe),e._worker=c}let le={docId:t,apiVersion:"4.8.69",data:r,password:a,disableAutoFetch:z,rangeChunkSize:d,length:Ae,docBaseUrl:h,enableXfa:S,evaluatorOptions:{maxImageSize:b,disableFontFace:L,ignoreErrors:y,isEvalSupported:A,isOffscreenCanvasSupported:M,isChrome:T,canvasMaxAreaInBytes:I,fontExtraProperties:E,useSystemFonts:Ce,cMapUrl:Ie?f:null,standardFontDataUrl:Ie?v:null}},be={disableFontFace:L,fontExtraProperties:E,ownerDocument:P,pdfBug:X,styleElement:He,loadingParams:{disableAutoFetch:z,enableXfa:S}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");let Pe=c.messageHandler.sendWithPromise("GetDocRequest",le,r?[r.buffer]:null),he;if(l)he=new eE(l,{disableRange:j,disableStream:B});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");let Ge;ki?Ge=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&of(n)?gv:dE:Ge=of(n)?gv:oE,he=new Ge({url:n,length:Ae,httpHeaders:s,withCredentials:o,rangeChunkSize:d,disableRange:j,disableStream:B})}return Pe.then(Ge=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");let ct=new Zl(t,Ge,c.port),dt=new xE(ct,e,he,be,at);e._transport=dt,ct.send("Ready",null)})}).catch(e._capability.reject),e}function zX(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(ki&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function jX(i){if(ki&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Bv(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function G3(i){return typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0}var pE=class i{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${i.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return re(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}},wv=class{constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){An("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},mE=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},gE=class{#e=null;#t=!1;constructor(e,t,n,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new rv:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new bv,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:s=!1}={}){return new cf({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return re(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:r=Ya.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:d=null,printAnnotationStorage:c=null,isEditing:u=!1}){this._stats?.time("Overall");let h=this._transport.getRenderingIntent(n,r,c,u),{renderingIntent:f,cacheKey:p}=h;this.#t=!1,this.#i(),a||=this._transport.getOptionalContentConfig(f);let x=this._intentStates.get(p);x||(x=Object.create(null),this._intentStates.set(p,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);let v=!!(f&Ar.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));let g=A=>{x.renderTasks.delete(y),(this._maybeCleanupAfterRender||v)&&(this.#t=!0),this.#n(!v),A?(y.capability.reject(A),this._abortOperatorList({intentState:x,reason:A instanceof Error?A:new Error(A)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new bE({callback:g,params:{canvasContext:e,viewport:t,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:d});(x.renderTasks||=new Set).add(y);let b=y.task;return Promise.all([x.displayReadyCapability.promise,a]).then(([A,M])=>{if(this.destroyed){g();return}if(this._stats?.time("Rendering"),!(M.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:A,optionalContentConfig:M}),y.operatorListChanged()}).catch(g),b}getOperatorList({intent:e="display",annotationMode:t=Ya.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}let o=this._transport.getRenderingIntent(e,t,n,r,!0),a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>vf.textContent(n));let t=this.streamTextContent(e);return new Promise(function(n,r){function s(){o.read().then(function({value:l,done:d}){if(d){n(a);return}a.lang??=l.lang,Object.assign(a.styles,l.styles),a.items.push(...l.items),s()},r)}let o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let t=this.#n(!1);return e&&t&&(this._stats&&=new rv),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},FX),!1;for(let{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){let n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){let{map:s,transfer:o}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},o).getReader(),d=this._intentStates.get(t);d.streamReader=l;let c=()=>{l.read().then(({value:u,done:h})=>{if(h){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,d),c())},u=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(let h of d.renderTasks)h.operatorListChanged();this.#n(!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(u);else if(d.opListReadCapability)d.opListReadCapability.reject(u);else throw u}})};c()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof uf){let r=NX;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Xo(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}},vE=class{#e=new Map;#t=Promise.resolve();postMessage(e,t){let n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(let[r]of this.#e)r.call(this,n)})}addEventListener(e,t,n=null){let r=null;if(n?.signal instanceof AbortSignal){let{signal:s}=n;if(s.aborted){Ot("LoopbackPort - cannot use an `aborted` signal.");return}let o=()=>this.removeEventListener(e,t);r=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(let[,e]of this.#e)e?.();this.#e.clear()}},Yc=class i{static#e=0;static#t=!1;static#n;static{ki&&(this.#t=!0,Yl.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}let r=new URL(t,n);return n.origin===r.origin},this._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:n=iX()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(i.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(i.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return ki?Promise.all([Qs.promise,this._readyCapability.promise]):this._readyCapability.promise}#i(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Zl("main","worker",e),this._messageHandler.on("ready",function(){}),this.#i()}_initialize(){if(i.#t||i.#r){this._setupFakeWorker();return}let{workerSrc:e}=i;try{i._isSameOrigin(window.location.href,e)||(e=i._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),n=new Zl("main","worker",t),r=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:s.signal}),n.on("test",a=>{if(s.abort(),this.destroyed||!a){r();return}this._messageHandler=n,this._port=t,this._webWorker=t,this.#i()}),n.on("ready",a=>{if(s.abort(),this.destroyed){r();return}try{o()}catch{this._setupFakeWorker()}});let o=()=>{let a=new Uint8Array;n.send("test",a,[a.buffer])};o();return}catch{Ov("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){i.#t||(Ot("Setting up fake worker."),i.#t=!0),i._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new vE;this._port=t;let n=`fake${i.#e++}`,r=new Zl(n+"_worker",n,t);e.setup(r,t),this._messageHandler=new Zl(n,n+"_worker",t),this.#i()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),i.#n?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new i(e)}static get workerSrc(){if(Yl.workerSrc)return Yl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#r(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Gt(this,"_setupFakeWorkerGlobal",re(this,null,function*(){return this.#r?this.#r:(yield import(this.workerSrc)).WorkerMessageHandler}))}},xE=class{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#r=null;constructor(e,t,n,r,s){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new bv,this.fontLoader=new BS({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){let n=this.#e.get(e);if(n)return n;let r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return Gt(this,"annotationStorage",new pf)}getRenderingIntent(e,t=Ya.ENABLE,n=null,r=!1,s=!1){let o=Ar.DISPLAY,a=OS;switch(e){case"any":o=Ar.ANY;break;case"display":break;case"print":o=Ar.PRINT;break;default:Ot(`getRenderingIntent - invalid intent: ${e}`)}let l=o&Ar.PRINT&&n instanceof lv?n:this.annotationStorage;switch(t){case Ya.DISABLE:o+=Ar.ANNOTATIONS_DISABLE;break;case Ya.ENABLE:break;case Ya.ENABLE_FORMS:o+=Ar.ANNOTATIONS_FORMS;break;case Ya.ENABLE_STORAGE:o+=Ar.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ot(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=Ar.IS_EDITING),s&&(o+=Ar.OPLIST);let{ids:d,hash:c}=l.modifiedIds,u=[o,a.hash,c];return{renderingIntent:o,cacheKey:u.join("_"),annotationStorageSerializable:a,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),gf.cleanup(),this._networkStream?.cancelAllRequests(new Xo("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{ri(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){r.close();return}ri(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",n=>re(this,null,function*(){yield this._fullReader.headersReady;let{isStreamingSupported:r,isRangeSupported:s,contentLength:o}=this._fullReader;return(!r||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:o}})),e.on("GetRangeReader",(n,r)=>{ri(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){r.close();return}ri(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{s.cancel(o),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new mE(n,this))}),e.on("DocException",function(n){let r;switch(n.name){case"PasswordException":r=new lf(n.message,n.code);break;case"InvalidPDFException":r=new iv(n.message);break;case"MissingPDFException":r=new Yo(n.message);break;case"UnexpectedResponseException":r=new Xc(n.message,n.status);break;case"UnknownErrorException":r=new df(n.message,n.details);break;default:An("DocException - expected a valid Error.")}t._capability.reject(r)}),e.on("PasswordRequest",n=>{if(this.#r=Promise.withResolvers(),t.onPassword){let r=s=>{s instanceof Error?this.#r.reject(s):this.#r.resolve({password:s})};try{t.onPassword(r,n.code)}catch(s){this.#r.reject(s)}}else this.#r.reject(new lf(n.message,n.code));return this.#r.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,s])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":let{disableFontFace:o,fontExtraProperties:a,pdfBug:l}=this._params;if("error"in s){let h=s.error;Ot(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}let d=l&&globalThis.FontInspector?.enabled?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,c=new VS(s,{disableFontFace:o,inspectFont:d});this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!a&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":let{imageRef:u}=s;ri(u,"The imageRef must be defined.");for(let h of this.#t.values())for(let[,f]of h.objs)if(f?.ref===u)return f.dataLen?(this.commonObjs.resolve(n,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,s,o])=>{if(this.destroyed)return;let a=this.#t.get(r);if(!a.objs.has(n)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(s){case"Image":a.objs.resolve(n,o),o?.dataLen>KY&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",n=>re(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)})),e.on("FetchStandardFontData",n=>re(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ot("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,n=this.#n.get(t);if(n)return n;let r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#i.set(s.refStr,e);let o=new gE(t,s,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,r),r}getPageIndex(e){return G3(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new $S(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#e.get(e);if(t)return t;let n=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new KS(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return re(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),gf.cleanup()}})}cachedPageNumber(e){if(!G3(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}},K0=Symbol("INITIAL_DATA"),bv=class{#e=Object.create(null);#t(e){return this.#e[e]||=We(ae({},Promise.withResolvers()),{data:K0})}get(e,t=null){if(t){let r=this.#t(e);return r.promise.then(()=>t(r.data)),null}let n=this.#e[e];if(!n||n.data===K0)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){let t=this.#e[e];return!!t&&t.data!==K0}resolve(e,t=null){let n=this.#t(e);n.data=t,n.resolve()}clear(){for(let e in this.#e){let{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(let e in this.#e){let{data:t}=this.#e[e];t!==K0&&(yield[e,t])}}},wE=class{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}},bE=class i{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:d,useRequestAnimationFrame:c=!1,pdfBug:u=!1,pageColors:h=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=d,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new wE(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(i.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");i.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:n,viewport:r,transform:s,background:o}=this.params;this.gfx=new Zc(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),i.#t.delete(this._canvas),this.callback(e||new uf(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return re(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),i.#t.delete(this._canvas),this.callback())))})}},GX="4.8.69",WX="3634dab10";function W3(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function sf(i){return Math.max(0,Math.min(255,255*i))}var yv=class{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=sf(e),[e,e,e]}static G_HTML([e]){let t=W3(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(sf)}static RGB_HTML(e){return`#${e.map(W3).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[sf(1-Math.min(1,e+r)),sf(1-Math.min(1,n+r)),sf(1-Math.min(1,t+r))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){let r=1-e,s=1-t,o=1-n,a=Math.min(r,s,o);return["CMYK",r,s,o,a]}},yE=class{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){An("Abstract method `_createSVG` called.")}},xf=class extends yE{_createSVG(e){return document.createElementNS(qo,e)}},Av=class{static setupStorage(e,t,n,r,s){let o=r.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{r.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(let a of n.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{let l=a.target.options,d=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:s}){let{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(let[l,d]of Object.entries(o))if(d!=null)switch(l){case"class":d.length&&e.setAttribute(l,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,d)}a&&s.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){let t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,s=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:s,linkService:n});let a=s!=="richText",l=e.div;if(l.append(o),e.viewport){let u=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=u}a&&l.setAttribute("class","xfaLayer xfaFont");let d=[];if(r.children.length===0){if(r.value){let u=document.createTextNode(r.value);o.append(u),a&&vf.shouldBuildText(r.name)&&d.push(u)}return{textDivs:d}}let c=[[r,-1,o]];for(;c.length>0;){let[u,h,f]=c.at(-1);if(h+1===u.children.length){c.pop();continue}let p=u.children[++c.at(-1)[1]];if(p===null)continue;let{name:x}=p;if(x==="#text"){let g=document.createTextNode(p.value);d.push(g),f.append(g);continue}let v=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,x):document.createElement(x);if(f.append(v),p.attributes&&this.setAttributes({html:v,element:p,storage:t,intent:s,linkService:n}),p.children?.length>0)c.push([p,-1,v]);else if(p.value){let g=document.createTextNode(p.value);a&&vf.shouldBuildText(x)&&d.push(g),v.append(g)}}for(let u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},Af=1e3,qX=9,Kl=new WeakSet;function Zo(i){return{width:i[2]-i[0],height:i[3]-i[1]}}var AE=class{static create(e){switch(e.data.annotationType){case ii.LINK:return new _v(e);case ii.TEXT:return new _E(e);case ii.WIDGET:switch(e.data.fieldType){case"Tx":return new SE(e);case"Btn":return e.data.radioButton?new Sv(e):e.data.checkBox?new CE(e):new ME(e);case"Ch":return new TE(e);case"Sig":return new EE(e)}return new Qo(e);case ii.POPUP:return new wf(e);case ii.FREETEXT:return new Ev(e);case ii.LINE:return new DE(e);case ii.SQUARE:return new PE(e);case ii.CIRCLE:return new RE(e);case ii.POLYLINE:return new Cv(e);case ii.CARET:return new kE(e);case ii.INK:return new bf(e);case ii.POLYGON:return new LE(e);case ii.HIGHLIGHT:return new Mv(e);case ii.UNDERLINE:return new NE(e);case ii.SQUIGGLY:return new FE(e);case ii.STRIKEOUT:return new OE(e);case ii.STAMP:return new Tv(e);case ii.FILEATTACHMENT:return new BE(e);default:return new Hn(e)}}},Hn=class i{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return i._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){let{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}}}=this;n?.splice(0,4,...e);let{width:d,height:c}=Zo(e);t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+l)/o}%`,r===0?(t.width=`${100*d/s}%`,t.height=`${100*c/o}%`):this.setRotation(r)}_createContainer(e){let{data:t,parent:{page:n,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof Qo||(s.tabIndex=Af);let{style:o}=s;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof wf){let{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,s),s}let{width:a,height:l}=Zo(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;let x=t.borderStyle.horizontalCornerRadius,v=t.borderStyle.verticalCornerRadius;if(x>0||v>0){let y=`calc(${x}px * var(--scale-factor)) / calc(${v}px * var(--scale-factor))`;o.borderRadius=y}else if(this instanceof Sv){let y=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=y}switch(t.borderStyle.style){case nf.SOLID:o.borderStyle="solid";break;case nf.DASHED:o.borderStyle="dashed";break;case nf.BEVELED:Ot("Unimplemented border style: beveled");break;case nf.INSET:Ot("Unimplemented border style: inset");break;case nf.UNDERLINE:o.borderBottomStyle="solid";break;default:break}let g=t.borderColor||null;g?(this.#t=!0,o.borderColor=$e.makeHexColor(g[0]|0,g[1]|0,g[2]|0)):o.borderWidth=0}let d=$e.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:u,pageX:h,pageY:f}=r.rawDims;o.left=`${100*(d[0]-h)/c}%`,o.top=`${100*(d[1]-f)/u}%`;let{rotation:p}=t;return t.hasOwnCanvas||p===0?(o.width=`${100*a/c}%`,o.height=`${100*l/u}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:s,height:o}=Zo(this.data.rect),a,l;e%180===0?(a=100*s/n,l=100*o/r):(a=100*o/n,l=100*s/r),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,n,r)=>{let s=r.detail[t],o=s[0],a=s.slice(1);r.target.style[n]=yv[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[n]:yv[`${o}_rgb`](a)})};return Gt(this,"_commonActions",{display:t=>{let{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){let n=this._commonActions;for(let r of Object.keys(t.detail))(e[r]||n[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let n=this._commonActions;for(let[r,s]of Object.entries(t)){let o=n[r];if(o){let a={detail:{[r]:s},target:e};o(a),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,n,r,s]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){let[x,v,g,y]=e.subarray(2,6);if(r===x&&s===v&&t===g&&n===y)return}let{style:o}=this.container,a;if(this.#t){let{borderColor:x,borderWidth:v}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${v}">`],this.container.classList.add("hasBorder")}let l=r-t,d=s-n,{svgFactory:c}=this,u=c.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);let h=c.createElement("defs");u.append(h);let f=c.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),h.append(f);for(let x=2,v=e.length;x<v;x+=8){let g=e[x],y=e[x+1],b=e[x+2],A=e[x+3],M=c.createElement("rect"),T=(b-t)/l,I=(s-y)/d,L=(g-b)/l,E=(y-A)/d;M.setAttribute("x",T),M.setAttribute("y",I),M.setAttribute("width",L),M.setAttribute("height",E),f.append(M),a?.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${I}" width="${L}" height="${E}"/>`)}this.#t&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath=`url(#${p})`}_createPopup(){let{data:e}=this,t=this.#n=new wf({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){An("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let n=[];if(this._fieldObjects){let r=this._fieldObjects[e];if(r)for(let{page:s,id:o,exportValues:a}of r){if(s===-1||o===t)continue;let l=typeof a=="string"?a:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!Kl.has(d)){Ot(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:l,domElement:d})}return n}for(let r of document.getElementsByName(e)){let{exportValue:s}=r,o=r.getAttribute("data-element-id");o!==t&&Kl.has(r)&&n.push({id:o,exportValue:s,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},_v=class extends Hn{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#n(n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let r of Object.keys(t.actions)){let s=n.get(r);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){let n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ot('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();let{fields:r,refs:s,include:o}=t,a=[];if(r.length!==0||s.length!==0){let c=new Set(s);for(let u of r){let h=this._fieldObjects[u]||[];for(let{id:f}of h)c.add(f)}for(let u of Object.values(this._fieldObjects))for(let h of u)c.has(h.id)===o&&a.push(h)}else for(let c of Object.values(this._fieldObjects))a.push(...c);let l=this.annotationStorage,d=[];for(let c of a){let{id:u}=c;switch(d.push(u),c.type){case"text":{let f=c.defaultValue||"";l.setValue(u,{value:f});break}case"checkbox":case"radiobutton":{let f=c.defaultValue===c.exportValues;l.setValue(u,{value:f});break}case"combobox":case"listbox":{let f=c.defaultValue||"";l.setValue(u,{value:f});break}default:continue}let h=document.querySelector(`[data-element-id="${u}"]`);if(h){if(!Kl.has(h)){Ot(`_bindResetFormAction - element not allowed: ${u}`);continue}}else continue;h.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}},_E=class extends Hn{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},Qo=class extends Hn{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ai.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,s){n.includes("mouse")?e.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o)}})})}_setEventListeners(e,t,n,r){for(let[s,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":$e.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||qX,s=e.style,o,a=2,l=d=>Math.round(10*d)/10;if(this.data.multiLine){let d=Math.abs(this.data.rect[3]-this.data.rect[1]-a),c=Math.round(d/($0*r))||1,u=d/c;o=Math.min(r,l(u/$0))}else{let d=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(r,l(d/$0))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=$e.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},SE=class extends Qo{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){let s=this.annotationStorage;for(let o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),s.setValue(o.id,{[r]:n})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){let r=e.getValue(t,{value:this.data.fieldValue}),s=r.value||"",o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let a=r.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));let l={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=a??s,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",a??s),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Kl.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Af,this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",c=>{e.setValue(t,{value:c.target.value}),this.setPropertyOnSiblings(n,"value",c.target.value,"value"),l.formattedValue=null}),n.addEventListener("resetform",c=>{let u=this.data.defaultFieldValue??"";n.value=l.userValue=u,l.formattedValue=null});let d=c=>{let{formattedValue:u}=l;u!=null&&(c.target.value=u),c.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",u=>{if(l.focused)return;let{target:h}=u;l.userValue&&(h.value=l.userValue),l.lastCommittedValue=h.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),n.addEventListener("updatefromsandbox",u=>{this.showElementAndHideCanvas(u.target);let h={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){let{formattedValue:p}=f.detail;l.formattedValue=p,p!=null&&f.target!==document.activeElement&&(f.target.value=p),e.setValue(t,{formattedValue:p})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{let{charLimit:p}=f.detail,{target:x}=f;if(p===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",p);let v=l.userValue;!v||v.length<=p||(v=v.slice(0,p),x.value=l.userValue=v,e.setValue(t,{value:v}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(h,u)}),n.addEventListener("keydown",u=>{l.commitKey=1;let h=-1;if(u.key==="Escape"?h=0:u.key==="Enter"&&!this.data.multiLine?h=2:u.key==="Tab"&&(l.commitKey=3),h===-1)return;let{value:f}=u.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:h,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}))});let c=d;d=null,n.addEventListener("blur",u=>{if(!l.focused||!u.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);let{value:h}=u.target;l.userValue=h,l.lastCommittedValue!==h&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,willCommit:!0,commitKey:l.commitKey,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}),c(u)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",u=>{l.lastCommittedValue=null;let{data:h,target:f}=u,{value:p,selectionStart:x,selectionEnd:v}=f,g=x,y=v;switch(u.inputType){case"deleteWordBackward":{let b=p.substring(0,x).match(/\w*[^\w]*$/);b&&(g-=b[0].length);break}case"deleteWordForward":{let b=p.substring(x).match(/^[^\w]*\w*/);b&&(y+=b[0].length);break}case"deleteContentBackward":x===v&&(g-=1);break;case"deleteContentForward":x===v&&(y+=1);break}u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:h||"",willCommit:!1,selStart:g,selEnd:y}})}),this._setEventListeners(n,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.value)}if(d&&n.addEventListener("blur",d),this.data.comb){let u=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},EE=class extends Qo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},CE=class extends Qo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let s=document.createElement("input");return Kl.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=Af,s.addEventListener("change",o=>{let{name:a,checked:l}=o.target;for(let d of this._getElementsByName(a,n)){let c=l&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=c),e.setValue(d.id,{value:c})}e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{let a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},Sv=class extends Qo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(let o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});let s=document.createElement("input");if(Kl.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=Af,s.addEventListener("change",o=>{let{name:a,checked:l}=o.target;for(let d of this._getElementsByName(a,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){let o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{let l={value:d=>{let c=o===d.detail.value;for(let u of this._getElementsByName(d.target.name)){let h=c&&u.id===n;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},ME=class extends _v{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}},TE=class extends Qo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Kl.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=Af;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",c=>{let u=this.data.defaultFieldValue;for(let h of r.options)h.selected=h.value===u});for(let c of this.data.options){let u=document.createElement("option");u.textContent=c.displayValue,u.value=c.exportValue,n.value.includes(c.exportValue)&&(u.setAttribute("selected",!0),s=!1),r.append(u)}let o=null;if(s){let c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),r.prepend(c),o=()=>{c.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}let a=c=>{let u=c?"value":"textContent",{options:h,multiple:f}=r;return f?Array.prototype.filter.call(h,p=>p.selected).map(p=>p[u]):h.selectedIndex===-1?null:h[h.selectedIndex][u]},l=a(!1),d=c=>{let u=c.target.options;return Array.prototype.map.call(u,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",c=>{let u={value(h){o?.();let f=h.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(let x of r.options)x.selected=p.has(x.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(h){r.multiple=!0},remove(h){let f=r.options,p=h.detail.remove;f[p].selected=!1,r.remove(p),f.length>0&&Array.prototype.findIndex.call(f,v=>v.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:a(!0),items:d(h)}),l=a(!1)},clear(h){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(h){let{index:f,displayValue:p,exportValue:x}=h.detail.insert,v=r.children[f],g=document.createElement("option");g.textContent=p,g.value=x,v?v.before(g):r.append(g),e.setValue(t,{value:a(!0),items:d(h)}),l=a(!1)},items(h){let{items:f}=h.detail;for(;r.length!==0;)r.remove(0);for(let p of f){let{displayValue:x,exportValue:v}=p,g=document.createElement("option");g.textContent=x,g.value=v,r.append(g)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:a(!0),items:d(h)}),l=a(!1)},indices(h){let f=new Set(h.detail.indices);for(let p of h.target.options)p.selected=f.has(p.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(u,c)}),r.addEventListener("input",c=>{let u=a(!0),h=a(!1);e.setValue(t,{value:u}),c.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:h,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):r.addEventListener("input",function(c){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},wf=class extends Hn{constructor(e){let{data:t,elements:n}=e;super(e,{isRenderable:Hn._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new IE({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${ZE}${n}`).join(",")),this.container}},IE=class{#e=this.#D.bind(this);#t=this.#C.bind(this);#n=this.#T.bind(this);#i=this.#S.bind(this);#r=null;#s=null;#l=null;#d=null;#c=null;#a=null;#u=null;#o=!1;#h=null;#p=null;#f=null;#m=null;#v=null;#g=null;#x=!1;constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:d,parentRect:c,open:u}){this.#s=e,this.#v=r,this.#l=o,this.#m=a,this.#a=l,this.#r=t,this.#f=d,this.#u=c,this.#c=n,this.#d=sv.toDateObject(s),this.trigger=n.flatMap(h=>h.getElementsToTriggerPopup());for(let h of this.trigger)h.addEventListener("click",this.#i),h.addEventListener("mouseenter",this.#n),h.addEventListener("mouseleave",this.#t),h.classList.add("popupTriggerArea");for(let h of n)h.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,u&&this.#S()}render(){if(this.#h)return;let e=this.#h=document.createElement("div");if(e.className="popup",this.#r){let s=e.style.outlineColor=$e.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=$e.makeHexColor(...this.#r.map(a=>Math.floor(.7*(255-a)+a)))}let t=document.createElement("span");t.className="header";let n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#v,e.append(t),this.#d){let s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#d.valueOf()})),t.append(s)}let r=this.#b;if(r)Av.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let s=this._formatContents(this.#l);e.append(s)}this.#s.append(e)}get#b(){let e=this.#m,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#_(){return this.#b?.attributes?.style?.fontSize||0}get#y(){return this.#b?.attributes?.style?.color||null}#A(e){let t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#y,fontSize:this.#_?`calc(${this.#_}px * var(--scale-factor))`:""}};for(let s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return n}_formatContents({str:e,dir:t}){let n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;let r=e.split(/(?:\r\n?|\n)/);for(let s=0,o=r.length;s<o;++s){let a=r[s];n.append(document.createTextNode(a)),s<o-1&&n.append(document.createElement("br"))}return n}#D(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#o)&&this.#S()}updateEdited({rect:e,popupContent:t}){this.#g||={contentsObj:this.#l,richText:this.#m},e&&(this.#p=null),t&&(this.#m=this.#A(t),this.#l=null),this.#h?.remove(),this.#h=null}resetEdited(){this.#g&&({contentsObj:this.#l,richText:this.#m}=this.#g,this.#g=null,this.#h?.remove(),this.#h=null,this.#p=null)}#M(){if(this.#p!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:s}}}=this.#a,o=!!this.#u,a=o?this.#u:this.#f;for(let p of this.#c)if(!a||$e.intersect(p.data.rect,a)!==null){a=p.data.rect,o=!0;break}let l=$e.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),c=o?a[2]-a[0]+5:0,u=l[0]+c,h=l[1];this.#p=[100*(u-r)/t,100*(h-s)/n];let{style:f}=this.#s;f.left=`${this.#p[0]}%`,f.top=`${this.#p[1]}%`}#S(){this.#o=!this.#o,this.#o?(this.#T(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#e)):(this.#C(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#e))}#T(){this.#h||this.render(),this.isVisible?this.#o&&this.#s.classList.add("focused"):(this.#M(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#o||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#s.hidden=!0)}maybeShow(){this.#x&&(this.#h||this.#T(),this.#x=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}},Ev=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Rt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},DE=class extends Hn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:n}=Zo(e.rect),r=this.svgFactory.create(t,n,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},PE=class extends Hn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:n}=Zo(e.rect),r=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",t-s),o.setAttribute("height",n-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},RE=class extends Hn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:n}=Zo(e.rect),r=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-s/2),o.setAttribute("ry",n/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Cv=class extends Hn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:n,popupRef:r}}=this;if(!t)return this.container;let{width:s,height:o}=Zo(e),a=this.svgFactory.create(s,o,!0),l=[];for(let c=0,u=t.length;c<u;c+=2){let h=t[c]-e[0],f=e[3]-t[c+1];l.push(`${h},${f}`)}l=l.join(" ");let d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",l),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),a.append(d),this.container.append(a),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},LE=class extends Cv{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},kE=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},bf=class extends Hn{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Rt.HIGHLIGHT:Rt.INK}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,inkLists:t,borderStyle:n,popupRef:r}}=this,{width:s,height:o}=Zo(e),a=this.svgFactory.create(s,o,!0);for(let l of t){let d=[];for(let u=0,h=l.length;u<h;u+=2){let f=l[u]-e[0],p=e[3]-l[u+1];d.push(`${f},${p}`)}d=d.join(" ");let c=this.svgFactory.createElement(this.svgElementName);this.#e.push(c),c.setAttribute("points",d),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(a),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Mv=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Rt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},NE=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},FE=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},OE=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},Tv=class extends Hn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Rt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},BE=class extends Hn{#e=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",ae({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;let{isMac:r}=Ai.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(r?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},VE=class{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:s,viewport:o,structTreeLayer:a}){this.div=e,this.#e=t,this.#t=n,this.#i=a||null,this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}#r(e,t){return re(this,null,function*(){let n=e.firstChild||e,r=n.id=`${ZE}${t}`,s=yield this.#i?.getAriaAttributes(r);if(s)for(let[o,a]of s)n.setAttribute(o,a);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1)})}render(e){return re(this,null,function*(){let{annotations:t}=e,n=this.div;Xl(n,this.viewport);let r=new Map,s={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new xf,annotationStorage:e.annotationStorage||new pf,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let o of t){if(o.noHTML)continue;let a=o.annotationType===ii.POPUP;if(a){let c=r.get(o.id);if(!c)continue;s.elements=c}else{let{width:c,height:u}=Zo(o.rect);if(c<=0||u<=0)continue}s.data=o;let l=AE.create(s);if(!l.isRenderable)continue;if(!a&&o.popupRef){let c=r.get(o.popupRef);c?c.push(l):r.set(o.popupRef,[l])}let d=l.render();o.hidden&&(d.style.visibility="hidden"),yield this.#r(d,o.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#s()})}update({viewport:e}){let t=this.div;this.viewport=e,Xl(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;let e=this.div;for(let[t,n]of this.#t){let r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;n.className="annotationContent";let{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):r.append(n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}},J0=/\r\n?|\n/g,UE=class i extends on{#e;#t="";#n=`${this.id}-editor`;#i=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=i.prototype,t=s=>s.isEmpty(),n=ff.TRANSLATE_SMALL,r=ff.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new Ql([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=Rt.FREETEXT;constructor(e){super(We(ae({},e),{name:"freeTextEditor"})),this.#e=e.color||i._defaultColor||on._defaultLineColor,this.#r=e.fontSize||i._defaultFontSize}static initialize(e,t){on.initialize(e,t);let n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case wt.FREETEXT_SIZE:i._defaultFontSize=t;break;case wt.FREETEXT_COLOR:i._defaultColor=t;break}}updateParams(e,t){switch(e){case wt.FREETEXT_SIZE:this.#s(t);break;case wt.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[wt.FREETEXT_SIZE,i._defaultFontSize],[wt.FREETEXT_COLOR,i._defaultColor||on._defaultLineColor]]}get propertiesToUpdate(){return[[wt.FREETEXT_SIZE,this.#r],[wt.FREETEXT_COLOR,this.#e]]}#s(e){let t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#c()},n=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){let t=r=>{this.#e=this.editorDiv.style.color=r},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-i._internalPadding*e,-(i._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Rt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;let e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#d(){let e=[];this.editorDiv.normalize();let t=null;for(let n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(i.#a(n)),t=n);return e.join(`
`)}#c(){let[e,t]=this.parentDimensions,n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{let{currentLayer:r,div:s}=this,o=s.style.display,a=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",r.div.append(this.div),n=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#t,t=this.#t=this.#d().trimEnd();if(e===t)return;let n=r=>{if(this.#t=r,!r){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#c()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){i._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#r}px * var(--scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),ov(this,this.div,["dblclick","keydown"]),this.width){let[r,s]=this.parentDimensions;if(this.annotationElementId){let{position:o}=this._initialData,[a,l]=this.getInitialTranslation();[a,l]=this.pageTranslationToScreen(a,l);let[d,c]=this.pageDimensions,[u,h]=this.pageTranslation,f,p;switch(this.rotation){case 0:f=e+(o[0]-u)/d,p=t+this.height-(o[1]-h)/c;break;case 90:f=e+(o[0]-u)/d,p=t-(o[1]-h)/c,[a,l]=[l,-a];break;case 180:f=e-this.width+(o[0]-u)/d,p=t-(o[1]-h)/c,[a,l]=[-a,-l];break;case 270:f=e+(o[0]-u-this.height*c)/d,p=t+(o[1]-h-this.width*d)/c,[a,l]=[-l,a];break}this.setAt(f*r,p*s,a,l)}else this.setAt(e*r,t*s,this.width*r,this.height*s);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#a(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(J0,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();let r=i.#h(t.getData("text")||"").replaceAll(J0,`
`);if(!r)return;let s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();let o=s.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),s.collapseToStart();return}let{startContainer:a,startOffset:l}=o,d=[],c=[];if(a.nodeType===Node.TEXT_NODE){let f=a.parentElement;if(c.push(a.nodeValue.slice(l).replaceAll(J0,"")),f!==this.editorDiv){let p=d;for(let x of this.editorDiv.childNodes){if(x===f){p=c;continue}p.push(i.#a(x))}}d.push(a.nodeValue.slice(0,l).replaceAll(J0,""))}else if(a===this.editorDiv){let f=d,p=0;for(let x of this.editorDiv.childNodes)p++===l&&(f=c),f.push(i.#a(x))}this.#t=`${d.join(`
`)}${r}${c.join(`
`)}`,this.#u();let u=new Range,h=d.reduce((f,p)=>f+p.length,0);for(let{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){let p=f.nodeValue.length;if(h<=p){u.setStart(f,h),u.setEnd(f,h);break}h-=p}s.removeAllRanges(),s.addRange(u)}#u(){if(this.editorDiv.replaceChildren(),!!this.#t)for(let e of this.#t.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#o(){return this.#t.replaceAll("\xA0"," ")}static#h(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){return re(this,null,function*(){let r=null;if(e instanceof Ev){let{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:l,rotation:d,id:c,popupRef:u},textContent:h,textPosition:f,parent:{page:{pageNumber:p}}}=e;if(!h||h.length===0)return null;r=e={annotationType:Rt.FREETEXT,color:Array.from(a),fontSize:o,value:h.join(`
`),position:f,pageIndex:p-1,rect:l.slice(0),rotation:d,id:c,deleted:!1,popupRef:u}}let s=yield nd(i,this,"deserialize").call(this,e,t,n);return s.#r=e.fontSize,s.#e=$e.makeHexColor(...e.color),s.#t=i.#h(e.value),s.annotationElementId=e.id||null,s._initialData=r,s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=i._internalPadding*this.parentScale,n=this.getRect(t,t),r=on._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),s={annotationType:Rt.FREETEXT,color:r,fontSize:this.#r,value:this.#o(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#p(s)?null:(s.id=this.annotationElementId,s)}#p(e){let{value:t,fontSize:n,color:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((o,a)=>o!==r[a])||e.pageIndex!==s}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:n}=t;n.fontSize=`calc(${this.#r}px * var(--scale-factor))`,n.color=this.#e,t.replaceChildren();for(let s of this.#t.split(`
`)){let o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}let r=i._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},Iv=class{toSVGPath(){An("Abstract method `toSVGPath` must be implemented.")}get box(){An("Abstract getter `box` must be implemented.")}serialize(e,t){An("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){An("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){An("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}},Dv=class i{#e;#t=[];#n;#i;#r=[];#s=new Float64Array(18);#l;#d;#c;#a;#u;#o;#h=[];static#p=8;static#f=2;static#m=i.#p+i.#f;constructor({x:e,y:t},n,r,s,o,a=0){this.#e=n,this.#o=s*r,this.#i=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#a=i.#p*r,this.#c=i.#m*r,this.#u=r,this.#h.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#v(){let e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,r,s,o]=this.#e;return[(this.#l+(e[0]-t[0])/2-n)/s,(this.#d+(e[1]-t[1])/2-r)/o,(this.#l+(t[0]-e[0])/2-n)/s,(this.#d+(t[1]-e[1])/2-r)/o]}add({x:e,y:t}){this.#l=e,this.#d=t;let[n,r,s,o]=this.#e,[a,l,d,c]=this.#s.subarray(8,12),u=e-d,h=t-c,f=Math.hypot(u,h);if(f<this.#c)return!1;let p=f-this.#a,x=p/f,v=x*u,g=x*h,y=a,b=l;a=d,l=c,d+=v,c+=g,this.#h?.push(e,t);let A=-g/p,M=v/p,T=A*this.#o,I=M*this.#o;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([d+T,c+I],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([d-T,c-I],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([a+T,l+I],2),this.#r.push(NaN,NaN,NaN,NaN,(a+T-n)/s,(l+I-r)/o),this.#s.set([a-T,l-I],14),this.#t.push(NaN,NaN,NaN,NaN,(a-T-n)/s,(l-I-r)/o)),this.#s.set([y,b,a,l,d,c],6),!this.isEmpty()):(this.#s.set([y,b,a,l,d,c],6),Math.abs(Math.atan2(b-l,y-a)-Math.atan2(g,v))<Math.PI/2?([a,l,d,c]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((a+d)/2-n)/s,((l+c)/2-r)/o),[a,l,y,b]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((y+a)/2-n)/s,((b+l)/2-r)/o),!0):([y,b,a,l,d,c]=this.#s.subarray(0,6),this.#r.push(((y+5*a)/6-n)/s,((b+5*l)/6-r)/o,((5*a+d)/6-n)/s,((5*l+c)/6-r)/o,((a+d)/2-n)/s,((l+c)/2-r)/o),[d,c,a,l,y,b]=this.#s.subarray(12,18),this.#t.push(((y+5*a)/6-n)/s,((b+5*l)/6-r)/o,((5*a+d)/6-n)/s,((5*l+c)/6-r)/o,((a+d)/2-n)/s,((l+c)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#r,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#g();let n=[];n.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#b(n);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#x(n),n.join(" ")}#g(){let[e,t,n,r]=this.#e,[s,o,a,l]=this.#v();return`M${(this.#s[2]-e)/n} ${(this.#s[3]-t)/r} L${(this.#s[4]-e)/n} ${(this.#s[5]-t)/r} L${s} ${o} L${a} ${l} L${(this.#s[16]-e)/n} ${(this.#s[17]-t)/r} L${(this.#s[14]-e)/n} ${(this.#s[15]-t)/r} Z`}#x(e){let t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#b(e){let[t,n,r,s]=this.#e,o=this.#s.subarray(4,6),a=this.#s.subarray(16,18),[l,d,c,u]=this.#v();e.push(`L${(o[0]-t)/r} ${(o[1]-n)/s} L${l} ${d} L${c} ${u} L${(a[0]-t)/r} ${(a[1]-n)/s}`)}newFreeDrawOutline(e,t,n,r,s,o){return new Pv(e,t,n,r,s,o)}getOutlines(){let e=this.#r,t=this.#t,n=this.#s,[r,s,o,a]=this.#e,l=new Float64Array((this.#h?.length??0)+2);for(let u=0,h=l.length-2;u<h;u+=2)l[u]=(this.#h[u]-r)/o,l[u+1]=(this.#h[u+1]-s)/a;if(l[l.length-2]=(this.#l-r)/o,l[l.length-1]=(this.#d-s)/a,isNaN(n[6])&&!this.isEmpty())return this.#_(l);let d=new Float64Array(this.#r.length+24+this.#t.length),c=e.length;for(let u=0;u<c;u+=2){if(isNaN(e[u])){d[u]=d[u+1]=NaN;continue}d[u]=e[u],d[u+1]=e[u+1]}c=this.#A(d,c);for(let u=t.length-6;u>=6;u-=6)for(let h=0;h<6;h+=2){if(isNaN(t[u+h])){d[c]=d[c+1]=NaN,c+=2;continue}d[c]=t[u+h],d[c+1]=t[u+h+1],c+=2}return this.#y(d,c),this.newFreeDrawOutline(d,l,this.#e,this.#u,this.#n,this.#i)}#_(e){let t=this.#s,[n,r,s,o]=this.#e,[a,l,d,c]=this.#v(),u=new Float64Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-r)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,d,c,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-r)/o],0),this.newFreeDrawOutline(u,e,this.#e,this.#u,this.#n,this.#i)}#y(e,t){let n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#A(e,t){let n=this.#s.subarray(4,6),r=this.#s.subarray(16,18),[s,o,a,l]=this.#e,[d,c,u,h]=this.#v();return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-o)/l,NaN,NaN,NaN,NaN,d,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(r[0]-s)/a,(r[1]-o)/l],t),t+=24}},Pv=class extends Iv{#e;#t=null;#n;#i;#r;#s;#l;constructor(e,t,n,r,s,o){super(),this.#l=e,this.#r=t,this.#e=n,this.#s=r,this.#n=s,this.#i=o,this.#a(o);let{x:a,y:l,width:d,height:c}=this.#t;for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-a)/d,e[u+1]=(e[u+1]-l)/c;for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-a)/d,t[u+1]=(t[u+1]-l)/c}toSVGPath(){let e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,n=this.#l.length;t<n;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,r],s){let o=n-e,a=r-t,l,d;switch(s){case 0:l=this.#d(this.#l,e,r,o,-a),d=this.#d(this.#r,e,r,o,-a);break;case 90:l=this.#c(this.#l,e,t,o,a),d=this.#c(this.#r,e,t,o,a);break;case 180:l=this.#d(this.#l,n,t,-o,a),d=this.#d(this.#r,n,t,-o,a);break;case 270:l=this.#c(this.#l,n,r,-o,-a),d=this.#c(this.#r,n,r,-o,-a);break}return{outline:Array.from(l),points:[Array.from(d)]}}#d(e,t,n,r,s){let o=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*r,o[a+1]=n+e[a+1]*s;return o}#c(e,t,n,r,s){let o=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*r,o[a+1]=n+e[a]*s;return o}#a(e){let t=this.#l,n=t[4],r=t[5],s=n,o=r,a=n,l=r,d=n,c=r,u=e?Math.max:Math.min;for(let v=6,g=t.length;v<g;v+=6){if(isNaN(t[v]))s=Math.min(s,t[v+4]),o=Math.min(o,t[v+5]),a=Math.max(a,t[v+4]),l=Math.max(l,t[v+5]),c<t[v+5]?(d=t[v+4],c=t[v+5]):c===t[v+5]&&(d=u(d,t[v+4]));else{let y=$e.bezierBoundingBox(n,r,...t.slice(v,v+6));s=Math.min(s,y[0]),o=Math.min(o,y[1]),a=Math.max(a,y[2]),l=Math.max(l,y[3]),c<y[3]?(d=y[2],c=y[3]):c===y[3]&&(d=u(d,y[2]))}n=t[v+4],r=t[v+5]}let h=s-this.#n,f=o-this.#n,p=a-s+2*this.#n,x=l-o+2*this.#n;this.#t={x:h,y:f,width:p,height:x,lastPoint:[d,c]}}get box(){return this.#t}newOutliner(e,t,n,r,s,o=0){return new Dv(e,t,n,r,s,o)}getNewOutline(e,t){let{x:n,y:r,width:s,height:o}=this.#t,[a,l,d,c]=this.#e,u=s*d,h=o*c,f=n*d+a,p=r*c+l,x=this.newOutliner({x:this.#r[0]*u+f,y:this.#r[1]*h+p},this.#e,this.#s,e,this.#i,t??this.#n);for(let v=2;v<this.#r.length;v+=2)x.add({x:this.#r[v]*u+f,y:this.#r[v+1]*h+p});return x.getOutlines()}get mustRemoveSelfIntersections(){return!0}},Rv=class{#e;#t=[];#n=[];constructor(e,t=0,n=0,r=!0){let s=1/0,o=-1/0,a=1/0,l=-1/0,c=10**-4;for(let{x:g,y,width:b,height:A}of e){let M=Math.floor((g-t)/c)*c,T=Math.ceil((g+b+t)/c)*c,I=Math.floor((y-t)/c)*c,L=Math.ceil((y+A+t)/c)*c,E=[M,I,L,!0],S=[T,I,L,!1];this.#t.push(E,S),s=Math.min(s,M),o=Math.max(o,T),a=Math.min(a,I),l=Math.max(l,L)}let u=o-s+2*n,h=l-a+2*n,f=s-n,p=a-n,x=this.#t.at(r?-1:-2),v=[x[0],x[2]];for(let g of this.#t){let[y,b,A]=g;g[0]=(y-f)/u,g[1]=(b-p)/h,g[2]=(A-p)/h}this.#e={x:f,y:p,width:u,height:h,lastPoint:v}}getOutlines(){this.#t.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);let e=[];for(let t of this.#t)t[3]?(e.push(...this.#d(t)),this.#s(t)):(this.#l(t),e.push(...this.#d(t)));return this.#i(e)}#i(e){let t=[],n=new Set;for(let o of e){let[a,l,d]=o;t.push([a,l,o],[a,d,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){let l=t[o][2],d=t[o+1][2];l.push(d),d.push(l),n.add(l),n.add(d)}let r=[],s;for(;n.size>0;){let o=n.values().next().value,[a,l,d,c,u]=o;n.delete(o);let h=a,f=l;for(s=[a,d],r.push(s);;){let p;if(n.has(c))p=c;else if(n.has(u))p=u;else break;n.delete(p),[a,l,d,c,u]=p,h!==a&&(s.push(h,f,a,f===l?l:d),h=a),f=f===l?d:l}s.push(h,f)}return new HE(r,this.#e)}#r(e){let t=this.#n,n=0,r=t.length-1;for(;n<=r;){let s=n+r>>1,o=t[s][0];if(o===e)return s;o<e?n=s+1:r=s-1}return r+1}#s([,e,t]){let n=this.#r(e);this.#n.splice(n,0,[e,t])}#l([,e,t]){let n=this.#r(e);for(let r=n;r<this.#n.length;r++){let[s,o]=this.#n[r];if(s!==e)break;if(s===e&&o===t){this.#n.splice(r,1);return}}for(let r=n-1;r>=0;r--){let[s,o]=this.#n[r];if(s!==e)break;if(s===e&&o===t){this.#n.splice(r,1);return}}}#d(e){let[t,n,r]=e,s=[[t,n,r]],o=this.#r(r);for(let a=0;a<o;a++){let[l,d]=this.#n[a];for(let c=0,u=s.length;c<u;c++){let[,h,f]=s[c];if(!(d<=h||f<=l)){if(h>=l){if(f>d)s[c][1]=d;else{if(u===1)return[];s.splice(c,1),c--,u--}continue}s[c][2]=l,f>d&&s.push([t,d,f])}}}return s}},HE=class extends Iv{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){let e=[];for(let t of this.#t){let[n,r]=t;e.push(`M${n} ${r}`);for(let s=2;s<t.length;s+=2){let o=t[s],a=t[s+1];o===n?(e.push(`V${a}`),r=a):a===r&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,t,n,r],s){let o=[],a=n-e,l=r-t;for(let d of this.#t){let c=new Array(d.length);for(let u=0;u<d.length;u+=2)c[u]=e+d[u]*a,c[u+1]=r-d[u+1]*l;o.push(c)}return o}get box(){return this.#e}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}},yf=class extends Dv{newFreeDrawOutline(e,t,n,r,s,o){return new zE(e,t,n,r,s,o)}get classNamesForDrawing(){return["highlight","free"]}},zE=class extends Pv{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,n,r,s,o=0){return new yf(e,t,n,r,s,o)}},Lv=class i{#e=null;#t=null;#n;#i=null;#r=!1;#s=!1;#l=null;#d;#c=null;#a=null;#u;static#o=null;static get _keyboardManager(){return Gt(this,"_keyboardManager",new Ql([[["Escape","mac+Escape"],i.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],i.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],i.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],i.prototype._moveToPrevious],[["Home","mac+Home"],i.prototype._moveToBeginning],[["End","mac+End"],i.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#u=wt.HIGHLIGHT_COLOR,this.#l=e):(this.#s=!0,this.#u=wt.HIGHLIGHT_DEFAULT_COLOR),this.#a=e?._uiManager||t,this.#d=this.#a._eventBus,this.#n=e?.color||this.#a?.highlightColors.values().next().value||"#FFFF98",i.#o||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){let e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#a._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#f.bind(this),{signal:t});let n=this.#t=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){let e=this.#i=this.#h();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#h(){let e=document.createElement("div"),t=this.#a._signal;e.addEventListener("contextmenu",Xr,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[n,r]of this.#a.highlightColors){let s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=n,s.setAttribute("data-l10n-id",i.#o[n]);let o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=r,s.setAttribute("aria-selected",r===this.#n),s.addEventListener("click",this.#p.bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#f.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#d.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}let t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#g){this.#m(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#m(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#g){this.#m(e);return}this.#i.lastChild?.focus()}#f(e){i._keyboardManager.exec(this,e)}#m(e){if(this.#g){this.hideDropdown();return}if(this.#r=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#v.bind(this),{signal:this.#a.combinedSignal(this.#c)})),this.#i){this.#i.classList.remove("hidden");return}let t=this.#i=this.#h();this.#e.append(t)}#v(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;let t=this.#a.highlightColors.values();for(let n of this.#i.children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}},kv=class i extends on{#e=null;#t=0;#n;#i=null;#r=null;#s=null;#l=null;#d=0;#c=null;#a=null;#u=null;#o=!1;#h=null;#p;#f=null;#m="";#v;#g="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Rt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=i.prototype;return Gt(this,"_keyboardManager",new Ql([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(We(ae({},e),{name:"highlightEditor"})),this.color=e.color||i._defaultColor,this.#v=e.thickness||i._defaultThickness,this.#p=e.opacity||i._defaultOpacity,this.#n=e.boxes||null,this.#g=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#o=!0,this.#b(e),this.#M()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#d=e.focusOffset,this.#x(),this.#M(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#o?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#v,methodOfCreation:this.#g}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#x(){let e=new Rv(this.#n,.001);this.#a=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#a.box;let t=new Rv(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();let{lastPoint:n}=this.#s.box;this.#h=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#b({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#a=e;let r=1.5;if(this.#s=e.getNewOutline(this.#v/2+r,.0025),t>=0)this.#u=t,this.#i=n,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.drawOutline(this.#s);else if(this.parent){let c=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#u,e),this.parent.drawLayer.updateBox(this.#u,i.#S(this.#a.box,(c-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#s),this.parent.drawLayer.updateBox(this.#f,i.#S(this.#s.box,c))}let{x:s,y:o,width:a,height:l}=e.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=a,this.height=l;break;case 90:{let[c,u]=this.parentDimensions;this.x=o,this.y=1-s,this.width=a*u/c,this.height=l*c/u;break}case 180:this.x=1-s,this.y=1-o,this.width=a,this.height=l;break;case 270:{let[c,u]=this.parentDimensions;this.x=1-o,this.y=s,this.width=a*u/c,this.height=l*c/u;break}}let{lastPoint:d}=this.#s.box;this.#h=[(d[0]-s)/a,(d[1]-o)/l]}static initialize(e,t){on.initialize(e,t),i._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case wt.HIGHLIGHT_DEFAULT_COLOR:i._defaultColor=t;break;case wt.HIGHLIGHT_THICKNESS:i._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#h}updateParams(e,t){switch(e){case wt.HIGHLIGHT_COLOR:this.#_(t);break;case wt.HIGHLIGHT_THICKNESS:this.#y(t);break}}static get defaultPropertiesToUpdate(){return[[wt.HIGHLIGHT_DEFAULT_COLOR,i._defaultColor],[wt.HIGHLIGHT_THICKNESS,i._defaultThickness]]}get propertiesToUpdate(){return[[wt.HIGHLIGHT_COLOR,this.color||i._defaultColor],[wt.HIGHLIGHT_THICKNESS,this.#v||i._defaultThickness],[wt.HIGHLIGHT_FREE,this.#o]]}#_(e){let t=(s,o)=>{this.color=s,this.parent?.drawLayer.changeColor(this.#u,s),this.#r?.updateColor(s),this.#p=o,this.parent?.drawLayer.changeOpacity(this.#u,o)},n=this.color,r=this.#p;this.addCommands({cmd:t.bind(this,e,i._defaultOpacity),undo:t.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#y(e){let t=this.#v,n=r=>{this.#v=r,this.#A(r)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}addEditToolbar(){return re(this,null,function*(){let e=yield nd(i.prototype,this,"addEditToolbar").call(this);return e?(this._uiManager.highlightColors&&(this.#r=new Lv({editor:this}),e.addColorPicker(this.#r)),e):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#D(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#M(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#D():e&&(this.#M(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#A(e){if(!this.#o)return;this.#b({highlightOutlines:this.#a.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#D(){this.#u===null||!this.parent||(this.parent.drawLayer.remove(this.#u),this.#u=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#M(e=this.parent){this.#u===null&&({id:this.#u,clipPathId:this.#i}=e.drawLayer.draw(this.#a,this.color,this.#p),this.#f=e.drawLayer.drawOutline(this.#s),this.#c&&(this.#c.style.clipPath=this.#i))}static#S({x:e,y:t,width:n,height:r},s){switch(s){case 90:return{x:1-t-r,y:e,width:r,height:n};case 180:return{x:1-e-n,y:1-t-r,width:n,height:r};case 270:return{x:t,y:1-e-n,width:r,height:n}}return{x:e,y:t,width:n,height:r}}rotate(e){let{drawLayer:t}=this.parent,n;this.#o?(e=(e-this.rotation+360)%360,n=i.#S(this.#a.box,e)):n=i.#S(this,e),t.rotate(this.#u,e),t.rotate(this.#f,e),t.updateBox(this.#u,n),t.updateBox(this.#f,i.#S(this.#s.box,e))}render(){if(this.div)return this.div;let e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#o?e.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});let t=this.#c=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;let[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),ov(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#f,"hovered")}#T(e){i._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(e){if(!this.#e)return;let t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#d)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#o||this.#C(!1))}get _mustFixPosition(){return!this.#o}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#u,e),this.parent.drawLayer.show(this.#f,e))}#P(){return this.#o?this.rotation:0}#L(){if(this.#o)return null;let[e,t]=this.pageDimensions,[n,r]=this.pageTranslation,s=this.#n,o=new Float32Array(s.length*8),a=0;for(let{x:l,y:d,width:c,height:u}of s){let h=l*e+n,f=(1-d-u)*t+r;o[a]=o[a+4]=h,o[a+1]=o[a+3]=f,o[a+2]=o[a+6]=h+c*e,o[a+5]=o[a+7]=f+u*t,a+=8}return o}#E(e){return this.#a.serialize(e,this.#P())}static startHighlighting(e,t,{target:n,x:r,y:s}){let{x:o,y:a,width:l,height:d}=n.getBoundingClientRect(),c=new AbortController,u=e.combinedSignal(c),h=p=>{p.preventDefault(),p.stopPropagation()},f=p=>{c.abort(),this.#I(e,p)};window.addEventListener("blur",f,{signal:u}),window.addEventListener("pointerup",f,{signal:u}),window.addEventListener("pointerdown",h,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",Xr,{signal:u}),n.addEventListener("pointermove",this.#w.bind(this,e),{signal:u}),this._freeHighlight=new yf({x:r,y:s},[o,a,l,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#w(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#I(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,n){return re(this,null,function*(){let r=null;if(e instanceof Mv){let{data:{quadPoints:p,rect:x,rotation:v,id:g,color:y,opacity:b,popupRef:A},parent:{page:{pageNumber:M}}}=e;r=e={annotationType:Rt.HIGHLIGHT,color:Array.from(y),opacity:b,quadPoints:p,boxes:null,pageIndex:M-1,rect:x.slice(0),rotation:v,id:g,deleted:!1,popupRef:A}}else if(e instanceof bf){let{data:{inkLists:p,rect:x,rotation:v,id:g,color:y,borderStyle:{rawWidth:b},popupRef:A},parent:{page:{pageNumber:M}}}=e;r=e={annotationType:Rt.HIGHLIGHT,color:Array.from(y),thickness:b,inkLists:p,boxes:null,pageIndex:M-1,rect:x.slice(0),rotation:v,id:g,deleted:!1,popupRef:A}}let{color:s,quadPoints:o,inkLists:a,opacity:l}=e,d=yield nd(i,this,"deserialize").call(this,e,t,n);d.color=$e.makeHexColor(...s),d.#p=l||1,a&&(d.#v=e.thickness),d.annotationElementId=e.id||null,d._initialData=r;let[c,u]=d.pageDimensions,[h,f]=d.pageTranslation;if(o){let p=d.#n=[];for(let x=0;x<o.length;x+=8)p.push({x:(o[x]-h)/c,y:1-(o[x+1]-f)/u,width:(o[x+2]-o[x])/c,height:(o[x+1]-o[x+5])/u});d.#x(),d.#M(),d.rotate(d.rotation)}else if(a){d.#o=!0;let p=a[0],x={x:p[0]-h,y:u-(p[1]-f)},v=new yf(x,[0,0,c,u],1,d.#v/2,!0,.001);for(let b=0,A=p.length;b<A;b+=2)x.x=p[b]-h,x.y=u-(p[b+1]-f),v.add(x);let{id:g,clipPathId:y}=t.drawLayer.draw(v,d.color,d._defaultOpacity,!0);d.#b({highlightOutlines:v.getOutlines(),highlightId:g,clipPathId:y}),d.#M()}return d})}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=this.getRect(0,0),n=on._colorManager.convert(this.color),r={annotationType:Rt.HIGHLIGHT,color:n,opacity:this.#p,thickness:this.#v,quadPoints:this.#L(),outlines:this.#E(t),pageIndex:this.pageIndex,rect:t,rotation:this.#P(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#R(r)?null:(r.id=this.annotationElementId,r)}#R(e){let{color:t}=this._initialData;return e.color.some((n,r)=>n!==t[r])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},jE=class i extends on{#e=0;#t=0;#n=null;#i=new Path2D;#r=!1;#s=null;#l=!1;#d=!1;#c=null;#a=null;#u=0;#o=0;#h=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=Rt.INK;constructor(e){super(We(ae({},e),{name:"inkEditor"})),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){on.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case wt.INK_THICKNESS:i._defaultThickness=t;break;case wt.INK_COLOR:i._defaultColor=t;break;case wt.INK_OPACITY:i._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case wt.INK_THICKNESS:this.#p(t);break;case wt.INK_COLOR:this.#f(t);break;case wt.INK_OPACITY:this.#m(t);break}}static get defaultPropertiesToUpdate(){return[[wt.INK_THICKNESS,i._defaultThickness],[wt.INK_COLOR,i._defaultColor||on._defaultLineColor],[wt.INK_OPACITY,Math.round(i._defaultOpacity*100)]]}get propertiesToUpdate(){return[[wt.INK_THICKNESS,this.thickness||i._defaultThickness],[wt.INK_COLOR,this.color||i._defaultColor||on._defaultLineColor],[wt.INK_OPACITY,Math.round(100*(this.opacity??i._defaultOpacity))]]}#p(e){let t=r=>{this.thickness=r,this.#k()},n=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#f(e){let t=r=>{this.color=r,this.#S()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#m(e){let t=r=>{this.opacity=r,this.#S()};e/=100;let n=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:wt.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#L(),this.#E()),this.isAttachedToDOM||(this.parent.add(this),this.#w()),this.#k()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#c?.disconnect(),this.#c=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){let[e,t]=this.parentDimensions,n=this.width*e,r=this.height*t;this.setDimensions(n,r)}enableEditMode(){this.#r||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#T())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#C())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#v(){let{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#g(){let{ctx:e,color:t,opacity:n,thickness:r,parentScale:s,scaleFactor:o}=this;e.lineWidth=r*s/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${vX(n)}`}#x(e,t){this.canvas.addEventListener("contextmenu",Xr,{signal:this._uiManager._signal}),this.#C(),this.#s=new AbortController;let n=this._uiManager.combinedSignal(this.#s);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,this.#d||(this.#d=!0,this.#w(),this.thickness||=i._defaultThickness,this.color||=i._defaultColor||on._defaultLineColor,this.opacity??=i._defaultOpacity),this.currentPath.push([e,t]),this.#l=!1,this.#g(),this.#h=()=>{this.#A(),this.#h&&window.requestAnimationFrame(this.#h)},window.requestAnimationFrame(this.#h)}#b(e,t){let[n,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===r)return;let s=this.currentPath,o=this.#i;if(s.push([e,t]),this.#l=!0,s.length<=2){o.moveTo(...s[0]),o.lineTo(e,t);return}s.length===3&&(this.#i=o=new Path2D,o.moveTo(...s[0])),this.#D(o,...s.at(-3),...s.at(-2),e,t)}#_(){if(this.currentPath.length===0)return;let e=this.currentPath.at(-1);this.#i.lineTo(...e)}#y(e,t){this.#h=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#b(e,t),this.#_();let n;if(this.currentPath.length!==1)n=this.#M();else{let l=[e,t];n=[[l,l.slice(),l.slice(),l]]}let r=this.#i,s=this.currentPath;this.currentPath=[],this.#i=new Path2D;let o=()=>{this.allRawPaths.push(s),this.paths.push(n),this.bezierPath2D.push(r),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#L(),this.#E()),this.#k())};this.addCommands({cmd:o,undo:a,mustExec:!0})}#A(){if(!this.#l)return;this.#l=!1;let e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),n=t.map(c=>c[0]),r=t.map(c=>c[1]),s=Math.min(...n)-e,o=Math.max(...n)+e,a=Math.min(...r)-e,l=Math.max(...r)+e,{ctx:d}=this;d.save(),d.clearRect(0,0,this.canvas.width,this.canvas.height);for(let c of this.bezierPath2D)d.stroke(c);d.stroke(this.#i),d.restore()}#D(e,t,n,r,s,o,a){let l=(t+r)/2,d=(n+s)/2,c=(r+o)/2,u=(s+a)/2;e.bezierCurveTo(l+2*(r-l)/3,d+2*(s-d)/3,c+2*(r-c)/3,u+2*(s-u)/3,c,u)}#M(){let e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];let t=[],n,[r,s]=e[0];for(n=1;n<e.length-2;n++){let[h,f]=e[n],[p,x]=e[n+1],v=(h+p)/2,g=(f+x)/2,y=[r+2*(h-r)/3,s+2*(f-s)/3],b=[v+2*(h-v)/3,g+2*(f-g)/3];t.push([[r,s],y,b,[v,g]]),[r,s]=[v,g]}let[o,a]=e[n],[l,d]=e[n+1],c=[r+2*(o-r)/3,s+2*(a-s)/3],u=[l+2*(o-l)/3,d+2*(a-d)/3];return t.push([[r,s],c,u,[l,d]]),t}#S(){if(this.isEmpty()){this.#R();return}this.#g();let{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#R();for(let n of this.bezierPath2D)t.stroke(n)}commit(){this.#r||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#r=!0,this.div.classList.add("disabled"),this.#k(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#T(){if(this.#a)return;this.#a=new AbortController;let e=this._uiManager.combinedSignal(this.#a);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#C(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#r||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#x(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#b(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#P(e)}canvasPointerleave(e){this.#P(e)}#P(e){this.#s?.abort(),this.#s=null,this.#T(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",Xr)},10),this.#y(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#L(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#E(){this.#c=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#c.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#c?.disconnect(),this.#c=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#r}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");let[n,r,s,o]=this.#v();if(this.setAt(n,r,0,0),this.setDims(s,o),this.#L(),this.width){let[a,l]=this.parentDimensions;this.setAspectRatio(this.width*a,this.height*l),this.setAt(e*a,t*l,this.width*a,this.height*l),this.#d=!0,this.#w(),this.setDims(this.width*a,this.height*l),this.#S(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#E(),this.div}#w(){if(!this.#d)return;let[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#R()}setDimensions(e,t){let n=Math.round(e),r=Math.round(t);if(this.#u===n&&this.#o===r)return;this.#u=n,this.#o=r,this.canvas.style.visibility="hidden";let[s,o]=this.parentDimensions;this.width=e/s,this.height=t/o,this.fixAndSetPosition(),this.#r&&this.#I(e,t),this.#w(),this.#S(),this.canvas.style.visibility="visible",this.fixDims()}#I(e,t){let n=this.#V(),r=(e-n)/this.#t,s=(t-n)/this.#e;this.scaleFactor=Math.min(r,s)}#R(){let e=this.#V()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#O(e){let t=new Path2D;for(let n=0,r=e.length;n<r;n++){let[s,o,a,l]=e[n];n===0&&t.moveTo(...s),t.bezierCurveTo(o[0],o[1],a[0],a[1],l[0],l[1])}return t}static#H(e,t,n){let[r,s,o,a]=t;switch(n){case 0:for(let l=0,d=e.length;l<d;l+=2)e[l]+=r,e[l+1]=a-e[l+1];break;case 90:for(let l=0,d=e.length;l<d;l+=2){let c=e[l];e[l]=e[l+1]+r,e[l+1]=c+s}break;case 180:for(let l=0,d=e.length;l<d;l+=2)e[l]=o-e[l],e[l+1]+=s;break;case 270:for(let l=0,d=e.length;l<d;l+=2){let c=e[l];e[l]=o-e[l+1],e[l+1]=a-c}break;default:throw new Error("Invalid rotation")}return e}static#U(e,t,n){let[r,s,o,a]=t;switch(n){case 0:for(let l=0,d=e.length;l<d;l+=2)e[l]-=r,e[l+1]=a-e[l+1];break;case 90:for(let l=0,d=e.length;l<d;l+=2){let c=e[l];e[l]=e[l+1]-s,e[l+1]=c-r}break;case 180:for(let l=0,d=e.length;l<d;l+=2)e[l]=o-e[l],e[l+1]-=s;break;case 270:for(let l=0,d=e.length;l<d;l+=2){let c=e[l];e[l]=a-e[l+1],e[l+1]=o-c}break;default:throw new Error("Invalid rotation")}return e}#F(e,t,n,r){let s=[],o=this.thickness/2,a=e*t+o,l=e*n+o;for(let d of this.paths){let c=[],u=[];for(let h=0,f=d.length;h<f;h++){let[p,x,v,g]=d[h];if(p[0]===g[0]&&p[1]===g[1]&&f===1){let S=e*p[0]+a,P=e*p[1]+l;c.push(S,P),u.push(S,P);break}let y=e*p[0]+a,b=e*p[1]+l,A=e*x[0]+a,M=e*x[1]+l,T=e*v[0]+a,I=e*v[1]+l,L=e*g[0]+a,E=e*g[1]+l;h===0&&(c.push(y,b),u.push(y,b)),c.push(A,M,T,I,L,E),u.push(A,M),h===f-1&&u.push(L,E)}s.push({bezier:i.#H(c,r,this.rotation),points:i.#H(u,r,this.rotation)})}return s}#B(){let e=1/0,t=-1/0,n=1/0,r=-1/0;for(let s of this.paths)for(let[o,a,l,d]of s){let c=$e.bezierBoundingBox(...o,...a,...l,...d);e=Math.min(e,c[0]),n=Math.min(n,c[1]),t=Math.max(t,c[2]),r=Math.max(r,c[3])}return[e,n,t,r]}#V(){return this.#r?Math.ceil(this.thickness*this.parentScale):0}#k(e=!1){if(this.isEmpty())return;if(!this.#r){this.#S();return}let t=this.#B(),n=this.#V();this.#t=Math.max(on.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(on.MIN_SIZE,t[3]-t[1]);let r=Math.ceil(n+this.#t*this.scaleFactor),s=Math.ceil(n+this.#e*this.scaleFactor),[o,a]=this.parentDimensions;this.width=r/o,this.height=s/a,this.setAspectRatio(r,s);let l=this.translationX,d=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#w(),this.#S(),this.#u=r,this.#o=s,this.setDims(r,s);let c=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-c,d-this.translationY-c)}static deserialize(e,t,n){return re(this,null,function*(){if(e instanceof bf)return null;let r=yield nd(i,this,"deserialize").call(this,e,t,n);r.thickness=e.thickness,r.color=$e.makeHexColor(...e.color),r.opacity=e.opacity;let[s,o]=r.pageDimensions,a=r.width*s,l=r.height*o,d=r.parentScale,c=e.thickness/2;r.#r=!0,r.#u=Math.round(a),r.#o=Math.round(l);let{paths:u,rect:h,rotation:f}=e;for(let{bezier:x}of u){x=i.#U(x,h,f);let v=[];r.paths.push(v);let g=d*(x[0]-c),y=d*(x[1]-c);for(let A=2,M=x.length;A<M;A+=6){let T=d*(x[A]-c),I=d*(x[A+1]-c),L=d*(x[A+2]-c),E=d*(x[A+3]-c),S=d*(x[A+4]-c),P=d*(x[A+5]-c);v.push([[g,y],[T,I],[L,E],[S,P]]),g=S,y=P}let b=this.#O(v);r.bezierPath2D.push(b)}let p=r.#B();return r.#t=Math.max(on.MIN_SIZE,p[2]-p[0]),r.#e=Math.max(on.MIN_SIZE,p[3]-p[1]),r.#I(a,l),r})}serialize(){if(this.isEmpty())return null;let e=this.getRect(0,0),t=on._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Rt.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#F(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}},GE=class i extends on{#e=null;#t=null;#n=null;#i=null;#r=null;#s="";#l=null;#d=null;#c=null;#a=!1;#u=!1;static _type="stamp";static _editorType=Rt.STAMP;constructor(e){super(We(ae({},e),{name:"stampEditor"})),this.#i=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){on.initialize(e,t)}static get supportedTypes(){return Gt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Gt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(Rt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#o(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#a=e.isSvg),e.file&&(this.#s=e.file.name),this.#f()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}mlGuessAltText(e=null,t=!0){return re(this,null,function*(){if(this.hasAltTextData())return null;let{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!(yield n.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");let{data:r,width:s,height:o}=e||this.copyCanvas(null,null,!0).imageData,a=yield n.guess({name:"altText",request:{data:r,width:s,height:o,channels:r.length/(s*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");let l=a.output;return yield this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l})}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#o(n,!0)).finally(()=>this.#h());return}if(this.#i){let n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#o(r)).finally(()=>this.#h());return}if(this.#r){let n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(r=>this.#o(r)).finally(()=>this.#h());return}let e=document.createElement("input");e.type="file",e.accept=i.supportedTypesStr;let t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",()=>re(this,null,function*(){if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let r=yield this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#o(r)}n()}),{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#h()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#d?.disconnect(),this.#d=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#f():this.#p(),this.width&&!this.annotationElementId){let[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r)}return this.div}#f(){let{div:e}=this,{width:t,height:n}=this.#e,[r,s]=this.pageDimensions,o=.75;if(this.width)t=this.width*r,n=this.height*s;else if(t>o*r||n>o*s){let c=Math.min(o*r/t,o*s/n);t*=c,n*=c}let[a,l]=this.parentDimensions;this.setDims(t*a/r,n*l/s),this._uiManager.enableWaiting(!1);let d=this.#l=document.createElement("canvas");d.setAttribute("role","img"),this.addContainer(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(t,n),this.#b(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&d.setAttribute("aria-label",this.#s)}copyCanvas(e,t,n=!1){e||(e=224);let{width:r,height:s}=this.#e,o=new hf,a=this.#e,l=r,d=s,c=null;if(t){if(r>t||s>t){let T=Math.min(t/r,t/s);l=Math.floor(r*T),d=Math.floor(s*T)}c=document.createElement("canvas");let h=c.width=Math.ceil(l*o.sx),f=c.height=Math.ceil(d*o.sy);this.#a||(a=this.#v(h,f));let p=c.getContext("2d");p.filter=this._uiManager.hcmFilter;let x="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",v="#42414d");let g=15,y=g*o.sx,b=g*o.sy,A=new OffscreenCanvas(y*2,b*2),M=A.getContext("2d");M.fillStyle=x,M.fillRect(0,0,y*2,b*2),M.fillStyle=v,M.fillRect(0,0,y,b),M.fillRect(y,b,y,b),p.fillStyle=p.createPattern(A,"repeat"),p.fillRect(0,0,h,f),p.drawImage(a,0,0,a.width,a.height,0,0,h,f)}let u=null;if(n){let h,f;if(o.symmetric&&a.width<e&&a.height<e)h=a.width,f=a.height;else if(a=this.#e,r>e||s>e){let v=Math.min(e/r,e/s);h=Math.floor(r*v),f=Math.floor(s*v),this.#a||(a=this.#v(h,f))}let x=new OffscreenCanvas(h,f).getContext("2d",{willReadFrequently:!0});x.drawImage(a,0,0,a.width,a.height,0,0,h,f),u={width:h,height:f,data:x.getImageData(0,0,h,f).data}}return{canvas:c,width:l,height:d,imageData:u}}#m(e,t){let[n,r]=this.parentDimensions;this.width=e/n,this.height=t/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#c!==null&&clearTimeout(this.#c);let s=200;this.#c=setTimeout(()=>{this.#c=null,this.#g(e,t)},s)}#v(e,t){let{width:n,height:r}=this.#e,s=n,o=r,a=this.#e;for(;s>2*e||o>2*t;){let l=s,d=o;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));let c=new OffscreenCanvas(s,o);c.getContext("2d").drawImage(a,0,0,l,d,0,0,s,o),a=c.transferToImageBitmap()}return a}#g(e,t){let n=new hf,r=Math.ceil(e*n.sx),s=Math.ceil(t*n.sy),o=this.#l;if(!o||o.width===r&&o.height===s)return;o.width=r,o.height=s;let a=this.#a?this.#e:this.#v(r,s),l=o.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(a,0,0,a.width,a.height,0,0,r,s)}getImageForAltText(){return this.#l}#x(e){if(e){if(this.#a){let r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#a){let[t,n]=this.pageDimensions,r=Math.round(this.width*t*Xa.PDF_TO_CSS_UNITS),s=Math.round(this.height*n*Xa.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,s);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,s),o.transferToImageBitmap()}return structuredClone(this.#e)}#b(){this._uiManager._signal&&(this.#d=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.#m(t.width,t.height)}),this.#d.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#d?.disconnect(),this.#d=null},{once:!0}))}static deserialize(e,t,n){return re(this,null,function*(){let r=null;if(e instanceof Tv){let{data:{rect:p,rotation:x,id:v,structParent:g,popupRef:y},container:b,parent:{page:{pageNumber:A}}}=e,M=b.querySelector("canvas"),T=n.imageManager.getFromCanvas(b.id,M);M.remove();let I=(yield t._structTree.getAriaAttributes(`${ZE}${v}`))?.get("aria-label")||"";r=e={annotationType:Rt.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:A-1,rect:p.slice(0),rotation:x,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:g,popupRef:y}}let s=yield nd(i,this,"deserialize").call(this,e,t,n),{rect:o,bitmap:a,bitmapUrl:l,bitmapId:d,isSvg:c,accessibilityData:u}=e;d&&n.imageManager.isValidId(d)?(s.#t=d,a&&(s.#e=a)):s.#i=l,s.#a=c;let[h,f]=s.pageDimensions;return s.width=(o[2]-o[0])/h,s.height=(o[3]-o[1])/f,s.annotationElementId=e.id||null,u&&(s.altTextData=u),s._initialData=r,s.#u=!!r,s})}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let n={annotationType:Rt.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#a,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#x(!0),n.accessibilityData=this.serializeAltText(!0),n;let{decorative:r,altText:s}=this.serializeAltText(!1);if(!r&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){let a=this.#_(n);if(a.isSame)return null;a.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,t===null)return n;t.stamps||=new Map;let o=this.#a?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:n}),n.bitmap=this.#x(!1);else if(this.#a){let a=t.stamps.get(this.#t);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#x(!1))}return n}#_(e){let{rect:t,pageIndex:n,accessibilityData:{altText:r}}=this._initialData,s=e.rect.every((l,d)=>Math.abs(l-t[d])<1),o=e.pageIndex===n,a=(e.accessibilityData?.alt||"")===r;return{isSame:s&&o&&a,isSameAltText:a}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},ZX=(()=>{class i{#e;#t=!1;#n=null;#i=null;#r=null;#s=new Map;#l=!1;#d=!1;#c=!1;#a=null;#u=null;#o;static _initialized=!1;static#h=new Map([UE,jE,GE,kv].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:n,div:r,structTreeLayer:s,accessibilityManager:o,annotationLayer:a,drawLayer:l,textLayer:d,viewport:c,l10n:u}){let h=[...i.#h.values()];if(!i._initialized){i._initialized=!0;for(let f of h)f.initialize(u,t)}t.registerEditorTypes(h),this.#o=t,this.pageIndex=n,this.div=r,this.#e=o,this.#n=a,this.viewport=c,this.#a=d,this.drawLayer=l,this._structTree=s,this.#o.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===Rt.NONE}updateToolbar(t){this.#o.updateToolbar(t)}updateMode(t=this.#o.getMode()){switch(this.#g(),t){case Rt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Rt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Rt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:n}=this.div;for(let r of i.#h.values())n.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#a?.div}addInkEditorIfNeeded(t){if(this.#o.getMode()!==Rt.INK)return;if(!t){for(let r of this.#s.values())if(r.isEmpty()){r.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#o.setEditingState(t)}addCommands(t){this.#o.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}enable(){return re(this,null,function*(){this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let r of this.#s.values())r.enableEditing(),r.show(!0),r.annotationElementId&&(this.#o.removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!this.#n)return;let n=this.#n.getEditableAnnotations();for(let r of n){if(r.hide(),this.#o.isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;let s=yield this.deserialize(r);s&&(this.addOrRebuild(s),s.enableEditing())}})}disable(){this.#c=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,n=new Map;for(let s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else n.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){let s=this.#n.getEditableAnnotations();for(let o of s){let{id:a}=o.data;if(this.#o.isDeletedAnnotationElement(a))continue;let l=n.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=t.get(a),l&&(this.#o.addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}this.#g(),this.isEmpty&&(this.div.hidden=!0);let{classList:r}=this.div;for(let s of i.#h.values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#c=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#o.getActive()!==t&&this.#o.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#a?.div&&!this.#u){this.#u=new AbortController;let t=this.#o.combinedSignal(this.#u);this.#a.div.addEventListener("pointerdown",this.#p.bind(this),{signal:t}),this.#a.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#a?.div&&this.#u&&(this.#u.abort(),this.#u=null,this.#a.div.classList.remove("highlighting"))}#p(t){this.#o.unselectAll();let{target:n}=t;if(n===this.#a.div||(n.getAttribute("role")==="img"||n.classList.contains("endOfContent"))&&this.#a.div.contains(n)){let{isMac:r}=Ai.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#o.showAllEditors("highlight",!0,!0),this.#a.div.classList.add("free"),this.toggleDrawing(),kv.startHighlighting(this,this.#o.direction==="ltr",{target:this.#a.div,x:t.x,y:t.y}),this.#a.div.addEventListener("pointerup",()=>{this.#a.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#o._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;let t=this.#o.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);let{annotationElementId:n}=t;n&&this.#o.isDeletedAnnotationElement(n)&&this.#o.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv),!this.#c&&t.annotationElementId&&this.#o.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#o.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#d||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#o.addDeletedAnnotationElement(t.annotationElementId),on.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#o.addEditor(t),this.attach(t),!t.isAttachedToDOM){let n=t.render();this.div.append(n),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#o.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:n}=document;t.div.contains(n)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#o._signal}),n.focus())},0)),t._structTreeParentId=this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let n=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:n,undo:r,mustExec:!1})}getNextId(){return this.#o.getId()}get#f(){return i.#h.get(this.#o.getMode())}combinedSignal(t){return this.#o.combinedSignal(t)}#m(t){let n=this.#f;return n?new n.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(t,n){this.#o.updateToolbar(t),this.#o.updateMode(t);let{offsetX:r,offsetY:s}=this.#v(),o=this.getNextId(),a=this.#m(ae({parent:this,id:o,x:r,y:s,uiManager:this.#o,isCentered:!0},n));a&&this.add(a)}deserialize(t){return re(this,null,function*(){return(yield i.#h.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#o))||null})}createAndAddNewEditor(t,n,r={}){let s=this.getNextId(),o=this.#m(ae({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#o,isCentered:n},r));return o&&this.add(o),o}#v(){let{x:t,y:n,width:r,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,t),a=Math.max(0,n),l=Math.min(window.innerWidth,t+r),d=Math.min(window.innerHeight,n+s),c=(o+l)/2-t,u=(a+d)/2-n,[h,f]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:h,offsetY:f}}addNewEditor(){this.createAndAddNewEditor(this.#v(),!0)}setSelected(t){this.#o.setSelected(t)}toggleSelected(t){this.#o.toggleSelected(t)}unselect(t){this.#o.unselect(t)}pointerup(t){let{isMac:n}=Ai.platform;if(!(t.button!==0||t.ctrlKey&&n)&&t.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}if(this.#o.getMode()===Rt.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#o.getMode()===Rt.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}let{isMac:n}=Ai.platform;if(t.button!==0||t.ctrlKey&&n||t.target!==this.div)return;this.#l=!0;let r=this.#o.getActive();this.#t=!r||r.isEmpty()}findNewParent(t,n,r){let s=this.#o.findParent(n,r);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(let t of this.#s.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#o.removeLayer(this)}#g(){this.#d=!0;for(let t of this.#s.values())t.isEmpty()&&t.remove();this.#d=!1}render({viewport:t}){this.viewport=t,Xl(this.div,t);for(let n of this.#o.getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update({viewport:t}){this.#o.commitOrRemove(),this.#g();let n=this.viewport.rotation,r=t.rotation;if(this.viewport=t,Xl(this.div,{rotation:r}),n!==r)for(let s of this.#s.values())s.rotate(r);this.addInkEditorIfNeeded(!1)}get pageDimensions(){let{pageWidth:t,pageHeight:n}=this.viewport.rawDims;return[t,n]}get scale(){return this.#o.viewParameters.realScale}}return i})(),WE=class i{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(let t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Gt(this,"_svgFactory",new xf)}static#r(e,{x:t=0,y:n=0,width:r=1,height:s=1}={}){let{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*s}%`}#s(e){let t=i._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),i.#r(t,e),t}#l(e,t){let n=i._svgFactory.createElement("clipPath");e.append(n);let r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");let s=i._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r}draw(e,t,n,r=!1){let s=this.#t++,o=this.#s(e.box);o.classList.add(...e.classNamesForDrawing);let a=i._svgFactory.createElement("defs");o.append(a);let l=i._svgFactory.createElement("path");a.append(l);let d=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",d),l.setAttribute("d",e.toSVGPath()),r&&this.#i.set(s,l);let c=this.#l(a,d),u=i._svgFactory.createElement("use");return o.append(u),o.setAttribute("fill",t),o.setAttribute("fill-opacity",n),u.setAttribute("href",`#${d}`),this.#n.set(s,o),{id:s,clipPathId:`url(#${c})`}}drawOutline(e){let t=this.#t++,n=this.#s(e.box);n.classList.add(...e.classNamesForOutlining);let r=i._svgFactory.createElement("defs");n.append(r);let s=i._svgFactory.createElement("path");r.append(s);let o=`path_p${this.pageIndex}_${t}`;s.setAttribute("id",o),s.setAttribute("d",e.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let a;if(e.mustRemoveSelfIntersections){let c=i._svgFactory.createElement("mask");r.append(c),a=`mask_p${this.pageIndex}_${t}`,c.setAttribute("id",a),c.setAttribute("maskUnits","objectBoundingBox");let u=i._svgFactory.createElement("rect");c.append(u),u.setAttribute("width","1"),u.setAttribute("height","1"),u.setAttribute("fill","white");let h=i._svgFactory.createElement("use");c.append(h),h.setAttribute("href",`#${o}`),h.setAttribute("stroke","none"),h.setAttribute("fill","black"),h.setAttribute("fill-rule","nonzero"),h.classList.add("mask")}let l=i._svgFactory.createElement("use");n.append(l),l.setAttribute("href",`#${o}`),a&&l.setAttribute("mask",`url(#${a})`);let d=l.cloneNode();return n.append(d),l.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.#n.set(t,n),t}finalizeLine(e,t){let n=this.#i.get(e);this.#i.delete(e),this.updateBox(e,t.box),n.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){this.#i.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){i.#r(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}getSVGRoot(e){return this.#n.get(e)}remove(e){this.#i.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(let e of this.#n.values())e.remove();this.#n.clear(),this.#i.clear()}};var YX=yt.AbortException,XX=yt.AnnotationEditorLayer,QX=yt.AnnotationEditorParamsType,$3=yt.AnnotationEditorType,KX=yt.AnnotationEditorUIManager,JX=yt.AnnotationLayer,$X=yt.AnnotationMode,eQ=yt.ColorPicker,tQ=yt.DOMSVGFactory,nQ=yt.DrawLayer,iQ=yt.FeatureTest,ek=yt.GlobalWorkerOptions,rQ=yt.ImageKind,sQ=yt.InvalidPDFException,oQ=yt.MissingPDFException,aQ=yt.OPS,lQ=yt.OutputScale,dQ=yt.PDFDataRangeTransport,cQ=yt.PDFDateString,uQ=yt.PDFWorker,hQ=yt.PasswordResponses,fQ=yt.PermissionFlag,pQ=yt.PixelsPerInch,mQ=yt.RenderingCancelledException,gQ=yt.TextLayer,vQ=yt.UnexpectedResponseException,xQ=yt.Util,$E=yt.VerbosityLevel,wQ=yt.XfaLayer,bQ=yt.build,yQ=yt.createValidAbsoluteUrl,AQ=yt.fetchData,tk=yt.getDocument,_Q=yt.getFilenameFromUrl,SQ=yt.getPdfFilenameFromUrl,EQ=yt.getXfaPageViewport,CQ=yt.isDataScheme,MQ=yt.isPdfFile,TQ=yt.noContextMenu,IQ=yt.normalizeUnicode,DQ=yt.setLayerDimensions,PQ=yt.shadow,nk=yt.version;var Sf={};Sf.d=(i,e)=>{for(var t in e)Sf.o(e,t)&&!Sf.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};Sf.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var Dn=globalThis.pdfjsViewer={};Sf.d(Dn,{AnnotationLayerBuilder:()=>Kv,DownloadManager:()=>fC,EventBus:()=>Jv,FindState:()=>Ka,GenericL10n:()=>$c,LinkTarget:()=>Jl,PDFFindController:()=>uC,PDFHistory:()=>SC,PDFLinkService:()=>Xv,PDFPageView:()=>rx,PDFScriptingManager:()=>LC,PDFSinglePageViewer:()=>FC,PDFViewer:()=>sx,ProgressBar:()=>cC,RenderingStates:()=>Fn,ScrollMode:()=>Yt,SimpleLinkService:()=>Mf,SpreadMode:()=>Ni,StructTreeLayerBuilder:()=>tx,TextLayerBuilder:()=>nx,XfaLayerBuilder:()=>ix,parseQueryString:()=>ox});var RQ="auto",Fk=1,ik=1.1,LQ=.1,kQ=10,tC=0,NQ=1.25,rk=40,sk=5,Fn={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Qc={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var Ks={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Yt={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Ni={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function Ok(i,e,t=!1){let n=i.offsetParent;if(!n){console.error("offsetParent is not set -- cannot scroll");return}let r=i.offsetTop+i.clientTop,s=i.offsetLeft+i.clientLeft;for(;n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||t&&(n.classList.contains("markedContent")||getComputedStyle(n).overflow==="hidden");)if(r+=n.offsetTop,s+=n.offsetLeft,n=n.offsetParent,!n)return;e&&(e.top!==void 0&&(r+=e.top),e.left!==void 0&&(s+=e.left,n.scrollLeft=s)),n.scrollTop=r}function FQ(i,e,t=void 0){let n=function(o){s||(s=window.requestAnimationFrame(function(){s=null;let l=i.scrollLeft,d=r.lastX;l!==d&&(r.right=l>d),r.lastX=l;let c=i.scrollTop,u=r.lastY;c!==u&&(r.down=c>u),r.lastY=c,e(r)}))},r={right:!0,down:!0,lastX:i.scrollLeft,lastY:i.scrollTop,_eventHandler:n},s=null;return i.addEventListener("scroll",n,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(s),{once:!0}),r}function ox(i){let e=new Map;for(let[t,n]of new URLSearchParams(i))e.set(t.toLowerCase(),n);return e}var ok=/[\x00-\x1F]/g;function Ef(i,e=!1){return ok.test(i)?e?i.replaceAll(ok,t=>t==="\0"?"":" "):i.replaceAll("\0",""):i}function Cf(i,e,t=0){let n=t,r=i.length-1;if(r<0||!e(i[r]))return i.length;if(e(i[n]))return n;for(;n<r;){let s=n+r>>1,o=i[s];e(o)?r=s:n=s+1}return n}function ak(i){if(Math.floor(i)===i)return[i,1];let e=1/i,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];let n=i>1?e:i,r=0,s=1,o=1,a=1;for(;;){let d=r+o,c=s+a;if(c>t)break;n<=d/c?(o=d,a=c):(r=d,s=c)}let l;return n-r/s<o/a-n?l=n===i?[r,s]:[s,r]:l=n===i?[o,a]:[a,o],l}function zv(i,e){return i-i%e}function OQ(i,e,t){if(i<2)return i;let n=e[i].div,r=n.offsetTop+n.clientTop;r>=t&&(n=e[i-1].div,r=n.offsetTop+n.clientTop);for(let s=i-2;s>=0&&(n=e[s].div,!(n.offsetTop+n.clientTop+n.clientHeight<=r));--s)i=s;return i}function BQ({scrollEl:i,views:e,sortByVisibility:t=!1,horizontal:n=!1,rtl:r=!1}){let s=i.scrollTop,o=s+i.clientHeight,a=i.scrollLeft,l=a+i.clientWidth;function d(y){let b=y.div;return b.offsetTop+b.clientTop+b.clientHeight>s}function c(y){let b=y.div,A=b.offsetLeft+b.clientLeft,M=A+b.clientWidth;return r?A<l:M>a}let u=[],h=new Set,f=e.length,p=Cf(e,n?c:d);p>0&&p<f&&!n&&(p=OQ(p,e,s));let x=n?l:-1;for(let y=p;y<f;y++){let b=e[y],A=b.div,M=A.offsetLeft+A.clientLeft,T=A.offsetTop+A.clientTop,I=A.clientWidth,L=A.clientHeight,E=M+I,S=T+L;if(x===-1)S>=o&&(x=S);else if((n?M:T)>x)break;if(S<=s||T>=o||E<=a||M>=l)continue;let P=Math.max(0,s-T)+Math.max(0,S-o),j=Math.max(0,a-M)+Math.max(0,E-l),B=(L-P)/L,z=(I-j)/I,X=B*z*100|0;u.push({id:b.id,x:M,y:T,view:b,percent:X,widthPercent:z*100|0}),h.add(b.id)}let v=u[0],g=u.at(-1);return t&&u.sort(function(y,b){let A=y.percent-b.percent;return Math.abs(A)>.001?-A:y.id-b.id}),{first:v,last:g,views:u,ids:h}}function Bk(i){return Number.isInteger(i)&&i%90===0}function VQ(i){return Number.isInteger(i)&&Object.values(Yt).includes(i)&&i!==Yt.UNKNOWN}function UQ(i){return Number.isInteger(i)&&Object.values(Ni).includes(i)&&i!==Ni.UNKNOWN}function lk(i){return i.width<=i.height}var ype=new Promise(function(i){window.requestAnimationFrame(i)}),HQ=document.documentElement.style;function zQ(i,e,t){return Math.min(Math.max(i,e),t)}var cC=class{#e=null;#t=null;#n=0;#i=null;#r=!0;constructor(e){this.#e=e.classList,this.#i=e.style}get percent(){return this.#n}set percent(e){if(this.#n=zQ(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#i.setProperty("--progressBar-percent",`${this.#n}%`)}setWidth(e){if(!e)return;let n=e.parentNode.offsetWidth-e.offsetWidth;n>0&&this.#i.setProperty("--progressBar-end-offset",`${n}px`)}setDisableAutoFetch(e=5e3){this.#n===100||isNaN(this.#n)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#r&&(this.#r=!1,this.#e.add("hidden"))}show(){this.#r||(this.#r=!0,this.#e.remove("hidden"))}};function jQ(i){let e=Yt.VERTICAL,t=Ni.NONE;switch(i){case"SinglePage":e=Yt.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=Yt.PAGE;case"TwoColumnLeft":t=Ni.ODD;break;case"TwoPageRight":e=Yt.PAGE;case"TwoColumnRight":t=Ni.EVEN;break}return{scrollMode:e,spreadMode:t}}var jv=function(){let i=document.createElement("div");return i.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",i.style.width==="calc(1320px)"?Math.fround:e=>e}(),_s={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function GQ(i){return i<11904}function WQ(i){return(i&65408)===0}function qQ(i){return i>=97&&i<=122||i>=65&&i<=90}function ZQ(i){return i>=48&&i<=57}function YQ(i){return i===32||i===9||i===13||i===10}function XQ(i){return i>=13312&&i<=40959||i>=63744&&i<=64255}function QQ(i){return i>=12448&&i<=12543}function KQ(i){return i>=12352&&i<=12447}function JQ(i){return i>=65376&&i<=65439}function $Q(i){return(i&65408)===3584}function Gv(i){return GQ(i)?WQ(i)?YQ(i)?_s.SPACE:qQ(i)||ZQ(i)||i===95?_s.ALPHA_LETTER:_s.PUNCT:$Q(i)?_s.THAI_LETTER:i===160?_s.SPACE:_s.ALPHA_LETTER:XQ(i)?_s.HAN_LETTER:QQ(i)?_s.KATAKANA_LETTER:KQ(i)?_s.HIRAGANA_LETTER:JQ(i)?_s.HALFWIDTH_KATAKANA_LETTER:_s.ALPHA_LETTER}var dk;function eK(){return dk||="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6",dk}var Ka={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},tK=250,nK=-50,iK=-400,ck={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"},uk=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),hk,rK=new RegExp("\\p{M}+","gu"),sK=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),oK=new RegExp("([^\\p{M}])\\p{M}*$","u"),aK=new RegExp("^\\p{M}*([^\\p{M}])","u"),lK=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,fk=new Map,dK="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",pk=new Map,nC=null,iC=null;function rC(i){let e=[],t;for(;(t=lK.exec(i))!==null;){let{index:f}=t;for(let p of t[0]){let x=fk.get(p);x||(x=p.normalize("NFD").length,fk.set(p,x)),e.push([x,f++])}}let n;if(e.length===0&&nC)n=nC;else if(e.length>0&&iC)n=iC;else{let f=Object.keys(ck).join(""),p=eK(),y=`([${f}])|([${p}])|((?:\u3099|\u309A)\\n)|(\\p{M}+(?:-\\n)?)|(\\p{Ll}-\\n\\p{Lu})|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30FF])\\n)|(\\n)`;e.length===0?n=nC=new RegExp(y+"|(\\u0000)","gum"):n=iC=new RegExp(y+`|(${dK})`,"gum")}let r=[];for(;(t=rK.exec(i))!==null;)r.push([t[0].length,t.index]);let s=i.normalize("NFD"),o=[[0,0]],a=0,l=0,d=0,c=0,u=0,h=!1;return s=s.replace(n,(f,p,x,v,g,y,b,A,M,T,I)=>{if(I-=c,p){let L=ck[p],E=L.length;for(let S=1;S<E;S++)o.push([I-d+S,d-S]);return d-=E-1,L}if(x){let L=pk.get(x);L||(L=x.normalize("NFKC"),pk.set(x,L));let E=L.length;for(let S=1;S<E;S++)o.push([I-d+S,d-S]);return d-=E-1,L}if(v)return h=!0,I+u===r[a]?.[1]?++a:(o.push([I-1-d+1,d-1]),d-=1,c+=1),o.push([I-d+1,d]),c+=1,u+=1,v.charAt(0);if(g){let L=g.endsWith(`
`),E=L?g.length-2:g.length;h=!0;let S=E;I+u===r[a]?.[1]&&(S-=r[a][0],++a);for(let P=1;P<=S;P++)o.push([I-1-d+P,d-P]);return d-=S,c+=S,L?(I+=E-1,o.push([I-d+1,1+d]),d+=1,c+=1,u+=1,g.slice(0,E)):g}if(y)return o.push([I-d+3,1+d]),d+=1,c+=1,u+=1,y.replace(`
`,"");if(b){let L=b.length-2;return o.push([I-d+L,1+d]),d+=1,c+=1,u+=1,b.slice(0,-2)}if(A){let L=A.length-1;return o.push([I-d+L,d]),c+=1,u+=1,A.slice(0,-1)}if(M)return o.push([I-d+1,d-1]),d-=1,c+=1,u+=1," ";if(I+u===e[l]?.[1]){let L=e[l][0]-1;++l;for(let E=1;E<=L;E++)o.push([I-(d-E),d-E]);d-=L,c+=L}return T}),o.push([s.length,d]),[s,o,h]}function cK(i,e,t){if(!i)return[e,t];let n=e,r=e+t-1,s=Cf(i,c=>c[0]>=n);i[s][0]>n&&--s;let o=Cf(i,c=>c[0]>=r,s);i[o][0]>r&&--o;let a=n+i[s][1],d=r+i[o][1]+1-a;return[a,d]}var uC=class{#e=null;#t=!0;#n=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:n=!0}){this._linkService=e,this._eventBus=t,this.#t=n,this.onIsPageVisible=null,this.#r(),t._on("find",this.#i.bind(this)),t._on("findbarclose",this.#x.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#r(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#i(e){if(!e)return;let t=this._pdfDocument,{type:n}=e;(this.#e===null||this.#l(e))&&(this._dirtyMatch=!0),this.#e=e,n!=="highlightallchange"&&this.#y(Ka.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#u();let r=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?this.#p():n==="again"?(this.#p(),r&&this.#e.highlightAll&&this.#h()):n==="highlightallchange"?(s?this.#p():this._highlightMatches=!0,this.#h()):this.#p():this._findTimeout=setTimeout(()=>{this.#p(),this._findTimeout=null},tK)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:n=-1,matchIndex:r=-1}){if(!this._scrollMatches||!e)return;if(r===-1||r!==this._selected.matchIdx)return;if(n===-1||n!==this._selected.pageIdx)return;this._scrollMatches=!1;let s={top:nK,left:t+iK};Ok(e,s,!0)}#r(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#n=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#s(){let{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=rC(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>rC(t)[0])}#l(e){let t=e.query,n=this.#e.query,r=typeof t;if(r!==typeof n)return!0;if(r==="string"){if(t!==n)return!0}else if(JSON.stringify(t)!==JSON.stringify(n))return!0;switch(e.type){case"again":let o=this._selected.pageIdx+1,a=this._linkService;return o>=1&&o<=a.pagesCount&&o!==a.page&&!(this.onIsPageVisible?.(o)??!0);case"highlightallchange":return!1}return!0}#d(e,t,n){let r=e.slice(0,t).match(oK);if(r){let s=e.charCodeAt(t),o=r[1].charCodeAt(0);if(Gv(s)===Gv(o))return!1}if(r=e.slice(t+n).match(aK),r){let s=e.charCodeAt(t+n-1),o=r[1].charCodeAt(0);if(Gv(s)===Gv(o))return!1}return!0}#c(e,t){let{matchDiacritics:n}=this.#e,r=!1;e=e.replaceAll(sK,(o,a,l,d,c,u)=>a?`[ ]*\\${a}[ ]*`:l?`[ ]*${l}[ ]*`:d?"[ ]+":n?c||u:c?uk.has(c.charCodeAt(0))?c:"":t?(r=!0,`${u}\\p{M}*`):u);let s="[ ]*";return e.endsWith(s)&&(e=e.slice(0,e.length-s.length)),n&&t&&(hk||=String.fromCharCode(...uk),r=!0,e=`${e}(?=[${hk}]|[^\\p{M}]|$)`),[r,e]}#a(e){let t=this.#s;if(t.length===0)return;let n=this._pageContents[e],r=this.match(t,n,e),s=this._pageMatches[e]=[],o=this._pageMatchesLength[e]=[],a=this._pageDiffs[e];r?.forEach(({index:d,length:c})=>{let[u,h]=cK(a,d,c);h&&(s.push(u),o.push(h))}),this.#e.highlightAll&&this.#o(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#m());let l=s.length;this._matchesCountTotal+=l,this.#t?l>0&&this.#_():++this.#n===this._linkService.pagesCount&&this.#_()}match(e,t,n){let r=this._hasDiacritics[n],s=!1;if(typeof e=="string"?[s,e]=this.#c(e,r):e=e.sort().reverse().map(u=>{let[h,f]=this.#c(u,r);return s||=h,`(${f})`}).join("|"),!e)return;let{caseSensitive:o,entireWord:a}=this.#e,l=`g${s?"u":""}${o?"":"i"}`;e=new RegExp(e,l);let d=[],c;for(;(c=e.exec(t))!==null;)a&&!this.#d(t,c.index,c[0].length)||d.push({index:c.index,length:c[0].length});return d}#u(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve(),t={disableNormalization:!0};for(let n=0,r=this._linkService.pagesCount;n<r;n++){let{promise:s,resolve:o}=Promise.withResolvers();this._extractTextPromises[n]=s,e=e.then(()=>this._pdfDocument.getPage(n+1).then(a=>a.getTextContent(t)).then(a=>{let l=[];for(let d of a.items)l.push(d.str),d.hasEOL&&l.push(`
`);[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=rC(l.join("")),o()},a=>{console.error(`Unable to get text content for page ${n+1}`,a),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,o()}))}}#o(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#h(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#p(){let e=this.#e.findPrevious,t=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#n=0,this._matchesCountTotal=0,this.#h();for(let o=0;o<n;o++)this._pendingFindMatches.has(o)||(this._pendingFindMatches.add(o),this._extractTextPromises[o].then(()=>{this._pendingFindMatches.delete(o),this.#a(o)}))}if(this.#s.length===0){this.#y(Ka.FOUND);return}if(this._resumePageIdx)return;let s=this._offset;if(this._pagesToSearch=n,s.matchIdx!==null){let o=this._pageMatches[s.pageIdx].length;if(!e&&s.matchIdx+1<o||e&&s.matchIdx>0){s.matchIdx=e?s.matchIdx-1:s.matchIdx+1,this.#g(!0);return}this.#v(e)}this.#m()}#f(e){let t=this._offset,n=e.length,r=this.#e.findPrevious;return n?(t.matchIdx=r?n-1:0,this.#g(!0),!0):(this.#v(r),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#g(!1),!0):!1)}#m(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{let t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#f(e))}#v(e){let t=this._offset,n=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=n||t.pageIdx<0)&&(t.pageIdx=e?n-1:0,t.wrapped=!0)}#g(e=!1){let t=Ka.NOT_FOUND,n=this._offset.wrapped;if(this._offset.wrapped=!1,e){let r=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=n?Ka.WRAPPED:Ka.FOUND,r!==-1&&r!==this._selected.pageIdx&&this.#o(r)}this.#y(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#o(this._selected.pageIdx))}#x(e){let t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#y(Ka.FOUND),this._highlightMatches=!1,this.#h())})}#b(){let{pageIdx:e,matchIdx:t}=this._selected,n=0,r=this._matchesCountTotal;if(t!==-1){for(let s=0;s<e;s++)n+=this._pageMatches[s]?.length||0;n+=t+1}return(n<1||n>r)&&(n=r=0),{current:n,total:r}}#_(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#b()})}#y(e,t=!1){!this.#t&&(this.#n!==this._linkService.pagesCount||e===Ka.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#b(),rawQuery:this.#e?.query??null})}},uK="noopener noreferrer nofollow",Jl={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},Xv=class i{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:n=null,ignoreDestinationZoom:r=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=n,this._ignoreDestinationZoom=r,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}goToDestination(e){return re(this,null,function*(){if(!this.pdfDocument)return;let t,n,r;if(typeof e=="string"?(t=e,n=yield this.pdfDocument.getDestination(e)):(t=null,n=yield e),!Array.isArray(n)){console.error(`goToDestination: "${n}" is not a valid destination array, for dest="${e}".`);return}let[s]=n;if(s&&typeof s=="object"){if(r=this.pdfDocument.cachedPageNumber(s),!r)try{r=(yield this.pdfDocument.getPageIndex(s))+1}catch{console.error(`goToDestination: "${s}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(s)&&(r=s+1);if(!r||r<1||r>this.pagesCount){console.error(`goToDestination: "${r}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:n,pageNumber:r})),this.pdfViewer.scrollPageIntoView({pageNumber:r,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom})})}goToPage(e){if(!this.pdfDocument)return;let t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,n=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');let r=n?Jl.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let o="";switch(r){case Jl.NONE:break;case Jl.SELF:o="_self";break;case Jl.BLANK:o="_blank";break;case Jl.PARENT:o="_parent";break;case Jl.TOP:o="_top";break}e.target=o,e.rel=typeof s=="string"?s:uK}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){let t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,n;if(e.includes("=")){let r=ox(e);if(r.has("search")){let s=r.get("search").replaceAll('"',""),o=r.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:o?s:s.match(/\S+/g)})}if(r.has("page")&&(t=r.get("page")|0||1),r.has("zoom")){let s=r.get("zoom").split(","),o=s[0],a=parseFloat(o);o.includes("Fit")?o==="Fit"||o==="FitB"?n=[null,{name:o}]:o==="FitH"||o==="FitBH"||o==="FitV"||o==="FitBV"?n=[null,{name:o},s.length>1?s[1]|0:null]:o==="FitR"?s.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):n=[null,{name:o},s[1]|0,s[2]|0,s[3]|0,s[4]|0]:console.error(`PDFLinkService.setHash: "${o}" is not a valid zoom value.`):n=[null,{name:"XYZ"},s.length>1?s[1]|0:null,s.length>2?s[2]|0:null,a?a/100:o]}n?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:n,allowNegativeOffset:!0}):t&&(this.page=t),r.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:r.get("pagemode")}),r.has("nameddest")&&this.goToDestination(r.get("nameddest"));return}n=unescape(e);try{n=JSON.parse(n),Array.isArray(n)||(n=n.toString())}catch{}if(typeof n=="string"||i.#e(n)){this.goToDestination(n);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}executeSetOCGState(e){return re(this,null,function*(){if(!this.pdfDocument)return;let t=this.pdfDocument,n=yield this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(n.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(n))})}static#e(e){if(!Array.isArray(e)||e.length<2)return!1;let[t,n,...r]=e;if(!(typeof t=="object"&&Number.isInteger(t?.num)&&Number.isInteger(t?.gen))&&!Number.isInteger(t)||!(typeof n=="object"&&typeof n?.name=="string"))return!1;let s=r.length,o=!0;switch(n.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;o=!1;break;default:return!1}for(let a of r)if(!(typeof a=="number"||o&&a===null))return!1;return!0}},Mf=class extends Xv{setDocument(e,t=null){}},{AbortException:hK,AnnotationEditorLayer:fK,AnnotationEditorParamsType:Ape,AnnotationEditorType:_r,AnnotationEditorUIManager:pK,AnnotationLayer:mK,AnnotationMode:Jo,build:_pe,ColorPicker:Spe,createValidAbsoluteUrl:gK,DOMSVGFactory:Epe,DrawLayer:vK,FeatureTest:Cpe,fetchData:mk,getDocument:Mpe,getFilenameFromUrl:Tpe,getPdfFilenameFromUrl:xK,getXfaPageViewport:Ipe,GlobalWorkerOptions:Dpe,ImageKind:Ppe,InvalidPDFException:Rpe,isDataScheme:Lpe,isPdfFile:wK,MissingPDFException:kpe,noContextMenu:Npe,normalizeUnicode:bK,OPS:Fpe,OutputScale:yK,PasswordResponses:Ope,PDFDataRangeTransport:Bpe,PDFDateString:Vpe,PDFWorker:Upe,PermissionFlag:Wv,PixelsPerInch:Ko,RenderingCancelledException:hC,setLayerDimensions:AK,shadow:Qv,TextLayer:_K,UnexpectedResponseException:Hpe,Util:zpe,VerbosityLevel:jpe,version:gk,XfaLayer:sC}=globalThis.pdfjsLib,Kv=class{#e=null;#t=null;constructor({pdfPage:e,linkService:t,downloadManager:n,annotationStorage:r=null,imageResourcesPath:s="",renderForms:o=!0,enableScripting:a=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:d=null,annotationCanvasMap:c=null,accessibilityManager:u=null,annotationEditorUIManager:h=null,onAppend:f=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=n,this.imageResourcesPath=s,this.renderForms=o,this.annotationStorage=r,this.enableScripting=a,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=d||Promise.resolve(null),this._annotationCanvasMap=c,this._accessibilityManager=u,this._annotationEditorUIManager=h,this.#e=f,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}render(e,t,n="display"){return re(this,null,function*(){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}let[r,s,o]=yield Promise.all([this.pdfPage.getAnnotations({intent:n}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;let a=this.div=document.createElement("div");if(a.className="annotationLayer",this.#e?.(a),r.length===0){this.hide();return}this.annotationLayer=new mK({div:a,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0}),structTreeLayer:t?.structTreeLayer||null}),yield this.annotationLayer.render({annotations:r,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:s,fieldObjects:o}),this.linkService.isInPresentationMode&&this.#n(Qc.FULLSCREEN),this.#t||(this.#t=new AbortController,this._eventBus?._on("presentationmodechanged",l=>{this.#n(l.state)},{signal:this.#t.signal}))})}cancel(){this._cancelled=!0,this.#t?.abort(),this.#t=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#n(e){if(!this.div)return;let t=!1;switch(e){case Qc.FULLSCREEN:t=!0;break;case Qc.NORMAL:break;default:return}for(let n of this.div.childNodes)n.hasAttribute("data-internal-link")||(n.inert=t)}};function vk(i,e){let t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=i,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}var fC=class{#e=new WeakMap;downloadData(e,t,n){let r=URL.createObjectURL(new Blob([e],{type:n}));vk(r,t)}openOrDownloadData(e,t,n=null){let s=wK(t)?"application/pdf":"";return this.downloadData(e,t,s),!1}download(e,t,n){let r;if(e)r=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!gK(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}r=t+"#pdfjs.action=download"}vk(r,n)}},xk={EVENT:"event",TIMEOUT:"timeout"};function SK(n){return re(this,arguments,function*({target:i,name:e,delay:t=0}){if(typeof i!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");let{promise:r,resolve:s}=Promise.withResolvers(),o=new AbortController;function a(c){o.abort(),clearTimeout(d),s(c)}let l=i instanceof Jv?"_on":"addEventListener";i[l](e,a.bind(null,xk.EVENT),{signal:o.signal});let d=setTimeout(a.bind(null,xk.TIMEOUT),t);return r})}var Jv=class{#e=Object.create(null);on(e,t,n=null){this._on(e,t,{external:!0,once:n?.once,signal:n?.signal})}off(e,t,n=null){this._off(e,t)}dispatch(e,t){let n=this.#e[e];if(!n||n.length===0)return;let r;for(let{listener:s,external:o,once:a}of n.slice(0)){if(a&&this._off(e,s),o){(r||=[]).push(s);continue}s(t)}if(r){for(let s of r)s(t);r=null}}_on(e,t,n=null){let r=null;if(n?.signal instanceof AbortSignal){let{signal:o}=n;if(o.aborted){console.error("Cannot use an `aborted` signal.");return}let a=()=>this._off(e,t);r=()=>o.removeEventListener("abort",a),o.addEventListener("abort",a)}(this.#e[e]||=[]).push({listener:t,external:n?.external===!0,once:n?.once===!0,rmAbort:r})}_off(e,t,n=null){let r=this.#e[e];if(r)for(let s=0,o=r.length;s<o;s++){let a=r[s];if(a.listener===t){a.rmAbort?.(),r.splice(s,1);return}}}};var Kc=class{constructor(e){this.value=e}valueOf(){return this.value}},On=class extends Kc{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Ss=class extends Kc{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},ed=class extends Kc{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},wk=100,EK="\u2068",CK="\u2069";function MK(i,e,t){if(t===e||t instanceof Ss&&e instanceof Ss&&t.value===e.value)return!0;if(e instanceof Ss&&typeof t=="string"){let n=i.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===n)return!0}return!1}function bk(i,e,t){return e[t]?Jc(i,e[t].value):(i.reportError(new RangeError("No default")),new On)}function pC(i,e){let t=[],n=Object.create(null);for(let r of e)r.type==="narg"?n[r.name]=Tf(i,r.value):t.push(Tf(i,r));return{positional:t,named:n}}function Tf(i,e){switch(e.type){case"str":return e.value;case"num":return new Ss(e.value,{minimumFractionDigits:e.precision});case"var":return TK(i,e);case"mesg":return IK(i,e);case"term":return DK(i,e);case"func":return PK(i,e);case"select":return RK(i,e);default:return new On}}function TK(i,{name:e}){let t;if(i.params)if(Object.prototype.hasOwnProperty.call(i.params,e))t=i.params[e];else return new On(`$${e}`);else if(i.args&&Object.prototype.hasOwnProperty.call(i.args,e))t=i.args[e];else return i.reportError(new ReferenceError(`Unknown variable: $${e}`)),new On(`$${e}`);if(t instanceof Kc)return t;switch(typeof t){case"string":return t;case"number":return new Ss(t);case"object":if(t instanceof Date)return new ed(t.getTime());default:return i.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new On(`$${e}`)}}function IK(i,{name:e,attr:t}){let n=i.bundle._messages.get(e);if(!n)return i.reportError(new ReferenceError(`Unknown message: ${e}`)),new On(e);if(t){let r=n.attributes[t];return r?Jc(i,r):(i.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new On(`${e}.${t}`))}return n.value?Jc(i,n.value):(i.reportError(new ReferenceError(`No value: ${e}`)),new On(e))}function DK(i,{name:e,attr:t,args:n}){let r=`-${e}`,s=i.bundle._terms.get(r);if(!s)return i.reportError(new ReferenceError(`Unknown term: ${r}`)),new On(r);if(t){let a=s.attributes[t];if(a){i.params=pC(i,n).named;let l=Jc(i,a);return i.params=null,l}return i.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new On(`${r}.${t}`)}i.params=pC(i,n).named;let o=Jc(i,s.value);return i.params=null,o}function PK(i,{name:e,args:t}){let n=i.bundle._functions[e];if(!n)return i.reportError(new ReferenceError(`Unknown function: ${e}()`)),new On(`${e}()`);if(typeof n!="function")return i.reportError(new TypeError(`Function ${e}() is not callable`)),new On(`${e}()`);try{let r=pC(i,t);return n(r.positional,r.named)}catch(r){return i.reportError(r),new On(`${e}()`)}}function RK(i,{selector:e,variants:t,star:n}){let r=Tf(i,e);if(r instanceof On)return bk(i,t,n);for(let s of t){let o=Tf(i,s.key);if(MK(i,r,o))return Jc(i,s.value)}return bk(i,t,n)}function Vk(i,e){if(i.dirty.has(e))return i.reportError(new RangeError("Cyclic reference")),new On;i.dirty.add(e);let t=[],n=i.bundle._useIsolating&&e.length>1;for(let r of e){if(typeof r=="string"){t.push(i.bundle._transform(r));continue}if(i.placeables++,i.placeables>wk)throw i.dirty.delete(e),new RangeError(`Too many placeables expanded: ${i.placeables}, max allowed is ${wk}`);n&&t.push(EK),t.push(Tf(i,r).toString(i)),n&&t.push(CK)}return i.dirty.delete(e),t.join("")}function Jc(i,e){return typeof e=="string"?i.bundle._transform(e):Vk(i,e)}var mC=class{constructor(e,t,n){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=n}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let n=this.bundle._intls.get(e);n||(n={},this.bundle._intls.set(e,n));let r=JSON.stringify(t);return n[r]||(n[r]=new e(this.bundle.locales,t)),n[r]}};function $v(i,e){let t=Object.create(null);for(let[n,r]of Object.entries(i))e.includes(n)&&(t[n]=r.valueOf());return t}var yk=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function LK(i,e){let t=i[0];if(t instanceof On)return new On(`NUMBER(${t.valueOf()})`);if(t instanceof Ss)return new Ss(t.valueOf(),ae(ae({},t.opts),$v(e,yk)));if(t instanceof ed)return new Ss(t.valueOf(),ae({},$v(e,yk)));throw new TypeError("Invalid argument to NUMBER")}var Ak=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function kK(i,e){let t=i[0];if(t instanceof On)return new On(`DATETIME(${t.valueOf()})`);if(t instanceof ed)return new ed(t.valueOf(),ae(ae({},t.opts),$v(e,Ak)));if(t instanceof Ss)return new ed(t.valueOf(),ae({},$v(e,Ak)));throw new TypeError("Invalid argument to DATETIME")}var _k=new Map;function NK(i){let e=Array.isArray(i)?i.join(" "):i,t=_k.get(e);return t===void 0&&(t=new Map,_k.set(e,t)),t}var gC=class{constructor(e,{functions:t,useIsolating:n=!0,transform:r=s=>s}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=ae({NUMBER:LK,DATETIME:kK},t),this._useIsolating=n,this._transform=r,this._intls=NK(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let n=[];for(let r=0;r<e.body.length;r++){let s=e.body[r];if(s.id.startsWith("-")){if(t===!1&&this._terms.has(s.id)){n.push(new Error(`Attempt to override an existing term: "${s.id}"`));continue}this._terms.set(s.id,s)}else{if(t===!1&&this._messages.has(s.id)){n.push(new Error(`Attempt to override an existing message: "${s.id}"`));continue}this._messages.set(s.id,s)}}return n}formatPattern(e,t=null,n=null){if(typeof e=="string")return this._transform(e);let r=new mC(this,n,t);try{return Vk(r,e).toString(r)}catch(s){if(r.errors&&s instanceof Error)return r.errors.push(s),new On().toString(r);throw s}}},oC=/^(-?[a-zA-Z][\w-]*) *= */gm,Sk=/\.([a-zA-Z][\w-]*) *= */y,FK=/\*?\[/y,aC=/(-?[0-9]+(?:\.([0-9]+))?)/y,OK=/([a-zA-Z][\w-]*)/y,Ek=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,BK=/^[A-Z][A-Z0-9_-]*$/,qv=/([^{}\n\r]+)/y,VK=/([^\\"\n\r]*)/y,Ck=/\\([\\"])/y,Mk=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,UK=/^\n+/,Tk=/ +$/,HK=/ *\r?\n/g,zK=/( *)$/,jK=/{\s*/y,Ik=/\s*}/y,GK=/\[\s*/y,WK=/\s*] */y,qK=/\s*\(\s*/y,ZK=/\s*->\s*/y,YK=/\s*:\s*/y,XK=/\s*,?\s*/y,QK=/\s+/y,vC=class{constructor(e){this.body=[],oC.lastIndex=0;let t=0;for(;;){let E=oC.exec(e);if(E===null)break;t=oC.lastIndex;try{this.body.push(l(E[1]))}catch(S){if(S instanceof SyntaxError)continue;throw S}}function n(E){return E.lastIndex=t,E.test(e)}function r(E,S){if(e[t]===E)return t++,!0;if(S)throw new S(`Expected ${E}`);return!1}function s(E,S){if(n(E))return t=E.lastIndex,!0;if(S)throw new S(`Expected ${E.toString()}`);return!1}function o(E){E.lastIndex=t;let S=E.exec(e);if(S===null)throw new SyntaxError(`Expected ${E.toString()}`);return t=E.lastIndex,S}function a(E){return o(E)[1]}function l(E){let S=c(),P=d();if(S===null&&Object.keys(P).length===0)throw new SyntaxError("Expected message value or attributes");return{id:E,value:S,attributes:P}}function d(){let E=Object.create(null);for(;n(Sk);){let S=a(Sk),P=c();if(P===null)throw new SyntaxError("Expected attribute value");E[S]=P}return E}function c(){let E;if(n(qv)&&(E=a(qv)),e[t]==="{"||e[t]==="}")return u(E?[E]:[],1/0);let S=T();return S?E?u([E,S],S.length):(S.value=I(S.value,UK),u([S],S.length)):E?I(E,Tk):null}function u(E=[],S){for(;;){if(n(qv)){E.push(a(qv));continue}if(e[t]==="{"){E.push(h());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let z=T();if(z){E.push(z),S=Math.min(S,z.length);continue}break}let P=E.length-1,j=E[P];typeof j=="string"&&(E[P]=I(j,Tk));let B=[];for(let z of E)z instanceof ex&&(z=z.value.slice(0,z.value.length-S)),z&&B.push(z);return B}function h(){s(jK,SyntaxError);let E=f();if(s(Ik))return E;if(s(ZK)){let S=v();return s(Ik,SyntaxError),ae({type:"select",selector:E},S)}throw new SyntaxError("Unclosed placeable")}function f(){if(e[t]==="{")return h();if(n(Ek)){let[,E,S,P=null]=o(Ek);if(E==="$")return{type:"var",name:S};if(s(qK)){let j=p();if(E==="-")return{type:"term",name:S,attr:P,args:j};if(BK.test(S))return{type:"func",name:S,args:j};throw new SyntaxError("Function names must be all upper-case")}return E==="-"?{type:"term",name:S,attr:P,args:[]}:{type:"mesg",name:S,attr:P}}return y()}function p(){let E=[];for(;;){switch(e[t]){case")":return t++,E;case void 0:throw new SyntaxError("Unclosed argument list")}E.push(x()),s(XK)}}function x(){let E=f();return E.type!=="mesg"?E:s(YK)?{type:"narg",name:E.name,value:y()}:E}function v(){let E=[],S=0,P;for(;n(FK);){r("*")&&(P=S);let j=g(),B=c();if(B===null)throw new SyntaxError("Expected variant value");E[S++]={key:j,value:B}}if(S===0)return null;if(P===void 0)throw new SyntaxError("Expected default variant");return{variants:E,star:P}}function g(){s(GK,SyntaxError);let E;return n(aC)?E=b():E={type:"str",value:a(OK)},s(WK,SyntaxError),E}function y(){if(n(aC))return b();if(e[t]==='"')return A();throw new SyntaxError("Invalid expression")}function b(){let[,E,S=""]=o(aC),P=S.length;return{type:"num",value:parseFloat(E),precision:P}}function A(){r('"',SyntaxError);let E="";for(;;){if(E+=a(VK),e[t]==="\\"){E+=M();continue}if(r('"'))return{type:"str",value:E};throw new SyntaxError("Unclosed string literal")}}function M(){if(n(Ck))return a(Ck);if(n(Mk)){let[,E,S]=o(Mk),P=parseInt(E||S,16);return P<=55295||57344<=P?String.fromCodePoint(P):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function T(){let E=t;switch(s(QK),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return L(e.slice(E,t))}return e[t-1]===" "?L(e.slice(E,t)):!1}function I(E,S){return E.replace(S,"")}function L(E){let S=E.replace(HK,`
`),P=zK.exec(E)[1].length;return new ex(S,P)}}},ex=class{constructor(e,t){this.value=e,this.length=t}},KK=/<|&#?\w+;/,JK={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},$K={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function eJ(i,e){let{value:t}=e;if(typeof t=="string")if(i.localName==="title"&&i.namespaceURI==="http://www.w3.org/1999/xhtml")i.textContent=t;else if(!KK.test(t))i.textContent=t;else{let n=i.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");n.innerHTML=t,tJ(n.content,i)}Uk(e,i)}function tJ(i,e){for(let t of i.childNodes)if(t.nodeType!==t.TEXT_NODE){if(t.hasAttribute("data-l10n-name")){let n=iJ(e,t);i.replaceChild(n,t);continue}if(sJ(t)){let n=rJ(t);i.replaceChild(n,t);continue}console.warn(`An element of forbidden type "${t.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),i.replaceChild(xC(t),t)}e.textContent="",e.appendChild(i)}function nJ(i,e){if(!i)return!1;for(let t of i)if(t.name===e)return!0;return!1}function Uk(i,e){let t=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map(n=>n.trim()):null;for(let n of Array.from(e.attributes))Dk(n.name,e,t)&&!nJ(i.attributes,n.name)&&e.removeAttribute(n.name);if(i.attributes)for(let n of Array.from(i.attributes))Dk(n.name,e,t)&&e.getAttribute(n.name)!==n.value&&e.setAttribute(n.name,n.value)}function iJ(i,e){let t=e.getAttribute("data-l10n-name"),n=i.querySelector(`[data-l10n-name="${t}"]`);if(!n)return console.warn(`An element named "${t}" wasn't found in the source.`),xC(e);if(n.localName!==e.localName)return console.warn(`An element named "${t}" was found in the translation but its type ${e.localName} didn't match the element found in the source (${n.localName}).`),xC(e);i.removeChild(n);let r=n.cloneNode(!1);return Hk(e,r)}function rJ(i){let e=i.ownerDocument.createElement(i.localName);return Hk(i,e)}function xC(i){return i.ownerDocument.createTextNode(i.textContent)}function sJ(i){let e=JK[i.namespaceURI];return e&&e.includes(i.localName)}function Dk(i,e,t=null){if(t&&t.includes(i))return!0;let n=$K[e.namespaceURI];if(!n)return!1;let r=i.toLowerCase(),s=e.localName;if(n.global.includes(r))return!0;if(!n[s])return!1;if(n[s].includes(r))return!0;if(e.namespaceURI==="http://www.w3.org/1999/xhtml"&&s==="input"&&r==="value"){let o=e.type.toLowerCase();if(o==="submit"||o==="button"||o==="reset")return!0}return!1}function Hk(i,e){return e.textContent=i.textContent,Uk(i,e),e}var wC=class extends Array{static from(e){return e instanceof this?e:new this(e)}};var bC=class extends wC{constructor(e){if(super(),Symbol.asyncIterator in Object(e))this.iterator=e[Symbol.asyncIterator]();else if(Symbol.iterator in Object(e))this.iterator=e[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){let e=this,t=0;return{next(){return re(this,null,function*(){return e.length<=t&&e.push(e.iterator.next()),e[t++]})}}}touchNext(e=1){return re(this,null,function*(){let t=0;for(;t++<e;){let n=this[this.length-1];if(n&&(yield n).done)break;this.push(this.iterator.next())}return this[this.length-1]})}},yC=class{constructor(e=[],t){this.resourceIds=e,this.generateBundles=t,this.onChange(!0)}addResourceIds(e,t=!1){return this.resourceIds.push(...e),this.onChange(t),this.resourceIds.length}removeResourceIds(e){return this.resourceIds=this.resourceIds.filter(t=>!e.includes(t)),this.onChange(),this.resourceIds.length}formatWithFallback(e,t){return re(this,null,function*(){let n=[],r=!1;try{for(var s=JC(this.bundles),o,a,l;o=!(a=yield s.next()).done;o=!1){let d=a.value;r=!0;let c=lJ(t,d,e,n);if(c.size===0)break;if(typeof console<"u"){let u=d.locales[0],h=Array.from(c).join(", ");console.warn(`[fluent] Missing translations in ${u}: ${h}`)}}}catch{l=[a]}finally{try{o&&(a=s.return)&&(yield a.call(s))}finally{if(l)throw l[0]}}return!r&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(e)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),n})}formatMessages(e){return this.formatWithFallback(e,aJ)}formatValues(e){return this.formatWithFallback(e,oJ)}formatValue(e,t){return re(this,null,function*(){let[n]=yield this.formatValues([{id:e,args:t}]);return n})}handleEvent(){this.onChange()}onChange(e=!1){this.bundles=bC.from(this.generateBundles(this.resourceIds)),e&&this.bundles.touchNext(2)}};function oJ(i,e,t,n){return t.value?i.formatPattern(t.value,n,e):null}function aJ(i,e,t,n){let r={value:null,attributes:null};t.value&&(r.value=i.formatPattern(t.value,n,e));let s=Object.keys(t.attributes);if(s.length>0){r.attributes=new Array(s.length);for(let[o,a]of s.entries()){let l=i.formatPattern(t.attributes[a],n,e);r.attributes[o]={name:a,value:l}}}return r}function lJ(i,e,t,n){let r=[],s=new Set;return t.forEach(({id:o,args:a},l)=>{if(n[l]!==void 0)return;let d=e.getMessage(o);if(d){if(r.length=0,n[l]=i(e,r,d,a),r.length>0&&typeof console<"u"){let c=e.locales[0],u=r.join(", ");console.warn(`[fluent][resolver] errors in ${c}/${o}: ${u}.`)}}else s.add(o)}),s}var $l="data-l10n-id",_f="data-l10n-args",dJ=`[${$l}]`,AC=class extends yC{constructor(e,t){super(e,t),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[$l,_f]}}onChange(e=!1){super.onChange(e),this.roots&&this.translateRoots()}setAttributes(e,t,n){return e.setAttribute($l,t),n?e.setAttribute(_f,JSON.stringify(n)):e.removeAttribute(_f),e}getAttributes(e){return{id:e.getAttribute($l),args:JSON.parse(e.getAttribute(_f)||null)}}connectRoot(e){for(let t of this.roots)if(t===e||t.contains(e)||e.contains(t))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==e.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=e.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(t=>this.translateMutations(t));this.roots.add(e),this.mutationObserver.observe(e,this.observerConfig)}disconnectRoot(e){return this.roots.delete(e),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){let e=Array.from(this.roots);return Promise.all(e.map(t=>this.translateFragment(t)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(let e of this.roots)this.mutationObserver.observe(e,this.observerConfig)}translateMutations(e){for(let t of e)switch(t.type){case"attributes":t.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(t.target);break;case"childList":for(let n of t.addedNodes)if(n.nodeType===n.ELEMENT_NODE)if(n.childElementCount)for(let r of this.getTranslatables(n))this.pendingElements.add(r);else n.hasAttribute($l)&&this.pendingElements.add(n);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(e){return this.translateElements(this.getTranslatables(e))}translateElements(e){return re(this,null,function*(){if(!e.length)return;let t=e.map(this.getKeysForElement),n=yield this.formatMessages(t);return this.applyTranslations(e,n)})}applyTranslations(e,t){this.pauseObserving();for(let n=0;n<e.length;n++)t[n]!==void 0&&eJ(e[n],t[n]);this.resumeObserving()}getTranslatables(e){let t=Array.from(e.querySelectorAll(dJ));return typeof e.hasAttribute=="function"&&e.hasAttribute($l)&&t.push(e),t}getKeysForElement(e){return{id:e.getAttribute($l),args:JSON.parse(e.getAttribute(_f)||null)}}},_C=class i{#e;#t;#n;#i;constructor({lang:e,isRTL:t},n=null){this.#n=i.#r(e),this.#i=n,this.#e=t??i.#s(this.#n)?"rtl":"ltr"}_setL10n(e){this.#i=e}getLanguage(){return this.#n}getDirection(){return this.#e}get(e,t=null,n){return re(this,null,function*(){return Array.isArray(e)?(e=e.map(o=>({id:o})),(yield this.#i.formatMessages(e)).map(o=>o.value)):(yield this.#i.formatMessages([{id:e,args:t}]))[0]?.value||n})}translate(e){return re(this,null,function*(){(this.#t||=new Set).add(e);try{this.#i.connectRoot(e),yield this.#i.translateRoots()}catch{}})}translateOnce(e){return re(this,null,function*(){try{yield this.#i.translateElements([e])}catch(t){console.error(`translateOnce: "${t}".`)}})}destroy(){return re(this,null,function*(){if(this.#t){for(let e of this.#t)this.#i.disconnectRoot(e);this.#t.clear(),this.#t=null}this.#i.pauseObserving()})}pause(){this.#i.pauseObserving()}resume(){this.#i.resumeObserving()}static#r(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#s(e){let t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}};function Pk(i,e){let t=new vC(e),n=new gC(i),r=n.addResource(t);return r.length&&console.error("L10n errors",r),n}var $c=class i extends _C{constructor(e){super({lang:e});let t=e?i.#e.bind(i,"en-us",this.getLanguage()):i.#i.bind(i,this.getLanguage());this._setL10n(new AC([],t))}static#e(e,t){return Ax(this,null,function*(){let{baseURL:n,paths:r}=yield new Lf(this.#n()),s=[t];if(e!==t){let o=t.split("-",1)[0];o!==t&&s.push(o),s.push(e)}for(let o of s){let a=yield new Lf(this.#t(o,n,r));a?yield a:o==="en-us"&&(yield this.#r(o))}})}static#t(e,t,n){return re(this,null,function*(){let r=n[e];if(!r)return null;let s=new URL(r,t),o=yield mk(s,"text");return Pk(e,o)})}static#n(){return re(this,null,function*(){try{let{href:e}=document.querySelector('link[type="application/l10n"]'),t=yield mk(e,"json");return{baseURL:e.replace(/[^/]*$/,"")||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}})}static#i(e){return Ax(this,null,function*(){yield this.#r(e)})}static#r(e){return re(this,null,function*(){return Pk(e,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties\u2026
pdfjs-document-properties-button-label = Document Properties\u2026
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing\u2026
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document\u2026
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing\u2026
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner \u2014 resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle \u2014 resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner \u2014 resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right \u2014 resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner \u2014 resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle \u2014 resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner \u2014 resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left \u2014 resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here\u2026
pdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close`)})}},cJ=1e3,lC=50,Rk=1e3;function dC(){return document.location.hash}var SC=class{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",n=>{this._isPagesLoaded=!!n.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:n=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();let r=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=n===!0,this._initialized=!0,this.#u();let s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=dC(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#r(s,!0)||t){let{hash:a,page:l,rotation:d}=this.#l(!0);if(!a||r||t){this.#t(null,!0);return}this.#t({hash:a,page:l,rotation:d},!0);return}let o=s.destination;this.#s(o,s.uid,!0),o.rotation!==void 0&&(this._initialRotation=o.rotation),o.dest?(this._initialBookmark=JSON.stringify(o.dest),this._destination.page=null):o.hash?this._initialBookmark=o.hash:o.page&&(this._initialBookmark=`page=${o.page}`)}reset(){this._initialized&&(this.#a(),this._initialized=!1,this.#o()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:n}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#i(n)&&(n!==null||this._destination)){console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}let r=e||JSON.stringify(t);if(!r)return;let s=!1;if(this._destination&&(uJ(this._destination.hash,r)||hJ(this._destination.dest,t))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#t({dest:t,hash:r,page:n,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#i(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#n()}back(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#r(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#r(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){let n=t||!this._destination,r={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:e};this.#s(e,r.uid);let s;if(this._updateUrl&&e?.hash){let o=document.location.href.split("#",1)[0];o.startsWith("file://")||(s=`${o}#${e.hash}`)}n?window.history.replaceState(r,"",s):window.history.pushState(r,"",s)}#n(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&(lC<=0||this._numPositionUpdates<=lC))return;let n=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;n=!0}this.#t(t,n)}#i(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#r(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;let[n]=performance.getEntriesByType("navigation");if(n?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#s(e,t,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#l(e=!1){let t=unescape(dC()).substring(1),n=ox(t),r=n.get("nameddest")||"",s=n.get("page")|0;return(!this.#i(s)||e&&r.length>0)&&(s=null),{hash:t,page:s,rotation:this.linkService.rotation}}#d({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(lC>0&&this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,Rk>0&&(this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#n(!0),this._updateViewareaTimeout=null},Rk)))}#c({state:e}){let t=dC(),n=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;let{hash:s,page:o,rotation:a}=this.#l();this.#t({hash:s,page:o,rotation:a},!0);return}if(!this.#r(e))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,SK({target:window,name:"hashchange",delay:cJ}).then(()=>{this._blockHashChange--}));let r=e.destination;this.#s(r,e.uid,!0),Bk(r.rotation)&&(this.linkService.rotation=r.rotation),r.dest?this.linkService.goToDestination(r.dest):r.hash?this.linkService.setHash(r.hash):r.page&&(this.linkService.page=r.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#a(){(!this._destination||this._destination.temporary)&&this.#n()}#u(){if(this.#e)return;this.#e=new AbortController;let{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#d.bind(this),{signal:e}),window.addEventListener("popstate",this.#c.bind(this),{signal:e}),window.addEventListener("pagehide",this.#a.bind(this),{signal:e})}#o(){this.#e?.abort(),this.#e=null}};function uJ(i,e){return typeof i!="string"||typeof e!="string"?!1:i===e||ox(i).get("nameddest")===e}function hJ(i,e){function t(n,r){if(typeof n!=typeof r||Array.isArray(n)||Array.isArray(r))return!1;if(n!==null&&typeof n=="object"&&r!==null){if(Object.keys(n).length!==Object.keys(r).length)return!1;for(let s in n)if(!t(n[s],r[s]))return!1;return!0}return n===r||Number.isNaN(n)&&Number.isNaN(r)}if(!(Array.isArray(i)&&Array.isArray(e))||i.length!==e.length)return!1;for(let n=0,r=i.length;n<r;n++)if(!t(i[n],e[n]))return!1;return!0}var EC=class{#e=null;#t=null;#n=null;#i=null;#r=null;#s;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,this.l10n||=new $c,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#s=e.uiManager,this.#e=e.annotationLayer||null,this.#r=e.textLayer||null,this.#t=e.drawLayer||null,this.#n=e.onAppend||null,this.#i=e.structTreeLayer||null}render(e,t="display"){return re(this,null,function*(){if(t!=="display"||this._cancelled)return;let n=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:n}),this.show();return}let r=this.div=document.createElement("div");r.className="annotationEditorLayer",r.hidden=!0,r.dir=this.#s.direction,this.#n?.(r),this.annotationEditorLayer=new fK({uiManager:this.#s,div:r,structTreeLayer:this.#i,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:this.#e,textLayer:this.#r,drawLayer:this.#t});let s={viewport:n,div:r,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()})}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}};{Yv=new Map;let i=navigator.userAgent||"",e=navigator.platform||"",t=navigator.maxTouchPoints||1,n=/Android/.test(i),r=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||e==="MacIntel"&&t>1;(function(){(r||n)&&Yv.set("maxCanvasPixels",5242880)})(),function(){n&&Yv.set("useSystemFonts",!1)}()}var Yv,ue={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},CC={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Js={allowedGlobalEvents:{value:null,kind:ue.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:ue.BROWSER+ue.API},isInAutomation:{value:!1,kind:ue.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:ue.BROWSER},nimbusDataStr:{value:"",kind:ue.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:ue.BROWSER},supportsDocumentFonts:{value:!0,kind:ue.BROWSER},supportsIntegratedFind:{value:!1,kind:ue.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:ue.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:ue.BROWSER},supportsPinchToZoom:{value:!0,kind:ue.BROWSER},toolbarDensity:{value:0,kind:ue.BROWSER+ue.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:ue.VIEWER+ue.PREFERENCE},annotationEditorMode:{value:0,kind:ue.VIEWER+ue.PREFERENCE},annotationMode:{value:2,kind:ue.VIEWER+ue.PREFERENCE},cursorToolOnLoad:{value:0,kind:ue.VIEWER+ue.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:ue.VIEWER},defaultZoomDelay:{value:400,kind:ue.VIEWER+ue.PREFERENCE},defaultZoomValue:{value:"",kind:ue.VIEWER+ue.PREFERENCE},disableHistory:{value:!1,kind:ue.VIEWER},disablePageLabels:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},enableAltText:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:ue.VIEWER+ue.PREFERENCE+ue.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:ue.VIEWER+ue.PREFERENCE+ue.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:ue.VIEWER+ue.PREFERENCE},enablePermissions:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:ue.VIEWER+ue.PREFERENCE},enableScripting:{value:!0,kind:ue.VIEWER+ue.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:ue.VIEWER},externalLinkTarget:{value:0,kind:ue.VIEWER+ue.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:ue.VIEWER+ue.PREFERENCE},historyUpdateUrl:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},imageResourcesPath:{value:"./images/",kind:ue.VIEWER},maxCanvasPixels:{value:2**25,kind:ue.VIEWER},forcePageColors:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:ue.VIEWER+ue.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:ue.VIEWER+ue.PREFERENCE},pdfBugEnabled:{value:!1,kind:ue.VIEWER+ue.PREFERENCE},printResolution:{value:150,kind:ue.VIEWER},sidebarViewOnLoad:{value:-1,kind:ue.VIEWER+ue.PREFERENCE},scrollModeOnLoad:{value:-1,kind:ue.VIEWER+ue.PREFERENCE},spreadModeOnLoad:{value:-1,kind:ue.VIEWER+ue.PREFERENCE},textLayerMode:{value:1,kind:ue.VIEWER+ue.PREFERENCE},viewOnLoad:{value:0,kind:ue.VIEWER+ue.PREFERENCE},cMapPacked:{value:!0,kind:ue.API},cMapUrl:{value:"../web/cmaps/",kind:ue.API},disableAutoFetch:{value:!1,kind:ue.API+ue.PREFERENCE},disableFontFace:{value:!1,kind:ue.API+ue.PREFERENCE},disableRange:{value:!1,kind:ue.API+ue.PREFERENCE},disableStream:{value:!1,kind:ue.API+ue.PREFERENCE},docBaseUrl:{value:"",kind:ue.API},enableHWA:{value:!0,kind:ue.API+ue.VIEWER+ue.PREFERENCE},enableXfa:{value:!0,kind:ue.API+ue.PREFERENCE},fontExtraProperties:{value:!1,kind:ue.API},isEvalSupported:{value:!0,kind:ue.API},isOffscreenCanvasSupported:{value:!0,kind:ue.API},maxImageSize:{value:-1,kind:ue.API},pdfBug:{value:!1,kind:ue.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:ue.API},useSystemFonts:{value:void 0,kind:ue.API,type:CC.BOOLEAN+CC.UNDEFINED},verbosity:{value:1,kind:ue.API},workerPort:{value:null,kind:ue.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:ue.WORKER}};Js.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:ue.VIEWER},Js.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:ue.VIEWER},Js.viewerCssTheme={value:0,kind:ue.VIEWER+ue.PREFERENCE},Js.enableFakeMLManager={value:!0,kind:ue.VIEWER};Js.disablePreferences={value:!1,kind:ue.VIEWER};var MC=class{static eventBus;static#e=new Map;static{for(let e in Js)this.#e.set(e,Js[e].value);for(let[e,t]of Yv)this.#e.set(e,t);this._hasInvokedSet=!1,this._checkDisablePreferences=()=>this.get("disablePreferences")?!0:(this._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)}static get(e){return this.#e.get(e)}static getAll(e=null,t=!1){let n=Object.create(null);for(let r in Js){let s=Js[r];e&&!(e&s.kind)||(n[r]=t?s.value:this.#e.get(r))}return n}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){this._hasInvokedSet||=!0;let n;for(let r in e){let s=Js[r],o=e[r];if(!s||!(typeof o==typeof s.value||CC[(typeof o).toUpperCase()]&s.type))continue;let{kind:a}=s;t&&!(a&ue.BROWSER||a&ue.PREFERENCE)||(this.eventBus&&a&ue.EVENT_DISPATCH&&(n||=new Map).set(r,o),this.#e.set(r,o))}if(n)for(let[r,s]of n)this.eventBus.dispatch(r.toLowerCase(),{source:this,value:s})}},TC=class{#e=null;constructor(e){this.pageIndex=e.pageIndex}render(e="display"){return re(this,null,function*(){e!=="display"||this.#e||this._cancelled||(this.#e=new vK({pageIndex:this.pageIndex}))})}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}},Lk={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},fJ=/^H(\d+)$/,tx=class{#e;#t=null;#n;#i=new Map;#r;#s=null;constructor(e,t){this.#e=e.getStructTree(),this.#r=t}render(){return re(this,null,function*(){if(this.#n)return this.#n;let{promise:e,resolve:t,reject:n}=Promise.withResolvers();this.#n=e;try{this.#t=this.#c(yield this.#e)}catch(r){n(r)}return this.#e=null,this.#t?.classList.add("structTree"),t(this.#t),e})}getAriaAttributes(e){return re(this,null,function*(){try{return yield this.render(),this.#i.get(e)}catch{}return null})}hide(){this.#t&&!this.#t.hidden&&(this.#t.hidden=!0)}show(){this.#t?.hidden&&(this.#t.hidden=!1)}#l(e,t){let{alt:n,id:r,lang:s}=e;if(n!==void 0){let o=!1,a=Ef(n);for(let l of e.children)if(l.type==="annotation"){let d=this.#i.get(l.id);d||(d=new Map,this.#i.set(l.id,d)),d.set("aria-label",a),o=!0}o||t.setAttribute("aria-label",a)}r!==void 0&&t.setAttribute("aria-owns",r),s!==void 0&&t.setAttribute("lang",Ef(s,!0))}#d(e,t){let{alt:n,bbox:r,children:s}=e,o=s?.[0];if(!this.#r||!n||!r||o?.type!=="content")return!1;let{id:a}=o;if(!a)return!1;t.setAttribute("aria-owns",a);let l=document.createElement("span");(this.#s||=new Map).set(a,l),l.setAttribute("role","img"),l.setAttribute("aria-label",Ef(n));let{pageHeight:d,pageX:c,pageY:u}=this.#r,h="calc(var(--scale-factor)*",{style:f}=l;return f.width=`${h}${r[2]-r[0]}px)`,f.height=`${h}${r[3]-r[1]}px)`,f.left=`${h}${r[0]-c}px)`,f.top=`${h}${d-r[3]+u}px)`,!0}addElementsToTextLayer(){if(this.#s){for(let[e,t]of this.#s)document.getElementById(e)?.append(t);this.#s.clear(),this.#s=null}}#c(e){if(!e)return null;let t=document.createElement("span");if("role"in e){let{role:n}=e,r=n.match(fJ);if(r?(t.setAttribute("role","heading"),t.setAttribute("aria-level",r[1])):Lk[n]&&t.setAttribute("role",Lk[n]),n==="Figure"&&this.#d(e,t))return t}if(this.#l(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#l(e.children[0],t);else for(let n of e.children)t.append(this.#c(n));return t}},IC=class i{#e=!1;#t=null;#n=new Map;#i=new Map;setTextMapping(e){this.#t=e}static#r(e,t){let n=e.getBoundingClientRect(),r=t.getBoundingClientRect();if(n.width===0&&n.height===0)return 1;if(r.width===0&&r.height===0)return-1;let s=n.y,o=n.y+n.height,a=n.y+n.height/2,l=r.y,d=r.y+r.height,c=r.y+r.height/2;if(a<=l&&c>=o)return-1;if(c<=s&&a>=d)return 1;let u=n.x+n.width/2,h=r.x+r.width/2;return u-h}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(i.#r),this.#n.size>0){let e=this.#t;for(let[t,n]of this.#n){if(!document.getElementById(t)){this.#n.delete(t);continue}this.#s(t,e[n])}}for(let[e,t]of this.#i)this.addPointerInTextLayer(e,t);this.#i.clear()}disable(){this.#e&&(this.#i.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#i.delete(e);return}let t=this.#t;if(!t||t.length===0)return;let{id:n}=e,r=this.#n.get(n);if(r===void 0)return;let s=t[r];this.#n.delete(n);let o=s.getAttribute("aria-owns");o?.includes(n)&&(o=o.split(" ").filter(a=>a!==n).join(" "),o?s.setAttribute("aria-owns",o):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#s(e,t){let n=t.getAttribute("aria-owns");n?.includes(e)||t.setAttribute("aria-owns",n?`${n} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){let{id:n}=e;if(!n)return null;if(!this.#e)return this.#i.set(e,t),null;t&&this.removePointerInTextLayer(e);let r=this.#t;if(!r||r.length===0)return null;let s=Cf(r,d=>i.#r(e,d)<0),o=Math.max(0,s-1),a=r[o];this.#s(n,a),this.#n.set(n,o);let l=a.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(e,t,n,r){let s=this.addPointerInTextLayer(n,r);if(!e.hasChildNodes())return e.append(t),s;let o=Array.from(e.childNodes).filter(d=>d!==t);if(o.length===0)return s;let a=n||t,l=Cf(o,d=>i.#r(a,d)<0);return l===0?o[0].before(t):o[l-1].after(t),s}},DC=class{#e=null;constructor({findController:e,eventBus:t,pageIndex:n}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=n,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];let{textContentItemsStr:n}=this,r=0,s=0,o=n.length-1,a=[];for(let l=0,d=e.length;l<d;l++){let c=e[l];for(;r!==o&&c>=s+n[r].length;)s+=n[r].length,r++;r===n.length&&console.error("Could not find a matching mapping");let u={begin:{divIdx:r,offset:c-s}};for(c+=t[l];r!==o&&c>s+n[r].length;)s+=n[r].length,r++;u.end={divIdx:r,offset:c-s},a.push(u)}return a}_renderMatches(e){if(e.length===0)return;let{findController:t,pageIdx:n}=this,{textContentItemsStr:r,textDivs:s}=this,o=n===t.selected.pageIdx,a=t.selected.matchIdx,l=t.state.highlightAll,d=null,c={divIdx:-1,offset:void 0};function u(g,y){let b=g.divIdx;return s[b].textContent="",h(b,0,g.offset,y)}function h(g,y,b,A){let M=s[g];if(M.nodeType===Node.TEXT_NODE){let L=document.createElement("span");M.before(L),L.append(M),s[g]=L,M=L}let T=r[g].substring(y,b),I=document.createTextNode(T);if(A){let L=document.createElement("span");return L.className=`${A} appended`,L.append(I),M.append(L),A.includes("selected")?L.offsetLeft:0}return M.append(I),0}let f=a,p=f+1;if(l)f=0,p=e.length;else if(!o)return;let x=-1,v=-1;for(let g=f;g<p;g++){let y=e[g],b=y.begin;if(b.divIdx===x&&b.offset===v)continue;x=b.divIdx,v=b.offset;let A=y.end,M=o&&g===a,T=M?" selected":"",I=0;if(!d||b.divIdx!==d.divIdx?(d!==null&&h(d.divIdx,d.offset,c.offset),u(b)):h(d.divIdx,d.offset,b.offset),b.divIdx===A.divIdx)I=h(b.divIdx,b.offset,A.offset,"highlight"+T);else{I=h(b.divIdx,b.offset,c.offset,"highlight begin"+T);for(let L=b.divIdx+1,E=A.divIdx;L<E;L++)s[L].className="highlight middle"+T;u(A,"highlight end"+T)}d=A,M&&t.scrollMatchIntoView({element:s[b.divIdx],selectedLeft:I,pageIndex:n,matchIndex:a})}d&&h(d.divIdx,d.offset,c.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;let{findController:t,matches:n,pageIdx:r}=this,{textContentItemsStr:s,textDivs:o}=this,a=-1;for(let c of n){let u=Math.max(a,c.begin.divIdx);for(let h=u,f=c.end.divIdx;h<=f;h++){let p=o[h];p.textContent=s[h],p.className=""}a=c.end.divIdx+1}if(!t?.highlightMatches||e)return;let l=t.pageMatches[r]||null,d=t.pageMatchesLength[r]||null;this.matches=this._convertMatches(l,d),this._renderMatches(this.matches)}},nx=class i{#e=!1;#t=null;#n=!1;#i=null;static#r=new Map;static#s=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:n=null,enablePermissions:r=!1,onAppend:s=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=n,this.#e=r===!0,this.#t=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}render(e,t=null){return re(this,null,function*(){if(this.#n&&this.#i){this.#i.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#i=new _K({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});let{textDivs:n,textContentItemsStr:r}=this.#i;this.highlighter?.setTextMapping(n,r),this.accessibilityManager?.setTextMapping(n),yield this.#i.render(),this.#n=!0;let s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#l(s),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()})}hide(){!this.div.hidden&&this.#n&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#n&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#i?.cancel(),this.#i=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),i.#d(this.div)}#l(e){let{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",n=>{if(!this.#e){let r=document.getSelection();n.clipboardData.setData("text/plain",Ef(bK(r.toString())))}n.preventDefault(),n.stopPropagation()}),i.#r.set(t,e),i.#c()}static#d(e){this.#r.delete(e),this.#r.size===0&&(this.#s?.abort(),this.#s=null)}static#c(){if(this.#s)return;this.#s=new AbortController;let{signal:e}=this.#s,t=(o,a)=>{a.append(o),o.style.width="",o.style.height="",a.classList.remove("selecting")},n=!1;document.addEventListener("pointerdown",()=>{n=!0},{signal:e}),document.addEventListener("pointerup",()=>{n=!1,this.#r.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{n=!1,this.#r.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{n||this.#r.forEach(t)},{signal:e});var r,s;document.addEventListener("selectionchange",()=>{let o=document.getSelection();if(o.rangeCount===0){this.#r.forEach(t);return}let a=new Set;for(let f=0;f<o.rangeCount;f++){let p=o.getRangeAt(f);for(let x of this.#r.keys())!a.has(x)&&p.intersectsNode(x)&&a.add(x)}for(let[f,p]of this.#r)a.has(f)?f.classList.add("selecting"):t(p,f);if(r??=getComputedStyle(this.#r.values().next().value).getPropertyValue("-moz-user-select")==="none",r)return;let l=o.getRangeAt(0),d=s&&(l.compareBoundaryPoints(Range.END_TO_END,s)===0||l.compareBoundaryPoints(Range.START_TO_END,s)===0),c=d?l.startContainer:l.endContainer;c.nodeType===Node.TEXT_NODE&&(c=c.parentNode);let u=c.parentElement?.closest(".textLayer"),h=this.#r.get(u);h&&(h.style.width=u.style.width,h.style.height=u.style.height,c.parentElement.insertBefore(h,d?c:c.nextSibling)),s=l.cloneRange()},{signal:e})}},ix=class{constructor({pdfPage:e,annotationStorage:t=null,linkService:n,xfaHtml:r=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=n,this.xfaHtml=r,this.div=null,this._cancelled=!1}render(e,t="display"){return re(this,null,function*(){if(t==="print"){let s={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),s.div=this.div,sC.render(s)}let n=yield this.pdfPage.getXfa();if(this._cancelled||!n)return{textDivs:[]};let r={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:n,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?sC.update(r):(this.div=document.createElement("div"),r.div=this.div,sC.render(r))})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}},pJ={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new Mf}},mJ=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]),rx=class{#e=Jo.ENABLE_FORMS;#t=!1;#n=!1;#i=!1;#r=null;#s=null;#l=null;#d=1;#c=1;#a=null;#u=Fn.INITIAL;#o=Ks.ENABLE;#h={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#p=new WeakMap;#f=[null,null,null,null];constructor(e){let t=e.container,n=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#r=e.layerProperties||pJ,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||Fk,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#o=e.textLayerMode??Ks.ENABLE,this.#e=e.annotationMode??Jo.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.maxCanvasPixels=e.maxCanvasPixels??MC.get("maxCanvasPixels"),this.pageColors=e.pageColors||null,this.#t=e.enableHWA||!1,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n,this.l10n||=new $c,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;let r=document.createElement("div");if(r.className="page",r.setAttribute("data-page-number",this.id),r.setAttribute("role","region"),r.setAttribute("data-l10n-id","pdfjs-page-landmark"),r.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=r,this.#v(),t?.append(r),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*Ko.PDF_TO_CSS_UNITS),this.pageColors?.background&&t?.style.setProperty("--page-bg-color",this.pageColors.background);let{optionalContentConfigPromise:s}=e;s&&s.then(o=>{s===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=o.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#m(e,t){let n=mJ.get(t),r=this.#f[n];if(this.#f[n]=e,r){r.replaceWith(e);return}for(let s=n-1;s>=0;s--){let o=this.#f[s];if(o){o.after(e);return}}this.div.prepend(e)}get renderingState(){return this.#u}set renderingState(e){if(e!==this.#u)switch(this.#u=e,this.#s&&(clearTimeout(this.#s),this.#s=null),e){case Fn.PAUSED:this.div.classList.remove("loading");break;case Fn.RUNNING:this.div.classList.add("loadingIcon"),this.#s=setTimeout(()=>{this.div.classList.add("loading"),this.#s=null},0);break;case Fn.INITIAL:case Fn.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#v(){let{viewport:e}=this;if(this.pdfPage){if(this.#l===e.rotation)return;this.#l=e.rotation}AK(this.div,e,!0,!1)}setPdfPage(e){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;let t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*Ko.PDF_TO_CSS_UNITS,rotation:t}),this.#v(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return Qv(this,"_textHighlighter",new DC({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#r.findController}))}#g(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}#x(){return re(this,null,function*(){let e=null;try{yield this.annotationLayer.render(this.viewport,{structTreeLayer:this.structTreeLayer},"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.#g("annotationlayerrendered",e)}})}#b(){return re(this,null,function*(){let e=null;try{yield this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.#g("annotationeditorlayerrendered",e)}})}#_(){return re(this,null,function*(){try{yield this.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}})}#y(){return re(this,null,function*(){let e=null;try{let t=yield this.xfaLayer.render(this.viewport,"display");t?.textDivs&&this._textHighlighter&&this.#M(t.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#m(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#g("xfalayerrendered",e)}})}#A(){return re(this,null,function*(){if(!this.textLayer)return;let e=null;try{yield this.textLayer.render(this.viewport)}catch(t){if(t instanceof hK)return;console.error(`#renderTextLayer: "${t}".`),e=t}this.#g("textlayerrendered",e),this.#D()})}#D(){return re(this,null,function*(){if(!this.textLayer)return;let e=yield this.structTreeLayer?.render();e&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&e.parentNode!==this.canvas&&this.canvas.append(e),this.l10n.resume()),this.structTreeLayer?.show()})}#M(e){return re(this,null,function*(){let t=yield this.pdfPage.getTextContent(),n=[];for(let r of t.items)n.push(r.str);this._textHighlighter.setTextMapping(e,n),this._textHighlighter.enable()})}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;let t=this.zoomLayer.firstChild;this.#p.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:r=!1,keepTextLayer:s=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:n,keepXfaLayer:r,keepTextLayer:s}),this.renderingState=Fn.INITIAL;let o=this.div,a=o.childNodes,l=e&&this.zoomLayer||null,d=t&&this.annotationLayer?.div||null,c=n&&this.annotationEditorLayer?.div||null,u=r&&this.xfaLayer?.div||null,h=s&&this.textLayer?.div||null;for(let f=a.length-1;f>=0;f--){let p=a[f];switch(p){case l:case d:case c:case u:case h:continue}p.remove();let x=this.#f.indexOf(p);x>=0&&(this.#f[x]=null)}o.removeAttribute("data-loaded"),d&&this.annotationLayer.hide(),c&&this.annotationEditorLayer.hide(),u&&this.xfaLayer.hide(),h&&this.textLayer.hide(),this.structTreeLayer?.hide(),l||(this.canvas&&(this.#p.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(e){this.hasEditableAnnotations()&&(this.#i=e,this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:n=null,drawingDelay:r=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),n instanceof Promise&&(this._optionalContentConfigPromise=n,n.then(o=>{n===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=o.hasInitialVisibility)})),this.#h.directDrawing=!0;let s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*Ko.PDF_TO_CSS_UNITS,rotation:s}),this.#v(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let o=!1;if(this.#n){if(this.maxCanvasPixels===0)o=!0;else if(this.maxCanvasPixels>0){let{width:l,height:d}=this.viewport,{sx:c,sy:u}=this.outputScale;o=(Math.floor(l)*c|0)*(Math.floor(d)*u|0)>this.maxCanvasPixels}}let a=r>=0&&r<1e3;if(a||o){if(a&&!o&&this.renderingState!==Fn.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:r}),this.renderingState=Fn.FINISHED,this.#h.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!a,hideTextLayer:a}),a)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#a});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:n=!1,keepTextLayer:r=!1,cancelExtraDelay:s=0}={}){this.renderTask&&(this.renderTask.cancel(s),this.renderTask=null),this.resume=null,this.textLayer&&(!r||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!n||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:n=!1,redrawXfaLayer:r=!1,redrawTextLayer:s=!1,hideTextLayer:o=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);let{style:l}=e;l.width=l.height=""}let a=this.#p.get(e);if(this.viewport!==a){let l=this.viewport.rotation-a.rotation,d=Math.abs(l),c=1,u=1;if(d===90||d===270){let{width:h,height:f}=this.viewport;c=f/h,u=h/f}e.style.transform=`rotate(${l}deg) scale(${c}, ${u})`}t&&this.annotationLayer&&this.#x(),n&&this.annotationEditorLayer&&(this.drawLayer&&this.#_(),this.#b()),r&&this.xfaLayer&&this.#y(),this.textLayer&&(o?(this.textLayer.hide(),this.structTreeLayer?.hide()):s&&this.#A())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}#S(e,t=null){return re(this,null,function*(){if(e===this.renderTask&&(this.renderTask=null),t instanceof hC){this.#a=null;return}if(this.#a=t,this.renderingState=Fn.FINISHED,this._resetZoomLayer(!0),this.#h.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#a}),t)throw t})}draw(){return re(this,null,function*(){this.renderingState!==Fn.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());let{div:e,l10n:t,pageColors:n,pdfPage:r,viewport:s}=this;if(!r)throw this.renderingState=Fn.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Fn.RUNNING;let o=document.createElement("div");if(o.classList.add("canvasWrapper"),this.#m(o,"canvasWrapper"),!this.textLayer&&this.#o!==Ks.DISABLE&&!r.isPureXfa&&(this._accessibilityManager||=new IC,this.textLayer=new nx({pdfPage:r,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#o===Ks.ENABLE_PERMISSIONS,onAppend:E=>{this.l10n.pause(),this.#m(E,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==Jo.DISABLE){let{annotationStorage:E,annotationEditorUIManager:S,downloadManager:P,enableScripting:j,fieldObjectsPromise:B,hasJSActionsPromise:z,linkService:X}=this.#r;this._annotationCanvasMap||=new Map,this.annotationLayer=new Kv({pdfPage:r,annotationStorage:E,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===Jo.ENABLE_FORMS,linkService:X,downloadManager:P,enableScripting:j,hasJSActionsPromise:z,fieldObjectsPromise:B,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:S,onAppend:Q=>{this.#m(Q,"annotationLayer")}})}let a=E=>{if(h?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=Fn.PAUSED,this.resume=()=>{this.renderingState=Fn.RUNNING,E()};return}E()},{width:l,height:d}=s,c=document.createElement("canvas");c.setAttribute("role","presentation"),c.hidden=!0;let u=!!(n?.background&&n?.foreground),h=E=>{(!u||E)&&(c.hidden=!1,h=null)};o.append(c),this.canvas=c;let f=c.getContext("2d",{alpha:!1,willReadFrequently:!this.#t}),p=this.outputScale=new yK;if(this.maxCanvasPixels===0){let E=1/this.scale;p.sx*=E,p.sy*=E,this.#n=!0}else if(this.maxCanvasPixels>0){let E=l*d,S=Math.sqrt(this.maxCanvasPixels/E);p.sx>S||p.sy>S?(p.sx=S,p.sy=S,this.#n=!0):this.#n=!1}let x=ak(p.sx),v=ak(p.sy),g=c.width=zv(jv(l*p.sx),x[0]),y=c.height=zv(jv(d*p.sy),v[0]),b=zv(jv(l),x[1]),A=zv(jv(d),v[1]);p.sx=g/b,p.sy=y/A,this.#d!==x[1]&&(e.style.setProperty("--scale-round-x",`${x[1]}px`),this.#d=x[1]),this.#c!==v[1]&&(e.style.setProperty("--scale-round-y",`${v[1]}px`),this.#c=v[1]),this.#p.set(c,s);let M=p.scaled?[p.sx,0,0,p.sy,0,0]:null,T={canvasContext:f,transform:M,viewport:s,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:n,isEditing:this.#i},I=this.renderTask=r.render(T);I.onContinue=a;let L=I.promise.then(()=>re(this,null,function*(){h?.(!0),yield this.#S(I),this.structTreeLayer||=new tx(r,s.rawDims),this.#A(),this.annotationLayer&&(yield this.#x());let{annotationEditorUIManager:E}=this.#r;E&&(this.drawLayer||=new TC({pageIndex:this.id}),yield this.#_(),this.drawLayer.setParent(o),this.annotationEditorLayer||=new EC({uiManager:E,pdfPage:r,l10n:t,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:S=>{this.#m(S,"annotationEditorLayer")}}),this.#b())}),E=>(E instanceof hC||h?.(!0),this.#S(I,E)));if(r.isPureXfa){if(!this.xfaLayer){let{annotationStorage:E,linkService:S}=this.#r;this.xfaLayer=new ix({pdfPage:r,annotationStorage:E,linkService:S})}this.#y()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),L})}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){let{directDrawing:e,initialOptionalContent:t,regularAnnotations:n}=this.#h;return e&&t&&n?this.canvas:null}};function gJ(i){return re(this,null,function*(){let e="",t=e.split("#",1)[0],{info:n,metadata:r,contentDispositionFilename:s,contentLength:o}=yield i.getMetadata();if(!o){let{length:a}=yield i.getDownloadInfo();o=a}return We(ae({},n),{baseURL:t,filesize:o,filename:s||xK(e),metadata:r?.getRaw(),authors:r?.get("dc:creator"),numPages:i.numPages,URL:e})})}var PC=class{constructor(e){this._ready=new Promise((t,n)=>{import(e).then(s=>{t(s.QuickJSSandbox())}).catch(n)})}createSandbox(e){return re(this,null,function*(){(yield this._ready).create(e)})}dispatchEventInSandbox(e){return re(this,null,function*(){let t=yield this._ready;setTimeout(()=>t.dispatchEvent(e),0)})}destroySandbox(){return re(this,null,function*(){(yield this._ready).nukeSandbox()})}},RC=class{#e=null;#t=null;#n=null;#i=null;#r=null;#s=null;#l=null;#d=null;#c=!1;#a=null;#u=null;constructor({eventBus:e,externalServices:t=null,docProperties:n=null}){this.#r=e,this.#s=t,this.#n=n}setViewer(e){this.#d=e}setDocument(e){return re(this,null,function*(){if(this.#l&&(yield this.#m()),this.#l=e,!e)return;let[t,n,r]=yield Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!r){yield this.#m();return}if(e!==this.#l)return;try{this.#a=this.#f()}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#m();return}let s=this.#r;this.#i=new AbortController;let{signal:o}=this.#i;s._on("updatefromsandbox",a=>{a?.source===window&&this.#o(a.detail)},{signal:o}),s._on("dispatcheventinsandbox",a=>{this.#a?.dispatchEventInSandbox(a.detail)},{signal:o}),s._on("pagechanging",({pageNumber:a,previous:l})=>{a!==l&&(this.#p(l),this.#h(a))},{signal:o}),s._on("pagerendered",({pageNumber:a})=>{this._pageOpenPending.has(a)&&a===this.#d.currentPageNumber&&this.#h(a)},{signal:o}),s._on("pagesdestroy",()=>re(this,null,function*(){yield this.#p(this.#d.currentPageNumber),yield this.#a?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()}),{signal:o});try{let a=yield this.#n(e);if(e!==this.#l)return;yield this.#a.createSandbox({objects:t,calculationOrder:n,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:We(ae({},a),{actions:r})}),s.dispatch("sandboxcreated",{source:this})}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#m();return}yield this.#a?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield this.#h(this.#d.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#l&&(this.#c=!0)})})}dispatchWillSave(){return re(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})}dispatchDidSave(){return re(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})}dispatchWillPrint(){return re(this,null,function*(){if(this.#a){yield this.#u?.promise,this.#u=Promise.withResolvers();try{yield this.#a.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#u.resolve(),this.#u=null,e}yield this.#u.promise}})}dispatchDidPrint(){return re(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#c}get _pageOpenPending(){return Qv(this,"_pageOpenPending",new Set)}get _visitedPages(){return Qv(this,"_visitedPages",new Map)}#o(e){return re(this,null,function*(){let t=this.#d,n=t.isInPresentationMode||t.isChangingPresentationMode,{id:r,siblings:s,command:o,value:a}=e;if(!r){switch(o){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(!n){let d=jQ(a);t.spreadMode=d.spreadMode}break;case"page-num":t.currentPageNumber=a+1;break;case"print":yield t.pagesPromise,this.#r.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":n||(t.currentScaleValue=a);break;case"SaveAs":this.#r.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":n||t.increaseScale();break;case"ZoomViewOut":n||t.decreaseScale();break;case"WillPrintFinished":this.#u?.resolve(),this.#u=null;break}return}if(n&&e.focus)return;delete e.id,delete e.siblings;let l=s?[r,...s]:[r];for(let d of l){let c=document.querySelector(`[data-element-id="${d}"]`);c?c.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#l?.annotationStorage.setValue(d,e)}})}#h(e,t=!1){return re(this,null,function*(){let n=this.#l,r=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;let s=this.#d.getPageView(e-1);if(s?.renderingState!==Fn.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);let o=re(this,null,function*(){let a=yield r.has(e)?null:s.pdfPage?.getJSActions();n===this.#l&&(yield this.#a?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:a}))});r.set(e,o)})}#p(e){return re(this,null,function*(){let t=this.#l,n=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;let r=n.get(e);r&&(n.set(e,null),yield r,t===this.#l&&(yield this.#a?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})))})}#f(){if(this.#t=Promise.withResolvers(),this.#a)throw new Error("#initScripting: Scripting already exists.");return this.#s.createScripting()}#m(){return re(this,null,function*(){if(!this.#a){this.#l=null,this.#t?.resolve();return}this.#e&&(yield Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#l=null;try{yield this.#a.destroySandbox()}catch{}this.#u?.reject(new Error("Scripting destroyed.")),this.#u=null,this.#i?.abort(),this.#i=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#a=null,this.#c=!1,this.#t?.resolve()})}},LC=class extends RC{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}),e.externalServices||={createScripting:()=>new PC(e.sandboxBundleSrc)},e.docProperties||=t=>gJ(t),super(e)}},vJ=3e4,kC=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),vJ)))}getHighestPriority(e,t,n,r=!1){let s=e.views,o=s.length;if(o===0)return null;for(let u=0;u<o;u++){let h=s[u].view;if(!this.isViewFinished(h))return h}let a=e.first.id,l=e.last.id;if(l-a+1>o){let u=e.ids;for(let h=1,f=l-a;h<f;h++){let p=n?a+h:l-h;if(u.has(p))continue;let x=t[p-1];if(!this.isViewFinished(x))return x}}let d=n?l:a-2,c=t[d];return c&&!this.isViewFinished(c)||r&&(d+=n?1:-1,c=t[d],c&&!this.isViewFinished(c))?c:null}isViewFinished(e){return e.renderingState===Fn.FINISHED}renderView(e){switch(e.renderingState){case Fn.FINISHED:return!1;case Fn.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case Fn.RUNNING:this.highestPriorityPage=e.renderingId;break;case Fn.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof hC||console.error(`renderView: "${t}"`)});break}return!0}},kk=10,Zv={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function Nk(i){return Object.values(_r).includes(i)&&i!==_r.DISABLE}var NC=class{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){let t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#n()}resize(e,t=null){this.#t=e;let n=this.#e;if(t){let r=n.size,s=1;for(let o of n)if(t.has(o.id)&&(n.delete(o),n.add(o)),++s>r)break}for(;n.size>this.#t;)this.#n()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#n(){let e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}},sx=class{#e=null;#t=null;#n=null;#i=_r.NONE;#r=null;#s=Jo.ENABLE_FORMS;#l=null;#d=!1;#c=!1;#a=!1;#u=!1;#o=!1;#h=null;#p=null;#f=null;#m=null;#v=!1;#g=null;#x=!1;#b=0;#_=new ResizeObserver(this.#B.bind(this));#y=null;#A=null;#D=Ks.ENABLE;constructor(e){let t="4.8.69";if(gk!==t)throw new Error(`The API version "${gk}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#_.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new Mf,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=r=>this._getVisiblePages().ids.has(r)),this._scriptingManager=e.scriptingManager||null,this.#D=e.textLayerMode??Ks.ENABLE,this.#s=e.annotationMode??Jo.ENABLE_FORMS,this.#i=e.annotationEditorMode??_r.NONE,this.#n=e.annotationEditorHighlightColors||null,this.#c=e.enableHighlightFloatingButton===!0,this.#u=e.enableUpdatedAddImage===!0,this.#o=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n,this.l10n||=new $c,this.#a=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#p=e.mlManager||null,this.#d=e.enableHWA||!1,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new kC,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;let{abortSignal:n}=e;n?.addEventListener("abort",()=>{this.#_.disconnect(),this.#_=null},{once:!0}),this.scroll=FQ(this.container,this._scrollUpdate.bind(this),n),this.presentationModeState=Qc.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#F(),this.eventBus._on("thumbnailrendered",({pageNumber:r,pdfPage:s})=>{let o=this._pages[r-1];this.#e.has(o)||s?.cleanup()}),e.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#s===Jo.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#R(),!0;if(!(0<e&&e<=this.pagesCount))return!1;let n=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:n}),t&&this.#R(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){let n=this._pageLabels.indexOf(e);n>=0&&(t=n+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==tC?this._currentScale:Fk}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#I(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#I(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!Bk(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;let t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#I(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){let e=this;return Qv(this,"_layerProperties",{get annotationEditorUIManager(){return e.#r},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#M(e){let t={annotationEditorMode:this.#i,annotationMode:this.#s,textLayerMode:this.#D};return e&&(!e.includes(Wv.COPY)&&this.#D===Ks.ENABLE&&(t.textLayerMode=Ks.ENABLE_PERMISSIONS),e.includes(Wv.MODIFY_CONTENTS)||(t.annotationEditorMode=_r.DISABLE),!e.includes(Wv.MODIFY_ANNOTATIONS)&&!e.includes(Wv.FILL_INTERACTIVE_FORMS)&&this.#s===Jo.ENABLE_FORMS&&(t.annotationMode=Jo.ENABLE)),t}#S(e){return re(this,null,function*(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;let t=Promise.withResolvers(),n=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&t.resolve()},{signal:typeof AbortSignal.any=="function"?AbortSignal.any([e,n.signal]):e}),yield Promise.race([this._onePageRenderedCapability.promise,t.promise]),n.abort()})}getAllText(){return re(this,null,function*(){let e=[],t=[];for(let n=1,r=this.pdfDocument.numPages;n<=r;++n){if(this.#x)return null;t.length=0;let s=yield this.pdfDocument.getPage(n),{items:o}=yield s.getTextContent();for(let a of o)a.str&&t.push(a.str),a.hasEOL&&t.push(`
`);e.push(Ef(t.join("")))}return e.join(`
`)})}#T(e,t){let n=document.getSelection(),{focusNode:r,anchorNode:s}=n;if(s&&r&&n.containsNode(this.#g)){if(this.#v||e===Ks.ENABLE_PERMISSIONS){t.preventDefault(),t.stopPropagation();return}this.#v=!0;let{classList:o}=this.viewer;o.add("copyAll");let a=new AbortController;window.addEventListener("keydown",l=>this.#x=l.key==="Escape",{signal:a.signal}),this.getAllText().then(l=>re(this,null,function*(){l!==null&&(yield navigator.clipboard.writeText(l))})).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#v=!1,this.#x=!1,a.abort(),o.remove("copyAll")}),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#r?.destroy(),this.#r=null),this.pdfDocument=e,!e)return;let t=e.numPages,n=e.getPage(1),r=e.getOptionalContentConfig({intent:"display"}),s=this.#a?e.getPermissions():Promise.resolve(),{eventBus:o,pageColors:a,viewer:l}=this;this.#h=new AbortController;let{signal:d}=this.#h;if(t>Zv.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");let h=this._scrollMode=Yt.PAGE;o.dispatch("scrollmodechanged",{source:this,mode:h})}this._pagesCapability.promise.then(()=>{o.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});let c=h=>{let f=this._pages[h.pageNumber-1];f&&this.#e.push(f)};o._on("pagerender",c,{signal:d});let u=h=>{h.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:h.timestamp}),o._off("pagerendered",u))};o._on("pagerendered",u,{signal:d}),Promise.all([n,s]).then(([h,f])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(h),this._optionalContentConfigPromise=r;let{annotationEditorMode:p,annotationMode:x,textLayerMode:v}=this.#M(f);if(v!==Ks.DISABLE){let A=this.#g=document.createElement("div");A.id="hiddenCopyElement",l.before(A)}if(typeof AbortSignal.any=="function"&&p!==_r.DISABLE){let A=p;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):Nk(A)?(this.#r=new pK(this.container,l,this.#t,o,e,a,this.#n,this.#c,this.#u,this.#o,this.#p),o.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#r}),A!==_r.NONE&&(A===_r.STAMP&&this.#p?.loadModel("altText"),this.#r.updateMode(A))):console.error(`Invalid AnnotationEditor mode: ${A}`)}let g=this._scrollMode===Yt.PAGE?null:l,y=this.currentScale,b=h.getViewport({scale:y*Ko.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",b.scale),a?.background&&l.style.setProperty("--page-bg-color",a.background),(a?.foreground==="CanvasText"||a?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let A=1;A<=t;++A){let M=new rx({container:g,eventBus:o,id:A,scale:y,defaultViewport:b.clone(),optionalContentConfigPromise:r,renderingQueue:this.renderingQueue,textLayerMode:v,annotationMode:x,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:a,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#d});this._pages.push(M)}this._pages[0]?.setPdfPage(h),this._scrollMode===Yt.PAGE?this.#C():this._spreadMode!==Ni.NONE&&this._updateSpreadMode(),this.#S(d).then(()=>re(this,null,function*(){if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#g&&document.addEventListener("copy",this.#T.bind(this,v),{signal:d}),this.#r&&o.dispatch("annotationeditormodechanged",{source:this,mode:this.#i}),e.loadingParams.disableAutoFetch||t>Zv.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let A=t-1;if(A<=0){this._pagesCapability.resolve();return}for(let M=2;M<=t;++M){let T=e.getPage(M).then(I=>{let L=this._pages[M-1];L.pdfPage||L.setPdfPage(I),--A===0&&this._pagesCapability.resolve()},I=>{console.error(`Unable to get page ${M} to initialize viewer`,I),--A===0&&this._pagesCapability.resolve()});M%Zv.PAUSE_EAGER_PAGE_INIT===0&&(yield T)}})),o.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:A})=>{e===this.pdfDocument&&A.Language&&(l.lang=A.Language)}),this.defaultRenderingQueue&&this.update()}).catch(h=>{console.error("Unable to initialize viewer",h),this._pagesCapability.reject(h)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,n=this._pages.length;t<n;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=tC,this._currentScaleValue=null,this._pageLabels=null,this.#e=new NC(kk),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Yt.VERTICAL,this._previousScrollMode=Yt.UNKNOWN,this._spreadMode=Ni.NONE,this.#y={previousPageNumber:1,scrollDown:!0,pages:[]},this.#h?.abort(),this.#h=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#g?.remove(),this.#g=null,this.#V()}#C(){if(this._scrollMode!==Yt.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");let e=this._currentPageNumber,t=this.#y,n=this.viewer;if(n.textContent="",t.pages.length=0,this._spreadMode===Ni.NONE&&!this.isInPresentationMode){let r=this._pages[e-1];n.append(r.div),t.pages.push(r)}else{let r=new Set,s=this._spreadMode-1;s===-1?r.add(e-1):e%2!==s?(r.add(e-1),r.add(e)):(r.add(e-2),r.add(e-1));let o=document.createElement("div");if(o.className="spread",this.isInPresentationMode){let a=document.createElement("div");a.className="dummyPage",o.append(a)}for(let a of r){let l=this._pages[a];l&&(o.append(l.div),t.pages.push(l))}n.append(o)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#P(e,t=null){let{div:n,id:r}=e;if(this._currentPageNumber!==r&&this._setCurrentPageNumber(r),this._scrollMode===Yt.PAGE&&(this.#C(),this.update()),!t&&!this.isInPresentationMode){let s=n.offsetLeft+n.clientLeft,o=s+n.clientWidth,{scrollLeft:a,clientWidth:l}=this.container;(this._scrollMode===Yt.HORIZONTAL||s<a||o>a+l)&&(t={left:0,top:0})}Ok(n,t),!this._currentScaleValue&&this._location&&(this._location=null)}#L(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#E(e,t,{noScroll:n=!1,preset:r=!1,drawingDelay:s=-1,origin:o=null}){if(this._currentScaleValue=t.toString(),this.#L(e)){r&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*Ko.PDF_TO_CSS_UNITS);let a=s>=0&&s<1e3;this.refresh(!0,{scale:e,drawingDelay:a?s:-1}),a&&(this.#A=setTimeout(()=>{this.#A=null,this.refresh()},s));let l=this._currentScale;if(this._currentScale=e,!n){let d=this._currentPageNumber,c;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(d=this._location.pageNumber,c=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:d,destArray:c,allowNegativeOffset:!0}),Array.isArray(o)){let u=e/l-1,[h,f]=this.containerTopLeft;this.container.scrollLeft+=(o[0]-f)*u,this.container.scrollTop+=(o[1]-h)*u}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:r?t:void 0}),this.defaultRenderingQueue&&this.update()}get#w(){return this._spreadMode!==Ni.NONE&&this._scrollMode!==Yt.HORIZONTAL?2:1}#I(e,t){let n=parseFloat(e);if(n>0)t.preset=!1,this.#E(n,e,t);else{let r=this._pages[this._currentPageNumber-1];if(!r)return;let s=rk,o=sk;this.isInPresentationMode?(s=o=4,this._spreadMode!==Ni.NONE&&(s*=2)):this.removePageBorders?s=o=0:this._scrollMode===Yt.HORIZONTAL&&([s,o]=[o,s]);let a=(this.container.clientWidth-s)/r.width*r.scale/this.#w,l=(this.container.clientHeight-o)/r.height*r.scale;switch(e){case"page-actual":n=1;break;case"page-width":n=a;break;case"page-height":n=l;break;case"page-fit":n=Math.min(a,l);break;case"auto":let d=lk(r)?a:Math.min(l,a);n=Math.min(NQ,d);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#E(n,e,t)}}#R(){let e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#I(this._currentScaleValue,{noScroll:!0}),this.#P(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;let t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:n=!1,ignoreDestinationZoom:r=!1}){if(!this.pdfDocument)return;let s=Number.isInteger(e)&&this._pages[e-1];if(!s){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let o=0,a=0,l=0,d=0,c,u,h=s.rotation%180!==0,f=(h?s.height:s.width)/s.scale/Ko.PDF_TO_CSS_UNITS,p=(h?s.width:s.height)/s.scale/Ko.PDF_TO_CSS_UNITS,x=0;switch(t[1].name){case"XYZ":o=t[2],a=t[3],x=t[4],o=o!==null?o:0,a=a!==null?a:p;break;case"Fit":case"FitB":x="page-fit";break;case"FitH":case"FitBH":a=t[2],x="page-width",a===null&&this._location?(o=this._location.left,a=this._location.top):(typeof a!="number"||a<0)&&(a=p);break;case"FitV":case"FitBV":o=t[2],l=f,d=p,x="page-height";break;case"FitR":o=t[2],a=t[3],l=t[4]-o,d=t[5]-a;let b=rk,A=sk;this.removePageBorders&&(b=A=0),c=(this.container.clientWidth-b)/l/Ko.PDF_TO_CSS_UNITS,u=(this.container.clientHeight-A)/d/Ko.PDF_TO_CSS_UNITS,x=Math.min(Math.abs(c),Math.abs(u));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(r||(x&&x!==this._currentScale?this.currentScaleValue=x:this._currentScale===tC&&(this.currentScaleValue=RQ)),x==="page-fit"&&!t[4]){this.#P(s);return}let v=[s.viewport.convertToViewportPoint(o,a),s.viewport.convertToViewportPoint(o+l,a+d)],g=Math.min(v[0][0],v[1][0]),y=Math.min(v[0][1],v[1][1]);n||(g=Math.max(g,0),y=Math.max(y,0)),this.#P(s,{left:g,top:y})}_updateLocation(e){let t=this._currentScale,n=this._currentScaleValue,r=parseFloat(n)===t?Math.round(t*1e4)/100:n,s=e.id,o=this._pages[s-1],a=this.container,l=o.getPagePoint(a.scrollLeft-e.x,a.scrollTop-e.y),d=Math.round(l[0]),c=Math.round(l[1]),u=`#page=${s}`;this.isInPresentationMode||(u+=`&zoom=${r},${d},${c}`),this._location={pageNumber:s,scale:r,top:c,left:d,rotation:this._pagesRotation,pdfOpenParams:u}}update(){let e=this._getVisiblePages(),t=e.views,n=t.length;if(n===0)return;let r=Math.max(kk,2*n+1);this.#e.resize(r,e.ids),this.renderingQueue.renderHighestPriority(e);let s=this._spreadMode===Ni.NONE&&(this._scrollMode===Yt.PAGE||this._scrollMode===Yt.VERTICAL),o=this._currentPageNumber,a=!1;for(let l of t){if(l.percent<100)break;if(l.id===o&&s){a=!0;break}}this._setCurrentPageNumber(a?o:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#O(){let e=this._getVisiblePages(),t=[],{ids:n,views:r}=e;for(let s of r){let{view:o}=s;if(!o.hasEditableAnnotations()){n.delete(o.id);continue}t.push(s)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:n}),n)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===Qc.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===Qc.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){let e=this._scrollMode===Yt.PAGE?this.#y.pages:this._pages,t=this._scrollMode===Yt.HORIZONTAL,n=t&&this._isContainerRtl;return BQ({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:n})}cleanup(){for(let e of this._pages)e.renderingState!==Fn.FINISHED&&e.reset()}_cancelRendering(){for(let e of this._pages)e.cancelRendering()}#H(e){return re(this,null,function*(){if(e.pdfPage)return e.pdfPage;try{let t=yield this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}})}#U(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Yt.PAGE:return this.#y.scrollDown;case Yt.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){let t=e||this._getVisiblePages(),n=this.#U(t),r=this._spreadMode!==Ni.NONE&&this._scrollMode!==Yt.HORIZONTAL,s=this.renderingQueue.getHighestPriority(t,this._pages,n,r);return s?(this.#H(s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}get hasEqualPageSizes(){let e=this._pages[0];for(let t=1,n=this._pages.length;t<n;++t){let r=this._pages[t];if(r.width!==e.width||r.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{let n=t.pdfPage.getViewport({scale:1}),r=lk(n);if(e===void 0)e=r;else if(this.enablePrintAutoRotate&&r!==e)return{width:n.height,height:n.width,rotation:(n.rotation-90)%360};return{width:n.width,height:n.height,rotation:n.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!VQ(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>Zv.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){let t=this._scrollMode,n=this.viewer;n.classList.toggle("scrollHorizontal",t===Yt.HORIZONTAL),n.classList.toggle("scrollWrapped",t===Yt.WRAPPED),!(!this.pdfDocument||!e)&&(t===Yt.PAGE?this.#C():this._previousScrollMode===Yt.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!UQ(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;let t=this.viewer,n=this._pages;if(this._scrollMode===Yt.PAGE)this.#C();else if(t.textContent="",this._spreadMode===Ni.NONE)for(let r of this._pages)t.append(r.div);else{let r=this._spreadMode-1,s=null;for(let o=0,a=n.length;o<a;++o)s===null?(s=document.createElement("div"),s.className="spread",t.append(s)):o%2===r&&(s=s.cloneNode(!1),t.append(s)),s.append(n[o].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case Yt.WRAPPED:{let{views:n}=this._getVisiblePages(),r=new Map;for(let{id:s,y:o,percent:a,widthPercent:l}of n){if(a===0||l<100)continue;let d=r.get(o);d||r.set(o,d||=[]),d.push(s)}for(let s of r.values()){let o=s.indexOf(e);if(o===-1)continue;let a=s.length;if(a===1)break;if(t)for(let l=o-1,d=0;l>=d;l--){let c=s[l],u=s[l+1]-1;if(c<u)return e-u}else for(let l=o+1,d=a;l<d;l++){let c=s[l],u=s[l-1]+1;if(c>u)return u-e}if(t){let l=s[0];if(l<e)return e-l+1}else{let l=s[a-1];if(l>e)return l-e+1}break}break}case Yt.HORIZONTAL:break;case Yt.PAGE:case Yt.VERTICAL:{if(this._spreadMode===Ni.NONE)break;let n=this._spreadMode-1;if(t&&e%2!==n)break;if(!t&&e%2===n)break;let{views:r}=this._getVisiblePages(),s=t?e-1:e+1;for(let{id:o,percent:a,widthPercent:l}of r)if(o===s){if(a>0&&l===100)return 2;break}break}}return 1}nextPage(){let e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;let n=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+n,t),!0}previousPage(){let e=this._currentPageNumber;if(e<=1)return!1;let t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:n=null,origin:r}){if(n===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(t>0&&t!==1)s=Math.round(s*t*100)/100;else if(n){let o=n>0?ik:1/ik,a=n>0?Math.ceil:Math.floor;n=Math.abs(n);do s=a((s*o).toFixed(2)*10)/10;while(--n>0)}s=Math.max(LQ,Math.min(kQ,s)),this.#I(s,{noScroll:!1,drawingDelay:e,origin:r})}increaseScale(e={}){this.updateScale(We(ae({},e),{steps:e.steps??1}))}decreaseScale(e={}){this.updateScale(We(ae({},e),{steps:-(e.steps??1)}))}#F(e=this.container.clientHeight){e!==this.#b&&(this.#b=e,HQ.setProperty("--viewer-container-height",`${e}px`))}#B(e){for(let t of e)if(t.target===this.container){this.#F(Math.floor(t.borderBoxSize[0].blockSize)),this.#l=null;break}}get containerTopLeft(){return this.#l||=[this.container.offsetTop,this.container.offsetLeft]}#V(){this.#f?.abort(),this.#f=null,this.#m!==null&&(clearTimeout(this.#m),this.#m=null)}get annotationEditorMode(){return this.#r?this.#i:_r.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:n=!1}){if(!this.#r)throw new Error("The AnnotationEditor is not enabled.");if(this.#i===e)return;if(!Nk(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;e===_r.STAMP&&this.#p?.loadModel("altText");let{eventBus:r}=this,s=()=>{this.#V(),this.#i=e,this.#r.updateMode(e,t,n),r.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===_r.NONE||this.#i===_r.NONE){let o=e!==_r.NONE;o||this.pdfDocument.annotationStorage.resetModifiedIds();for(let l of this._pages)l.toggleEditingMode(o);let a=this.#O();if(o&&a){this.#V(),this.#f=new AbortController;let l=AbortSignal.any([this.#h.signal,this.#f.signal]);r._on("pagerendered",({pageNumber:d})=>{a.delete(d),a.size===0&&(this.#m=setTimeout(s,0))},{signal:l});return}}s()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(let n of this._pages)n.update(t);this.#A!==null&&(clearTimeout(this.#A),this.#A=null),e||this.update()}}},FC=class extends sx{_resetView(){super._resetView(),this._scrollMode=Yt.PAGE,this._spreadMode=Ni.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}};var Gpe=Dn.AnnotationLayerBuilder,Wpe=Dn.DownloadManager,qpe=Dn.EventBus,Zpe=Dn.FindState,xJ=Dn.GenericL10n,wJ=Dn.LinkTarget,bJ=Dn.PDFFindController,Ype=Dn.PDFHistory,yJ=Dn.PDFLinkService,Xpe=Dn.PDFPageView,Qpe=Dn.PDFScriptingManager,AJ=Dn.PDFSinglePageViewer,_J=Dn.PDFViewer,Kpe=Dn.ProgressBar,Jpe=Dn.RenderingStates,$pe=Dn.ScrollMode,eme=Dn.SimpleLinkService,tme=Dn.SpreadMode,nme=Dn.StructTreeLayerBuilder,ime=Dn.TextLayerBuilder,rme=Dn.XfaLayerBuilder,sme=Dn.parseQueryString;function EJ(i,e,t){i[e]=t}function CJ(){return typeof window>"u"}CJ()||EJ(eC,"verbosity",$E.INFOS);typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let i,e;return{promise:new Promise((n,r)=>{i=n,e=r}),resolve:i,reject:e}});var Qr=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({})}return i})();var If=function(i){return i[i.DISABLE=0]="DISABLE",i[i.ENABLE=1]="ENABLE",i[i.ENABLE_FORMS=2]="ENABLE_FORMS",i[i.ENABLE_STORAGE=3]="ENABLE_STORAGE",i}(If||{});var $o={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},MJ=typeof window>"u"?!1:!!globalThis.MSInputMethodContext&&!!document.documentMode,TJ=typeof navigator>"u"||/Edge\/\d./i.test(navigator.userAgent),IJ=typeof ReadableStream>"u"||typeof Promise.allSettled>"u",DJ="4.7.701",PJ="4.7.699";function eu(i){return i?.includes("bleeding-edge")?PJ:DJ}function Ja(i,e=""){return i.includes("://")?i:`./${i+e}`}var ar={needsES5:MJ||TJ||IJ,annotationEditorMode:0,annotationMode:If.ENABLE_FORMS,defaultZoomDelay:400,cursorToolOnLoad:0,defaultUrl:"",defaultZoomValue:"",disableHistory:!1,disablePageLabels:!1,enablePermissions:!1,docBaseUrl:"",enablePrintAutoRotate:!0,externalLinkRel:"noopener noreferrer nofollow",externalLinkTarget:0,findController:void 0,historyUpdateUrl:!1,ignoreDestinationZoom:!1,imageResourcesPath:"./images/",maxCanvasPixels:-1,forcePageColors:!1,pageColorsBackground:"Canvas",pageColorsForeground:"CanvasText",pdfBugEnabled:!1,printResolution:150,rangeChunkSize:65536,removePageBorders:!1,enableXfa:!0,fontExtraProperties:!1,sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,viewOnLoad:0,cMapPacked:!0,cMapUrl:function(){return`${Ja(ar.assetsFolder,"/..")}/cmaps/`},disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!0,isEvalSupported:!0,isOffscreenCanvasSupported:!0,maxImageSize:-1,pdfBug:!1,verbosity:1,workerPort:null,assetsFolder:"assets",_internalFilenameSuffix:".min",sandboxBundleSrc:function(){return ar.needsES5?`./pdf.sandbox-${eu(Ja(ar.assetsFolder))}-es5.mjs`:`./pdf.sandbox-${eu(Ja(ar.assetsFolder))}${ar._internalFilenameSuffix}.mjs`},workerSrc:function(){return ar.needsES5?`${Ja(ar.assetsFolder)}/pdf.worker-${eu(Ja(ar.assetsFolder))}-es5.mjs`:`${Ja(ar.assetsFolder)}/pdf.worker-${eu(Ja(ar.assetsFolder))}${ar._internalFilenameSuffix}.mjs`},standardFontDataUrl:()=>`${Ja(ar.assetsFolder,"/..")}/standard_fonts/`,doubleTapZoomFactor:"page-width",doubleTapZoomsInHandMode:!0,doubleTapZoomsInTextSelectionMode:!1,doubleTapResetsZoomOnSecondDoubleTap:!1,enableScripting:!0,defaultCacheSize:50,passwordPrompt:void 0,enableHWA:!0};var RJ=(()=>{class i{onPDFJSInitSignal=xl(void 0);pdfjsVersion=eu(ar.assetsFolder);constructor(){Sm(()=>{this.onPDFJSInitSignal()&&(this.pdfjsVersion=eu(ar.assetsFolder))})}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),LJ=(()=>{class i{rendererFactory;ngxExtendedPdfViewerInitialized=!1;secondaryMenuIsEmpty=!1;renderer;PDFViewerApplication;constructor(t,n){this.rendererFactory=t,this.renderer=this.rendererFactory.createRenderer(null,null),Sm(()=>{this.PDFViewerApplication=n.onPDFJSInitSignal()})}find(t,n={}){if(this.ngxExtendedPdfViewerInitialized){if(!n.useSecondaryFindcontroller){let a=document.getElementById("findHighlightAll");a&&(a.checked=n.highlightAll??!1);let l=document.getElementById("findMatchCase");l&&(l.checked=n.matchCase??!1);let d=document.getElementById("findMultiple");d&&(d.checked=n.findMultiple??!1);let c=document.getElementById("findEntireWord");c&&(c.checked=n.wholeWords??!1);let u=document.getElementById("findMatchDiacritics");u&&(u.checked=n.matchDiacritics??!1);let h=document.getElementById("matchRegExp");h&&(h.checked=n.regexp??!1,h.checked&&(d&&(d.checked=!1),c&&(c.checked=!1),u&&(u.checked=!1)),d&&(d.disabled=h.checked),c&&(c.disabled=h.checked),u&&(u.disabled=h.checked));let f=document.getElementById("findInput");f&&typeof t=="string"&&(f.value=t)}let r={caseSensitive:n.matchCase??!1,entireWord:n.wholeWords??!1,highlightAll:n.highlightAll??!1,matchDiacritics:n.matchDiacritics??!1,findMultiple:n.findMultiple,matchRegExp:n.regexp??!1,findPrevious:!1,query:t,source:null,type:"find",dontScrollIntoView:n.dontScrollIntoView??!1};return(n.useSecondaryFindcontroller?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFind(r)}else{console.error("The PDF viewer hasn't finished initializing. Please call find() later.");return}}findNext(t=!1){return this.ngxExtendedPdfViewerInitialized?((t?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFindNext(),!0):(console.error("The PDF viewer hasn't finished initializing. Please call findNext() later."),!1)}findPrevious(t=!1){return this.ngxExtendedPdfViewerInitialized?((t?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFindPrevious(),!0):(console.error("The PDF viewer hasn't finished initializing. Please call findPrevious() later."),!1)}print(t){this.PDFViewerApplication&&(this.PDFViewerApplication?.PDFPrintServiceFactory?.isInPDFPrintRange!==void 0||(t||(t={}),this.setPrintRange(t),this.PDFViewerApplication?.printPdf(),this.PDFViewerApplication?.eventBus.on("afterprint",this.removePrintRange.bind(this),{once:!0})))}removePrintRange(){this.PDFViewerApplication?.PDFPrintServiceFactory&&(delete this.PDFViewerApplication.PDFPrintServiceFactory.isInPDFPrintRange,delete this.PDFViewerApplication.PDFPrintServiceFactory.filteredPageCount)}setPrintRange(t){if(!this.PDFViewerApplication?.PDFPrintServiceFactory){console.error("The print service hasn't been initialized yet.");return}this.PDFViewerApplication.PDFPrintServiceFactory.isInPDFPrintRange=n=>this.isInPDFPrintRange(n,t),this.PDFViewerApplication.PDFPrintServiceFactory.filteredPageCount=this.filteredPageCount(this.PDFViewerApplication?.pagesCount,t)}filteredPageCount(t,n){let r=0;for(let s=0;s<t;s++)this.isInPDFPrintRange(s,n)&&r++;return r}isInPDFPrintRange(t,n){let r=t+1;return!(n.from&&r<n.from||n.to&&r>n.to||n.excluded&&n.excluded.some(s=>s===r)||n.included&&!n.included.some(s=>s===r))}getPageAsLines(t){return re(this,null,function*(){if(this.PDFViewerApplication){let o=(yield(yield(this.PDFViewerApplication?.pdfDocument).getPage(t)).getTextContent()).items.filter(x=>!x.type),a=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,u=0,h=0,f="",p=new Array;for(let x=0;x<o.length;x++){let v=o[x];if(!v.hasEOL){let y=v.transform[4],b=-v.transform[5],A=v.width,M=v.height;a=Math.min(a,y),l=Math.min(l,b),d=Math.max(d,y+A),c=Math.max(c,b+M),f+=v.str,v.dir==="rtl"&&h++,v.dir==="ltr"&&u++}if(x===o.length-1||v.hasEOL){let y;u>0&&h>0?y="both":u>0?y="ltr":h>0&&(y="rtl");let b={direction:y,x:a,y:l,width:d-a,height:c-l,text:f.trim()};p.push(b),a=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,u=0,h=0,f=""}}return p}return[]})}getPageAsText(t){return re(this,null,function*(){if(!this.PDFViewerApplication)return"";let s=(yield(yield(this.PDFViewerApplication?.pdfDocument).getPage(t)).getTextContent()).items;return this.convertTextInfoToText(s)})}convertTextInfoToText(t){return t?t.filter(n=>!n.type).map(n=>n.hasEOL?n.str+`
`:n.str).join(""):""}getPageAsCanvas(a,l,d){return re(this,arguments,function*(t,n,r,s="#FFFFFF",o=If.ENABLE){if(!this.PDFViewerApplication)return Promise.resolve(void 0);let u=yield this.PDFViewerApplication.pdfDocument.getPage(t);return this.draw(u,n,r,s,o)})}getPageAsImage(a,l,d){return re(this,arguments,function*(t,n,r,s="#FFFFFF",o=If.ENABLE){return(yield this.getPageAsCanvas(t,n,r,s,o))?.toDataURL()})}draw(a,l,d){return re(this,arguments,function*(t,n,r,s="#FFFFFF",o=If.ENABLE){let c=1;n.scale?c=n.scale:n.width?c=n.width/t.getViewport({scale:1}).width:n.height&&(c=n.height/t.getViewport({scale:1}).height);let u=t.getViewport({scale:c}),{ctx:h,canvas:f}=this.getPageDrawContext(u.width,u.height),p=u.clone(),x={canvasContext:h,viewport:p,background:r,backgroundColorToReplace:s,annotationMode:o},v=t.render(x),g=()=>Promise.resolve(f);return v.promise.then(g)})}getPageDrawContext(t,n){let r=document.createElement("canvas"),s=r.getContext("2d",{alpha:!0});if(!s)throw new Error("Couldn't create the 2d context");return r.width=t,r.height=n,this.renderer.setStyle(r,"width",`${t}px`),this.renderer.setStyle(r,"height",`${n}px`),{ctx:s,canvas:r}}getCurrentDocumentAsBlob(){return re(this,null,function*(){return(yield this.PDFViewerApplication?.export())||void 0})}getFormData(t=!0){return re(this,null,function*(){if(!this.PDFViewerApplication)return[];let n=this.PDFViewerApplication?.pdfDocument,r=96/72,s=[];for(let o=1;o<=n?.numPages;o++){let a=yield n.getPage(o);(yield a.getAnnotations()).filter(d=>d.subtype==="Widget").map(d=>ae({},d)).forEach(d=>{let c=a.getViewport({scale:r}).convertToViewportRectangle(d.rect);if(t&&d.fieldName)try{if(d.exportValue){let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(d.id,d.fieldName+"/"+d.exportValue,"");d.value=u?.value}else if(d.radioButton){let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(d.id,d.fieldName+"/"+d.fieldValue,"");d.value=u?.value}else{let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(d.id,d.fieldName,"");d.value=u?.value}}catch{}s.push({fieldAnnotation:d,fieldRect:c,pageNumber:o})})}return s})}addPageToRenderQueue(t){return this.PDFViewerApplication?.pdfViewer.addPageToRenderQueue(t)??!1}isRenderQueueEmpty(){return this.PDFViewerApplication?!this.PDFViewerApplication.pdfViewer.renderingQueue.getHighestPriority(this.PDFViewerApplication?.pdfViewer._getVisiblePages(),this.PDFViewerApplication?.pdfViewer._pages,!0,!1):!0}hasPageBeenRendered(t){if(!this.PDFViewerApplication)return!1;let n=this.PDFViewerApplication?.pdfViewer._pages;return n.length>t&&t>=0?n[t].renderingState===3:!1}sleep(t){return new Promise(n=>setTimeout(n,t))}renderPage(t){return re(this,null,function*(){if(!this.hasPageBeenRendered(t))for(yield this.addPageToRenderQueue(t);!this.hasPageBeenRendered(t);)yield this.sleep(7)})}currentlyRenderedPages(){return this.PDFViewerApplication?(this.PDFViewerApplication?.pdfViewer._pages).filter(n=>n.renderingState===3).map(n=>n.id):[]}numberOfPages(){return this.PDFViewerApplication?(this.PDFViewerApplication?.pdfViewer._pages).length:0}getCurrentlyVisiblePageNumbers(){let t=this.PDFViewerApplication;return t?t.pdfViewer._getVisiblePages().views?.map(r=>r.id):[]}listLayers(){return re(this,null,function*(){if(!this.PDFViewerApplication)return[];let t=yield this.PDFViewerApplication?.pdfViewer.optionalContentConfigPromise;if(t)return t.getOrder().filter(s=>typeof s!="object").map(s=>{let o=t.getGroup(s);return{layerId:s,name:o.name,visible:o.visible}})})}toggleLayer(t){return re(this,null,function*(){if(!this.PDFViewerApplication)return;let n=yield this.PDFViewerApplication?.pdfViewer.optionalContentConfigPromise;if(n){let r=n.getGroup(t).visible,s=document.querySelector(`input[id='${t}']`);s&&(r=s.checked,s.checked=!r),n.setVisibility(t,!r),this.PDFViewerApplication?.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(n)})}})}scrollPageIntoView(t,n){this.PDFViewerApplication?.pdfViewer?.scrollPagePosIntoView(t,n)}getSerializedAnnotations(){return this.PDFViewerApplication?.pdfViewer.getSerializedAnnotations()}addEditorAnnotation(t){return re(this,null,function*(){yield this.PDFViewerApplication?.pdfViewer.addEditorAnnotation(t)})}removeEditorAnnotations(t){this.PDFViewerApplication?.pdfViewer.removeEditorAnnotations(t)}loadImageAsDataURL(t){return re(this,null,function*(){if(t.startsWith("data:"))return t;let n=yield fetch(t);if(!n.ok)throw new Error(`Failed to fetch the image from ${t}: ${n.statusText}`);return yield n.blob()})}addImageToAnnotationLayer(d){return re(this,arguments,function*({urlOrDataUrl:t,page:n,left:r,bottom:s,right:o,top:a,rotation:l}){if(!this.PDFViewerApplication){console.error("The PDF viewer has not been initialized yet.");return}let c;n!==void 0?(n!==this.currentPageIndex()&&(yield this.renderPage(n)),c=n):c=this.currentPageIndex()??0;let u=this.PDFViewerApplication.pdfViewer.annotationEditorMode;this.switchAnnotationEdtorMode(13);let h=yield this.loadImageAsDataURL(t),f=this.PDFViewerApplication.pdfViewer._pages[c].pdfPage.view,p=f[0],x=f[1],v=f[2],g=f[3],y=v-p,b=g-x,A=this.PDFViewerApplication?.pdfViewer._pages[c].div.clientWidth,M=this.PDFViewerApplication?.pdfViewer._pages[c].div.clientHeight,T=this.convertToPDFCoordinates(r,y,0,A),I=this.convertToPDFCoordinates(s,b,0,M),L=this.convertToPDFCoordinates(o,y,y,A),E=this.convertToPDFCoordinates(a,b,b,M),S={annotationType:13,pageIndex:c,bitmapUrl:h,rect:[T,I,L,E],rotation:l??0};this.addEditorAnnotation(S),yield this.sleep(10),this.switchAnnotationEdtorMode(u)})}currentPageIndex(){let t=this.PDFViewerApplication?.pdfViewer;if(t)return t.currentPageNumber-1}convertToPDFCoordinates(t,n,r,s){return t?typeof t=="string"?t.endsWith("%")?parseInt(t,10)/100*n:t.endsWith("px")?parseInt(t,10)*(n/s):parseInt(t,10):t:r}switchAnnotationEdtorMode(t){this.PDFViewerApplication?.eventBus.dispatch("switchannotationeditormode",{mode:t})}set editorFontSize(t){this.setEditorProperty($o.FREETEXT_SIZE,t)}set editorFontColor(t){this.setEditorProperty($o.FREETEXT_COLOR,t)}set editorInkColor(t){this.setEditorProperty($o.INK_COLOR,t)}set editorInkOpacity(t){this.setEditorProperty($o.INK_OPACITY,t)}set editorInkThickness(t){this.setEditorProperty($o.INK_THICKNESS,t)}set editorHighlightColor(t){this.setEditorProperty($o.HIGHLIGHT_COLOR,t)}set editorHighlightDefaultColor(t){this.setEditorProperty($o.HIGHLIGHT_DEFAULT_COLOR,t)}set editorHighlightShowAll(t){this.setEditorProperty($o.HIGHLIGHT_SHOW_ALL,t)}set editorHighlightThickness(t){this.setEditorProperty($o.HIGHLIGHT_THICKNESS,t)}setEditorProperty(t,n){this.PDFViewerApplication?.eventBus.dispatch("switchannotationeditorparams",{type:t,value:n}),this.PDFViewerApplication?.eventBus.dispatch("annotationeditorparamschanged",{details:[[t,n]]})}static \u0275fac=function(n){return new(n||i)(Te(fa),Te(RJ))};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();Promise.allSettled||window.Zone&&!window["__zone_symbol__Promise.allSettled"]&&console.error("Please update zone.js to version 0.10.3 or higher. Otherwise, you'll run the slow ECMAScript 5 version even on modern browser that can run the fast ESMAScript 2015 version.");var Kr=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({providers:[LJ],imports:[xt,vn]})}return i})();var kJ=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500 hidden":!0}),NJ=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500":!0}),FJ=()=>({standalone:!0});function OJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",27)(2,"line",28)(3,"line",29),w())}function BJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",30)(2,"line",31)(3,"line",32),w())}function VJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",27)(2,"line",28)(3,"line",29),w())}function UJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",30)(2,"line",31)(3,"line",32),w())}function HJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",27)(2,"line",28)(3,"line",29),w())}function zJ(i,e){i&1&&(ie(),m(0,"svg",26),F(1,"path",30)(2,"line",31)(3,"line",32),w())}function jJ(i,e){i&1&&(m(0,"div",33)(1,"div",34),_(2,"No results found"),w()())}function GJ(i,e){i&1&&(m(0,"span",50),_(1,"(Missed Date)"),w())}function WJ(i,e){if(i&1&&(m(0,"option",51),_(1),w()),i&2){let t=e.$implicit,n=U(2);k("ngClass",Mi(3,NJ))("value",t),C(),ot(" ",n.statusViewer(t)," ")}}function qJ(i,e){if(i&1){let t=Ve();m(0,"button",52),H("click",function(){$(t);let r=U().$implicit,s=U();return ee(s.viewPdfFile(r.file_name))}),_(1," View forms "),w()}}function ZJ(i,e){i&1&&(m(0,"div",53),_(1," No forms "),w())}function YJ(i,e){if(i&1){let t=Ve();m(0,"div",35)(1,"div",36),_(2),w(),m(3,"div",37),_(4),w(),m(5,"div",38)(6,"select",39),H("change",function(r){let s=$(t).$implicit,o=U();return ee(o.onOptionSelected(r,s.user_id,s.event_id,s.kiosk_id,s.form_id,s.Email,s.date_req))}),m(7,"option",40),_(8),G(9,GJ,2,0,"span",41),w(),G(10,WJ,2,4,"option",42),w()(),m(11,"div",43),G(12,qJ,2,0,"button",44)(13,ZJ,2,0,"div",45),w(),m(14,"div",46)(15,"button",47),H("click",function(){let r=$(t).$implicit,s=U();return s.viewUser=!s.viewUser,s.viewFormId=r.form_id,s.viewUserName=r.First_name+" "+r.Last_name,s.viewDate=s.formatDate(r.date_created.toString()),s.firstName=r.First_name,s.lastName=r.Last_name,s.viewEvent=r.event_name,s.viewKiosk=r.kiosk_name,s.viewReceipt=r.receipt_number,s.viewPurpose=r.purpose,s.viewThings=r.requirements,s.viewDateRequested=r.date_req,s.viewMayors=r.mayors_permit,s.viewSanitary=r.sanitary_permit,ee(s.viewBusiness=r.business_permit)}),ie(),m(16,"svg",48),F(17,"path",49),w()()()()}if(i&2){let t=e.$implicit,n=U();C(2),ot(" ",n.formatDate(t.date_created),""),C(2),ot("",t.First_name+" "+t.Last_name," "),C(2),k("disabled",n.dateVerifier(t.date_req)&&t.date_req!="0000-00-00 00:00:00"&&t.status=="approved"),C(),k("ngClass",Mi(9,kJ)),C(),ot(" ",n.statusViewer(t.status)||"Select an option"," "),C(),k("ngIf",n.dateVerifier(t.date_req)&&t.date_req!="0000-00-00 00:00:00"&&t.status=="approved"),C(),k("ngForOf",n.statusOptions),C(2),k("ngIf",t.file_name),C(),k("ngIf",!t.file_name)}}function XJ(i,e){i&1&&(Gb(0),m(1,"div",57),_(2," No PDF found. "),w(),Wb())}function QJ(i,e){if(i&1){let t=Ve();m(0,"embed",58),H("error",function(){$(t);let r=U(2);return ee(r.onPdfError())}),w()}if(i&2){let t=U(2);k("src",t.pdfUrl,Mb)}}function KJ(i,e){if(i&1){let t=Ve();m(0,"div",54)(1,"button",55),H("click",function(){$(t);let r=U();return ee(r.viewPdf=!r.viewPdf)}),m(2,"span"),_(3,"x"),w()(),G(4,XJ,3,0,"ng-container",56)(5,QJ,1,1,"ng-template",null,0,qb),w()}if(i&2){let t=Ki(6),n=U();C(4),k("ngIf",n.pdfError)("ngIfElse",t)}}function JJ(i,e){i&1&&(m(0,"span"),_(1," Requested date is required, please input in the field provided"),w())}function $J(i,e){if(i&1){let t=Ve();m(0,"div",64)(1,"div",65)(2,"p",66),_(3," Please enter the date you wish to schedule! In the field provided below. "),w(),m(4,"div",67)(5,"label",68),_(6,"Requested Date"),w(),m(7,"input",69),Ye("ngModelChange",function(r){$(t);let s=U(2);return Xe(s.dateRequested,r)||(s.dateRequested=r),ee(r)}),w(),m(8,"p",70),G(9,JJ,2,0,"span",25),w()()(),m(10,"div",71)(11,"button",72),H("click",function(){$(t);let r=U(2);return ee(r.selectorDate=!r.selectorDate)}),_(12,"Cancel"),w(),m(13,"button",73),H("click",function(r){$(t);let s=U(2);return ee(s.onOptionSelected(r,s.userId,s.eventId,s.kioskId,s.formId,s.userEmail,s.dateRequested))}),_(14,"Submit"),w()()()}if(i&2){let t=U(2);C(7),Ze("ngModel",t.dateRequested),k("min",t.minDate)("max",t.maxDate)("ngModelOptions",Mi(5,FJ)),C(2),k("ngIf",t.counter>1)}}function e$(i,e){if(i&1&&(m(0,"span",84),_(1),w()),i&2){let t=U(3);C(),ge(t.formatDate(t.viewDateRequested))}}function t$(i,e){i&1&&(m(0,"span",84),_(1,"Not yet approved"),w())}function n$(i,e){if(i&1&&(m(0,"span",84),_(1),w()),i&2){let t=U(3);C(),ge(t.viewReceipt)}}function i$(i,e){i&1&&(m(0,"span",84),_(1,"Not yet paid"),w())}function r$(i,e){if(i&1){let t=Ve();m(0,"button",98),H("click",function(){$(t);let r=U(3);return ee(r.downloadForm(r.viewFormId.toString()))}),_(1," Download User Application Form "),w()}}function s$(i,e){i&1&&(m(0,"div",99),_(1," User Application Form Not Available "),w())}function o$(i,e){i&1&&(m(0,"div",100)(1,"label",101),_(2,"Permit:"),w(),m(3,"div",102),_(4," Permit not available"),w()())}function a$(i,e){if(i&1&&(m(0,"div",103)(1,"label",104),_(2,"Mayors Permit:"),w(),F(3,"img",105),w()),i&2){let t=U(3);C(3),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/requirementsImages/",t.viewMayors,"",ai),ls("alt",t.viewMayors)}}function l$(i,e){if(i&1&&(m(0,"div",103)(1,"label",104),_(2,"Business Permit:"),w(),F(3,"img",105),w()),i&2){let t=U(3);C(3),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/requirementsImages/",t.viewBusiness,"",ai),ls("alt",t.viewMayors)}}function d$(i,e){if(i&1&&(m(0,"div",103)(1,"label",104),_(2,"Sanitary Permit:"),w(),F(3,"img",105),w()),i&2){let t=U(3);C(3),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/requirementsImages/",t.viewSanitary,"",ai),ls("alt",t.viewMayors)}}function c$(i,e){if(i&1){let t=Ve();m(0,"div",74)(1,"div",75)(2,"button",76),H("click",function(){$(t);let r=U(2);return ee(r.viewUser=!r.viewUser)}),_(3,"x"),w()(),m(4,"div",77)(5,"p",78),_(6," Transaction Details "),w(),m(7,"p",79),_(8,"Forms, and Permits"),w()(),m(9,"div",80)(10,"div",81)(11,"p",82),_(12," Date Created: "),w(),m(13,"p",83)(14,"span",84),_(15),w()(),m(16,"p",85)(17,"span",84),_(18,"Date requested:"),w()(),m(19,"p",86),G(20,e$,2,1,"span",87)(21,t$,2,0,"span",87),w(),m(22,"p",82),_(23," Full Name: "),w(),m(24,"p",83)(25,"span",84),_(26),w()(),m(27,"p",82),_(28," Event Name: "),w(),m(29,"p",83)(30,"span",84),_(31),w()(),m(32,"p",82),_(33," Kiosk Name: "),w(),m(34,"p",83)(35,"span",84),_(36),w()(),m(37,"p",82),_(38," Receipt Number: "),w(),m(39,"p",83),G(40,n$,2,1,"span",87)(41,i$,2,0,"span",87),w(),m(42,"p",88),_(43," Purpose: "),w(),m(44,"textarea",89),_(45),w(),m(46,"p",88),_(47," Things: "),w(),m(48,"textarea",89),_(49),w()(),m(50,"div",90)(51,"p",91),_(52," Forms, and Permits"),w(),m(53,"div",92)(54,"label",93),_(55,"Application Form:"),w(),G(56,r$,2,0,"button",94)(57,s$,2,0,"div",95),w(),G(58,o$,5,0,"div",96)(59,a$,4,3,"div",97)(60,l$,4,3,"div",97)(61,d$,4,3,"div",97),w()()()}if(i&2){let t=U(2);C(15),ge(t.viewDate),C(5),k("ngIf",t.viewDateRequested!="0000-00-00 00:00:00"),C(),k("ngIf",t.viewDateRequested=="0000-00-00 00:00:00"),C(5),ge(t.viewUserName),C(5),ge(t.viewEvent),C(5),ge(t.viewKiosk),C(4),k("ngIf",t.viewReceipt),C(),k("ngIf",!t.viewReceipt),C(4),ge(t.toSentenceCase(t.viewPurpose)),C(4),ge(t.removeLastComma(t.viewThings)),C(7),k("ngIf",t.viewDateRequested!="0000-00-00 00:00:00"),C(),k("ngIf",t.viewDateRequested=="0000-00-00 00:00:00"),C(),k("ngIf",!t.viewMayors&&!t.viewBusiness&&!t.viewSanitary),C(),k("ngIf",t.viewMayors),C(),k("ngIf",t.viewBusiness),C(),k("ngIf",t.viewSanitary)}}function u$(i,e){if(i&1){let t=Ve();m(0,"div",106)(1,"div",65)(2,"p",107),_(3," The requested date, and status has been successfully updated, User has been notified. "),w()(),m(4,"div",108)(5,"button",109),H("click",function(){$(t);let r=U(2);return r.updatedRequestedDate=!r.updatedRequestedDate,ee(r.changeVal())}),_(6,"Okay"),w()()()}}function h$(i,e){i&1&&(m(0,"div",110),F(1,"div",111),m(2,"p",112),_(3,"loading..."),w()())}function f$(i,e){if(i&1&&(m(0,"div")(1,"div",59),G(2,$J,15,6,"div",60)(3,c$,62,16,"div",61)(4,u$,7,0,"div",62)(5,h$,4,0,"div",63),w()()),i&2){let t=U();C(2),k("ngIf",t.selectorDate),C(),k("ngIf",t.viewUser),C(),k("ngIf",t.updatedRequestedDate),C(),k("ngIf",t.loading)}}var ax=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userTransaction=[];eventData=[];kioskData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascStatus=!1;ascEvent=!1;ascKiosk=!1;ascRefNum=!1;ascUsername=!1;reference="";checkerReference=!1;ascPurpose=!1;ascDate=!1;ascReq=!1;referenceNumber=!1;errorMessage="";viewPdf=!1;selectorDate=!1;loading=!1;updatedRequestedDate=!1;viewUser=!1;statusOptions=["pending","approved","denied","finished","paid"];pdfError=!1;dateRequested="";maxDate="";minDate="";status="";userId=0;eventId=0;kioskId=0;formId=0;viewFormId=0;viewUserName="";viewDate="";viewEvent="";viewKiosk="";viewPurpose="";viewThings="";viewReceipt="";viewDateRequested="";viewMayors="";viewSanitary="";viewBusiness="";userEmail="";pdfUrl="";counter=0;selectedOption="";onOptionSelected(e,t,n,r,s,o,a){if(console.log(new Date),this.selectedOption=e.target.value,!this.dateRequested&&this.selectedOption!="approved")a="0000-00-00 00:00:00",this.selectedOption=="finished"&&(a=a),this.loading=!0,this.adminService.updateStatus(this.selectedOption,t,n,r,s,a).subscribe(l=>{l.success&&(this.loading=!1,ps.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:o,status:this.selectedOption,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(d=>{console.log("Email sent successfully!",d.text),window.location.reload()}))});else if(this.dateRequested&&this.selectedOption=="approved"){this.loading=!0;let l=new Date(a);console.log(l),this.adminService.updateStatus(this.selectedOption,t,n,r,s,a).subscribe(d=>{d.success&&(this.counter=0,this.selectorDate=!this.selectorDate,this.updatedRequestedDate=!this.updatedRequestedDate,sessionStorage.setItem("updatedRequestedDate",this.updatedRequestedDate.toString()),this.loading=!1,ps.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:o,message:"Note: From "+this.formatDate(a)+" (requested date) you only have 3 days to comply with the requirements, Failure to comply within 3 days will result in your reservation being CANCELLED",status:this.selectedOption,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(c=>{console.log("Email sent successfully!",c.text),this.dateRequested="",window.location.reload()}))})}else!this.dateRequested&&this.selectedOption=="approved"&&(this.loading=!0,this.counter+=1,this.counter==1&&this.adminService.getSelectedEvent(n).subscribe(l=>{if(l.success==!0){this.loading=!1;let d=new Date;this.maxDate=this.formatDateRemove(l.endDate.toString()),this.minDate=this.formatDateRemove(d.toString()),console.log(this.minDate,this.maxDate),this.selectorDate=!0,this.userId=t,this.eventId=n,this.kioskId=r,this.formId=s,this.userEmail=o}}))}toSentenceCase(e){return!e||typeof e!="string"?"":e.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g,t=>t.toUpperCase())}formatDateRemove(e){return new Date(e).toISOString().split("T")[0]}dateVerifier(e){let t=new Date,n=new Date(e),r=new Date(n);return r.setDate(r.getDate()+3),t>r}getTransaction(){this.token=sessionStorage.getItem("tokenId")??"",this.adminService.getTransaction().subscribe(e=>{this.userTransaction=e})}selectDate(){}viewPdfFile(e){let t="https://mapp-thesis.infotech3c.com/public/dbAssets/userImages/"+e;this.viewPdf=!0,console.log(this.pdfUrl),this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t)}onPdfError(){this.pdfError=!0}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}statusViewer(e){return e=="approved"?"approved":e=="pending"?"booked":e=="finished"?"completed":e=="paid"?e:(e=="denied","cancelled")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getKioskName(e){let t=this.kioskData.find(n=>n.kiosk_id==e);return t?t.kiosk_name:"Unknown Kiosk"}getKiosk(){this.eventService.getKiosk().subscribe(e=>{this.kioskData=e})}getEvent(){this.eventService.getEvents().subscribe(e=>{this.eventData=e})}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}removeLastComma(e){return!e||typeof e!="string"?"":e.replace(/,\s*$/,"")}toLowerCaseSafe(e){return e?e.toLowerCase():""}getTransactionsToDisplay(){let e=this.userTransaction.filter(r=>this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.kiosk_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.receipt_number).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(this.formatDate(r.date_created)).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status+"(over due)").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.First_name+" "+r.Last_name).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userTransaction.length&&(console.log(this.userTransaction.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.eventService.downloadForm(e,this.firstName,this.lastName)}changeVal(){sessionStorage.setItem("updatedRequestedDate","false")}ngOnInit(){sessionStorage.getItem("transactions")!="1"&&this.router.navigate(["/dashboard-admin"]),this.updatedRequestedDate=sessionStorage.getItem("updatedRequestedDate")==="true",this.getEvent(),this.getKiosk(),this.getTransaction()}static \u0275fac=function(t){return new(t||i)(se(ds),se(Qe),se(Xn),se(ci),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-transaction"]],standalone:!0,features:[gt],decls:63,vars:14,consts:[["showPdf",""],[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"flex","justify-between","h-full","w-full","px-0","md:px-2","items-center"],[1,"bg-green-200","size-28","md:size-36","px-2","text-center","rounded-xl","shadow-md","shadow-gray-500","justify-center","grid","items-center"],[1,"text-7xl","md:text-8xl","text-gray-600"],[1,"text-sm","md:text-md","text-gray-600","font-bold"],[1,"text-sm","md:text-md","text-gray-600","font-bold","w-full"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1"],[1,"text-gray-700","text-3xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-5","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[12px]","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","class","svgTable","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"flex","justify-center","items-center","border-r-2","border-green-900"],["class","grid grid-cols- overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-[10px] md:text-lg font-semibold text-gray-200",4,"ngIf"],["class","grid grid-cols-5 overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px]  text-center w-full h-full px-3 md:px-2 py-2 text-[10px] md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["class","absolute top-0 left-1/2 transform -translate-x-1/2 mt-4 border-4 border-gray-300 bg-gray-50 w-3/4 h-[90%] flex flex-col z-[10001] shadow-lg",4,"ngIf"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"svgTable"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","md:text-lg","font-semibold","text-gray-200"],[1,"text-md","col-span-9","md:text-lg","flex","justify-center","items-center"],[1,"grid","grid-cols-5","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","md:text-lg","font-semibold","text-gray-200"],[1,"text-[10px]","md:text-sm","flex","justify-center","items-center","leading-none"],[1,"flex","justify-center","items-center","leading-none"],["id","dropdown",1,"flex","justify-center","items-center","leading-none","overflow-x-hidden"],[1,"bg-customDarkGreen","border-none","outline-none","w-48","md:w-96",3,"change","disabled"],["value","","selected","",3,"ngClass"],["class","text-red-200",4,"ngIf"],["class","bg-customDarkGreen rounded-md",3,"ngClass","value",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","px-1"],["class","bg-green-800 h-5 md:h-8 w-full md:text-sm rounded-lg hover:bg-green-900 leading-none hover:text-white",3,"click",4,"ngIf"],["class","flex justify-center items-center text-center bg-green-800 h-8 w-full md:text-sm rounded-lg leading-none hover:text-white",4,"ngIf"],[1,"flex","justify-center","items-center","px-1"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 64 64","width","24","height","24"],["d","M32 12C18 12 6.3 24 2 32c4.3 8 16 20 30 20s25.7-12 30-20c-4.3-8-16-20-30-20zm0 34c-8.3 0-15-6.7-15-15s6.7-15 15-15 15 6.7 15 15-6.7 15-15 15zm0-24c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9z","fill","white"],[1,"text-red-200"],[1,"bg-customDarkGreen","rounded-md",3,"ngClass","value"],[1,"bg-green-800","h-5","md:h-8","w-full","md:text-sm","rounded-lg","hover:bg-green-900","leading-none","hover:text-white",3,"click"],[1,"flex","justify-center","items-center","text-center","bg-green-800","h-8","w-full","md:text-sm","rounded-lg","leading-none","hover:text-white"],[1,"absolute","top-0","left-1/2","transform","-translate-x-1/2","mt-4","border-4","border-gray-300","bg-gray-50","w-3/4","h-[90%]","flex","flex-col","z-[10001]","shadow-lg"],[1,"absolute","top-3","right-[16px]","hover:bg-[#747775]","hover:text-gray-200","text-sm","text-center","cursor-pointer","text-gray-50","rounded-full","bg-[#323639FF]","size-8","flex","items-center","justify-center",3,"click"],[4,"ngIf","ngIfElse"],[1,"flex","items-center","justify-center","h-full","text-gray-500","text-lg"],["width","100%","height","100%","type","application/pdf",3,"error","src"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[10000]"],["class"," animate-fadeIn overflow-hidden  absolute top-[15rem] pt-8 px-8 grid justify-center items-center  left-1/2 transform -translate-x-1/2 w-3/4 h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[10001] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden absolute top-[5rem] p-8 grid justify-center items-center left-1/2 transform -translate-x-1/2 w-full h-3/4 md:h-3/4 md:w-3/4 border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[10001] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute top-[15rem] px-8 grid justify-center items-center  left-1/2 transform -translate-x-1/2 w-3/4 h-[380px]  md:h-[380px] md:w-96 border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[10001] bg-customDarkGreen",4,"ngIf"],["class","absolute inset-0 flex flex-col items-center justify-center h-[70rem] overflow-hidden w-full z-[1001]",4,"ngIf"],[1,"animate-fadeIn","overflow-hidden","absolute","top-[15rem]","pt-8","px-8","grid","justify-center","items-center","left-1/2","transform","-translate-x-1/2","w-3/4","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[10001]","bg-customDarkGreen"],[1,"flex","flex-col","w-full","h-40","justify-center","items-center","space-y-8"],[1,"text-lg","text-center","text-red-50","pt-4"],[1,"form-group","w-72"],[1,"text-white"],["type","date","id","dateRequested","name","dateRequested","required","","placeholder","Date requested",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","min","max","ngModelOptions"],[1,"h-12","text-sm","text-center","mt-8","text-red-500"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],["value","approved",1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","absolute","top-[5rem]","p-8","grid","justify-center","items-center","left-1/2","transform","-translate-x-1/2","w-full","h-3/4","md:h-3/4","md:w-3/4","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[10001]","bg-customDarkGreen"],[1,"absolute","top-4","right-4"],["value","approved",1,"size-12","bg-green-600","rounded-full","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"grid","grid-cols-2","w-full","h-full","justify-start","items-start","gap-x-4","gap-y-0","px-8","pb-4"],[1,"md:col-span-1","col-span-2","text-2xl","md:text-3xl","text-center","text-red-50","font-bold","h-full"],[1,"hidden","md:inline","text-2xl","md:text-3xl","text-center","text-red-50","font-bold","h-full"],[1,"grid","grid-cols-1","md:grid-cols-2","w-full","h-full","justify-start","items-start","gap-x-4","gap-y-0","overflow-auto","p-4","md:p-8"],[1,"grid","grid-cols-2","w-full","h-full","justify-start","items-start","gap-y-2"],[1,"labelForm"],[1,"valueForm"],[1,"leading-none"],[1,"labelForm","leading-none"],[1,"valueForm","leading-none"],["class"," leading-none",4,"ngIf"],[1,"text-sm","md:text-lg","font-semibold","min-h-40","h-40","max-h-40","text-left","py-2","text-red-50","rounded-l-xl","border-b-2","border-l-2","border-t-2","border-gray-50","pl-3"],["readonly","",1,"min-h-40","h-40","max-h-40","text-sm","md:text-lg","text-left","bg-transparent","py-2","text-red-50","rounded-r-xl","border-b-2","border-r-2","border-t-2","border-gray-50","focus:outline-none","focus:ring-none"],[1,"grid","grid-cols-1","gap-2","text-lg","overflow-auto"],[1,"flex","items-center","justify-center","md:hidden","col-span-1","md:col-span-2","text-2xl","md:text-3xl","text-center","text-red-50","font-bold","h-full","py-4"],[1,"flex-col","justify-center","items-center","text-gray-50","w-full"],[1,"text-white","w-full","font-semibold"],["class","bg-green-800 h-8 w-full border-2 leading-none border-gray-50 text-xs md:text-sm rounded-lg hover:bg-green-900 hover:text-white",3,"click",4,"ngIf"],["class","flex justify-center items-center border-2 leading-none border-gray-50 bg-green-800 h-8 w-full text-xs md:text-sm rounded-lg ",4,"ngIf"],["class","flex-col justify-center items-center ",4,"ngIf"],["class","flex flex-col justify-start items-start ",4,"ngIf"],[1,"bg-green-800","h-8","w-full","border-2","leading-none","border-gray-50","text-xs","md:text-sm","rounded-lg","hover:bg-green-900","hover:text-white",3,"click"],[1,"flex","justify-center","items-center","border-2","leading-none","border-gray-50","bg-green-800","h-8","w-full","text-xs","md:text-sm","rounded-lg"],[1,"flex-col","justify-center","items-center"],[1,"text-white","font-semibold"],[1,"h-96","w-full","border-2","border-gray-50","rounded-xl","object-contain","text-gray-50","text-xl","flex","justify-center","items-center"],[1,"flex","flex-col","justify-start","items-start"],[1,"text-white","font-semibold","text-left"],[1,"size-full","position-center","object-contain","border-2","border-gray-50","rounded-xl",3,"src","alt"],[1,"animate-fadeIn","overflow-hidden","absolute","top-[15rem]","px-8","grid","justify-center","items-center","left-1/2","transform","-translate-x-1/2","w-3/4","h-[380px]","md:h-[380px]","md:w-96","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[10001]","bg-customDarkGreen"],[1,"text-lg","md:text-2xl","text-center","text-gray-50"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-[70rem]","overflow-hidden","w-full","z-[1001]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"]],template:function(t,n){t&1&&(m(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),_(5),w(),m(6,"div",6),_(7,"PAID"),w()(),m(8,"div",4)(9,"div",5),_(10),w(),m(11,"div",7),_(12,"FINISHED"),w()(),m(13,"div",4)(14,"div",5),_(15),w(),m(16,"div",7),_(17,"TRANSACTION"),w()()(),m(18,"div",8)(19,"div",9)(20,"p"),_(21," Transaction History:"),w()(),m(22,"div",10),ie(),m(23,"svg",11)(24,"g")(25,"g"),F(26,"path",12),w()()(),Je(),m(27,"input",13),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(28,"div",14)(29,"div",15)(30,"button",16),H("click",function(){return n.onSortChange("date_req"),n.ascDate=!n.ascDate}),m(31,"div",17),G(32,OJ,4,0,"svg",18)(33,BJ,4,0,"svg",18),m(34,"p"),_(35,"Date"),w()()()(),m(36,"div",15)(37,"button",16),H("click",function(){return n.onSortChange("Username"),n.ascUsername=!n.ascUsername}),m(38,"div",17),G(39,VJ,4,0,"svg",18)(40,UJ,4,0,"svg",18),m(41,"p"),_(42,"Name"),w()()()(),m(43,"div",15)(44,"button",16),H("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),m(45,"div",17),G(46,HJ,4,0,"svg",18)(47,zJ,4,0,"svg",18),m(48,"p"),_(49,"Status"),w()()()(),m(50,"div",19),_(51,"Pdf file"),w(),m(52,"div",17),_(53,"View More"),w()(),G(54,jJ,3,0,"div",20)(55,YJ,18,10,"div",21),m(56,"div",22)(57,"button",23),H("click",function(){return n.prevTransaction()}),_(58," Prev "),w(),m(59,"button",23),H("click",function(){return n.nextTransaction()}),_(60," Next "),w()()(),G(61,KJ,7,2,"div",24)(62,f$,6,4,"div",25),w()),t&2&&(C(5),ge(n.counterPaid(n.userTransaction)),C(5),ge(n.counterFinished(n.userTransaction)),C(5),ge(n.userTransaction.length),C(12),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascDate),C(),k("ngIf",!n.ascDate),C(6),k("ngIf",n.ascUsername),C(),k("ngIf",!n.ascUsername),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(7),k("ngIf",n.getTransactionsToDisplay().length==0),C(),k("ngForOf",n.getTransactionsToDisplay()),C(6),k("ngIf",n.viewPdf),C(),k("ngIf",n.selectorDate||n.viewUser||n.updatedRequestedDate||n.loading))},dependencies:[vn,Us,Hs,_n,Sn,_o,yn,xt,Ji,an,kt,Qr,Kr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.svgTable[_ngcontent-%COMP%]{height:1rem;width:1rem}@media (min-width: 768px){.svgTable[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem}}.labelForm[_ngcontent-%COMP%]{display:flex;height:3rem;align-items:center;justify-content:flex-start;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;border-bottom-width:2px;border-left-width:2px;border-top-width:2px;--tw-border-opacity: 1;border-color:rgb(249 250 251 / var(--tw-border-opacity, 1));padding-left:.75rem;text-align:left;font-size:.875rem;line-height:1.25rem;font-weight:600;--tw-text-opacity: 1;color:rgb(254 242 242 / var(--tw-text-opacity, 1))}@media (min-width: 768px){.labelForm[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}}.valueForm[_ngcontent-%COMP%]{display:flex;height:3rem;align-items:center;justify-content:flex-start;border-top-right-radius:.75rem;border-bottom-right-radius:.75rem;border-bottom-width:2px;border-right-width:2px;border-top-width:2px;--tw-border-opacity: 1;border-color:rgb(249 250 251 / var(--tw-border-opacity, 1));text-align:left;font-size:.875rem;line-height:1.25rem;line-height:1;--tw-text-opacity: 1;color:rgb(254 242 242 / var(--tw-text-opacity, 1))}@media (min-width: 768px){.valueForm[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}}"]})};function p$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function m$(i,e){i&1&&(ie(),m(0,"svg",25),F(1,"path",26)(2,"line",27)(3,"line",28),w())}function g$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function v$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",26)(2,"line",27)(3,"line",28),w())}function x$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function w$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",26)(2,"line",27)(3,"line",28),w())}function b$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function y$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",26)(2,"line",27)(3,"line",28),w())}function A$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function _$(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",26)(2,"line",27)(3,"line",28),w())}function S$(i,e){i&1&&(m(0,"div",29)(1,"div",30),_(2,"No results found"),w()())}function E$(i,e){i&1&&(m(0,"p",38),_(1,"Active"),w())}function C$(i,e){if(i&1){let t=Ve();m(0,"div",31)(1,"div",32),_(2),w(),m(3,"div",32),_(4),w(),m(5,"div",12),_(6),w(),m(7,"div",33),_(8),w(),m(9,"div",12),G(10,E$,2,0,"p",34),w(),m(11,"div",12),F(12,"img",35),w(),m(13,"div",12)(14,"button",36),H("click",function(){let r=$(t).$implicit,s=U();return s.isModalOpen=!s.isModalOpen,s.eventStart=r.event_start,s.eventEnd=r.event_end,s.eventName=r.event_name,s.eventDetails=r.details,s.eventId=r.event_id,ee(s.eventStatus=r.status)}),F(15,"img",37),w()()()}if(i&2){let t=e.$implicit,n=U();C(2),ot("",n.formatDate(t.event_start)," "),C(2),ge(n.formatDate(t.event_end)),C(2),ge(t.event_name),C(2),ot("",t.details," "),C(2),k("ngIf",t.status==1),C(2),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/",t.event_image,"",ai)}}function M$(i,e){i&1&&(m(0,"span",69),_(1,"..."),w())}function T$(i,e){if(i&1&&(m(0,"span",69),_(1),Ti(2,"slice"),G(3,M$,2,0,"span",62),w()),i&2){let t=U(2);C(),ot("",Hi(2,2,t.eventImage.name,0,6)," "),C(2),k("ngIf",t.eventImage&&t.eventImage.name.length>6)}}function I$(i,e){i&1&&(m(0,"span",69),_(1,"Upload image"),w())}function D$(i,e){if(i&1&&(m(0,"div",46)(1,"p",70),_(2),w()()),i&2){let t=U(2);C(2),ge(t.errorMessage)}}function P$(i,e){if(i&1){let t=Ve();m(0,"div",39)(1,"div",40)(2,"button",41),H("click",function(){$(t);let r=U();return ee(r.disable=!r.disable)}),ie(),m(3,"svg",42)(4,"g")(5,"g"),F(6,"path",43),w()()()(),Je(),m(7,"h2",44),_(8,"Edit Event"),w(),m(9,"form",45),H("ngSubmit",function(){$(t);let r=U();return ee(r.onSubmit())}),m(10,"div",46)(11,"label",47),_(12,"Event Name"),w(),m(13,"input",48),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.eventName,r)||(s.eventName=r),ee(r)}),w()(),m(14,"div",49)(15,"div",46)(16,"label",50),_(17,"Event Start"),w(),m(18,"input",51),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.eventStart,r)||(s.eventStart=r),ee(r)}),w()(),m(19,"div",46)(20,"label",52),_(21,"Event End"),w(),m(22,"input",53),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.eventEnd,r)||(s.eventEnd=r),ee(r)}),w()()(),m(23,"div",46)(24,"label",54),_(25,"Details"),w(),m(26,"textarea",55),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.eventDetails,r)||(s.eventDetails=r),ee(r)}),w()(),m(27,"div",49)(28,"div",46)(29,"label",56),_(30,"Status"),w(),m(31,"select",57),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.eventStatus,r)||(s.eventStatus=r),ee(r)}),m(32,"option",58),_(33,"Disable"),w(),m(34,"option",59),_(35,"Active"),w()()(),m(36,"div",46)(37,"label",60),_(38,"Event Image"),w(),m(39,"div",61),H("click",function(){$(t);let r=Ki(45);return ee(r.click())}),G(40,T$,4,6,"span",62)(41,I$,2,0,"span",62),m(42,"div",63),_(43," Browse "),w()(),m(44,"input",64,0),H("change",function(r){$(t);let s=U();return ee(s.onFileChange(r))}),w()()(),G(46,D$,3,1,"div",65),m(47,"div",66)(48,"button",67),H("click",function(){$(t);let r=U();return ee(r.closeModal())}),_(49," Cancel "),w(),m(50,"button",68),_(51," Save Changes "),w()()()()()}if(i&2){let t=U();C(13),Ze("ngModel",t.eventName),C(5),Ze("ngModel",t.eventStart),C(4),Ze("ngModel",t.eventEnd),C(4),Ze("ngModel",t.eventDetails),C(5),Ze("ngModel",t.eventStatus),C(9),k("ngIf",t.eventImage),C(),k("ngIf",!t.eventImage),C(5),k("ngIf",t.errorMessage)}}function R$(i,e){i&1&&(m(0,"div",75),F(1,"div",76),m(2,"p",77),_(3,"loading..."),w()())}function L$(i,e){if(i&1){let t=Ve();m(0,"div",78)(1,"div",79)(2,"p",80),_(3," Are you sure you want to disable the event? "),F(4,"br")(5,"br"),m(6,"span",81),_(7,"Note: It will only be seen in the event history"),w()()(),m(8,"div",82)(9,"button",83),H("click",function(){$(t);let r=U(2);return ee(r.disable=!r.disable)}),_(10,"No "),w(),m(11,"button",84),H("click",function(){$(t);let r=U(2);return ee(r.eventDisable())}),_(12,"Yes "),w()()()}}function k$(i,e){if(i&1){let t=Ve();m(0,"div",85)(1,"div",79)(2,"p",86),_(3," Events Updated Succesfully! "),w()(),m(4,"div",87)(5,"button",84),H("click",function(){$(t);let r=U(2);return ee(r.changeVal())}),_(6,"Okay "),w()()()}}function N$(i,e){if(i&1&&(m(0,"div")(1,"div",71),G(2,R$,4,0,"div",72),w(),G(3,L$,13,0,"div",73)(4,k$,7,0,"div",74),w()),i&2){let t=U();C(2),k("ngIf",t.loading),C(),k("ngIf",t.disable),C(),k("ngIf",t.submit=="true")}}var lx=class i{constructor(e,t,n,r,s,o){this.ngZone=e;this.sanitizer=t;this.router=n;this.userService=r;this.eventService=s;this.adminService=o}eventData=[];searchText="";loading=!1;pageIndex=0;pageSize=10;sortField="event_start";sortDirection="asc";ascStart=!1;ascEnd=!1;ascEvent=!1;ascDetails=!1;ascStatus=!1;errorMessage="";isModalOpen=!1;selectedEvent={};disable=!1;eventName="";eventStart="";eventStatus="";eventEnd="";eventDetails="";eventId="";eventImage=null;imageFileName="";submit="false";onlyOnce=!1;getDynamicImagePath(e){let t="/dbAssets/eventImages/",n=new Date().getTime();return`${t}${e}?t=${n}`}getSanitizedImagePath(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}eventDisable(){this.adminService.disableEvent(this.eventId).subscribe({next:e=>{e.success&&(this.closeModal(),this.eventId="",this.eventName="",this.eventStart="",this.eventEnd="",this.eventStatus="",this.eventDetails="",this.eventImage=null,this.imageFileName="",window.location.reload())},error:e=>{this.errorMessage="Error submitting the application. Please try again.",console.error(e)}})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getEvent(){this.adminService.getEvent().subscribe(e=>{this.eventData=e})}openModal(e){this.selectedEvent=ae({},e),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){let e=new Date,t=new Date(this.eventStart),n=new Date(this.eventEnd);if(t.getTime()===n.getTime()){this.errorMessage="The start and end dates cannot be the same.";return}if(n<t){this.errorMessage="The end date must be later than the start date.";return}if(t<e){this.errorMessage="The start date must be in the future.";return}if(n<e){this.errorMessage="The end date must be in the future.";return}let r=new FormData;r.append("eventId",this.eventId),r.append("eventName",this.eventName),r.append("eventStart",this.eventStart),r.append("eventEnd",this.eventEnd),r.append("status",this.eventStatus),r.append("details",this.eventDetails),this.eventImage&&r.append("eventImage",this.eventImage,this.eventImage.name),this.onlyOnce==!1&&(this.onlyOnce=!0,this.loading=!0,this.adminService.updateEvents(r).subscribe({next:s=>{this.loading=!1,console.log(s.message,s.success),s.success&&(console.log("Event updated successfully."),console.log("Event Name:",r.get("eventName")),console.log("Event ID:",r.get("eventId")),sessionStorage.setItem("submit","true"),this.closeModal(),this.eventId="",this.eventName="",this.eventStart="",this.eventEnd="",this.eventStatus="",this.eventDetails="",this.eventImage=null,this.imageFileName="",this.onlyOnce=!1,window.location.reload())},error:s=>{this.onlyOnce=!1,this.errorMessage="Error submitting the application. Please try again.",console.error(s)}}))}get eventStatusModel(){return this.eventStatus==="1"?"active":this.eventStatus}set eventStatusModel(e){this.eventStatus=e==="active"?"1":e}onStatusChange(e){console.log("Event Status Changed:",this.eventStatus)}toLowerCaseSafe(e){return e?e.toLowerCase():""}getEventsToDisplay(){let e=this.eventData.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(this.formatDate(r.event_start)).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(this.formatDate(r.event_end)).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe("active").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.details).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortEvents(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortEvents(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.eventData.length&&(console.log(this.eventData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}changeVal(){sessionStorage.setItem("submit","false"),this.submit="false"}ngOnInit(){sessionStorage.getItem("events")!="1"&&this.router.navigate(["/dashboard-admin"]),this.submit=sessionStorage.getItem("submit")??"",this.getEvent()}static \u0275fac=function(t){return new(t||i)(se(rn),se(ds),se(Qe),se(Xn),se(ci),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-events-manage"]],standalone:!0,features:[gt],decls:65,vars:15,consts:[["fileInput",""],[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1"],[1,"text-gray-700","text-3xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-7","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[8px]","leading-none","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","class","svgTable","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["class","grid grid-cols-7 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngIf"],["class","grid grid-cols-7 gap-x-2 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-[7px] leading-none md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["class","fixed inset-0 flex justify-center items-center bg-gray-700 bg-opacity-50 z-[1000]",4,"ngIf"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"svgTable"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-7","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-md","col-span-7","md:text-lg","flex","justify-center","items-center"],[1,"grid","grid-cols-7","gap-x-2","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[7px]","leading-none","md:text-lg","font-semibold","text-gray-200"],[1,"flex","justify-center","items-center","text-[7px]","md:text-sm"],[1,"flex","justify-center","items-center","px-2","text-[7px]","md:text-xs","leading-none"],["class","text-green-200",4,"ngIf"],[1,"size-18","md:size-24","object-cover","border-2","border-gray-50","rounded-lg",3,"src"],[3,"click"],["src","/assets/svg/edit.svg",1,"size-8"],[1,"text-green-200"],[1,"fixed","inset-0","flex","justify-center","items-center","bg-gray-700","bg-opacity-50","z-[1000]"],[1,"bg-[#226f54]","rounded-lg","p-6","w-1/3","relative"],[1,"absolute","top-2","right-2","py-1","hover:bg-green-700","hover:text-gray-200","text-lg","text-center","justify-center","items-center","cursor-pointer","text-gray-50","rounded-full","bg-customDarkGreen","size-10","flex","items-center","justify-center",3,"click"],["fill","white","height","24px","width","24px","version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 512 512",0,"xml","space","preserve"],["d",`M256,0C114.615,0,0,114.616,0,256s114.615,256,256,256s256-114.616,256-256S397.385,0,256,0z M66.783,256
                       c0-104.503,84.716-189.217,189.217-189.217c40.19,0,77.446,12.541,108.089,33.907L100.689,364.089
                       C79.323,333.446,66.783,296.19,66.783,256z M256,445.217c-40.19,0-77.446-12.541-108.089-33.907l263.399-263.399
                       c21.366,30.643,33.907,67.899,33.907,108.089C445.217,360.501,360.501,445.217,256,445.217z`],[1,"text-xl","font-bold","mb-4","text-gray-50"],[3,"ngSubmit"],[1,"mb-4"],["for","event_name",1,"block","text-sm","font-medium","text-gray-50"],["id","event_name","name","event_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-2"],["for","event_start",1,"block","text-sm","font-medium","text-gray-50"],["id","event_start","name","event_start","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_end",1,"block","text-sm","font-medium","text-gray-50"],["id","event_end","name","event_end","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","details",1,"block","text-sm","font-medium","text-gray-50"],["id","details","name","details","rows","4",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_status",1,"block","text-sm","font-medium","text-gray-50"],["id","status","name","status",1,"mt-1","h-12","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","0"],["value","1"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"mt-1","relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","eventImage","accept","image/*","name","eventImage","required","",1,"hidden",3,"change"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end"],["type","button",1,"px-4","py-2","mr-2","text-white","bg-gray-500","hover:bg-gray-700","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md"],[1,"text-gray-700"],[1,"text-center","text-md","text-gray-50"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[1100] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[1100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl","w-96","leading-none"],[1,"text-[18px]"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-700","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-800","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"flex","justify-end","w-full"]],template:function(t,n){t&1&&(m(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"p"),_(5," Manage Events:"),w()(),m(6,"div",5),ie(),m(7,"svg",6)(8,"g")(9,"g"),F(10,"path",7),w()()(),Je(),m(11,"input",8),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(12,"div",9)(13,"div",10)(14,"button",11),H("click",function(){return n.onSortChange("event_start"),n.ascStart=!n.ascStart}),m(15,"div",12),G(16,p$,4,0,"svg",13)(17,m$,4,0,"svg",14),m(18,"p"),_(19,"Date Started"),w()()()(),m(20,"div",10)(21,"button",11),H("click",function(){return n.onSortChange("event_end"),n.ascEnd=!n.ascEnd}),m(22,"div",12),G(23,g$,4,0,"svg",13)(24,v$,4,0,"svg",13),m(25,"p"),_(26,"Date Ended"),w()()()(),m(27,"div",10)(28,"button",11),H("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),m(29,"div",12),G(30,x$,4,0,"svg",13)(31,w$,4,0,"svg",13),m(32,"p"),_(33,"Event Name"),w()()()(),m(34,"div",10)(35,"button",11),H("click",function(){return n.onSortChange("details"),n.ascDetails=!n.ascDetails}),m(36,"div",12),G(37,b$,4,0,"svg",13)(38,y$,4,0,"svg",13),m(39,"p"),_(40,"Details"),w()()()(),m(41,"div",10)(42,"button",11),H("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),m(43,"div",12),G(44,A$,4,0,"svg",13)(45,_$,4,0,"svg",13),m(46,"p"),_(47,"Status"),w()()()(),m(48,"div",10)(49,"div",12)(50,"p"),_(51,"Images"),w()()(),m(52,"div",12)(53,"div",12)(54,"p"),_(55,"Review"),w()()()(),G(56,S$,3,0,"div",15)(57,C$,16,7,"div",16),m(58,"div",17)(59,"button",18),H("click",function(){return n.prevTransaction()}),_(60," Prev "),w(),m(61,"button",18),H("click",function(){return n.nextTransaction()}),_(62," Next "),w()()(),G(63,P$,52,8,"div",19)(64,N$,5,3,"div",20),w()),t&2&&(C(11),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascStart),C(),k("ngIf",!n.ascStart),C(6),k("ngIf",n.ascEnd),C(),k("ngIf",!n.ascEnd),C(6),k("ngIf",n.ascEvent),C(),k("ngIf",!n.ascEvent),C(6),k("ngIf",n.ascDetails),C(),k("ngIf",!n.ascDetails),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(11),k("ngIf",n.getEventsToDisplay().length==0),C(),k("ngForOf",n.getEventsToDisplay()),C(6),k("ngIf",n.isModalOpen),C(),k("ngIf",n.loading||n.disable||n.submit=="true"))},dependencies:[vn,Fr,Us,Hs,_n,Ta,Sn,Nr,yn,pr,xt,an,kt,Lr,Qr,Kr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.svgTable[_ngcontent-%COMP%]{height:1rem;width:1rem}@media (min-width: 768px){.svgTable[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem}}"]})};function F$(i,e){if(i&1&&(m(0,"span",27),_(1),w()),i&2){let t=U();C(),ge(t.eventImage.name)}}function O$(i,e){i&1&&(m(0,"span",27),_(1,"Upload image"),w())}function B$(i,e){if(i&1&&(m(0,"p",28),_(1),w()),i&2){let t=U();C(),ge(t.errorMessage)}}function V$(i,e){i&1&&F(0,"div",29)}function U$(i,e){if(i&1){let t=Ve();m(0,"div",30)(1,"div",31)(2,"p",32),_(3," Event successfully created! "),w()(),m(4,"div",33)(5,"button",34),H("click",function(){$(t);let r=U();return ee(r.eventCreated())}),_(6,"Okay "),w()()()}}function H$(i,e){i&1&&(m(0,"div",37),F(1,"div",38),m(2,"p",39),_(3,"loading..."),w()())}function z$(i,e){if(i&1&&(m(0,"div")(1,"div",35),G(2,H$,4,0,"div",36),w()()),i&2){let t=U();C(2),k("ngIf",t.loading)}}var dx=class i{constructor(e,t){this.router=e;this.adminService=t}errorMessage="";isModalOpen=!1;created=!1;eventName="";eventStart="";eventEnd="";eventDetails="";eventImage=null;imageFileName="";onlyOnce=!1;loading=!1;onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}openModal(e){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){let e=new Date,t=new Date(this.eventStart),n=new Date(this.eventEnd);if(!this.eventName||!this.eventStart||!this.eventEnd||!this.eventDetails||!this.eventImage){this.errorMessage="All fields are required!";return}if(t.getTime()===n.getTime()){this.errorMessage="The start and end dates cannot be the same.";return}if(n<t){this.errorMessage="The end date must be later than the start date.";return}if(t<e){this.errorMessage="The start date must be in the future.";return}if(n<e){this.errorMessage="The end date must be in the future.";return}let r=new FormData;r.append("eventName",this.eventName),r.append("eventStart",this.eventStart),r.append("eventEnd",this.eventEnd),r.append("details",this.eventDetails),this.eventImage&&r.append("eventImage",this.eventImage,this.eventImage.name),this.onlyOnce||(this.onlyOnce=!0,this.loading=!0,this.adminService.createEvents(r).subscribe({next:s=>{this.loading=!1,console.log(s.message,s.success),s.success&&this.eventCreated(),this.onlyOnce=!1},error:s=>{this.errorMessage="Error submitting the event. Please try again.",console.error(s),console.error(this.errorMessage),this.onlyOnce=!1}}))}eventCreated(){this.onlyOnce=!1,this.created=!0,this.closeModal(),this.eventName="",this.eventStart="",this.eventEnd="",this.eventDetails="",this.eventImage=null,this.imageFileName="",window.location.reload()}ngOnInit(){sessionStorage.getItem("events")!="1"&&this.router.navigate(["/dashboard-admin"])}static \u0275fac=function(t){return new(t||i)(se(Qe),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-events-create"]],standalone:!0,features:[gt],decls:41,vars:10,consts:[["fileInput",""],[1,"px-2"],[1,"bg-customDarkGreen","md:rounded-lg","p-6","max-w-screen-xl","mx-auto"],[1,"text-2xl","font-bold","text-gray-50"],[1,"mt-4",3,"ngSubmit"],[1,"mb-4"],["for","event_name",1,"block","text-sm","font-medium","text-gray-50"],["id","event_name","name","event_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-x-2"],["for","event_start",1,"block","text-sm","font-medium","text-gray-50"],["id","event_start","name","event_start","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_end",1,"block","text-sm","font-medium","text-gray-50"],["id","event_end","name","event_end","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","details",1,"block","text-sm","font-medium","text-gray-50"],["id","details","name","details","rows","4",1,"mt-1","block","min-h-72","h-72","max-h-72","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","accept","image/*","id","eventImage","name","eventImage","required","",1,"hidden",3,"change"],[1,"mb-4","h-8"],["class","text-center text-md text-red-300",4,"ngIf"],[1,"flex","justify-end"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-[1000]",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[1100] bg-customDarkGreen",4,"ngIf"],[4,"ngIf"],[1,"text-gray-700"],[1,"text-center","text-md","text-red-300"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-[1000]"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[1100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"]],template:function(t,n){if(t&1){let r=Ve();m(0,"div",1)(1,"div",2)(2,"h2",3),_(3,"Create Event"),w(),F(4,"hr"),m(5,"form",4),H("ngSubmit",function(){return $(r),ee(n.onSubmit())}),m(6,"div",5)(7,"label",6),_(8,"Event Name"),w(),m(9,"input",7),Ye("ngModelChange",function(o){return $(r),Xe(n.eventName,o)||(n.eventName=o),ee(o)}),w()(),m(10,"div",8)(11,"div",5)(12,"label",9),_(13,"Event Start"),w(),m(14,"input",10),Ye("ngModelChange",function(o){return $(r),Xe(n.eventStart,o)||(n.eventStart=o),ee(o)}),w()(),m(15,"div",5)(16,"label",11),_(17,"Event End"),w(),m(18,"input",12),Ye("ngModelChange",function(o){return $(r),Xe(n.eventEnd,o)||(n.eventEnd=o),ee(o)}),w()()(),m(19,"div",5)(20,"label",13),_(21,"Details"),w(),m(22,"textarea",14),Ye("ngModelChange",function(o){return $(r),Xe(n.eventDetails,o)||(n.eventDetails=o),ee(o)}),w()(),m(23,"div",5)(24,"label",15),_(25,"Event Image"),w(),m(26,"div",16),H("click",function(){$(r);let o=Ki(32);return ee(o.click())}),G(27,F$,2,1,"span",17)(28,O$,2,0,"span",17),m(29,"button",18),_(30," Browse "),w()(),m(31,"input",19,0),H("change",function(o){return $(r),ee(n.onFileChange(o))}),w()(),m(33,"div",20),G(34,B$,2,1,"p",21),w(),m(35,"div",22)(36,"button",23),_(37," Create Event "),w()()(),G(38,V$,1,0,"div",24)(39,U$,7,0,"div",25),w()(),G(40,z$,3,1,"div",26)}t&2&&(C(9),Ze("ngModel",n.eventName),C(5),Ze("ngModel",n.eventStart),C(4),Ze("ngModel",n.eventEnd),C(4),Ze("ngModel",n.eventDetails),C(5),k("ngIf",n.eventImage),C(),k("ngIf",!n.eventImage),C(6),k("ngIf",n.errorMessage),C(4),k("ngIf",n.created),C(),k("ngIf",n.created),C(),k("ngIf",n.loading))},dependencies:[vn,Fr,_n,Sn,Nr,yn,pr,xt,kt,Qr,Kr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var j$=["modelContainer"],G$=(i,e)=>({"h-auto md:h-[520px]":i,"h-auto md:h-[280px]":e}),W$=i=>({"col-span-2":i});function q$(i,e){if(i&1){let t=Ve();m(0,"button",31),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/mapTerrain.glb"),ee(r.mapTerrain=!0)}),m(1,"div",32),ie(),m(2,"svg",33),F(3,"path",34),w()()()}}function Z$(i,e){if(i&1){let t=Ve();m(0,"button",31),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/map.glb"),ee(r.mapTerrain=!1)}),m(1,"div",32),ie(),m(2,"svg",33),F(3,"path",34),w()()()}}function Y$(i,e){if(i&1&&(m(0,"option",35),_(1),w()),i&2){let t=e.$implicit;k("value",t.event_id),C(),ot(" ",t.event_name," ")}}function X$(i,e){if(i&1){let t=Ve();m(0,"button",31),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/mapTerrain.glb"),ee(r.mapTerrain=!0)}),m(1,"div",32),ie(),m(2,"svg",33),F(3,"path",34),w()()()}}function Q$(i,e){if(i&1){let t=Ve();m(0,"button",31),H("click",function(){$(t);let r=U();return r.changeModel("assets/model/map.glb"),ee(r.mapTerrain=!1)}),m(1,"div",32),ie(),m(2,"svg",33),F(3,"path",34),w()()()}}function K$(i,e){if(i&1){let t=Ve();m(0,"div",36)(1,"label",37),_(2),w(),m(3,"div")(4,"label",38),_(5,"X Position"),w(),m(6,"input",39),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.kioskX,r)||(s.kioskX=r),ee(r)}),w(),m(7,"div",40)(8,"span"),_(9,"min"),w(),m(10,"span"),_(11,"max"),w()()(),m(12,"div")(13,"label",38),_(14,"Y Position"),w(),m(15,"input",41),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.kioskY,r)||(s.kioskY=r),ee(r)}),w(),m(16,"div",40)(17,"span"),_(18,"min"),w(),m(19,"span"),_(20,"max"),w()()(),m(21,"div",42)(22,"button",43),H("click",function(){$(t);let r=U();return r.addKiosk=!1,r.kioskX=0,ee(r.kioskY=0)}),_(23," Cancel "),w(),m(24,"button",44),H("click",function(){$(t);let r=U();return r.addKiosk=!1,ee(r.isModalOpen=!r.isModalOpen)}),_(25," Save Positon "),w()()()}if(i&2){let t=U();C(2),ot("Edit Position of ",t.kioskName,""),C(4),Ze("ngModel",t.kioskX),C(9),Ze("ngModel",t.kioskY)}}function J$(i,e){i&1&&(m(0,"span",75),_(1,"..."),w())}function $$(i,e){if(i&1&&(m(0,"span",75),_(1),Ti(2,"slice"),G(3,J$,2,0,"span",69),w()),i&2){let t=U(2);C(),ot("",Hi(2,2,t.kioskUploadImage.name,0,12)," "),C(2),k("ngIf",t.kioskUploadImage&&t.kioskUploadImage.name.length>12)}}function eee(i,e){i&1&&(m(0,"span",75),_(1,"Upload image "),w())}function tee(i,e){if(i&1&&(m(0,"div",49)(1,"p",76),_(2),w()()),i&2){let t=U(2);C(2),ge(t.errorMessage)}}function nee(i,e){if(i&1){let t=Ve();m(0,"div",45)(1,"div",46)(2,"h2",47),_(3,"Edit Kiosk"),w(),m(4,"form",48),H("ngSubmit",function(){$(t);let r=U();return ee(r.onSubmit())}),m(5,"div",49)(6,"label",50),_(7,"Kiosk Name"),w(),m(8,"input",51),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.kioskName,r)||(s.kioskName=r),ee(r)}),w()(),m(9,"div",49)(10,"label",52),_(11,"Status"),w(),m(12,"select",53),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.kioskStatus,r)||(s.kioskStatus=r),ee(r)}),m(13,"option",54),_(14,"Unavailable"),w(),m(15,"option",55),_(16,"Available"),w(),m(17,"option",56),_(18,"Disable"),w(),m(19,"option",57),_(20,"Pending"),w()()(),m(21,"div",49)(22,"label",58),_(23,"Description"),w(),m(24,"textarea",59),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.kioskDescription,r)||(s.kioskDescription=r),ee(r)}),w()(),m(25,"div",60)(26,"div",49)(27,"label",61),_(28,"Position X"),w(),m(29,"input",62),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.posx,r)||(s.posx=r),ee(r)}),w()(),m(30,"div",49)(31,"label",63),_(32,"Position Y"),w(),m(33,"input",64),Ye("ngModelChange",function(r){$(t);let s=U();return Xe(s.posy,r)||(s.posy=r),ee(r)}),w()(),m(34,"div",49),F(35,"label"),m(36,"button",65),H("click",function(){$(t);let r=U();return r.submitted=!1,r.addKiosk=!0,r.kioskX=r.posx,r.kioskY=r.posy,ee(r.isModalOpen=!r.isModalOpen)}),F(37,"img",66),w()()(),m(38,"div",49)(39,"label",67),_(40,"Kiosk Image"),w(),m(41,"div",68),H("click",function(){$(t);let r=Ki(47);return ee(r.click())}),G(42,$$,4,6,"span",69)(43,eee,2,0,"span",69),m(44,"div",70),_(45,"Browse"),w()(),m(46,"input",71,1),H("change",function(r){$(t);let s=U();return ee(s.onFileChange(r))}),w()(),G(48,tee,3,1,"div",72),m(49,"div",73)(50,"button",43),H("click",function(){$(t);let r=U();return r.closeModal(),r.addKiosk=!1,r.kioskX=0,ee(r.kioskY=0)}),_(51," Cancel "),w(),m(52,"button",74),H("click",function(){$(t);let r=U();return r.submitted=!0,ee(r.addKiosk=!1)}),_(53," Save Changes "),w()()()()()}if(i&2){let t=U();C(8),Ze("ngModel",t.kioskName),C(4),Ze("ngModel",t.kioskStatus),C(12),Ze("ngModel",t.kioskDescription),C(5),Ze("ngModel",t.posx),C(4),Ze("ngModel",t.posy),C(9),k("ngIf",t.kioskUploadImage),C(),k("ngIf",!t.kioskUploadImage),C(5),k("ngIf",t.errorMessage!="done"&&!t.errorMessage)}}function iee(i,e){i&1&&(m(0,"div",79),F(1,"div",80),m(2,"p",81),_(3,"loading..."),w()())}function ree(i,e){if(i&1){let t=Ve();m(0,"div",45)(1,"div",82)(2,"p",83),_(3,"Kiosk Updated Successfully!"),w(),m(4,"div",84)(5,"button",85),H("click",function(){$(t);let r=U(2);return ee(r.changeVal())}),_(6," Okay "),w()()()()}}function see(i,e){if(i&1){let t=Ve();m(0,"div",45)(1,"div",46)(2,"div"),F(3,"img",86),m(4,"p",87),_(5),w()(),m(6,"div",88)(7,"button",89),H("click",function(){$(t);let r=U(2);return ee(r.errorMessage="")}),_(8,"Close"),w(),m(9,"button",90),H("click",function(){$(t);let r=U(2);return r.isModalOpen=!r.isModalOpen,ee(r.errorMessage="")}),_(10,"Edit"),w()()()()}if(i&2){let t=U(2);C(3),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/kioskImages/",t.kioskImage,"",ai),C(2),ge(t.kioskName)}}function oee(i,e){if(i&1&&(m(0,"div")(1,"div",77),G(2,iee,4,0,"div",78),w(),G(3,ree,7,0,"div",29)(4,see,11,3,"div",29),w()),i&2){let t=U();C(2),k("ngIf",t.loading),C(),k("ngIf",t.submitKiosk=="true"),C(),k("ngIf",t.errorMessage=="done")}}var cx=class i{constructor(e,t,n){this.router=e;this.screenSizeService=t;this.adminService=n;this.scene=new Oc,this.camera=new Un(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new Fc({antialias:!0}),this.fontLoader=new ql}kioskData=[];eventData=[];scene;camera;renderer;model;controls;raycaster=new Hc;pointer=new we;clickableObjects=[];errorMessage="";fontLoader;isMap=!1;kioskName="";eventId="";kioskId="";submitKiosk="";kioskStatus="";posx=0;posy=0;kioskDescription="";kioskImage="";mapTerrain=!1;selectedEventId="";selectedEventName="Select events";currentModel;kioskUploadImage=null;kioskUploadImageName="";isModalOpen=!1;disable=!1;loading=!1;kioskX=0;kioskY=0;myKiosk;addKiosk=!1;submitted=!1;modelContainer;ngOnChanges(e){}goToDashBoard(){this.router.navigate(["/dashboard-admin"])}onEventSelect(e){let n=e.target.value;sessionStorage.setItem("eventIdMap",this.selectedEventId);let r=this.eventData.find(s=>s.event_id===n);if(r){let s=r.event_name;sessionStorage.setItem("eventIdMap",n),sessionStorage.setItem("eventNameMap",s)}window.location.reload()}getEventName(){return sessionStorage.getItem("eventNameMap")??"Select events"}getEvents(){this.adminService.getEvent().subscribe(e=>{this.eventData=e.map(t=>({event_id:t.event_id,event_name:t.event_name}))},e=>{console.error("Error fetching events:",e)})}changeVal(){sessionStorage.setItem("submit","false"),this.submitKiosk="false"}ngOnInit(){this.submitKiosk=sessionStorage.getItem("submit")??"",this.addClickListener(),this.getEvents(),this.controls=new Za(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let e=new ja(4210752);this.scene.add(e);let t=new Ys(16777215,1);t.position.set(20,20,20).normalize(),this.scene.add(t);let n=sessionStorage.getItem("eventIdMap")??"";this.adminService.getKioskMap(n).subscribe(r=>{this.kioskData=r,r.forEach(s=>{let o=new qs(.15,.15,.15);if(s.status=="available"){let a=new fn({color:5405039}),l=new jt(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="pending"){let a=new fn({color:16760331}),l=new jt(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="unavailable"){let a=new fn({color:10289672}),l=new jt(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,kiosk:s,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else{let a=new fn({color:1779259}),l=new jt(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,kiosk:s,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",a=>{let l=new qr(s.kiosk_name.replace(/\D/g,""),{font:a,size:.08,height:.05,curveSegments:12}),d=new fn({color:16381939}),c=new jt(l,d);this.scene.add(c),c.position.set(s.position_x,.8,s.position_y),c.scale.z=-1})}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new qr("Gym",{font:s,size:.5,height:.05,curveSegments:12}),a=new fn({color:3096134}),l=new jt(o,a);this.scene.add(l),l.position.set(1,1.8,1),l.scale.z=-1}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new qr("Field",{font:s,size:.5,height:.05,curveSegments:12}),a=new fn({color:3096134}),l=new jt(o,a);this.scene.add(l),l.position.set(-1.5,1.8,0),l.scale.z=-1})}),this.loadModel("assets/model/map.glb")}loadModel(e){let t=new Wl;this.removeModel(),t.load(e,n=>{this.currentModel=n.scene,this.scene.add(this.currentModel)},void 0,n=>{console.error("An error occurred while loading the model:",n)})}removeModel(){this.currentModel&&(this.scene.remove(this.currentModel),this.currentModel.traverse(e=>{e instanceof jt&&(e.geometry&&e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(t=>{t instanceof Tn&&t.dispose()}):e.material instanceof Tn&&e.material.dispose())}),this.currentModel=void 0)}changeModel(e){this.loadModel(e),this.renderer.domElement.addEventListener("click",r=>this.onMouseClick(r)),this.controls=new Za(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let t=new ja(4210752);this.scene.add(t);let n=new Ys(16777215,1);n.position.set(20,20,20).normalize(),this.scene.add(n)}onMouseClick(e){this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);let t=this.raycaster.intersectObjects(this.clickableObjects);if(t.length>0&&!this.addKiosk){let n=t[0].object,r=n.position.y,s=n.userData,o=s.kioskId,a=s.name,l=s.eventId,d=s.kioskStatus,c=s.kioskDescription,u=s.kioskImage,h=s.posx,f=s.posy;this.errorMessage="done",this.eventId=l,this.kioskId=o,this.kioskName=a,this.kioskStatus=d,this.kioskDescription=c,this.kioskImage=u,this.posx=h,this.posy=f}}addClickListener(){this.modelContainer.nativeElement.addEventListener("click",e=>this.onMouseClick(e))}ngAfterViewInit(){this.modelContainer&&this.modelContainer.nativeElement?(this.modelContainer.nativeElement.appendChild(this.renderer.domElement),this.animate()):console.error("Model container not found.")}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}ngDoCheck(){if(this.addKiosk){let e=new qs(.15,.15,.15),t=new fn({color:6180927}),n=new jt(e,t);n.position.set(this.posx,.65,this.posy),this.posx=this.kioskX,this.posy=this.kioskY,this.myKiosk&&this.scene.remove(this.myKiosk),this.scene.add(n),this.myKiosk=n}else this.scene.remove(this.myKiosk)}ngOnDestroy(){this.model&&(this.scene.remove(this.model),this.model.traverse(t=>{t instanceof jt&&(t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(n=>{n instanceof Tn&&n.dispose()}):t.material instanceof Tn&&t.material.dispose())})),this.renderer&&this.renderer.dispose();let e=this.renderer.domElement;e.parentElement&&e.parentElement.removeChild(e),this.controls&&this.controls.dispose()}openModal(e){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){if(this.submitted){let e=new FormData;e.append("kioskId",this.kioskId),e.append("kioskName",this.kioskName),e.append("posx",this.posx.toString()),e.append("posy",this.posy.toString()),e.append("kioskDescription",this.kioskDescription),e.append("status",this.kioskStatus),this.kioskUploadImage&&e.append("kioskUploadImage",this.kioskUploadImage,this.kioskUploadImage.name),this.loading=!0,this.adminService.updateKiosk(e).subscribe({next:t=>{this.loading=!1,t.success&&(sessionStorage.setItem("submit","true"),this.closeModal(),this.kioskId="",this.kioskName="",this.kioskDescription="",this.posx=0,this.posy=0,this.kioskStatus="",this.kioskUploadImage=null,this.kioskUploadImageName="",window.location.reload())},error:t=>{this.errorMessage="Error submitting the application. Please try again.",console.error(t)}})}}onFileChange(e){this.isModalOpen=!0;let t=e.target;t.files&&t.files.length>0&&(this.kioskUploadImage=t.files[0],this.kioskUploadImageName=this.kioskUploadImage.name)}static \u0275fac=function(t){return new(t||i)(se(Qe),se(Wc),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-map-viewer"]],viewQuery:function(t,n){if(t&1&&qn(j$,7),t&2){let r;Rn(r=Ln())&&(n.modelContainer=r.first)}},standalone:!0,features:[Vi,gt],decls:59,vars:16,consts:[["modelContainer",""],["fileInput",""],[1,"w-full","h-full","overflow-hidden","absolute","left-[0rem]","top-[0rem]","z-[100]"],[1,"overflow-hidden"],[1,"z-[110]","absolute","bottom-0","md:top-0","right-0","w-full","md:w-auto","bg-gray-400","p-4","rounded-t-xl","md:rounded-r-none","md:rounded-l-xl",3,"ngClass"],[1,"w-full","h-full","grid","grid-cols-2","gap-y-2"],[1,"hidden","md:flex","flex-row","space-x-2","justify-center","items-center","align-center","w-full","h-40","col-span-2"],[1,"grid","grid-cols-1","justify-center","item-center","align-center"],["class","size-20 hover:bg-green-700 hover:text-gray-50 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-center rounded-xl",3,"click",4,"ngIf"],[1,"md:grid","hidden","grid-cols-2","gap-x-1","gap-y-1","mt-4","h-40"],[1,"text-gray-50","text-lg","col-span-2","text-center"],[1,"size-6","bg-red-500","rounded-lg"],[1,"text-gray-50","text-xs"],[1,"size-6","bg-green-500","rounded-lg"],[1,"size-6","bg-yellow-500","rounded-lg"],[1,"size-6","bg-blue-500","rounded-lg"],[1,"w-full","grid","grid-cols-2","md:col-span-2","gap-y-1","gap-x-2",3,"ngClass"],[1,"col-span-2","flex-col","w-full","px-2","h-20"],[1,"text-left","text-md","text-gray-50","px-2"],[1,"outline-none","h-6","w-full","px-2",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"grid","md:hidden","grid-cols-2","gap-y-1","w-20","h-40"],[1,"flex","items-center","justify-center","md:hidden","h-full","w-full","flex-col","mt-4","px-2","space-y-2"],[1,"flex","justify-center","items-center","text-sm","text-gray-50","w-20","h-8","bg-red-400","rounded-md",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","white","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-5","w-5"],["d","M19 12H5"],["d","M12 19l-7-7 7-7"],["class","flex-col md:col-span-2  mt-4 justify-center items-center space-y-2 w-full text-gray-50 ",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center bg-gray-700 bg-opacity-50 z-[1000]",4,"ngIf"],[4,"ngIf"],[1,"size-20","hover:bg-green-700","hover:text-gray-50","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-center","rounded-xl",3,"click"],[1,"flex","h-full","items-center","justify-center","text-gray-50"],["width","24px","height","24px","viewBox","0 0 100 100","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","aria-hidden","true","role","img","preserveAspectRatio","xMidYMid meet",1,"iconify","iconify--gis"],["d","M50 5L24.637 30.469H41.34v20.705h17.32V30.469h16.703zM28.135 37.309a3.5 3.5 0 0 0-2.668 1.234L.832 67.559a3.5 3.5 0 0 0 2.67 5.765l93-.064a3.5 3.5 0 0 0 2.666-5.766L74.59 38.543a3.5 3.5 0 0 0-2.668-1.234H64.66c-.002 2.333-.008 4.666-.008 7h5.649l18.64 21.957l-77.873.052l18.686-22.01h5.586c.002-2.333.003-4.666 0-7zM89.91 78.264l-9.178.007l8.211 9.67l-77.875.053l8.22-9.682l-9.188.008L.832 89.234A3.5 3.5 0 0 0 3.502 95l93-.064a3.5 3.5 0 0 0 2.666-5.766z","fill","#161a1d"],[3,"value"],[1,"flex-col","md:col-span-2","mt-4","justify-center","items-center","space-y-2","w-full","text-gray-50"],[1,"block","text-xl","text-center","font-medium"],[1,"text-sm","font-medium"],["id","x-range","type","range","min","-3.5","max","4.8","step","0.01",1,"w-full","h-2","bg-blue-200","rounded-lg","cursor-pointer",3,"ngModelChange","ngModel"],[1,"flex","justify-between","text-xs"],["type","range","min","-2.6","max","1.8","step","0.01",1,"w-full","h-2","bg-green-200","rounded-lg","cursor-pointer",3,"ngModelChange","ngModel"],[1,"flex","justify-between"],["type","button",1,"px-4","py-2","mr-2","text-white","bg-gray-500","hover:bg-gray-700","rounded-md",3,"click"],[1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md","leading-none",3,"click"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-gray-700","bg-opacity-50","z-[1000]"],[1,"bg-[#226f54]","rounded-lg","p-6","w-full","md:w-1/3","absolute"],[1,"text-xl","font-bold","mb-4","text-gray-50","text-center"],[3,"ngSubmit"],[1,"mb-4"],["for","kiosk_name",1,"block","text-sm","font-medium","text-gray-50"],["id","kiosk_name","name","kiosk_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","status",1,"block","text-sm","font-medium","text-gray-50"],["id","status","name","status",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","unavailable"],["value","available"],["value","disable"],["value","pending"],["for","kiosk_description",1,"block","text-sm","font-medium","text-gray-50"],["id","kiosk_description","name","kiosk_description","rows","3",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"flex","space-x-2","justify-center","items-center"],["for","posx-x",1,"block","text-sm","font-medium","text-gray-50"],["id","posx","readonly","","name","posx","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","posy-y",1,"block","text-sm","font-medium","text-gray-50"],["id","posy","readonly","","name","posy","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[3,"click"],["src","/assets/svg/edit.svg",1,"size-4","mt-7"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","accept","image/*","id","kioskImage","name","kioskImage",1,"hidden",3,"change"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md",3,"click"],[1,"text-gray-700"],[1,"text-center","text-md","text-gray-50"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","absolute inset-0 flex flex-col items-center justify-center  h-full w-full z-[100]",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","h-20","w-20","border-t-4","border-black"],[1,"mt-4","font-bold","text-xs"],[1,"bg-[#226f54]","rounded-lg","p-6","w-full","md:w-1/3","h-[350px]","relative","flex","flex-col","justify-center"],[1,"text-gray-50","text-center","text-3xl","mb-4"],[1,"flex","justify-end","mt-36"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"size-full","object-contain",3,"src"],[1,"text-center","text-lg","text-gray-50","mt-4"],[1,"flex","justify-between","w-full","mt-4"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"]],template:function(t,n){if(t&1){let r=Ve();m(0,"div",2),F(1,"div",3,0),w(),m(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),G(7,q$,4,0,"button",8)(8,Z$,4,0,"button",8),w(),m(9,"div",9)(10,"p",10),_(11,"Legend:"),w(),F(12,"div",11),m(13,"p",12),_(14,"Unavailable"),w(),F(15,"div",13),m(16,"p",12),_(17,"Available"),w(),F(18,"div",14),m(19,"p",12),_(20,"Pending"),w(),F(21,"div",15),m(22,"p",12),_(23,"Disable"),w()()(),m(24,"div",16)(25,"div",17)(26,"label",18),_(27,"Select Events:"),w(),m(28,"select",19),H("change",function(o){return $(r),ee(n.onEventSelect(o))}),m(29,"option",20),_(30),w(),G(31,Y$,2,2,"option",21),w()(),m(32,"div",22)(33,"p",10),_(34,"Legend:"),w(),F(35,"div",11),m(36,"p",12),_(37,"Unavailable"),w(),F(38,"div",13),m(39,"p",12),_(40,"Available"),w(),F(41,"div",14),m(42,"p",12),_(43,"Pending"),w(),F(44,"div",15),m(45,"p",12),_(46,"Disable"),w()(),m(47,"div",23)(48,"button",24),H("click",function(){return $(r),ee(n.goToDashBoard())}),ie(),m(49,"svg",25),F(50,"path",26)(51,"path",27),w(),Je(),m(52,"span"),_(53,"Back"),w()(),G(54,X$,4,0,"button",8)(55,Q$,4,0,"button",8),w()(),G(56,K$,26,3,"div",28),w()(),G(57,nee,54,8,"div",29)(58,oee,5,3,"div",30)}t&2&&(C(3),k("ngClass",wm(11,G$,n.addKiosk,!n.addKiosk)),C(4),k("ngIf",!n.mapTerrain),C(),k("ngIf",n.mapTerrain),C(16),k("ngClass",$I(14,W$,!n.addKiosk)),C(6),ge(n.getEventName()),C(),k("ngForOf",n.eventData),C(23),k("ngIf",!n.mapTerrain),C(),k("ngIf",n.mapTerrain),C(),k("ngIf",n.addKiosk),C(),k("ngIf",n.isModalOpen),C(),k("ngIf",n.loading||n.submitKiosk=="true"||n.errorMessage=="done"))},dependencies:[xt,Ji,an,kt,Lr,vn,Fr,Us,Hs,_n,_1,Ta,Sn,Nr,yn,pr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.truncate[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"]})};function aee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function lee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function dee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function cee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function uee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function hee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function fee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function pee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function mee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function gee(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function vee(i,e){i&1&&(m(0,"div",24)(1,"div",25),_(2,"No results found"),w()())}function xee(i,e){i&1&&(m(0,"p",33),_(1,"Event Ended"),w())}function wee(i,e){i&1&&(m(0,"p",34),_(1,"Event Disabled"),w())}function bee(i,e){if(i&1&&(m(0,"div",26)(1,"div",27),_(2),w(),m(3,"div",27),_(4),w(),m(5,"div",28),_(6),w(),m(7,"div",29),_(8),w(),m(9,"div",28),G(10,xee,2,0,"p",30)(11,wee,2,0,"p",31),w(),m(12,"div",11),F(13,"img",32),w()()),i&2){let t=e.$implicit,n=U();C(2),ge(n.formatDate(t.event_start)),C(2),ge(n.formatDate(t.event_end)),C(2),ge(t.event_name),C(2),ge(t.details),C(2),k("ngIf",t.status==1),C(),k("ngIf",t.status==0),C(2),Ci("src","https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/",t.event_image,"",ai)}}var ux=class i{constructor(e,t,n,r,s,o){this.ngZone=e;this.sanitizer=t;this.router=n;this.userService=r;this.eventService=s;this.adminService=o}eventData=[];searchText="";pageIndex=0;pageSize=10;sortField="event_start";sortDirection="asc";ascStart=!1;ascEnd=!1;ascEvent=!1;ascDetails=!1;ascStatus=!1;errorMessage="";isModalOpen=!1;selectedEvent={};disable=!1;eventName="";eventStart="";eventStatus="";eventEnd="";eventDetails="";eventId="";eventImage=null;imageFileName="";submit="false";onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getEvent(){this.adminService.getPastEvent().subscribe(e=>{this.eventData=e})}openModal(e){this.selectedEvent=ae({},e),this.isModalOpen=!0}get eventStatusModel(){return this.eventStatus==="1"?"active":this.eventStatus}set eventStatusModel(e){this.eventStatus=e==="active"?"1":e}onStatusChange(e){console.log("Event Status Changed:",this.eventStatus)}toLowerCaseSafe(e){return e?e.toLowerCase():""}getEventsToDisplay(){let e=this.eventData.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_start).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_end).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe("active").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.details).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortEvents(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortEvents(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.eventData.length&&(console.log(this.eventData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}changeVal(){sessionStorage.setItem("submit","false"),this.submit="false"}ngOnInit(){sessionStorage.getItem("history")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getEvent()}static \u0275fac=function(t){return new(t||i)(se(rn),se(ds),se(Qe),se(Xn),se(ci),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-history"]],standalone:!0,features:[gt],decls:59,vars:13,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1"],[1,"text-gray-700","text-3xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-6","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","leading-none","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["class","grid grid-cols-7 overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngIf"],["class","grid grid-cols-6 overflow-hidden bg-customDarkGreen  border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2  text-[8px] leading-none md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-7","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-md","col-span-7","md:text-lg","flex","justify-center","items-center"],[1,"grid","grid-cols-6","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[8px]","leading-none","md:text-lg","font-semibold","text-gray-200"],[1,"flex","justify-center","items-center","px-2","text-[8px]","md:text-sm"],[1,"flex","justify-center","items-center","px-2"],[1,"flex","justify-center","items-center","px-2","text-[8px]","md:text-xs","leading-none"],["class","text-green-200",4,"ngIf"],["class","text-red-200",4,"ngIf"],[1,"size-16","md:size-24","object-cover","border-2","border-gray-50","rounded-xl",3,"src"],[1,"text-green-200"],[1,"text-red-200"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),_(5," Event History:"),w()(),m(6,"div",4),ie(),m(7,"svg",5)(8,"g")(9,"g"),F(10,"path",6),w()()(),Je(),m(11,"input",7),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(12,"div",8)(13,"div",9)(14,"button",10),H("click",function(){return n.onSortChange("event_start"),n.ascStart=!n.ascStart}),m(15,"div",11),G(16,aee,4,0,"svg",12)(17,lee,4,0,"svg",12),m(18,"p"),_(19,"Date Started"),w()()()(),m(20,"div",9)(21,"button",10),H("click",function(){return n.onSortChange("event_end"),n.ascEnd=!n.ascEnd}),m(22,"div",11),G(23,dee,4,0,"svg",12)(24,cee,4,0,"svg",12),m(25,"p"),_(26,"Date Ended"),w()()()(),m(27,"div",9)(28,"button",10),H("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),m(29,"div",11),G(30,uee,4,0,"svg",12)(31,hee,4,0,"svg",12),m(32,"p"),_(33,"Event Name"),w()()()(),m(34,"div",9)(35,"button",10),H("click",function(){return n.onSortChange("details"),n.ascDetails=!n.ascDetails}),m(36,"div",11),G(37,fee,4,0,"svg",12)(38,pee,4,0,"svg",12),m(39,"p"),_(40,"Details"),w()()()(),m(41,"div",9)(42,"button",10),H("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),m(43,"div",11),G(44,mee,4,0,"svg",12)(45,gee,4,0,"svg",12),m(46,"p"),_(47,"Status"),w()()()(),m(48,"div",11)(49,"div",11)(50,"p"),_(51,"Images"),w()()()(),G(52,vee,3,0,"div",13)(53,bee,14,8,"div",14),m(54,"div",15)(55,"button",16),H("click",function(){return n.prevTransaction()}),_(56," Prev "),w(),m(57,"button",16),H("click",function(){return n.nextTransaction()}),_(58," Next "),w()()()()),t&2&&(C(11),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascStart),C(),k("ngIf",!n.ascStart),C(6),k("ngIf",n.ascEnd),C(),k("ngIf",!n.ascEnd),C(6),k("ngIf",n.ascEvent),C(),k("ngIf",!n.ascEvent),C(6),k("ngIf",n.ascDetails),C(),k("ngIf",!n.ascDetails),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(7),k("ngIf",n.getEventsToDisplay().length==0),C(),k("ngForOf",n.getEventsToDisplay()))},dependencies:[vn,_n,Sn,yn,xt,an,kt,Qr,Kr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var yee=(()=>{class i{_printStyle=[];_styleSheetFile="";setPrintStyle(t){this._printStyle=[];for(let n in t)t.hasOwnProperty(n)&&this._printStyle.push((n+JSON.stringify(t[n])).replace(/['"]+/g,""))}returnStyleValues(){return`<style> ${this._printStyle.join(" ").replace(/,/g,";")} </style>`}returnStyleSheetLinkTags(){return this._styleSheetFile}setStyleSheetFile(t){let n=function(r){return`<link rel="stylesheet" type="text/css" href="${r}">`};if(t.indexOf(",")!==-1){let r=t.split(",");this._styleSheetFile=r.map(s=>n(s)).join("")}else this._styleSheetFile=n(t)}updateInputDefaults(t){for(let n=0;n<t.length;n++){let r=t[n];r.defaultValue=r.value,r.checked&&(r.defaultChecked=!0)}}updateSelectDefaults(t){for(let n=0;n<t.length;n++){let r=t[n],s=r.selectedIndex,o=r.options[s];o.defaultSelected=!0}}updateTextAreaDefaults(t){for(let n=0;n<t.length;n++){let r=t[n];r.defaultValue=r.value}}canvasToImageHtml(t){return`<img src="${t.toDataURL()}" style="max-width: 100%;">`}updateCanvasToImage(t){for(let n=0;n<t.length;n++){let r=this.canvasToImageHtml(t[n]);t[n].insertAdjacentHTML("afterend",r),t[n].remove()}}getHtmlContents(t){let n=document.getElementById(t);if(!n)return null;let r=n.getElementsByTagName("input"),s=n.getElementsByTagName("select"),o=n.getElementsByTagName("textarea"),a=n.getElementsByTagName("canvas");return this.updateInputDefaults(r),this.updateSelectDefaults(s),this.updateTextAreaDefaults(o),this.updateCanvasToImage(a),n.innerHTML}getElementTag(t){let n=[],r=document.getElementsByTagName(t);for(let s=0;s<r.length;s++)n.push(r[s].outerHTML);return n.join(`\r
`)}print(t){let n="",r="",s="top=0,left=0,height=auto,width=auto",o=this.getElementTag("base");t.useExistingCss&&(n=this.getElementTag("style"),r=this.getElementTag("link")),t.openNewTab&&(s="");let a=this.getHtmlContents(t.printSectionId);if(!a){console.error(`Print section with id ${t.printSectionId} not found.`);return}let l=window.open("","_blank",s);if(!l){console.error("Could not open print window.");return}l.document.open(),l.document.write(`
          <html>
            <head>
              <title>${t.printTitle?t.printTitle:""}</title>
              ${o}
              ${this.returnStyleValues()}
              ${this.returnStyleSheetLinkTags()}
              ${n}
              ${r}
            </head>
            <body ${t.bodyClass?`class="${t.bodyClass}"`:""}>
              ${a}
              <script defer>
                function triggerPrint(event) {
                  window.removeEventListener('load', triggerPrint, false);
                  ${t.previewOnly?"":`setTimeout(function() {
                    closeWindow(window.print());
                  }, ${t.printDelay});`}
                }
                function closeWindow(){
                  ${t.closeWindow?"window.close();":""}
                }
                window.addEventListener('load', triggerPrint, false);
              <\/script>
            </body>
          </html>`),l.document.close()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Ee({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var OC=class{printSectionId=null;printTitle=null;useExistingCss=!1;bodyClass="";openNewTab=!1;previewOnly=!1;closeWindow=!0;printDelay=0;constructor(e){e&&Object.assign(this,e)}},zk=(()=>{class i extends yee{printOptions=new OC;set previewOnly(t){this.printOptions=We(ae({},this.printOptions),{previewOnly:t})}set printSectionId(t){this.printOptions=We(ae({},this.printOptions),{printSectionId:t})}set printTitle(t){this.printOptions=We(ae({},this.printOptions),{printTitle:t})}set useExistingCss(t){this.printOptions=We(ae({},this.printOptions),{useExistingCss:t})}set printDelay(t){this.printOptions=We(ae({},this.printOptions),{printDelay:t})}set closeWindow(t){this.printOptions=We(ae({},this.printOptions),{closeWindow:t})}set bodyClass(t){this.printOptions=We(ae({},this.printOptions),{bodyClass:t})}set openNewTab(t){this.printOptions=We(ae({},this.printOptions),{openNewTab:t})}set printStyle(t){super.setPrintStyle(t)}set styleSheetFile(t){super.setStyleSheetFile(t)}print(){super.print(this.printOptions)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Rr(i)))(r||i)}})();static \u0275dir=hn({type:i,selectors:[["button","ngxPrint",""]],hostBindings:function(n,r){n&1&&H("click",function(){return r.print()})},inputs:{previewOnly:"previewOnly",printSectionId:"printSectionId",printTitle:"printTitle",useExistingCss:"useExistingCss",printDelay:"printDelay",closeWindow:"closeWindow",bodyClass:"bodyClass",openNewTab:"openNewTab",printStyle:"printStyle",styleSheetFile:"styleSheetFile"},standalone:!0,features:[Ui]})}return i})(),jk=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({})}return i})();function _ee(i,e){if(i&1&&(m(0,"option",27),_(1),w()),i&2){let t=e.$implicit;k("value",t),C(),ge(t)}}function See(i,e){if(i&1&&(m(0,"option",27),_(1),w()),i&2){let t=e.$implicit;k("value",t),C(),ot(" ",t," ")}}function Eee(i,e){if(i&1&&(m(0,"option",27),_(1),w()),i&2){let t=e.$implicit;k("value",t.event_id),C(),ot(" ",t.event_name," ")}}function Cee(i,e){if(i&1&&(m(0,"div",35)(1,"div",36),_(2),w(),m(3,"div",32),_(4),w()()),i&2){let t=e.$implicit;C(2),ge(t.kiosk_name),C(2),ot("",t.kiosk_description," ")}}function Mee(i,e){if(i&1&&(m(0,"div"),G(1,Cee,5,2,"div",34),w()),i&2){let t=U(2);C(),k("ngForOf",t.eventReportData.slice(0,t.itemsPerPage))}}function Tee(i,e){if(i&1&&(m(0,"div",28)(1,"div",29)(2,"p",30),_(3,"List of Kiosk"),w()(),m(4,"div",31)(5,"div",32),_(6,"Kiosk Name"),w(),m(7,"div",32),_(8,"Description"),w()(),G(9,Mee,2,1,"div",33),w()),i&2){let t=U();C(9),k("ngIf",t.eventReportData.length>0)}}function Iee(i,e){if(i&1&&(m(0,"div",40)(1,"div",32),_(2),w(),m(3,"div",32),_(4),w(),m(5,"div",32),_(6),w()()),i&2){let t=e.$implicit;C(2),ge(t.Company_name),C(2),ge(t.First_name+" "+t.Last_name),C(2),ge(t.kiosk_name)}}function Dee(i,e){if(i&1&&(m(0,"div"),G(1,Iee,7,3,"div",39),w()),i&2){let t=U(2);C(),k("ngForOf",t.businessData.slice(0,t.itemsPerPage))}}function Pee(i,e){if(i&1&&(m(0,"div",28)(1,"div",37)(2,"p",30),_(3,"List of Approved Business"),w()(),m(4,"div",38)(5,"div",32),_(6,"Company"),w(),m(7,"div",32),_(8,"Owner"),w(),m(9,"div",32),_(10,"Kiosk Name"),w()(),G(11,Dee,2,1,"div",33),w()),i&2){let t=U();C(11),k("ngIf",t.businessData.length>0)}}function Ree(i,e){if(i&1&&(m(0,"div",44)(1,"div",42),_(2),w(),m(3,"div",42),_(4),w(),m(5,"div",42),_(6),w(),m(7,"div",42),_(8),w(),m(9,"div",42),_(10),w()()),i&2){let t=e.$implicit,n=U(3);C(2),ot("",n.formatDate(t.date_created)," "),C(2),ot("",t.kiosk_name," "),C(2),ot("",t.First_name+" "+t.Last_name," "),C(2),ge(n.toSentenceCase(t.purpose)),C(2),ge(t.status)}}function Lee(i,e){if(i&1&&(m(0,"div"),G(1,Ree,11,5,"div",43),w()),i&2){let t=U(2);C(),k("ngForOf",t.kioskReportData.slice(0,t.itemsPerPage))}}function kee(i,e){if(i&1&&(m(0,"div",28)(1,"div",37)(2,"p",30),_(3,"List of Kiosk Per Business Owner"),w()(),m(4,"div",41)(5,"div",42),_(6,"Date Created"),w(),m(7,"div",42),_(8,"Kiosk Name"),w(),m(9,"div",42),_(10,"Owner"),w(),m(11,"div",42),_(12,"Purpose"),w(),m(13,"div",42),_(14,"Status"),w()(),G(15,Lee,2,1,"div",33),w()),i&2){let t=U();C(15),k("ngIf",t.kioskReportData.length>0)}}var hx=class i{constructor(e,t){this.adminService=e;this.router=t}eventData=[];userData=[];kioskData=[];eventReportData=[];transactionData=[];businessData=[];kioskReportData=[];finishedTransaction=0;approvedUser=0;activeEvents=0;selectedEventId="";itemsPerPage=5;reportsPage="";reportsOptions=["list of kiosk","list of approved business","list of kiosk per business owner","Show All"];pageOptions=[5,10,15,20];ngOnInit(){if(this.reportsPage=sessionStorage.getItem("reportName")??"",sessionStorage.getItem("reports")!=="1"){this.router.navigate(["/dashboard-admin"]);return}this.loadAllData()}ngDoCheck(){}loadAllData(){il([this.adminService.getEvent(),this.adminService.getTransaction(),this.adminService.getUsers(),this.adminService.getKiosk()]).subscribe(([e,t,n,r])=>{this.eventData=e.map(s=>({event_id:s.event_id,event_name:s.event_name,status:s.status})),this.activeEvents=this.eventData.filter(s=>s.status==="1").length,this.transactionData=t,this.finishedTransaction=this.transactionData.filter(s=>s.status==="finished").length,this.userData=n,this.approvedUser=this.userData.filter(s=>s.status==="1").length,this.kioskData=r},e=>console.error("Error loading data:",e)),this.getBusinessReport(),this.getEventReport(),this.getKioskBusiness()}checkReport(e){let n=e.target.value;sessionStorage.setItem("reportName",n),window.location.reload()}toSentenceCase(e){return!e||typeof e!="string"?"":e.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g,t=>t.toUpperCase())}onEventSelect(e){let n=e.target.value,r=this.eventData.find(s=>s.event_id===n);r?(sessionStorage.setItem("eventIdMap",n),sessionStorage.setItem("eventNameMap",r.event_name),sessionStorage.setItem("eventIdReport",n)):console.log("Event not found."),window.location.reload()}getStoredEventId(){let e=sessionStorage.getItem("eventIdReport");return e?parseInt(e,10):null}getBusinessReport(){let e=this.getStoredEventId();e&&this.adminService.getBusinessReport(e).subscribe(t=>{this.businessData=t})}getKioskBusiness(){let e=this.getStoredEventId();e&&this.adminService.getKioskReport(e).subscribe(t=>{this.kioskReportData=t})}getEventReport(){let e=this.getStoredEventId();e&&this.adminService.getEventsReport(e).subscribe(t=>{this.eventReportData=t})}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(){return sessionStorage.getItem("eventNameMap")??"Select events"}getReportName(){return sessionStorage.getItem("reportName")??"Select reports"}static \u0275fac=function(t){return new(t||i)(se(cn),se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-admin-reports"]],standalone:!0,features:[gt],decls:60,vars:14,consts:[[1,"w-screen","md:w-full","h-full","md:px-2"],[1,"w-full","bg-customDarkGreen","h-full","p-2","md:rounded-xl","shadow-md","shadow-green-900"],[1,"h-full","w-full","flex","justify-between"],[1,"text-gray-50","text-3xl","font-semibold"],[1,"grid","grid-cols-4","h-full","w-full","mt-4","gap-x-2","font-semibold"],[1,"bg-[#40916c]","text-[11px]","md:text-lg","justify-center","w-full","h-20","p-2","grid","rounded-lg"],[1,"text-center","text-gray-50","leading-none"],[1,"flex","justify-center","align-center","text-gray-50"],[1,"w-full","bg-gray-50","h-full"],[1,"absolute","flex","justify-end","align-end","top-[17rem]","right-12"],["printSectionId","print-section","ngxPrint","",1,"flex","justify-center","align-center","pt-1","h-8","w-8","bg-green-600","rounded-md","hover:bg-green-700",3,"useExistingCss"],["width","24px","height","24px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M17 7H7V6h10v1zm0 12H7v-6h10v6zm2-12V3H5v4H1v8.996C1 17.103 1.897 18 3.004 18H5v3h14v-3h1.996A2.004 2.004 0 0 0 23 15.996V7h-4z","fill","white"],[1,"bg-customDarkGreen","md:rounded-xl","shadow-md","shadow-green-900","px-4","pt-8","md:p-8","p-2","mt-2"],[1,"h-full","w-full","flex-col","my-2"],[1,"text-gray-50","text-left","md:text-center","text-3xl","font-semibold"],[1,"w-full","flex","justify-between","align-center","mt-4"],[1,"w-32","flex-col","justify-center","align-center","text-gray-700","pr-2"],["for","itemsPerPage",1,"text-gray-50","pr-2","pt-2"],["id","itemsPerPage",1,"border","border-gray-300","outline-none","rounded-md","shadow-sm","w-full","px-3","py-2","text-sm","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"text-gray-50","pr-2","pt-2"],[1,"border","border-gray-300","outline-none","rounded-md","shadow-sm","w-full","px-3","py-2","text-sm","focus:ring-indigo-500","focus:border-indigo-500",3,"change"],["value","","selected",""],["id","eventSelect",1,"border","border-gray-300","outline-none","rounded-md","shadow-sm","w-full","px-3","py-2","text-sm","focus:ring-indigo-500","focus:border-indigo-500",3,"change"],["id","print-section",1,"grid","grid-cols-1","h-full","w-full","gap-x-2","gap-y-2","mt-2"],["class","bg-customDarkGreen  md:rounded-xl shadow-md shadow-green-900 px-4 md:p-8 p-2",4,"ngIf"],[3,"value"],[1,"bg-customDarkGreen","md:rounded-xl","shadow-md","shadow-green-900","px-4","md:p-8","p-2"],[1,"text-2xl","text-gray-50","flex","align-center","text-center","font-semibold","justify-center","p-2"],[1,"leading-none"],[1,"grid","grid-cols-2","text-lg","text-gray-50","mt-2","font-semibold","py-2","border-y-2"],[1,"flex","justify-center","items-center","w-full","h-full"],[4,"ngIf"],["class","grid grid-cols-2 text-gray-50 leading-none mt-2 py-2 border-b-2",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","text-gray-50","leading-none","mt-2","py-2","border-b-2"],[1,"flex","justify-center","items-center","w-full","h-full","text-lg","md:text-md"],[1,"text-2xl","text-gray-50","text-center","font-semibold","flex","justify-center","p-2"],[1,"grid","grid-cols-3","text-lg","text-gray-50","mt-2","font-semibold","py-2","border-y-2"],["class","grid grid-cols-3 text-gray-50 leading-none mt-[10px] py-2 border-b-2 h-24",4,"ngFor","ngForOf"],[1,"grid","grid-cols-3","text-gray-50","leading-none","mt-[10px]","py-2","border-b-2","h-24"],[1,"grid","grid-cols-5","gap-x-2","text-sm","md:text-lg","text-gray-50","mt-4","font-semibold","py-2","border-y-2"],[1,"flex","justify-center","items-center","w-full","h-full","leading-none"],["class","grid grid-cols-5 gap-x-2 text-gray-50 text-xs md:text-md leading-none mt-[10px] py-2 border-b-2 h-24",4,"ngFor","ngForOf"],[1,"grid","grid-cols-5","gap-x-2","text-gray-50","text-xs","md:text-md","leading-none","mt-[10px]","py-2","border-b-2","h-24"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),_(4,"General Report"),w()(),F(5,"hr"),m(6,"div",4)(7,"div",5)(8,"p",6),_(9,"Total Approved Users"),w(),m(10,"p",7),_(11),w()(),m(12,"div",5)(13,"p",6),_(14,"Total Active Events"),w(),m(15,"p",7),_(16),w()(),m(17,"div",5)(18,"p",6),_(19,"Total Kiosks"),w(),m(20,"p",7),_(21),w()(),m(22,"div",5)(23,"p",6),_(24,"Total Paid Transactions"),w(),m(25,"p",7),_(26),w()()()(),m(27,"div",8)(28,"div",9)(29,"button",10),ie(),m(30,"svg",11),F(31,"path",12),w()()(),Je(),m(32,"div",13)(33,"div",14)(34,"p",15),_(35,"Reports Per Event"),w(),m(36,"div",16)(37,"div",17)(38,"label",18),_(39,"Items: "),w(),m(40,"select",19),Ye("ngModelChange",function(s){return Xe(n.itemsPerPage,s)||(n.itemsPerPage=s),s}),G(41,_ee,2,2,"option",20),w()(),m(42,"div",17)(43,"label",21),_(44,"Reports: "),w(),m(45,"select",22),H("change",function(s){return n.checkReport(s)}),m(46,"option",23),_(47),w(),G(48,See,2,2,"option",20),w()(),m(49,"div",17)(50,"label",18),_(51,"Events: "),w(),m(52,"select",24),H("change",function(s){return n.onEventSelect(s)}),m(53,"option",23),_(54),w(),G(55,Eee,2,2,"option",20),w()()()()(),m(56,"div",25),G(57,Tee,10,1,"div",26)(58,Pee,12,1,"div",26)(59,kee,16,1,"div",26),w()()()),t&2&&(C(11),ge(n.approvedUser),C(5),ge(n.activeEvents),C(5),ge(n.kioskData.length),C(5),ge(n.finishedTransaction),C(3),k("useExistingCss",!0),C(11),Ze("ngModel",n.itemsPerPage),C(),k("ngForOf",n.pageOptions),C(6),ge(n.getReportName()),C(),k("ngForOf",n.reportsOptions),C(6),ge(n.getEventName()),C(),k("ngForOf",n.eventData),C(2),k("ngIf",n.reportsPage=="list of kiosk"||n.reportsPage==="Show All"),C(),k("ngIf",n.reportsPage=="list of approved business"||n.reportsPage==="Show All"),C(),k("ngIf",n.reportsPage=="list of kiosk per business owner"||n.reportsPage==="Show All"))},dependencies:[vn,Us,Hs,Ta,Sn,yn,xt,an,kt,jk,zk],styles:["@media print{body[_ngcontent-%COMP%], *[_ngcontent-%COMP%]{color:#000!important}}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var Gk=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500":!0});function Nee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Fee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Oee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Bee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Vee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Uee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Hee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function zee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function jee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Gee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Wee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function qee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Zee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Yee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Xee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",22)(2,"line",23)(3,"line",24),w())}function Qee(i,e){i&1&&(ie(),m(0,"svg",21),F(1,"path",25)(2,"line",26)(3,"line",27),w())}function Kee(i,e){i&1&&(m(0,"div",28)(1,"div",29),_(2,"No results found"),w()())}function Jee(i,e){i&1&&(m(0,"p"),_(1,"pending"),w())}function $ee(i,e){i&1&&(m(0,"p"),_(1,"approved"),w())}function ete(i,e){i&1&&(m(0,"p"),_(1,"denied"),w())}function tte(i,e){if(i&1&&(m(0,"option",41),_(1),w()),i&2){let t=e.$implicit;k("ngClass",Mi(3,Gk))("value",t.value),C(),ot(" ",t.label," ")}}function nte(i,e){if(i&1&&(m(0,"option",41),_(1),w()),i&2){let t=e.$implicit;k("ngClass",Mi(3,Gk))("value",t),C(),ot(" ",t," ")}}function ite(i,e){if(i&1){let t=Ve();m(0,"div",30)(1,"div",31),_(2),w(),m(3,"div",32),_(4),w(),m(5,"div",32),_(6),w(),m(7,"div",33),_(8),w(),m(9,"div",32),_(10),w(),m(11,"div",32),_(12),w(),m(13,"div",32)(14,"select",34),H("change",function(r){let s=$(t).$implicit,o=U();return ee(o.onStatusChange(r,s.user_info_id,s.Email))}),m(15,"option",35),G(16,Jee,2,0,"p",36)(17,$ee,2,0,"p",36)(18,ete,2,0,"p",36),w(),G(19,tte,2,4,"option",37),w()(),m(20,"div",38)(21,"select",39),H("change",function(r){let s=$(t).$implicit,o=U();return ee(o.onUserTypeChange(r,s.user_info_id))}),m(22,"option",40),_(23),w(),G(24,nte,2,4,"option",37),w()()()}if(i&2){let t=e.$implicit,n=U();C(2),ot("",n.formatDate(t.date_registered)," "),C(2),ge(t.First_name),C(2),ge(t.Last_name),C(2),ge(t.Email),C(2),ge(t["Contact#"]),C(2),ge(t.Company_name),C(4),k("ngIf",t.status==0),C(),k("ngIf",t.status==1),C(),k("ngIf",t.status==2),C(),k("ngForOf",n.statusOptions),C(4),ot(" ",t.User_type," "),C(),k("ngForOf",n.userTypeOptions)}}var fx=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascFName=!1;ascLName=!1;ascCompany=!1;ascEmail=!1;ascContact="";ascStatus=!1;ascUserType=!1;ascDate=!1;ascUsername=!1;referenceNumber=!1;formId="";errorMessage="";contact="Contact#";viewPdf=!1;statusOptions=[{value:0,label:"Pending"},{value:1,label:"Approved"},{value:2,label:"Denied"}];userTypeOptions=["user","admin","EX-Director","IGP"];pdfError=!1;pdfUrl="";selectedOption="";selectedUserType="";onUserTypeChange(e,t){this.selectedUserType=e.target.value,console.log(this.selectedUserType),this.adminService.updateUserType(this.selectedUserType,t).subscribe(n=>{n.success&&window.location.reload()})}onStatusChange(e,t,n){this.selectedOption=e.target.value,console.log(this.selectedOption),this.adminService.updateUserStatus(this.selectedOption,t).subscribe(r=>{if(r.success&&(this.selectedOption=="1"||this.selectedOption=="2")){let s="";this.selectedOption=="1"?s="Approved":s="Denied",ps.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:n,status:s,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(o=>{console.log("Email sent successfully!",o.text),window.location.reload()})}})}getUser(){this.adminService.getUsers().subscribe(e=>{this.userData=e})}viewPdfFile(e){let t="dbAssets/userImages/"+e;this.viewPdf=!0,console.log(this.pdfUrl),this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t)}onPdfError(){this.pdfError=!0}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}toLowerCaseSafe(e){return e?e.toLowerCase():""}getUserToDisplay(){let e=this.userData.filter(r=>this.toLowerCaseSafe(this.formatDate(r.date_registered)).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.First_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Last_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.contact+"#").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Email).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Company_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.User_type).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userData.length&&(console.log(this.userData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.firstName=sessionStorage.getItem("firstName")??"",this.lastName=sessionStorage.getItem("lastName")??"",this.eventService.downloadForm(e,this.firstName,this.lastName)}ngOnInit(){sessionStorage.getItem("settings")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getUser()}static \u0275fac=function(t){return new(t||i)(se(ds),se(Qe),se(Xn),se(ci),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-user-manage"]],standalone:!0,features:[gt],decls:76,vars:19,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1","overflow-hidden"],[1,"text-gray-700","text-3xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-md","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","grid-cols-9","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[7px]","md:text-sm","leading-none","text-md","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","px-2","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","class","svgTable","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"border-r-2","border-green-900","px-2","flex","justify-center","items-center"],[1,"border-r-2","col-span-2","border-green-900","px-2","flex","justify-center","items-center"],[1,"block",3,"click"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],["class","grid grid-cols-7 overflow-hidden bg-customDarkGreen border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngIf"],["class"," grid grid-cols-9 text-[6px] md:text-xs overflow-hidden bg-customDarkGreen text-xs  border-gray-50 border-b-[3px] text-left w-full h-full px-3 md:px-2 py-2  font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"svgTable"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-7","overflow-hidden","bg-customDarkGreen","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-md","col-span-7","md:text-lg","flex","justify-center","items-center"],[1,"grid","grid-cols-9","text-[6px]","md:text-xs","overflow-hidden","bg-customDarkGreen","text-xs","border-gray-50","border-b-[3px]","text-left","w-full","h-full","px-3","md:px-2","py-2","font-semibold","text-gray-200"],[1,"flex","justify-start","items-center","text-[6px]","md:text-xs","leading-none"],[1,"flex","justify-center","items-center","text-[6px]","md:text-xs","mx-2","leading-none"],[1,"flex","justify-center","col-span-2","text-[6px]","md:text-xs","items-center","mx-2","leading-none"],["id","dropdown",1,"bg-customDarkGreen","border-none","text-[6px]","md:text-xs","outline-none",3,"change"],["disabled","","selected","",3,"value"],[4,"ngIf"],["class","bg-customDarkGreen rounded-md",3,"ngClass","value",4,"ngFor","ngForOf"],[1,"flex","text-[6px]","md:text-xs","justify-center","items-center"],["id","dropdown",1,"bg-customDarkGreen","border-none","outline-none",3,"change"],["selected",""],[1,"bg-customDarkGreen","rounded-md",3,"ngClass","value"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),_(5," User Management:"),w()(),m(6,"div",4),ie(),m(7,"svg",5)(8,"g")(9,"g"),F(10,"path",6),w()()(),Je(),m(11,"input",7),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(12,"div",8)(13,"div",9)(14,"button",10),H("click",function(){return n.onSortChange("date_registered"),n.ascDate=!n.ascDate}),m(15,"div",11),G(16,Nee,4,0,"svg",12)(17,Fee,4,0,"svg",12),m(18,"p"),_(19,"Date"),w()()()(),m(20,"div",13)(21,"button",10),H("click",function(){return n.onSortChange("First_name"),n.ascFName=!n.ascFName}),m(22,"div",11),G(23,Oee,4,0,"svg",12)(24,Bee,4,0,"svg",12),m(25,"p"),_(26,"Name"),w()()()(),m(27,"div",13)(28,"button",10),H("click",function(){return n.onSortChange("Last_name"),n.ascLName=!n.ascLName}),m(29,"div",11),G(30,Vee,4,0,"svg",12)(31,Uee,4,0,"svg",12),m(32,"p"),_(33,"Surname"),w()()()(),m(34,"div",14)(35,"button",15),H("click",function(){return n.onSortChange("Email"),n.ascEmail=!n.ascEmail}),m(36,"div",11),G(37,Hee,4,0,"svg",12)(38,zee,4,0,"svg",12),m(39,"p"),_(40,"Email"),w()()()(),m(41,"div",9)(42,"button",10),H("click",function(){return n.onSortChange("Contact#"),n.ascStatus=!n.ascStatus}),m(43,"div",11),G(44,jee,4,0,"svg",12)(45,Gee,4,0,"svg",12),m(46,"p"),_(47,"Contact"),w()()()(),m(48,"div",16)(49,"button",10),H("click",function(){return n.onSortChange("Company_name"),n.ascCompany=!n.ascCompany}),m(50,"div",11),G(51,Wee,4,0,"svg",12)(52,qee,4,0,"svg",12),m(53,"p"),_(54,"Company"),w()()()(),m(55,"div",16)(56,"button",10),H("click",function(){return n.onSortChange("Status"),n.ascStatus=!n.ascStatus}),m(57,"div",11),G(58,Zee,4,0,"svg",12)(59,Yee,4,0,"svg",12),m(60,"p"),_(61,"Status"),w()()()(),m(62,"div",11)(63,"button",10),H("click",function(){return n.onSortChange("User_type"),n.ascUserType=!n.ascUserType}),m(64,"div",11),G(65,Xee,4,0,"svg",12)(66,Qee,4,0,"svg",12),m(67,"p"),_(68,"User type"),w()()()()(),G(69,Kee,3,0,"div",17)(70,ite,25,12,"div",18),m(71,"div",19)(72,"button",20),H("click",function(){return n.prevTransaction()}),_(73," Prev "),w(),m(74,"button",20),H("click",function(){return n.nextTransaction()}),_(75," Next "),w()()()()),t&2&&(C(11),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascDate),C(),k("ngIf",!n.ascDate),C(6),k("ngIf",n.ascFName),C(),k("ngIf",!n.ascFName),C(6),k("ngIf",n.ascLName),C(),k("ngIf",!n.ascLName),C(6),k("ngIf",n.ascEmail),C(),k("ngIf",!n.ascEmail),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(6),k("ngIf",n.ascCompany),C(),k("ngIf",!n.ascCompany),C(6),k("ngIf",n.ascStatus),C(),k("ngIf",!n.ascStatus),C(6),k("ngIf",n.ascUserType),C(),k("ngIf",!n.ascUserType),C(3),k("ngIf",n.getUserToDisplay().length==0),C(),k("ngForOf",n.getUserToDisplay()))},dependencies:[vn,Us,Hs,_n,Sn,yn,xt,Ji,an,kt,Qr,Kr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.svgTable[_ngcontent-%COMP%]{height:.75rem;width:.75rem}@media (min-width: 768px){.svgTable[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem}}"]})};function rte(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function ste(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function ote(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",18)(2,"line",19)(3,"line",20),w())}function ate(i,e){i&1&&(ie(),m(0,"svg",17),F(1,"path",21)(2,"line",22)(3,"line",23),w())}function lte(i,e){if(i&1){let t=Ve();m(0,"div",24)(1,"div",25),_(2),w(),m(3,"div",26),_(4),w(),m(5,"div",11)(6,"label",27)(7,"input",28),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_events,r)||(s.access_permissions_events=r),ee(r)}),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"events",r.access_permissions_events))}),w(),m(8,"span",29),ie(),m(9,"svg",30),F(10,"path",31),w()()()(),Je(),m(11,"div",11)(12,"label",27)(13,"input",32),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"transactions",r.access_permissions_transactions))}),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_transactions,r)||(s.access_permissions_transactions=r),ee(r)}),w(),m(14,"span",29),ie(),m(15,"svg",30),F(16,"path",31),w()()()(),Je(),m(17,"div",11)(18,"label",27)(19,"input",32),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"reports",r.access_permissions_reports))}),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_reports,r)||(s.access_permissions_reports=r),ee(r)}),w(),m(20,"span",29),ie(),m(21,"svg",30),F(22,"path",31),w()()()(),Je(),m(23,"div",11)(24,"label",27)(25,"input",32),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"user_settings",r.access_permissions_user_settings))}),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_user_settings,r)||(s.access_permissions_user_settings=r),ee(r)}),w(),m(26,"span",29),ie(),m(27,"svg",30),F(28,"path",31),w()()()(),Je(),m(29,"div",11)(30,"label",27)(31,"input",32),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"access_control",r.access_permissions_access_control))}),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_access_control,r)||(s.access_permissions_access_control=r),ee(r)}),w(),m(32,"span",29),ie(),m(33,"svg",30),F(34,"path",31),w()()()(),Je(),m(35,"div",11)(36,"label",27)(37,"input",32),H("change",function(){let r=$(t).$implicit,s=U();return ee(s.onPermissionChange(r.user_info_id,"history",r.access_permissions_history))}),Ye("ngModelChange",function(r){let s=$(t).$implicit;return Xe(s.access_permissions_history,r)||(s.access_permissions_history=r),ee(r)}),w(),m(38,"span",29),ie(),m(39,"svg",30),F(40,"path",31),w()()()()()}if(i&2){let t=e.$implicit;C(2),ge(t.First_name+" "+t.Last_name),C(2),ge(t.User_type),C(3),Ze("ngModel",t.access_permissions_events),C(6),Ze("ngModel",t.access_permissions_transactions),C(6),Ze("ngModel",t.access_permissions_reports),C(6),Ze("ngModel",t.access_permissions_user_settings),C(6),Ze("ngModel",t.access_permissions_access_control),C(6),Ze("ngModel",t.access_permissions_history)}}var px=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascDate=!1;ascType=!1;getUser(){this.adminService.getUsers().subscribe(e=>{this.userData=e.filter(t=>t.User_type!=="user")})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onPermissionChange(e,t,n){console.log(n),this.adminService.userControl(e,t,n).subscribe({next:r=>{console.log(r)}})}toLowerCaseSafe(e){return e?e.toLowerCase():""}getUserToDisplay(){let e=this.userData.filter(r=>this.toLowerCaseSafe(r.First_name).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userData.length&&(console.log(this.userData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}ngOnInit(){sessionStorage.getItem("control")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getUser()}static \u0275fac=function(t){return new(t||i)(se(ds),se(Qe),se(Xn),se(ci),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-user-control"]],standalone:!0,features:[gt],decls:45,vars:6,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","px-1","overflow-hidden"],[1,"text-gray-700","text-3xl","font-bold","md:col-span-1","col-span-3","flex","items-center"],[1,"col-span-3","md:col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-md","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","grid-cols-8","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[8px]","md:text-[14px]","leading-none","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","py-4","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],["class"," grid grid-cols-8  overflow-hidden bg-customDarkGreen leading-none text-[10px] md:text-md border-gray-50 border-b-[3px] text-left w-full h-full px-3 md:px-2 py-2  font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-8","overflow-hidden","bg-customDarkGreen","leading-none","text-[10px]","md:text-md","border-gray-50","border-b-[3px]","text-left","w-full","h-full","px-3","md:px-2","py-2","font-semibold","text-gray-200"],[1,"flex","justify-center","text-center","items-center","leading-none","px-2"],[1,"flex","justify-center","items-center","leading-none","px-2"],[1,"flex","items-center","cursor-pointer","relative"],["type","checkbox",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-slate-300","checked:bg-green-600","checked:border-green-600",3,"ngModelChange","change","ngModel"],[1,"absolute","text-white","opacity-0","peer-checked:opacity-100","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","stroke","currentColor","stroke-width","1",1,"h-3.5","w-3.5"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["type","checkbox",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-slate-300","checked:bg-green-600","checked:border-green-600",3,"change","ngModelChange","ngModel"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),_(5," User Control:"),w()(),m(6,"div",4),ie(),m(7,"svg",5)(8,"g")(9,"g"),F(10,"path",6),w()()(),Je(),m(11,"input",7),Ye("ngModelChange",function(s){return Xe(n.searchText,s)||(n.searchText=s),s}),H("ngModelChange",function(s){return n.onSearchChange(s)}),w()()(),m(12,"div",8)(13,"div",9)(14,"button",10),H("click",function(){return n.onSortChange("Firs_name"),n.ascDate=!n.ascDate}),m(15,"div",11),G(16,rte,4,0,"svg",12)(17,ste,4,0,"svg",12),m(18,"p"),_(19,"Name"),w()()()(),m(20,"div",9)(21,"button",10),H("click",function(){return n.onSortChange("User_type"),n.ascType=!n.ascType}),m(22,"div",11),G(23,ote,4,0,"svg",12)(24,ate,4,0,"svg",12),m(25,"p"),_(26,"Type"),w()()()(),m(27,"div",13),_(28,"Access Events"),w(),m(29,"div",13),_(30,"Access Transactions"),w(),m(31,"div",13),_(32,"Access Reports"),w(),m(33,"div",13),_(34,"Access History"),w(),m(35,"div",13),_(36,"Access Users"),w(),m(37,"div",11),_(38,"Access Control"),w()(),G(39,lte,41,8,"div",14),m(40,"div",15)(41,"button",16),H("click",function(){return n.prevTransaction()}),_(42," Prev "),w(),m(43,"button",16),H("click",function(){return n.nextTransaction()}),_(44," Next "),w()()()()),t&2&&(C(11),Ze("ngModel",n.searchText),C(5),k("ngIf",n.ascDate),C(),k("ngIf",!n.ascDate),C(6),k("ngIf",n.ascType),C(),k("ngIf",!n.ascType),C(15),k("ngForOf",n.getUserToDisplay()))},dependencies:[vn,_n,v1,Sn,yn,xt,an,kt,Qr,Kr],styles:["label[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:16px}.checked-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#4caf50;border-color:#4caf50}input[type=checkbox][_ngcontent-%COMP%]:checked{border-color:#4caf50}.checked-checkbox[_ngcontent-%COMP%]{color:#4caf50}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var mx=class i{constructor(e){this.router=e}ngOnInit(){window.location.assign("http://kmv-portfolio.web.app/")}static \u0275fac=function(t){return new(t||i)(se(Qe))};static \u0275cmp=ft({type:i,selectors:[["app-owner"]],standalone:!0,features:[gt],decls:0,vars:0,template:function(t,n){},dependencies:[xt]})};var BC=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"transaction",component:j0,canActivate:[xh]},{path:"map-viewer",component:U0,canActivate:[G0]},{path:"login",component:fg,canActivate:[wh]},{path:"register",component:xg,canActivate:[wh]},{path:"dashboard",component:rg,canActivate:[xh]},{path:"dashboard-admin",component:Z0,canActivate:[Zr]},{path:"transaction-admin",component:ax,canActivate:[Zr]},{path:"application-form",component:z0,canActivate:[W0]},{path:"manage-events",component:lx,canActivate:[Zr]},{path:"add-events",component:dx,canActivate:[Zr]},{path:"history",component:ux,canActivate:[Zr]},{path:"reports",component:hx,canActivate:[Zr]},{path:"manage-user",component:fx,canActivate:[Zr]},{path:"user-control",component:px,canActivate:[Zr]},{path:"map-viewer-admin",component:cx,canActivate:[Zr]},{path:"owner",component:mx},{path:"**",redirectTo:"/login",pathMatch:"full"}],Wk=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({imports:[rh.forRoot(BC,{useHash:!1}),rh]})};var dte=["sidebar"],cte=["button"],ute=["notifer"],hte=["notifyButton"],fte=["dropper"],pte=["drop"],mte=(i,e)=>({"animate-slide-in-right":i,"animate-slide-in-left":e}),qk=()=>({exact:!0});function gte(i,e){i&1&&F(0,"div",18)}function vte(i,e){if(i&1&&(m(0,"span"),_(1),w()),i&2){let t=U(3);C(),ge(t.getUnreadCount())}}function xte(i,e){i&1&&F(0,"img",36)}function wte(i,e){i&1&&(m(0,"span"),_(1,"..."),w())}function bte(i,e){i&1&&(ie(),m(0,"svg",37),F(1,"path",38),w())}function yte(i,e){i&1&&(ie(),m(0,"svg",37),F(1,"path",39),w())}function Ate(i,e){if(i&1){let t=Ve();m(0,"div",19)(1,"div",20)(2,"button",21,0),H("click",function(){$(t);let r=U(2);return ee(r.toggleSide())}),ie(),m(4,"svg",22),F(5,"path",23),w()(),Je(),m(6,"img",24),H("click",function(){$(t);let r=U(2);return ee(r.refreshPage())}),w(),m(7,"h1",25),_(8,"Chmsu-A mAPP"),w()(),m(9,"div",26)(10,"button",27,1),H("click",function(){$(t);let r=U(2);return ee(r.toggleNotificationBar())}),ie(),m(12,"svg",28),F(13,"path",29),w(),Je(),m(14,"p",30),G(15,vte,2,1,"span",31),w()(),m(16,"div",32)(17,"div"),G(18,xte,1,0,"img",33),w(),m(19,"button",34,2),H("click",function(){$(t);let r=U(2);return ee(r.toggleSettings())}),_(21),Ti(22,"slice"),G(23,wte,2,0,"span",31),m(24,"span"),G(25,bte,2,0,"svg",35)(26,yte,2,0,"svg",35),w()()()()()}if(i&2){let t=e.$implicit,n=U(2);C(15),k("ngIf",n.notification),C(3),k("ngIf",!t.profile_image),C(3),ot(" ",Hi(22,6,t.First_name,0,6),""),C(2),k("ngIf",t.First_name.length>6),C(2),k("ngIf",n.isDropped),C(),k("ngIf",!n.isDropped)}}function _te(i,e){i&1&&F(0,"img",64)}function Ste(i,e){if(i&1){let t=Ve();m(0,"div",42)(1,"div",43),G(2,_te,1,0,"img",44),w(),m(3,"div",45),_(4),w(),m(5,"div",46),_(6),w(),F(7,"hr",47),m(8,"a",48)(9,"span",49),ie(),m(10,"svg",50),F(11,"path",51)(12,"path",52),w()(),_(13," Dashboard "),w(),Je(),m(14,"a",53)(15,"span",49),ie(),m(16,"svg",54),F(17,"path",55),w()(),_(18," Transaction "),w(),Je(),m(19,"a",56)(20,"span",49),ie(),m(21,"svg",57)(22,"g",58)(23,"g",59)(24,"g",60),F(25,"path",61),w()()()()(),_(26,"Profile"),w(),Je(),m(27,"a",62)(28,"span",49),ie(),m(29,"svg",57)(30,"g",58)(31,"g",59)(32,"g",60),F(33,"path",61),w()()()()(),_(34,"Notification"),w(),Je(),m(35,"a",63),H("click",function(){$(t);let r=U(3);return ee(r.logOut=!0)}),m(36,"span",49),ie(),m(37,"svg",28),F(38,"path",29),w()(),_(39,"logout"),w()()}if(i&2){let t=e.$implicit;C(2),k("ngIf",!t.profile_image),C(2),ge(t.First_name+" "+t.Last_name),C(2),ge(t.Username),C(2),k("routerLinkActiveOptions",Mi(4,qk))}}function Ete(i,e){if(i&1&&(m(0,"div",40,3),G(2,Ste,40,5,"div",41),w()),i&2){let t=U(2);k("ngClass",wm(2,mte,t.toggleSidebar,!t.toggleSidebar)),C(2),k("ngForOf",t.userData)}}function Cte(i,e){i&1&&(m(0,"div",73)(1,"div",74),_(2,"No new notifications"),w()())}function Mte(i,e){if(i&1){let t=Ve();m(0,"button",81),H("click",function(){$(t);let r=U(2).$implicit,s=U(3);return ee(s.readMessage(r.notification_id,"read"))}),_(1,"Read"),w()}}function Tte(i,e){if(i&1&&(m(0,"div",77)(1,"div",78),_(2),w(),m(3,"div",79)(4,"p"),_(5),w(),G(6,Mte,2,0,"button",80),w()()),i&2){let t=U().$implicit,n=U(3);C(2),ge(t.message),C(3),ge(n.formatDate(t.date_created)),C(),k("ngIf",t.status=="unread")}}function Ite(i,e){if(i&1&&(m(0,"div")(1,"div",75),G(2,Tte,7,3,"div",76),w()()),i&2){let t=e.$implicit;C(2),k("ngIf",t.status=="unread")}}function Dte(i,e){if(i&1&&(m(0,"div",73)(1,"div",82),_(2),w(),m(3,"div",83),_(4),w()()),i&2){let t=U().$implicit,n=U(3);C(2),ge(t.message),C(2),ge(n.formatDate(t.date_created))}}function Pte(i,e){if(i&1&&(m(0,"div"),G(1,Dte,5,2,"div",71),w()),i&2){let t=e.$implicit;C(),k("ngIf",t.status=="read")}}function Rte(i,e){if(i&1&&(m(0,"div",65,4)(2,"div",66),F(3,"div",67),m(4,"div",68)(5,"div",69)(6,"div",70),_(7,"Unread Messages:"),w(),F(8,"hr"),G(9,Cte,3,0,"div",71)(10,Ite,3,1,"div",72),m(11,"div",70),_(12,"Read Messages:"),w(),F(13,"hr"),G(14,Pte,2,1,"div",72),w()()()()),i&2){let t=U(2);C(9),k("ngIf",!t.hasUnreadMessages()),C(),k("ngForOf",t.notification),C(4),k("ngForOf",t.notification)}}function Lte(i,e){if(i&1){let t=Ve();m(0,"div",86),F(1,"div",87),m(2,"div",88)(3,"div",42)(4,"div",89),_(5),w(),m(6,"div",90),_(7),w(),F(8,"hr"),m(9,"a",91)(10,"span",49),ie(),m(11,"svg",50),F(12,"path",51)(13,"path",52),w()(),_(14," Dashboard "),w(),Je(),m(15,"a",53)(16,"span",49),ie(),m(17,"svg",54),F(18,"path",55),w()(),_(19," Transaction "),w(),Je(),m(20,"a",56)(21,"span",49),ie(),m(22,"svg",57)(23,"g",58)(24,"g",59)(25,"g",60),F(26,"path",61),w()()()()(),_(27," Profile "),w(),Je(),m(28,"a",92),H("click",function(){$(t);let r=U(3);return ee(r.logOut=!0)}),m(29,"span",49),ie(),m(30,"svg",93),F(31,"path",94)(32,"path",95)(33,"path",96),w()(),_(34," logout "),w()()()()}if(i&2){let t=e.$implicit;C(5),ge(t.First_name+" "+t.Last_name),C(2),ge(t.Username),C(2),k("routerLinkActiveOptions",Mi(3,qk))}}function kte(i,e){if(i&1&&(m(0,"div",84,5),G(2,Lte,35,4,"div",85),w()),i&2){let t=U(2);C(2),k("ngForOf",t.userData)}}function Nte(i,e){i&1&&(m(0,"div",97),F(1,"div",98),m(2,"p",99),_(3,"loading..."),w()())}function Fte(i,e){i&1&&F(0,"div",100)}function Ote(i,e){if(i&1){let t=Ve();m(0,"div",101)(1,"div",102)(2,"div",103)(3,"p",104),_(4," Are you sure you want to log out? "),w(),m(5,"div",105)(6,"button",106),H("click",function(){$(t);let r=U(2);return ee(r.logOut=!r.logOut)}),_(7," Cancel "),w(),m(8,"button",107),H("click",function(){$(t);let r=U(2);return ee(r.logout())}),_(9," Logout "),w()()()()()}}function Bte(i,e){if(i&1&&(m(0,"div",7)(1,"div",8),G(2,gte,1,0,"div",9),w(),G(3,Ate,27,10,"div",10)(4,Ete,3,5,"div",11),m(5,"div",12),G(6,Rte,15,3,"div",13)(7,kte,3,1,"div",14),w(),G(8,Nte,4,0,"div",15)(9,Fte,1,0,"div",16)(10,Ote,10,0,"div",17),w()),i&2){let t=U();C(2),k("ngIf",t.userData.length==0),C(),k("ngForOf",t.userData),C(),k("ngIf",t.toggleSidebar),C(2),k("ngIf",t.toggleNotification),C(),k("ngIf",t.isDropped),C(),k("ngIf",t.loading),C(),k("ngIf",t.logOut==!0),C(),k("ngIf",t.logOut==!0)}}var gx=class i{constructor(e,t,n){this.router=e;this.renderer=t;this.userService=n}notification=[];showNotification=!1;loading=!1;toggleSidebar=!1;toggleNotification=!1;userData=[];userType="";logOut=!1;sidebar;button;notifer;notifyButton;dropper;drop;open=!1;isDropped=!1;ngAfterViewInit(){this.renderer.listen("document","click",e=>this.onClickOutside(e))}sortNotifications(e){return e.sort((t,n)=>t.status==="read"&&n.status!=="read"?-1:t.status!=="read"&&n.status==="read"?1:0)}getUnreadCount(){return this.notification.reduce((e,t)=>t.status==="unread"?e+1:e,0)}refreshPage(){window.location.reload()}hasUnreadMessages(){return this.notification.some(e=>e.status==="unread")}isLastUnread(){return this.notification.map((t,n)=>t.status==="unread"?n:-1).filter(t=>t!==-1).pop()===this.notification.length-1}toggleSettings(){this.isDropped=!this.isDropped}readMessage(e,t){this.userService.updateMessage(e,t).subscribe(n=>{n.success==!0&&this.refreshPage()})}logout(){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("tokenId",""),this.router.navigate(["/login"]).then(()=>{window.location.reload()})},200)}toggleSide(){this.toggleSidebar=!this.toggleSidebar}toggleNotificationBar(){this.toggleNotification=!this.toggleNotification}onClickOutside(e){this.sidebar&&!this.sidebar.nativeElement.contains(e.target)&&!this.button.nativeElement.contains(e.target)&&this.toggleSidebar==!0?this.toggleSidebar=!1:e.stopPropagation(),this.notifer&&!this.notifer.nativeElement.contains(e.target)&&!this.notifyButton.nativeElement.contains(e.target)&&this.toggleNotification==!0?this.toggleNotification=!1:e.stopPropagation(),this.dropper&&!this.dropper.nativeElement.contains(e.target)&&!this.drop.nativeElement.contains(e.target)&&this.isDropped==!0?this.isDropped=!1:e.stopPropagation()}token="";fetchUser(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getUser(this.token).subscribe(e=>{this.userData=e})}formatDate(e,t=8){let n=new Date(e);n.setHours(n.getHours()+t);let r={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return n.toLocaleString("en-US",r).replace(",","")}ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.fetchUser(),this.getNotification(),this.userType=sessionStorage.getItem("userType")??""}ngDoCheck(){setTimeout(()=>{this.getNotification()},6e4)}getNotification(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getNotification(this.token).subscribe(e=>{this.notification=this.sortNotifications(e)})}static \u0275fac=function(t){return new(t||i)(se(Qe),se(Ei),se(Xn))};static \u0275cmp=ft({type:i,selectors:[["app-navbar"]],viewQuery:function(t,n){if(t&1&&(qn(dte,5),qn(cte,5),qn(ute,5),qn(hte,5),qn(fte,5),qn(pte,5)),t&2){let r;Rn(r=Ln())&&(n.sidebar=r.first),Rn(r=Ln())&&(n.button=r.first),Rn(r=Ln())&&(n.notifer=r.first),Rn(r=Ln())&&(n.notifyButton=r.first),Rn(r=Ln())&&(n.dropper=r.first),Rn(r=Ln())&&(n.drop=r.first)}},standalone:!0,features:[gt],decls:1,vars:1,consts:[["button",""],["notifyButton",""],["drop",""],["sidebar",""],["notifer",""],["dropper",""],["class","fixed w-full z-[100] ",4,"ngIf"],[1,"fixed","w-full","z-[100]"],[1,"bg-green-800"],["class","h-20  max-full animate-gradient-wave  z-100 items-center justify-between bg-customDarkGreen px-2 md:px-6 py-4",4,"ngIf"],["class","flex max-full z-100 items-center justify-between bg-customDarkGreen px-2 md:px-6 py-4",4,"ngFor","ngForOf"],["class","md:hidden flex top-[0] relative min-h-screen max-w-[250px] bg-dropDown shadow-r-xl shadow-black p-2 z-[0]",3,"ngClass",4,"ngIf"],[1,"max-w-screen-xl","h-full","z-[1000]"],["class","grid animate-swipeDown absolute justify-self-end items-center right-0 min-h-[200px] max-w-[350px] shadow-r-md shadow-black p-2",4,"ngIf"],["class","hidden md:grid animate-swipeDown absolute justify-self-end items-center right-0 min-h-[200px] max-w-[350px] shadow-r-md shadow-black p-2",4,"ngIf"],["class","relative inset-0 flex items-center justify-center bg-white bg-opacity-50 h-screen w-full z-[10000]",4,"ngIf"],["class","animate-fadeIn fixed inset-0 flex justify-center items-center  bg-white bg-opacity-50 h-full w-full z-[100]",4,"ngIf"],["class","animate-fadeIn fixed inset-0 flex justify-center items-center z-[10000]",4,"ngIf"],[1,"h-20","max-full","animate-gradient-wave","z-100","items-center","justify-between","bg-customDarkGreen","px-2","md:px-6","py-4"],[1,"flex","max-full","z-100","items-center","justify-between","bg-customDarkGreen","px-2","md:px-6","py-4"],[1,"flex","space-x-4","justify-self-center","items-center"],[1,"md:hidden","text-white","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"cursor-pointer","size-12",3,"click"],[1,"md:text-xl","text-[18px]","font-bold","text-white","text-3xl","text-center"],[1,"flex","items-center","space-x-4"],[1,"text-white","rounded-md","text-sm","flex","items-center","justify-between","w-auto","md:pr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 48 48","fill","white"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],[1,"relative","size-5","bg-red-700","rounded-full","text-center","top-[-10px]","left-[-15px]"],[4,"ngIf"],[1,"md:flex","hidden","justify-center","items-center"],["src","./assets/images/defaultProfile.png","class","size-10 bg-black rounded-full ",4,"ngIf"],[1,"hidden","md:flex","pl-2","text-xl","font-bold","justify-center","text-gray-200","hover:text-white","align-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","class","h-6 w-6  relative","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",4,"ngIf"],["src","./assets/images/defaultProfile.png",1,"size-10","bg-black","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-6","w-6","relative"],["d","M5 12h10L10 6z"],["d","M5 8h10l-5 6z"],[1,"md:hidden","flex","top-[0]","relative","min-h-screen","max-w-[250px]","bg-dropDown","shadow-r-xl","shadow-black","p-2","z-[0]",3,"ngClass"],["class","grid-cols-1 grid w-full h-full pl-2 span-8",4,"ngFor","ngForOf"],[1,"grid-cols-1","grid","w-full","h-full","pl-2","span-8"],[1,"flex","justify-center","align-center","pt-4","w-full"],["src","assets/images/defaultProfile.png","class","size-24 bg-black rounded-full border-2 border-white",4,"ngIf"],[1,"block","text-lg","text-center","text-gray-50","pt-2"],[1,"block","text-sm","text-center","text-gray-200","pb-2","font-light"],[1,"pt-4"],["routerLink"," /dashboard","routerLinkActive","active",1,"buttonSideBar",3,"routerLinkActiveOptions"],[1,"pr-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M3 3h18v18H3z"],["d","M3 9h18M9 3v18"],["routerLink","/transaction","routerLinkActive","active",1,"buttonSideBar"],["fill","white","width","26","height","26","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],["routerLink","/profile","routerLinkActive","active",1,"hidden"],["width","24","height","24","viewBox","0 0 20 20","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","Dribbble-Light-Preview","transform","translate(-420.000000, -2159.000000)","fill","white"],["id","icons","transform","translate(56.000000, 160.000000)"],["d","M374,2009 C371.794,2009 370,2007.206 370,2005 C370,2002.794 371.794,2001 374,2001 C376.206,2001 378,2002.794 378,2005 C378,2007.206 376.206,2009 374,2009 M377.758,2009.673 C379.124,2008.574 380,2006.89 380,2005 C380,2001.686 377.314,1999 374,1999 C370.686,1999 368,2001.686 368,2005 C368,2006.89 368.876,2008.574 370.242,2009.673 C366.583,2011.048 364,2014.445 364,2019 L366,2019 C366,2014 369.589,2011 374,2011 C378.411,2011 382,2014 382,2019 L384,2019 C384,2014.445 381.417,2011.048 377.758,2009.673","id","profile-[#1335]"],["routerLink","/notification","routerLinkActive","active",1,"hidden"],["routerLinkActive","active",1,"buttonSideBar","text-white",3,"click"],["src","assets/images/defaultProfile.png",1,"size-24","bg-black","rounded-full","border-2","border-white"],[1,"grid","animate-swipeDown","absolute","justify-self-end","items-center","right-0","min-h-[200px]","max-w-[350px]","shadow-r-md","shadow-black","p-2"],[1,"relative","max-w-sm","w-full","bg-dropDown","shadow-xl","rounded-lg","p-4"],[1,"relative","-top-8","-right-40","md:-right-5","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-dropDown"],[1,"h-96","w-56","pb-2","grid","overflow-hidden"],[1,"overflow-scrollable","h-[calc(100%-2rem)]","overflow-y-auto","px-2"],[1,"text-white","text-md","font-bold"],["class","block text-sm justify-self-start align-start py-2",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"block","text-sm","justify-self-start","align-start","py-2"],[1,"text-md","text-white","text-center"],[1,"text-gray-500","text-sm","mb-4","text-center"],["class"," py-2",4,"ngIf"],[1,"py-2"],[1,"text-md","text-white","text-left","leading-none"],[1,"text-[10px]","pt-1","text-right","text-white","flex","justify-between","align-center"],["class","text-gray-300 hover:text-gray-50 underline",3,"click",4,"ngIf"],[1,"text-gray-300","hover:text-gray-50","underline",3,"click"],[1,"text-md","text-white"],[1,"text-[10px]","pt-1","text-white","text-left"],[1,"hidden","md:grid","animate-swipeDown","absolute","justify-self-end","items-center","right-0","min-h-[200px]","max-w-[350px]","shadow-r-md","shadow-black","p-2"],["class","relative max-w-sm w-full h-full bg-dropDown shadow-md rounded-lg p-4",4,"ngFor","ngForOf"],[1,"relative","max-w-sm","w-full","h-full","bg-dropDown","shadow-md","rounded-lg","p-4"],[1,"relative","-top-8","md:-right-36","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-b-dropDown"],[1,"h-80","w-52","px-4"],[1,"text-center","text-lg","text-white"],[1,"text-center","text-sm","text-gray-200"],["routerLink","/dashboard","routerLinkActive","active",1,"buttonSideBar",3,"routerLinkActiveOptions"],["routerLinkActive","active",1,"buttonSideBar",3,"click"],["width","29","height","29","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M21 12L13 12","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M18 15L20.913 12.087V12.087C20.961 12.039 20.961 11.961 20.913 11.913V11.913L18 9","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M16 5V4.5V4.5C16 3.67157 15.3284 3 14.5 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H14.5C15.3284 21 16 20.3284 16 19.5V19.5V19","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"relative","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-screen","w-full","z-[10000]"],[1,"animate-spin","rounded-full","size-20","border-t-4","border-black"],[1,"relative","left-[-65px]","font-bold","text-xs"],[1,"animate-fadeIn","fixed","inset-0","flex","justify-center","items-center","bg-white","bg-opacity-50","h-full","w-full","z-[100]"],[1,"animate-fadeIn","fixed","inset-0","flex","justify-center","items-center","z-[10000]"],[1,"w-[300px]","h-[230px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","bg-customDarkGreen"],[1,"flex","flex-col","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-sm","md:text-2xl","md:px-8","md:w-full"],[1,"flex","justify-between","space-x-20","md:space-x-52","mt-20"],[1,"h-8","w-16","md:h-12","md:w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-sm","md:text-lg","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md","z-[105]",3,"click"],[1,"h-8","w-16","md:h-12","md:w-24","bg-red-800","rounded-xl","text-gray-50","text-center","text-sm","md:text-lg","hover:bg-red-900","hover:text-gray-200","hover:shadow-red-800","hover:shadow-md","z-[105]",3,"click"]],template:function(t,n){t&1&&G(0,Bte,11,8,"div",6),t&2&&k("ngIf",n.userType=="user")},dependencies:[xt,Ji,an,kt,Lr,qd,rh,tg],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.buttonSideBar[_ngcontent-%COMP%]{display:flex;height:3rem;width:100%;align-items:center;justify-content:flex-start;padding:.5rem;font-size:1.125rem;line-height:1.75rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.buttonSideBar[_ngcontent-%COMP%]:hover{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(27 67 50 / var(--tw-bg-opacity, 1));--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}.truncate[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"]})};var vx=class i{static \u0275fac=function(t){return new(t||i)};static \u0275cmp=ft({type:i,selectors:[["app-footer"]],standalone:!0,features:[gt],decls:3,vars:0,consts:[[1,"w-screen-xl","text-center","bg-gray-50","text-black","text-sm","pt-8"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"p"),_(2,"Copyright \xA92024 All rights reserved"),w()())}})};var Vte=()=>({exact:!0});function Ute(i,e){if(i&1&&(m(0,"p",35),_(1),w()),i&2){let t=U(2);C(),ot(" ",t.getUserNotif("transaction")," ")}}function Hte(i,e){if(i&1&&(m(0,"a",30)(1,"div",31),G(2,Ute,2,1,"p",32),m(3,"span",7),ie(),m(4,"svg",33),F(5,"path",34),w()()(),_(6," Transaction "),w()),i&2){let t=U();C(2),k("ngIf",t.getUserNotif("transaction")!="0")}}function zte(i,e){i&1&&(ie(),m(0,"svg",42),F(1,"path",43),w())}function jte(i,e){i&1&&(ie(),m(0,"svg",42),F(1,"path",44),w())}function Gte(i,e){i&1&&(m(0,"div",45)(1,"a",46),_(2," Create Events "),w(),m(3,"a",47),_(4," Manage Events "),w()())}function Wte(i,e){if(i&1){let t=Ve();m(0,"div",36)(1,"a",37),H("click",function(){$(t);let r=U();return ee(r.toggleDropdown())}),m(2,"div",38)(3,"span",7),F(4,"img",39),w(),m(5,"span"),_(6,"Events"),w()(),G(7,zte,2,0,"svg",40)(8,jte,2,0,"svg",40),w(),G(9,Gte,5,0,"div",41),w()}if(i&2){let t=U();C(7),k("ngIf",!t.isDropdownOpen),C(),k("ngIf",t.isDropdownOpen),C(),k("ngIf",t.isDropdownOpen)}}function qte(i,e){if(i&1&&(m(0,"p",35),_(1),w()),i&2){let t=U(2);C(),ot(" ",t.getUserNotif("user")," ")}}function Zte(i,e){if(i&1&&(m(0,"a",48)(1,"div",31),G(2,qte,2,1,"p",32),m(3,"span",7),ie(),m(4,"svg",49),F(5,"path",50)(6,"path",51),w()(),_(7,"Users "),w()()),i&2){let t=U();C(2),k("ngIf",t.getUserNotif("user")!="0")}}function Yte(i,e){i&1&&(m(0,"a",52)(1,"span",7),ie(),m(2,"svg",53)(3,"title"),_(4,"report"),w(),F(5,"path",54),w()(),_(6,"Reports"),w())}function Xte(i,e){i&1&&(m(0,"a",55)(1,"span",7),ie(),m(2,"svg",56),F(3,"path",57)(4,"path",58),w()(),_(5,"History"),w())}function Qte(i,e){i&1&&(m(0,"a",59)(1,"span",60),ie(),m(2,"svg",61)(3,"g",62)(4,"g",63),F(5,"path",64),w()()()(),_(6,"User Control"),w())}function Kte(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function Jte(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function $te(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function ene(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function tne(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function nne(i,e){i&1&&(m(0,"a",65)(1,"span"),F(2,"div",66),w(),_(3," Loading... "),w())}function ine(i,e){if(i&1){let t=Ve();m(0,"div",69)(1,"div",70)(2,"div",71)(3,"p",72),_(4," Are you sure you want to log out? "),w(),m(5,"div",73)(6,"button",74),H("click",function(){$(t);let r=U(2);return ee(r.logOut=!r.logOut)}),_(7," Cancel "),w(),m(8,"button",75),H("click",function(){$(t);let r=U(2);return ee(r.logout())}),_(9," Logout "),w()()()()()}}function rne(i,e){if(i&1&&(m(0,"div")(1,"div",67),G(2,ine,10,0,"div",68),w()()),i&2){let t=U();C(2),k("ngIf",t.logOut)}}var xx=class i{constructor(e,t){this.router=e;this.adminService=t}loading=!1;toggleSidebar=!1;events="";transactions="";reports="";settings="";control="";history="";logOut=!1;notifData=[];isDropdownOpen=!1;toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}refreshPage(){window.location.reload()}logout(){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("tokenId",""),this.router.navigate(["/login"]).then(()=>{window.location.reload()})},200)}dynamicControl(){let e=sessionStorage.getItem("tokenId")??"";this.adminService.dynamicController(e).subscribe({next:t=>{console.log("check");let n=t.events,r=t.transactions,s=t.reports,o=t.settings,a=t.control,l=t.history;sessionStorage.setItem("events",n),sessionStorage.setItem("transactions",r),sessionStorage.setItem("reports",s),sessionStorage.setItem("settings",o),sessionStorage.setItem("control",a),sessionStorage.setItem("history",l),this.events=sessionStorage.getItem("events")??"",this.transactions=sessionStorage.getItem("transactions")??"",this.reports=sessionStorage.getItem("reports")??"",this.settings=sessionStorage.getItem("settings")??"",this.control=sessionStorage.getItem("control")??"",this.history=sessionStorage.getItem("history")??""}})}ngDoCheck(){sessionStorage.getItem("isLoggedIn")=="login"&&setInterval(()=>{this.dynamicControl(),this.getNotification()},12e4)}ngOnInit(){sessionStorage.getItem("isLoggedIn")=="login"&&(this.dynamicControl(),this.getNotification())}getNotification(){let e=sessionStorage.getItem("tokenId")??"";this.adminService.getNotification(e).subscribe({next:t=>{this.notifData=t},error:t=>{console.error("Error fetching notifications:",t)}})}getUserNotif(e){let t=0;return e=="user"?t=this.notifData.filter(n=>n.message?.startsWith("User created account,")&&n.status?.startsWith("unread")).length:t=this.notifData.filter(n=>!n.message?.startsWith("User created account,")&&n.status?.startsWith("unread")).length,t.toString()}isSidebarVisible(){sessionStorage.setItem("isSidebarVisible","true"),console.log("check")}static \u0275fac=function(t){return new(t||i)(se(Qe),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-admin-navbar"]],standalone:!0,features:[gt],decls:45,vars:15,consts:[[1,"w-full","h-full","px-2","span-8","pt-4"],[1,"flex","justify-center","items-center","flex-col","h-32","w-full","mb-4"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png","alt","Logo",1,"size-24","mb-2","cursor-pointer",3,"click"],[1,"text-center","text-2xl","font-bold"],[1,"text-gray-50"],[1,"mb-2"],["routerLinkActive","active","routerLink","/dashboard-admin",1,"buttonSideBar",3,"routerLinkActiveOptions"],[1,"pr-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M3 3h18v18H3z"],["d","M3 9h18M9 3v18"],[1,"grid","grid-cols-1"],["routerLink","/transaction-admin","routerLinkActive","active","class","buttonSideBar ",4,"ngIf"],["class","relative group",4,"ngIf"],["routerLink","/map-viewer-admin","routerLinkActive","active",1,"buttonSideBar"],["height","24px","width","24px","version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 512 512",0,"xml","space","preserve"],["points","154.64,420.096 154.64,59.496 0,134 0,512 ",2,"fill","white"],["points","309.288,146.464 309.288,504.472 154.64,420.096 154.64,59.496 ",2,"fill","white"],["points","463.928,50.152 309.288,146.464 309.288,504.472 463.928,415.68 ",2,"fill","white"],["d",`M414.512,281.656l-11.92-15.744c-8.8-11.472-85.6-113.984-85.6-165.048
                C317.032,39.592,355.272,0,414.512,0S512,39.592,512,100.864c0,50.992-76.8,153.504-85.488,165.048L414.512,281.656z`,2,"fill","black"],["cx","414.512","cy","101.536","r","31.568",2,"fill","white"],["routerLink","/manage-user","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/reports","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/history","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/user-control","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["class","buttonSideBarLoad",4,"ngIf"],["routerLinkActive","active",1,"buttonSideBar","text-white",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","25px","height","25px","viewBox","0 0 48 48","fill","white"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],[4,"ngIf"],["routerLink","/transaction-admin","routerLinkActive","active",1,"buttonSideBar"],[1,"relative","h-full","flex"],["class","absolute text-white bg-[#880d1e] rounded-full text-[9px] font-semibold text-center size-5 flex items-center justify-center -top-2 left-3 z-[100]",4,"ngIf"],["fill","white","width","26","height","26","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],[1,"absolute","text-white","bg-[#880d1e]","rounded-full","text-[9px]","font-semibold","text-center","size-5","flex","items-center","justify-center","-top-2","left-3","z-[100]"],[1,"relative","group"],["routerLinkActive","active",1,"buttonSideBar","flex","items-center","justify-between","cursor-pointer","w-full",3,"click"],[1,"flex"],["src","/assets/svg/calendar.svg","alt","Description of the image",1,"size-6"],["class"," ml-auto text-right ","fill","white","height","20px","width","20px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 490 490",0,"xml","space","preserve",4,"ngIf"],["class"," left-0 mt-2 w-full bg-customDarkGreen  text-white shadow-lg rounded-lg overflow-hidden transition-all duration-200",4,"ngIf"],["fill","white","height","20px","width","20px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 490 490",0,"xml","space","preserve",1,"ml-auto","text-right"],["d",`M245,258.23l153.302,155.246L490,324.619L245,76.524L0,324.619l91.697,88.857L245,258.23z M43.502,324.14L245,120.101
               l201.498,204.04l-47.717,46.252L245,214.653L91.219,370.393L43.502,324.14z`],["d",`M490,165.37l-91.698-88.842L245,231.766L91.698,76.528L0,165.37l245,248.102L490,165.37z M91.219,119.611L245,275.343
	l153.781-155.732l47.717,46.237L245,369.91L43.502,165.848L91.219,119.611z`],[1,"left-0","mt-2","w-full","bg-customDarkGreen","text-white","shadow-lg","rounded-lg","overflow-hidden","transition-all","duration-200"],["routerLink","/add-events","routerLinkActive","active",1,"block","px-2","py-2","hover:bg-hoverBar","rounded-lg","text-sm"],["routerLink","/manage-events","routerLinkActive","active",1,"block","px-2","py-2","hover:bg-hoverBar","text-sm","rounded-lg"],["routerLink","/manage-user","routerLinkActive","active",1,"buttonSideBar"],["width","24px","height","24px","viewBox","0 0 16 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8 7C9.65685 7 11 5.65685 11 4C11 2.34315 9.65685 1 8 1C6.34315 1 5 2.34315 5 4C5 5.65685 6.34315 7 8 7Z","fill","white"],["d","M14 12C14 10.3431 12.6569 9 11 9H5C3.34315 9 2 10.3431 2 12V15H14V12Z","fill","white"],["routerLink","/reports","routerLinkActive","active",1,"buttonSideBar"],["fill","white","width","24px","height","24px","viewBox","0 0 32 32","version","1.1","xmlns","http://www.w3.org/2000/svg"],["d","M6 11h4v17h-4v-17zM22 16v12h4v-12h-4zM14 28h4v-24h-4v24z"],["routerLink","/history","routerLinkActive","active",1,"buttonSideBar"],["width","24px","height","24px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 8V12L14.5 14.5","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5.60423 5.60423L5.0739 5.0739V5.0739L5.60423 5.60423ZM4.33785 6.87061L3.58786 6.87438C3.58992 7.28564 3.92281 7.61853 4.33408 7.6206L4.33785 6.87061ZM6.87963 7.63339C7.29384 7.63547 7.63131 7.30138 7.63339 6.88717C7.63547 6.47296 7.30138 6.13549 6.88717 6.13341L6.87963 7.63339ZM5.07505 4.32129C5.07296 3.90708 4.7355 3.57298 4.32129 3.57506C3.90708 3.57715 3.57298 3.91462 3.57507 4.32882L5.07505 4.32129ZM3.75 12C3.75 11.5858 3.41421 11.25 3 11.25C2.58579 11.25 2.25 11.5858 2.25 12H3.75ZM16.8755 20.4452C17.2341 20.2378 17.3566 19.779 17.1492 19.4204C16.9418 19.0619 16.483 18.9393 16.1245 19.1468L16.8755 20.4452ZM19.1468 16.1245C18.9393 16.483 19.0619 16.9418 19.4204 17.1492C19.779 17.3566 20.2378 17.2341 20.4452 16.8755L19.1468 16.1245ZM5.14033 5.07126C4.84598 5.36269 4.84361 5.83756 5.13505 6.13191C5.42648 6.42626 5.90134 6.42862 6.19569 6.13719L5.14033 5.07126ZM18.8623 5.13786C15.0421 1.31766 8.86882 1.27898 5.0739 5.0739L6.13456 6.13456C9.33366 2.93545 14.5572 2.95404 17.8017 6.19852L18.8623 5.13786ZM5.0739 5.0739L3.80752 6.34028L4.86818 7.40094L6.13456 6.13456L5.0739 5.0739ZM4.33408 7.6206L6.87963 7.63339L6.88717 6.13341L4.34162 6.12062L4.33408 7.6206ZM5.08784 6.86684L5.07505 4.32129L3.57507 4.32882L3.58786 6.87438L5.08784 6.86684ZM12 3.75C16.5563 3.75 20.25 7.44365 20.25 12H21.75C21.75 6.61522 17.3848 2.25 12 2.25V3.75ZM12 20.25C7.44365 20.25 3.75 16.5563 3.75 12H2.25C2.25 17.3848 6.61522 21.75 12 21.75V20.25ZM16.1245 19.1468C14.9118 19.8483 13.5039 20.25 12 20.25V21.75C13.7747 21.75 15.4407 21.2752 16.8755 20.4452L16.1245 19.1468ZM20.25 12C20.25 13.5039 19.8483 14.9118 19.1468 16.1245L20.4452 16.8755C21.2752 15.4407 21.75 13.7747 21.75 12H20.25ZM6.19569 6.13719C7.68707 4.66059 9.73646 3.75 12 3.75V2.25C9.32542 2.25 6.90113 3.32791 5.14033 5.07126L6.19569 6.13719Z","fill","white"],["routerLink","/user-control","routerLinkActive","active",1,"buttonSideBar"],[1,"pr-2","w-auto"],["width","24px","height","24px","viewBox","0 0 30 30","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xmlns","sketch","http://www.bohemiancoding.com/sketch/ns"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd",0,"sketch","type","MSPage"],["id","Icon-Set-Filled",0,"sketch","type","MSLayerGroup","transform","translate(-103.000000, -362.000000)","fill","white"],["d","M118,382 C115.261,382 113.042,379.762 113.042,377 C113.042,374.238 115.261,372 118,372 C120.739,372 122.959,374.238 122.959,377 C122.959,379.762 120.739,382 118,382 L118,382 Z M132.008,380.536 L129.685,379.184 C129.815,378.474 129.901,377.749 129.901,377 C129.901,376.252 129.815,375.526 129.685,374.816 L132.008,373.464 C132.957,372.912 133.281,371.688 132.733,370.732 L130.75,367.268 C130.203,366.312 128.989,365.983 128.041,366.536 L125.694,367.901 C124.598,366.961 123.352,366.192 121.967,365.697 L121.967,364 C121.967,362.896 121.079,362 119.983,362 L116.017,362 C114.921,362 114.033,362.896 114.033,364 L114.033,365.697 C112.648,366.192 111.402,366.961 110.306,367.901 L107.959,366.536 C107.011,365.983 105.797,366.312 105.25,367.268 L103.267,370.732 C102.719,371.688 103.044,372.912 103.992,373.464 L106.315,374.816 C106.185,375.526 106.099,376.252 106.099,377 C106.099,377.749 106.185,378.474 106.315,379.184 L103.992,380.536 C103.044,381.088 102.719,382.312 103.267,383.268 L105.25,386.732 C105.797,387.688 107.011,388.017 107.959,387.464 L110.306,386.099 C111.402,387.039 112.648,387.809 114.033,388.303 L114.033,390 C114.033,391.104 114.921,392 116.017,392 L119.983,392 C121.079,392 121.967,391.104 121.967,390 L121.967,388.303 C123.352,387.809 124.598,387.039 125.694,386.099 L128.041,387.464 C128.989,388.017 130.203,387.688 130.75,386.732 L132.733,383.268 C133.281,382.312 132.957,381.088 132.008,380.536 L132.008,380.536 Z M118,374 C116.357,374 115.025,375.344 115.025,377 C115.025,378.657 116.357,380 118,380 C119.643,380 120.975,378.657 120.975,377 C120.975,375.344 119.643,374 118,374 L118,374 Z","id","settings",0,"sketch","type","MSShapeGroup"],[1,"buttonSideBarLoad"],[1,"animate-spin","rounded-full","size-6","border-t-2","border-gray-50","mr-2"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-[100]"],["class","animate-fadeIn fixed inset-0 flex justify-center items-center z-[100]",4,"ngIf"],[1,"animate-fadeIn","fixed","inset-0","flex","justify-center","items-center","z-[100]"],[1,"w-[300px]","h-[230px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","bg-customDarkGreen"],[1,"flex","flex-col","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-sm","md:text-2xl","md:px-8","md:w-full"],[1,"flex","justify-between","space-x-20","md:space-x-52","mt-20"],[1,"h-8","w-16","md:h-12","md:w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-sm","md:text-lg","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md","z-[105]",3,"click"],[1,"h-8","w-16","md:h-12","md:w-24","bg-red-800","rounded-xl","text-gray-50","text-center","text-sm","md:text-lg","hover:bg-red-900","hover:text-gray-200","hover:shadow-red-800","hover:shadow-md","z-[105]",3,"click"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"div",1)(2,"img",2),H("click",function(){return n.refreshPage()}),w(),m(3,"p",3),_(4,"CHMSU-A MAPP"),w()(),m(5,"p",4),_(6,"Dashboard"),w(),F(7,"hr",5),m(8,"a",6)(9,"span",7),ie(),m(10,"svg",8),F(11,"path",9)(12,"path",10),w()(),_(13," Dashboard "),w(),Je(),m(14,"p",4),_(15,"Interface"),w(),F(16,"hr",5),m(17,"div",11),G(18,Hte,7,1,"a",12)(19,Wte,10,3,"div",13),m(20,"a",14)(21,"span",7),ie(),m(22,"svg",15),F(23,"polygon",16)(24,"polygon",17)(25,"polygon",18)(26,"path",19)(27,"circle",20),w()(),_(28,"Kiosks"),w(),G(29,Zte,8,1,"a",21)(30,Yte,7,0,"a",22)(31,Xte,6,0,"a",23)(32,Qte,7,0,"a",24)(33,Kte,4,0,"a",25)(34,Jte,4,0,"a",25)(35,$te,4,0,"a",25)(36,ene,4,0,"a",25)(37,tne,4,0,"a",25)(38,nne,4,0,"a",25),Je(),m(39,"a",26),H("click",function(){return n.logOut=!0}),m(40,"span",7),ie(),m(41,"svg",27),F(42,"path",28),w()(),_(43,"logout"),w()()(),G(44,rne,3,1,"div",29)),t&2&&(C(8),k("routerLinkActiveOptions",Mi(14,Vte)),C(10),k("ngIf",n.transactions=="1"),C(),k("ngIf",n.events=="1"),C(10),k("ngIf",n.settings=="1"),C(),k("ngIf",n.reports=="1"),C(),k("ngIf",n.history=="1"),C(),k("ngIf",n.control=="1"),C(),k("ngIf",!n.control),C(),k("ngIf",!n.history),C(),k("ngIf",!n.reports),C(),k("ngIf",!n.settings),C(),k("ngIf",!n.transactions),C(),k("ngIf",!n.events),C(6),k("ngIf",n.logOut))},dependencies:[xt,kt,qd,tg],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.buttonSideBar[_ngcontent-%COMP%]{display:flex;height:2.5rem;width:100%;align-items:center;justify-content:flex-start;padding:.5rem;font-size:1.125rem;line-height:1.75rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.buttonSideBar[_ngcontent-%COMP%]:hover{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(27 67 50 / var(--tw-bg-opacity, 1));--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}.buttonSideBarLoad[_ngcontent-%COMP%]{display:flex;height:2.5rem;width:100%;align-items:center;justify-content:flex-start;border-radius:.75rem;padding:.5rem;font-size:1.125rem;line-height:1.75rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.buttonSideBarLoad[_ngcontent-%COMP%]:hover{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(27 67 50 / var(--tw-bg-opacity, 1));--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}.truncate[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.active[_ngcontent-%COMP%]{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(44 110 73 / var(--tw-bg-opacity, 1));padding:.5rem;--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}"]})};var sne=["notifer"],one=["notifyButton"],ane=["sidebar"],lne=["sidebarButton"];function dne(i,e){i&1&&(m(0,"div",6)(1,"div",7),F(2,"app-navbar"),w(),m(3,"div",8),F(4,"router-outlet"),w()())}function cne(i,e){i&1&&(m(0,"div",17,0)(2,"div",11),F(3,"app-admin-navbar"),w()())}function une(i,e){i&1&&(m(0,"div",21),F(1,"div",22),w())}function hne(i,e){if(i&1&&(m(0,"span"),_(1),w()),i&2){let t=U(4);C(),ge(t.getUnreadCount())}}function fne(i,e){i&1&&(m(0,"div",44)(1,"div",45),_(2,"No new notifications"),w()())}function pne(i,e){if(i&1){let t=Ve();m(0,"button",52),H("click",function(){$(t);let r=U(2).$implicit,s=U(5);return ee(s.readMessage(r.notification_id,"read"))}),_(1,"Read"),w()}}function mne(i,e){if(i&1&&(m(0,"div",48)(1,"div",49),_(2),w(),m(3,"div",50),_(4),G(5,pne,2,0,"button",51),w()()),i&2){let t=U().$implicit,n=U(5);C(2),ge(t.message),C(2),ot(" ",n.formatDate(t.date_created)," "),C(),k("ngIf",t.status=="unread")}}function gne(i,e){if(i&1&&(m(0,"div")(1,"div",46),G(2,mne,6,3,"div",47),w()()),i&2){let t=e.$implicit;C(2),k("ngIf",t.status=="unread")}}function vne(i,e){if(i&1&&(m(0,"div",44)(1,"div",53),_(2),w(),m(3,"div",54),_(4),w()()),i&2){let t=U().$implicit,n=U(5);C(2),ge(t.message),C(2),ge(n.formatDate(t.date_created))}}function xne(i,e){if(i&1&&(m(0,"div"),G(1,vne,5,2,"div",42),w()),i&2){let t=e.$implicit;C(),k("ngIf",t.status=="read")}}function wne(i,e){if(i&1&&(m(0,"div",36,3)(2,"div",37),F(3,"div",38),m(4,"div",39)(5,"div",40)(6,"div",41),_(7,"Unread Messages:"),w(),F(8,"hr"),G(9,fne,3,0,"div",42)(10,gne,3,1,"div",43),m(11,"div",41),_(12,"Read Messages:"),w(),F(13,"hr"),G(14,xne,2,1,"div",43),w()()()()),i&2){let t=U(4);C(9),k("ngIf",!t.hasUnreadMessages()),C(),k("ngForOf",t.notification),C(4),k("ngForOf",t.notification)}}function bne(i,e){i&1&&F(0,"img",55)}function yne(i,e){i&1&&(m(0,"span"),_(1,"..."),w())}function Ane(i,e){if(i&1){let t=Ve();m(0,"div",23)(1,"div")(2,"button",24,1),H("click",function(){$(t);let r=U(3);return ee(r.toggleSidebar())}),ie(),m(4,"svg",25),F(5,"path",26),w()()(),Je(),m(6,"div",27,2)(8,"button",28),H("click",function(){$(t);let r=U(3);return ee(r.toggleNotificationBar())}),ie(),m(9,"svg",29),F(10,"path",30),w(),Je(),m(11,"p",31),G(12,hne,2,1,"span",5),w()(),G(13,wne,15,3,"div",32),m(14,"div",33),G(15,bne,1,0,"img",34),w(),m(16,"div",35),_(17),Ti(18,"slice"),G(19,yne,2,0,"span",5),w()()()}if(i&2){let t=e.$implicit,n=U(3);C(12),k("ngIf",n.notification),C(),k("ngIf",n.toggleNotification),C(2),k("ngIf",!t.profile_image),C(2),ot(" ",Hi(18,5,t.First_name,0,6),""),C(2),k("ngIf",t.First_name.length>6)}}function _ne(i,e){if(i&1&&(m(0,"div",18),G(1,une,2,0,"div",19)(2,Ane,20,9,"div",20),w()),i&2){let t=U(2);C(),k("ngIf",t.userData.length==0),C(),k("ngForOf",t.userData)}}function Sne(i,e){i&1&&(m(0,"div",56),F(1,"router-outlet"),w())}function Ene(i,e){i&1&&(m(0,"div",57),F(1,"router-outlet"),w())}function Cne(i,e){if(i&1&&(m(0,"div",6)(1,"div",9)(2,"div",10)(3,"div",11),F(4,"app-admin-navbar"),w()(),G(5,cne,4,0,"div",12),m(6,"div",13),G(7,_ne,3,2,"div",14)(8,Sne,2,0,"div",15)(9,Ene,2,0,"div",16),w()()()),i&2){let t=U();C(5),k("ngIf",t.isSidebarVisible),C(2),k("ngIf",!t.isMap()),C(),k("ngIf",t.isMap()),C(),k("ngIf",!t.isMap())}}function Mne(i,e){i&1&&(m(0,"div",59),F(1,"app-footer",60),w())}function Tne(i,e){if(i&1&&(m(0,"div"),G(1,Mne,2,0,"div",58),w()),i&2){let t=U();C(),k("ngIf",t.shouldShowForUser()||t.shouldShowForAdmin())}}function Ine(i,e){i&1&&(m(0,"div"),F(1,"router-outlet"),w())}var tu=class i{constructor(e,t,n){this.router=e;this.userService=t;this.adminService=n}notification=[];notifer;notifyButton;sidebar;sidebarButton;showNotification=!1;toggleNotification=!1;userType=null;token="";userData=[];isSidebarVisible=!1;toggleSidebar(){this.isSidebarVisible=!this.isSidebarVisible}ngDoCheck(){sessionStorage.getItem("isLoggedIn")=="login"&&(this.userType=sessionStorage.getItem("userType"))}ngOnInit(){sessionStorage.getItem("isLoggedIn")=="login"&&(this.fetchUser(),this.getNotification())}onClickOutside(e){this.notifer?.nativeElement&&this.notifyButton?.nativeElement&&!this.notifer.nativeElement.contains(e.target)&&!this.notifyButton.nativeElement.contains(e.target)&&this.toggleNotification===!0?(this.toggleNotification=!1,console.log("close")):(console.log("open"),e.stopPropagation()),this.sidebar?.nativeElement&&this.sidebarButton?.nativeElement&&!this.sidebar.nativeElement.contains(e.target)&&!this.sidebarButton.nativeElement.contains(e.target)&&this.isSidebarVisible===!0?this.isSidebarVisible=!1:e.stopPropagation()}getNotification(){this.token=sessionStorage.getItem("tokenId")??"",this.adminService.getNotification(this.token).subscribe(e=>{this.notification=this.sortNotifications(e)})}sortNotifications(e){return e.sort((t,n)=>t.status==="read"&&n.status!=="read"?-1:t.status!=="read"&&n.status==="read"?1:0)}fetchUser(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getUser(this.token).subscribe(e=>{this.userData=e})}toggleNotificationBar(){this.toggleNotification=!this.toggleNotification}formatDate(e,t=8){let n=new Date(e);n.setHours(n.getHours()+t);let r={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return n.toLocaleString("en-US",r).replace(",","")}shouldShowForUser(){return this.userType==="user"&&!this.isRoute()}isMap(){return this.router.url.startsWith("/map-viewer-admin")}isRoute(){return this.router.url.startsWith("/login")||this.router.url.startsWith("/register")||this.router.url.startsWith("/owner")}shouldShowForAdmin(){return this.userType!=="user"&&!this.isRoute()}hasUnreadMessages(){return this.notification.some(e=>e.status==="unread")}readMessage(e,t){this.userService.updateMessage(e,t).subscribe(n=>{n.success==!0&&this.refreshPage()})}refreshPage(){window.location.reload()}getUnreadCount(){return this.notification.reduce((e,t)=>t.status==="unread"?e+1:e,0)}static \u0275fac=function(t){return new(t||i)(se(Qe),se(Xn),se(cn))};static \u0275cmp=ft({type:i,selectors:[["app-root"]],viewQuery:function(t,n){if(t&1&&(qn(sne,5),qn(one,5),qn(ane,5),qn(lne,5)),t&2){let r;Rn(r=Ln())&&(n.notifer=r.first),Rn(r=Ln())&&(n.notifyButton=r.first),Rn(r=Ln())&&(n.sidebar=r.first),Rn(r=Ln())&&(n.sidebarButton=r.first)}},hostBindings:function(t,n){t&1&&H("click",function(s){return n.onClickOutside(s)},!1,lI)},standalone:!0,features:[gt],decls:4,vars:4,consts:[["sidebar",""],["sidebarButton",""],["notifyButton",""],["notifer",""],["class","min-h-screen flex flex-col items-center bg-customBlack",4,"ngIf"],[4,"ngIf"],[1,"min-h-screen","flex","flex-col","items-center","bg-customBlack"],[1,"w-full","max-w-full"],[1,"w-full"],[1,"flex","w-full","justiy-center","align-center"],[1,"hidden","md:flex","w-60","h-full","text-white","flex-col","justify-between","fixed","z-[200]"],[1,"flex","min-h-screen","w-full","bg-customDarkGreen","shadow-r-xl","shadow-black"],["class","flex md:hidden w-60 h-full  text-white flex-col justify-between fixed z-[200]",4,"ngIf"],[1,"flex-1","md:ml-60","w-full"],["class","w-full h-16",4,"ngIf"],["class","pt-2 max-w-screen-xl ",4,"ngIf"],["class","pt-2 w-full ",4,"ngIf"],[1,"flex","md:hidden","w-60","h-full","text-white","flex-col","justify-between","fixed","z-[200]"],[1,"w-full","h-16"],["class","bg-green-800  h-16 overflow-hidden",4,"ngIf"],["class","flex justify-between items-center h-16 bg-[#2c6e49] shadow-[#1b4332] shadow-md px-4 py-4 overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-green-800","h-16","overflow-hidden"],[1,"h-16","bg-customDarkGreen","max-full","animate-gradient-wave","z-100","items-center","justify-between","px-2","md:px-6","py-4"],[1,"flex","justify-between","items-center","h-16","bg-[#2c6e49]","shadow-[#1b4332]","shadow-md","px-4","py-4","overflow-hidden"],[1,"md:hidden","flex","justify-between","items-center","text-white","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-8","w-8"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[1,"flex","justify-center"],[1,"text-white","rounded-md","text-sm","flex","items-center","justify-between","w-auto","pr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 48 48","fill","#ffffff"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],[1,"relative","size-5","bg-[#880d1e]","rounded-full","text-center","top-[-10px]","left-[-15px]"],["class","flex absolute  justify-end items-end animate-swipeDown max-w-[350px] -right-[0.025rem] shadow-r-md shadow-black p-2 z-[10000]",4,"ngIf"],[1,"flex","justify-center","items-center"],["src","assets/images/defaultProfile.png","class","size-8 md:size-10 bg-black rounded-full object-contain",4,"ngIf"],[1,"pl-2","text-md","md:text-xl","font-bold","pt-[7px]","md:pt-1","text-gray-50","pr-1","md:pr-4"],[1,"flex","absolute","justify-end","items-end","animate-swipeDown","max-w-[350px]","-right-[0.025rem]","shadow-r-md","shadow-black","p-2","z-[10000]"],[1,"relative","max-w-[350px]","top-[3rem]","-right-[0.2rem]","bg-dropDown","shadow-xl","rounded-lg","p-4"],[1,"relative","-top-8","left-[3.3rem]","md:left-[1.27rem]","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-dropDown"],[1,"h-96","w-56","pb-2","grid","overflow-hidden"],[1,"overflow-scrollable","h-full","overflow-y-auto","px-2"],[1,"text-white","text-md","font-bold"],["class","block text-sm justify-self-start align-start py-2",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"block","text-sm","justify-self-start","align-start","py-2"],[1,"text-md","text-white","text-center"],[1,"text-gray-500","text-sm","mb-4","text-center"],["class","block text-sm w-full",4,"ngIf"],[1,"block","text-sm","w-full"],[1,"text-md","text-white","text-left"],[1,"text-[10px]","pt-1","text-right","text-white","flex","justify-between"],["class","text-gray-300 hover:text-gray-50 underline",3,"click",4,"ngIf"],[1,"text-gray-300","hover:text-gray-50","underline",3,"click"],[1,"text-md","text-white"],[1,"text-[10px]","pt-1","text-white","text-left"],["src","assets/images/defaultProfile.png",1,"size-8","md:size-10","bg-black","rounded-full","object-contain"],[1,"pt-2","max-w-screen-xl"],[1,"pt-2","w-full"],["class","w-full max-w-screen-xl h-8",4,"ngIf"],[1,"w-full","max-w-screen-xl","h-8"],[1,"bg-customBlack"]],template:function(t,n){t&1&&G(0,dne,5,0,"div",4)(1,Cne,10,4,"div",4)(2,Tne,2,1,"div",5)(3,Ine,2,0,"div",5),t&2&&(k("ngIf",n.shouldShowForUser()),C(),k("ngIf",n.shouldShowForAdmin()),C(),k("ngIf",!n.isMap()),C(),k("ngIf",n.isRoute()))},dependencies:[xt,an,kt,Lr,Yy,gx,vx,xx],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var VC={providers:[TD(),EP(BC)]};Nm(tu,VC).catch(i=>console.error(i));Nm(tu,VC).catch(i=>console.error(i));
