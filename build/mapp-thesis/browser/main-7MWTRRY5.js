var qC=Object.defineProperty,J3=Object.defineProperties;var $3=Object.getOwnPropertyDescriptors;var Tf=Object.getOwnPropertySymbols,eN=Object.getPrototypeOf,ZC=Object.prototype.hasOwnProperty,XC=Object.prototype.propertyIsEnumerable,tN=Reflect.get;var px=(i,e)=>(e=Symbol[i])?e:Symbol.for("Symbol."+i);var WC=(i,e,t)=>e in i?qC(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,re=(i,e)=>{for(var t in e||={})ZC.call(e,t)&&WC(i,t,e[t]);if(Tf)for(var t of Tf(e))XC.call(e,t)&&WC(i,t,e[t]);return i},Ge=(i,e)=>J3(i,$3(e));var mx=(i,e)=>{var t={};for(var n in i)ZC.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&Tf)for(var n of Tf(i))e.indexOf(n)<0&&XC.call(i,n)&&(t[n]=i[n]);return t};var nN=(i,e)=>{for(var t in e)qC(i,t,{get:e[t],enumerable:!0})};var YC=(i,e,t)=>tN(eN(i),t,e);var ce=(i,e,t)=>new Promise((n,r)=>{var s=l=>{try{a(t.next(l))}catch(c){r(c)}},o=l=>{try{a(t.throw(l))}catch(c){r(c)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(i,e)).next())}),If=function(i,e){this[0]=i,this[1]=e},gx=(i,e,t)=>{var n=(o,a,l,c)=>{try{var d=t[o](a),u=(a=d.value)instanceof If,h=d.done;Promise.resolve(u?a[0]:a).then(f=>u?n(o==="return"?o:"next",a[1]?{done:f.done,value:f.value}:f,l,c):l({value:f,done:h})).catch(f=>n("throw",f,l,c))}catch(f){c(f)}},r=o=>s[o]=a=>new Promise((l,c)=>n(o,a,l,c)),s={};return t=t.apply(i,e),s[px("asyncIterator")]=()=>s,r("next"),r("throw"),r("return"),s};var QC=(i,e,t)=>(e=i[px("asyncIterator")])?e.call(i):(i=i[px("iterator")](),e={},t=(n,r)=>(r=i[n])&&(e[n]=s=>new Promise((o,a,l)=>(s=r.call(i,s),l=s.done,Promise.resolve(s.value).then(c=>o({value:c,done:l}),a)))),t("next"),t("return"),e);function KC(i,e){return Object.is(i,e)}var Yn=null,tu=!1,Df=1,bs=Symbol("SIGNAL");function Yt(i){let e=Yn;return Yn=i,e}function JC(){return Yn}function iN(){return tu}var ec={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function yx(i){if(tu)throw new Error("");if(Yn===null)return;Yn.consumerOnSignalRead(i);let e=Yn.nextProducerIndex++;if(Ff(Yn),e<Yn.producerNode.length&&Yn.producerNode[e]!==i&&nu(Yn)){let t=Yn.producerNode[e];Nf(t,Yn.producerIndexOfThis[e])}Yn.producerNode[e]!==i&&(Yn.producerNode[e]=i,Yn.producerIndexOfThis[e]=nu(Yn)?iM(i,Yn,e):0),Yn.producerLastReadVersion[e]=i.version}function rN(){Df++}function $C(i){if(!(nu(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===Df)){if(!i.producerMustRecompute(i)&&!Lf(i)){i.dirty=!1,i.lastCleanEpoch=Df;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=Df}}function eM(i){if(i.liveConsumerNode===void 0)return;let e=tu;tu=!0;try{for(let t of i.liveConsumerNode)t.dirty||nM(t)}finally{tu=e}}function tM(){return Yn?.consumerAllowSignalWrites!==!1}function nM(i){i.dirty=!0,eM(i),i.consumerMarkedDirty?.(i)}function iu(i){return i&&(i.nextProducerIndex=0),Yt(i)}function Rf(i,e){if(Yt(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(nu(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)Nf(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function Lf(i){Ff(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||($C(t),n!==t.version))return!0}return!1}function kf(i){if(Ff(i),nu(i))for(let e=0;e<i.producerNode.length;e++)Nf(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function iM(i,e,t){if(rM(i),i.liveConsumerNode.length===0&&sM(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=iM(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(t),i.liveConsumerNode.push(e)-1}function Nf(i,e){if(rM(i),i.liveConsumerNode.length===1&&sM(i))for(let n=0;n<i.producerNode.length;n++)Nf(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];Ff(r),r.producerIndexOfThis[n]=e}}function nu(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function Ff(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function rM(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function sM(i){return i.producerNode!==void 0}function oM(i){let e=Object.create(sN);e.computation=i;let t=()=>{if($C(e),yx(e),e.value===Pf)throw e.error;return e.value};return t[bs]=e,t}var vx=Symbol("UNSET"),xx=Symbol("COMPUTING"),Pf=Symbol("ERRORED"),sN=Ge(re({},ec),{value:vx,dirty:!0,error:null,equal:KC,producerMustRecompute(i){return i.value===vx||i.value===xx},producerRecomputeValue(i){if(i.value===xx)throw new Error("Detected cycle in computations.");let e=i.value;i.value=xx;let t=iu(i),n;try{n=i.computation()}catch(r){n=Pf,i.error=r}finally{Rf(i,t)}if(e!==vx&&e!==Pf&&n!==Pf&&i.equal(e,n)){i.value=e;return}i.value=n,i.version++}});function oN(){throw new Error}var aM=oN;function lM(){aM()}function cM(i){aM=i}var aN=null;function dM(i){let e=Object.create(hM);e.value=i;let t=()=>(yx(e),e.value);return t[bs]=e,t}function bx(i,e){tM()||lM(),i.equal(i.value,e)||(i.value=e,lN(i))}function uM(i,e){tM()||lM(),bx(i,e(i.value))}var hM=Ge(re({},ec),{equal:KC,value:void 0});function lN(i){i.version++,rN(),eM(i),aN?.()}function fM(i,e,t){let n=Object.create(cN);t&&(n.consumerAllowSignalWrites=!0),n.fn=i,n.schedule=e;let r=l=>{n.cleanupFn=l};function s(l){return l.fn===null&&l.schedule===null}function o(l){s(l)||(kf(l),l.cleanupFn(),l.fn=null,l.schedule=null,l.cleanupFn=wx)}let a=()=>{if(n.fn===null)return;if(iN())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(n.dirty=!1,n.hasRun&&!Lf(n))return;n.hasRun=!0;let l=iu(n);try{n.cleanupFn(),n.cleanupFn=wx,n.fn(r)}finally{Rf(n,l)}};return n.ref={notify:()=>nM(n),run:a,cleanup:()=>n.cleanupFn(),destroy:()=>o(n),[bs]:n},n.ref}var wx=()=>{},cN=Ge(re({},ec),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:i=>{i.schedule!==null&&i.schedule(i.ref)},hasRun:!1,cleanupFn:wx});function wt(i){return typeof i=="function"}function tc(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Of=tc(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ru(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var Bn=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(wt(n))try{n()}catch(s){e=s instanceof Of?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{pM(s)}catch(o){e=e??[],o instanceof Of?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Of(e)}}add(e){var t;if(e&&e!==this)if(this.closed)pM(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ru(t,e)}remove(e){let{_finalizers:t}=this;t&&ru(t,e),e instanceof i&&e._removeParent(this)}};Bn.EMPTY=(()=>{let i=new Bn;return i.closed=!0,i})();var Ax=Bn.EMPTY;function Bf(i){return i instanceof Bn||i&&"closed"in i&&wt(i.remove)&&wt(i.add)&&wt(i.unsubscribe)}function pM(i){wt(i)?i():i.unsubscribe()}var Yr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var nc={setTimeout(i,e,...t){let{delegate:n}=nc;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=nc;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Vf(i){nc.setTimeout(()=>{let{onUnhandledError:e}=Yr;if(e)e(i);else throw i})}function su(){}var mM=_x("C",void 0,void 0);function gM(i){return _x("E",void 0,i)}function vM(i){return _x("N",i,void 0)}function _x(i,e,t){return{kind:i,value:e,error:t}}var Qa=null;function ic(i){if(Yr.useDeprecatedSynchronousErrorHandling){let e=!Qa;if(e&&(Qa={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=Qa;if(Qa=null,t)throw n}}else i()}function xM(i){Yr.useDeprecatedSynchronousErrorHandling&&Qa&&(Qa.errorThrown=!0,Qa.error=i)}var Ka=class extends Bn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Bf(e)&&e.add(this)):this.destination=hN}static create(e,t,n){return new rc(e,t,n)}next(e){this.isStopped?Ex(vM(e),this):this._next(e)}error(e){this.isStopped?Ex(gM(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ex(mM,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},dN=Function.prototype.bind;function Sx(i,e){return dN.call(i,e)}var Cx=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Uf(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Uf(n)}else Uf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Uf(t)}}},rc=class extends Ka{constructor(e,t,n){super();let r;if(wt(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Yr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Sx(e.next,s),error:e.error&&Sx(e.error,s),complete:e.complete&&Sx(e.complete,s)}):r=e}this.destination=new Cx(r)}};function Uf(i){Yr.useDeprecatedSynchronousErrorHandling?xM(i):Vf(i)}function uN(i){throw i}function Ex(i,e){let{onStoppedNotification:t}=Yr;t&&nc.setTimeout(()=>t(i,e))}var hN={closed:!0,next:su,error:uN,complete:su};var sc=typeof Symbol=="function"&&Symbol.observable||"@@observable";function sr(i){return i}function Mx(...i){return Tx(i)}function Tx(i){return i.length===0?sr:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var Gt=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=pN(t)?t:new rc(t,n,r);return ic(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=wM(n),new n((r,s)=>{let o=new rc({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[sc](){return this}pipe(...t){return Tx(t)(this)}toPromise(t){return t=wM(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function wM(i){var e;return(e=i??Yr.Promise)!==null&&e!==void 0?e:Promise}function fN(i){return i&&wt(i.next)&&wt(i.error)&&wt(i.complete)}function pN(i){return i&&i instanceof Ka||fN(i)&&Bf(i)}function Ix(i){return wt(i?.lift)}function Wt(i){return e=>{if(Ix(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Vt(i,e,t,n,r){return new Dx(i,e,t,n,r)}var Dx=class extends Ka{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function oc(){return Wt((i,e)=>{let t=null;i._refCount++;let n=Vt(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var ac=class extends Gt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ix(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Bn;let t=this.getSubject();e.add(this.source.subscribe(Vt(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Bn.EMPTY)}return e}refCount(){return oc()(this)}};var yM=tc(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ri=(()=>{class i extends Gt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new Hf(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new yM}next(t){ic(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){ic(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ic(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?Ax:(this.currentObservers=null,s.push(t),new Bn(()=>{this.currentObservers=null,ru(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new Gt;return t.source=this,t}}return i.create=(e,t)=>new Hf(e,t),i})(),Hf=class extends ri{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:Ax}};var pi=class extends ri{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var or=new Gt(i=>i.complete());function bM(i){return i&&wt(i.schedule)}function AM(i){return i[i.length-1]}function zf(i){return wt(AM(i))?i.pop():void 0}function Xo(i){return bM(AM(i))?i.pop():void 0}function SM(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{c(n.next(d))}catch(u){o(u)}}function l(d){try{c(n.throw(d))}catch(u){o(u)}}function c(d){d.done?s(d.value):r(d.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}function _M(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ja(i){return this instanceof Ja?(this.v=i,this):new Ja(i)}function EM(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(p){return Promise.resolve(p).then(f,u)}}function a(f,p){n[f]&&(r[f]=function(v){return new Promise(function(g,m){s.push([f,v,g,m])>1||l(f,v)})},p&&(r[f]=p(r[f])))}function l(f,p){try{c(n[f](p))}catch(v){h(s[0][3],v)}}function c(f){f.value instanceof Ja?Promise.resolve(f.value.v).then(d,u):h(s[0][2],f)}function d(f){l("next",f)}function u(f){l("throw",f)}function h(f,p){f(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function CM(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof _M=="function"?_M(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){o=i[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}var jf=i=>i&&typeof i.length=="number"&&typeof i!="function";function Gf(i){return wt(i?.then)}function Wf(i){return wt(i[sc])}function qf(i){return Symbol.asyncIterator&&wt(i?.[Symbol.asyncIterator])}function Zf(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function mN(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Xf=mN();function Yf(i){return wt(i?.[Xf])}function Qf(i){return EM(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield Ja(t.read());if(r)return yield Ja(void 0);yield yield Ja(n)}}finally{t.releaseLock()}})}function Kf(i){return wt(i?.getReader)}function Vn(i){if(i instanceof Gt)return i;if(i!=null){if(Wf(i))return gN(i);if(jf(i))return vN(i);if(Gf(i))return xN(i);if(qf(i))return MM(i);if(Yf(i))return wN(i);if(Kf(i))return yN(i)}throw Zf(i)}function gN(i){return new Gt(e=>{let t=i[sc]();if(wt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function vN(i){return new Gt(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function xN(i){return new Gt(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Vf)})}function wN(i){return new Gt(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function MM(i){return new Gt(e=>{bN(i,e).catch(t=>e.error(t))})}function yN(i){return MM(Qf(i))}function bN(i,e){var t,n,r,s;return SM(this,void 0,void 0,function*(){try{for(t=CM(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function zi(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function Jf(i,e=0){return Wt((t,n)=>{t.subscribe(Vt(n,r=>zi(n,i,()=>n.next(r),e),()=>zi(n,i,()=>n.complete(),e),r=>zi(n,i,()=>n.error(r),e)))})}function $f(i,e=0){return Wt((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function TM(i,e){return Vn(i).pipe($f(e),Jf(e))}function IM(i,e){return Vn(i).pipe($f(e),Jf(e))}function DM(i,e){return new Gt(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function PM(i,e){return new Gt(t=>{let n;return zi(t,e,()=>{n=i[Xf](),zi(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>wt(n?.return)&&n.return()})}function ep(i,e){if(!i)throw new Error("Iterable cannot be null");return new Gt(t=>{zi(t,e,()=>{let n=i[Symbol.asyncIterator]();zi(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function RM(i,e){return ep(Qf(i),e)}function LM(i,e){if(i!=null){if(Wf(i))return TM(i,e);if(jf(i))return DM(i,e);if(Gf(i))return IM(i,e);if(qf(i))return ep(i,e);if(Yf(i))return PM(i,e);if(Kf(i))return RM(i,e)}throw Zf(i)}function fn(i,e){return e?LM(i,e):Vn(i)}function st(...i){let e=Xo(i);return fn(i,e)}function yr(i,e){let t=wt(i)?i:()=>i,n=r=>r.error(t());return new Gt(e?r=>e.schedule(n,0,r):n)}function Px(i){return!!i&&(i instanceof Gt||wt(i.lift)&&wt(i.subscribe))}var Ys=tc(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function bt(i,e){return Wt((t,n)=>{let r=0;t.subscribe(Vt(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:AN}=Array;function _N(i,e){return AN(e)?i(...e):i(e)}function tp(i){return bt(e=>_N(i,e))}var{isArray:SN}=Array,{getPrototypeOf:EN,prototype:CN,keys:MN}=Object;function np(i){if(i.length===1){let e=i[0];if(SN(e))return{args:e,keys:null};if(TN(e)){let t=MN(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function TN(i){return i&&typeof i=="object"&&EN(i)===CN}function ip(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function $a(...i){let e=Xo(i),t=zf(i),{args:n,keys:r}=np(i);if(n.length===0)return fn([],e);let s=new Gt(IN(n,e,r?o=>ip(r,o):sr));return t?s.pipe(tp(t)):s}function IN(i,e,t=sr){return n=>{kM(e,()=>{let{length:r}=i,s=new Array(r),o=r,a=r;for(let l=0;l<r;l++)kM(e,()=>{let c=fn(i[l],e),d=!1;c.subscribe(Vt(n,u=>{s[l]=u,d||(d=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}function kM(i,e,t){i?zi(t,i,e):e()}function NM(i,e,t,n,r,s,o,a){let l=[],c=0,d=0,u=!1,h=()=>{u&&!l.length&&!c&&e.complete()},f=v=>c<n?p(v):l.push(v),p=v=>{s&&e.next(v),c++;let g=!1;Vn(t(v,d++)).subscribe(Vt(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){let m=l.shift();o?zi(e,o,()=>p(m)):p(m)}h()}catch(m){e.error(m)}}))};return i.subscribe(Vt(e,f,()=>{u=!0,h()})),()=>{a?.()}}function Un(i,e,t=1/0){return wt(e)?Un((n,r)=>bt((s,o)=>e(n,s,r,o))(Vn(i(n,r))),t):(typeof e=="number"&&(t=e),Wt((n,r)=>NM(n,r,i,t)))}function Yo(i=1/0){return Un(sr,i)}function FM(){return Yo(1)}function lc(...i){return FM()(fn(i,Xo(i)))}function rp(i){return new Gt(e=>{Vn(i()).subscribe(e)})}function Rx(...i){let e=zf(i),{args:t,keys:n}=np(i),r=new Gt(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),l=o,c=o;for(let d=0;d<o;d++){let u=!1;Vn(t[d]).subscribe(Vt(s,h=>{u||(u=!0,c--),a[d]=h},()=>l--,void 0,()=>{(!l||!u)&&(c||s.next(n?ip(n,a):a),s.complete())}))}});return e?r.pipe(tp(e)):r}function ji(i,e){return Wt((t,n)=>{let r=0;t.subscribe(Vt(n,s=>i.call(e,s,r++)&&n.next(s)))})}function Gi(i){return Wt((e,t)=>{let n=null,r=!1,s;n=e.subscribe(Vt(t,void 0,void 0,o=>{s=Vn(i(o,Gi(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function OM(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Vt(o,d=>{let u=c++;l=a?i(l,d,u):(a=!0,d),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function Qs(i,e){return wt(e)?Un(i,e,1):Un(i,1)}function Qo(i){return Wt((e,t)=>{let n=!1;e.subscribe(Vt(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function Ks(i){return i<=0?()=>or:Wt((e,t)=>{let n=0;e.subscribe(Vt(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Lx(i){return bt(()=>i)}function sp(i=DN){return Wt((e,t)=>{let n=!1;e.subscribe(Vt(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function DN(){return new Ys}function el(i){return Wt((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function As(i,e){let t=arguments.length>=2;return n=>n.pipe(i?ji((r,s)=>i(r,s,n)):sr,Ks(1),t?Qo(e):sp(()=>new Ys))}function cc(i){return i<=0?()=>or:Wt((e,t)=>{let n=[];e.subscribe(Vt(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function kx(i,e){let t=arguments.length>=2;return n=>n.pipe(i?ji((r,s)=>i(r,s,n)):sr,cc(1),t?Qo(e):sp(()=>new Ys))}function Nx(i,e){return Wt(OM(i,e,arguments.length>=2,!0))}function Fx(...i){let e=Xo(i);return Wt((t,n)=>{(e?lc(i,t,e):lc(i,t)).subscribe(n)})}function Wi(i,e){return Wt((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(Vt(n,l=>{r?.unsubscribe();let c=0,d=s++;Vn(i(l,d)).subscribe(r=Vt(n,u=>n.next(e?e(l,u,d,c++):u),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Ox(i){return Wt((e,t)=>{Vn(i).subscribe(Vt(t,()=>t.complete(),su)),!t.closed&&e.subscribe(t)})}function si(i,e,t){let n=wt(i)||e||t?{next:i,error:e,complete:t}:i;return n?Wt((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(Vt(s,l=>{var c;(c=n.next)===null||c===void 0||c.call(n,l),s.next(l)},()=>{var l;a=!1,(l=n.complete)===null||l===void 0||l.call(n),s.complete()},l=>{var c;a=!1,(c=n.error)===null||c===void 0||c.call(n,l),s.error(l)},()=>{var l,c;a&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(c=n.finalize)===null||c===void 0||c.call(n)}))}):sr}var MT="https://g.co/ng/security#xss",ze=class extends Error{constructor(e,t){super(Gp(e,t)),this.code=e}};function Gp(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}function gu(i){return{toString:i}.toString()}var op="__parameters__";function PN(i){return function(...t){if(i){let n=i(...t);for(let r in n)this[r]=n[r]}}}function TT(i,e,t){return gu(()=>{let n=PN(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(l,c,d){let u=l.hasOwnProperty(op)?l[op]:Object.defineProperty(l,op,{value:[]})[op];for(;u.length<=d;)u.push(null);return(u[d]=u[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}var lu=globalThis;function cn(i){for(let e in i)if(i[e]===cn)return e;throw Error("Could not find renamed property on target object.")}function RN(i,e){for(let t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function Li(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(Li).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function BM(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var LN=cn({__forward_ref__:cn});function Ps(i){return i.__forward_ref__=Ps,i.toString=function(){return Li(this())},i}function Ri(i){return IT(i)?i():i}function IT(i){return typeof i=="function"&&i.hasOwnProperty(LN)&&i.__forward_ref__===Ps}function Se(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function mi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Wp(i){return VM(i,PT)||VM(i,RT)}function DT(i){return Wp(i)!==null}function VM(i,e){return i.hasOwnProperty(e)?i[e]:null}function kN(i){let e=i&&(i[PT]||i[RT]);return e||null}function UM(i){return i&&(i.hasOwnProperty(HM)||i.hasOwnProperty(NN))?i[HM]:null}var PT=cn({\u0275prov:cn}),HM=cn({\u0275inj:cn}),RT=cn({ngInjectableDef:cn}),NN=cn({ngInjectorDef:cn}),Je=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function LT(i){return i&&!!i.\u0275providers}var FN=cn({\u0275cmp:cn}),ON=cn({\u0275dir:cn}),BN=cn({\u0275pipe:cn}),VN=cn({\u0275mod:cn}),yp=cn({\u0275fac:cn}),au=cn({__NG_ELEMENT_ID__:cn}),zM=cn({__NG_ENV_ID__:cn});function gc(i){return typeof i=="string"?i:i==null?"":String(i)}function UN(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():gc(i)}function HN(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new ze(-200,i)}function ry(i,e){throw new ze(-201,!1)}var Rt=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(Rt||{}),Qx;function kT(){return Qx}function qi(i){let e=Qx;return Qx=i,e}function NT(i,e,t){let n=Wp(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&Rt.Optional)return null;if(e!==void 0)return e;ry(i,"Injector")}var zN={},cu=zN,Kx="__NG_DI_FLAG__",bp="ngTempTokenPath",jN="ngTokenPath",GN=/\n/gm,WN="\u0275",jM="__source",pc;function qN(){return pc}function Ko(i){let e=pc;return pc=i,e}function ZN(i,e=Rt.Default){if(pc===void 0)throw new ze(-203,!1);return pc===null?NT(i,void 0,e):pc.get(i,e&Rt.Optional?null:void 0,e)}function Me(i,e=Rt.Default){return(kT()||ZN)(Ri(i),e)}function ve(i,e=Rt.Default){return Me(i,qp(e))}function qp(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function Jx(i){let e=[];for(let t=0;t<i.length;t++){let n=Ri(i[t]);if(Array.isArray(n)){if(n.length===0)throw new ze(900,!1);let r,s=Rt.Default;for(let o=0;o<n.length;o++){let a=n[o],l=XN(a);typeof l=="number"?l===-1?r=a.token:s|=l:r=a}e.push(Me(r,s))}else e.push(Me(n))}return e}function FT(i,e){return i[Kx]=e,i.prototype[Kx]=e,i}function XN(i){return i[Kx]}function YN(i,e,t,n){let r=i[bp];throw e[jM]&&r.unshift(e[jM]),i.message=QN(`
`+i.message,r,t,n),i[jN]=r,i[bp]=null,i}function QN(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==WN?i.slice(2):i;let r=Li(e);if(Array.isArray(e))r=e.map(Li).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Li(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(GN,`
  `)}`}var vu=FT(TT("Optional"),8);var Zp=FT(TT("SkipSelf"),4);function nl(i,e){let t=i.hasOwnProperty(yp);return t?i[yp]:null}function KN(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function JN(i){return i.flat(Number.POSITIVE_INFINITY)}function sy(i,e){i.forEach(t=>Array.isArray(t)?sy(t,e):e(t))}function OT(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Ap(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function $N(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function eF(i,e,t){let n=xu(i,e);return n>=0?i[n|1]=t:(n=~n,$N(i,n,e,t)),n}function Bx(i,e){let t=xu(i,e);if(t>=0)return i[t|1]}function xu(i,e){return tF(i,e,1)}function tF(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var vc={},br=[],xc=new Je(""),BT=new Je("",-1),VT=new Je(""),_p=class{get(e,t=cu){if(t===cu){let n=new Error(`NullInjectorError: No provider for ${Li(e)}!`);throw n.name="NullInjectorError",n}return t}},UT=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(UT||{}),Es=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(Es||{}),ea=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(ea||{});function nF(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function $x(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];iF(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function HT(i){return i===3||i===4||i===6}function iF(i){return i.charCodeAt(0)===64}function du(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?GM(i,t,r,null,e[++n]):GM(i,t,r,null,null))}}return i}function GM(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var zT="ng-template";function rF(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&nF(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(oy(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function oy(i){return i.type===4&&i.value!==zT}function sF(i,e,t){let n=i.type===4&&!t?zT:i.value;return e===n}function oF(i,e,t){let n=4,r=i.attrs,s=r!==null?cF(r):0,o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!Qr(n)&&!Qr(l))return!1;if(o&&Qr(l))continue;o=!1,n=l|n&1;continue}if(!o)if(n&4){if(n=2|n&1,l!==""&&!sF(i,l,t)||l===""&&e.length===1){if(Qr(n))return!1;o=!0}}else if(n&8){if(r===null||!rF(i,r,l,t)){if(Qr(n))return!1;o=!0}}else{let c=e[++a],d=aF(l,r,oy(i),t);if(d===-1){if(Qr(n))return!1;o=!0;continue}if(c!==""){let u;if(d>s?u="":u=r[d+1].toLowerCase(),n&2&&c!==u){if(Qr(n))return!1;o=!0}}}}return Qr(n)||o}function Qr(i){return(i&1)===0}function aF(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return dF(e,i)}function lF(i,e,t=!1){for(let n=0;n<e.length;n++)if(oF(i,e[n],t))return!0;return!1}function cF(i){for(let e=0;e<i.length;e++){let t=i[e];if(HT(t))return e}return i.length}function dF(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function WM(i,e){return i?":not("+e.trim()+")":e}function uF(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!Qr(o)&&(e+=WM(s,r),r=""),n=o,s=s||!Qr(n);t++}return r!==""&&(e+=WM(s,r)),e}function hF(i){return i.map(uF).join(",")}function fF(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!Qr(r))break;r=s}n++}return{attrs:e,classes:t}}function vt(i){return gu(()=>{let e=ZT(i),t=Ge(re({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===UT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||Es.Emulated,styles:i.styles||br,_:null,schemas:i.schemas||null,tView:null,id:""});XT(t);let n=i.dependencies;return t.directiveDefs=ZM(n,!1),t.pipeDefs=ZM(n,!0),t.id=gF(t),t})}function pF(i){return ta(i)||jT(i)}function mF(i){return i!==null}function gi(i){return gu(()=>({type:i.type,bootstrap:i.bootstrap||br,declarations:i.declarations||br,imports:i.imports||br,exports:i.exports||br,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function qM(i,e){if(i==null)return vc;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=ea.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==ea.None?[n,a]:n,e[s]=o):t[s]=n}return t}function dn(i){return gu(()=>{let e=ZT(i);return XT(e),e})}function ay(i){return{type:i.type,name:i.name,factory:null,pure:i.pure!==!1,standalone:i.standalone===!0,onDestroy:i.type.prototype.ngOnDestroy||null}}function ta(i){return i[FN]||null}function jT(i){return i[ON]||null}function GT(i){return i[BN]||null}function WT(i){let e=ta(i)||jT(i)||GT(i);return e!==null?e.standalone:!1}function qT(i,e){let t=i[VN]||null;if(!t&&e===!0)throw new Error(`Type ${Li(i)} does not have '\u0275mod' property.`);return t}function ZT(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||vc,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||br,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qM(i.inputs,e),outputs:qM(i.outputs),debugInfo:null}}function XT(i){i.features?.forEach(e=>e(i))}function ZM(i,e){if(!i)return null;let t=e?GT:pF;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter(mF)}function gF(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function wu(i){return{\u0275providers:i}}function vF(...i){return{\u0275providers:YT(!0,i),\u0275fromNgModule:!0}}function YT(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return sy(e,o=>{let a=o;ew(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&QT(r,s),t}function QT(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];ly(r,s=>{e(s,n)})}}function ew(i,e,t,n){if(i=Ri(i),!i)return!1;let r=null,s=UM(i),o=!s&&ta(i);if(!s&&!o){let l=i.ngModule;if(s=UM(l),s)r=l;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of l)ew(c,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let c;try{sy(s.imports,d=>{ew(d,e,t,n)&&(c||=[],c.push(d))})}finally{}c!==void 0&&QT(c,e)}if(!a){let c=nl(r)||(()=>new r);e({provide:r,useFactory:c,deps:br},r),e({provide:VT,useValue:r,multi:!0},r),e({provide:xc,useValue:()=>Me(r),multi:!0},r)}let l=s.providers;if(l!=null&&!a){let c=i;ly(l,d=>{e(d,c)})}}else return!1;return r!==i&&i.providers!==void 0}function ly(i,e){for(let t of i)LT(t)&&(t=t.\u0275providers),Array.isArray(t)?ly(t,e):e(t)}var xF=cn({provide:String,useValue:cn});function KT(i){return i!==null&&typeof i=="object"&&xF in i}function wF(i){return!!(i&&i.useExisting)}function yF(i){return!!(i&&i.useFactory)}function wc(i){return typeof i=="function"}function bF(i){return!!i.useClass}var Xp=new Je(""),fp={},AF={},Vx;function cy(){return Vx===void 0&&(Vx=new _p),Vx}var ki=class{},uu=class extends ki{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,nw(e,o=>this.processProvider(o)),this.records.set(BT,dc(void 0,this)),r.has("environment")&&this.records.set(ki,dc(void 0,this));let s=this.records.get(Xp);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(VT,br,Rt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Yt(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Yt(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Ko(this),n=qi(void 0),r;try{return e()}finally{Ko(t),qi(n)}}get(e,t=cu,n=Rt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(zM))return e[zM](this);n=qp(n);let r,s=Ko(this),o=qi(void 0);try{if(!(n&Rt.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=MF(e)&&Wp(e);c&&this.injectableDefInScope(c)?l=dc(tw(e),fp):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=n&Rt.Self?cy():this.parent;return t=n&Rt.Optional&&t===cu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[bp]=a[bp]||[]).unshift(Li(e)),s)throw a;return YN(a,e,"R3InjectorError",this.source)}else throw a}finally{qi(o),Ko(s)}}resolveInjectorInitializers(){let e=Yt(null),t=Ko(this),n=qi(void 0),r;try{let s=this.get(xc,br,Rt.Self);for(let o of s)o()}finally{Ko(t),qi(n),Yt(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(Li(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ze(205,!1)}processProvider(e){e=Ri(e);let t=wc(e)?e:Ri(e&&e.provide),n=SF(e);if(!wc(e)&&e.multi===!0){let r=this.records.get(t);r||(r=dc(void 0,fp,!0),r.factory=()=>Jx(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=Yt(null);try{return t.value===fp&&(t.value=AF,t.value=t.factory()),typeof t.value=="object"&&t.value&&CF(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Yt(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Ri(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function tw(i){let e=Wp(i),t=e!==null?e.factory:nl(i);if(t!==null)return t;if(i instanceof Je)throw new ze(204,!1);if(i instanceof Function)return _F(i);throw new ze(204,!1)}function _F(i){if(i.length>0)throw new ze(204,!1);let t=kN(i);return t!==null?()=>t.factory(i):()=>new i}function SF(i){if(KT(i))return dc(void 0,i.useValue);{let e=JT(i);return dc(e,fp)}}function JT(i,e,t){let n;if(wc(i)){let r=Ri(i);return nl(r)||tw(r)}else if(KT(i))n=()=>Ri(i.useValue);else if(yF(i))n=()=>i.useFactory(...Jx(i.deps||[]));else if(wF(i))n=()=>Me(Ri(i.useExisting));else{let r=Ri(i&&(i.useClass||i.provide));if(EF(i))n=()=>new r(...Jx(i.deps));else return nl(r)||tw(r)}return n}function dc(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function EF(i){return!!i.deps}function CF(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function MF(i){return typeof i=="function"||typeof i=="object"&&i instanceof Je}function nw(i,e){for(let t of i)Array.isArray(t)?nw(t,e):t&&LT(t)?nw(t.\u0275providers,e):e(t)}function Er(i,e){i instanceof uu&&i.assertNotDestroyed();let t,n=Ko(i),r=qi(void 0);try{return e()}finally{Ko(n),qi(r)}}function $T(){return kT()!==void 0||qN()!=null}function e2(i){if(!$T())throw new ze(-203,!1)}function TF(i){return typeof i=="function"}var to=0,Ct=1,ht=2,Ai=3,Kr=4,$r=5,Sp=6,Ep=7,Jr=8,yc=9,Cs=10,kn=11,hu=12,XM=13,Mc=14,Ms=15,il=16,uc=17,Js=18,Yp=19,t2=20,Jo=21,pp=22,Ar=23,_r=25,n2=1;var rl=7,Cp=8,bc=9,ar=10,Mp=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Mp||{});function $o(i){return Array.isArray(i)&&typeof i[n2]=="object"}function no(i){return Array.isArray(i)&&i[n2]===!0}function dy(i){return(i.flags&4)!==0}function Qp(i){return i.componentOffset>-1}function Kp(i){return(i.flags&1)===1}function na(i){return!!i.template}function iw(i){return(i[ht]&512)!==0}var rw=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function i2(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function Ni(){return r2}function r2(i){return i.type.prototype.ngOnChanges&&(i.setInput=DF),IF}Ni.ngInherit=!0;function IF(){let i=o2(this),e=i?.current;if(e){let t=i.previous;if(t===vc)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function DF(i,e,t,n,r){let s=this.declaredInputs[n],o=o2(i)||PF(i,{previous:vc,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new rw(c&&c.currentValue,t,l===vc),i2(i,e,r,t)}var s2="__ngSimpleChanges__";function o2(i){return i[s2]||null}function PF(i,e){return i[s2]=e}var YM=null;var _s=function(i,e,t){YM?.(i,e,t)},a2="svg",RF="math";function Ts(i){for(;Array.isArray(i);)i=i[to];return i}function l2(i,e){return Ts(e[i])}function Cr(i,e){return Ts(e[i.index])}function c2(i,e){return i.data[e]}function d2(i,e){return i[e]}function aa(i,e){let t=e[i];return $o(t)?t:t[to]}function LF(i){return(i[ht]&4)===4}function uy(i){return(i[ht]&128)===128}function kF(i){return no(i[Ai])}function Ac(i,e){return e==null?null:i[e]}function u2(i){i[uc]=0}function h2(i){i[ht]&1024||(i[ht]|=1024,uy(i)&&$p(i))}function NF(i,e){for(;i>0;)e=e[Mc],i--;return e}function Jp(i){return!!(i[ht]&9216||i[Ar]?.dirty)}function sw(i){i[Cs].changeDetectionScheduler?.notify(8),i[ht]&64&&(i[ht]|=1024),Jp(i)&&$p(i)}function $p(i){i[Cs].changeDetectionScheduler?.notify(0);let e=sl(i);for(;e!==null&&!(e[ht]&8192||(e[ht]|=8192,!uy(e)));)e=sl(e)}function f2(i,e){if((i[ht]&256)===256)throw new ze(911,!1);i[Jo]===null&&(i[Jo]=[]),i[Jo].push(e)}function FF(i,e){if(i[Jo]===null)return;let t=i[Jo].indexOf(e);t!==-1&&i[Jo].splice(t,1)}function sl(i){let e=i[Ai];return no(e)?e[Ai]:e}var At={lFrame:_2(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var p2=!1;function OF(){return At.lFrame.elementDepthCount}function BF(){At.lFrame.elementDepthCount++}function VF(){At.lFrame.elementDepthCount--}function m2(){return At.bindingsEnabled}function UF(){return At.skipHydrationRootTNode!==null}function HF(i){return At.skipHydrationRootTNode===i}function zF(){At.skipHydrationRootTNode=null}function kt(){return At.lFrame.lView}function Hn(){return At.lFrame.tView}function he(i){return At.lFrame.contextLView=i,i[Jr]}function fe(i){return At.lFrame.contextLView=null,i}function vi(){let i=g2();for(;i!==null&&i.type===64;)i=i.parent;return i}function g2(){return At.lFrame.currentTNode}function jF(){let i=At.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function ul(i,e){let t=At.lFrame;t.currentTNode=i,t.isParent=e}function hy(){return At.lFrame.isParent}function v2(){At.lFrame.isParent=!1}function GF(){return At.lFrame.contextLView}function x2(){return p2}function QM(i){p2=i}function yu(){let i=At.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function WF(){return At.lFrame.bindingIndex}function qF(i){return At.lFrame.bindingIndex=i}function em(){return At.lFrame.bindingIndex++}function w2(i){let e=At.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function ZF(){return At.lFrame.inI18n}function XF(i,e){let t=At.lFrame;t.bindingIndex=t.bindingRootIndex=i,ow(e)}function YF(){return At.lFrame.currentDirectiveIndex}function ow(i){At.lFrame.currentDirectiveIndex=i}function QF(i){let e=At.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function y2(){return At.lFrame.currentQueryIndex}function fy(i){At.lFrame.currentQueryIndex=i}function KF(i){let e=i[Ct];return e.type===2?e.declTNode:e.type===1?i[$r]:null}function b2(i,e,t){if(t&Rt.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&Rt.Host);)if(r=KF(s),r===null||(s=s[Mc],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=At.lFrame=A2();return n.currentTNode=e,n.lView=i,!0}function py(i){let e=A2(),t=i[Ct];At.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function A2(){let i=At.lFrame,e=i===null?null:i.child;return e===null?_2(i):e}function _2(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function S2(){let i=At.lFrame;return At.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var E2=S2;function my(){let i=S2();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function JF(i){return(At.lFrame.contextLView=NF(i,At.lFrame.contextLView))[Jr]}function hl(){return At.lFrame.selectedIndex}function ol(i){At.lFrame.selectedIndex=i}function tm(){let i=At.lFrame;return c2(i.tView,i.selectedIndex)}function te(){At.lFrame.currentNamespace=a2}function ot(){$F()}function $F(){At.lFrame.currentNamespace=null}function eO(){return At.lFrame.currentNamespace}var C2=!0;function nm(){return C2}function im(i){C2=i}function tO(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=r2(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function rm(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),l&&(i.viewHooks??=[]).push(-t,l),c&&((i.viewHooks??=[]).push(t,c),(i.viewCheckHooks??=[]).push(t,c)),d!=null&&(i.destroyHooks??=[]).push(t,d)}}function mp(i,e,t){M2(i,e,3,t)}function gp(i,e,t,n){(i[ht]&3)===t&&M2(i,e,t,n)}function Ux(i,e){let t=i[ht];(t&3)===e&&(t&=16383,t+=1,i[ht]=t)}function M2(i,e,t,n){let r=n!==void 0?i[uc]&65535:0,s=n??-1,o=e.length-1,a=0;for(let l=r;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],n!=null&&a>=n)break}else e[l]<0&&(i[uc]+=65536),(a<s||s==-1)&&(nO(i,t,e,l),i[uc]=(i[uc]&4294901760)+l+2),l++}function KM(i,e){_s(4,i,e);let t=Yt(null);try{e.call(i)}finally{Yt(t),_s(5,i,e)}}function nO(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[ht]>>14<i[uc]>>16&&(i[ht]&3)===e&&(i[ht]+=16384,KM(a,s)):KM(a,s)}var mc=-1,al=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function iO(i){return i instanceof al}function rO(i){return(i.flags&8)!==0}function sO(i){return(i.flags&16)!==0}var Hx={},aw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=qp(n);let r=this.injector.get(e,Hx,n);return r!==Hx||t===Hx?r:this.parentInjector.get(e,t,n)}};function T2(i){return i!==mc}function Tp(i){return i&32767}function oO(i){return i>>16}function Ip(i,e){let t=oO(i),n=e;for(;t>0;)n=n[Mc],t--;return n}var lw=!0;function Dp(i){let e=lw;return lw=i,e}var aO=256,I2=aO-1,D2=5,lO=0,Ss={};function cO(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(au)&&(n=t[au]),n==null&&(n=t[au]=lO++);let r=n&I2,s=1<<r;e.data[i+(r>>D2)]|=s}function Pp(i,e){let t=P2(i,e);if(t!==-1)return t;let n=e[Ct];n.firstCreatePass&&(i.injectorIndex=e.length,zx(n.data,i),zx(e,null),zx(n.blueprint,null));let r=gy(i,e),s=i.injectorIndex;if(T2(r)){let o=Tp(r),a=Ip(r,e),l=a[Ct].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function zx(i,e){i.push(0,0,0,0,0,0,0,0,e)}function P2(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function gy(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=F2(r),n===null)return mc;if(t++,r=r[Mc],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return mc}function cw(i,e,t){cO(i,e,t)}function dO(i,e){if(e==="class")return i.classes;if(e==="style")return i.styles;let t=i.attrs;if(t){let n=t.length,r=0;for(;r<n;){let s=t[r];if(HT(s))break;if(s===0)r=r+2;else if(typeof s=="number")for(r++;r<n&&typeof t[r]=="string";)r++;else{if(s===e)return t[r+1];r=r+2}}}return null}function R2(i,e,t){if(t&Rt.Optional||i!==void 0)return i;ry(e,"NodeInjector")}function L2(i,e,t,n){if(t&Rt.Optional&&n===void 0&&(n=null),!(t&(Rt.Self|Rt.Host))){let r=i[yc],s=qi(void 0);try{return r?r.get(e,n,t&Rt.Optional):NT(e,n,t&Rt.Optional)}finally{qi(s)}}return R2(n,e,t)}function k2(i,e,t,n=Rt.Default,r){if(i!==null){if(e[ht]&2048&&!(n&Rt.Self)){let o=pO(i,e,t,n,Ss);if(o!==Ss)return o}let s=N2(i,e,t,n,Ss);if(s!==Ss)return s}return L2(e,t,n,r)}function N2(i,e,t,n,r){let s=hO(t);if(typeof s=="function"){if(!b2(e,i,n))return n&Rt.Host?R2(r,t,n):L2(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&Rt.Optional))ry(t);else return o}finally{E2()}}else if(typeof s=="number"){let o=null,a=P2(i,e),l=mc,c=n&Rt.Host?e[Ms][$r]:null;for((a===-1||n&Rt.SkipSelf)&&(l=a===-1?gy(i,e):e[a+8],l===mc||!$M(n,!1)?a=-1:(o=e[Ct],a=Tp(l),e=Ip(l,e)));a!==-1;){let d=e[Ct];if(JM(s,a,d.data)){let u=uO(a,e,t,o,n,c);if(u!==Ss)return u}l=e[a+8],l!==mc&&$M(n,e[Ct].data[a+8]===c)&&JM(s,a,e)?(o=d,a=Tp(l),e=Ip(l,e)):a=-1}}return r}function uO(i,e,t,n,r,s){let o=e[Ct],a=o.data[i+8],l=n==null?Qp(a)&&lw:n!=o&&(a.type&3)!==0,c=r&Rt.Host&&s===a,d=vp(a,o,t,l,c);return d!==null?ll(e,o,d,a):Ss}function vp(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,l=i.directiveStart,c=i.directiveEnd,d=s>>20,u=n?a:a+d,h=r?a+d:c;for(let f=u;f<h;f++){let p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){let f=o[l];if(f&&na(f)&&f.type===t)return l}return null}function ll(i,e,t,n){let r=i[t],s=e.data;if(iO(r)){let o=r;o.resolving&&HN(UN(s[t]));let a=Dp(o.canSeeViewProviders);o.resolving=!0;let l,c=o.injectImpl?qi(o.injectImpl):null,d=b2(i,n,Rt.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&tO(t,s[t],e)}finally{c!==null&&qi(c),Dp(a),o.resolving=!1,E2()}}return r}function hO(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(au)?i[au]:void 0;return typeof e=="number"?e>=0?e&I2:fO:e}function JM(i,e,t){let n=1<<i;return!!(t[e+(i>>D2)]&n)}function $M(i,e){return!(i&Rt.Self)&&!(i&Rt.Host&&e)}var tl=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return k2(this._tNode,this._lView,e,qp(n),t)}};function fO(){return new tl(vi(),kt())}function es(i){return gu(()=>{let e=i.prototype.constructor,t=e[yp]||dw(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[yp]||dw(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function dw(i){return IT(i)?()=>{let e=dw(Ri(i));return e&&e()}:nl(i)}function pO(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[ht]&2048&&!(o[ht]&512);){let a=N2(s,o,t,n|Rt.Self,Ss);if(a!==Ss)return a;let l=s.parent;if(!l){let c=o[t2];if(c){let d=c.get(t,Ss,n);if(d!==Ss)return d}l=F2(o),o=o[Mc]}s=l}return r}function F2(i){let e=i[Ct],t=e.type;return t===2?e.declTNode:t===1?i[$r]:null}function vy(i){return dO(vi(),i)}function eT(i,e=null,t=null,n){let r=O2(i,e,t,n);return r.resolveInjectorInitializers(),r}function O2(i,e=null,t=null,n,r=new Set){let s=[t||br,vF(i)];return n=n||(typeof i=="object"?void 0:Li(i)),new uu(s,e||cy(),n||null,r)}var Sr=class i{static{this.THROW_IF_NOT_FOUND=cu}static{this.NULL=new _p}static create(e,t){if(Array.isArray(e))return eT({name:""},t,e,"");{let n=e.name??"";return eT({name:n},e.parent,e.providers,n)}}static{this.\u0275prov=Se({token:i,providedIn:"any",factory:()=>Me(BT)})}static{this.__NG_ELEMENT_ID__=-1}};var mO=new Je("");mO.__NG_ELEMENT_ID__=i=>{let e=vi();if(e===null)throw new ze(204,!1);if(e.type&2)return e.value;if(i&Rt.Optional)return null;throw new ze(204,!1)};var gO="ngOriginalError";function jx(i){return i[gO]}var B2=!0,sm=(()=>{class i{static{this.__NG_ELEMENT_ID__=vO}static{this.__NG_ENV_ID__=t=>t}}return i})(),uw=class extends sm{constructor(e){super(),this._lView=e}onDestroy(e){return f2(this._lView,e),()=>FF(this._lView,e)}};function vO(){return new uw(kt())}var io=(()=>{class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new pi(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>new i})}}return i})();var hw=class extends ri{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,$T()&&(this.destroyRef=ve(sm,{optional:!0})??void 0,this.pendingTasks=ve(io,{optional:!0})??void 0)}emit(e){let t=Yt(null);try{super.next(e)}finally{Yt(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof Bn&&e.add(a),a}wrapInTimeout(e){return t=>{let n=this.pendingTasks?.add();setTimeout(()=>{e(t),n!==void 0&&this.pendingTasks?.remove(n)})}}},_n=hw;function Rp(...i){}function V2(i){let e,t;function n(){i=Rp;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{i(),n()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{i(),n()})),()=>n()}function tT(i){return queueMicrotask(()=>i()),()=>{i=Rp}}var xy="isAngularZone",Lp=xy+"_ID",xO=0,sn=class i{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _n(!1),this.onMicrotaskEmpty=new _n(!1),this.onStable=new _n(!1),this.onError=new _n(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=B2}=e;if(typeof Zone>"u")throw new ze(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,bO(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(xy)===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new ze(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new ze(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,wO,Rp,Rp);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},wO={};function wy(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function yO(i){if(i.isCheckStableRunning||i.callbackScheduled)return;i.callbackScheduled=!0;function e(){V2(()=>{i.callbackScheduled=!1,fw(i),i.isCheckStableRunning=!0,wy(i),i.isCheckStableRunning=!1})}i.scheduleInRootZone?Zone.root.run(()=>{e()}):i._outer.run(()=>{e()}),fw(i)}function bO(i){let e=()=>{yO(i)},t=xO++;i._inner=i._inner.fork({name:"angular",properties:{[xy]:!0,[Lp]:t,[Lp+t]:!0},onInvokeTask:(n,r,s,o,a,l)=>{if(AO(l))return n.invokeTask(s,o,a,l);try{return nT(i),n.invokeTask(s,o,a,l)}finally{(i.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),iT(i)}},onInvoke:(n,r,s,o,a,l,c)=>{try{return nT(i),n.invoke(s,o,a,l,c)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!_O(l)&&e(),iT(i)}},onHasTask:(n,r,s,o)=>{n.hasTask(s,o),r===s&&(o.change=="microTask"?(i._hasPendingMicrotasks=o.microTask,fw(i),wy(i)):o.change=="macroTask"&&(i.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,s,o)=>(n.handleError(s,o),i.runOutsideAngular(()=>i.onError.emit(o)),!1)})}function fw(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function nT(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function iT(i){i._nesting--,wy(i)}var pw=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _n,this.onMicrotaskEmpty=new _n,this.onStable=new _n,this.onError=new _n}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}};function AO(i){return U2(i,"__ignore_ng_zone__")}function _O(i){return U2(i,"__scheduler_tick__")}function U2(i,e){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[e]===!0}var Is=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&jx(e);for(;t&&jx(t);)t=jx(t);return t||null}},SO=new Je("",{providedIn:"root",factory:()=>{let i=ve(sn),e=ve(Is);return t=>i.runOutsideAngular(()=>e.handleError(t))}});function EO(){return Tc(vi(),kt())}function Tc(i,e){return new oi(Cr(i,e))}var oi=(()=>{class i{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=EO}}return i})();function CO(i){return i instanceof oi?i.nativeElement:i}function MO(){return this._results[Symbol.iterator]()}var mw=class i{get changes(){return this._changes??=new _n}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=MO)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=JN(e);(this._changesDetected=!KN(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function H2(i){return(i.flags&128)===128}var z2=new Map,TO=0;function IO(){return TO++}function DO(i){z2.set(i[Yp],i)}function gw(i){z2.delete(i[Yp])}var rT="__ngContext__";function ia(i,e){$o(e)?(i[rT]=e[Yp],DO(e)):i[rT]=e}function j2(i){return W2(i[hu])}function G2(i){return W2(i[Kr])}function W2(i){for(;i!==null&&!no(i);)i=i[Kr];return i}var vw;function q2(i){vw=i}function PO(){if(vw!==void 0)return vw;if(typeof document<"u")return document;throw new ze(210,!1)}var yy=new Je("",{providedIn:"root",factory:()=>RO}),RO="ng",by=new Je(""),ts=new Je("",{providedIn:"platform",factory:()=>"unknown"});var om=new Je("",{providedIn:"root",factory:()=>PO().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var LO="h",kO="b";var NO=()=>null;function Ay(i,e,t=!1){return NO(i,e,t)}var Z2=!1,FO=new Je("",{providedIn:"root",factory:()=>Z2});var ap;function OO(){if(ap===void 0&&(ap=null,lu.trustedTypes))try{ap=lu.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return ap}function am(i){return OO()?.createHTML(i)||i}var lp;function BO(){if(lp===void 0&&(lp=null,lu.trustedTypes))try{lp=lu.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return lp}function sT(i){return BO()?.createScriptURL(i)||i}var $s=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${MT})`}},xw=class extends $s{getTypeName(){return"HTML"}},ww=class extends $s{getTypeName(){return"Style"}},yw=class extends $s{getTypeName(){return"Script"}},bw=class extends $s{getTypeName(){return"URL"}},Aw=class extends $s{getTypeName(){return"ResourceURL"}};function Rs(i){return i instanceof $s?i.changingThisBreaksApplicationSecurity:i}function la(i,e){let t=VO(i);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${MT})`)}return t===e}function VO(i){return i instanceof $s&&i.getTypeName()||null}function X2(i){return new xw(i)}function Y2(i){return new ww(i)}function Q2(i){return new yw(i)}function K2(i){return new bw(i)}function J2(i){return new Aw(i)}function UO(i){let e=new Sw(i);return HO()?new _w(e):e}var _w=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(am(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},Sw=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=am(e),t}};function HO(){try{return!!new window.DOMParser().parseFromString(am(""),"text/html")}catch{return!1}}var zO=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function lm(i){return i=String(i),i.match(zO)?i:"unsafe:"+i}function ro(i){let e={};for(let t of i.split(","))e[t]=!0;return e}function bu(...i){let e={};for(let t of i)for(let n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}var $2=ro("area,br,col,hr,img,wbr"),eI=ro("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),tI=ro("rp,rt"),jO=bu(tI,eI),GO=bu(eI,ro("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),WO=bu(tI,ro("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),oT=bu($2,GO,WO,jO),nI=ro("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),qO=ro("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ZO=ro("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),XO=bu(nI,qO,ZO),YO=ro("script,style,template"),Ew=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0,r=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild){r.push(t),t=JO(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=KO(t);if(s){t=s;break}t=r.pop()}}return this.buf.join("")}startElement(e){let t=aT(e).toLowerCase();if(!oT.hasOwnProperty(t))return this.sanitizedSomething=!0,!YO.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let n=e.attributes;for(let r=0;r<n.length;r++){let s=n.item(r),o=s.name,a=o.toLowerCase();if(!XO.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;nI[a]&&(l=lm(l)),this.buf.push(" ",o,'="',lT(l),'"')}return this.buf.push(">"),!0}endElement(e){let t=aT(e).toLowerCase();oT.hasOwnProperty(t)&&!$2.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(lT(e))}};function QO(i,e){return(i.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function KO(i){let e=i.nextSibling;if(e&&i!==e.previousSibling)throw iI(e);return e}function JO(i){let e=i.firstChild;if(e&&QO(i,e))throw iI(e);return e}function aT(i){let e=i.nodeName;return typeof e=="string"?e:"FORM"}function iI(i){return new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`)}var $O=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,e4=/([^\#-~ |!])/g;function lT(i){return i.replace(/&/g,"&amp;").replace($O,function(e){let t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(e4,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var cp;function rI(i,e){let t=null;try{cp=cp||UO(i);let n=e?String(e):"";t=cp.getInertBodyElement(n);let r=5,s=n;do{if(r===0)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=t.innerHTML,t=cp.getInertBodyElement(n)}while(n!==s);let a=new Ew().sanitizeChildren(cT(t)||t);return am(a)}finally{if(t){let n=cT(t)||t;for(;n.firstChild;)n.firstChild.remove()}}}function cT(i){return"content"in i&&t4(i)?i.content:null}function t4(i){return i.nodeType===Node.ELEMENT_NODE&&i.nodeName==="TEMPLATE"}var Ls=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(Ls||{});function _i(i){let e=oI();return e?e.sanitize(Ls.URL,i)||"":la(i,"URL")?Rs(i):lm(gc(i))}function _y(i){let e=oI();if(e)return sT(e.sanitize(Ls.RESOURCE_URL,i)||"");if(la(i,"ResourceURL"))return sT(Rs(i));throw new ze(904,!1)}function n4(i,e){return e==="src"&&(i==="embed"||i==="frame"||i==="iframe"||i==="media"||i==="script")||e==="href"&&(i==="base"||i==="link")?_y:_i}function sI(i,e,t){return n4(e,t)(i)}function oI(){let i=kt();return i&&i[Cs].sanitizer}var i4=/^>|^->|<!--|-->|--!>|<!-$/g,r4=/(<|>)/g,s4="\u200B$1\u200B";function o4(i){return i.replace(i4,e=>e.replace(r4,s4))}function aI(i){return i.ownerDocument}function lI(i){return i instanceof Function?i():i}function a4(i){return(i??ve(Sr)).get(ts)==="browser"}var Ds=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(Ds||{}),l4;function Sy(i,e){return l4(i,e)}function hc(i,e,t,n,r){if(n!=null){let s,o=!1;no(n)?s=n:$o(n)&&(o=!0,n=n[to]);let a=Ts(n);i===0&&t!==null?r==null?fI(e,t,a):kp(e,t,a,r||null,!0):i===1&&t!==null?kp(e,t,a,r||null,!0):i===2?S4(e,a,o):i===3&&e.destroyNode(a),s!=null&&C4(e,i,s,t,r)}}function c4(i,e){return i.createText(e)}function d4(i,e,t){i.setValue(e,t)}function u4(i,e){return i.createComment(o4(e))}function cI(i,e,t){return i.createElement(e,t)}function h4(i,e){dI(i,e),e[to]=null,e[$r]=null}function f4(i,e,t,n,r,s){n[to]=r,n[$r]=e,dm(i,n,t,1,r,s)}function dI(i,e){e[Cs].changeDetectionScheduler?.notify(9),dm(i,e,e[kn],2,null,null)}function p4(i){let e=i[hu];if(!e)return Gx(i[Ct],i);for(;e;){let t=null;if($o(e))t=e[hu];else{let n=e[ar];n&&(t=n)}if(!t){for(;e&&!e[Kr]&&e!==i;)$o(e)&&Gx(e[Ct],e),e=e[Ai];e===null&&(e=i),$o(e)&&Gx(e[Ct],e),t=e&&e[Kr]}e=t}}function m4(i,e,t,n){let r=ar+n,s=t.length;n>0&&(t[r-1][Kr]=e),n<s-ar?(e[Kr]=t[r],OT(t,ar+n,e)):(t.push(e),e[Kr]=null),e[Ai]=t;let o=e[il];o!==null&&t!==o&&uI(o,e);let a=e[Js];a!==null&&a.insertView(i),sw(e),e[ht]|=128}function uI(i,e){let t=i[bc],n=e[Ai];if($o(n))i[ht]|=Mp.HasTransplantedViews;else{let r=n[Ai][Ms];e[Ms]!==r&&(i[ht]|=Mp.HasTransplantedViews)}t===null?i[bc]=[e]:t.push(e)}function Ey(i,e){let t=i[bc],n=t.indexOf(e);t.splice(n,1)}function Cw(i,e){if(i.length<=ar)return;let t=ar+e,n=i[t];if(n){let r=n[il];r!==null&&r!==i&&Ey(r,n),e>0&&(i[t-1][Kr]=n[Kr]);let s=Ap(i,ar+e);h4(n[Ct],n);let o=s[Js];o!==null&&o.detachView(s[Ct]),n[Ai]=null,n[Kr]=null,n[ht]&=-129}return n}function hI(i,e){if(!(e[ht]&256)){let t=e[kn];t.destroyNode&&dm(i,e,t,3,null,null),p4(e)}}function Gx(i,e){if(e[ht]&256)return;let t=Yt(null);try{e[ht]&=-129,e[ht]|=256,e[Ar]&&kf(e[Ar]),v4(i,e),g4(i,e),e[Ct].type===1&&e[kn].destroy();let n=e[il];if(n!==null&&no(e[Ai])){n!==e[Ai]&&Ey(n,e);let r=e[Js];r!==null&&r.detachView(i)}gw(e)}finally{Yt(t)}}function g4(i,e){let t=i.cleanup,n=e[Ep];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[Ep]=null);let r=e[Jo];if(r!==null){e[Jo]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function v4(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof al)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],l=s[o+1];_s(4,a,l);try{l.call(a)}finally{_s(5,a,l)}}else{_s(4,r,s);try{s.call(r)}finally{_s(5,r,s)}}}}}function x4(i,e,t){return w4(i,e.parent,t)}function w4(i,e,t){let n=e;for(;n!==null&&n.type&168;)e=n,n=e.parent;if(n===null)return t[to];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===Es.None||s===Es.Emulated)return null}return Cr(n,t)}}function kp(i,e,t,n,r){i.insertBefore(e,t,n,r)}function fI(i,e,t){i.appendChild(e,t)}function dT(i,e,t,n,r){n!==null?kp(i,e,t,n,r):fI(i,e,t)}function pI(i,e){return i.parentNode(e)}function y4(i,e){return i.nextSibling(e)}function b4(i,e,t){return _4(i,e,t)}function A4(i,e,t){return i.type&40?Cr(i,t):null}var _4=A4,uT;function cm(i,e,t,n){let r=x4(i,n,e),s=e[kn],o=n.parent||e[$r],a=b4(o,n,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)dT(s,r,t[l],a,!1);else dT(s,r,t,a,!1);uT!==void 0&&uT(s,n,e,t,r)}function ou(i,e){if(e!==null){let t=e.type;if(t&3)return Cr(e,i);if(t&4)return Mw(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return ou(i,n);{let r=i[e.index];return no(r)?Mw(-1,r):Ts(r)}}else{if(t&128)return ou(i,e.next);if(t&32)return Sy(e,i)()||Ts(i[e.index]);{let n=mI(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=sl(i[Ms]);return ou(r,n)}else return ou(i,e.next)}}}return null}function mI(i,e){if(e!==null){let n=i[Ms][$r],r=e.projection;return n.projection[r]}return null}function Mw(i,e){let t=ar+i+1;if(t<e.length){let n=e[t],r=n[Ct].firstChild;if(r!==null)return ou(n,r)}return e[rl]}function S4(i,e,t){i.removeChild(null,e,t)}function Cy(i,e,t,n,r,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=n[t.index],l=t.type;if(o&&e===0&&(a&&ia(Ts(a),n),t.flags|=2),(t.flags&32)!==32)if(l&8)Cy(i,e,t.child,n,r,s,!1),hc(e,i,r,a,s);else if(l&32){let c=Sy(t,n),d;for(;d=c();)hc(e,i,r,d,s);hc(e,i,r,a,s)}else l&16?E4(i,e,n,t,r,s):hc(e,i,r,a,s);t=o?t.projectionNext:t.next}}function dm(i,e,t,n,r,s){Cy(t,n,i.firstChild,e,r,s,!1)}function E4(i,e,t,n,r,s){let o=t[Ms],l=o[$r].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];hc(e,i,r,d,s)}else{let c=l,d=o[Ai];H2(n)&&(c.flags|=128),Cy(i,e,c,d,r,s,!0)}}function C4(i,e,t,n,r){let s=t[rl],o=Ts(t);s!==o&&hc(e,i,n,s,r);for(let a=ar;a<t.length;a++){let l=t[a];dm(l[Ct],l,i,e,n,s)}}function M4(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:Ds.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Ds.Important),i.setStyle(t,n,r,s))}}function T4(i,e,t){i.setAttribute(e,"style",t)}function gI(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function vI(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&$x(i,e,n),r!==null&&gI(i,e,r),s!==null&&T4(i,e,s)}var ns={};function I(i=1){xI(Hn(),kt(),hl()+i,!1)}function xI(i,e,t,n){if(!n)if((e[ht]&3)===3){let s=i.preOrderCheckHooks;s!==null&&mp(e,s,t)}else{let s=i.preOrderHooks;s!==null&&gp(e,s,0,t)}ol(t)}function ne(i,e=Rt.Default){let t=kt();if(t===null)return Me(i,e);let n=vi();return k2(n,t,Ri(i),e)}function wI(){let i="invalid";throw new Error(i)}function yI(i,e,t,n,r,s){let o=Yt(null);try{let a=null;r&ea.SignalBased&&(a=e[n][bs]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&ea.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):i2(e,a,n,s)}finally{Yt(o)}}function I4(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)ol(~r);else{let s=r,o=t[++n],a=t[++n];XF(o,s);let l=e[s];a(2,l)}}}finally{ol(-1)}}function um(i,e,t,n,r,s,o,a,l,c,d){let u=e.blueprint.slice();return u[to]=r,u[ht]=n|4|128|8|64,(c!==null||i&&i[ht]&2048)&&(u[ht]|=2048),u2(u),u[Ai]=u[Mc]=i,u[Jr]=t,u[Cs]=o||i&&i[Cs],u[kn]=a||i&&i[kn],u[yc]=l||i&&i[yc]||null,u[$r]=s,u[Yp]=IO(),u[Sp]=d,u[t2]=c,u[Ms]=e.type==2?i[Ms]:u,u}function Au(i,e,t,n,r){let s=i.data[e];if(s===null)s=D4(i,e,t,n,r),ZF()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=jF();s.injectorIndex=o===null?-1:o.injectorIndex}return ul(s,!0),s}function D4(i,e,t,n,r){let s=g2(),o=hy(),a=o?s:s&&s.parent,l=i.data[e]=F4(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function bI(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function AI(i,e,t,n,r){let s=hl(),o=n&2;try{ol(-1),o&&e.length>_r&&xI(i,e,_r,!1),_s(o?2:0,r),t(n,r)}finally{ol(s),_s(o?3:1,r)}}function My(i,e,t){if(dy(e)){let n=Yt(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let l=t[o];a.contentQueries(1,l,o)}}}finally{Yt(n)}}}function Ty(i,e,t){m2()&&(z4(i,e,t,Cr(t,e)),(t.flags&64)===64&&EI(i,e,t))}function Iy(i,e,t=Cr){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function _I(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=Dy(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function Dy(i,e,t,n,r,s,o,a,l,c,d){let u=_r+n,h=u+r,f=P4(u,h),p=typeof c=="function"?c():c;return f[Ct]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:d}}function P4(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:ns);return t}function R4(i,e,t,n){let s=n.get(FO,Z2)||t===Es.ShadowDom,o=i.selectRootElement(e,s);return L4(o),o}function L4(i){k4(i)}var k4=()=>null;function N4(i,e,t,n){let r=TI(e);r.push(t),i.firstCreatePass&&II(i).push(n,r.length-1)}function F4(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return UF()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function hT(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,l=ea.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let c=s;if(r!==null){if(!r.hasOwnProperty(s))continue;c=r[s]}i===0?fT(n,t,c,a,l):fT(n,t,c,a)}return n}function fT(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function O4(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],l=null,c=null;for(let d=n;d<r;d++){let u=s[d],h=t?t.get(u):null,f=h?h.inputs:null,p=h?h.outputs:null;l=hT(0,u.inputs,d,l,f),c=hT(1,u.outputs,d,c,p);let v=l!==null&&o!==null&&!oy(e)?$4(l,d,o):null;a.push(v)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function B4(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function Py(i,e,t,n,r,s,o,a){let l=Cr(e,t),c=e.inputs,d;!a&&c!=null&&(d=c[n])?(Ly(i,t,d,n,r),Qp(e)&&V4(t,e.index)):e.type&3?(n=B4(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(l,n,r)):e.type&12}function V4(i,e){let t=aa(e,i);t[ht]&16||(t[ht]|=64)}function Ry(i,e,t,n){if(m2()){let r=n===null?null:{"":-1},s=G4(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&SI(i,e,t,o,r,a),r&&W4(t,n,r)}t.mergedAttrs=du(t.mergedAttrs,t.attrs)}function SI(i,e,t,n,r,s){for(let c=0;c<n.length;c++)cw(Pp(t,e),i,n[c].type);Z4(t,i.data.length,n.length);for(let c=0;c<n.length;c++){let d=n[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=bI(i,e,n.length,null);for(let c=0;c<n.length;c++){let d=n[c];t.mergedAttrs=du(t.mergedAttrs,d.hostAttrs),X4(i,t,e,l,d),q4(l,d,r),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let u=d.type.prototype;!o&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}O4(i,t,s)}function U4(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;H4(o)!=a&&o.push(a),o.push(t,n,s)}}function H4(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function z4(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;Qp(t)&&Y4(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||Pp(t,e),ia(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let l=i.data[a],c=ll(e,i,a,t);if(ia(c,e),o!==null&&J4(e,a-r,c,l,t,o),na(l)){let d=aa(t.index,e);d[Jr]=ll(e,i,a,t)}}}function EI(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=YF();try{ol(s);for(let a=n;a<r;a++){let l=i.data[a],c=e[a];ow(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&j4(l,c)}}finally{ol(-1),ow(o)}}function j4(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function G4(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(lF(e,o.selectors,!1))if(n||(n=[]),na(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let l=a.length;Tw(i,e,l)}else n.unshift(o),Tw(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function Tw(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function W4(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new ze(-301,!1);n.push(e[r],s)}}}function q4(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;na(e)&&(t[""]=i)}}function Z4(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function X4(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=nl(r.type,!0)),o=new al(s,na(r),ne);i.blueprint[n]=o,t[n]=o,U4(i,e,n,bI(i,t,r.hostVars,ns),r)}function Y4(i,e,t){let n=Cr(e,i),r=_I(t),s=i[Cs].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=hm(i,um(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function Q4(i,e,t,n,r,s){let o=Cr(i,e);K4(e[kn],o,s,i.value,t,n,r)}function K4(i,e,t,n,r,s,o){if(s==null)i.removeAttribute(e,r,t);else{let a=o==null?gc(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}function J4(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],c=o[a++],d=o[a++],u=o[a++];yI(n,t,l,c,d,u)}}function $4(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function CI(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function MI(i,e){let t=i.contentQueries;if(t!==null){let n=Yt(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];fy(s),a.contentQueries(2,e[o],o)}}}finally{Yt(n)}}}function hm(i,e){return i[hu]?i[XM][Kr]=e:i[hu]=e,i[XM]=e,e}function Iw(i,e,t){fy(0);let n=Yt(null);try{e(i,t)}finally{Yt(n)}}function TI(i){return i[Ep]??=[]}function II(i){return i.cleanup??=[]}function DI(i,e){let t=i[yc],n=t?t.get(Is,null):null;n&&n.handleError(e)}function Ly(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],l=t[s++],c=e[o],d=i.data[o];yI(d,c,n,a,l,r)}}function PI(i,e,t){let n=l2(e,i);d4(i[kn],n,t)}function eB(i,e){let t=aa(e,i),n=t[Ct];tB(n,t);let r=t[to];r!==null&&t[Sp]===null&&(t[Sp]=Ay(r,t[yc])),ky(n,t,t[Jr])}function tB(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function ky(i,e,t){py(e);try{let n=i.viewQuery;n!==null&&Iw(1,n,t);let r=i.template;r!==null&&AI(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[Js]?.finishViewCreation(i),i.staticContentQueries&&MI(i,e),i.staticViewQueries&&Iw(2,i.viewQuery,t);let s=i.components;s!==null&&nB(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[ht]&=-5,my()}}function nB(i,e){for(let t=0;t<e.length;t++)eB(i,e[t])}function iB(i,e,t,n){let r=Yt(null);try{let s=e.tView,a=i[ht]&4096?4096:16,l=um(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),c=i[e.index];l[il]=c;let d=i[Js];return d!==null&&(l[Js]=d.createEmbeddedView(s)),ky(s,l,t),l}finally{Yt(r)}}function pT(i,e){return!e||e.firstChild===null||H2(i)}function rB(i,e,t,n=!0){let r=e[Ct];if(m4(r,e,i,t),n){let o=Mw(t,i),a=e[kn],l=pI(a,i[rl]);l!==null&&f4(r,i[$r],a,e,l,o)}let s=e[Sp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Np(i,e,t,n,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&n.push(Ts(s)),no(s)&&sB(s,n);let o=t.type;if(o&8)Np(i,e,t.child,n);else if(o&32){let a=Sy(t,e),l;for(;l=a();)n.push(l)}else if(o&16){let a=mI(e,t);if(Array.isArray(a))n.push(...a);else{let l=sl(e[Ms]);Np(l[Ct],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function sB(i,e){for(let t=ar;t<i.length;t++){let n=i[t],r=n[Ct].firstChild;r!==null&&Np(n[Ct],n,r,e)}i[rl]!==i[to]&&e.push(i[rl])}var RI=[];function oB(i){return i[Ar]??aB(i)}function aB(i){let e=RI.pop()??Object.create(cB);return e.lView=i,e}function lB(i){i.lView[Ar]!==i&&(i.lView=null,RI.push(i))}var cB=Ge(re({},ec),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{$p(i.lView)},consumerOnSignalRead(){this.lView[Ar]=this}});function dB(i){let e=i[Ar]??Object.create(uB);return e.lView=i,e}var uB=Ge(re({},ec),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{let e=sl(i.lView);for(;e&&!LI(e[Ct]);)e=sl(e);e&&h2(e)},consumerOnSignalRead(){this.lView[Ar]=this}});function LI(i){return i.type!==2}var hB=100;function kI(i,e=!0,t=0){let n=i[Cs],r=n.rendererFactory,s=!1;s||r.begin?.();try{fB(i,t)}catch(o){throw e&&DI(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function fB(i,e){let t=x2();try{QM(!0),Dw(i,e);let n=0;for(;Jp(i);){if(n===hB)throw new ze(103,!1);n++,Dw(i,1)}}finally{QM(t)}}function pB(i,e,t,n){let r=e[ht];if((r&256)===256)return;let s=!1,o=!1;!s&&e[Cs].inlineEffectRunner?.flush(),py(e);let a=!0,l=null,c=null;s||(LI(i)?(c=oB(e),l=iu(c)):JC()===null?(a=!1,c=dB(e),l=iu(c)):e[Ar]&&(kf(e[Ar]),e[Ar]=null));try{u2(e),qF(i.bindingStartIndex),t!==null&&AI(i,e,t,2,n);let d=(r&3)===3;if(!s)if(d){let f=i.preOrderCheckHooks;f!==null&&mp(e,f,null)}else{let f=i.preOrderHooks;f!==null&&gp(e,f,0,null),Ux(e,0)}if(o||mB(e),NI(e,0),i.contentQueries!==null&&MI(i,e),!s)if(d){let f=i.contentCheckHooks;f!==null&&mp(e,f)}else{let f=i.contentHooks;f!==null&&gp(e,f,1),Ux(e,1)}I4(i,e);let u=i.components;u!==null&&OI(e,u,0);let h=i.viewQuery;if(h!==null&&Iw(2,h,n),!s)if(d){let f=i.viewCheckHooks;f!==null&&mp(e,f)}else{let f=i.viewHooks;f!==null&&gp(e,f,2),Ux(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[pp]){for(let f of e[pp])f();e[pp]=null}s||(e[ht]&=-73)}catch(d){throw s||$p(e),d}finally{c!==null&&(Rf(c,l),a&&lB(c)),my()}}function NI(i,e){for(let t=j2(i);t!==null;t=G2(t))for(let n=ar;n<t.length;n++){let r=t[n];FI(r,e)}}function mB(i){for(let e=j2(i);e!==null;e=G2(e)){if(!(e[ht]&Mp.HasTransplantedViews))continue;let t=e[bc];for(let n=0;n<t.length;n++){let r=t[n];h2(r)}}}function gB(i,e,t){let n=aa(e,i);FI(n,t)}function FI(i,e){uy(i)&&Dw(i,e)}function Dw(i,e){let n=i[Ct],r=i[ht],s=i[Ar],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&Lf(s)),o||=!1,s&&(s.dirty=!1),i[ht]&=-9217,o)pB(n,i,n.template,i[Jr]);else if(r&8192){NI(i,1);let a=n.components;a!==null&&OI(i,a,1)}}function OI(i,e,t){for(let n=0;n<e.length;n++)gB(i,e[n],t)}function Ny(i,e){let t=x2()?64:1088;for(i[Cs].changeDetectionScheduler?.notify(e);i;){i[ht]|=t;let n=sl(i);if(iw(i)&&!n)return i;i=n}return null}var cl=class{get rootNodes(){let e=this._lView,t=e[Ct];return Np(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Jr]}set context(e){this._lView[Jr]=e}get destroyed(){return(this._lView[ht]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ai];if(no(e)){let t=e[Cp],n=t?t.indexOf(this):-1;n>-1&&(Cw(e,n),Ap(t,n))}this._attachedToViewContainer=!1}hI(this._lView[Ct],this._lView)}onDestroy(e){f2(this._lView,e)}markForCheck(){Ny(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ht]&=-129}reattach(){sw(this._lView),this._lView[ht]|=128}detectChanges(){this._lView[ht]|=1024,kI(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ze(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=iw(this._lView),t=this._lView[il];t!==null&&!e&&Ey(t,this._lView),dI(this._lView[Ct],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ze(902,!1);this._appRef=e;let t=iw(this._lView),n=this._lView[il];n!==null&&!t&&uI(n,this._lView),sw(this._lView)}},ra=(()=>{class i{static{this.__NG_ELEMENT_ID__=wB}}return i})(),vB=ra,xB=class extends vB{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=iB(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new cl(r)}};function wB(){return fm(vi(),kt())}function fm(i,e){return i.type&4?new xB(e,i,Tc(i,e)):null}var eae=new RegExp(`^(\\d+)*(${kO}|${LO})*(.*)`);var yB=()=>null;function mT(i,e){return yB(i,e)}var _c=class{},Fy=new Je("",{providedIn:"root",factory:()=>!1});var BI=new Je(""),VI=new Je(""),Pw=class{},Fp=class{};function bB(i){let e=Error(`No component factory found for ${Li(i)}.`);return e[AB]=i,e}var AB="ngComponent";var Rw=class{resolveComponentFactory(e){throw bB(e)}},Sc=class{static{this.NULL=new Rw}},sa=class{},Fi=(()=>{class i{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>_B()}}return i})();function _B(){let i=kt(),e=vi(),t=aa(e.index,i);return($o(t)?t:i)[kn]}var SB=(()=>{class i{static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>null})}}return i})();function Op(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=BM(r,a);else if(s==2){let l=a,c=e[++o];n=BM(n,l+": "+c+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var Bp=class extends Sc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ta(e);return new Ec(t,this.ngModule)}};function gT(i,e){let t=[];for(let n in i){if(!i.hasOwnProperty(n))continue;let r=i[n];if(r===void 0)continue;let s=Array.isArray(r),o=s?r[0]:r,a=s?r[1]:ea.None;e?t.push({propName:o,templateName:n,isSignal:(a&ea.SignalBased)!==0}):t.push({propName:o,templateName:n})}return t}function EB(i){let e=i.toLowerCase();return e==="svg"?a2:e==="math"?RF:null}var Ec=class extends Fp{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=gT(e.inputs,!0);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return gT(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=hF(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=Yt(null);try{r=r||this.ngModule;let o=r instanceof ki?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new aw(e,o):e,l=a.get(sa,null);if(l===null)throw new ze(407,!1);let c=a.get(SB,null),d=a.get(_c,null),u={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,changeDetectionScheduler:d},h=l.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=n?R4(h,n,this.componentDef.encapsulation,a):cI(h,f,EB(f)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let g=null;p!==null&&(g=Ay(p,a,!0));let m=Dy(0,null,null,1,0,null,null,null,null,null,null),y=um(null,m,null,v,null,null,u,h,a,null,g);py(y);let w,A,C=null;try{let E=this.componentDef,T,L=null;E.findHostDirectiveDefs?(T=[],L=new Map,E.findHostDirectiveDefs(E,T,L),T.push(E)):T=[E];let S=CB(y,p);C=MB(S,p,E,T,y,u,h),A=c2(m,_r),p&&DB(h,E,p,n),t!==void 0&&PB(A,this.ngContentSelectors,t),w=IB(C,E,T,L,y,[RB]),ky(m,y,null)}catch(E){throw C!==null&&gw(C),gw(y),E}finally{my()}return new Lw(this.componentType,w,Tc(A,y),y,A)}finally{Yt(s)}}},Lw=class extends Pw{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new cl(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Ly(s[Ct],s,r,e,t),this.previousInputValues.set(e,t);let o=aa(this._tNode.index,s);Ny(o,1)}}get injector(){return new tl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function CB(i,e){let t=i[Ct],n=_r;return i[n]=e,Au(t,n,2,"#host",null)}function MB(i,e,t,n,r,s,o){let a=r[Ct];TB(n,i,e,o);let l=null;e!==null&&(l=Ay(e,r[yc]));let c=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let u=um(r,_I(t),null,d,r[i.index],i,s,c,null,null,l);return a.firstCreatePass&&Tw(a,i,n.length-1),hm(r,u),r[i.index]=u}function TB(i,e,t,n){for(let r of i)e.mergedAttrs=du(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(Op(e,e.mergedAttrs,!0),t!==null&&vI(n,t,e))}function IB(i,e,t,n,r,s){let o=vi(),a=r[Ct],l=Cr(o,r);SI(a,r,o,t,null,n);for(let d=0;d<t.length;d++){let u=o.directiveStart+d,h=ll(r,a,u,o);ia(h,r)}EI(a,r,o),l&&ia(l,r);let c=ll(r,a,o.directiveStart+o.componentOffset,o);if(i[Jr]=r[Jr]=c,s!==null)for(let d of s)d(c,e);return My(a,o,r),c}function DB(i,e,t,n){if(n)$x(i,t,["ng-version","18.2.11"]);else{let{attrs:r,classes:s}=fF(e.selectors[0]);r&&$x(i,t,r),s&&s.length>0&&gI(i,t,s.join(" "))}}function PB(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function RB(){let i=vi();rm(kt()[Ct],i)}var ca=(()=>{class i{static{this.__NG_ELEMENT_ID__=LB}}return i})();function LB(){let i=vi();return HI(i,kt())}var kB=ca,UI=class extends kB{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Tc(this._hostTNode,this._hostLView)}get injector(){return new tl(this._hostTNode,this._hostLView)}get parentInjector(){let e=gy(this._hostTNode,this._hostLView);if(T2(e)){let t=Ip(e,this._hostLView),n=Tp(e),r=t[Ct].data[n+8];return new tl(r,t)}else return new tl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=vT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ar}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=mT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,pT(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!TF(e),a;if(o)a=t;else{let p=t||{};a=p.index,n=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=o?e:new Ec(ta(e)),c=n||this.parentInjector;if(!s&&l.ngModule==null){let v=(o?c:this.parentInjector).get(ki,null);v&&(s=v)}let d=ta(l.componentType??{}),u=mT(this._lContainer,d?.id??null),h=u?.firstChild??null,f=l.create(c,r,h,s);return this.insertImpl(f.hostView,a,pT(this._hostTNode,u)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(kF(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Ai],c=new UI(l,l[$r],l[Ai]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return rB(o,r,s,n),e.attachToViewContainerRef(),OT(Wx(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=vT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=Cw(this._lContainer,t);n&&(Ap(Wx(this._lContainer),t),hI(n[Ct],n))}detach(e){let t=this._adjustIndex(e,-1),n=Cw(this._lContainer,t);return n&&Ap(Wx(this._lContainer),t)!=null?new cl(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function vT(i){return i[Cp]}function Wx(i){return i[Cp]||(i[Cp]=[])}function HI(i,e){let t,n=e[i.index];return no(n)?t=n:(t=CI(n,e,null,i),e[i.index]=t,hm(e,t)),FB(t,e,i,n),new UI(t,i,e)}function NB(i,e){let t=i[kn],n=t.createComment(""),r=Cr(e,i),s=pI(t,r);return kp(t,s,n,y4(t,r),!1),n}var FB=VB,OB=()=>!1;function BB(i,e,t){return OB(i,e,t)}function VB(i,e,t,n){if(i[rl])return;let r;t.type&8?r=Ts(n):r=NB(e,t),i[rl]=r}var kw=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},Nw=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Oy(e,t).matches!==null&&this.queries[t].setDirty()}},Vp=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=ZB(e):this.predicate=e}},Fw=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Ow=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,UB(t,s)),this.matchTNodeWithReadOption(e,t,vp(t,e,s,!1,!1))}else n===ra?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,vp(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===oi||r===ca||r===ra&&t.type&4)this.addMatch(t.index,-2);else{let s=vp(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function UB(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function HB(i,e){return i.type&11?Tc(i,e):i.type&4?fm(i,e):null}function zB(i,e,t,n){return t===-1?HB(e,i):t===-2?jB(i,e,n):ll(i,i[Ct],t,e)}function jB(i,e,t){if(t===oi)return Tc(e,i);if(t===ra)return fm(e,i);if(t===ca)return HI(e,i)}function zI(i,e,t,n){let r=e[Js].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let l=0;o!==null&&l<o.length;l+=2){let c=o[l];if(c<0)a.push(null);else{let d=s[c];a.push(zB(e,d,o[l+1],t.metadata.read))}}r.matches=a}return r.matches}function Bw(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=zI(i,e,r,t);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)n.push(o[a/2]);else{let c=s[a+1],d=e[-l];for(let u=ar;u<d.length;u++){let h=d[u];h[il]===h[Ai]&&Bw(h[Ct],h,c,n)}if(d[bc]!==null){let u=d[bc];for(let h=0;h<u.length;h++){let f=u[h];Bw(f[Ct],f,c,n)}}}}}return n}function GB(i,e){return i[Js].queries[e].queryList}function jI(i,e,t){let n=new mw((t&4)===4);return N4(i,e,n,n.destroy),(e[Js]??=new Nw).queries.push(new kw(n))-1}function WB(i,e,t){let n=Hn();return n.firstCreatePass&&(GI(n,new Vp(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),jI(n,kt(),e)}function qB(i,e,t,n){let r=Hn();if(r.firstCreatePass){let s=vi();GI(r,new Vp(e,t,n),s.index),XB(r,i),(t&2)===2&&(r.staticContentQueries=!0)}return jI(r,kt(),t)}function ZB(i){return i.split(",").map(e=>e.trim())}function GI(i,e,t){i.queries===null&&(i.queries=new Fw),i.queries.track(new Ow(e,t))}function XB(i,e){let t=i.contentQueries||(i.contentQueries=[]),n=t.length?t[t.length-1]:-1;e!==n&&t.push(i.queries.length-1,e)}function Oy(i,e){return i.queries.getByIndex(e)}function YB(i,e){let t=i[Ct],n=Oy(t,e);return n.crossesNgTemplate?Bw(t,i,e,[]):zI(t,i,n,e)}var xT=new Set;function fl(i){xT.has(i)||(xT.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function QB(i){return typeof i=="function"&&i[bs]!==void 0}function pl(i,e){fl("NgSignals");let t=dM(i),n=t[bs];return e?.equal&&(n.equal=e.equal),t.set=r=>bx(n,r),t.update=r=>uM(n,r),t.asReadonly=KB.bind(t),t}function KB(){let i=this[bs];if(i.readonlyFn===void 0){let e=()=>this();e[bs]=i,i.readonlyFn=e}return i.readonlyFn}function WI(i){return QB(i)&&typeof i.set=="function"}function JB(i){return Object.getPrototypeOf(i.prototype).constructor}function Zi(i){let e=JB(i.type),t=!0,n=[i];for(;e;){let r;if(na(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ze(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);let o=i;o.inputs=dp(i.inputs),o.inputTransforms=dp(i.inputTransforms),o.declaredInputs=dp(i.declaredInputs),o.outputs=dp(i.outputs);let a=r.hostBindings;a&&i5(i,a);let l=r.viewQuery,c=r.contentQueries;if(l&&t5(i,l),c&&n5(i,c),$B(i,r),RN(i.outputs,r.outputs),na(r)&&r.data.animation){let d=i.data;d.animation=(d.animation||[]).concat(r.data.animation)}}let s=r.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(i),a===Zi&&(t=!1)}}e=Object.getPrototypeOf(e)}e5(n)}function $B(i,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||i.inputs.hasOwnProperty(t))continue;let n=e.inputs[t];if(n!==void 0&&(i.inputs[t]=n,i.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let r=Array.isArray(n)?n[0]:n;if(!e.inputTransforms.hasOwnProperty(r))continue;i.inputTransforms??={},i.inputTransforms[r]=e.inputTransforms[r]}}}function e5(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){let r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=du(r.hostAttrs,t=du(t,r.hostAttrs))}}function dp(i){return i===vc?{}:i===br?[]:i}function t5(i,e){let t=i.viewQuery;t?i.viewQuery=(n,r)=>{e(n,r),t(n,r)}:i.viewQuery=e}function n5(i,e){let t=i.contentQueries;t?i.contentQueries=(n,r,s)=>{e(n,r,s),t(n,r,s)}:i.contentQueries=e}function i5(i,e){let t=i.hostBindings;t?i.hostBindings=(n,r)=>{e(n,r),t(n,r)}:i.hostBindings=e}function By(i){let e=i.inputConfig,t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];Array.isArray(r)&&r[3]&&(t[n]=r[3])}i.inputTransforms=t}var oa=class{},fu=class{};var Vw=class extends oa{constructor(e,t,n,r=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Bp(this);let s=qT(e);this._bootstrapComponents=lI(s.bootstrap),this._r3Injector=O2(e,t,[{provide:oa,useValue:this},{provide:Sc,useValue:this.componentFactoryResolver},...n],Li(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Uw=class extends fu{constructor(e){super(),this.moduleType=e}create(e){return new Vw(this.moduleType,e,[])}};var Up=class extends oa{constructor(e){super(),this.componentFactoryResolver=new Bp(this),this.instance=null;let t=new uu([...e.providers,{provide:oa,useValue:this},{provide:Sc,useValue:this.componentFactoryResolver}],e.parent||cy(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function pm(i,e,t=null){return new Up({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function qI(i){return Vy(i)?Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i:!1}function r5(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{let t=i[Symbol.iterator](),n;for(;!(n=t.next()).done;)e(n.value)}}function Vy(i){return i!==null&&(typeof i=="function"||typeof i=="object")}function _u(i,e,t){return i[e]=t}function s5(i,e){return i[e]}function eo(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function pu(i,e,t,n){let r=eo(i,e,t);return eo(i,e+1,n)||r}function o5(i,e,t,n,r){let s=pu(i,e,t,n);return eo(i,e+2,r)||s}function a5(i,e,t,n,r,s){let o=pu(i,e,t,n);return pu(i,e+2,r,s)||o}function l5(i){return(i.flags&32)===32}function c5(i,e,t,n,r,s,o,a,l){let c=e.consts,d=Au(e,i,4,o||null,a||null);Ry(e,t,d,Ac(c,l)),rm(e,d);let u=d.tView=Dy(2,d,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,d),u.queries=e.queries.embeddedTView(d)),d}function d5(i,e,t,n,r,s,o,a,l,c){let d=t+_r,u=e.firstCreatePass?c5(d,e,i,n,r,s,o,a,l):e.data[d];ul(u,!1);let h=u5(e,i,u,t);nm()&&cm(e,i,h,u),ia(h,i);let f=CI(h,i,h,u);return i[d]=f,hm(i,f),BB(f,u,i),Kp(u)&&Ty(e,i,u),l!=null&&Iy(i,u,c),u}function ee(i,e,t,n,r,s,o,a){let l=kt(),c=Hn(),d=Ac(c.consts,s);return d5(l,c,i,e,t,n,r,d,o,a),ee}var u5=h5;function h5(i,e,t,n){return im(!0),e[kn].createComment("")}var fc=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(fc||{}),ZI=(()=>{class i{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>new i})}}return i})(),Hw=class i{constructor(){this.ngZone=ve(sn),this.scheduler=ve(_c),this.errorHandler=ve(Is,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[fc.EarlyRead,fc.Write,fc.MixedReadWrite,fc.Read]}execute(){this.executing=!0;for(let e of i.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(n){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(n)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>new i})}},zw=class{constructor(e,t,n,r){this.impl=e,this.hooks=t,this.once=n,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Uy(i,e){!e?.injector&&e2(Uy);let t=e?.injector??ve(Sr);return a4(t)?(fl("NgAfterNextRender"),p5(i,t,e,!0)):m5}function f5(i,e){if(i instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=i,t}else return[i.earlyRead,i.write,i.mixedReadWrite,i.read]}function p5(i,e,t,n){let r=e.get(ZI);r.impl??=e.get(Hw);let s=t?.phase??fc.MixedReadWrite,o=t?.manualCleanup!==!0?e.get(sm):null,a=new zw(r.impl,f5(i,s),n,o);return r.impl.register(a),a}var m5={destroy(){}};function Ic(i,e,t,n){let r=kt(),s=em();if(eo(r,s,e)){let o=Hn(),a=tm();Q4(a,r,i,e,t,n)}return Ic}function XI(i,e,t,n){return eo(i,em(),t)?e+gc(t)+n:ns}function g5(i,e,t,n,r,s){let o=WF(),a=pu(i,o,t,r);return w2(2),a?e+gc(t)+n+gc(r)+s:ns}function up(i,e){return i<<17|e<<2}function dl(i){return i>>17&32767}function v5(i){return(i&2)==2}function x5(i,e){return i&131071|e<<17}function jw(i){return i|2}function Cc(i){return(i&131068)>>2}function qx(i,e){return i&-131069|e<<2}function w5(i){return(i&1)===1}function Gw(i){return i|1}function y5(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=dl(o),l=Cc(o);i[n]=t;let c=!1,d;if(Array.isArray(t)){let u=t;d=u[1],(d===null||xu(u,d)>0)&&(c=!0)}else d=t;if(r)if(l!==0){let h=dl(i[a+1]);i[n+1]=up(h,a),h!==0&&(i[h+1]=qx(i[h+1],n)),i[a+1]=x5(i[a+1],n)}else i[n+1]=up(a,0),a!==0&&(i[a+1]=qx(i[a+1],n)),a=n;else i[n+1]=up(l,0),a===0?a=n:i[l+1]=qx(i[l+1],n),l=n;c&&(i[n+1]=jw(i[n+1])),wT(i,d,n,!0),wT(i,d,n,!1),b5(e,d,i,n,s),o=up(a,l),s?e.classBindings=o:e.styleBindings=o}function b5(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&xu(s,e)>=0&&(t[n+1]=Gw(t[n+1]))}function wT(i,e,t,n){let r=i[t+1],s=e===null,o=n?dl(r):Cc(r),a=!1;for(;o!==0&&(a===!1||s);){let l=i[o],c=i[o+1];A5(l,e)&&(a=!0,i[o+1]=n?Gw(c):jw(c)),o=n?dl(c):Cc(c)}a&&(i[t+1]=n?jw(r):Gw(r))}function A5(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?xu(i,e)>=0:!1}function F(i,e,t){let n=kt(),r=em();if(eo(n,r,e)){let s=Hn(),o=tm();Py(s,o,n,i,e,n[kn],t,!1)}return F}function yT(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";Ly(i,t,s[o],o,n)}function Su(i,e){return _5(i,e,null,!0),Su}function _5(i,e,t,n){let r=kt(),s=Hn(),o=w2(2);if(s.firstUpdatePass&&E5(s,i,o,n),e!==ns&&eo(r,o,e)){let a=s.data[hl()];D5(s,a,r,r[kn],i,r[o+1]=P5(e,t),n,o)}}function S5(i,e){return e>=i.expandoStartIndex}function E5(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[hl()],o=S5(i,t);R5(s,n)&&e===null&&!o&&(e=!1),e=C5(r,s,e,n),y5(r,s,e,t,o,n)}}function C5(i,e,t,n){let r=QF(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=Zx(null,i,e,t,n),t=mu(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=Zx(r,i,e,t,n),s===null){let l=M5(i,e,n);l!==void 0&&Array.isArray(l)&&(l=Zx(null,i,e,l[1],n),l=mu(l,e.attrs,n),T5(i,e,n,l))}else s=I5(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function M5(i,e,t){let n=t?e.classBindings:e.styleBindings;if(Cc(n)!==0)return i[dl(n)]}function T5(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[dl(r)]=n}function I5(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=mu(n,o,t)}return mu(n,e.attrs,t)}function Zx(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=mu(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function mu(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),eF(i,o,t?!0:e[++s]))}return i===void 0?null:i}function D5(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let l=i.data,c=l[a+1],d=w5(c)?bT(l,e,t,r,Cc(c),o):void 0;if(!Hp(d)){Hp(s)||v5(c)&&(s=bT(l,null,t,r,a,o));let u=l2(hl(),t);M4(n,o,u,r,s)}}function bT(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let l=i[r],c=Array.isArray(l),d=c?l[1]:l,u=d===null,h=t[r+1];h===ns&&(h=u?br:void 0);let f=u?Bx(h,n):d===n?h:void 0;if(c&&!Hp(f)&&(f=Bx(l,n)),Hp(f)&&(a=f,o))return a;let p=i[r+1];r=o?dl(p):Cc(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=Bx(l,n))}return a}function Hp(i){return i!==void 0}function P5(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=Li(Rs(i)))),i}function R5(i,e){return(i.flags&(e?8:16))!==0}function L5(i,e,t,n,r,s){let o=e.consts,a=Ac(o,r),l=Au(e,i,2,n,a);return Ry(e,t,l,Ac(o,s)),l.attrs!==null&&Op(l,l.attrs,!1),l.mergedAttrs!==null&&Op(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function x(i,e,t,n){let r=kt(),s=Hn(),o=_r+i,a=r[kn],l=s.firstCreatePass?L5(o,s,r,e,t,n):s.data[o],c=k5(s,r,l,a,e,i);r[o]=c;let d=Kp(l);return ul(l,!0),vI(a,c,l),!l5(l)&&nm()&&cm(s,r,c,l),OF()===0&&ia(c,r),BF(),d&&(Ty(s,r,l),My(s,l,r)),n!==null&&Iy(r,l),x}function b(){let i=vi();hy()?v2():(i=i.parent,ul(i,!1));let e=i;HF(e)&&zF(),VF();let t=Hn();return t.firstCreatePass&&(rm(t,i),dy(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&rO(e)&&yT(t,e,kt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&sO(e)&&yT(t,e,kt(),e.stylesWithoutHost,!1),b}function B(i,e,t,n){return x(i,e,t,n),b(),B}var k5=(i,e,t,n,r,s)=>(im(!0),cI(n,r,eO()));function N5(i,e,t,n,r){let s=e.consts,o=Ac(s,n),a=Au(e,i,8,"ng-container",o);o!==null&&Op(a,o,!0);let l=Ac(s,r);return Ry(e,t,a,l),e.queries!==null&&e.queries.elementStart(e,a),a}function Hy(i,e,t){let n=kt(),r=Hn(),s=i+_r,o=r.firstCreatePass?N5(s,r,n,e,t):r.data[s];ul(o,!0);let a=F5(r,n,o,i);return n[s]=a,nm()&&cm(r,n,a,o),ia(a,n),Kp(o)&&(Ty(r,n,o),My(r,o,n)),t!=null&&Iy(n,o),Hy}function zy(){let i=vi(),e=Hn();return hy()?v2():(i=i.parent,ul(i,!1)),e.firstCreatePass&&(rm(e,i),dy(i)&&e.queries.elementEnd(i)),zy}var F5=(i,e,t,n)=>(im(!0),u4(e[kn],""));function rt(){return kt()}var zp="en-US";var O5=zp;function B5(i){typeof i=="string"&&(O5=i.toLowerCase().replace(/_/g,"-"))}var V5=(i,e,t)=>{};function Z(i,e,t,n){let r=kt(),s=Hn(),o=vi();return YI(s,r,r[kn],o,i,e,n),Z}function U5(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[Ep],l=r[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function YI(i,e,t,n,r,s,o){let a=Kp(n),c=i.firstCreatePass&&II(i),d=e[Jr],u=TI(e),h=!0;if(n.type&3||o){let v=Cr(n,e),g=o?o(v):v,m=u.length,y=o?A=>o(Ts(A[n.index])):n.index,w=null;if(!o&&a&&(w=U5(i,e,r,n.index)),w!==null){let A=w.__ngLastListenerFn__||w;A.__ngNextListenerFn__=s,w.__ngLastListenerFn__=s,h=!1}else{s=_T(n,e,d,s),V5(v,r,s);let A=t.listen(g,r,s);u.push(s,A),c&&c.push(r,y,m,m+1)}}else s=_T(n,e,d,s);let f=n.outputs,p;if(h&&f!==null&&(p=f[r])){let v=p.length;if(v)for(let g=0;g<v;g+=2){let m=p[g],y=p[g+1],C=e[m][y].subscribe(s),E=u.length;u.push(s,C),c&&c.push(r,n.index,E,-(E+1))}}}function AT(i,e,t,n){let r=Yt(null);try{return _s(6,e,t),t(n)!==!1}catch(s){return DI(i,s),!1}finally{_s(7,e,t),Yt(r)}}function _T(i,e,t,n){return function r(s){if(s===Function)return n;let o=i.componentOffset>-1?aa(i.index,e):e;Ny(o,5);let a=AT(e,t,n,s),l=r.__ngNextListenerFn__;for(;l;)a=AT(e,t,l,s)&&a,l=l.__ngNextListenerFn__;return a}}function Y(i=1){return JF(i)}function Eu(i,e,t){return Mr(i,"",e,"",t),Eu}function Mr(i,e,t,n,r){let s=kt(),o=XI(s,e,t,n);if(o!==ns){let a=Hn(),l=tm();Py(a,l,s,i,o,s[kn],r,!1)}return Mr}function QI(i,e,t,n){qB(i,e,t,n)}function ai(i,e,t){WB(i,e,t)}function zn(i){let e=kt(),t=Hn(),n=y2();fy(n+1);let r=Oy(t,n);if(i.dirty&&LF(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let s=YB(e,n);i.reset(s,CO),i.notifyOnChanges()}return!0}return!1}function jn(){return GB(kt(),y2())}function H5(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}function is(i){let e=GF();return d2(e,_r+i)}function M(i,e=""){let t=kt(),n=Hn(),r=i+_r,s=n.firstCreatePass?Au(n,r,1,e,null):n.data[r],o=z5(n,t,s,e,i);t[r]=o,nm()&&cm(n,t,o,s),ul(s,!1)}var z5=(i,e,t,n,r)=>(im(!0),c4(e[kn],n));function ge(i){return Qt("",i,""),ge}function Qt(i,e,t){let n=kt(),r=XI(n,i,e,t);return r!==ns&&PI(n,hl(),r),Qt}function jy(i,e,t,n,r){let s=kt(),o=g5(s,i,e,t,n,r);return o!==ns&&PI(s,hl(),o),jy}function tt(i,e,t){WI(e)&&(e=e());let n=kt(),r=em();if(eo(n,r,e)){let s=Hn(),o=tm();Py(s,o,n,i,e,n[kn],t,!1)}return tt}function it(i,e){let t=WI(i);return t&&i.set(e),t}function nt(i,e){let t=kt(),n=Hn(),r=vi();return YI(n,t,t[kn],r,i,e),nt}function j5(i,e,t){let n=Hn();if(n.firstCreatePass){let r=na(i);Ww(t,n.data,n.blueprint,r,!0),Ww(e,n.data,n.blueprint,r,!1)}}function Ww(i,e,t,n,r){if(i=Ri(i),Array.isArray(i))for(let s=0;s<i.length;s++)Ww(i[s],e,t,n,r);else{let s=Hn(),o=kt(),a=vi(),l=wc(i)?i:Ri(i.provide),c=JT(i),d=a.providerIndexes&1048575,u=a.directiveStart,h=a.providerIndexes>>20;if(wc(i)||!i.multi){let f=new al(c,r,ne),p=Yx(l,e,r?d:d+h,u);p===-1?(cw(Pp(a,o),s,l),Xx(s,i,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{let f=Yx(l,e,d+h,u),p=Yx(l,e,d,d+h),v=f>=0&&t[f],g=p>=0&&t[p];if(r&&!g||!r&&!v){cw(Pp(a,o),s,l);let m=q5(r?W5:G5,t.length,r,n,c);!r&&g&&(t[p].providerFactory=m),Xx(s,i,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)}else{let m=KI(t[r?p:f],c,!r&&n);Xx(s,i,f>-1?f:p,m)}!r&&n&&g&&t[p].componentProviders++}}}function Xx(i,e,t,n){let r=wc(e),s=bF(e);if(r||s){let l=(s?Ri(e.useClass):e).prototype.ngOnDestroy;if(l){let c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[n,l]):c[d+1].push(n,l)}else c.push(t,l)}}}function KI(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function Yx(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function G5(i,e,t,n){return qw(this.multi,[])}function W5(i,e,t,n){let r=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ll(t,t[Ct],this.providerFactory.index,n);s=a.slice(0,o),qw(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],qw(r,s);return s}function qw(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function q5(i,e,t,n,r){let s=new al(i,t,ne);return s.multi=[],s.index=e,s.componentProviders=0,KI(s,r,n&&!t),s}function da(i,e=[]){return t=>{t.providersResolver=(n,r)=>j5(n,r?r(i):i,e)}}var Z5=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let n=YT(!1,t.type),r=n.length>0?pm([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Se({token:i,providedIn:"environment",factory:()=>new i(Me(ki))})}}return i})();function _t(i){fl("NgStandalone"),i.getStandaloneInjector=e=>e.get(Z5).getOrCreateStandaloneInjector(i)}function Xi(i,e,t){let n=yu()+i,r=kt();return r[n]===ns?_u(r,n,t?e.call(t):e()):s5(r,n)}function mm(i,e,t,n){return X5(kt(),yu(),i,e,t,n)}function JI(i,e,t,n,r){return Y5(kt(),yu(),i,e,t,n,r)}function $I(i,e,t,n,r,s,o){return K5(kt(),yu(),i,e,t,n,r,s,o)}function gm(i,e){let t=i[e];return t===ns?void 0:t}function X5(i,e,t,n,r,s){let o=e+t;return eo(i,o,r)?_u(i,o+1,s?n.call(s,r):n(r)):gm(i,o+1)}function Y5(i,e,t,n,r,s,o){let a=e+t;return pu(i,a,r,s)?_u(i,a+2,o?n.call(o,r,s):n(r,s)):gm(i,a+2)}function Q5(i,e,t,n,r,s,o,a){let l=e+t;return o5(i,l,r,s,o)?_u(i,l+3,a?n.call(a,r,s,o):n(r,s,o)):gm(i,l+3)}function K5(i,e,t,n,r,s,o,a,l){let c=e+t;return a5(i,c,r,s,o,a)?_u(i,c+4,l?n.call(l,r,s,o,a):n(r,s,o,a)):gm(i,c+4)}function ml(i,e){let t=Hn(),n,r=i+_r;t.firstCreatePass?(n=J5(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks??=[]).push(r,n.onDestroy)):n=t.data[r];let s=n.factory||(n.factory=nl(n.type,!0)),o,a=qi(ne);try{let l=Dp(!1),c=s();return Dp(l),H5(t,kt(),r,c),c}finally{qi(a)}}function J5(i,e){if(e)for(let t=e.length-1;t>=0;t--){let n=e[t];if(i===n.name)return n}}function Dc(i,e,t,n,r){let s=i+_r,o=kt(),a=d2(o,s);return $5(o,s)?Q5(o,yu(),e,a.transform,t,n,r,a):a.transform(t,n,r)}function $5(i,e){return i[Ct].data[e].pure}function Cu(i,e){return fm(i,e)}var vm=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"platform"})}}return i})();var eD=new Je("");function gl(i){return!!i&&typeof i.then=="function"}function tD(i){return!!i&&typeof i.subscribe=="function"}var xm=new Je(""),nD=(()=>{class i{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.appInits=ve(xm,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let s=r();if(gl(s))t.push(s);else if(tD(s)){let o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),t.length===0&&n(),this.initialized=!0}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Mu=new Je("");function eV(){cM(()=>{throw new ze(600,!1)})}function tV(i){return i.isBoundToModule}var nV=10;function iV(i,e,t){try{let n=t();return gl(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}var ua=(()=>{class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(SO),this.afterRenderManager=ve(ZI),this.zonelessEnabled=ve(Fy),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new ri,this.afterTick=new ri,this.componentTypes=[],this.components=[],this.isStable=ve(io).hasPendingTasks.pipe(bt(t=>!t)),this._injector=ve(ki)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(n=>{t=this.isStable.subscribe({next:r=>{r&&n()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,n){let r=t instanceof Fp;if(!this._injector.get(nD).done){let h=!r&&WT(t),f=!1;throw new ze(405,f)}let o;r?o=t:o=this._injector.get(Sc).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=tV(o)?void 0:this._injector.get(oa),l=n||o.selector,c=o.create(Sr.NULL,[],l,a),d=c.location.nativeElement,u=c.injector.get(eD,null);return u?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),xp(this.components,c),u?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new ze(101,!1);let t=Yt(null);try{this._runningTick=!0,this.synchronize()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,Yt(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(sa,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<nV;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(n);for(let{_lView:r,notifyErrorHandler:s}of this._views)rV(r,s,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Jp(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){let n=t;xp(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let n=this._injector.get(Mu,[]);[...this._bootstrapListeners,...n].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>xp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ze(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function xp(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function rV(i,e,t,n){if(!t&&!Jp(i))return;kI(i,e,t&&!n?0:1)}var Zw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},wm=(()=>{class i{compileModuleSync(t){return new Uw(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let n=this.compileModuleSync(t),r=qT(t),s=lI(r.declarations).reduce((o,a)=>{let l=ta(a);return l&&o.push(new Ec(l)),o},[]);return new Zw(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var sV=(()=>{class i{constructor(){this.zone=ve(sn),this.changeDetectionScheduler=ve(_c),this.applicationRef=ve(ua)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function oV({ngZoneFactory:i,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return i??=()=>new sn(Ge(re({},aV()),{scheduleInRootZone:t})),[{provide:sn,useFactory:i},{provide:xc,multi:!0,useFactory:()=>{let n=ve(sV,{optional:!0});return()=>n.initialize()}},{provide:xc,multi:!0,useFactory:()=>{let n=ve(lV);return()=>{n.initialize()}}},e===!0?{provide:BI,useValue:!0}:[],{provide:VI,useValue:t??B2}]}function aV(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var lV=(()=>{class i{constructor(){this.subscription=new Bn,this.initialized=!1,this.zone=ve(sn),this.pendingTasks=ve(io)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{sn.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{sn.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var cV=(()=>{class i{constructor(){this.appRef=ve(ua),this.taskService=ve(io),this.ngZone=ve(sn),this.zonelessEnabled=ve(Fy),this.disableScheduling=ve(BI,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Bn,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Lp):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ve(VI,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof pw||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let n=this.useMicrotaskScheduler?tT:V2;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>n(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>n(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Lp+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){throw this.taskService.remove(t),n}finally{this.cleanup()}this.useMicrotaskScheduler=!0,tT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function dV(){return typeof $localize<"u"&&$localize.locale||zp}var Gy=new Je("",{providedIn:"root",factory:()=>ve(Gy,Rt.Optional|Rt.SkipSelf)||dV()});var Xw=new Je("");function hp(i){return!i.moduleRef}function uV(i){let e=hp(i)?i.r3Injector:i.moduleRef.injector,t=e.get(sn);return t.run(()=>{hp(i)?i.r3Injector.resolveInjectorInitializers():i.moduleRef.resolveInjectorInitializers();let n=e.get(Is,null),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{n.handleError(s)}})}),hp(i)){let s=()=>e.destroy(),o=i.platformInjector.get(Xw);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{let s=()=>i.moduleRef.destroy(),o=i.platformInjector.get(Xw);o.add(s),i.moduleRef.onDestroy(()=>{xp(i.allPlatformModules,i.moduleRef),r.unsubscribe(),o.delete(s)})}return iV(n,t,()=>{let s=e.get(nD);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(Gy,zp);if(B5(o||zp),hp(i)){let a=e.get(ua);return i.rootComponent!==void 0&&a.bootstrap(i.rootComponent),a}else return hV(i.moduleRef,i.allPlatformModules),i.moduleRef})})})}function hV(i,e){let t=i.injector.get(ua);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(n=>t.bootstrap(n));else if(i.instance.ngDoBootstrap)i.instance.ngDoBootstrap(t);else throw new ze(-403,!1);e.push(i)}var wp=null;function fV(i=[],e){return Sr.create({name:e,providers:[{provide:Xp,useValue:"platform"},{provide:Xw,useValue:new Set([()=>wp=null])},...i]})}function pV(i=[]){if(wp)return wp;let e=fV(i);return wp=e,eV(),mV(e),e}function mV(i){i.get(by,null)?.forEach(t=>t())}var ks=(()=>{class i{static{this.__NG_ELEMENT_ID__=gV}}return i})();function gV(i){return vV(vi(),kt(),(i&16)===16)}function vV(i,e,t){if(Qp(i)&&!t){let n=aa(i.index,e);return new cl(n,n)}else if(i.type&175){let n=e[Ms];return new cl(n,e)}return null}var Yw=class{constructor(){}supports(e){return qI(e)}create(e){return new Qw(e)}},xV=(i,e)=>e,Qw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||xV}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){let o=!n||t&&t.currentIndex<ST(n,r,s)?t:n,a=ST(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,o.previousIndex==null)r++;else{s||(s=[]);let c=a-r,d=l-r;if(c!=d){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;d<=p&&p<c&&(s[h]=f+1)}let u=o.previousIndex;s[u]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!qI(e))throw new ze(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,n=!1,r,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),n=!0):(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else r=0,r5(e,a=>{o=this._trackByFn(r,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,r),n=!0):(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(n,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Kw(t,n),s,r)),e}_verifyReinsertion(e,t,n,r){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null);return s!==null?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,s=e._nextRemoved;return r===null?this._removalsHead=s:r._nextRemoved=s,s===null?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new jp),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,n=e._next;return t===null?this._itHead=n:t._next=n,n===null?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new jp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Kw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Jw=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;n!==null;n=n._nextDup)if((t===null||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){let t=e._prevDup,n=e._nextDup;return t===null?this._head=n:t._nextDup=n,n===null?this._tail=t:n._prevDup=t,this._head===null}},jp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,n=this.map.get(t);n||(n=new Jw,this.map.set(t,n)),n.add(e)}get(e,t){let n=e,r=this.map.get(n);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function ST(i,e,t){let n=i.previousIndex;if(n===null)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}var $w=class{constructor(){}supports(e){return e instanceof Map||Vy(e)}create(){return new ey}},ey=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||Vy(e)))throw new ze(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{let s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;n!==null;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let r=this._records.get(e);this._maybeAddToChanges(r,t);let s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}let n=new ty(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}},ty=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function ET(){return new Wy([new Yw])}var Wy=(()=>{class i{static{this.\u0275prov=Se({token:i,providedIn:"root",factory:ET})}constructor(t){this.factories=t}static create(t,n){if(n!=null){let r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||ET()),deps:[[i,new Zp,new vu]]}}find(t){let n=this.factories.find(r=>r.supports(t));if(n!=null)return n;throw new ze(901,!1)}}return i})();function CT(){return new qy([new $w])}var qy=(()=>{class i{static{this.\u0275prov=Se({token:i,providedIn:"root",factory:CT})}constructor(t){this.factories=t}static create(t,n){if(n){let r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||CT()),deps:[[i,new Zp,new vu]]}}find(t){let n=this.factories.find(r=>r.supports(t));if(n)return n;throw new ze(901,!1)}}return i})();function iD(i){try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=pV(n),s=[oV({}),{provide:_c,useExisting:cV},...t||[]],o=new Up({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1});return uV({r3Injector:o.injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}function ha(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function Tu(i,e){fl("NgSignals");let t=oM(i);return e?.equal&&(t[bs].equal=e.equal),t}function so(i){let e=Yt(null);try{return i()}finally{Yt(e)}}var wV=new Je("",{providedIn:"root",factory:()=>ve(yV)}),yV=(()=>{class i{static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>new ny})}}return i})(),ny=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=ve(io),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),this.taskId===null){let t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){let t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);let n=this.queues.get(t);n.has(e)||(this.queuedEffectCount++,n.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},iy=class{constructor(e,t,n,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=n,this.injector=s,this.watcher=fM(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(Is,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function ym(i,e){fl("NgSignals"),!e?.injector&&e2(ym);let t=e?.injector??ve(Sr),n=e?.manualCleanup!==!0?t.get(sm):null,r=new iy(t.get(wV),i,typeof Zone>"u"?null:Zone.current,n,t,e?.allowSignalWrites??!1),s=t.get(ks,null,{optional:!0});return!s||!(s._lView[ht]&8)?r.watcher.notify():(s._lView[pp]??=[]).push(r.watcher.notify),r}function rD(i){let e=ta(i);if(!e)return null;let t=new Ec(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var dD=null;function ao(){return dD}function uD(i){dD??=i}var bm=class{};var li=new Je(""),$y=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(_V),providedIn:"platform"})}}return i})(),hD=new Je(""),_V=(()=>{class i extends $y{constructor(){super(),this._doc=ve(li),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ao().getBaseHref(this._doc)}onPopState(t){let n=ao().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){let n=ao().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){this._history.pushState(t,n,r)}replaceState(t,n,r){this._history.replaceState(t,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>new i,providedIn:"platform"})}}return i})();function eb(i,e){if(i.length==0)return e;if(e.length==0)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?i+e.substring(1):t==1?i+e:i+"/"+e}function sD(i){let e=i.match(/#|\?|$/),t=e&&e.index||i.length,n=t-(i[t-1]==="/"?1:0);return i.slice(0,n)+i.slice(t)}function oo(i){return i&&i[0]!=="?"?"?"+i:i}var lo=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(tb),providedIn:"root"})}}return i})(),fD=new Je(""),tb=(()=>{class i extends lo{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??ve(li).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return eb(this._baseHref,t)}path(t=!1){let n=this._platformLocation.pathname+oo(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+oo(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+oo(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(Me($y),Me(fD,8))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),pD=(()=>{class i extends lo{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(t){let n=eb(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+oo(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+oo(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(Me($y),Me(fD,8))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),Rc=(()=>{class i{constructor(t){this._subject=new _n,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let n=this._locationStrategy.getBaseHref();this._basePath=CV(sD(oD(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+oo(n))}normalize(t){return i.stripTrailingSlash(EV(this._basePath,oD(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+oo(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+oo(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}static{this.normalizeQueryParams=oo}static{this.joinWithSlash=eb}static{this.stripTrailingSlash=sD}static{this.\u0275fac=function(n){return new(n||i)(Me(lo))}}static{this.\u0275prov=Se({token:i,factory:()=>SV(),providedIn:"root"})}}return i})();function SV(){return new Rc(Me(lo))}function EV(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function oD(i){return i.replace(/\/index.html$/,"")}function CV(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}function Am(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Zy=/\s+/,aD=[],Ns=(()=>{class i{constructor(t,n){this._ngEl=t,this._renderer=n,this.initialClasses=aD,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(Zy):aD}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Zy):t}ngDoCheck(){for(let n of this.initialClasses)this._updateState(n,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let n of t)this._updateState(n,!0);else if(t!=null)for(let n of Object.keys(t))this._updateState(n,!!t[n]);this._applyStateDiff()}_updateState(t,n){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(t,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let n=t[0],r=t[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(t,n){t=t.trim(),t.length>0&&t.split(Zy).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(n){return new(n||i)(ne(oi),ne(Fi))}}static{this.\u0275dir=dn({type:i,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return i})();var Xy=class{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},pn=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(r.previousIndex==null)n.createEmbeddedView(this._template,new Xy(r.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)n.remove(s===null?void 0:s);else if(s!==null){let a=n.get(s);n.move(a,o),lD(a,r)}});for(let r=0,s=n.length;r<s;r++){let a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let s=n.get(r.currentIndex);lD(s,r)})}static ngTemplateContextGuard(t,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(ne(ca),ne(ra),ne(Wy))}}static{this.\u0275dir=dn({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return i})();function lD(i,e){i.context.$implicit=e.item}var Nt=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new Yy,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){cD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){cD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(ne(ca),ne(ra))}}static{this.\u0275dir=dn({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return i})(),Yy=class{constructor(){this.$implicit=null,this.ngIf=null}};function cD(i,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${i} must be a TemplateRef, but received '${Li(e)}'.`)}var mD=(()=>{class i{constructor(t,n,r){this._ngEl=t,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){let t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){let[r,s]=t.split("."),o=r.indexOf("-")===-1?void 0:Ds.DashCase;n!=null?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${n}${s}`:n,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}static{this.\u0275fac=function(n){return new(n||i)(ne(oi),ne(qy),ne(Fi))}}static{this.\u0275dir=dn({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return i})();function MV(i,e){return new ze(2100,!1)}var Lc=(()=>{class i{transform(t,n,r){if(t==null)return null;if(!this.supports(t))throw MV(i,t);return t.slice(n,r)}supports(t){return typeof t=="string"||Array.isArray(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275pipe=ay({name:"slice",type:i,pure:!1,standalone:!0})}}return i})();var Mt=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})(),nb="browser",TV="server";function gD(i){return i===nb}function _m(i){return i===TV}var vD=(()=>{class i{static{this.\u0275prov=Se({token:i,providedIn:"root",factory:()=>gD(ve(ts))?new Qy(ve(li),window):new Ky})}}return i})(),Qy=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=IV(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}};function IV(i,e){let t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if(typeof i.createTreeWalker=="function"&&i.body&&typeof i.body.attachShadow=="function"){let n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT),r=n.currentNode;for(;r;){let s=r.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}var Ky=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Pc=class{};var Du=class{},Em=class{},co=class i{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof i?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new i;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof i?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,n),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var rb=class{encodeKey(e){return xD(e)}encodeValue(e){return xD(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function DV(i,e){let t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,a]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}var PV=/%(\d[a-f0-9])/gi,RV={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function xD(i){return encodeURIComponent(i).replace(PV,(e,t)=>RV[t]??e)}function Sm(i){return`${i}`}var pa=class i{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new rb,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=DV(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],r=Array.isArray(n)?n.map(Sm):[Sm(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new i({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Sm(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],r=n.indexOf(Sm(e.value));r!==-1&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var sb=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function LV(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function wD(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function yD(i){return typeof Blob<"u"&&i instanceof Blob}function bD(i){return typeof FormData<"u"&&i instanceof FormData}function kV(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}var Iu=class i{constructor(e,t,n,r){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(LV(this.method)||r?(this.body=n!==void 0?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new co,this.context??=new sb,!this.params)this.params=new pa,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),l=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||wD(this.body)||yD(this.body)||bD(this.body)||kV(this.body)?this.body:this.body instanceof pa?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||bD(this.body)?null:yD(this.body)?this.body.type||null:wD(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof pa?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,c=e.headers||this.headers,d=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(c=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),c)),e.setParams&&(d=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),d)),new i(t,n,o,{params:d,headers:c,context:u,reportProgress:l,responseType:r,withCredentials:a,transferCache:s})}},ma=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(ma||{}),Pu=class{constructor(e,t=200,n="OK"){this.headers=e.headers||new co,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Cm=class i extends Pu{constructor(e={}){super(e),this.type=ma.ResponseHeader}clone(e={}){return new i({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ru=class i extends Pu{constructor(e={}){super(e),this.type=ma.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new i({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},fa=class extends Pu{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},ED=200,NV=204;function ib(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials,transferCache:i.transferCache}}var uo=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof Iu)s=t;else{let l;r.headers instanceof co?l=r.headers:l=new co(r.headers);let c;r.params&&(r.params instanceof pa?c=r.params:c=new pa({fromObject:r.params})),s=new Iu(t,n,r.body!==void 0?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let o=st(s).pipe(Qs(l=>this.handler.handle(l)));if(t instanceof Iu||r.observe==="events")return o;let a=o.pipe(ji(l=>l instanceof Ru));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(bt(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(bt(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(bt(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(bt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:new pa().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,ib(r,n))}post(t,n,r={}){return this.request("POST",t,ib(r,n))}put(t,n,r={}){return this.request("PUT",t,ib(r,n))}static{this.\u0275fac=function(n){return new(n||i)(Me(Du))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),FV=/^\)\]\}',?\n/,OV="X-Request-URL";function AD(i){if(i.url)return i.url;let e=OV.toLocaleLowerCase();return i.headers.get(e)}var BV=(()=>{class i{constructor(){this.fetchImpl=ve(ob,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=ve(sn)}handle(t){return new Gt(n=>{let r=new AbortController;return this.doRequest(t,r.signal,n).then(ab,s=>n.error(new fa({error:s}))),()=>r.abort()})}doRequest(t,n,r){return ce(this,null,function*(){let s=this.createRequestInit(t),o;try{let f=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,re({signal:n},s)));VV(f),r.next({type:ma.Sent}),o=yield f}catch(f){r.error(new fa({error:f,status:f.status??0,statusText:f.statusText,url:t.urlWithParams,headers:f.headers}));return}let a=new co(o.headers),l=o.statusText,c=AD(o)??t.urlWithParams,d=o.status,u=null;if(t.reportProgress&&r.next(new Cm({headers:a,status:d,statusText:l,url:c})),o.body){let f=o.headers.get("content-length"),p=[],v=o.body.getReader(),g=0,m,y,w=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>ce(this,null,function*(){for(;;){let{done:C,value:E}=yield v.read();if(C)break;if(p.push(E),g+=E.length,t.reportProgress){y=t.responseType==="text"?(y??"")+(m??=new TextDecoder).decode(E,{stream:!0}):void 0;let T=()=>r.next({type:ma.DownloadProgress,total:f?+f:void 0,loaded:g,partialText:y});w?w.run(T):T()}}}));let A=this.concatChunks(p,g);try{let C=o.headers.get("Content-Type")??"";u=this.parseBody(t,A,C)}catch(C){r.error(new fa({error:C,headers:new co(o.headers),status:o.status,statusText:o.statusText,url:AD(o)??t.urlWithParams}));return}}d===0&&(d=u?ED:0),d>=200&&d<300?(r.next(new Ru({body:u,headers:a,status:d,statusText:l,url:c})),r.complete()):r.error(new fa({error:u,headers:a,status:d,statusText:l,url:c}))})}parseBody(t,n,r){switch(t.responseType){case"json":let s=new TextDecoder().decode(n).replace(FV,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(n);case"blob":return new Blob([n],{type:r});case"arraybuffer":return n.buffer}}createRequestInit(t){let n={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>n[s]=o.join(",")),t.headers.has("Accept")||(n.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(n["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:n,credentials:r}}concatChunks(t,n){let r=new Uint8Array(n),s=0;for(let o of t)r.set(o,s),s+=o.length;return r}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),ob=class{};function ab(){}function VV(i){i.then(ab,ab)}function UV(i,e){return e(i)}function HV(i,e,t){return(n,r)=>Er(t,()=>e(n,s=>i(s,r)))}var CD=new Je(""),zV=new Je(""),jV=new Je("",{providedIn:"root",factory:()=>!0});var _D=(()=>{class i extends Du{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null,this.pendingTasks=ve(io),this.contributeToStability=ve(jV)}handle(t){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(CD),...this.injector.get(zV,[])]));this.chain=n.reduceRight((r,s)=>HV(r,s,this.injector),UV)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(el(()=>this.pendingTasks.remove(n)))}else return this.chain(t,n=>this.backend.handle(n))}static{this.\u0275fac=function(n){return new(n||i)(Me(Em),Me(ki))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})();var GV=/^\)\]\}',?\n/;function WV(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}var SD=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new ze(-2800,!1);let n=this.xhrFactory;return(n.\u0275loadImpl?fn(n.\u0275loadImpl()):st(null)).pipe(Wi(()=>new Gt(s=>{let o=n.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((v,g)=>o.setRequestHeader(v,g.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let v=t.detectContentTypeHeader();v!==null&&o.setRequestHeader("Content-Type",v)}if(t.responseType){let v=t.responseType.toLowerCase();o.responseType=v!=="json"?v:"text"}let a=t.serializeBody(),l=null,c=()=>{if(l!==null)return l;let v=o.statusText||"OK",g=new co(o.getAllResponseHeaders()),m=WV(o)||t.url;return l=new Cm({headers:g,status:o.status,statusText:v,url:m}),l},d=()=>{let{headers:v,status:g,statusText:m,url:y}=c(),w=null;g!==NV&&(w=typeof o.response>"u"?o.responseText:o.response),g===0&&(g=w?ED:0);let A=g>=200&&g<300;if(t.responseType==="json"&&typeof w=="string"){let C=w;w=w.replace(GV,"");try{w=w!==""?JSON.parse(w):null}catch(E){w=C,A&&(A=!1,w={error:E,text:w})}}A?(s.next(new Ru({body:w,headers:v,status:g,statusText:m,url:y||void 0})),s.complete()):s.error(new fa({error:w,headers:v,status:g,statusText:m,url:y||void 0}))},u=v=>{let{url:g}=c(),m=new fa({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:g||void 0});s.error(m)},h=!1,f=v=>{h||(s.next(c()),h=!0);let g={type:ma.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),t.responseType==="text"&&o.responseText&&(g.partialText=o.responseText),s.next(g)},p=v=>{let g={type:ma.UploadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),s.next(g)};return o.addEventListener("load",d),o.addEventListener("error",u),o.addEventListener("timeout",u),o.addEventListener("abort",u),t.reportProgress&&(o.addEventListener("progress",f),a!==null&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:ma.Sent}),()=>{o.removeEventListener("error",u),o.removeEventListener("abort",u),o.removeEventListener("load",d),o.removeEventListener("timeout",u),t.reportProgress&&(o.removeEventListener("progress",f),a!==null&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(n){return new(n||i)(Me(Pc))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),MD=new Je(""),qV="XSRF-TOKEN",ZV=new Je("",{providedIn:"root",factory:()=>qV}),XV="X-XSRF-TOKEN",YV=new Je("",{providedIn:"root",factory:()=>XV}),Mm=class{},QV=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Am(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(n){return new(n||i)(Me(li),Me(ts),Me(ZV))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})();function KV(i,e){let t=i.url.toLowerCase();if(!ve(MD)||i.method==="GET"||i.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(i);let n=ve(Mm).getToken(),r=ve(YV);return n!=null&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),e(i)}function TD(...i){let e=[uo,SD,_D,{provide:Du,useExisting:_D},{provide:Em,useFactory:()=>ve(BV,{optional:!0})??ve(SD)},{provide:CD,useValue:KV,multi:!0},{provide:MD,useValue:!0},{provide:Mm,useClass:QV}];for(let t of i)e.push(...t.\u0275providers);return wu(e)}var db=class extends bm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ub=class i extends db{static makeCurrent(){uD(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=JV();return t==null?null:$V(t)}resetBaseElement(){Lu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Am(document.cookie,e)}},Lu=null;function JV(){return Lu=Lu||document.querySelector("base"),Lu?Lu.getAttribute("href"):null}function $V(i){return new URL(i,document.baseURI).pathname}var eU=(()=>{class i{build(){return new XMLHttpRequest}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),hb=new Je(""),RD=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(s=>s.supports(t)),!n)throw new ze(5101,!1);return this._eventNameToPlugin.set(t,n),n}static{this.\u0275fac=function(n){return new(n||i)(Me(hb),Me(sn))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),Im=class{constructor(e){this._doc=e}},lb="ng-app-id",LD=(()=>{class i{constructor(t,n,r,s={}){this.doc=t,this.appId=n,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=_m(s),this.resetHostNodes()}addStyles(t){for(let n of t)this.changeUsageCount(n,1)===1&&this.onStyleAdded(n)}removeStyles(t){for(let n of t)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(n=>n.remove()),t.clear());for(let n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){let n=this.styleRef;n.get(t)?.elements?.forEach(r=>r.remove()),n.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${lb}="${this.appId}"]`);if(t?.length){let n=new Map;return t.forEach(r=>{r.textContent!=null&&n.set(r.textContent,r)}),n}return null}changeUsageCount(t,n){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=n,s.usage}return r.set(t,{usage:n,elements:[]}),n}getStyleElement(t,n){let r=this.styleNodesInDOM,s=r?.get(n);if(s?.parentNode===t)return r.delete(n),s.removeAttribute(lb),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=n,this.platformIsServer&&o.setAttribute(lb,this.appId),t.appendChild(o),o}}addStyleToHost(t,n){let r=this.getStyleElement(t,n),s=this.styleRef,o=s.get(n)?.elements;o?o.push(r):s.set(n,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(n){return new(n||i)(Me(li),Me(yy),Me(om,8),Me(ts))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),cb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},pb=/%COMP%/g,kD="%COMP%",tU=`_nghost-${kD}`,nU=`_ngcontent-${kD}`,iU=!0,rU=new Je("",{providedIn:"root",factory:()=>iU});function sU(i){return nU.replace(pb,i)}function oU(i){return tU.replace(pb,i)}function ND(i,e){return e.map(t=>t.replace(pb,i))}var ID=(()=>{class i{constructor(t,n,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=_m(a),this.defaultRenderer=new ku(t,o,l,this.platformIsServer)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Es.ShadowDom&&(n=Ge(re({},n),{encapsulation:Es.Emulated}));let r=this.getOrCreateRenderer(t,n);return r instanceof Dm?r.applyToHost(t):r instanceof Nu&&r.applyStyles(),r}getOrCreateRenderer(t,n){let r=this.rendererByCompId,s=r.get(n.id);if(!s){let o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(n.encapsulation){case Es.Emulated:s=new Dm(l,c,n,this.appId,d,o,a,u);break;case Es.ShadowDom:return new fb(l,c,t,n,o,a,this.nonce,u);default:s=new Nu(l,c,n,d,o,a,u);break}r.set(n.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(n){return new(n||i)(Me(RD),Me(LD),Me(yy),Me(rU),Me(li),Me(ts),Me(sn),Me(om))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),ku=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(cb[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(DD(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(DD(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new ze(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=cb[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=cb[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Ds.DashCase|Ds.Important)?e.style.setProperty(t,n,r&Ds.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Ds.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=ao().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function DD(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var fb=class extends ku{constructor(e,t,n,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=ND(r.id,r.styles);for(let d of c){let u=document.createElement("style");a&&u.setAttribute("nonce",a),u.textContent=d,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Nu=class extends ku{constructor(e,t,n,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?ND(l,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Dm=class extends Nu{constructor(e,t,n,r,s,o,a,l){let c=r+"-"+n.id;super(e,t,n,s,o,a,l,c),this.contentAttr=sU(c),this.hostAttr=oU(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},aU=(()=>{class i extends Im{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}static{this.\u0275fac=function(n){return new(n||i)(Me(li))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})(),PD=["alt","control","meta","shift"],lU={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cU={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},dU=(()=>{class i extends Im{constructor(t){super(t)}supports(t){return i.parseEventName(t)!=null}addEventListener(t,n,r){let s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ao().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let n=t.toLowerCase().split("."),r=n.shift();if(n.length===0||!(r==="keydown"||r==="keyup"))return null;let s=i._normalizeKey(n.pop()),o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),PD.forEach(c=>{let d=n.indexOf(c);d>-1&&(n.splice(d,1),o+=c+".")}),o+=s,n.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,n){let r=lU[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),PD.forEach(o=>{if(o!==r){let a=cU[o];a(t)&&(s+=o+".")}}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(n){return new(n||i)(Me(li))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})();function Pm(i,e){return iD(re({rootComponent:i},uU(e)))}function uU(i){return{appProviders:[...gU,...i?.providers??[]],platformProviders:mU}}function hU(){ub.makeCurrent()}function fU(){return new Is}function pU(){return q2(document),document}var mU=[{provide:ts,useValue:nb},{provide:by,useValue:hU,multi:!0},{provide:li,useFactory:pU,deps:[]}];var gU=[{provide:Xp,useValue:"root"},{provide:Is,useFactory:fU,deps:[]},{provide:hb,useClass:aU,multi:!0,deps:[li,sn,ts]},{provide:hb,useClass:dU,multi:!0,deps:[li]},ID,LD,RD,{provide:sa,useExisting:ID},{provide:Pc,useClass:eU,deps:[]},[]];var FD=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(n){return new(n||i)(Me(li))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var rs=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:function(n){let r=null;return n?r=new(n||i):r=Me(vU),r},providedIn:"root"})}}return i})(),vU=(()=>{class i extends rs{constructor(t){super(),this._doc=t}sanitize(t,n){if(n==null)return null;switch(t){case Ls.NONE:return n;case Ls.HTML:return la(n,"HTML")?Rs(n):rI(this._doc,String(n)).toString();case Ls.STYLE:return la(n,"Style")?Rs(n):n;case Ls.SCRIPT:if(la(n,"Script"))return Rs(n);throw new ze(5200,!1);case Ls.URL:return la(n,"URL")?Rs(n):lm(String(n));case Ls.RESOURCE_URL:if(la(n,"ResourceURL"))return Rs(n);throw new ze(5201,!1);default:throw new ze(5202,!1)}}bypassSecurityTrustHtml(t){return X2(t)}bypassSecurityTrustStyle(t){return Y2(t)}bypassSecurityTrustScript(t){return Q2(t)}bypassSecurityTrustUrl(t){return K2(t)}bypassSecurityTrustResourceUrl(t){return J2(t)}static{this.\u0275fac=function(n){return new(n||i)(Me(li))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Tt="primary",Qu=Symbol("RouteTitle"),wb=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Uc(i){return new wb(i)}function xU(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let s=0;s<n.length;s++){let o=n[s],a=i[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function wU(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Fs(i[t],e[t]))return!1;return!0}function Fs(i,e){let t=i?yb(i):void 0,n=e?yb(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!ZD(i[r],e[r]))return!1;return!0}function yb(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function ZD(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}else return i===e}function XD(i){return i.length>0?i[i.length-1]:null}function xa(i){return Px(i)?i:gl(i)?fn(Promise.resolve(i)):st(i)}var yU={exact:QD,subset:KD},YD={exact:bU,subset:AU,ignored:()=>!0};function OD(i,e,t){return yU[t.paths](i.root,e.root,t.matrixParams)&&YD[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function bU(i,e){return Fs(i,e)}function QD(i,e,t){if(!xl(i.segments,e.segments)||!km(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!QD(i.children[n],e.children[n],t))return!1;return!0}function AU(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>ZD(i[t],e[t]))}function KD(i,e,t){return JD(i,e,e.segments,t)}function JD(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!xl(r,t)||e.hasChildren()||!km(r,t,n))}else if(i.segments.length===t.length){if(!xl(i.segments,t)||!km(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!KD(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!xl(i.segments,r)||!km(i.segments,r,n)||!i.children[Tt]?!1:JD(i.children[Tt],e,s,n)}}function km(i,e,t){return e.every((n,r)=>YD[t](i[r].parameters,n.parameters))}var fo=class{constructor(e=new tn([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Uc(this.queryParams),this._queryParamMap}toString(){return EU.serialize(this)}},tn=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Nm(this)}},vl=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Uc(this.parameters),this._parameterMap}toString(){return eP(this)}};function _U(i,e){return xl(i,e)&&i.every((t,n)=>Fs(t.parameters,e[n].parameters))}function xl(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function SU(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===Tt&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==Tt&&(t=t.concat(e(r,n)))}),t}var Ku=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>new Hc,providedIn:"root"})}}return i})(),Hc=class{parse(e){let t=new Ab(e);return new fo(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Fu(e.root,!0)}`,n=TU(e.queryParams),r=typeof e.fragment=="string"?`#${CU(e.fragment)}`:"";return`${t}${n}${r}`}},EU=new Hc;function Nm(i){return i.segments.map(e=>eP(e)).join("/")}function Fu(i,e){if(!i.hasChildren())return Nm(i);if(e){let t=i.children[Tt]?Fu(i.children[Tt],!1):"",n=[];return Object.entries(i.children).forEach(([r,s])=>{r!==Tt&&n.push(`${r}:${Fu(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=SU(i,(n,r)=>r===Tt?[Fu(i.children[Tt],!1)]:[`${r}:${Fu(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[Tt]!=null?`${Nm(i)}/${t[0]}`:`${Nm(i)}/(${t.join("//")})`}}function $D(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Rm(i){return $D(i).replace(/%3B/gi,";")}function CU(i){return encodeURI(i)}function bb(i){return $D(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Fm(i){return decodeURIComponent(i)}function BD(i){return Fm(i.replace(/\+/g,"%20"))}function eP(i){return`${bb(i.path)}${MU(i.parameters)}`}function MU(i){return Object.entries(i).map(([e,t])=>`;${bb(e)}=${bb(t)}`).join("")}function TU(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${Rm(t)}=${Rm(r)}`).join("&"):`${Rm(t)}=${Rm(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var IU=/^[^\/()?;#]+/;function mb(i){let e=i.match(IU);return e?e[0]:""}var DU=/^[^\/()?;=#]+/;function PU(i){let e=i.match(DU);return e?e[0]:""}var RU=/^[^=?&#]+/;function LU(i){let e=i.match(RU);return e?e[0]:""}var kU=/^[^&#]+/;function NU(i){let e=i.match(kU);return e?e[0]:""}var Ab=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new tn([],{}):new tn([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Tt]=new tn(e,t)),n}parseSegment(){let e=mb(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ze(4009,!1);return this.capture(e),new vl(Fm(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=PU(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=mb(this.remaining);r&&(n=r,this.capture(n))}e[Fm(t)]=Fm(n)}parseQueryParam(e){let t=LU(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=NU(this.remaining);o&&(n=o,this.capture(n))}let r=BD(t),s=BD(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=mb(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new ze(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Tt);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[Tt]:new tn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ze(4011,!1)}};function tP(i){return i.segments.length>0?new tn([],{[Tt]:i}):i}function nP(i){let e={};for(let[n,r]of Object.entries(i.children)){let s=nP(r);if(n===Tt&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new tn(i.segments,e);return FU(t)}function FU(i){if(i.numberOfChildren===1&&i.children[Tt]){let e=i.children[Tt];return new tn(i.segments.concat(e.segments),e.children)}return i}function wl(i){return i instanceof fo}function OU(i,e,t=null,n=null){let r=iP(i);return rP(r,e,t,n)}function iP(i){let e;function t(s){let o={};for(let l of s.children){let c=t(l);o[l.outlet]=c}let a=new tn(s.url,o);return s===i&&(e=a),a}let n=t(i.root),r=tP(n);return e??r}function rP(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return gb(r,r,r,t,n);let s=BU(e);if(s.toRoot())return gb(r,r,new tn([],{}),t,n);let o=VU(s,r,i),a=o.processChildren?Vu(o.segmentGroup,o.index,s.commands):oP(o.segmentGroup,o.index,s.commands);return gb(r,o.segmentGroup,a,t,n)}function Om(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function zu(i){return typeof i=="object"&&i!=null&&i.outlets}function gb(i,e,t,n,r){let s={};n&&Object.entries(n).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`});let o;i===e?o=t:o=sP(i,e,t);let a=tP(nP(o));return new fo(a,s,r)}function sP(i,e,t){let n={};return Object.entries(i.children).forEach(([r,s])=>{s===e?n[r]=t:n[r]=sP(s,e,t)}),new tn(i.segments,n)}var Bm=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Om(n[0]))throw new ze(4003,!1);let r=n.find(zu);if(r&&r!==XD(n))throw new ze(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function BU(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new Bm(!0,0,i);let e=0,t=!1,n=i.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Bm(t,e,n)}var Oc=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function VU(i,e,t){if(i.isAbsolute)return new Oc(e,!0,0);if(!t)return new Oc(e,!1,NaN);if(t.parent===null)return new Oc(t,!0,0);let n=Om(i.commands[0])?0:1,r=t.segments.length-1+n;return UU(t,r,i.numberOfDoubleDots)}function UU(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new ze(4005,!1);r=n.segments.length}return new Oc(n,!1,r-s)}function HU(i){return zu(i[0])?i[0].outlets:{[Tt]:i}}function oP(i,e,t){if(i??=new tn([],{}),i.segments.length===0&&i.hasChildren())return Vu(i,e,t);let n=zU(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let s=new tn(i.segments.slice(0,n.pathIndex),{});return s.children[Tt]=new tn(i.segments.slice(n.pathIndex),i.children),Vu(s,0,r)}else return n.match&&r.length===0?new tn(i.segments,{}):n.match&&!i.hasChildren()?_b(i,e,t):n.match?Vu(i,0,r):_b(i,e,t)}function Vu(i,e,t){if(t.length===0)return new tn(i.segments,{});{let n=HU(t),r={};if(Object.keys(n).some(s=>s!==Tt)&&i.children[Tt]&&i.numberOfChildren===1&&i.children[Tt].segments.length===0){let s=Vu(i.children[Tt],e,t);return new tn(i.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=oP(i.children[s],e,o))}),Object.entries(i.children).forEach(([s,o])=>{n[s]===void 0&&(r[s]=o)}),new tn(i.segments,r)}}function zU(i,e,t){let n=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;let o=i.segments[r],a=t[n];if(zu(a))break;let l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!UD(l,c,o))return s;n+=2}else{if(!UD(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function _b(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(zu(s)){let l=jU(s.outlets);return new tn(n,l)}if(r===0&&Om(t[0])){let l=i.segments[e];n.push(new vl(l.path,VD(t[0]))),r++;continue}let o=zu(s)?s.outlets[Tt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Om(a)?(n.push(new vl(o,VD(a))),r+=2):(n.push(new vl(o,{})),r++)}return new tn(n,{})}function jU(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=_b(new tn([],{}),0,n))}),e}function VD(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function UD(i,e,t){return i==t.path&&Fs(e,t.parameters)}var Uu="imperative",ci=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(ci||{}),Tr=class{constructor(e,t){this.id=e,this.url=t}},zc=class extends Tr{constructor(e,t,n="imperative",r=null){super(e,t),this.type=ci.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},os=class extends Tr{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=ci.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},cr=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(cr||{}),Vm=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(Vm||{}),ho=class extends Tr{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=ci.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ga=class extends Tr{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=ci.NavigationSkipped}},ju=class extends Tr{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=ci.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Um=class extends Tr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=ci.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sb=class extends Tr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=ci.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Eb=class extends Tr{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=ci.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Cb=class extends Tr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=ci.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mb=class extends Tr{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=ci.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tb=class{constructor(e){this.route=e,this.type=ci.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ib=class{constructor(e){this.route=e,this.type=ci.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Db=class{constructor(e){this.snapshot=e,this.type=ci.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pb=class{constructor(e){this.snapshot=e,this.type=ci.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Rb=class{constructor(e){this.snapshot=e,this.type=ci.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lb=class{constructor(e){this.snapshot=e,this.type=ci.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hm=class{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=ci.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Gu=class{},jc=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function GU(i,e){return i.providers&&!i._injector&&(i._injector=pm(i.providers,e,`Route: ${i.path}`)),i._injector??e}function ss(i){return i.outlet||Tt}function WU(i,e){let t=i.filter(n=>ss(n)===e);return t.push(...i.filter(n=>ss(n)!==e)),t}function Ju(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var kb=class{get injector(){return Ju(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new $u(this.rootInjector),this.attachRef=null}},$u=(()=>{class i{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,n){let r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new kb(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(n){return new(n||i)(Me(ki))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),zm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Nb(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=Nb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Fb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Fb(e,this._root).map(t=>t.value)}};function Nb(i,e){if(i===e.value)return e;for(let t of e.children){let n=Nb(i,t);if(n)return n}return null}function Fb(i,e){if(i===e.value)return[e];for(let t of e.children){let n=Fb(i,t);if(n.length)return n.unshift(e),n}return[]}var lr=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Fc(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var jm=class extends zm{constructor(e,t){super(e),this.snapshot=t,Wb(this,e)}toString(){return this.snapshot.toString()}};function aP(i){let e=qU(i),t=new pi([new vl("",{})]),n=new pi({}),r=new pi({}),s=new pi({}),o=new pi(""),a=new va(t,n,s,o,r,Tt,i,e.root);return a.snapshot=e.root,new jm(new lr(a,[]),e)}function qU(i){let e={},t={},n={},r="",s=new Bc([],e,n,r,t,Tt,i,null,{});return new Wm("",new lr(s,[]))}var va=class{constructor(e,t,n,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(bt(c=>c[Qu]))??st(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(bt(e=>Uc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(bt(e=>Uc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Gm(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:re(re({},e.params),i.params),data:re(re({},e.data),i.data),resolve:re(re(re(re({},i.data),e.data),r?.data),i._resolvedData)}:n={params:re({},i.params),data:re({},i.data),resolve:re(re({},i.data),i._resolvedData??{})},r&&cP(r)&&(n.resolve[Qu]=r.title),n}var Bc=class{get title(){return this.data?.[Qu]}constructor(e,t,n,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Uc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Uc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Wm=class extends zm{constructor(e,t){super(t),this.url=e,Wb(this,t)}toString(){return lP(this._root)}};function Wb(i,e){e.value._routerState=i,e.children.forEach(t=>Wb(i,t))}function lP(i){let e=i.children.length>0?` { ${i.children.map(lP).join(", ")} } `:"";return`${i.value}${e}`}function vb(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Fs(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),Fs(e.params,t.params)||i.paramsSubject.next(t.params),wU(e.url,t.url)||i.urlSubject.next(t.url),Fs(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function Ob(i,e){let t=Fs(i.params,e.params)&&_U(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||Ob(i.parent,e.parent))}function cP(i){return typeof i.title=="string"||i.title===null}var qb=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=Tt,this.activateEvents=new _n,this.deactivateEvents=new _n,this.attachEvents=new _n,this.detachEvents=new _n,this.parentContexts=ve($u),this.location=ve(ca),this.changeDetector=ve(ks),this.inputBinder=ve(Ym,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ze(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ze(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ze(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new ze(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Bb(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=dn({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ni]})}}return i})(),Bb=class i{__ngOutletInjector(e){return new i(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===va?this.route:e===$u?this.childContexts:this.parent.get(e,t)}},Ym=new Je(""),HD=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:n}=t,r=$a([n.queryParams,n.params,n.data]).pipe(Wi(([s,o,a],l)=>(a=re(re(re({},s),o),a),l===0?st(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(t);return}let o=rD(n.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})();function ZU(i,e,t){let n=Wu(i,e._root,t?t._root:void 0);return new jm(n,e)}function Wu(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=XU(i,e,t);return new lr(n,r)}else{if(i.shouldAttach(e.value)){let s=i.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Wu(i,a)),o}}let n=YU(e.value),r=e.children.map(s=>Wu(i,s));return new lr(n,r)}}function XU(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Wu(i,n,r);return Wu(i,n)})}function YU(i){return new va(new pi(i.url),new pi(i.params),new pi(i.queryParams),new pi(i.fragment),new pi(i.data),i.outlet,i.component,i)}var qu=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},dP="ngNavigationCancelingError";function qm(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=wl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=uP(!1,cr.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function uP(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[dP]=!0,t.cancellationCode=e,t}function QU(i){return hP(i)&&wl(i.url)}function hP(i){return!!i&&i[dP]}var KU=(i,e,t,n)=>bt(r=>(new Vb(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),Vb=class{constructor(e,t,n,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),vb(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=Fc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Fc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(n&&n.outlet){let o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Fc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=Fc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new Lb(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Pb(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(vb(r),r===s)if(r.component){let o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),vb(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,n)}},Zm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Vc=class{constructor(e,t){this.component=e,this.route=t}};function JU(i,e,t){let n=i._root,r=e?e._root:null;return Ou(n,r,t,[n.value])}function $U(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function qc(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!DT(i)?i:e.get(i):n}function Ou(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Fc(e);return i.children.forEach(o=>{e8(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Hu(a,t.getContext(o),r)),r}function e8(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=t8(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Zm(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ou(i,e,a?a.children:null,n,r):Ou(i,e,t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Vc(a.outlet.component,o))}else o&&Hu(e,a,r),r.canActivateChecks.push(new Zm(n)),s.component?Ou(i,null,a?a.children:null,n,r):Ou(i,null,t,n,r);return r}function t8(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!xl(i.url,e.url);case"pathParamsOrQueryParamsChange":return!xl(i.url,e.url)||!Fs(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ob(i,e)||!Fs(i.queryParams,e.queryParams);case"paramsChange":default:return!Ob(i,e)}}function Hu(i,e,t){let n=Fc(i),r=i.value;Object.entries(n).forEach(([s,o])=>{r.component?e?Hu(o,e.children.getContext(s),t):Hu(o,null,t):Hu(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Vc(e.outlet.component,r)):t.canDeactivateChecks.push(new Vc(null,r)):t.canDeactivateChecks.push(new Vc(null,r))}function eh(i){return typeof i=="function"}function n8(i){return typeof i=="boolean"}function i8(i){return i&&eh(i.canLoad)}function r8(i){return i&&eh(i.canActivate)}function s8(i){return i&&eh(i.canActivateChild)}function o8(i){return i&&eh(i.canDeactivate)}function a8(i){return i&&eh(i.canMatch)}function fP(i){return i instanceof Ys||i?.name==="EmptyError"}var Lm=Symbol("INITIAL_VALUE");function Gc(){return Wi(i=>$a(i.map(e=>e.pipe(Ks(1),Fx(Lm)))).pipe(bt(e=>{for(let t of e)if(t!==!0){if(t===Lm)return Lm;if(t===!1||l8(t))return t}return!0}),ji(e=>e!==Lm),Ks(1)))}function l8(i){return wl(i)||i instanceof qu}function c8(i,e){return Un(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?st(Ge(re({},t),{guardsResult:!0})):d8(o,n,r,i).pipe(Un(a=>a&&n8(a)?u8(n,s,i,e):st(a)),bt(a=>Ge(re({},t),{guardsResult:a})))})}function d8(i,e,t,n){return fn(i).pipe(Un(r=>g8(r.component,r.route,t,e,n)),As(r=>r!==!0,!0))}function u8(i,e,t,n){return fn(e).pipe(Qs(r=>lc(f8(r.route.parent,n),h8(r.route,n),m8(i,r.path,t),p8(i,r.route,t))),As(r=>r!==!0,!0))}function h8(i,e){return i!==null&&e&&e(new Rb(i)),st(!0)}function f8(i,e){return i!==null&&e&&e(new Db(i)),st(!0)}function p8(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return st(!0);let r=n.map(s=>rp(()=>{let o=Ju(e)??t,a=qc(s,o),l=r8(a)?a.canActivate(e,i):Er(o,()=>a(e,i));return xa(l).pipe(As())}));return st(r).pipe(Gc())}function m8(i,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>$U(o)).filter(o=>o!==null).map(o=>rp(()=>{let a=o.guards.map(l=>{let c=Ju(o.node)??t,d=qc(l,c),u=s8(d)?d.canActivateChild(n,i):Er(c,()=>d(n,i));return xa(u).pipe(As())});return st(a).pipe(Gc())}));return st(s).pipe(Gc())}function g8(i,e,t,n,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return st(!0);let o=s.map(a=>{let l=Ju(e)??r,c=qc(a,l),d=o8(c)?c.canDeactivate(i,e,t,n):Er(l,()=>c(i,e,t,n));return xa(d).pipe(As())});return st(o).pipe(Gc())}function v8(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return st(!0);let s=r.map(o=>{let a=qc(o,i),l=i8(a)?a.canLoad(e,t):Er(i,()=>a(e,t));return xa(l)});return st(s).pipe(Gc(),pP(n))}function pP(i){return Mx(si(e=>{if(typeof e!="boolean")throw qm(i,e)}),bt(e=>e===!0))}function x8(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return st(!0);let s=r.map(o=>{let a=qc(o,i),l=a8(a)?a.canMatch(e,t):Er(i,()=>a(e,t));return xa(l)});return st(s).pipe(Gc(),pP(n))}var Zu=class{constructor(e){this.segmentGroup=e||null}},Xu=class extends Error{constructor(e){super(),this.urlTree=e}};function Nc(i){return yr(new Zu(i))}function w8(i){return yr(new ze(4e3,!1))}function y8(i){return yr(uP(!1,cr.GuardRejected))}var Ub=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return st(n);if(r.numberOfChildren>1||!r.children[Tt])return w8(`${e.redirectTo}`);r=r.children[Tt]}}applyRedirectCommands(e,t,n,r,s){if(typeof t!="string"){let a=t,{queryParams:l,fragment:c,routeConfig:d,url:u,outlet:h,params:f,data:p,title:v}=r,g=Er(s,()=>a({params:f,data:p,queryParams:l,fragment:c,routeConfig:d,url:u,outlet:h,title:v}));if(g instanceof fo)throw new Xu(g);t=g}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t[0]==="/")throw new Xu(o);return o}applyRedirectCreateUrlTree(e,t,n,r){let s=this.createSegmentGroup(e,t.root,n,r);return new fo(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);n[r]=t[a]}else n[r]=s}),n}createSegmentGroup(e,t,n,r){let s=this.createSegments(e,t.segments,n,r),o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,n,r)}),new tn(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new ze(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}},Hb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function b8(i,e,t,n,r){let s=mP(i,e,t);return s.matched?(n=GU(e,n),x8(n,e,t,r).pipe(bt(o=>o===!0?s:re({},Hb)))):st(s)}function mP(i,e,t){if(e.path==="**")return A8(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?re({},Hb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||xU)(t,i,e);if(!r)return re({},Hb);let s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=r.consumed.length>0?re(re({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function A8(i){return{matched:!0,parameters:i.length>0?XD(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function zD(i,e,t,n){return t.length>0&&E8(i,t,n)?{segmentGroup:new tn(e,S8(n,new tn(t,i.children))),slicedSegments:[]}:t.length===0&&C8(i,t,n)?{segmentGroup:new tn(i.segments,_8(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new tn(i.segments,i.children),slicedSegments:t}}function _8(i,e,t,n){let r={};for(let s of t)if(Qm(i,e,s)&&!n[ss(s)]){let o=new tn([],{});r[ss(s)]=o}return re(re({},n),r)}function S8(i,e){let t={};t[Tt]=e;for(let n of i)if(n.path===""&&ss(n)!==Tt){let r=new tn([],{});t[ss(n)]=r}return t}function E8(i,e,t){return t.some(n=>Qm(i,e,n)&&ss(n)!==Tt)}function C8(i,e,t){return t.some(n=>Qm(i,e,n))}function Qm(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function M8(i,e,t){return e.length===0&&!i.children[t]}var zb=class{};function T8(i,e,t,n,r,s,o="emptyOnly"){return new jb(i,e,t,n,r,o,s).recognize()}var I8=31,jb=class{constructor(e,t,n,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Ub(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ze(4002,`'${e.segmentGroup}'`)}recognize(){let e=zD(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(bt(({children:t,rootSnapshot:n})=>{let r=new lr(n,t),s=new Wm("",r),o=OU(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Bc([],Object.freeze({}),Object.freeze(re({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Tt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Tt,t).pipe(bt(n=>({children:n,rootSnapshot:t})),Gi(n=>{if(n instanceof Xu)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Zu?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,r,s){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,s):this.processSegment(e,t,n,n.segments,r,!0,s).pipe(bt(o=>o instanceof lr?[o]:[]))}processChildren(e,t,n,r){let s=[];for(let o of Object.keys(n.children))o==="primary"?s.unshift(o):s.push(o);return fn(s).pipe(Qs(o=>{let a=n.children[o],l=WU(t,o);return this.processSegmentGroup(e,l,a,o,r)}),Nx((o,a)=>(o.push(...a),o)),Qo(null),kx(),Un(o=>{if(o===null)return Nc(n);let a=gP(o);return D8(a),st(a)}))}processSegment(e,t,n,r,s,o,a){return fn(t).pipe(Qs(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,n,r,s,o,a).pipe(Gi(c=>{if(c instanceof Zu)return st(null);throw c}))),As(l=>!!l),Gi(l=>{if(fP(l))return M8(n,r,s)?st(new zb):Nc(n);throw l}))}processSegmentAgainstRoute(e,t,n,r,s,o,a,l){return ss(n)!==o&&(o===Tt||!Qm(r,s,n))?Nc(r):n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,s,o,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,s,o,l):Nc(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:u,remainingSegments:h}=mP(t,r,s);if(!l)return Nc(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>I8&&(this.allowRedirects=!1));let f=new Bc(s,c,Object.freeze(re({},this.urlTree.queryParams)),this.urlTree.fragment,jD(r),ss(r),r.component??r._loadedComponent??null,r,GD(r)),p=Gm(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let v=this.applyRedirects.applyRedirectCommands(d,r.redirectTo,u,f,e);return this.applyRedirects.lineralizeSegments(r,v).pipe(Un(g=>this.processSegment(e,n,t,g.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,t,n,r,s,o){let a=b8(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),a.pipe(Wi(l=>l.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(Wi(({routes:c})=>{let d=n._loadedInjector??e,{parameters:u,consumedSegments:h,remainingSegments:f}=l,p=new Bc(h,u,Object.freeze(re({},this.urlTree.queryParams)),this.urlTree.fragment,jD(n),ss(n),n.component??n._loadedComponent??null,n,GD(n)),v=Gm(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(v.params),p.data=Object.freeze(v.data);let{segmentGroup:g,slicedSegments:m}=zD(t,h,f,c);if(m.length===0&&g.hasChildren())return this.processChildren(d,c,g,p).pipe(bt(w=>new lr(p,w)));if(c.length===0&&m.length===0)return st(new lr(p,[]));let y=ss(n)===s;return this.processSegment(d,c,g,m,y?Tt:s,!0,p).pipe(bt(w=>new lr(p,w instanceof lr?[w]:[])))}))):Nc(t)))}getChildConfig(e,t,n){return t.children?st({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?st({routes:t._loadedRoutes,injector:t._loadedInjector}):v8(e,t,n,this.urlSerializer).pipe(Un(r=>r?this.configLoader.loadChildren(e,t).pipe(si(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):y8(t))):st({routes:[],injector:e})}};function D8(i){i.sort((e,t)=>e.value.outlet===Tt?-1:t.value.outlet===Tt?1:e.value.outlet.localeCompare(t.value.outlet))}function P8(i){let e=i.value.routeConfig;return e&&e.path===""}function gP(i){let e=[],t=new Set;for(let n of i){if(!P8(n)){e.push(n);continue}let r=e.find(s=>n.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=gP(n.children);e.push(new lr(n.value,r))}return e.filter(n=>!t.has(n))}function jD(i){return i.data||{}}function GD(i){return i.resolve||{}}function R8(i,e,t,n,r,s){return Un(o=>T8(i,e,t,n,o.extractedUrl,r,s).pipe(bt(({state:a,tree:l})=>Ge(re({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function L8(i,e){return Un(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return st(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let c of vP(l))o.add(c);let a=0;return fn(o).pipe(Qs(l=>s.has(l)?k8(l,n,i,e):(l.data=Gm(l,l.parent,i).resolve,st(void 0))),si(()=>a++),cc(1),Un(l=>a===o.size?st(t):or))})}function vP(i){let e=i.children.map(t=>vP(t)).flat();return[i,...e]}function k8(i,e,t,n){let r=i.routeConfig,s=i._resolve;return r?.title!==void 0&&!cP(r)&&(s[Qu]=r.title),N8(s,i,e,n).pipe(bt(o=>(i._resolvedData=o,i.data=Gm(i,i.parent,t).resolve,null)))}function N8(i,e,t,n){let r=yb(i);if(r.length===0)return st({});let s={};return fn(r).pipe(Un(o=>F8(i[o],e,t,n).pipe(As(),si(a=>{if(a instanceof qu)throw qm(new Hc,a);s[o]=a}))),cc(1),Lx(s),Gi(o=>fP(o)?or:yr(o)))}function F8(i,e,t,n){let r=Ju(e)??n,s=qc(i,r),o=s.resolve?s.resolve(e,t):Er(r,()=>s(e,t));return xa(o)}function xb(i){return Wi(e=>{let t=i(e);return t?fn(t).pipe(bt(()=>e)):st(e)})}var xP=(()=>{class i{buildTitle(t){let n,r=t.root;for(;r!==void 0;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===Tt);return n}getResolvedTitleForRoute(t){return t.data[Qu]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(O8),providedIn:"root"})}}return i})(),O8=(()=>{class i extends xP{constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static{this.\u0275fac=function(n){return new(n||i)(Me(FD))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),th=new Je("",{providedIn:"root",factory:()=>({})}),B8=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=vt({type:i,selectors:[["ng-component"]],standalone:!0,features:[_t],decls:1,vars:0,template:function(n,r){n&1&&B(0,"router-outlet")},dependencies:[qb],encapsulation:2})}}return i})();function Zb(i){let e=i.children&&i.children.map(Zb),t=e?Ge(re({},i),{children:e}):re({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Tt&&(t.component=B8),t}var Yu=new Je(""),Xb=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ve(wm)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return st(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let n=xa(t.loadComponent()).pipe(bt(wP),si(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),el(()=>{this.componentLoaders.delete(t)})),r=new ac(n,()=>new ri).pipe(oc());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return st({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let s=V8(n,this.compiler,t,this.onLoadEndListener).pipe(el(()=>{this.childrenLoaders.delete(n)})),o=new ac(s,()=>new ri).pipe(oc());return this.childrenLoaders.set(n,o),o}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function V8(i,e,t,n){return xa(i.loadChildren()).pipe(bt(wP),Un(r=>r instanceof fu||Array.isArray(r)?st(r):fn(e.compileModuleAsync(r))),bt(r=>{n&&n(i);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(Yu,[],{optional:!0,self:!0}).flat()),{routes:o.map(Zb),injector:s}}))}function U8(i){return i&&typeof i=="object"&&"default"in i}function wP(i){return U8(i)?i.default:i}var Yb=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(H8),providedIn:"root"})}}return i})(),H8=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),yP=new Je(""),bP=new Je("");function z8(i,e,t){let n=i.get(bP),r=i.get(li);return i.get(sn).runOutsideAngular(()=>{if(!r.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,o=new Promise(c=>{s=c}),a=r.startViewTransition(()=>(s(),j8(i))),{onViewTransitionCreated:l}=n;return l&&Er(i,()=>l({transition:a,from:e,to:t})),o})}function j8(i){return new Promise(e=>{Uy({read:()=>setTimeout(e)},{injector:i})})}var G8=new Je(""),Qb=(()=>{class i{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ri,this.transitionAbortSubject=new ri,this.configLoader=ve(Xb),this.environmentInjector=ve(ki),this.urlSerializer=ve(Ku),this.rootContexts=ve($u),this.location=ve(Rc),this.inputBindingEnabled=ve(Ym,{optional:!0})!==null,this.titleStrategy=ve(xP),this.options=ve(th,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ve(Yb),this.createViewTransition=ve(yP,{optional:!0}),this.navigationErrorHandler=ve(G8,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>st(void 0),this.rootComponentType=null;let t=r=>this.events.next(new Tb(r)),n=r=>this.events.next(new Ib(r));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;this.transitions?.next(Ge(re(re({},this.transitions.value),t),{id:n}))}setupNavigations(t,n,r){return this.transitions=new pi({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Uu,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ji(s=>s.id!==0),bt(s=>Ge(re({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Wi(s=>{let o=!1,a=!1;return st(s).pipe(Wi(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",cr.SupersededByNewNavigation),or;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Ge(re({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload"){let u="";return this.events.next(new ga(l.id,this.urlSerializer.serialize(l.rawUrl),u,Vm.IgnoredSameUrlNavigation)),l.resolve(!1),or}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return st(l).pipe(Wi(u=>{let h=this.transitions?.getValue();return this.events.next(new zc(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?or:Promise.resolve(u)}),R8(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),si(u=>{s.targetSnapshot=u.targetSnapshot,s.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=Ge(re({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let h=new Um(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:u,extractedUrl:h,source:f,restoredState:p,extras:v}=l,g=new zc(u,this.urlSerializer.serialize(h),f,p);this.events.next(g);let m=aP(this.rootComponentType).snapshot;return this.currentTransition=s=Ge(re({},l),{targetSnapshot:m,urlAfterRedirects:h,extras:Ge(re({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,st(s)}else{let u="";return this.events.next(new ga(l.id,this.urlSerializer.serialize(l.extractedUrl),u,Vm.IgnoredByUrlHandlingStrategy)),l.resolve(!1),or}}),si(l=>{let c=new Sb(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),bt(l=>(this.currentTransition=s=Ge(re({},l),{guards:JU(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),c8(this.environmentInjector,l=>this.events.next(l)),si(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw qm(this.urlSerializer,l.guardsResult);let c=new Eb(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),ji(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",cr.GuardRejected),!1)),xb(l=>{if(l.guards.canActivateChecks.length)return st(l).pipe(si(c=>{let d=new Cb(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Wi(c=>{let d=!1;return st(c).pipe(L8(this.paramsInheritanceStrategy,this.environmentInjector),si({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",cr.NoDataFromResolver)}}))}),si(c=>{let d=new Mb(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),xb(l=>{let c=d=>{let u=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(d.routeConfig).pipe(si(h=>{d.component=h}),bt(()=>{})));for(let h of d.children)u.push(...c(h));return u};return $a(c(l.targetSnapshot.root)).pipe(Qo(null),Ks(1))}),xb(()=>this.afterPreactivation()),Wi(()=>{let{currentSnapshot:l,targetSnapshot:c}=s,d=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return d?fn(d).pipe(bt(()=>s)):st(s)}),bt(l=>{let c=ZU(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=Ge(re({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),si(()=>{this.events.next(new Gu)}),KU(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ks(1),si({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new os(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),Ox(this.transitionAbortSubject.pipe(si(l=>{throw l}))),el(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",cr.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Gi(l=>{if(a=!0,hP(l))this.events.next(new ho(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),QU(l)?this.events.next(new jc(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let c=new ju(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let d=Er(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(d instanceof qu){let{message:u,cancellationCode:h}=qm(this.urlSerializer,d);this.events.next(new ho(s.id,this.urlSerializer.serialize(s.extractedUrl),u,h)),this.events.next(new jc(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(c);let u=t.errorHandler(l);s.resolve(!!u)}}catch(d){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(d)}}return or}))}))}cancelNavigationTransition(t,n,r){let s=new ho(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function W8(i){return i!==Uu}var q8=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(Z8),providedIn:"root"})}}return i})(),Gb=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Z8=(()=>{class i extends Gb{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),AP=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:()=>ve(X8),providedIn:"root"})}}return i})(),X8=(()=>{class i extends AP{constructor(){super(...arguments),this.location=ve(Rc),this.urlSerializer=ve(Ku),this.options=ve(th,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ve(Yb),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new fo,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=aP(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&t(n.url,n.state)})}handleRouterEvent(t,n){if(t instanceof zc)this.stateMemento=this.createStateMemento();else if(t instanceof ga)this.rawUrlTree=n.initialUrl;else if(t instanceof Um){if(this.urlUpdateStrategy==="eager"&&!n.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(n.targetBrowserUrl??r,n)}}else t instanceof Gu?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(n.targetBrowserUrl??this.rawUrlTree,n)):t instanceof ho&&(t.code===cr.GuardRejected||t.code===cr.NoDataFromResolver)?this.restoreHistory(n):t instanceof ju?this.restoreHistory(n,!0):t instanceof os&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,n){let r=t instanceof fo?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){let s=this.browserPageId,o=re(re({},n.extras.state),this.generateNgRouterState(n.id,s));this.location.replaceState(r,"",o)}else{let s=re(re({},n.extras.state),this.generateNgRouterState(n.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Bu=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(Bu||{});function _P(i,e){i.events.pipe(ji(t=>t instanceof os||t instanceof ho||t instanceof ju||t instanceof ga),bt(t=>t instanceof os||t instanceof ga?Bu.COMPLETE:(t instanceof ho?t.code===cr.Redirect||t.code===cr.SupersededByNewNavigation:!1)?Bu.REDIRECTING:Bu.FAILED),ji(t=>t!==Bu.REDIRECTING),Ks(1)).subscribe(()=>{e()})}function Y8(i){throw i}var Q8={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},K8={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},et=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ve(vm),this.stateManager=ve(AP),this.options=ve(th,{optional:!0})||{},this.pendingTasks=ve(io),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ve(Qb),this.urlSerializer=ve(Ku),this.location=ve(Rc),this.urlHandlingStrategy=ve(Yb),this._events=new ri,this.errorHandler=this.options.errorHandler||Y8,this.navigated=!1,this.routeReuseStrategy=ve(q8),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ve(Yu,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ve(Ym,{optional:!0}),this.eventsSubscription=new Bn,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(n,s),n instanceof ho&&n.code!==cr.Redirect&&n.code!==cr.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof os)this.navigated=!0;else if(n instanceof jc){let o=n.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),l=re({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||W8(r.source)},o);this.scheduleNavigation(a,Uu,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}$8(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Uu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",n)},0)})}navigateToSyncWithBrowser(t,n,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=re({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Zb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=l?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=re(re({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let u;try{let h=r?r.snapshot:this.routerState.snapshot.root;u=iP(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),u=this.currentUrlTree.root}return rP(u,t,d,c??null)}navigateByUrl(t,n={skipLocationChange:!1}){let r=wl(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Uu,null,n)}navigate(t,n={skipLocationChange:!1}){return J8(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let r;if(n===!0?r=re({},Q8):n===!1?r=re({},K8):r=n,wl(t))return OD(this.currentUrlTree,t,r);let s=this.parseUrl(t);return OD(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((n,[r,s])=>(s!=null&&(n[r]=s),n),{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((u,h)=>{a=u,l=h});let d=this.pendingTasks.add();return _P(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function J8(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new ze(4008,!1)}function $8(i){return!(i instanceof Gu)&&!(i instanceof jc)}var Wc=(()=>{class i{constructor(t,n,r,s,o,a){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.onChanges=new ri,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof os&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(wl(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,n,r,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||n||r||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let n=this.href===null?null:sI(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(t,n){let r=this.renderer,s=this.el.nativeElement;n!==null?r.setAttribute(s,t,n):r.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:wl(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(n){return new(n||i)(ne(et),ne(va),vy("tabindex"),ne(Fi),ne(oi),ne(lo))}}static{this.\u0275dir=dn({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,r){n&1&&Z("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),n&2&&Ic("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ha],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ha],replaceUrl:[2,"replaceUrl","replaceUrl",ha],routerLink:"routerLink"},standalone:!0,features:[By,Ni]})}}return i})(),Km=(()=>{class i{get isActive(){return this._isActive}constructor(t,n,r,s,o){this.router=t,this.element=n,this.renderer=r,this.cdr=s,this.link=o,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new _n,this.routerEventsSubscription=t.events.subscribe(a=>{a instanceof os&&this.update()})}ngAfterContentInit(){st(this.links.changes,st(null)).pipe(Yo()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(n=>!!n).map(n=>n.onChanges);this.linkInputChangesSubscription=fn(t).pipe(Yo()).subscribe(n=>{this._isActive!==this.isLinkActive(this.router)(n)&&this.update()})}set routerLinkActive(t){let n=Array.isArray(t)?t:t.split(" ");this.classes=n.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(n=>{t?this.renderer.addClass(this.element.nativeElement,n):this.renderer.removeClass(this.element.nativeElement,n)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let n=e6(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let s=r.urlTree;return s?t.isActive(s,n):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static{this.\u0275fac=function(n){return new(n||i)(ne(et),ne(oi),ne(Fi),ne(ks),ne(Wc,8))}}static{this.\u0275dir=dn({type:i,selectors:[["","routerLinkActive",""]],contentQueries:function(n,r,s){if(n&1&&QI(s,Wc,5),n&2){let o;zn(o=jn())&&(r.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ni]})}}return i})();function e6(i){return!!i.paths}var Xm=class{};var t6=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ji(t=>t instanceof os),Qs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){let r=[];for(let s of n){s.providers&&!s._injector&&(s._injector=pm(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return fn(r).pipe(Yo())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;n.loadChildren&&n.canLoad===void 0?r=this.loader.loadChildren(t,n):r=st(null);let s=r.pipe(Un(o=>o===null?st(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(n.loadComponent&&!n._loadedComponent){let o=this.loader.loadComponent(n);return fn([s,o]).pipe(Yo())}else return s})}static{this.\u0275fac=function(n){return new(n||i)(Me(et),Me(wm),Me(ki),Me(Xm),Me(Xb))}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),SP=new Je(""),n6=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof zc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof os?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof ga&&t.code===Vm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Hm&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Hm(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(n){wI()}}static{this.\u0275prov=Se({token:i,factory:i.\u0275fac})}}return i})();function EP(i,...e){return wu([{provide:Yu,multi:!0,useValue:i},[],{provide:va,useFactory:CP,deps:[et]},{provide:Mu,multi:!0,useFactory:MP},e.map(t=>t.\u0275providers)])}function CP(i){return i.routerState.root}function nh(i,e){return{\u0275kind:i,\u0275providers:e}}function MP(){let i=ve(Sr);return e=>{let t=i.get(ua);if(e!==t.components[0])return;let n=i.get(et),r=i.get(TP);i.get(Kb)===1&&n.initialNavigation(),i.get(IP,null,Rt.Optional)?.setUpPreloading(),i.get(SP,null,Rt.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var TP=new Je("",{factory:()=>new ri}),Kb=new Je("",{providedIn:"root",factory:()=>1});function i6(){return nh(2,[{provide:Kb,useValue:0},{provide:xm,multi:!0,deps:[Sr],useFactory:e=>{let t=e.get(hD,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let r=e.get(et),s=e.get(TP);_P(r,()=>{n(!0)}),e.get(Qb).afterPreactivation=()=>(n(!0),s.closed?st(void 0):s),r.initialNavigation()}))}}])}function r6(){return nh(3,[{provide:xm,multi:!0,useFactory:()=>{let e=ve(et);return()=>{e.setUpLocationChangeListener()}}},{provide:Kb,useValue:2}])}var IP=new Je("");function s6(i){return nh(0,[{provide:IP,useExisting:t6},{provide:Xm,useExisting:i}])}function o6(){return nh(8,[HD,{provide:Ym,useExisting:HD}])}function a6(i){let e=[{provide:yP,useValue:z8},{provide:bP,useValue:re({skipNextTransition:!!i?.skipInitialTransition},i)}];return nh(9,e)}var WD=new Je("ROUTER_FORROOT_GUARD"),l6=[Rc,{provide:Ku,useClass:Hc},et,$u,{provide:va,useFactory:CP,deps:[et]},Xb,[]],ih=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[l6,[],{provide:Yu,multi:!0,useValue:t},{provide:WD,useFactory:h6,deps:[[et,new vu,new Zp]]},{provide:th,useValue:n||{}},n?.useHash?d6():u6(),c6(),n?.preloadingStrategy?s6(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?f6(n):[],n?.bindToComponentInputs?o6().\u0275providers:[],n?.enableViewTransitions?a6().\u0275providers:[],p6()]}}static forChild(t){return{ngModule:i,providers:[{provide:Yu,multi:!0,useValue:t}]}}static{this.\u0275fac=function(n){return new(n||i)(Me(WD,8))}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})();function c6(){return{provide:SP,useFactory:()=>{let i=ve(vD),e=ve(sn),t=ve(th),n=ve(Qb),r=ve(Ku);return t.scrollOffset&&i.setOffset(t.scrollOffset),new n6(r,n,i,e,t)}}}function d6(){return{provide:lo,useClass:pD}}function u6(){return{provide:lo,useClass:tb}}function h6(i){return"guarded"}function f6(i){return[i.initialNavigation==="disabled"?r6().\u0275providers:[],i.initialNavigation==="enabledBlocking"?i6().\u0275providers:[]]}var qD=new Je("");function p6(){return[{provide:qD,useFactory:MP},{provide:Mu,multi:!0,useExisting:qD}]}function DP(i){return i!==null&&typeof i=="object"&&"constructor"in i&&i.constructor===Object}function Jb(i,e){i===void 0&&(i={}),e===void 0&&(e={}),Object.keys(e).forEach(t=>{typeof i[t]>"u"?i[t]=e[t]:DP(e[t])&&DP(i[t])&&Object.keys(e[t]).length>0&&Jb(i[t],e[t])})}var PP={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Oi(){let i=typeof document<"u"?document:{};return Jb(i,PP),i}var m6={document:PP,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(i){return typeof setTimeout>"u"?(i(),null):setTimeout(i,0)},cancelAnimationFrame(i){typeof setTimeout>"u"||clearTimeout(i)}};function Gn(){let i=typeof window<"u"?window:{};return Jb(i,m6),i}function RP(i){return i===void 0&&(i=""),i.trim().split(" ").filter(e=>!!e.trim())}function LP(i){let e=i;Object.keys(e).forEach(t=>{try{e[t]=null}catch{}try{delete e[t]}catch{}})}function yl(i,e){return e===void 0&&(e=0),setTimeout(i,e)}function bl(){return Date.now()}function g6(i){let e=Gn(),t;return e.getComputedStyle&&(t=e.getComputedStyle(i,null)),!t&&i.currentStyle&&(t=i.currentStyle),t||(t=i.style),t}function $b(i,e){e===void 0&&(e="x");let t=Gn(),n,r,s,o=g6(i);return t.WebKitCSSMatrix?(r=o.transform||o.webkitTransform,r.split(",").length>6&&(r=r.split(", ").map(a=>a.replace(",",".")).join(", ")),s=new t.WebKitCSSMatrix(r==="none"?"":r)):(s=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=s.toString().split(",")),e==="x"&&(t.WebKitCSSMatrix?r=s.m41:n.length===16?r=parseFloat(n[12]):r=parseFloat(n[4])),e==="y"&&(t.WebKitCSSMatrix?r=s.m42:n.length===16?r=parseFloat(n[13]):r=parseFloat(n[5])),r||0}function rh(i){return typeof i=="object"&&i!==null&&i.constructor&&Object.prototype.toString.call(i).slice(8,-1)==="Object"}function v6(i){return typeof window<"u"&&typeof window.HTMLElement<"u"?i instanceof HTMLElement:i&&(i.nodeType===1||i.nodeType===11)}function Yi(){let i=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let t=1;t<arguments.length;t+=1){let n=t<0||arguments.length<=t?void 0:arguments[t];if(n!=null&&!v6(n)){let r=Object.keys(Object(n)).filter(s=>e.indexOf(s)<0);for(let s=0,o=r.length;s<o;s+=1){let a=r[s],l=Object.getOwnPropertyDescriptor(n,a);l!==void 0&&l.enumerable&&(rh(i[a])&&rh(n[a])?n[a].__swiper__?i[a]=n[a]:Yi(i[a],n[a]):!rh(i[a])&&rh(n[a])?(i[a]={},n[a].__swiper__?i[a]=n[a]:Yi(i[a],n[a])):i[a]=n[a])}}}return i}function Zc(i,e,t){i.style.setProperty(e,t)}function eA(i){let{swiper:e,targetPosition:t,side:n}=i,r=Gn(),s=-e.translate,o=null,a,l=e.params.speed;e.wrapperEl.style.scrollSnapType="none",r.cancelAnimationFrame(e.cssModeFrameID);let c=t>s?"next":"prev",d=(h,f)=>c==="next"&&h>=f||c==="prev"&&h<=f,u=()=>{a=new Date().getTime(),o===null&&(o=a);let h=Math.max(Math.min((a-o)/l,1),0),f=.5-Math.cos(h*Math.PI)/2,p=s+f*(t-s);if(d(p,t)&&(p=t),e.wrapperEl.scrollTo({[n]:p}),d(p,t)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[n]:p})}),r.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=r.requestAnimationFrame(u)};u()}function xi(i,e){e===void 0&&(e="");let t=[...i.children];return i instanceof HTMLSlotElement&&t.push(...i.assignedElements()),e?t.filter(n=>n.matches(e)):t}function kP(i,e){let t=e.contains(i);return!t&&e instanceof HTMLSlotElement?[...e.assignedElements()].includes(i):t}function sh(i){try{console.warn(i);return}catch{}}function as(i,e){e===void 0&&(e=[]);let t=document.createElement(i);return t.classList.add(...Array.isArray(e)?e:RP(e)),t}function NP(i,e){let t=[];for(;i.previousElementSibling;){let n=i.previousElementSibling;e?n.matches(e)&&t.push(n):t.push(n),i=n}return t}function FP(i,e){let t=[];for(;i.nextElementSibling;){let n=i.nextElementSibling;e?n.matches(e)&&t.push(n):t.push(n),i=n}return t}function po(i,e){return Gn().getComputedStyle(i,null).getPropertyValue(e)}function Al(i){let e=i,t;if(e){for(t=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(t+=1);return t}}function Xc(i,e){let t=[],n=i.parentElement;for(;n;)e?n.matches(e)&&t.push(n):t.push(n),n=n.parentElement;return t}function oh(i,e,t){let n=Gn();return t?i[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(n.getComputedStyle(i,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(n.getComputedStyle(i,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom")):i.offsetWidth}function Pn(i){return(Array.isArray(i)?i:[i]).filter(e=>!!e)}var tA;function x6(){let i=Gn(),e=Oi();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in i||i.DocumentTouch&&e instanceof i.DocumentTouch)}}function zP(){return tA||(tA=x6()),tA}var nA;function w6(i){let{userAgent:e}=i===void 0?{}:i,t=zP(),n=Gn(),r=n.navigator.platform,s=e||n.navigator.userAgent,o={ios:!1,android:!1},a=n.screen.width,l=n.screen.height,c=s.match(/(Android);?[\s\/]+([\d.]+)?/),d=s.match(/(iPad).*OS\s([\d_]+)/),u=s.match(/(iPod)(.*OS\s([\d_]+))?/),h=!d&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),f=r==="Win32",p=r==="MacIntel",v=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!d&&p&&t.touch&&v.indexOf(`${a}x${l}`)>=0&&(d=s.match(/(Version)\/([\d.]+)/),d||(d=[0,1,"13_0_0"]),p=!1),c&&!f&&(o.os="android",o.android=!0),(d||h||u)&&(o.os="ios",o.ios=!0),o}function jP(i){return i===void 0&&(i={}),nA||(nA=w6(i)),nA}var iA;function y6(){let i=Gn(),e=jP(),t=!1;function n(){let a=i.navigator.userAgent.toLowerCase();return a.indexOf("safari")>=0&&a.indexOf("chrome")<0&&a.indexOf("android")<0}if(n()){let a=String(i.navigator.userAgent);if(a.includes("Version/")){let[l,c]=a.split("Version/")[1].split(" ")[0].split(".").map(d=>Number(d));t=l<16||l===16&&c<2}}let r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(i.navigator.userAgent),s=n(),o=s||r&&e.ios;return{isSafari:t||s,needPerspectiveFix:t,need3dFix:o,isWebView:r}}function b6(){return iA||(iA=y6()),iA}function A6(i){let{swiper:e,on:t,emit:n}=i,r=Gn(),s=null,o=null,a=()=>{!e||e.destroyed||!e.initialized||(n("beforeResize"),n("resize"))},l=()=>{!e||e.destroyed||!e.initialized||(s=new ResizeObserver(u=>{o=r.requestAnimationFrame(()=>{let{width:h,height:f}=e,p=h,v=f;u.forEach(g=>{let{contentBoxSize:m,contentRect:y,target:w}=g;w&&w!==e.el||(p=y?y.width:(m[0]||m).inlineSize,v=y?y.height:(m[0]||m).blockSize)}),(p!==h||v!==f)&&a()})}),s.observe(e.el))},c=()=>{o&&r.cancelAnimationFrame(o),s&&s.unobserve&&e.el&&(s.unobserve(e.el),s=null)},d=()=>{!e||e.destroyed||!e.initialized||n("orientationchange")};t("init",()=>{if(e.params.resizeObserver&&typeof r.ResizeObserver<"u"){l();return}r.addEventListener("resize",a),r.addEventListener("orientationchange",d)}),t("destroy",()=>{c(),r.removeEventListener("resize",a),r.removeEventListener("orientationchange",d)})}function _6(i){let{swiper:e,extendParams:t,on:n,emit:r}=i,s=[],o=Gn(),a=function(d,u){u===void 0&&(u={});let h=o.MutationObserver||o.WebkitMutationObserver,f=new h(p=>{if(e.__preventObserver__)return;if(p.length===1){r("observerUpdate",p[0]);return}let v=function(){r("observerUpdate",p[0])};o.requestAnimationFrame?o.requestAnimationFrame(v):o.setTimeout(v,0)});f.observe(d,{attributes:typeof u.attributes>"u"?!0:u.attributes,childList:e.isElement||(typeof u.childList>"u"?!0:u).childList,characterData:typeof u.characterData>"u"?!0:u.characterData}),s.push(f)},l=()=>{if(e.params.observer){if(e.params.observeParents){let d=Xc(e.hostEl);for(let u=0;u<d.length;u+=1)a(d[u])}a(e.hostEl,{childList:e.params.observeSlideChildren}),a(e.wrapperEl,{attributes:!1})}},c=()=>{s.forEach(d=>{d.disconnect()}),s.splice(0,s.length)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),n("init",l),n("destroy",c)}var S6={on(i,e,t){let n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;let r=t?"unshift":"push";return i.split(" ").forEach(s=>{n.eventsListeners[s]||(n.eventsListeners[s]=[]),n.eventsListeners[s][r](e)}),n},once(i,e,t){let n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;function r(){n.off(i,r),r.__emitterProxy&&delete r.__emitterProxy;for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];e.apply(n,o)}return r.__emitterProxy=e,n.on(i,r,t)},onAny(i,e){let t=this;if(!t.eventsListeners||t.destroyed||typeof i!="function")return t;let n=e?"unshift":"push";return t.eventsAnyListeners.indexOf(i)<0&&t.eventsAnyListeners[n](i),t},offAny(i){let e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;let t=e.eventsAnyListeners.indexOf(i);return t>=0&&e.eventsAnyListeners.splice(t,1),e},off(i,e){let t=this;return!t.eventsListeners||t.destroyed||!t.eventsListeners||i.split(" ").forEach(n=>{typeof e>"u"?t.eventsListeners[n]=[]:t.eventsListeners[n]&&t.eventsListeners[n].forEach((r,s)=>{(r===e||r.__emitterProxy&&r.__emitterProxy===e)&&t.eventsListeners[n].splice(s,1)})}),t},emit(){let i=this;if(!i.eventsListeners||i.destroyed||!i.eventsListeners)return i;let e,t,n;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return typeof s[0]=="string"||Array.isArray(s[0])?(e=s[0],t=s.slice(1,s.length),n=i):(e=s[0].events,t=s[0].data,n=s[0].context||i),t.unshift(n),(Array.isArray(e)?e:e.split(" ")).forEach(l=>{i.eventsAnyListeners&&i.eventsAnyListeners.length&&i.eventsAnyListeners.forEach(c=>{c.apply(n,[l,...t])}),i.eventsListeners&&i.eventsListeners[l]&&i.eventsListeners[l].forEach(c=>{c.apply(n,t)})}),i}};function E6(){let i=this,e,t,n=i.el;typeof i.params.width<"u"&&i.params.width!==null?e=i.params.width:e=n.clientWidth,typeof i.params.height<"u"&&i.params.height!==null?t=i.params.height:t=n.clientHeight,!(e===0&&i.isHorizontal()||t===0&&i.isVertical())&&(e=e-parseInt(po(n,"padding-left")||0,10)-parseInt(po(n,"padding-right")||0,10),t=t-parseInt(po(n,"padding-top")||0,10)-parseInt(po(n,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(t)&&(t=0),Object.assign(i,{width:e,height:t,size:i.isHorizontal()?e:t}))}function C6(){let i=this;function e(_,P){return parseFloat(_.getPropertyValue(i.getDirectionLabel(P))||0)}let t=i.params,{wrapperEl:n,slidesEl:r,size:s,rtlTranslate:o,wrongRTL:a}=i,l=i.virtual&&t.virtual.enabled,c=l?i.virtual.slides.length:i.slides.length,d=xi(r,`.${i.params.slideClass}, swiper-slide`),u=l?i.virtual.slides.length:d.length,h=[],f=[],p=[],v=t.slidesOffsetBefore;typeof v=="function"&&(v=t.slidesOffsetBefore.call(i));let g=t.slidesOffsetAfter;typeof g=="function"&&(g=t.slidesOffsetAfter.call(i));let m=i.snapGrid.length,y=i.slidesGrid.length,w=t.spaceBetween,A=-v,C=0,E=0;if(typeof s>"u")return;typeof w=="string"&&w.indexOf("%")>=0?w=parseFloat(w.replace("%",""))/100*s:typeof w=="string"&&(w=parseFloat(w)),i.virtualSize=-w,d.forEach(_=>{o?_.style.marginLeft="":_.style.marginRight="",_.style.marginBottom="",_.style.marginTop=""}),t.centeredSlides&&t.cssMode&&(Zc(n,"--swiper-centered-offset-before",""),Zc(n,"--swiper-centered-offset-after",""));let T=t.grid&&t.grid.rows>1&&i.grid;T?i.grid.initSlides(d):i.grid&&i.grid.unsetSlides();let L,S=t.slidesPerView==="auto"&&t.breakpoints&&Object.keys(t.breakpoints).filter(_=>typeof t.breakpoints[_].slidesPerView<"u").length>0;for(let _=0;_<u;_+=1){L=0;let P;if(d[_]&&(P=d[_]),T&&i.grid.updateSlide(_,P,d),!(d[_]&&po(P,"display")==="none")){if(t.slidesPerView==="auto"){S&&(d[_].style[i.getDirectionLabel("width")]="");let U=getComputedStyle(P),O=P.style.transform,z=P.style.webkitTransform;if(O&&(P.style.transform="none"),z&&(P.style.webkitTransform="none"),t.roundLengths)L=i.isHorizontal()?oh(P,"width",!0):oh(P,"height",!0);else{let q=e(U,"width"),Q=e(U,"padding-left"),K=e(U,"padding-right"),W=e(U,"margin-left"),Ee=e(U,"margin-right"),Te=U.getPropertyValue("box-sizing");if(Te&&Te==="border-box")L=q+W+Ee;else{let{clientWidth:ke,offsetWidth:We}=P;L=q+Q+K+W+Ee+(We-ke)}}O&&(P.style.transform=O),z&&(P.style.webkitTransform=z),t.roundLengths&&(L=Math.floor(L))}else L=(s-(t.slidesPerView-1)*w)/t.slidesPerView,t.roundLengths&&(L=Math.floor(L)),d[_]&&(d[_].style[i.getDirectionLabel("width")]=`${L}px`);d[_]&&(d[_].swiperSlideSize=L),p.push(L),t.centeredSlides?(A=A+L/2+C/2+w,C===0&&_!==0&&(A=A-s/2-w),_===0&&(A=A-s/2-w),Math.abs(A)<1/1e3&&(A=0),t.roundLengths&&(A=Math.floor(A)),E%t.slidesPerGroup===0&&h.push(A),f.push(A)):(t.roundLengths&&(A=Math.floor(A)),(E-Math.min(i.params.slidesPerGroupSkip,E))%i.params.slidesPerGroup===0&&h.push(A),f.push(A),A=A+L+w),i.virtualSize+=L+w,C=L,E+=1}}if(i.virtualSize=Math.max(i.virtualSize,s)+g,o&&a&&(t.effect==="slide"||t.effect==="coverflow")&&(n.style.width=`${i.virtualSize+w}px`),t.setWrapperSize&&(n.style[i.getDirectionLabel("width")]=`${i.virtualSize+w}px`),T&&i.grid.updateWrapperSize(L,h),!t.centeredSlides){let _=[];for(let P=0;P<h.length;P+=1){let U=h[P];t.roundLengths&&(U=Math.floor(U)),h[P]<=i.virtualSize-s&&_.push(U)}h=_,Math.floor(i.virtualSize-s)-Math.floor(h[h.length-1])>1&&h.push(i.virtualSize-s)}if(l&&t.loop){let _=p[0]+w;if(t.slidesPerGroup>1){let P=Math.ceil((i.virtual.slidesBefore+i.virtual.slidesAfter)/t.slidesPerGroup),U=_*t.slidesPerGroup;for(let O=0;O<P;O+=1)h.push(h[h.length-1]+U)}for(let P=0;P<i.virtual.slidesBefore+i.virtual.slidesAfter;P+=1)t.slidesPerGroup===1&&h.push(h[h.length-1]+_),f.push(f[f.length-1]+_),i.virtualSize+=_}if(h.length===0&&(h=[0]),w!==0){let _=i.isHorizontal()&&o?"marginLeft":i.getDirectionLabel("marginRight");d.filter((P,U)=>!t.cssMode||t.loop?!0:U!==d.length-1).forEach(P=>{P.style[_]=`${w}px`})}if(t.centeredSlides&&t.centeredSlidesBounds){let _=0;p.forEach(U=>{_+=U+(w||0)}),_-=w;let P=_>s?_-s:0;h=h.map(U=>U<=0?-v:U>P?P+g:U)}if(t.centerInsufficientSlides){let _=0;p.forEach(U=>{_+=U+(w||0)}),_-=w;let P=(t.slidesOffsetBefore||0)+(t.slidesOffsetAfter||0);if(_+P<s){let U=(s-_-P)/2;h.forEach((O,z)=>{h[z]=O-U}),f.forEach((O,z)=>{f[z]=O+U})}}if(Object.assign(i,{slides:d,snapGrid:h,slidesGrid:f,slidesSizesGrid:p}),t.centeredSlides&&t.cssMode&&!t.centeredSlidesBounds){Zc(n,"--swiper-centered-offset-before",`${-h[0]}px`),Zc(n,"--swiper-centered-offset-after",`${i.size/2-p[p.length-1]/2}px`);let _=-i.snapGrid[0],P=-i.slidesGrid[0];i.snapGrid=i.snapGrid.map(U=>U+_),i.slidesGrid=i.slidesGrid.map(U=>U+P)}if(u!==c&&i.emit("slidesLengthChange"),h.length!==m&&(i.params.watchOverflow&&i.checkOverflow(),i.emit("snapGridLengthChange")),f.length!==y&&i.emit("slidesGridLengthChange"),t.watchSlidesProgress&&i.updateSlidesOffset(),i.emit("slidesUpdated"),!l&&!t.cssMode&&(t.effect==="slide"||t.effect==="fade")){let _=`${t.containerModifierClass}backface-hidden`,P=i.el.classList.contains(_);u<=t.maxBackfaceHiddenSlides?P||i.el.classList.add(_):P&&i.el.classList.remove(_)}}function M6(i){let e=this,t=[],n=e.virtual&&e.params.virtual.enabled,r=0,s;typeof i=="number"?e.setTransition(i):i===!0&&e.setTransition(e.params.speed);let o=a=>n?e.slides[e.getSlideIndexByData(a)]:e.slides[a];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(a=>{t.push(a)});else for(s=0;s<Math.ceil(e.params.slidesPerView);s+=1){let a=e.activeIndex+s;if(a>e.slides.length&&!n)break;t.push(o(a))}else t.push(o(e.activeIndex));for(s=0;s<t.length;s+=1)if(typeof t[s]<"u"){let a=t[s].offsetHeight;r=a>r?a:r}(r||r===0)&&(e.wrapperEl.style.height=`${r}px`)}function T6(){let i=this,e=i.slides,t=i.isElement?i.isHorizontal()?i.wrapperEl.offsetLeft:i.wrapperEl.offsetTop:0;for(let n=0;n<e.length;n+=1)e[n].swiperSlideOffset=(i.isHorizontal()?e[n].offsetLeft:e[n].offsetTop)-t-i.cssOverflowAdjustment()}var OP=(i,e,t)=>{e&&!i.classList.contains(t)?i.classList.add(t):!e&&i.classList.contains(t)&&i.classList.remove(t)};function I6(i){i===void 0&&(i=this&&this.translate||0);let e=this,t=e.params,{slides:n,rtlTranslate:r,snapGrid:s}=e;if(n.length===0)return;typeof n[0].swiperSlideOffset>"u"&&e.updateSlidesOffset();let o=-i;r&&(o=i),e.visibleSlidesIndexes=[],e.visibleSlides=[];let a=t.spaceBetween;typeof a=="string"&&a.indexOf("%")>=0?a=parseFloat(a.replace("%",""))/100*e.size:typeof a=="string"&&(a=parseFloat(a));for(let l=0;l<n.length;l+=1){let c=n[l],d=c.swiperSlideOffset;t.cssMode&&t.centeredSlides&&(d-=n[0].swiperSlideOffset);let u=(o+(t.centeredSlides?e.minTranslate():0)-d)/(c.swiperSlideSize+a),h=(o-s[0]+(t.centeredSlides?e.minTranslate():0)-d)/(c.swiperSlideSize+a),f=-(o-d),p=f+e.slidesSizesGrid[l],v=f>=0&&f<=e.size-e.slidesSizesGrid[l],g=f>=0&&f<e.size-1||p>1&&p<=e.size||f<=0&&p>=e.size;g&&(e.visibleSlides.push(c),e.visibleSlidesIndexes.push(l)),OP(c,g,t.slideVisibleClass),OP(c,v,t.slideFullyVisibleClass),c.progress=r?-u:u,c.originalProgress=r?-h:h}}function D6(i){let e=this;if(typeof i>"u"){let d=e.rtlTranslate?-1:1;i=e&&e.translate&&e.translate*d||0}let t=e.params,n=e.maxTranslate()-e.minTranslate(),{progress:r,isBeginning:s,isEnd:o,progressLoop:a}=e,l=s,c=o;if(n===0)r=0,s=!0,o=!0;else{r=(i-e.minTranslate())/n;let d=Math.abs(i-e.minTranslate())<1,u=Math.abs(i-e.maxTranslate())<1;s=d||r<=0,o=u||r>=1,d&&(r=0),u&&(r=1)}if(t.loop){let d=e.getSlideIndexByData(0),u=e.getSlideIndexByData(e.slides.length-1),h=e.slidesGrid[d],f=e.slidesGrid[u],p=e.slidesGrid[e.slidesGrid.length-1],v=Math.abs(i);v>=h?a=(v-h)/p:a=(v+p-f)/p,a>1&&(a-=1)}Object.assign(e,{progress:r,progressLoop:a,isBeginning:s,isEnd:o}),(t.watchSlidesProgress||t.centeredSlides&&t.autoHeight)&&e.updateSlidesProgress(i),s&&!l&&e.emit("reachBeginning toEdge"),o&&!c&&e.emit("reachEnd toEdge"),(l&&!s||c&&!o)&&e.emit("fromEdge"),e.emit("progress",r)}var rA=(i,e,t)=>{e&&!i.classList.contains(t)?i.classList.add(t):!e&&i.classList.contains(t)&&i.classList.remove(t)};function P6(){let i=this,{slides:e,params:t,slidesEl:n,activeIndex:r}=i,s=i.virtual&&t.virtual.enabled,o=i.grid&&t.grid&&t.grid.rows>1,a=u=>xi(n,`.${t.slideClass}${u}, swiper-slide${u}`)[0],l,c,d;if(s)if(t.loop){let u=r-i.virtual.slidesBefore;u<0&&(u=i.virtual.slides.length+u),u>=i.virtual.slides.length&&(u-=i.virtual.slides.length),l=a(`[data-swiper-slide-index="${u}"]`)}else l=a(`[data-swiper-slide-index="${r}"]`);else o?(l=e.filter(u=>u.column===r)[0],d=e.filter(u=>u.column===r+1)[0],c=e.filter(u=>u.column===r-1)[0]):l=e[r];l&&(o||(d=FP(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!d&&(d=e[0]),c=NP(l,`.${t.slideClass}, swiper-slide`)[0],t.loop&&!c===0&&(c=e[e.length-1]))),e.forEach(u=>{rA(u,u===l,t.slideActiveClass),rA(u,u===d,t.slideNextClass),rA(u,u===c,t.slidePrevClass)}),i.emitSlidesClasses()}var Jm=(i,e)=>{if(!i||i.destroyed||!i.params)return;let t=()=>i.isElement?"swiper-slide":`.${i.params.slideClass}`,n=e.closest(t());if(n){let r=n.querySelector(`.${i.params.lazyPreloaderClass}`);!r&&i.isElement&&(n.shadowRoot?r=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{n.shadowRoot&&(r=n.shadowRoot.querySelector(`.${i.params.lazyPreloaderClass}`),r&&r.remove())})),r&&r.remove()}},sA=(i,e)=>{if(!i.slides[e])return;let t=i.slides[e].querySelector('[loading="lazy"]');t&&t.removeAttribute("loading")},lA=i=>{if(!i||i.destroyed||!i.params)return;let e=i.params.lazyPreloadPrevNext,t=i.slides.length;if(!t||!e||e<0)return;e=Math.min(e,t);let n=i.params.slidesPerView==="auto"?i.slidesPerViewDynamic():Math.ceil(i.params.slidesPerView),r=i.activeIndex;if(i.params.grid&&i.params.grid.rows>1){let o=r,a=[o-e];a.push(...Array.from({length:e}).map((l,c)=>o+n+c)),i.slides.forEach((l,c)=>{a.includes(l.column)&&sA(i,c)});return}let s=r+n-1;if(i.params.rewind||i.params.loop)for(let o=r-e;o<=s+e;o+=1){let a=(o%t+t)%t;(a<r||a>s)&&sA(i,a)}else for(let o=Math.max(r-e,0);o<=Math.min(s+e,t-1);o+=1)o!==r&&(o>s||o<r)&&sA(i,o)};function R6(i){let{slidesGrid:e,params:t}=i,n=i.rtlTranslate?i.translate:-i.translate,r;for(let s=0;s<e.length;s+=1)typeof e[s+1]<"u"?n>=e[s]&&n<e[s+1]-(e[s+1]-e[s])/2?r=s:n>=e[s]&&n<e[s+1]&&(r=s+1):n>=e[s]&&(r=s);return t.normalizeSlideIndex&&(r<0||typeof r>"u")&&(r=0),r}function L6(i){let e=this,t=e.rtlTranslate?e.translate:-e.translate,{snapGrid:n,params:r,activeIndex:s,realIndex:o,snapIndex:a}=e,l=i,c,d=f=>{let p=f-e.virtual.slidesBefore;return p<0&&(p=e.virtual.slides.length+p),p>=e.virtual.slides.length&&(p-=e.virtual.slides.length),p};if(typeof l>"u"&&(l=R6(e)),n.indexOf(t)>=0)c=n.indexOf(t);else{let f=Math.min(r.slidesPerGroupSkip,l);c=f+Math.floor((l-f)/r.slidesPerGroup)}if(c>=n.length&&(c=n.length-1),l===s&&!e.params.loop){c!==a&&(e.snapIndex=c,e.emit("snapIndexChange"));return}if(l===s&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=d(l);return}let u=e.grid&&r.grid&&r.grid.rows>1,h;if(e.virtual&&r.virtual.enabled&&r.loop)h=d(l);else if(u){let f=e.slides.filter(v=>v.column===l)[0],p=parseInt(f.getAttribute("data-swiper-slide-index"),10);Number.isNaN(p)&&(p=Math.max(e.slides.indexOf(f),0)),h=Math.floor(p/r.grid.rows)}else if(e.slides[l]){let f=e.slides[l].getAttribute("data-swiper-slide-index");f?h=parseInt(f,10):h=l}else h=l;Object.assign(e,{previousSnapIndex:a,snapIndex:c,previousRealIndex:o,realIndex:h,previousIndex:s,activeIndex:l}),e.initialized&&lA(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(o!==h&&e.emit("realIndexChange"),e.emit("slideChange"))}function k6(i,e){let t=this,n=t.params,r=i.closest(`.${n.slideClass}, swiper-slide`);!r&&t.isElement&&e&&e.length>1&&e.includes(i)&&[...e.slice(e.indexOf(i)+1,e.length)].forEach(a=>{!r&&a.matches&&a.matches(`.${n.slideClass}, swiper-slide`)&&(r=a)});let s=!1,o;if(r){for(let a=0;a<t.slides.length;a+=1)if(t.slides[a]===r){s=!0,o=a;break}}if(r&&s)t.clickedSlide=r,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(r.getAttribute("data-swiper-slide-index"),10):t.clickedIndex=o;else{t.clickedSlide=void 0,t.clickedIndex=void 0;return}n.slideToClickedSlide&&t.clickedIndex!==void 0&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}var N6={updateSize:E6,updateSlides:C6,updateAutoHeight:M6,updateSlidesOffset:T6,updateSlidesProgress:I6,updateProgress:D6,updateSlidesClasses:P6,updateActiveIndex:L6,updateClickedSlide:k6};function F6(i){i===void 0&&(i=this.isHorizontal()?"x":"y");let e=this,{params:t,rtlTranslate:n,translate:r,wrapperEl:s}=e;if(t.virtualTranslate)return n?-r:r;if(t.cssMode)return r;let o=$b(s,i);return o+=e.cssOverflowAdjustment(),n&&(o=-o),o||0}function O6(i,e){let t=this,{rtlTranslate:n,params:r,wrapperEl:s,progress:o}=t,a=0,l=0,c=0;t.isHorizontal()?a=n?-i:i:l=i,r.roundLengths&&(a=Math.floor(a),l=Math.floor(l)),t.previousTranslate=t.translate,t.translate=t.isHorizontal()?a:l,r.cssMode?s[t.isHorizontal()?"scrollLeft":"scrollTop"]=t.isHorizontal()?-a:-l:r.virtualTranslate||(t.isHorizontal()?a-=t.cssOverflowAdjustment():l-=t.cssOverflowAdjustment(),s.style.transform=`translate3d(${a}px, ${l}px, ${c}px)`);let d,u=t.maxTranslate()-t.minTranslate();u===0?d=0:d=(i-t.minTranslate())/u,d!==o&&t.updateProgress(i),t.emit("setTranslate",t.translate,e)}function B6(){return-this.snapGrid[0]}function V6(){return-this.snapGrid[this.snapGrid.length-1]}function U6(i,e,t,n,r){i===void 0&&(i=0),e===void 0&&(e=this.params.speed),t===void 0&&(t=!0),n===void 0&&(n=!0);let s=this,{params:o,wrapperEl:a}=s;if(s.animating&&o.preventInteractionOnTransition)return!1;let l=s.minTranslate(),c=s.maxTranslate(),d;if(n&&i>l?d=l:n&&i<c?d=c:d=i,s.updateProgress(d),o.cssMode){let u=s.isHorizontal();if(e===0)a[u?"scrollLeft":"scrollTop"]=-d;else{if(!s.support.smoothScroll)return eA({swiper:s,targetPosition:-d,side:u?"left":"top"}),!0;a.scrollTo({[u?"left":"top"]:-d,behavior:"smooth"})}return!0}return e===0?(s.setTransition(0),s.setTranslate(d),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionEnd"))):(s.setTransition(e),s.setTranslate(d),t&&(s.emit("beforeTransitionStart",e,r),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(h){!s||s.destroyed||h.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,t&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}var H6={getTranslate:F6,setTranslate:O6,minTranslate:B6,maxTranslate:V6,translateTo:U6};function z6(i,e){let t=this;t.params.cssMode||(t.wrapperEl.style.transitionDuration=`${i}ms`,t.wrapperEl.style.transitionDelay=i===0?"0ms":""),t.emit("setTransition",i,e)}function GP(i){let{swiper:e,runCallbacks:t,direction:n,step:r}=i,{activeIndex:s,previousIndex:o}=e,a=n;if(a||(s>o?a="next":s<o?a="prev":a="reset"),e.emit(`transition${r}`),t&&s!==o){if(a==="reset"){e.emit(`slideResetTransition${r}`);return}e.emit(`slideChangeTransition${r}`),a==="next"?e.emit(`slideNextTransition${r}`):e.emit(`slidePrevTransition${r}`)}}function j6(i,e){i===void 0&&(i=!0);let t=this,{params:n}=t;n.cssMode||(n.autoHeight&&t.updateAutoHeight(),GP({swiper:t,runCallbacks:i,direction:e,step:"Start"}))}function G6(i,e){i===void 0&&(i=!0);let t=this,{params:n}=t;t.animating=!1,!n.cssMode&&(t.setTransition(0),GP({swiper:t,runCallbacks:i,direction:e,step:"End"}))}var W6={setTransition:z6,transitionStart:j6,transitionEnd:G6};function q6(i,e,t,n,r){i===void 0&&(i=0),t===void 0&&(t=!0),typeof i=="string"&&(i=parseInt(i,10));let s=this,o=i;o<0&&(o=0);let{params:a,snapGrid:l,slidesGrid:c,previousIndex:d,activeIndex:u,rtlTranslate:h,wrapperEl:f,enabled:p}=s;if(!p&&!n&&!r||s.destroyed||s.animating&&a.preventInteractionOnTransition)return!1;typeof e>"u"&&(e=s.params.speed);let v=Math.min(s.params.slidesPerGroupSkip,o),g=v+Math.floor((o-v)/s.params.slidesPerGroup);g>=l.length&&(g=l.length-1);let m=-l[g];if(a.normalizeSlideIndex)for(let C=0;C<c.length;C+=1){let E=-Math.floor(m*100),T=Math.floor(c[C]*100),L=Math.floor(c[C+1]*100);typeof c[C+1]<"u"?E>=T&&E<L-(L-T)/2?o=C:E>=T&&E<L&&(o=C+1):E>=T&&(o=C)}if(s.initialized&&o!==u&&(!s.allowSlideNext&&(h?m>s.translate&&m>s.minTranslate():m<s.translate&&m<s.minTranslate())||!s.allowSlidePrev&&m>s.translate&&m>s.maxTranslate()&&(u||0)!==o))return!1;o!==(d||0)&&t&&s.emit("beforeSlideChangeStart"),s.updateProgress(m);let y;o>u?y="next":o<u?y="prev":y="reset";let w=s.virtual&&s.params.virtual.enabled;if(!(w&&r)&&(h&&-m===s.translate||!h&&m===s.translate))return s.updateActiveIndex(o),a.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),a.effect!=="slide"&&s.setTranslate(m),y!=="reset"&&(s.transitionStart(t,y),s.transitionEnd(t,y)),!1;if(a.cssMode){let C=s.isHorizontal(),E=h?m:-m;if(e===0)w&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),w&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{f[C?"scrollLeft":"scrollTop"]=E})):f[C?"scrollLeft":"scrollTop"]=E,w&&requestAnimationFrame(()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1});else{if(!s.support.smoothScroll)return eA({swiper:s,targetPosition:E,side:C?"left":"top"}),!0;f.scrollTo({[C?"left":"top"]:E,behavior:"smooth"})}return!0}return s.setTransition(e),s.setTranslate(m),s.updateActiveIndex(o),s.updateSlidesClasses(),s.emit("beforeTransitionStart",e,n),s.transitionStart(t,y),e===0?s.transitionEnd(t,y):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(E){!s||s.destroyed||E.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(t,y))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0}function Z6(i,e,t,n){i===void 0&&(i=0),t===void 0&&(t=!0),typeof i=="string"&&(i=parseInt(i,10));let r=this;if(r.destroyed)return;typeof e>"u"&&(e=r.params.speed);let s=r.grid&&r.params.grid&&r.params.grid.rows>1,o=i;if(r.params.loop)if(r.virtual&&r.params.virtual.enabled)o=o+r.virtual.slidesBefore;else{let a;if(s){let h=o*r.params.grid.rows;a=r.slides.filter(f=>f.getAttribute("data-swiper-slide-index")*1===h)[0].column}else a=r.getSlideIndexByData(o);let l=s?Math.ceil(r.slides.length/r.params.grid.rows):r.slides.length,{centeredSlides:c}=r.params,d=r.params.slidesPerView;d==="auto"?d=r.slidesPerViewDynamic():(d=Math.ceil(parseFloat(r.params.slidesPerView,10)),c&&d%2===0&&(d=d+1));let u=l-a<d;if(c&&(u=u||a<Math.ceil(d/2)),n&&c&&r.params.slidesPerView!=="auto"&&!s&&(u=!1),u){let h=c?a<r.activeIndex?"prev":"next":a-r.activeIndex-1<r.params.slidesPerView?"next":"prev";r.loopFix({direction:h,slideTo:!0,activeSlideIndex:h==="next"?a+1:a-l+1,slideRealIndex:h==="next"?r.realIndex:void 0})}if(s){let h=o*r.params.grid.rows;o=r.slides.filter(f=>f.getAttribute("data-swiper-slide-index")*1===h)[0].column}else o=r.getSlideIndexByData(o)}return requestAnimationFrame(()=>{r.slideTo(o,e,t,n)}),r}function X6(i,e,t){e===void 0&&(e=!0);let n=this,{enabled:r,params:s,animating:o}=n;if(!r||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let a=s.slidesPerGroup;s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(a=Math.max(n.slidesPerViewDynamic("current",!0),1));let l=n.activeIndex<s.slidesPerGroupSkip?1:a,c=n.virtual&&s.virtual.enabled;if(s.loop){if(o&&!c&&s.loopPreventsSliding)return!1;if(n.loopFix({direction:"next"}),n._clientLeft=n.wrapperEl.clientLeft,n.activeIndex===n.slides.length-1&&s.cssMode)return requestAnimationFrame(()=>{n.slideTo(n.activeIndex+l,i,e,t)}),!0}return s.rewind&&n.isEnd?n.slideTo(0,i,e,t):n.slideTo(n.activeIndex+l,i,e,t)}function Y6(i,e,t){e===void 0&&(e=!0);let n=this,{params:r,snapGrid:s,slidesGrid:o,rtlTranslate:a,enabled:l,animating:c}=n;if(!l||n.destroyed)return n;typeof i>"u"&&(i=n.params.speed);let d=n.virtual&&r.virtual.enabled;if(r.loop){if(c&&!d&&r.loopPreventsSliding)return!1;n.loopFix({direction:"prev"}),n._clientLeft=n.wrapperEl.clientLeft}let u=a?n.translate:-n.translate;function h(m){return m<0?-Math.floor(Math.abs(m)):Math.floor(m)}let f=h(u),p=s.map(m=>h(m)),v=s[p.indexOf(f)-1];if(typeof v>"u"&&r.cssMode){let m;s.forEach((y,w)=>{f>=y&&(m=w)}),typeof m<"u"&&(v=s[m>0?m-1:m])}let g=0;if(typeof v<"u"&&(g=o.indexOf(v),g<0&&(g=n.activeIndex-1),r.slidesPerView==="auto"&&r.slidesPerGroup===1&&r.slidesPerGroupAuto&&(g=g-n.slidesPerViewDynamic("previous",!0)+1,g=Math.max(g,0))),r.rewind&&n.isBeginning){let m=n.params.virtual&&n.params.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1;return n.slideTo(m,i,e,t)}else if(r.loop&&n.activeIndex===0&&r.cssMode)return requestAnimationFrame(()=>{n.slideTo(g,i,e,t)}),!0;return n.slideTo(g,i,e,t)}function Q6(i,e,t){e===void 0&&(e=!0);let n=this;if(!n.destroyed)return typeof i>"u"&&(i=n.params.speed),n.slideTo(n.activeIndex,i,e,t)}function K6(i,e,t,n){e===void 0&&(e=!0),n===void 0&&(n=.5);let r=this;if(r.destroyed)return;typeof i>"u"&&(i=r.params.speed);let s=r.activeIndex,o=Math.min(r.params.slidesPerGroupSkip,s),a=o+Math.floor((s-o)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[a]){let c=r.snapGrid[a],d=r.snapGrid[a+1];l-c>(d-c)*n&&(s+=r.params.slidesPerGroup)}else{let c=r.snapGrid[a-1],d=r.snapGrid[a];l-c<=(d-c)*n&&(s-=r.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,r.slidesGrid.length-1),r.slideTo(s,i,e,t)}function J6(){let i=this;if(i.destroyed)return;let{params:e,slidesEl:t}=i,n=e.slidesPerView==="auto"?i.slidesPerViewDynamic():e.slidesPerView,r=i.clickedIndex,s,o=i.isElement?"swiper-slide":`.${e.slideClass}`;if(e.loop){if(i.animating)return;s=parseInt(i.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?r<i.loopedSlides-n/2||r>i.slides.length-i.loopedSlides+n/2?(i.loopFix(),r=i.getSlideIndex(xi(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),yl(()=>{i.slideTo(r)})):i.slideTo(r):r>i.slides.length-n?(i.loopFix(),r=i.getSlideIndex(xi(t,`${o}[data-swiper-slide-index="${s}"]`)[0]),yl(()=>{i.slideTo(r)})):i.slideTo(r)}else i.slideTo(r)}var $6={slideTo:q6,slideToLoop:Z6,slideNext:X6,slidePrev:Y6,slideReset:Q6,slideToClosest:K6,slideToClickedSlide:J6};function eH(i){let e=this,{params:t,slidesEl:n}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;let r=()=>{xi(n,`.${t.slideClass}, swiper-slide`).forEach((u,h)=>{u.setAttribute("data-swiper-slide-index",h)})},s=e.grid&&t.grid&&t.grid.rows>1,o=t.slidesPerGroup*(s?t.grid.rows:1),a=e.slides.length%o!==0,l=s&&e.slides.length%t.grid.rows!==0,c=d=>{for(let u=0;u<d;u+=1){let h=e.isElement?as("swiper-slide",[t.slideBlankClass]):as("div",[t.slideClass,t.slideBlankClass]);e.slidesEl.append(h)}};if(a){if(t.loopAddBlankSlides){let d=o-e.slides.length%o;c(d),e.recalcSlides(),e.updateSlides()}else sh("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(l){if(t.loopAddBlankSlides){let d=t.grid.rows-e.slides.length%t.grid.rows;c(d),e.recalcSlides(),e.updateSlides()}else sh("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();e.loopFix({slideRealIndex:i,direction:t.centeredSlides?void 0:"next"})}function tH(i){let{slideRealIndex:e,slideTo:t=!0,direction:n,setTranslate:r,activeSlideIndex:s,byController:o,byMousewheel:a}=i===void 0?{}:i,l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");let{slides:c,allowSlidePrev:d,allowSlideNext:u,slidesEl:h,params:f}=l,{centeredSlides:p}=f;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&f.virtual.enabled){t&&(!f.centeredSlides&&l.snapIndex===0?l.slideTo(l.virtual.slides.length,0,!1,!0):f.centeredSlides&&l.snapIndex<f.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0)),l.allowSlidePrev=d,l.allowSlideNext=u,l.emit("loopFix");return}let v=f.slidesPerView;v==="auto"?v=l.slidesPerViewDynamic():(v=Math.ceil(parseFloat(f.slidesPerView,10)),p&&v%2===0&&(v=v+1));let g=f.slidesPerGroupAuto?v:f.slidesPerGroup,m=g;m%g!==0&&(m+=g-m%g),m+=f.loopAdditionalSlides,l.loopedSlides=m;let y=l.grid&&f.grid&&f.grid.rows>1;c.length<v+m?sh("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):y&&f.grid.fill==="row"&&sh("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");let w=[],A=[],C=l.activeIndex;typeof s>"u"?s=l.getSlideIndex(c.filter(O=>O.classList.contains(f.slideActiveClass))[0]):C=s;let E=n==="next"||!n,T=n==="prev"||!n,L=0,S=0,_=y?Math.ceil(c.length/f.grid.rows):c.length,U=(y?c[s].column:s)+(p&&typeof r>"u"?-v/2+.5:0);if(U<m){L=Math.max(m-U,g);for(let O=0;O<m-U;O+=1){let z=O-Math.floor(O/_)*_;if(y){let q=_-z-1;for(let Q=c.length-1;Q>=0;Q-=1)c[Q].column===q&&w.push(Q)}else w.push(_-z-1)}}else if(U+v>_-m){S=Math.max(U-(_-m*2),g);for(let O=0;O<S;O+=1){let z=O-Math.floor(O/_)*_;y?c.forEach((q,Q)=>{q.column===z&&A.push(Q)}):A.push(z)}}if(l.__preventObserver__=!0,requestAnimationFrame(()=>{l.__preventObserver__=!1}),T&&w.forEach(O=>{c[O].swiperLoopMoveDOM=!0,h.prepend(c[O]),c[O].swiperLoopMoveDOM=!1}),E&&A.forEach(O=>{c[O].swiperLoopMoveDOM=!0,h.append(c[O]),c[O].swiperLoopMoveDOM=!1}),l.recalcSlides(),f.slidesPerView==="auto"?l.updateSlides():y&&(w.length>0&&T||A.length>0&&E)&&l.slides.forEach((O,z)=>{l.grid.updateSlide(z,O,l.slides)}),f.watchSlidesProgress&&l.updateSlidesOffset(),t){if(w.length>0&&T){if(typeof e>"u"){let O=l.slidesGrid[C],q=l.slidesGrid[C+L]-O;a?l.setTranslate(l.translate-q):(l.slideTo(C+Math.ceil(L),0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-q,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-q))}else if(r){let O=y?w.length/f.grid.rows:w.length;l.slideTo(l.activeIndex+O,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(A.length>0&&E)if(typeof e>"u"){let O=l.slidesGrid[C],q=l.slidesGrid[C-S]-O;a?l.setTranslate(l.translate-q):(l.slideTo(C-S,0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-q,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-q))}else{let O=y?A.length/f.grid.rows:A.length;l.slideTo(l.activeIndex-O,0,!1,!0)}}if(l.allowSlidePrev=d,l.allowSlideNext=u,l.controller&&l.controller.control&&!o){let O={slideRealIndex:e,direction:n,setTranslate:r,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach(z=>{!z.destroyed&&z.params.loop&&z.loopFix(Ge(re({},O),{slideTo:z.params.slidesPerView===f.slidesPerView?t:!1}))}):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix(Ge(re({},O),{slideTo:l.controller.control.params.slidesPerView===f.slidesPerView?t:!1}))}l.emit("loopFix")}function nH(){let i=this,{params:e,slidesEl:t}=i;if(!e.loop||i.virtual&&i.params.virtual.enabled)return;i.recalcSlides();let n=[];i.slides.forEach(r=>{let s=typeof r.swiperSlideIndex>"u"?r.getAttribute("data-swiper-slide-index")*1:r.swiperSlideIndex;n[s]=r}),i.slides.forEach(r=>{r.removeAttribute("data-swiper-slide-index")}),n.forEach(r=>{t.append(r)}),i.recalcSlides(),i.slideTo(i.realIndex,0)}var iH={loopCreate:eH,loopFix:tH,loopDestroy:nH};function rH(i){let e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;let t=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),t.style.cursor="move",t.style.cursor=i?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function sH(){let i=this;i.params.watchOverflow&&i.isLocked||i.params.cssMode||(i.isElement&&(i.__preventObserver__=!0),i[i.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",i.isElement&&requestAnimationFrame(()=>{i.__preventObserver__=!1}))}var oH={setGrabCursor:rH,unsetGrabCursor:sH};function aH(i,e){e===void 0&&(e=this);function t(n){if(!n||n===Oi()||n===Gn())return null;n.assignedSlot&&(n=n.assignedSlot);let r=n.closest(i);return!r&&!n.getRootNode?null:r||t(n.getRootNode().host)}return t(e)}function BP(i,e,t){let n=Gn(),{params:r}=i,s=r.edgeSwipeDetection,o=r.edgeSwipeThreshold;return s&&(t<=o||t>=n.innerWidth-o)?s==="prevent"?(e.preventDefault(),!0):!1:!0}function lH(i){let e=this,t=Oi(),n=i;n.originalEvent&&(n=n.originalEvent);let r=e.touchEventsData;if(n.type==="pointerdown"){if(r.pointerId!==null&&r.pointerId!==n.pointerId)return;r.pointerId=n.pointerId}else n.type==="touchstart"&&n.targetTouches.length===1&&(r.touchId=n.targetTouches[0].identifier);if(n.type==="touchstart"){BP(e,n,n.targetTouches[0].pageX);return}let{params:s,touches:o,enabled:a}=e;if(!a||!s.simulateTouch&&n.pointerType==="mouse"||e.animating&&s.preventInteractionOnTransition)return;!e.animating&&s.cssMode&&s.loop&&e.loopFix();let l=n.target;if(s.touchEventsTarget==="wrapper"&&!kP(l,e.wrapperEl)||"which"in n&&n.which===3||"button"in n&&n.button>0||r.isTouched&&r.isMoved)return;let c=!!s.noSwipingClass&&s.noSwipingClass!=="",d=n.composedPath?n.composedPath():n.path;c&&n.target&&n.target.shadowRoot&&d&&(l=d[0]);let u=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,h=!!(n.target&&n.target.shadowRoot);if(s.noSwiping&&(h?aH(u,l):l.closest(u))){e.allowClick=!0;return}if(s.swipeHandler&&!l.closest(s.swipeHandler))return;o.currentX=n.pageX,o.currentY=n.pageY;let f=o.currentX,p=o.currentY;if(!BP(e,n,f))return;Object.assign(r,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),o.startX=f,o.startY=p,r.touchStartTime=bl(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,s.threshold>0&&(r.allowThresholdMove=!1);let v=!0;l.matches(r.focusableElements)&&(v=!1,l.nodeName==="SELECT"&&(r.isTouched=!1)),t.activeElement&&t.activeElement.matches(r.focusableElements)&&t.activeElement!==l&&(n.pointerType==="mouse"||n.pointerType!=="mouse"&&!l.matches(r.focusableElements))&&t.activeElement.blur();let g=v&&e.allowTouchMove&&s.touchStartPreventDefault;(s.touchStartForcePreventDefault||g)&&!l.isContentEditable&&n.preventDefault(),s.freeMode&&s.freeMode.enabled&&e.freeMode&&e.animating&&!s.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",n)}function cH(i){let e=Oi(),t=this,n=t.touchEventsData,{params:r,touches:s,rtlTranslate:o,enabled:a}=t;if(!a||!r.simulateTouch&&i.pointerType==="mouse")return;let l=i;if(l.originalEvent&&(l=l.originalEvent),l.type==="pointermove"&&(n.touchId!==null||l.pointerId!==n.pointerId))return;let c;if(l.type==="touchmove"){if(c=[...l.changedTouches].filter(E=>E.identifier===n.touchId)[0],!c||c.identifier!==n.touchId)return}else c=l;if(!n.isTouched){n.startMoving&&n.isScrolling&&t.emit("touchMoveOpposite",l);return}let d=c.pageX,u=c.pageY;if(l.preventedByNestedSwiper){s.startX=d,s.startY=u;return}if(!t.allowTouchMove){l.target.matches(n.focusableElements)||(t.allowClick=!1),n.isTouched&&(Object.assign(s,{startX:d,startY:u,currentX:d,currentY:u}),n.touchStartTime=bl());return}if(r.touchReleaseOnEdges&&!r.loop){if(t.isVertical()){if(u<s.startY&&t.translate<=t.maxTranslate()||u>s.startY&&t.translate>=t.minTranslate()){n.isTouched=!1,n.isMoved=!1;return}}else if(d<s.startX&&t.translate<=t.maxTranslate()||d>s.startX&&t.translate>=t.minTranslate())return}if(e.activeElement&&e.activeElement.matches(n.focusableElements)&&e.activeElement!==l.target&&l.pointerType!=="mouse"&&e.activeElement.blur(),e.activeElement&&l.target===e.activeElement&&l.target.matches(n.focusableElements)){n.isMoved=!0,t.allowClick=!1;return}n.allowTouchCallbacks&&t.emit("touchMove",l),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=d,s.currentY=u;let h=s.currentX-s.startX,f=s.currentY-s.startY;if(t.params.threshold&&Math.sqrt(h**2+f**2)<t.params.threshold)return;if(typeof n.isScrolling>"u"){let E;t.isHorizontal()&&s.currentY===s.startY||t.isVertical()&&s.currentX===s.startX?n.isScrolling=!1:h*h+f*f>=25&&(E=Math.atan2(Math.abs(f),Math.abs(h))*180/Math.PI,n.isScrolling=t.isHorizontal()?E>r.touchAngle:90-E>r.touchAngle)}if(n.isScrolling&&t.emit("touchMoveOpposite",l),typeof n.startMoving>"u"&&(s.currentX!==s.startX||s.currentY!==s.startY)&&(n.startMoving=!0),n.isScrolling||l.type==="touchmove"&&n.preventTouchMoveFromPointerMove){n.isTouched=!1;return}if(!n.startMoving)return;t.allowClick=!1,!r.cssMode&&l.cancelable&&l.preventDefault(),r.touchMoveStopPropagation&&!r.nested&&l.stopPropagation();let p=t.isHorizontal()?h:f,v=t.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;r.oneWayMovement&&(p=Math.abs(p)*(o?1:-1),v=Math.abs(v)*(o?1:-1)),s.diff=p,p*=r.touchRatio,o&&(p=-p,v=-v);let g=t.touchesDirection;t.swipeDirection=p>0?"prev":"next",t.touchesDirection=v>0?"prev":"next";let m=t.params.loop&&!r.cssMode,y=t.touchesDirection==="next"&&t.allowSlideNext||t.touchesDirection==="prev"&&t.allowSlidePrev;if(!n.isMoved){if(m&&y&&t.loopFix({direction:t.swipeDirection}),n.startTranslate=t.getTranslate(),t.setTransition(0),t.animating){let E=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});t.wrapperEl.dispatchEvent(E)}n.allowMomentumBounce=!1,r.grabCursor&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!0),t.emit("sliderFirstMove",l)}let w;if(new Date().getTime(),n.isMoved&&n.allowThresholdMove&&g!==t.touchesDirection&&m&&y&&Math.abs(p)>=1){Object.assign(s,{startX:d,startY:u,currentX:d,currentY:u,startTranslate:n.currentTranslate}),n.loopSwapReset=!0,n.startTranslate=n.currentTranslate;return}t.emit("sliderMove",l),n.isMoved=!0,n.currentTranslate=p+n.startTranslate;let A=!0,C=r.resistanceRatio;if(r.touchReleaseOnEdges&&(C=0),p>0?(m&&y&&!w&&n.allowThresholdMove&&n.currentTranslate>(r.centeredSlides?t.minTranslate()-t.slidesSizesGrid[t.activeIndex+1]-(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.activeIndex+1]+t.params.spaceBetween:0)-t.params.spaceBetween:t.minTranslate())&&t.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),n.currentTranslate>t.minTranslate()&&(A=!1,r.resistance&&(n.currentTranslate=t.minTranslate()-1+(-t.minTranslate()+n.startTranslate+p)**C))):p<0&&(m&&y&&!w&&n.allowThresholdMove&&n.currentTranslate<(r.centeredSlides?t.maxTranslate()+t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween+(r.slidesPerView!=="auto"&&t.slides.length-r.slidesPerView>=2?t.slidesSizesGrid[t.slidesSizesGrid.length-1]+t.params.spaceBetween:0):t.maxTranslate())&&t.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:t.slides.length-(r.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(parseFloat(r.slidesPerView,10)))}),n.currentTranslate<t.maxTranslate()&&(A=!1,r.resistance&&(n.currentTranslate=t.maxTranslate()+1-(t.maxTranslate()-n.startTranslate-p)**C))),A&&(l.preventedByNestedSwiper=!0),!t.allowSlideNext&&t.swipeDirection==="next"&&n.currentTranslate<n.startTranslate&&(n.currentTranslate=n.startTranslate),!t.allowSlidePrev&&t.swipeDirection==="prev"&&n.currentTranslate>n.startTranslate&&(n.currentTranslate=n.startTranslate),!t.allowSlidePrev&&!t.allowSlideNext&&(n.currentTranslate=n.startTranslate),r.threshold>0)if(Math.abs(p)>r.threshold||n.allowThresholdMove){if(!n.allowThresholdMove){n.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,n.currentTranslate=n.startTranslate,s.diff=t.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY;return}}else{n.currentTranslate=n.startTranslate;return}!r.followFinger||r.cssMode||((r.freeMode&&r.freeMode.enabled&&t.freeMode||r.watchSlidesProgress)&&(t.updateActiveIndex(),t.updateSlidesClasses()),r.freeMode&&r.freeMode.enabled&&t.freeMode&&t.freeMode.onTouchMove(),t.updateProgress(n.currentTranslate),t.setTranslate(n.currentTranslate))}function dH(i){let e=this,t=e.touchEventsData,n=i;n.originalEvent&&(n=n.originalEvent);let r;if(n.type==="touchend"||n.type==="touchcancel"){if(r=[...n.changedTouches].filter(C=>C.identifier===t.touchId)[0],!r||r.identifier!==t.touchId)return}else{if(t.touchId!==null||n.pointerId!==t.pointerId)return;r=n}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(n.type)&&!(["pointercancel","contextmenu"].includes(n.type)&&(e.browser.isSafari||e.browser.isWebView)))return;t.pointerId=null,t.touchId=null;let{params:o,touches:a,rtlTranslate:l,slidesGrid:c,enabled:d}=e;if(!d||!o.simulateTouch&&n.pointerType==="mouse")return;if(t.allowTouchCallbacks&&e.emit("touchEnd",n),t.allowTouchCallbacks=!1,!t.isTouched){t.isMoved&&o.grabCursor&&e.setGrabCursor(!1),t.isMoved=!1,t.startMoving=!1;return}o.grabCursor&&t.isMoved&&t.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);let u=bl(),h=u-t.touchStartTime;if(e.allowClick){let C=n.path||n.composedPath&&n.composedPath();e.updateClickedSlide(C&&C[0]||n.target,C),e.emit("tap click",n),h<300&&u-t.lastClickTime<300&&e.emit("doubleTap doubleClick",n)}if(t.lastClickTime=bl(),yl(()=>{e.destroyed||(e.allowClick=!0)}),!t.isTouched||!t.isMoved||!e.swipeDirection||a.diff===0&&!t.loopSwapReset||t.currentTranslate===t.startTranslate&&!t.loopSwapReset){t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;return}t.isTouched=!1,t.isMoved=!1,t.startMoving=!1;let f;if(o.followFinger?f=l?e.translate:-e.translate:f=-t.currentTranslate,o.cssMode)return;if(o.freeMode&&o.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:f});return}let p=f>=-e.maxTranslate()&&!e.params.loop,v=0,g=e.slidesSizesGrid[0];for(let C=0;C<c.length;C+=C<o.slidesPerGroupSkip?1:o.slidesPerGroup){let E=C<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;typeof c[C+E]<"u"?(p||f>=c[C]&&f<c[C+E])&&(v=C,g=c[C+E]-c[C]):(p||f>=c[C])&&(v=C,g=c[c.length-1]-c[c.length-2])}let m=null,y=null;o.rewind&&(e.isBeginning?y=o.virtual&&o.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(m=0));let w=(f-c[v])/g,A=v<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;if(h>o.longSwipesMs){if(!o.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(w>=o.longSwipesRatio?e.slideTo(o.rewind&&e.isEnd?m:v+A):e.slideTo(v)),e.swipeDirection==="prev"&&(w>1-o.longSwipesRatio?e.slideTo(v+A):y!==null&&w<0&&Math.abs(w)>o.longSwipesRatio?e.slideTo(y):e.slideTo(v))}else{if(!o.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(n.target===e.navigation.nextEl||n.target===e.navigation.prevEl)?n.target===e.navigation.nextEl?e.slideTo(v+A):e.slideTo(v):(e.swipeDirection==="next"&&e.slideTo(m!==null?m:v+A),e.swipeDirection==="prev"&&e.slideTo(y!==null?y:v))}}function VP(){let i=this,{params:e,el:t}=i;if(t&&t.offsetWidth===0)return;e.breakpoints&&i.setBreakpoint();let{allowSlideNext:n,allowSlidePrev:r,snapGrid:s}=i,o=i.virtual&&i.params.virtual.enabled;i.allowSlideNext=!0,i.allowSlidePrev=!0,i.updateSize(),i.updateSlides(),i.updateSlidesClasses();let a=o&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&i.isEnd&&!i.isBeginning&&!i.params.centeredSlides&&!a?i.slideTo(i.slides.length-1,0,!1,!0):i.params.loop&&!o?i.slideToLoop(i.realIndex,0,!1,!0):i.slideTo(i.activeIndex,0,!1,!0),i.autoplay&&i.autoplay.running&&i.autoplay.paused&&(clearTimeout(i.autoplay.resizeTimeout),i.autoplay.resizeTimeout=setTimeout(()=>{i.autoplay&&i.autoplay.running&&i.autoplay.paused&&i.autoplay.resume()},500)),i.allowSlidePrev=r,i.allowSlideNext=n,i.params.watchOverflow&&s!==i.snapGrid&&i.checkOverflow()}function uH(i){let e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&i.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(i.stopPropagation(),i.stopImmediatePropagation())))}function hH(){let i=this,{wrapperEl:e,rtlTranslate:t,enabled:n}=i;if(!n)return;i.previousTranslate=i.translate,i.isHorizontal()?i.translate=-e.scrollLeft:i.translate=-e.scrollTop,i.translate===0&&(i.translate=0),i.updateActiveIndex(),i.updateSlidesClasses();let r,s=i.maxTranslate()-i.minTranslate();s===0?r=0:r=(i.translate-i.minTranslate())/s,r!==i.progress&&i.updateProgress(t?-i.translate:i.translate),i.emit("setTranslate",i.translate,!1)}function fH(i){let e=this;Jm(e,i.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function pH(){let i=this;i.documentTouchHandlerProceeded||(i.documentTouchHandlerProceeded=!0,i.params.touchReleaseOnEdges&&(i.el.style.touchAction="auto"))}var WP=(i,e)=>{let t=Oi(),{params:n,el:r,wrapperEl:s,device:o}=i,a=!!n.nested,l=e==="on"?"addEventListener":"removeEventListener",c=e;!r||typeof r=="string"||(t[l]("touchstart",i.onDocumentTouchStart,{passive:!1,capture:a}),r[l]("touchstart",i.onTouchStart,{passive:!1}),r[l]("pointerdown",i.onTouchStart,{passive:!1}),t[l]("touchmove",i.onTouchMove,{passive:!1,capture:a}),t[l]("pointermove",i.onTouchMove,{passive:!1,capture:a}),t[l]("touchend",i.onTouchEnd,{passive:!0}),t[l]("pointerup",i.onTouchEnd,{passive:!0}),t[l]("pointercancel",i.onTouchEnd,{passive:!0}),t[l]("touchcancel",i.onTouchEnd,{passive:!0}),t[l]("pointerout",i.onTouchEnd,{passive:!0}),t[l]("pointerleave",i.onTouchEnd,{passive:!0}),t[l]("contextmenu",i.onTouchEnd,{passive:!0}),(n.preventClicks||n.preventClicksPropagation)&&r[l]("click",i.onClick,!0),n.cssMode&&s[l]("scroll",i.onScroll),n.updateOnWindowResize?i[c](o.ios||o.android?"resize orientationchange observerUpdate":"resize observerUpdate",VP,!0):i[c]("observerUpdate",VP,!0),r[l]("load",i.onLoad,{capture:!0}))};function mH(){let i=this,{params:e}=i;i.onTouchStart=lH.bind(i),i.onTouchMove=cH.bind(i),i.onTouchEnd=dH.bind(i),i.onDocumentTouchStart=pH.bind(i),e.cssMode&&(i.onScroll=hH.bind(i)),i.onClick=uH.bind(i),i.onLoad=fH.bind(i),WP(i,"on")}function gH(){WP(this,"off")}var vH={attachEvents:mH,detachEvents:gH},UP=(i,e)=>i.grid&&e.grid&&e.grid.rows>1;function xH(){let i=this,{realIndex:e,initialized:t,params:n,el:r}=i,s=n.breakpoints;if(!s||s&&Object.keys(s).length===0)return;let o=i.getBreakpoint(s,i.params.breakpointsBase,i.el);if(!o||i.currentBreakpoint===o)return;let l=(o in s?s[o]:void 0)||i.originalParams,c=UP(i,n),d=UP(i,l),u=i.params.grabCursor,h=l.grabCursor,f=n.enabled;c&&!d?(r.classList.remove(`${n.containerModifierClass}grid`,`${n.containerModifierClass}grid-column`),i.emitContainerClasses()):!c&&d&&(r.classList.add(`${n.containerModifierClass}grid`),(l.grid.fill&&l.grid.fill==="column"||!l.grid.fill&&n.grid.fill==="column")&&r.classList.add(`${n.containerModifierClass}grid-column`),i.emitContainerClasses()),u&&!h?i.unsetGrabCursor():!u&&h&&i.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(w=>{if(typeof l[w]>"u")return;let A=n[w]&&n[w].enabled,C=l[w]&&l[w].enabled;A&&!C&&i[w].disable(),!A&&C&&i[w].enable()});let p=l.direction&&l.direction!==n.direction,v=n.loop&&(l.slidesPerView!==n.slidesPerView||p),g=n.loop;p&&t&&i.changeDirection(),Yi(i.params,l);let m=i.params.enabled,y=i.params.loop;Object.assign(i,{allowTouchMove:i.params.allowTouchMove,allowSlideNext:i.params.allowSlideNext,allowSlidePrev:i.params.allowSlidePrev}),f&&!m?i.disable():!f&&m&&i.enable(),i.currentBreakpoint=o,i.emit("_beforeBreakpoint",l),t&&(v?(i.loopDestroy(),i.loopCreate(e),i.updateSlides()):!g&&y?(i.loopCreate(e),i.updateSlides()):g&&!y&&i.loopDestroy()),i.emit("breakpoint",l)}function wH(i,e,t){if(e===void 0&&(e="window"),!i||e==="container"&&!t)return;let n=!1,r=Gn(),s=e==="window"?r.innerHeight:t.clientHeight,o=Object.keys(i).map(a=>{if(typeof a=="string"&&a.indexOf("@")===0){let l=parseFloat(a.substr(1));return{value:s*l,point:a}}return{value:a,point:a}});o.sort((a,l)=>parseInt(a.value,10)-parseInt(l.value,10));for(let a=0;a<o.length;a+=1){let{point:l,value:c}=o[a];e==="window"?r.matchMedia(`(min-width: ${c}px)`).matches&&(n=l):c<=t.clientWidth&&(n=l)}return n||"max"}var yH={setBreakpoint:xH,getBreakpoint:wH};function bH(i,e){let t=[];return i.forEach(n=>{typeof n=="object"?Object.keys(n).forEach(r=>{n[r]&&t.push(e+r)}):typeof n=="string"&&t.push(e+n)}),t}function AH(){let i=this,{classNames:e,params:t,rtl:n,el:r,device:s}=i,o=bH(["initialized",t.direction,{"free-mode":i.params.freeMode&&t.freeMode.enabled},{autoheight:t.autoHeight},{rtl:n},{grid:t.grid&&t.grid.rows>1},{"grid-column":t.grid&&t.grid.rows>1&&t.grid.fill==="column"},{android:s.android},{ios:s.ios},{"css-mode":t.cssMode},{centered:t.cssMode&&t.centeredSlides},{"watch-progress":t.watchSlidesProgress}],t.containerModifierClass);e.push(...o),r.classList.add(...e),i.emitContainerClasses()}function _H(){let i=this,{el:e,classNames:t}=i;!e||typeof e=="string"||(e.classList.remove(...t),i.emitContainerClasses())}var SH={addClasses:AH,removeClasses:_H};function EH(){let i=this,{isLocked:e,params:t}=i,{slidesOffsetBefore:n}=t;if(n){let r=i.slides.length-1,s=i.slidesGrid[r]+i.slidesSizesGrid[r]+n*2;i.isLocked=i.size>s}else i.isLocked=i.snapGrid.length===1;t.allowSlideNext===!0&&(i.allowSlideNext=!i.isLocked),t.allowSlidePrev===!0&&(i.allowSlidePrev=!i.isLocked),e&&e!==i.isLocked&&(i.isEnd=!1),e!==i.isLocked&&i.emit(i.isLocked?"lock":"unlock")}var CH={checkOverflow:EH},HP={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function MH(i,e){return function(n){n===void 0&&(n={});let r=Object.keys(n)[0],s=n[r];if(typeof s!="object"||s===null){Yi(e,n);return}if(i[r]===!0&&(i[r]={enabled:!0}),r==="navigation"&&i[r]&&i[r].enabled&&!i[r].prevEl&&!i[r].nextEl&&(i[r].auto=!0),["pagination","scrollbar"].indexOf(r)>=0&&i[r]&&i[r].enabled&&!i[r].el&&(i[r].auto=!0),!(r in i&&"enabled"in s)){Yi(e,n);return}typeof i[r]=="object"&&!("enabled"in i[r])&&(i[r].enabled=!0),i[r]||(i[r]={enabled:!1}),Yi(e,n)}}var oA={eventsEmitter:S6,update:N6,translate:H6,transition:W6,slide:$6,loop:iH,grabCursor:oH,events:vH,breakpoints:yH,checkOverflow:CH,classes:SH},aA={},ls=class i{constructor(){let e,t;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];r.length===1&&r[0].constructor&&Object.prototype.toString.call(r[0]).slice(8,-1)==="Object"?t=r[0]:[e,t]=r,t||(t={}),t=Yi({},t),e&&!t.el&&(t.el=e);let o=Oi();if(t.el&&typeof t.el=="string"&&o.querySelectorAll(t.el).length>1){let d=[];return o.querySelectorAll(t.el).forEach(u=>{let h=Yi({},t,{el:u});d.push(new i(h))}),d}let a=this;a.__swiper__=!0,a.support=zP(),a.device=jP({userAgent:t.userAgent}),a.browser=b6(),a.eventsListeners={},a.eventsAnyListeners=[],a.modules=[...a.__modules__],t.modules&&Array.isArray(t.modules)&&a.modules.push(...t.modules);let l={};a.modules.forEach(d=>{d({params:t,swiper:a,extendParams:MH(t,l),on:a.on.bind(a),once:a.once.bind(a),off:a.off.bind(a),emit:a.emit.bind(a)})});let c=Yi({},HP,l);return a.params=Yi({},c,aA,t),a.originalParams=Yi({},a.params),a.passedParams=Yi({},t),a.params&&a.params.on&&Object.keys(a.params.on).forEach(d=>{a.on(d,a.params.on[d])}),a.params&&a.params.onAny&&a.onAny(a.params.onAny),Object.assign(a,{enabled:a.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return a.params.direction==="horizontal"},isVertical(){return a.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:a.params.allowSlideNext,allowSlidePrev:a.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:a.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:a.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),a.emit("_swiper"),a.params.init&&a.init(),a}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){let{slidesEl:t,params:n}=this,r=xi(t,`.${n.slideClass}, swiper-slide`),s=Al(r[0]);return Al(e)-s}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter(t=>t.getAttribute("data-swiper-slide-index")*1===e)[0])}recalcSlides(){let e=this,{slidesEl:t,params:n}=e;e.slides=xi(t,`.${n.slideClass}, swiper-slide`)}enable(){let e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){let e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){let n=this;e=Math.min(Math.max(e,0),1);let r=n.minTranslate(),o=(n.maxTranslate()-r)*e+r;n.translateTo(o,typeof t>"u"?0:t),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=e.el.className.split(" ").filter(n=>n.indexOf("swiper")===0||n.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){let t=this;return t.destroyed?"":e.className.split(" ").filter(n=>n.indexOf("swiper-slide")===0||n.indexOf(t.params.slideClass)===0).join(" ")}emitSlidesClasses(){let e=this;if(!e.params._emitClasses||!e.el)return;let t=[];e.slides.forEach(n=>{let r=e.getSlideClasses(n);t.push({slideEl:n,classNames:r}),e.emit("_slideClass",n,r)}),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){e===void 0&&(e="current"),t===void 0&&(t=!1);let n=this,{params:r,slides:s,slidesGrid:o,slidesSizesGrid:a,size:l,activeIndex:c}=n,d=1;if(typeof r.slidesPerView=="number")return r.slidesPerView;if(r.centeredSlides){let u=s[c]?Math.ceil(s[c].swiperSlideSize):0,h;for(let f=c+1;f<s.length;f+=1)s[f]&&!h&&(u+=Math.ceil(s[f].swiperSlideSize),d+=1,u>l&&(h=!0));for(let f=c-1;f>=0;f-=1)s[f]&&!h&&(u+=s[f].swiperSlideSize,d+=1,u>l&&(h=!0))}else if(e==="current")for(let u=c+1;u<s.length;u+=1)(t?o[u]+a[u]-o[c]<l:o[u]-o[c]<l)&&(d+=1);else for(let u=c-1;u>=0;u-=1)o[c]-o[u]<l&&(d+=1);return d}update(){let e=this;if(!e||e.destroyed)return;let{snapGrid:t,params:n}=e;n.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(o=>{o.complete&&Jm(e,o)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function r(){let o=e.rtlTranslate?e.translate*-1:e.translate,a=Math.min(Math.max(o,e.maxTranslate()),e.minTranslate());e.setTranslate(a),e.updateActiveIndex(),e.updateSlidesClasses()}let s;if(n.freeMode&&n.freeMode.enabled&&!n.cssMode)r(),n.autoHeight&&e.updateAutoHeight();else{if((n.slidesPerView==="auto"||n.slidesPerView>1)&&e.isEnd&&!n.centeredSlides){let o=e.virtual&&n.virtual.enabled?e.virtual.slides:e.slides;s=e.slideTo(o.length-1,0,!1,!0)}else s=e.slideTo(e.activeIndex,0,!1,!0);s||r()}n.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){t===void 0&&(t=!0);let n=this,r=n.params.direction;return e||(e=r==="horizontal"?"vertical":"horizontal"),e===r||e!=="horizontal"&&e!=="vertical"||(n.el.classList.remove(`${n.params.containerModifierClass}${r}`),n.el.classList.add(`${n.params.containerModifierClass}${e}`),n.emitContainerClasses(),n.params.direction=e,n.slides.forEach(s=>{e==="vertical"?s.style.width="":s.style.height=""}),n.emit("changeDirection"),t&&n.update()),n}changeLanguageDirection(e){let t=this;t.rtl&&e==="rtl"||!t.rtl&&e==="ltr"||(t.rtl=e==="rtl",t.rtlTranslate=t.params.direction==="horizontal"&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){let t=this;if(t.mounted)return!0;let n=e||t.params.el;if(typeof n=="string"&&(n=document.querySelector(n)),!n)return!1;n.swiper=t,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);let r=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`,o=n&&n.shadowRoot&&n.shadowRoot.querySelector?n.shadowRoot.querySelector(r()):xi(n,r())[0];return!o&&t.params.createElements&&(o=as("div",t.params.wrapperClass),n.append(o),xi(n,`.${t.params.slideClass}`).forEach(a=>{o.append(a)})),Object.assign(t,{el:n,wrapperEl:o,slidesEl:t.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:o,hostEl:t.isElement?n.parentNode.host:n,mounted:!0,rtl:n.dir.toLowerCase()==="rtl"||po(n,"direction")==="rtl",rtlTranslate:t.params.direction==="horizontal"&&(n.dir.toLowerCase()==="rtl"||po(n,"direction")==="rtl"),wrongRTL:po(o,"display")==="-webkit-box"}),!0}init(e){let t=this;if(t.initialized||t.mount(e)===!1)return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();let r=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&r.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),r.forEach(s=>{s.complete?Jm(t,s):s.addEventListener("load",o=>{Jm(t,o.target)})}),lA(t),t.initialized=!0,lA(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);let n=this,{params:r,el:s,wrapperEl:o,slides:a}=n;return typeof n.params>"u"||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),r.loop&&n.loopDestroy(),t&&(n.removeClasses(),s&&typeof s!="string"&&s.removeAttribute("style"),o&&o.removeAttribute("style"),a&&a.length&&a.forEach(l=>{l.classList.remove(r.slideVisibleClass,r.slideFullyVisibleClass,r.slideActiveClass,r.slideNextClass,r.slidePrevClass),l.removeAttribute("style"),l.removeAttribute("data-swiper-slide-index")})),n.emit("destroy"),Object.keys(n.eventsListeners).forEach(l=>{n.off(l)}),e!==!1&&(n.el&&typeof n.el!="string"&&(n.el.swiper=null),LP(n)),n.destroyed=!0),null}static extendDefaults(e){Yi(aA,e)}static get extendedDefaults(){return aA}static get defaults(){return HP}static installModule(e){i.prototype.__modules__||(i.prototype.__modules__=[]);let t=i.prototype.__modules__;typeof e=="function"&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach(t=>i.installModule(t)),i):(i.installModule(e),i)}};Object.keys(oA).forEach(i=>{Object.keys(oA[i]).forEach(e=>{ls.prototype[e]=oA[i][e]})});ls.use([A6,_6]);function ah(i,e,t,n){return i.params.createElements&&Object.keys(n).forEach(r=>{if(!t[r]&&t.auto===!0){let s=xi(i.el,`.${n[r]}`)[0];s||(s=as("div",n[r]),s.className=n[r],i.el.append(s)),t[r]=s,e[r]=s}}),t}function cA(i){let{swiper:e,extendParams:t,on:n,emit:r}=i;t({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};function s(p){let v;return p&&typeof p=="string"&&e.isElement&&(v=e.el.querySelector(p)||e.hostEl.querySelector(p),v)?v:(p&&(typeof p=="string"&&(v=[...document.querySelectorAll(p)]),e.params.uniqueNavElements&&typeof p=="string"&&v&&v.length>1&&e.el.querySelectorAll(p).length===1?v=e.el.querySelector(p):v&&v.length===1&&(v=v[0])),p&&!v?p:v)}function o(p,v){let g=e.params.navigation;p=Pn(p),p.forEach(m=>{m&&(m.classList[v?"add":"remove"](...g.disabledClass.split(" ")),m.tagName==="BUTTON"&&(m.disabled=v),e.params.watchOverflow&&e.enabled&&m.classList[e.isLocked?"add":"remove"](g.lockClass))})}function a(){let{nextEl:p,prevEl:v}=e.navigation;if(e.params.loop){o(v,!1),o(p,!1);return}o(v,e.isBeginning&&!e.params.rewind),o(p,e.isEnd&&!e.params.rewind)}function l(p){p.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),r("navigationPrev"))}function c(p){p.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),r("navigationNext"))}function d(){let p=e.params.navigation;if(e.params.navigation=ah(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(p.nextEl||p.prevEl))return;let v=s(p.nextEl),g=s(p.prevEl);Object.assign(e.navigation,{nextEl:v,prevEl:g}),v=Pn(v),g=Pn(g);let m=(y,w)=>{y&&y.addEventListener("click",w==="next"?c:l),!e.enabled&&y&&y.classList.add(...p.lockClass.split(" "))};v.forEach(y=>m(y,"next")),g.forEach(y=>m(y,"prev"))}function u(){let{nextEl:p,prevEl:v}=e.navigation;p=Pn(p),v=Pn(v);let g=(m,y)=>{m.removeEventListener("click",y==="next"?c:l),m.classList.remove(...e.params.navigation.disabledClass.split(" "))};p.forEach(m=>g(m,"next")),v.forEach(m=>g(m,"prev"))}n("init",()=>{e.params.navigation.enabled===!1?f():(d(),a())}),n("toEdge fromEdge lock unlock",()=>{a()}),n("destroy",()=>{u()}),n("enable disable",()=>{let{nextEl:p,prevEl:v}=e.navigation;if(p=Pn(p),v=Pn(v),e.enabled){a();return}[...p,...v].filter(g=>!!g).forEach(g=>g.classList.add(e.params.navigation.lockClass))}),n("click",(p,v)=>{let{nextEl:g,prevEl:m}=e.navigation;g=Pn(g),m=Pn(m);let y=v.target,w=m.includes(y)||g.includes(y);if(e.isElement&&!w){let A=v.path||v.composedPath&&v.composedPath();A&&(w=A.find(C=>g.includes(C)||m.includes(C)))}if(e.params.navigation.hideOnClick&&!w){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===y||e.pagination.el.contains(y)))return;let A;g.length?A=g[0].classList.contains(e.params.navigation.hiddenClass):m.length&&(A=m[0].classList.contains(e.params.navigation.hiddenClass)),r(A===!0?"navigationShow":"navigationHide"),[...g,...m].filter(C=>!!C).forEach(C=>C.classList.toggle(e.params.navigation.hiddenClass))}});let h=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),d(),a()},f=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),u()};Object.assign(e.navigation,{enable:h,disable:f,update:a,init:d,destroy:u})}function wa(i){return i===void 0&&(i=""),`.${i.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function dA(i){let{swiper:e,extendParams:t,on:n,emit:r}=i,s="swiper-pagination";t({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:y=>y,formatFractionTotal:y=>y,bulletClass:`${s}-bullet`,bulletActiveClass:`${s}-bullet-active`,modifierClass:`${s}-`,currentClass:`${s}-current`,totalClass:`${s}-total`,hiddenClass:`${s}-hidden`,progressbarFillClass:`${s}-progressbar-fill`,progressbarOppositeClass:`${s}-progressbar-opposite`,clickableClass:`${s}-clickable`,lockClass:`${s}-lock`,horizontalClass:`${s}-horizontal`,verticalClass:`${s}-vertical`,paginationDisabledClass:`${s}-disabled`}}),e.pagination={el:null,bullets:[]};let o,a=0;function l(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function c(y,w){let{bulletActiveClass:A}=e.params.pagination;y&&(y=y[`${w==="prev"?"previous":"next"}ElementSibling`],y&&(y.classList.add(`${A}-${w}`),y=y[`${w==="prev"?"previous":"next"}ElementSibling`],y&&y.classList.add(`${A}-${w}-${w}`)))}function d(y,w,A){if(y=y%A,w=w%A,w===y+1)return"next";if(w===y-1)return"previous"}function u(y){let w=y.target.closest(wa(e.params.pagination.bulletClass));if(!w)return;y.preventDefault();let A=Al(w)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===A)return;let C=d(e.realIndex,A,e.slides.length);C==="next"?e.slideNext():C==="previous"?e.slidePrev():e.slideToLoop(A)}else e.slideTo(A)}function h(){let y=e.rtl,w=e.params.pagination;if(l())return;let A=e.pagination.el;A=Pn(A);let C,E,T=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,L=e.params.loop?Math.ceil(T/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(E=e.previousRealIndex||0,C=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(C=e.snapIndex,E=e.previousSnapIndex):(E=e.previousIndex||0,C=e.activeIndex||0),w.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){let S=e.pagination.bullets,_,P,U;if(w.dynamicBullets&&(o=oh(S[0],e.isHorizontal()?"width":"height",!0),A.forEach(O=>{O.style[e.isHorizontal()?"width":"height"]=`${o*(w.dynamicMainBullets+4)}px`}),w.dynamicMainBullets>1&&E!==void 0&&(a+=C-(E||0),a>w.dynamicMainBullets-1?a=w.dynamicMainBullets-1:a<0&&(a=0)),_=Math.max(C-a,0),P=_+(Math.min(S.length,w.dynamicMainBullets)-1),U=(P+_)/2),S.forEach(O=>{let z=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(q=>`${w.bulletActiveClass}${q}`)].map(q=>typeof q=="string"&&q.includes(" ")?q.split(" "):q).flat();O.classList.remove(...z)}),A.length>1)S.forEach(O=>{let z=Al(O);z===C?O.classList.add(...w.bulletActiveClass.split(" ")):e.isElement&&O.setAttribute("part","bullet"),w.dynamicBullets&&(z>=_&&z<=P&&O.classList.add(...`${w.bulletActiveClass}-main`.split(" ")),z===_&&c(O,"prev"),z===P&&c(O,"next"))});else{let O=S[C];if(O&&O.classList.add(...w.bulletActiveClass.split(" ")),e.isElement&&S.forEach((z,q)=>{z.setAttribute("part",q===C?"bullet-active":"bullet")}),w.dynamicBullets){let z=S[_],q=S[P];for(let Q=_;Q<=P;Q+=1)S[Q]&&S[Q].classList.add(...`${w.bulletActiveClass}-main`.split(" "));c(z,"prev"),c(q,"next")}}if(w.dynamicBullets){let O=Math.min(S.length,w.dynamicMainBullets+4),z=(o*O-o)/2-U*o,q=y?"right":"left";S.forEach(Q=>{Q.style[e.isHorizontal()?q:"top"]=`${z}px`})}}A.forEach((S,_)=>{if(w.type==="fraction"&&(S.querySelectorAll(wa(w.currentClass)).forEach(P=>{P.textContent=w.formatFractionCurrent(C+1)}),S.querySelectorAll(wa(w.totalClass)).forEach(P=>{P.textContent=w.formatFractionTotal(L)})),w.type==="progressbar"){let P;w.progressbarOpposite?P=e.isHorizontal()?"vertical":"horizontal":P=e.isHorizontal()?"horizontal":"vertical";let U=(C+1)/L,O=1,z=1;P==="horizontal"?O=U:z=U,S.querySelectorAll(wa(w.progressbarFillClass)).forEach(q=>{q.style.transform=`translate3d(0,0,0) scaleX(${O}) scaleY(${z})`,q.style.transitionDuration=`${e.params.speed}ms`})}w.type==="custom"&&w.renderCustom?(S.innerHTML=w.renderCustom(e,C+1,L),_===0&&r("paginationRender",S)):(_===0&&r("paginationRender",S),r("paginationUpdate",S)),e.params.watchOverflow&&e.enabled&&S.classList[e.isLocked?"add":"remove"](w.lockClass)})}function f(){let y=e.params.pagination;if(l())return;let w=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length,A=e.pagination.el;A=Pn(A);let C="";if(y.type==="bullets"){let E=e.params.loop?Math.ceil(w/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&E>w&&(E=w);for(let T=0;T<E;T+=1)y.renderBullet?C+=y.renderBullet.call(e,T,y.bulletClass):C+=`<${y.bulletElement} ${e.isElement?'part="bullet"':""} class="${y.bulletClass}"></${y.bulletElement}>`}y.type==="fraction"&&(y.renderFraction?C=y.renderFraction.call(e,y.currentClass,y.totalClass):C=`<span class="${y.currentClass}"></span> / <span class="${y.totalClass}"></span>`),y.type==="progressbar"&&(y.renderProgressbar?C=y.renderProgressbar.call(e,y.progressbarFillClass):C=`<span class="${y.progressbarFillClass}"></span>`),e.pagination.bullets=[],A.forEach(E=>{y.type!=="custom"&&(E.innerHTML=C||""),y.type==="bullets"&&e.pagination.bullets.push(...E.querySelectorAll(wa(y.bulletClass)))}),y.type!=="custom"&&r("paginationRender",A[0])}function p(){e.params.pagination=ah(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});let y=e.params.pagination;if(!y.el)return;let w;typeof y.el=="string"&&e.isElement&&(w=e.el.querySelector(y.el)),!w&&typeof y.el=="string"&&(w=[...document.querySelectorAll(y.el)]),w||(w=y.el),!(!w||w.length===0)&&(e.params.uniqueNavElements&&typeof y.el=="string"&&Array.isArray(w)&&w.length>1&&(w=[...e.el.querySelectorAll(y.el)],w.length>1&&(w=w.filter(A=>Xc(A,".swiper")[0]===e.el)[0])),Array.isArray(w)&&w.length===1&&(w=w[0]),Object.assign(e.pagination,{el:w}),w=Pn(w),w.forEach(A=>{y.type==="bullets"&&y.clickable&&A.classList.add(...(y.clickableClass||"").split(" ")),A.classList.add(y.modifierClass+y.type),A.classList.add(e.isHorizontal()?y.horizontalClass:y.verticalClass),y.type==="bullets"&&y.dynamicBullets&&(A.classList.add(`${y.modifierClass}${y.type}-dynamic`),a=0,y.dynamicMainBullets<1&&(y.dynamicMainBullets=1)),y.type==="progressbar"&&y.progressbarOpposite&&A.classList.add(y.progressbarOppositeClass),y.clickable&&A.addEventListener("click",u),e.enabled||A.classList.add(y.lockClass)}))}function v(){let y=e.params.pagination;if(l())return;let w=e.pagination.el;w&&(w=Pn(w),w.forEach(A=>{A.classList.remove(y.hiddenClass),A.classList.remove(y.modifierClass+y.type),A.classList.remove(e.isHorizontal()?y.horizontalClass:y.verticalClass),y.clickable&&(A.classList.remove(...(y.clickableClass||"").split(" ")),A.removeEventListener("click",u))})),e.pagination.bullets&&e.pagination.bullets.forEach(A=>A.classList.remove(...y.bulletActiveClass.split(" ")))}n("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;let y=e.params.pagination,{el:w}=e.pagination;w=Pn(w),w.forEach(A=>{A.classList.remove(y.horizontalClass,y.verticalClass),A.classList.add(e.isHorizontal()?y.horizontalClass:y.verticalClass)})}),n("init",()=>{e.params.pagination.enabled===!1?m():(p(),f(),h())}),n("activeIndexChange",()=>{typeof e.snapIndex>"u"&&h()}),n("snapIndexChange",()=>{h()}),n("snapGridLengthChange",()=>{f(),h()}),n("destroy",()=>{v()}),n("enable disable",()=>{let{el:y}=e.pagination;y&&(y=Pn(y),y.forEach(w=>w.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),n("lock unlock",()=>{h()}),n("click",(y,w)=>{let A=w.target,C=Pn(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&C&&C.length>0&&!A.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&A===e.navigation.nextEl||e.navigation.prevEl&&A===e.navigation.prevEl))return;let E=C[0].classList.contains(e.params.pagination.hiddenClass);r(E===!0?"paginationShow":"paginationHide"),C.forEach(T=>T.classList.toggle(e.params.pagination.hiddenClass))}});let g=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:y}=e.pagination;y&&(y=Pn(y),y.forEach(w=>w.classList.remove(e.params.pagination.paginationDisabledClass))),p(),f(),h()},m=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:y}=e.pagination;y&&(y=Pn(y),y.forEach(w=>w.classList.add(e.params.pagination.paginationDisabledClass))),v()};Object.assign(e.pagination,{enable:g,disable:m,render:f,update:h,init:p,destroy:v})}var di=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files/";getKioskMap(e){let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-kiosk-map.php`,t)}getEvents(){return this.http.get(this.apiUrl+"/fetch-events.php")}getKiosk(){return this.http.get(`${this.apiUrl}/fetch-kiosk.php`)}downloadForm(e,t,n){let r=`${this.apiUrl}create-form.php`,s={formId:e,firstName:t,lastName:n};this.http.post(r,s,{responseType:"blob"}).subscribe(o=>{let a=new Blob([o],{type:"application/pdf"}),l=window.URL.createObjectURL(a),c=document.createElement("a");c.href=l,c.download=`${t}_${n}_application_form.pdf`,c.click(),window.URL.revokeObjectURL(l)},o=>{console.error("Error downloading the form:",o),alert("Failed to download the form. Please try again later.")})}static \u0275fac=function(t){return new(t||i)(Me(uo))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};function TH(i,e){i&1&&(x(0,"div",24)(1,"div",26),M(2,"No Image provided"),b()())}function IH(i,e){if(i&1&&(x(0,"div",22),ee(1,TH,3,0,"div",23),x(2,"div",24),B(3,"img",25),b()()),i&2){let t=e.$implicit,n=Y();I(),F("ngIf",n.events.length==0),I(2),F("src",n.urlImage+t.event_image,_i)}}function DH(i,e){i&1&&(x(0,"span"),M(1,"..."),b())}function PH(i,e){if(i&1){let t=rt();x(0,"div",44)(1,"div",45),B(2,"img",46),b(),x(3,"div",47),M(4),b(),B(5,"hr",48),x(6,"div",49)(7,"p",50),M(8,"Start:"),b(),x(9,"p"),M(10),b(),x(11,"p",51),M(12,"End:"),b(),x(13,"p"),M(14),b(),x(15,"p",51),M(16,"Details:"),b(),x(17,"p",52),M(18),ml(19,"slice"),ee(20,DH,2,0,"span",53),b()(),x(21,"div",54)(22,"button",55),Z("click",function(){let r=he(t).$implicit,s=Y(2);return fe(s.eventSelected(r.event_id,r.event_name,r.status,r.event_start,r.event_end))}),M(23," Select This Event "),b()()()}if(i&2){let t=e.$implicit,n=Y(2);I(2),F("src",n.urlImage+t.event_image,_i),I(2),Qt(" ",n.toTitleCase(t.event_name)," "),I(6),ge(n.formatDate(t.event_start)),I(4),ge(t.event_end),I(4),ge(Dc(19,6,t.details,0,100)),I(2),F("ngIf",t.details.length>100)}}function RH(i,e){if(i&1){let t=rt();x(0,"div",27)(1,"div",28)(2,"div",29)(3,"button",30),Z("click",function(){he(t);let r=Y();return fe(r.isEvent=!r.isEvent)}),te(),x(4,"svg",31),B(5,"path",32),b()()(),ot(),x(6,"div",33),B(7,"div",34),x(8,"div",35)(9,"p",36),M(10," STEP 3 "),x(11,"span",37),B(12,"br"),M(13,"Application"),b()()(),x(14,"div",38)(15,"p",36),M(16," STEP 2 "),x(17,"span",37),B(18,"br"),M(19,"Kiosk Selection"),b()()(),x(20,"div",39)(21,"p",36),M(22," STEP 1 "),x(23,"span",40),B(24,"br"),M(25,"Event Selection"),b()()()(),x(26,"div",41),M(27," Upcoming Events: "),b(),x(28,"div",42),ee(29,PH,24,10,"div",43),b()()()}if(i&2){let t=Y();I(29),F("ngForOf",t.events)}}function LH(i,e){i&1&&(x(0,"div",56),B(1,"div",57),x(2,"p",58),M(3,"loading..."),b()())}ls.use([cA,dA]);var eg=class i{constructor(e,t){this.eventService=e;this.router=t}events=[];loading=!1;urlImage="https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/";isEvent=!1;runOnce=!1;ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.fetchEvents(),sessionStorage.setItem("eventName",""),sessionStorage.setItem("kioskName",""),sessionStorage.setItem("eventId",""),sessionStorage.setItem("kioskId",""),sessionStorage.getItem("runOnce")=="false"&&(window.location.reload(),sessionStorage.setItem("runOnce","true"))}fetchEvents(){this.eventService.getEvents().subscribe(e=>{this.events=e})}ngAfterViewInit(){let e=new ls(".default-carousel",{loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swipe-next",prevEl:".swipe-prev"}});setInterval(()=>{e.slideNext()},3e3)}toTitleCase(e){return e.toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}formatDate(e){let t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}toggleKiosk(){this.isEvent=!this.isEvent}eventSelected(e,t,n,r,s){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("eventId",e),sessionStorage.setItem("eventName",t),sessionStorage.setItem("status",n),sessionStorage.setItem("eventStart",r),sessionStorage.setItem("eventE  nd",s),this.router.navigate(["/map-viewer"]).then(()=>{window.location.reload()})},200)}static \u0275fac=function(t){return new(t||i)(ne(di),ne(et))};static \u0275cmp=vt({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[_t],decls:26,vars:3,consts:[[1,"h-full","max-w-full","pt-20","justify-center","flex","items-center","z-0","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","pt-2","z-10"],[1,"h-full","justify-center","itens-center","flex","bg-black"],[1,"swiper","justify-center","itens-center","default-carousel"],[1,"swiper-wrapper"],["class","swiper-slide",4,"ngFor","ngForOf"],[1,"swipe-prev","absolute","top-72","z-10","left-1","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-14","w-14","text-gray-600","hover:text-gray-900"],["points","15 18 9 12 15 6"],[1,"swipe-next","absolute","top-72","z-[10]","right-1","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["points","9 18 15 12 9 6"],[1,"relative","-top-2"],[1,"swiper-pagination"],[1,"flex","justify-center","items-center","space-y-9","w-full","h-full","bg-customDarkGreen","l-0","py-24","md:py-0"],[1,"block","justify-center","items-center","w-full","pl-4"],[1,"text-left","text-white","text-7xl","font-bold"],[1,"text-left","text-gray-300","text-sm","font-semibold","pt-2","w-3/4"],[1,"pt-4"],[1,"bg-gray-300","w-40","h-12","rounded-xl","text-gray-600","font-bold","shadow-sm","shadow-gray-400","hover:text-gray-800","hover-bg-gray-400","hover:shadow-md","hover:shadow-green-900",3,"click"],[1,"max-w-screen-xl"],["class","animate-fadeIn fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-[100]",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-full w-full z-[300]",4,"ngIf"],[1,"swiper-slide"],["class","h-full w-full flex justify-center items-center ",4,"ngIf"],[1,"h-full","w-full","flex","justify-center","items-center"],[1,"h-full","w-full","object-cover",3,"src"],[1,"h-[500px]","w-full","object-cover","flex","text-gray-50","justify-center","items-center"],[1,"animate-fadeIn","fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-[100]"],[1,"relative","bg-customDarkGreen","max-w-screen-xl","max-w-screen-md","h-5/6","w-5/6","md:h-3/4","px-8","py-4","rounded-xl","shadow-black","shadow-[4px]","overflow-y-auto","z-[200]"],[1,"absolute","top-4","right-4"],[1,"text-white","hover:text-gray-700","p-2","rounded-full","hover:bg-gray-200","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"w-full","h-20","flex","flex-col","items-center","md:flex-row","md:justify-center","md:top-0","top-10","relative"],[1,"w-[15rem]","md:w-[29rem]","h-16","pt-5","border-b-4","px-4","md:px-20","relative"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[1.75rem]","left-32","md:top-[1.90rem]","md:left-0","mt-4","md:mt-0"],[1,"relative","text-sm","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold"],[1,"text-xs","text-gray-300"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[4.0rem]","md:top-[1.90rem]","md:right-[16rem]","mt-4","md:mt-0"],[1,"size-8","bg-gray-50","rounded-full","relative","-top-[6.5rem]","-left-[8rem]","md:top-[2rem]","md:-left-[32rem]","mt-4","md:mt-0"],[1,"text-xs","text-gray-50"],[1,"w-full","text-left","text-white","text-3xl","font-bold","border-white","border-b-2","pt-4","pb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-2","justify-center","items-center","gap-4","pt-4"],["class","h-full flex flex-col w-full bg-green-50 rounded-xl shadow-green-700 shadow-md px-3",4,"ngFor","ngForOf"],[1,"h-full","flex","flex-col","w-full","bg-green-50","rounded-xl","shadow-green-700","shadow-md","px-3"],[1,"flex","justify-center","items-center"],[1,"size-28","rounded-full","object-contain","mt-4","justify-self-center","align-center","border-gray-300","border-2",3,"src"],[1,"text-center","text-xl","py-2","font-bold","block"],[1,"border-t-2","border-black","w-full"],[1,"text-center","text-xs","pt-2","block"],[1,"text-md","font-bold"],[1,"text-md","font-bold","pt-2"],[1,"block","w-full","min-h-full"],[4,"ngIf"],[1,"flex","align-center","justify-center","pt-3","pb-4","mt-auto"],[1,"flex","align-center","justify-center","font-bold","text-gray-900","text-center","h-12","w-40","pt-3","bg-gray-300","shadow-sm","shadow-gray-400","rounded-full","hover:bg-gray-400","hover:shadow-gray-900","hover:shadow-md",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-full","w-full","z-[300]"],[1,"animate-spin","rounded-full","size-20","border-t-4","border-black"],[1,"relative","left-[-65px]","font-bold","text-xs"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),ee(5,IH,4,2,"div",5),b(),x(6,"button",6),te(),x(7,"svg",7),B(8,"polyline",8),b()(),ot(),x(9,"button",9),te(),x(10,"svg",7),B(11,"polyline",10),b()(),ot(),x(12,"div",11),B(13,"div",12),b()()(),x(14,"div",13)(15,"div",14)(16,"div",15),M(17,"EVENTS"),b(),x(18,"div",16),M(19,'"Streamline your event experience with our kiosk system\u2014effortlessly browse, select, and stay updated on the latest happenings! Discover events that match your interests, view real-time details, and plan with ease. Our intuitive system ensures a hassle-free way to stay connected and make the most of every event opportunity."'),b(),x(20,"div",17)(21,"button",18),Z("click",function(){return n.toggleKiosk()}),M(22,"EXPLORE EVENTS!"),b()()()()(),x(23,"div",19),ee(24,RH,30,1,"div",20),b()(),ee(25,LH,4,0,"div",21)),t&2&&(I(5),F("ngForOf",n.events),I(19),F("ngIf",n.isEvent),I(),F("ngIf",n.loading))},dependencies:[Mt,pn,Nt,Lc],styles:['*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.swiper-wrapper[_ngcontent-%COMP%]{width:100%;height:max-content!important;padding-bottom:0!important;-webkit-transition-timing-function:linear!important;transition-timing-function:linear!important;position:relative}.swiper-pagination-bullet[_ngcontent-%COMP%]{background:#4f46e5}.swiper-button-next[_ngcontent-%COMP%]:before{content:"";color:#4a5568;font-size:1.5rem;font-weight:700}.swiper-button-next[_ngcontent-%COMP%]:hover:before{color:#1a202c}']})};var iR=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(n){return new(n||i)(ne(Fi),ne(oi))}}static{this.\u0275dir=dn({type:i})}}return i})(),lg=(()=>{class i extends iR{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275dir=dn({type:i,features:[Zi]})}}return i})(),mh=new Je(""),kH={provide:mh,useExisting:Ps(()=>mA),multi:!0},mA=(()=>{class i extends lg{writeValue(t){this.setProperty("checked",t)}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275dir=dn({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,r){n&1&&Z("change",function(o){return r.onChange(o.target.checked)})("blur",function(){return r.onTouched()})},features:[da([kH]),Zi]})}}return i})(),NH={provide:mh,useExisting:Ps(()=>bn),multi:!0};function FH(){let i=ao()?ao().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var OH=new Je(""),bn=(()=>{class i extends iR{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!FH())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(n){return new(n||i)(ne(Fi),ne(oi),ne(OH,8))}}static{this.\u0275dir=dn({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&Z("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[da([NH]),Zi]})}}return i})();function BH(i){return i==null||(typeof i=="string"||Array.isArray(i))&&i.length===0}var gA=new Je(""),rR=new Je("");function VH(i){return BH(i.value)?{required:!0}:null}function XP(i){return null}function sR(i){return i!=null}function oR(i){return gl(i)?fn(i):i}function aR(i){let e={};return i.forEach(t=>{e=t!=null?re(re({},e),t):e}),Object.keys(e).length===0?null:e}function lR(i,e){return e.map(t=>t(i))}function UH(i){return!i.validate}function cR(i){return i.map(e=>UH(e)?e:t=>e.validate(t))}function HH(i){if(!i)return null;let e=i.filter(sR);return e.length==0?null:function(t){return aR(lR(t,e))}}function vA(i){return i!=null?HH(cR(i)):null}function zH(i){if(!i)return null;let e=i.filter(sR);return e.length==0?null:function(t){let n=lR(t,e).map(oR);return Rx(n).pipe(bt(aR))}}function xA(i){return i!=null?zH(cR(i)):null}function YP(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function jH(i){return i._rawValidators}function GH(i){return i._rawAsyncValidators}function pA(i){return i?Array.isArray(i)?i:[i]:[]}function ng(i,e){return Array.isArray(i)?i.includes(e):i===e}function QP(i,e){let t=pA(e);return pA(i).forEach(r=>{ng(t,r)||t.push(r)}),t}function KP(i,e){return pA(e).filter(t=>!ng(i,t))}var ig=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=vA(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=xA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Jc=class extends ig{get formDirective(){return null}get path(){return null}},ph=class extends ig{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},rg=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},WH={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},gue=Ge(re({},WH),{"[class.ng-submitted]":"isSubmitted"}),An=(()=>{class i extends rg{constructor(t){super(t)}static{this.\u0275fac=function(n){return new(n||i)(ne(ph,2))}}static{this.\u0275dir=dn({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&Su("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Zi]})}}return i})(),Ir=(()=>{class i extends rg{constructor(t){super(t)}static{this.\u0275fac=function(n){return new(n||i)(ne(Jc,10))}}static{this.\u0275dir=dn({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){n&2&&Su("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Zi]})}}return i})();var ch="VALID",tg="INVALID",Qc="PENDING",dh="DISABLED",$c=class{},sg=class extends $c{constructor(e,t){super(),this.value=e,this.source=t}},hh=class extends $c{constructor(e,t){super(),this.pristine=e,this.source=t}},fh=class extends $c{constructor(e,t){super(),this.touched=e,this.source=t}},Kc=class extends $c{constructor(e,t){super(),this.status=e,this.source=t}};function dR(i){return(cg(i)?i.validators:i)||null}function qH(i){return Array.isArray(i)?vA(i):i||null}function uR(i,e){return(cg(e)?e.asyncValidators:i)||null}function ZH(i){return Array.isArray(i)?xA(i):i||null}function cg(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function XH(i,e,t){let n=i.controls;if(!(e?Object.keys(n):n).length)throw new ze(1e3,"");if(!n[t])throw new ze(1001,"")}function YH(i,e,t){i._forEachChild((n,r)=>{if(t[r]===void 0)throw new ze(1002,"")})}var og=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Tu(()=>this.statusReactive()),this.statusReactive=pl(void 0),this._pristine=Tu(()=>this.pristineReactive()),this.pristineReactive=pl(!0),this._touched=Tu(()=>this.touchedReactive()),this.touchedReactive=pl(!1),this._events=new ri,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return so(this.statusReactive)}set status(e){so(()=>this.statusReactive.set(e))}get valid(){return this.status===ch}get invalid(){return this.status===tg}get pending(){return this.status==Qc}get disabled(){return this.status===dh}get enabled(){return this.status!==dh}get pristine(){return so(this.pristineReactive)}set pristine(e){so(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return so(this.touchedReactive)}set touched(e){so(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(QP(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(QP(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(KP(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(KP(e,this._rawAsyncValidators))}hasValidator(e){return ng(this._rawValidators,e)}hasAsyncValidator(e){return ng(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Ge(re({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new fh(!0,n))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new fh(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Ge(re({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new hh(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new hh(!0,n))}markAsPending(e={}){this.status=Qc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Kc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Ge(re({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=dh,this.errors=null,this._forEachChild(r=>{r.disable(Ge(re({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new sg(this.value,n)),this._events.next(new Kc(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ge(re({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ch,this._forEachChild(n=>{n.enable(Ge(re({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ge(re({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ch||this.status===Qc)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new sg(this.value,t)),this._events.next(new Kc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Ge(re({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dh:ch}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Qc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=oR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new Kc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new _n,this.statusChanges=new _n}_calculateStatus(){return this._allControlsDisabled()?dh:this.errors?tg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qc)?Qc:this._anyControlsHaveStatus(tg)?tg:ch}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new hh(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new fh(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){cg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=qH(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=ZH(this._rawAsyncValidators)}},ag=class extends og{constructor(e,t,n){super(dR(t),uR(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){YH(this,!0,e),Object.keys(e).forEach(n=>{XH(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,r)=>((n.enabled||this.disabled)&&(t[r]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var wA=new Je("CallSetDisabledState",{providedIn:"root",factory:()=>yA}),yA="always";function QH(i,e){return[...e.path,i]}function hR(i,e,t=yA){fR(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),JH(i,e),ez(i,e),$H(i,e),KH(i,e)}function JP(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function KH(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function fR(i,e){let t=jH(i);e.validator!==null?i.setValidators(YP(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=GH(i);e.asyncValidator!==null?i.setAsyncValidators(YP(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();JP(e._rawValidators,r),JP(e._rawAsyncValidators,r)}function JH(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&pR(i,e)})}function $H(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&pR(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function pR(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function ez(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function tz(i,e){i==null,fR(i,e)}function nz(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function iz(i){return Object.getPrototypeOf(i.constructor)===lg}function rz(i,e){i._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function sz(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(s=>{s.constructor===bn?t=s:iz(s)?n=s:r=s}),r||n||t||null}var oz={provide:Jc,useExisting:Ps(()=>dr)},uh=Promise.resolve(),dr=(()=>{class i extends Jc{get submitted(){return so(this.submittedReactive)}constructor(t,n,r){super(),this.callSetDisabledState=r,this._submitted=Tu(()=>this.submittedReactive()),this.submittedReactive=pl(!1),this._directives=new Set,this.ngSubmit=new _n,this.form=new ag({},vA(t),xA(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){uh.then(()=>{let n=this._findContainer(t.path);t.control=n.registerControl(t.name,t.control),hR(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){uh.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){uh.then(()=>{let n=this._findContainer(t.path),r=new ag({});tz(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){uh.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,n){uh.then(()=>{this.form.get(t.path).setValue(n)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),rz(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(n){return new(n||i)(ne(gA,10),ne(rR,10),ne(wA,8))}}static{this.\u0275dir=dn({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,r){n&1&&Z("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[da([oz]),Zi]})}}return i})();function $P(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function eR(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var az=class extends og{constructor(e=null,t,n){super(dR(t),uR(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),cg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(eR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){$P(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){$P(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var lz={provide:ph,useExisting:Ps(()=>wn)},tR=Promise.resolve(),wn=(()=>{class i extends ph{constructor(t,n,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new az,this._registered=!1,this.name="",this.update=new _n,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=sz(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),nz(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){hR(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){tR.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,r=n!==0&&ha(n);tR.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?QH(t,this._parent):[t]}static{this.\u0275fac=function(n){return new(n||i)(ne(Jc,9),ne(gA,10),ne(rR,10),ne(mh,10),ne(ks,8),ne(wA,8))}}static{this.\u0275dir=dn({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[da([lz]),Zi,Ni]})}}return i})(),Dr=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=dn({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return i})();var cz={provide:mh,useExisting:Ps(()=>ed),multi:!0};function mR(i,e){return i==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function dz(i){return i.split(":")[0]}var ed=(()=>{class i extends lg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let n=this._getOptionId(t),r=mR(n,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){let n=dz(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275dir=dn({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&Z("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[da([cz]),Zi]})}}return i})(),ba=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(mR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(n){return new(n||i)(ne(oi),ne(Fi),ne(ed,9))}}static{this.\u0275dir=dn({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return i})(),uz={provide:mh,useExisting:Ps(()=>gR),multi:!0};function nR(i,e){return i==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function hz(i){return i.split(":")[0]}var gR=(()=>{class i extends lg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let n;if(Array.isArray(t)){let r=t.map(s=>this._getOptionId(s));n=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else n=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{let r=[],s=n.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let l=o[a],c=this._getOptionValue(l.value);r.push(c)}}else{let o=n.options;for(let a=0;a<o.length;a++){let l=o[a];if(l.selected){let c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){let n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){let n=hz(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275dir=dn({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&Z("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[da([uz]),Zi]})}}return i})(),Aa=(()=>{class i{constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(nR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(nR(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(n){return new(n||i)(ne(oi),ne(Fi),ne(gR,9))}}static{this.\u0275dir=dn({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return i})();var fz=(()=>{class i{constructor(){this._validator=XP}ngOnChanges(t){if(this.inputName in t){let n=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):XP,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=dn({type:i,features:[Ni]})}}return i})();var pz={provide:gA,useExisting:Ps(()=>_l),multi:!0};var _l=(()=>{class i extends fz{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ha,this.createValidator=t=>VH}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})()}static{this.\u0275dir=dn({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,r){n&2&&Ic("required",r._enabled?"":null)},inputs:{required:"required"},features:[da([pz]),Zi]})}}return i})();var mz=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({})}}return i})();var mn=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:wA,useValue:t.callSetDisabledState??yA}]}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=gi({type:i})}static{this.\u0275inj=mi({imports:[mz]})}}return i})();var ui=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files/";isLoggedIn(){return!!sessionStorage.getItem("tokenId")}isApplied(){let e=sessionStorage.getItem("tokenId"),t=sessionStorage.getItem("userId"),n=sessionStorage.getItem("eventId"),r=sessionStorage.getItem("kioskId");return!!(e&&t&&n&&r)}isSelectedEvent(){let e=sessionStorage.getItem("tokenId"),t=sessionStorage.getItem("userId"),n=sessionStorage.getItem("eventId");return!!(e&&t&&n)}isTokenValid(){return!!sessionStorage.getItem("tokenId")}checkUserLogin(){return this.isLoggedIn()&&this.isTokenValid()}register(e,t,n,r,s,o,a,l){let c={email:e,password:t,username:n,fname:r,lname:s,businessName:o,contactNumber:a,tokenId:l};return this.http.post(`${this.apiUrl}/validation_registration.php`,c)}login(e,t){let n={email:e,password:t};return this.http.post(`${this.apiUrl}/users_authentication.php`,n)}static \u0275fac=function(t){return new(t||i)(Me(uo))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};function gz(i,e){if(i&1&&(x(0,"p",20),M(1),b()),i&2){let t=Y();I(),ge(t.errorMessage)}}function vz(i,e){i&1&&(x(0,"div",21),B(1,"div",22),x(2,"p",23),M(3,"loading..."),b()())}var dg=class i{constructor(e,t){this.authService=e;this.router=t}password="";errorMessage="";signingIn=!1;email="";rememberMe=!1;tokenIdTemp="";userName="";firstName="";lastName="";userId="";userType="";change(){this.rememberMe=!this.rememberMe}goToSignup(){this.router.navigate(["../register"])}onLogin(){sessionStorage.setItem("runOnce","false"),this.signingIn=!0,this.email==""||this.password==""?(this.errorMessage="Email and password must not be empty",this.signingIn=!1):this.authService.login(this.email,this.password).subscribe({next:e=>{if(e.success&&e.tokenId)if(e.userType=="user"&&e.status==1)this.tokenIdTemp=e.tokenId,this.userName=e.user.username,this.firstName=e.user.firstname,this.lastName=e.user.lastname,this.userId=e.user.userId,this.email=e.user.email,this.userType=e.userType,sessionStorage.setItem("tokenId",this.tokenIdTemp.toString()),sessionStorage.setItem("userName",this.userName.toString()),sessionStorage.setItem("firstName",this.firstName.toString()),sessionStorage.setItem("lastName",this.lastName.toString()),sessionStorage.setItem("userId",this.userId.toString()),sessionStorage.setItem("email",this.email.toString()),sessionStorage.setItem("userType",this.userType.toString()),setInterval(()=>{this.signingIn=!1,sessionStorage.setItem("runOnce","false"),this.router.navigate(["/dashboard"])},200);else if(e.userType=="admin"&&e.status==1||e.userType=="IGP"&&e.status==1||e.userType=="EX-Director"&&e.status==1){this.tokenIdTemp=e.tokenId,this.userName=e.user.username,this.firstName=e.user.firstname,this.lastName=e.user.lastname,this.userId=e.user.userId,this.email=e.user.email,this.userType=e.userType;let t=e.events,n=e.transactions,r=e.reports,s=e.settings,o=e.control,a=e.history;sessionStorage.setItem("events",t),sessionStorage.setItem("transactions",n),sessionStorage.setItem("reports",r),sessionStorage.setItem("settings",s),sessionStorage.setItem("control",o),sessionStorage.setItem("history",a),console.log(r,t,n,s,a,o),sessionStorage.setItem("tokenId",this.tokenIdTemp.toString()),sessionStorage.setItem("userName",this.userName.toString()),sessionStorage.setItem("firstName",this.firstName.toString()),sessionStorage.setItem("lastName",this.lastName.toString()),sessionStorage.setItem("userId",this.userId.toString()),sessionStorage.setItem("email",this.email.toString()),sessionStorage.setItem("userType",this.userType.toString()),setInterval(()=>{this.signingIn=!1,sessionStorage.setItem("runOnce","false"),this.router.navigate(["/dashboard-admin"])},200)}else setInterval(()=>{this.signingIn=!1,e.status==0?this.errorMessage="Request is still pending":e.status==2&&(this.errorMessage="Request denied")},200);else setInterval(()=>{this.signingIn=!1,this.errorMessage=e.message},200),console.log(this.errorMessage)},error:e=>{this.errorMessage="There was an error with the login request."},complete:()=>{}})}ngOnInit(){}static \u0275fac=function(t){return new(t||i)(ne(ui),ne(et))};static \u0275cmp=vt({type:i,selectors:[["app-login"]],standalone:!0,features:[_t],decls:25,vars:4,consts:[[1,"min-h-screen","top-0","w-full","px-[8vw]","left-0","flex","items-center","justify-center","bg-customGreen"],[1,"grid","grid-cols-1","md:grid-cols-2","justify-center","shadow-bottom","shadow-black","items-center","h-[520px]","w-[1000px]","bg-white","rounded-xl"],[1,"justify-center","items-center","h-full","w-full","p-8","hidden","md:flex","bg-gray-50","rounded-l-xl"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"md:size-[400px]","xl:size-[400px]","align-center"],[1,"h-full","w-full","p-4","md:p-16","justify-center","items-center","flex","bg-gray-200","rounded-xl","md:rounded-l-[0px]","md:rounded-r-xl"],[1,"w-full"],[1,"text-center","overflow-hidden","text-xl","md:text-3xl","text-gray-700"],[1,"pt-4",3,"ngSubmit"],[1,"form-group","mb-4"],["type","text","id","email","name","email","required","","placeholder","Enter email or username",1,"mt-2","h-14","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","password","id","password","name","password","required","","placeholder","Enter password",1,"h-14","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group"],["type","submit","id","submit","name","submit",1,"h-12","rounded-full","text-white","text-sm","px-4","py-2","bg-blue-600","hover:bg-blue-900","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue"],[1,"form-group","col-span-2","h-2","p-2"],["class","text-center text-red-700 text-sm ",4,"ngIf"],[1,"hidden","text-center","mt-4","overflow-hidden"],[1,"text-blue-500","text-sm","overflow-hidden"],[1,"text-center","overflow-hidden"],[1,"text-blue-500","text-sm",3,"click"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-full w-full z-[100]",4,"ngIf"],[1,"text-center","text-red-700","text-sm"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","size-20","border-t-4","border-black"],[1,"relative","left-[-65px]","font-bold","text-xs"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2),B(3,"img",3),b(),x(4,"div",4)(5,"div",5)(6,"h6",6),M(7," Welcome Back! "),b(),x(8,"form",7),Z("ngSubmit",function(){return n.onLogin()}),x(9,"div",8)(10,"input",9),nt("ngModelChange",function(s){return it(n.email,s)||(n.email=s),s}),b()(),x(11,"div",8)(12,"input",10),nt("ngModelChange",function(s){return it(n.password,s)||(n.password=s),s}),b()(),x(13,"div",11)(14,"button",12),M(15,"Login"),b()(),x(16,"div",13),ee(17,gz,2,1,"p",14),b()(),x(18,"div",15)(19,"button",16),M(20," Forgot Password ? "),b()(),x(21,"div",17)(22,"button",18),Z("click",function(){return n.goToSignup()}),M(23," Don't have an account? Sign Up "),b()()()()(),ee(24,vz,4,0,"div",19),b()),t&2&&(I(10),tt("ngModel",n.email),I(2),tt("ngModel",n.password),I(5),F("ngIf",n.errorMessage),I(7),F("ngIf",n.signingIn))},dependencies:[Mt,Nt,mn,Dr,bn,An,Ir,_l,wn,dr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var ug,xz=new Uint8Array(16);function bA(){if(!ug&&(ug=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ug))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ug(xz)}var vR=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function wz(i){return typeof i=="string"&&vR.test(i)}var xR=wz;var wi=[];for(hg=0;hg<256;++hg)wi.push((hg+256).toString(16).substr(1));var hg;function yz(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(wi[i[e+0]]+wi[i[e+1]]+wi[i[e+2]]+wi[i[e+3]]+"-"+wi[i[e+4]]+wi[i[e+5]]+"-"+wi[i[e+6]]+wi[i[e+7]]+"-"+wi[i[e+8]]+wi[i[e+9]]+"-"+wi[i[e+10]]+wi[i[e+11]]+wi[i[e+12]]+wi[i[e+13]]+wi[i[e+14]]+wi[i[e+15]]).toLowerCase();if(!xR(t))throw TypeError("Stringified UUID is invalid");return t}var wR=yz;function bz(i,e,t){i=i||{};var n=i.random||(i.rng||bA)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=n[r];return e}return wR(n)}var AA=bz;var mo={_origin:"https://api.emailjs.com"};var yR=(i,e="https://api.emailjs.com")=>{mo._userID=i,mo._origin=e};var fg=(i,e,t)=>{if(!i)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};var gh=class{constructor(e){this.status=e.status,this.text=e.responseText}};var pg=(i,e,t={})=>new Promise((n,r)=>{let s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{let a=new gh(o);a.status===200||a.text==="OK"?n(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new gh(o))}),s.open("POST",mo._origin+i,!0),Object.keys(t).forEach(o=>{s.setRequestHeader(o,t[o])}),s.send(e)});var bR=(i,e,t,n)=>{let r=n||mo._userID;return fg(r,i,e),pg("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:r,service_id:i,template_id:e,template_params:t}),{"Content-type":"application/json"})};var Az=i=>{let e;if(typeof i=="string"?e=document.querySelector(i):e=i,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},AR=(i,e,t,n)=>{let r=n||mo._userID,s=Az(t);fg(r,i,e);let o=new FormData(s);return o.append("lib_version","3.2.0"),o.append("service_id",i),o.append("template_id",e),o.append("user_id",r),pg("/api/v1.0/email/send-form",o)};var cs={init:yR,send:bR,sendForm:AR};function _z(i,e){if(i&1&&(x(0,"p",26),M(1),b()),i&2){let t=Y();I(),ge(t.successMessage)}}function Sz(i,e){if(i&1&&(x(0,"p",27),M(1),b()),i&2){let t=Y();I(),ge(t.errorMessage)}}var mg=class i{constructor(e,t){this.authService=e;this.router=t}email="";password="";fname="";lname="";businessName="";contactNumber="";username="";confirmPassword="";successMessage="";errorMessage="";tokenId="";currentTime="";templateParams={from_name:"John Doe",from_email:"john.doe@example.com",message:"User has signed up and is now trying to log in."};goToSignIn(){this.router.navigate(["/login"])}emailPattern=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;passwordPatterm=/^(?=.*\d)(?=.*[!@#$%^&*(),.?":{}|<>])[A-Za-z\d!@#$%^&*(),.?":{}|<>]{6,}$/;phoneNumberPattern=/^(?:639\d{9}|09\d{9})$/;generateUUID(){let e=AA();this.tokenId=e}onSignUp(){if(this.email==""||this.password==""||this.fname==""||this.lname==""||this.businessName==""||this.contactNumber==""||this.username==""||this.confirmPassword==""){this.errorMessage="All fields are required!";return}if(this.contactNumber.startsWith("639")&&this.contactNumber.length!==12||this.contactNumber.startsWith("09")&&this.contactNumber.length!==11||!this.phoneNumberPattern.test(this.contactNumber)){this.errorMessage="Invalid phone number",console.log(this.errorMessage);return}if(this.password.length<6){this.errorMessage="Passwords must be 6 characters long!";return}if(this.password!==this.confirmPassword){this.errorMessage="Passwords do not match!";return}if(!this.passwordPatterm.test(this.password)){this.errorMessage="Include atleast one symbos and number!";return}if(this.emailPattern.test(this.email))this.generateUUID(),this.authService.register(this.email,this.password,this.username,this.fname,this.lname,this.businessName,this.contactNumber,this.tokenId).subscribe({next:e=>{if(e.success){let t=new Date;this.currentTime=t.toLocaleString(),cs.send("service_l1qrwc6","template_spu6fzu",{from_name:this.fname+this.lname,from_email:this.email,creation_date:this.currentTime},"Tv0xOXxLvWH60MEV_").then(n=>{console.log("Email sent successfully!",n.text)}).catch(n=>{console.error("Email sending failed:",n)}),console.log("Registration request success"),this.errorMessage="",this.successMessage="Registration success!",this.email="",this.password="",this.fname="",this.lname="",this.businessName="",this.contactNumber="",this.username="",this.confirmPassword=""}else this.errorMessage=e.message,console.log(this.errorMessage)},error:e=>{this.errorMessage="There was an error with the registration request.",console.log(e)},complete:()=>{console.log("Registration request completed")}});else{this.errorMessage="Invalid Email Format!";return}}static \u0275fac=function(t){return new(t||i)(ne(ui),ne(et))};static \u0275cmp=vt({type:i,selectors:[["app-register"]],standalone:!0,features:[_t],decls:34,vars:10,consts:[[1,"h-screen","flex","items-center","justify-center","bg-customGreen"],[1,"sm:grid","grid-cols-1","lg:grid-cols-2","items-start","shadow-bottom","shadow-black","min-h-screen-sm","max-w-screen-lg","rounded-xl"],[1,"justify-center","items-center","h-full","w-full","p-5","hidden","lg:flex","bg-gray-50","rounded-l-xl"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"lg:size-4/5","object-contain","object-center"],[1,"h-full","w-full","px-5","py-20","md:p-10","justify-center","items-center","bg-gray-200","lg:rounded-l-none","rounded-l-xl","rounded-r-xl"],[1,"text-center","text-3xl","text-gray-700"],[1,"pt-4",3,"ngSubmit"],[1,"grid","grid-cols-2","col-span-1","gap-2"],[1,"form-group"],["type","text","id","fname","name","fname","required","","placeholder","First Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-1"],["type","text","id","lname","name","lname","required","","placeholder","Last Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-2"],["type","text","id","email","name","email","required","","placeholder","Enter Email",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","businessName","name","businessName","required","","placeholder","Business Name",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","contactNumber","name","contactNumber","required","","placeholder","Contact number",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","text","id","username","name","username","required","","placeholder","Username",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","password","id","password","name","password","required","","placeholder","Confirm Password",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],["type","password","id","confirmpassword","name","confirmpassword","required","","placeholder","Password",1,"h-12","rounded-full","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel"],[1,"form-group","col-span-2","p-1"],["type","submit","id","submit","name","submit",1,"h-12","rounded-full","text-white","text-sm","px-4","py-2","bg-blue-600","hover:bg-blue-900","w-full","border","border-gray-300","focus:outline-none","hover:ring-[3px]","hover:ring-customSkyBlue"],[1,"form-group","col-span-2","h-2","p-1"],["class","text-center text-green-700 text-sm ",4,"ngIf"],["class","text-center text-red-700 text-sm ",4,"ngIf"],[1,"text-center","pt-4"],[1,"text-blue-500","text-sm",3,"click"],[1,"text-center","text-green-700","text-sm"],[1,"text-center","text-red-700","text-sm"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2),B(3,"img",3),b(),x(4,"div",4)(5,"h6",5),M(6,"Create an account!"),b(),x(7,"form",6),Z("ngSubmit",function(){return n.onSignUp()}),x(8,"div",7)(9,"div",8)(10,"input",9),nt("ngModelChange",function(s){return it(n.fname,s)||(n.fname=s),s}),b()(),x(11,"div",10)(12,"input",11),nt("ngModelChange",function(s){return it(n.lname,s)||(n.lname=s),s}),b()(),x(13,"div",12)(14,"input",13),nt("ngModelChange",function(s){return it(n.email,s)||(n.email=s),s}),b()(),x(15,"div",10)(16,"input",14),nt("ngModelChange",function(s){return it(n.businessName,s)||(n.businessName=s),s}),b()(),x(17,"div",10)(18,"input",15),nt("ngModelChange",function(s){return it(n.contactNumber,s)||(n.contactNumber=s),s}),b()(),x(19,"div",12)(20,"input",16),nt("ngModelChange",function(s){return it(n.username,s)||(n.username=s),s}),b()(),x(21,"div",10)(22,"input",17),nt("ngModelChange",function(s){return it(n.password,s)||(n.password=s),s}),b()(),x(23,"div",10)(24,"input",18),nt("ngModelChange",function(s){return it(n.confirmPassword,s)||(n.confirmPassword=s),s}),b()(),x(25,"div",19)(26,"button",20),M(27," Register "),b()(),x(28,"div",21),ee(29,_z,2,1,"p",22)(30,Sz,2,1,"p",23),b()()(),x(31,"div",24)(32,"button",25),Z("click",function(){return n.goToSignIn()}),M(33,"Already have an account? Sign In"),b()()()()()),t&2&&(I(10),tt("ngModel",n.fname),I(2),tt("ngModel",n.lname),I(2),tt("ngModel",n.email),I(2),tt("ngModel",n.businessName),I(2),tt("ngModel",n.contactNumber),I(2),tt("ngModel",n.username),I(2),tt("ngModel",n.password),I(2),tt("ngModel",n.confirmPassword),I(5),F("ngIf",n.successMessage),I(),F("ngIf",n.errorMessage))},dependencies:[Mt,Nt,mn,Dr,bn,An,Ir,_l,wn,dr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var vh=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){let e=sessionStorage.getItem("userType");return this.authService.checkUserLogin()&&e=="user"?!0:(this.router.navigate(["/login"]),!1)}cantLogin(){return this.authService.checkUserLogin()?(this.router.navigate(["/dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Me(ui),Me(et))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var xh=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.checkUserLogin()?(this.router.navigate(["/dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Me(ui),Me(et))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var C_="170",Ul={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Hl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ez=0,_R=1,Cz=2;var YL=1,Mz=2,Ao=3,Us=0,Ki=1,ps=2,Ra=0,wd=1,SR=2,ER=3,CR=4,Tz=5,Pl=100,Iz=101,Dz=102,Pz=103,Rz=104,Lz=200,kz=201,Nz=202,Fz=203,r1=204,s1=205,Oz=206,Bz=207,Vz=208,Uz=209,Hz=210,zz=211,jz=212,Gz=213,Wz=214,o1=0,a1=1,l1=2,Ed=3,c1=4,d1=5,u1=6,h1=7,QL=0,qz=1,Zz=2,La=0,Xz=1,Yz=2,Qz=3,Kz=4,Jz=5,$z=6,e7=7,MR="attached",t7="detached",TR=300,Cd=301,Md=302,f1=303,p1=304,I0=306,kl=1e3,_o=1001,Nh=1002,Ci=1003,M_=1004;var gd=1005;var Qi=1006,Ih=1007;var Bs=1008;var Co=1009,KL=1010,JL=1011,Fh=1012,T_=1013,Nl=1014,gs=1015,Jh=1016,I_=1017,D_=1018,Td=1020,$L=35902,ek=1021,tk=1022,Lr=1023,nk=1024,ik=1025,yd=1026,Id=1027,P_=1028,R_=1029,rk=1030,L_=1031;var k_=1033,qg=33776,Zg=33777,Xg=33778,Yg=33779,m1=35840,g1=35841,v1=35842,x1=35843,w1=36196,y1=37492,b1=37496,A1=37808,_1=37809,S1=37810,E1=37811,C1=37812,M1=37813,T1=37814,I1=37815,D1=37816,P1=37817,R1=37818,L1=37819,k1=37820,N1=37821,Qg=36492,F1=36494,O1=36495,sk=36283,B1=36284,V1=36285,U1=36286;var Dd=2300,Pd=2301,_A=2302,IR=2400,DR=2401,PR=2402,n7=2500;var ok=0,D0=1,$h=2,i7=3200,r7=3201;var ak=0,s7=1,Da="",fi="srgb",Mi="srgb-linear",P0="linear",an="srgb";var td=7680;var RR=519,o7=512,a7=513,l7=514,lk=515,c7=516,d7=517,u7=518,h7=519,H1=35044;var LR="300 es",So=2e3,Kg=2001,Mo=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},Si=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],kR=1234567,Dh=Math.PI/180,Rd=180/Math.PI;function kr(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Si[i&255]+Si[i>>8&255]+Si[i>>16&255]+Si[i>>24&255]+"-"+Si[e&255]+Si[e>>8&255]+"-"+Si[e>>16&15|64]+Si[e>>24&255]+"-"+Si[t&63|128]+Si[t>>8&255]+"-"+Si[t>>16&255]+Si[t>>24&255]+Si[n&255]+Si[n>>8&255]+Si[n>>16&255]+Si[n>>24&255]).toLowerCase()}function Kn(i,e,t){return Math.max(e,Math.min(t,i))}function N_(i,e){return(i%e+e)%e}function f7(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function p7(i,e,t){return i!==e?(t-i)/(e-i):0}function Ph(i,e,t){return(1-t)*i+t*e}function m7(i,e,t,n){return Ph(i,e,1-Math.exp(-t*n))}function g7(i,e=1){return e-Math.abs(N_(i,e*2)-e)}function v7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function x7(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function w7(i,e){return i+Math.floor(Math.random()*(e-i+1))}function y7(i,e){return i+Math.random()*(e-i)}function b7(i){return i*(.5-Math.random())}function A7(i){i!==void 0&&(kR=i);let e=kR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function _7(i){return i*Dh}function S7(i){return i*Rd}function E7(i){return(i&i-1)===0&&i!==0}function C7(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function M7(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function T7(i,e,t,n,r){let s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),d=o((e+n)/2),u=s((e-n)/2),h=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":i.set(a*d,l*u,l*h,a*c);break;case"YZY":i.set(l*h,a*d,l*u,a*c);break;case"ZXZ":i.set(l*u,l*h,a*d,a*c);break;case"XZX":i.set(a*d,l*p,l*f,a*c);break;case"YXY":i.set(l*f,a*d,l*p,a*c);break;case"ZYZ":i.set(l*p,l*f,a*d,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ms(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function on(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var R0={DEG2RAD:Dh,RAD2DEG:Rd,generateUUID:kr,clamp:Kn,euclideanModulo:N_,mapLinear:f7,inverseLerp:p7,lerp:Ph,damp:m7,pingpong:g7,smoothstep:v7,smootherstep:x7,randInt:w7,randFloat:y7,randFloatSpread:b7,seededRandom:A7,degToRad:_7,radToDeg:S7,isPowerOfTwo:E7,ceilPowerOfTwo:C7,floorPowerOfTwo:M7,setQuaternionFromProperEuler:T7,normalize:on,denormalize:ms},ye=class i{constructor(e=0,t=0){i.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Kn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},It=class i{constructor(e,t,n,r,s,o,a,l,c){i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,c)}set(e,t,n,r,s,o,a,l,c){let d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],d=n[4],u=n[7],h=n[2],f=n[5],p=n[8],v=r[0],g=r[3],m=r[6],y=r[1],w=r[4],A=r[7],C=r[2],E=r[5],T=r[8];return s[0]=o*v+a*y+l*C,s[3]=o*g+a*w+l*E,s[6]=o*m+a*A+l*T,s[1]=c*v+d*y+u*C,s[4]=c*g+d*w+u*E,s[7]=c*m+d*A+u*T,s[2]=h*v+f*y+p*C,s[5]=h*g+f*w+p*E,s[8]=h*m+f*A+p*T,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-n*s*d+n*a*l+r*s*c-r*o*l}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=d*o-a*c,h=a*l-d*s,f=c*s-o*l,p=t*u+n*h+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let v=1/p;return e[0]=u*v,e[1]=(r*c-d*n)*v,e[2]=(a*n-r*o)*v,e[3]=h*v,e[4]=(d*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=f*v,e[7]=(n*l-c*t)*v,e[8]=(o*t-n*s)*v,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){let l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(SA.makeScale(e,t)),this}rotate(e){return this.premultiply(SA.makeRotation(-e)),this}translate(e,t){return this.premultiply(SA.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},SA=new It;function ck(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function Oh(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function I7(){let i=Oh("canvas");return i.style.display="block",i}var NR={};function Mh(i){i in NR||(NR[i]=!0,console.warn(i))}function D7(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}function P7(i){let e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function R7(i){let e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}var Ut={enabled:!0,workingColorSpace:Mi,spaces:{},convert:function(i,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===an&&(i.r=Eo(i.r),i.g=Eo(i.g),i.b=Eo(i.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(i.applyMatrix3(this.spaces[e].toXYZ),i.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===an&&(i.r=bd(i.r),i.g=bd(i.g),i.b=bd(i.b))),i},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Da?P0:this.spaces[i].transfer},getLuminanceCoefficients:function(i,e=this.workingColorSpace){return i.fromArray(this.spaces[e].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,e,t){return i.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}};function Eo(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function bd(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var FR=[.64,.33,.3,.6,.15,.06],OR=[.2126,.7152,.0722],BR=[.3127,.329],VR=new It().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),UR=new It().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);Ut.define({[Mi]:{primaries:FR,whitePoint:BR,transfer:P0,toXYZ:VR,fromXYZ:UR,luminanceCoefficients:OR,workingColorSpaceConfig:{unpackColorSpace:fi},outputColorSpaceConfig:{drawingBufferColorSpace:fi}},[fi]:{primaries:FR,whitePoint:BR,transfer:an,toXYZ:VR,fromXYZ:UR,luminanceCoefficients:OR,outputColorSpaceConfig:{drawingBufferColorSpace:fi}}});var nd,z1=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{nd===void 0&&(nd=Oh("canvas")),nd.width=e.width,nd.height=e.height;let n=nd.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=nd}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Oh("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Eo(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Eo(t[n]/255)*255):t[n]=Eo(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},L7=0,Jg=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:L7++}),this.uuid=kr(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(EA(r[o].image)):s.push(EA(r[o]))}else s=EA(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function EA(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?z1.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var k7=0,Br=(()=>{class i extends Mo{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=_o,s=_o,o=Qi,a=Bs,l=Lr,c=Co,d=i.DEFAULT_ANISOTROPY,u=Da){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:k7++}),this.uuid=kr(),this.name="",this.source=new Jg(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ye(0,0),this.repeat=new ye(1,1),this.center=new ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new It,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==TR)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case kl:t.x=t.x-Math.floor(t.x);break;case _o:t.x=t.x<0?0:1;break;case Nh:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case kl:t.y=t.y-Math.floor(t.y);break;case _o:t.y=t.y<0?0:1;break;case Nh:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=TR,i.DEFAULT_ANISOTROPY=1,i})(),Jt=class i{constructor(e=0,t=0,n=0,r=1){i.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s,l=e.elements,c=l[0],d=l[4],u=l[8],h=l[1],f=l[5],p=l[9],v=l[2],g=l[6],m=l[10];if(Math.abs(d-h)<.01&&Math.abs(u-v)<.01&&Math.abs(p-g)<.01){if(Math.abs(d+h)<.1&&Math.abs(u+v)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let w=(c+1)/2,A=(f+1)/2,C=(m+1)/2,E=(d+h)/4,T=(u+v)/4,L=(p+g)/4;return w>A&&w>C?w<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(w),r=E/n,s=T/n):A>C?A<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(A),n=E/r,s=L/r):C<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),n=T/s,r=L/s),this.set(n,r,s,t),this}let y=Math.sqrt((g-p)*(g-p)+(u-v)*(u-v)+(h-d)*(h-d));return Math.abs(y)<.001&&(y=1),this.x=(g-p)/y,this.y=(u-v)/y,this.z=(h-d)/y,this.w=Math.acos((c+f+m-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},j1=class extends Mo{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Jt(0,0,e,t),this.scissorTest=!1,this.viewport=new Jt(0,0,e,t);let r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Qi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let s=new Br(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Jg(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},To=class extends j1{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},$g=class extends Br{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=_o,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};var G1=class extends Br{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=_o,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var $i=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],d=n[r+2],u=n[r+3],h=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=f,e[t+2]=p,e[t+3]=v;return}if(u!==v||l!==h||c!==f||d!==p){let g=1-a,m=l*h+c*f+d*p+u*v,y=m>=0?1:-1,w=1-m*m;if(w>Number.EPSILON){let C=Math.sqrt(w),E=Math.atan2(C,m*y);g=Math.sin(g*E)/C,a=Math.sin(a*E)/C}let A=a*y;if(l=l*g+h*A,c=c*g+f*A,d=d*g+p*A,u=u*g+v*A,g===1-a){let C=1/Math.sqrt(l*l+c*c+d*d+u*u);l*=C,c*=C,d*=C,u*=C}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,s,o){let a=n[r],l=n[r+1],c=n[r+2],d=n[r+3],u=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+d*u+l*f-c*h,e[t+1]=l*p+d*h+c*u-a*f,e[t+2]=c*p+d*f+a*h-l*u,e[t+3]=d*p-a*u-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),d=a(r/2),u=a(s/2),h=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*d*u+c*f*p,this._y=c*f*u-h*d*p,this._z=c*d*p+h*f*u,this._w=c*d*u-h*f*p;break;case"YXZ":this._x=h*d*u+c*f*p,this._y=c*f*u-h*d*p,this._z=c*d*p-h*f*u,this._w=c*d*u+h*f*p;break;case"ZXY":this._x=h*d*u-c*f*p,this._y=c*f*u+h*d*p,this._z=c*d*p+h*f*u,this._w=c*d*u-h*f*p;break;case"ZYX":this._x=h*d*u-c*f*p,this._y=c*f*u+h*d*p,this._z=c*d*p-h*f*u,this._w=c*d*u+h*f*p;break;case"YZX":this._x=h*d*u+c*f*p,this._y=c*f*u+h*d*p,this._z=c*d*p-h*f*u,this._w=c*d*u-h*f*p;break;case"XZY":this._x=h*d*u-c*f*p,this._y=c*f*u-h*d*p,this._z=c*d*p+h*f*u,this._w=c*d*u+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],u=t[10],h=n+a+u;if(h>0){let f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(d-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){let f=2*Math.sqrt(1+n-a-u);this._w=(d-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){let f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+d)/f}else{let f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+d)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Kn(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-n*c,this._z=s*d+o*c+n*l-r*a,this._w=o*d-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;let l=1-a*a;if(l<=Number.EPSILON){let f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}let c=Math.sqrt(l),d=Math.atan2(c,a),u=Math.sin((1-t)*d)/c,h=Math.sin(t*d)/c;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},V=class i{constructor(e=0,t=0,n=0){i.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HR.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*n),d=2*(a*t-s*r),u=2*(s*n-o*t);return this.x=t+l*c+o*u-a*d,this.y=n+l*d+a*c-s*u,this.z=r+l*u+s*d-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return CA.copy(this).projectOnVector(e),this.sub(CA)}reflect(e){return this.sub(CA.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Kn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},CA=new V,HR=new $i,Nr=class{constructor(e=new V(1/0,1/0,1/0),t=new V(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(ds.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(ds.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=ds.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ds):ds.fromBufferAttribute(s,o),ds.applyMatrix4(e.matrixWorld),this.expandByPoint(ds);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),gg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),gg.copy(n.boundingBox)),gg.applyMatrix4(e.matrixWorld),this.union(gg)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ds),ds.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(wh),vg.subVectors(this.max,wh),id.subVectors(e.a,wh),rd.subVectors(e.b,wh),sd.subVectors(e.c,wh),Sa.subVectors(rd,id),Ea.subVectors(sd,rd),Sl.subVectors(id,sd);let t=[0,-Sa.z,Sa.y,0,-Ea.z,Ea.y,0,-Sl.z,Sl.y,Sa.z,0,-Sa.x,Ea.z,0,-Ea.x,Sl.z,0,-Sl.x,-Sa.y,Sa.x,0,-Ea.y,Ea.x,0,-Sl.y,Sl.x,0];return!MA(t,id,rd,sd,vg)||(t=[1,0,0,0,1,0,0,0,1],!MA(t,id,rd,sd,vg))?!1:(xg.crossVectors(Sa,Ea),t=[xg.x,xg.y,xg.z],MA(t,id,rd,sd,vg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ds).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ds).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(go[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),go[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),go[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),go[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),go[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),go[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),go[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),go[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(go),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},go=[new V,new V,new V,new V,new V,new V,new V,new V],ds=new V,gg=new Nr,id=new V,rd=new V,sd=new V,Sa=new V,Ea=new V,Sl=new V,wh=new V,vg=new V,xg=new V,El=new V;function MA(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){El.fromArray(i,s);let a=r.x*Math.abs(El.x)+r.y*Math.abs(El.y)+r.z*Math.abs(El.z),l=e.dot(El),c=t.dot(El),d=n.dot(El);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}var N7=new Nr,yh=new V,TA=new V,fr=class{constructor(e=new V,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):N7.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;yh.subVectors(e,this.center);let t=yh.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(yh,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(TA.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(yh.copy(e.center).add(TA)),this.expandByPoint(yh.copy(e.center).sub(TA))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},vo=new V,IA=new V,wg=new V,Ca=new V,DA=new V,yg=new V,PA=new V,Io=class{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=vo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vo.copy(this.origin).addScaledVector(this.direction,t),vo.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){IA.copy(e).add(t).multiplyScalar(.5),wg.copy(t).sub(e).normalize(),Ca.copy(this.origin).sub(IA);let s=e.distanceTo(t)*.5,o=-this.direction.dot(wg),a=Ca.dot(this.direction),l=-Ca.dot(wg),c=Ca.lengthSq(),d=Math.abs(1-o*o),u,h,f,p;if(d>0)if(u=o*l-a,h=o*a-l,p=s*d,u>=0)if(h>=-p)if(h<=p){let v=1/d;u*=v,h*=v,f=u*(u+o*h+2*a)+h*(o*u+h+2*l)+c}else h=s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h=-s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;else h<=-p?(u=Math.max(0,-(-o*s+a)),h=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c):h<=p?(u=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(u=Math.max(0,-(o*s+a)),h=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+h*(h+2*l)+c);else h=o>0?-s:s,u=Math.max(0,-(o*h+a)),f=-u*u+h*(h+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(IA).addScaledVector(wg,h),f}intersectSphere(e,t){vo.subVectors(e.center,this.origin);let n=vo.dot(this.direction),r=vo.dot(vo)-n*n,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l,c=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-h.z)*u,l=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,l=(e.min.z-h.z)*u),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,vo)!==null}intersectTriangle(e,t,n,r,s){DA.subVectors(t,e),yg.subVectors(n,e),PA.crossVectors(DA,yg);let o=this.direction.dot(PA),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ca.subVectors(this.origin,e);let l=a*this.direction.dot(yg.crossVectors(Ca,yg));if(l<0)return null;let c=a*this.direction.dot(DA.cross(Ca));if(c<0||l+c>o)return null;let d=-a*Ca.dot(PA);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},yt=class i{constructor(e,t,n,r,s,o,a,l,c,d,u,h,f,p,v,g){i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,c,d,u,h,f,p,v,g)}set(e,t,n,r,s,o,a,l,c,d,u,h,f,p,v,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=d,m[10]=u,m[14]=h,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new i().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/od.setFromMatrixColumn(e,0).length(),s=1/od.setFromMatrixColumn(e,1).length(),o=1/od.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){let h=o*d,f=o*u,p=a*d,v=a*u;t[0]=l*d,t[4]=-l*u,t[8]=c,t[1]=f+p*c,t[5]=h-v*c,t[9]=-a*l,t[2]=v-h*c,t[6]=p+f*c,t[10]=o*l}else if(e.order==="YXZ"){let h=l*d,f=l*u,p=c*d,v=c*u;t[0]=h+v*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*u,t[5]=o*d,t[9]=-a,t[2]=f*a-p,t[6]=v+h*a,t[10]=o*l}else if(e.order==="ZXY"){let h=l*d,f=l*u,p=c*d,v=c*u;t[0]=h-v*a,t[4]=-o*u,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*d,t[9]=v-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){let h=o*d,f=o*u,p=a*d,v=a*u;t[0]=l*d,t[4]=p*c-f,t[8]=h*c+v,t[1]=l*u,t[5]=v*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){let h=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*d,t[4]=v-h*u,t[8]=p*u+f,t[1]=u,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=f*u+p,t[10]=h-v*u}else if(e.order==="XZY"){let h=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*d,t[4]=-u,t[8]=c*d,t[1]=h*u+v,t[5]=o*d,t[9]=f*u-p,t[2]=p*u-f,t[6]=a*d,t[10]=v*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(F7,e,O7)}lookAt(e,t,n){let r=this.elements;return ur.subVectors(e,t),ur.lengthSq()===0&&(ur.z=1),ur.normalize(),Ma.crossVectors(n,ur),Ma.lengthSq()===0&&(Math.abs(n.z)===1?ur.x+=1e-4:ur.z+=1e-4,ur.normalize(),Ma.crossVectors(n,ur)),Ma.normalize(),bg.crossVectors(ur,Ma),r[0]=Ma.x,r[4]=bg.x,r[8]=ur.x,r[1]=Ma.y,r[5]=bg.y,r[9]=ur.y,r[2]=Ma.z,r[6]=bg.z,r[10]=ur.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],d=n[1],u=n[5],h=n[9],f=n[13],p=n[2],v=n[6],g=n[10],m=n[14],y=n[3],w=n[7],A=n[11],C=n[15],E=r[0],T=r[4],L=r[8],S=r[12],_=r[1],P=r[5],U=r[9],O=r[13],z=r[2],q=r[6],Q=r[10],K=r[14],W=r[3],Ee=r[7],Te=r[11],ke=r[15];return s[0]=o*E+a*_+l*z+c*W,s[4]=o*T+a*P+l*q+c*Ee,s[8]=o*L+a*U+l*Q+c*Te,s[12]=o*S+a*O+l*K+c*ke,s[1]=d*E+u*_+h*z+f*W,s[5]=d*T+u*P+h*q+f*Ee,s[9]=d*L+u*U+h*Q+f*Te,s[13]=d*S+u*O+h*K+f*ke,s[2]=p*E+v*_+g*z+m*W,s[6]=p*T+v*P+g*q+m*Ee,s[10]=p*L+v*U+g*Q+m*Te,s[14]=p*S+v*O+g*K+m*ke,s[3]=y*E+w*_+A*z+C*W,s[7]=y*T+w*P+A*q+C*Ee,s[11]=y*L+w*U+A*Q+C*Te,s[15]=y*S+w*O+A*K+C*ke,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],u=e[6],h=e[10],f=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*l*u-r*c*u-s*a*h+n*c*h+r*a*f-n*l*f)+v*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*d-s*l*d)+g*(+t*c*u-t*a*f-s*o*u+n*o*f+s*a*d-n*c*d)+m*(-r*a*d-t*l*u+t*a*h+r*o*u-n*o*h+n*l*d)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=e[9],h=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=u*g*c-v*h*c+v*l*f-a*g*f-u*l*m+a*h*m,w=p*h*c-d*g*c-p*l*f+o*g*f+d*l*m-o*h*m,A=d*v*c-p*u*c+p*a*f-o*v*f-d*a*m+o*u*m,C=p*u*l-d*v*l-p*a*h+o*v*h+d*a*g-o*u*g,E=t*y+n*w+r*A+s*C;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let T=1/E;return e[0]=y*T,e[1]=(v*h*s-u*g*s-v*r*f+n*g*f+u*r*m-n*h*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-n*g*c-a*r*m+n*l*m)*T,e[3]=(u*l*s-a*h*s-u*r*c+n*h*c+a*r*f-n*l*f)*T,e[4]=w*T,e[5]=(d*g*s-p*h*s+p*r*f-t*g*f-d*r*m+t*h*m)*T,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*m-t*l*m)*T,e[7]=(o*h*s-d*l*s+d*r*c-t*h*c-o*r*f+t*l*f)*T,e[8]=A*T,e[9]=(p*u*s-d*v*s-p*n*f+t*v*f+d*n*m-t*u*m)*T,e[10]=(o*v*s-p*a*s+p*n*c-t*v*c-o*n*m+t*a*m)*T,e[11]=(d*a*s-o*u*s-d*n*c+t*u*c+o*n*f-t*a*f)*T,e[12]=C*T,e[13]=(d*v*r-p*u*r+p*n*h-t*v*h-d*n*g+t*u*g)*T,e[14]=(p*a*r-o*v*r-p*n*l+t*v*l+o*n*g-t*a*g)*T,e[15]=(o*u*r-d*a*r+d*n*l-t*u*l-o*n*h+t*a*h)*T,this}scale(e){let t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+n,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,u=a+a,h=s*c,f=s*d,p=s*u,v=o*d,g=o*u,m=a*u,y=l*c,w=l*d,A=l*u,C=n.x,E=n.y,T=n.z;return r[0]=(1-(v+m))*C,r[1]=(f+A)*C,r[2]=(p-w)*C,r[3]=0,r[4]=(f-A)*E,r[5]=(1-(h+m))*E,r[6]=(g+y)*E,r[7]=0,r[8]=(p+w)*T,r[9]=(g-y)*T,r[10]=(1-(h+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,s=od.set(r[0],r[1],r[2]).length(),o=od.set(r[4],r[5],r[6]).length(),a=od.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],us.copy(this);let c=1/s,d=1/o,u=1/a;return us.elements[0]*=c,us.elements[1]*=c,us.elements[2]*=c,us.elements[4]*=d,us.elements[5]*=d,us.elements[6]*=d,us.elements[8]*=u,us.elements[9]*=u,us.elements[10]*=u,t.setFromRotationMatrix(us),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=So){let l=this.elements,c=2*s/(t-e),d=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),f,p;if(a===So)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===Kg)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=d,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=So){let l=this.elements,c=1/(t-e),d=1/(n-r),u=1/(o-s),h=(t+e)*c,f=(n+r)*d,p,v;if(a===So)p=(o+s)*u,v=-2*u;else if(a===Kg)p=s*u,v=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=v,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},od=new V,us=new yt,F7=new V(0,0,0),O7=new V(1,1,1),Ma=new V,bg=new V,ur=new V,zR=new yt,jR=new $i,Fl=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){let s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],u=s[9],h=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Kn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Kn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Kn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Kn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Kn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,d),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Kn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return zR.makeRotationFromQuaternion(t),this.setFromRotationMatrix(zR,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return jR.setFromEuler(this),this.setFromQuaternion(jR,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})(),Bh=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},B7=0,GR=new V,ad=new $i,xo=new yt,Ag=new V,bh=new V,V7=new V,U7=new $i,WR=new V(1,0,0),qR=new V(0,1,0),ZR=new V(0,0,1),XR={type:"added"},H7={type:"removed"},ld={type:"childadded",child:null},RA={type:"childremoved",child:null},yi=(()=>{class i extends Mo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:B7++}),this.uuid=kr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();let t=new V,n=new Fl,r=new $i,s=new V(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new yt},normalMatrix:{value:new It}}),this.matrix=new yt,this.matrixWorld=new yt,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Bh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return ad.setFromAxisAngle(t,n),this.quaternion.multiply(ad),this}rotateOnWorldAxis(t,n){return ad.setFromAxisAngle(t,n),this.quaternion.premultiply(ad),this}rotateX(t){return this.rotateOnAxis(WR,t)}rotateY(t){return this.rotateOnAxis(qR,t)}rotateZ(t){return this.rotateOnAxis(ZR,t)}translateOnAxis(t,n){return GR.copy(t).applyQuaternion(this.quaternion),this.position.add(GR.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(WR,t)}translateY(t){return this.translateOnAxis(qR,t)}translateZ(t){return this.translateOnAxis(ZR,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(xo.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Ag.copy(t):Ag.set(t,n,r);let s=this.parent;this.updateWorldMatrix(!0,!1),bh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xo.lookAt(bh,Ag,this.up):xo.lookAt(Ag,bh,this.up),this.quaternion.setFromRotationMatrix(xo),s&&(xo.extractRotation(s.matrixWorld),ad.setFromRotationMatrix(xo),this.quaternion.premultiply(ad.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(XR),ld.child=t,this.dispatchEvent(ld),ld.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(H7),RA.child=t,this.dispatchEvent(RA),RA.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),xo.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),xo.multiply(t.parent.matrixWorld)),t.applyMatrix4(xo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(XR),ld.child=t,this.dispatchEvent(ld),ld.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(t,n);if(a!==void 0)return a}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bh,t,V7),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bh,U7,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){let n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){let r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){let n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);let l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){let c=l.shapes;if(Array.isArray(c))for(let d=0,u=c.length;d<u;d++){let h=c[d];o(t.shapes,h)}else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){let c=this.animations[l];s.animations.push(o(t.animations,c))}}if(n){let l=a(t.geometries),c=a(t.materials),d=a(t.textures),u=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),v=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),u.length>0&&(r.images=u),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(l){let c=[];for(let d in l){let u=l[d];delete u.metadata,c.push(u)}return c}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){let s=t.children[r];this.add(s.clone())}return this}}return i.DEFAULT_UP=new V(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})(),hs=new V,wo=new V,LA=new V,yo=new V,cd=new V,dd=new V,YR=new V,kA=new V,NA=new V,FA=new V,OA=new Jt,BA=new Jt,VA=new Jt,Rl=class i{constructor(e=new V,t=new V,n=new V){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),hs.subVectors(e,t),r.cross(hs);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){hs.subVectors(r,t),wo.subVectors(n,t),LA.subVectors(e,t);let o=hs.dot(hs),a=hs.dot(wo),l=hs.dot(LA),c=wo.dot(wo),d=wo.dot(LA),u=o*c-a*a;if(u===0)return s.set(0,0,0),null;let h=1/u,f=(c*l-a*d)*h,p=(o*d-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,yo)===null?!1:yo.x>=0&&yo.y>=0&&yo.x+yo.y<=1}static getInterpolation(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,yo)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,yo.x),l.addScaledVector(o,yo.y),l.addScaledVector(a,yo.z),l)}static getInterpolatedAttribute(e,t,n,r,s,o){return OA.setScalar(0),BA.setScalar(0),VA.setScalar(0),OA.fromBufferAttribute(e,t),BA.fromBufferAttribute(e,n),VA.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(OA,s.x),o.addScaledVector(BA,s.y),o.addScaledVector(VA,s.z),o}static isFrontFacing(e,t,n,r){return hs.subVectors(n,t),wo.subVectors(e,t),hs.cross(wo).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return hs.subVectors(this.c,this.b),wo.subVectors(this.a,this.b),hs.cross(wo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return i.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return i.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,s=this.c,o,a;cd.subVectors(r,n),dd.subVectors(s,n),kA.subVectors(e,n);let l=cd.dot(kA),c=dd.dot(kA);if(l<=0&&c<=0)return t.copy(n);NA.subVectors(e,r);let d=cd.dot(NA),u=dd.dot(NA);if(d>=0&&u<=d)return t.copy(r);let h=l*u-d*c;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(n).addScaledVector(cd,o);FA.subVectors(e,s);let f=cd.dot(FA),p=dd.dot(FA);if(p>=0&&f<=p)return t.copy(s);let v=f*c-l*p;if(v<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(n).addScaledVector(dd,a);let g=d*p-f*u;if(g<=0&&u-d>=0&&f-p>=0)return YR.subVectors(s,r),a=(u-d)/(u-d+(f-p)),t.copy(r).addScaledVector(YR,a);let m=1/(g+v+h);return o=v*m,a=h*m,t.copy(n).addScaledVector(cd,o).addScaledVector(dd,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},dk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ta={h:0,s:0,l:0},_g={h:0,s:0,l:0};function UA(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var ft=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ut.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=Ut.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ut.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=Ut.workingColorSpace){if(e=N_(e,1),t=Kn(t,0,1),n=Kn(n,0,1),t===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=UA(o,s,e+1/3),this.g=UA(o,s,e),this.b=UA(o,s,e-1/3)}return Ut.toWorkingColorSpace(this,r),this}setStyle(e,t=fi){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fi){let n=dk[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Eo(e.r),this.g=Eo(e.g),this.b=Eo(e.b),this}copyLinearToSRGB(e){return this.r=bd(e.r),this.g=bd(e.g),this.b=bd(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fi){return Ut.fromWorkingColorSpace(Ei.copy(this),e),Math.round(Kn(Ei.r*255,0,255))*65536+Math.round(Kn(Ei.g*255,0,255))*256+Math.round(Kn(Ei.b*255,0,255))}getHexString(e=fi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ut.workingColorSpace){Ut.fromWorkingColorSpace(Ei.copy(this),t);let n=Ei.r,r=Ei.g,s=Ei.b,o=Math.max(n,r,s),a=Math.min(n,r,s),l,c,d=(a+o)/2;if(a===o)l=0,c=0;else{let u=o-a;switch(c=d<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Ut.workingColorSpace){return Ut.fromWorkingColorSpace(Ei.copy(this),t),e.r=Ei.r,e.g=Ei.g,e.b=Ei.b,e}getStyle(e=fi){Ut.fromWorkingColorSpace(Ei.copy(this),e);let t=Ei.r,n=Ei.g,r=Ei.b;return e!==fi?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Ta),this.setHSL(Ta.h+e,Ta.s+t,Ta.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Ta),e.getHSL(_g);let n=Ph(Ta.h,_g.h,t),r=Ph(Ta.s,_g.s,t),s=Ph(Ta.l,_g.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},Ei=new ft;ft.NAMES=dk;var z7=0,Mn=class extends Mo{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:z7++}),this.uuid=kr(),this.name="",this.blending=wd,this.side=Us,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=r1,this.blendDst=s1,this.blendEquation=Pl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ft(0,0,0),this.blendAlpha=0,this.depthFunc=Ed,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=RR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=td,this.stencilZFail=td,this.stencilZPass=td,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==wd&&(n.blending=this.blending),this.side!==Us&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==r1&&(n.blendSrc=this.blendSrc),this.blendDst!==s1&&(n.blendDst=this.blendDst),this.blendEquation!==Pl&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Ed&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==RR&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==td&&(n.stencilFail=this.stencilFail),this.stencilZFail!==td&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==td&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){let o=[];for(let a in s){let l=s[a];delete l.metadata,o.push(l)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},yn=class extends Mn{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Fl,this.combine=QL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var Wn=new V,Sg=new ye,Jn=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=H1,this.updateRanges=[],this.gpuType=gs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Sg.fromBufferAttribute(this,t),Sg.applyMatrix3(e),this.setXY(t,Sg.x,Sg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Wn.fromBufferAttribute(this,t),Wn.applyMatrix3(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Wn.fromBufferAttribute(this,t),Wn.applyMatrix4(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Wn.fromBufferAttribute(this,t),Wn.applyNormalMatrix(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Wn.fromBufferAttribute(this,t),Wn.transformDirection(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ms(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=on(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ms(t,this.array)),t}setX(e,t){return this.normalized&&(t=on(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ms(t,this.array)),t}setY(e,t){return this.normalized&&(t=on(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ms(t,this.array)),t}setZ(e,t){return this.normalized&&(t=on(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ms(t,this.array)),t}setW(e,t){return this.normalized&&(t=on(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=on(t,this.array),n=on(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=on(t,this.array),n=on(n,this.array),r=on(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=on(t,this.array),n=on(n,this.array),r=on(r,this.array),s=on(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==H1&&(e.usage=this.usage),e}};var e0=class extends Jn{constructor(e,t,n){super(new Uint16Array(e),t,n)}};var t0=class extends Jn{constructor(e,t,n){super(new Uint32Array(e),t,n)}};var Ji=class extends Jn{constructor(e,t,n){super(new Float32Array(e),t,n)}},j7=0,Rr=new yt,HA=new yi,ud=new V,hr=new Nr,Ah=new Nr,hi=new V,pr=class i extends Mo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:j7++}),this.uuid=kr(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ck(e)?t0:e0)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let s=new It().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rr.makeRotationFromQuaternion(e),this.applyMatrix4(Rr),this}rotateX(e){return Rr.makeRotationX(e),this.applyMatrix4(Rr),this}rotateY(e){return Rr.makeRotationY(e),this.applyMatrix4(Rr),this}rotateZ(e){return Rr.makeRotationZ(e),this.applyMatrix4(Rr),this}translate(e,t,n){return Rr.makeTranslation(e,t,n),this.applyMatrix4(Rr),this}scale(e,t,n){return Rr.makeScale(e,t,n),this.applyMatrix4(Rr),this}lookAt(e){return HA.lookAt(e),HA.updateMatrix(),this.applyMatrix4(HA.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ud).negate(),this.translate(ud.x,ud.y,ud.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let n=[];for(let r=0,s=e.length;r<s;r++){let o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Ji(n,3))}else{for(let n=0,r=t.count;n<r;n++){let s=e[n];t.setXYZ(n,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Nr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let s=t[n];hr.setFromBufferAttribute(s),this.morphTargetsRelative?(hi.addVectors(this.boundingBox.min,hr.min),this.boundingBox.expandByPoint(hi),hi.addVectors(this.boundingBox.max,hr.max),this.boundingBox.expandByPoint(hi)):(this.boundingBox.expandByPoint(hr.min),this.boundingBox.expandByPoint(hr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new fr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new V,1/0);return}if(e){let n=this.boundingSphere.center;if(hr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];Ah.setFromBufferAttribute(a),this.morphTargetsRelative?(hi.addVectors(hr.min,Ah.min),hr.expandByPoint(hi),hi.addVectors(hr.max,Ah.max),hr.expandByPoint(hi)):(hr.expandByPoint(Ah.min),hr.expandByPoint(Ah.max))}hr.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)hi.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(hi));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)hi.fromBufferAttribute(a,c),l&&(ud.fromBufferAttribute(e,c),hi.add(ud)),r=Math.max(r,n.distanceToSquared(hi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Jn(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),a=[],l=[];for(let L=0;L<n.count;L++)a[L]=new V,l[L]=new V;let c=new V,d=new V,u=new V,h=new ye,f=new ye,p=new ye,v=new V,g=new V;function m(L,S,_){c.fromBufferAttribute(n,L),d.fromBufferAttribute(n,S),u.fromBufferAttribute(n,_),h.fromBufferAttribute(s,L),f.fromBufferAttribute(s,S),p.fromBufferAttribute(s,_),d.sub(c),u.sub(c),f.sub(h),p.sub(h);let P=1/(f.x*p.y-p.x*f.y);isFinite(P)&&(v.copy(d).multiplyScalar(p.y).addScaledVector(u,-f.y).multiplyScalar(P),g.copy(u).multiplyScalar(f.x).addScaledVector(d,-p.x).multiplyScalar(P),a[L].add(v),a[S].add(v),a[_].add(v),l[L].add(g),l[S].add(g),l[_].add(g))}let y=this.groups;y.length===0&&(y=[{start:0,count:e.count}]);for(let L=0,S=y.length;L<S;++L){let _=y[L],P=_.start,U=_.count;for(let O=P,z=P+U;O<z;O+=3)m(e.getX(O+0),e.getX(O+1),e.getX(O+2))}let w=new V,A=new V,C=new V,E=new V;function T(L){C.fromBufferAttribute(r,L),E.copy(C);let S=a[L];w.copy(S),w.sub(C.multiplyScalar(C.dot(S))).normalize(),A.crossVectors(E,S);let P=A.dot(l[L])<0?-1:1;o.setXYZW(L,w.x,w.y,w.z,P)}for(let L=0,S=y.length;L<S;++L){let _=y[L],P=_.start,U=_.count;for(let O=P,z=P+U;O<z;O+=3)T(e.getX(O+0)),T(e.getX(O+1)),T(e.getX(O+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Jn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let h=0,f=n.count;h<f;h++)n.setXYZ(h,0,0,0);let r=new V,s=new V,o=new V,a=new V,l=new V,c=new V,d=new V,u=new V;if(e)for(let h=0,f=e.count;h<f;h+=3){let p=e.getX(h+0),v=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,g),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,v),c.fromBufferAttribute(n,g),a.add(d),l.add(d),c.add(d),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(v,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),d.subVectors(o,s),u.subVectors(r,s),d.cross(u),n.setXYZ(h+0,d.x,d.y,d.z),n.setXYZ(h+1,d.x,d.y,d.z),n.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)hi.fromBufferAttribute(e,t),hi.normalize(),e.setXYZ(t,hi.x,hi.y,hi.z)}toNonIndexed(){function e(a,l){let c=a.array,d=a.itemSize,u=a.normalized,h=new c.constructor(l.length*d),f=0,p=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*d;for(let m=0;m<d;m++)h[p++]=c[f++]}return new Jn(h,d,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new i,n=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=e(l,n);t.setAttribute(a,c)}let s=this.morphAttributes;for(let a in s){let l=[],c=s[a];for(let d=0,u=c.length;d<u;d++){let h=c[d],f=e(h,n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let l in n){let c=n[l];e.data.attributes[l]=c.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],d=[];for(let u=0,h=c.length;u<h;u++){let f=c[u];d.push(f.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let c in r){let d=r[c];this.setAttribute(c,d.clone(t))}let s=e.morphAttributes;for(let c in s){let d=[],u=s[c];for(let h=0,f=u.length;h<f;h++)d.push(u[h].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,d=o.length;c<d;c++){let u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},QR=new yt,Cl=new Io,Eg=new fr,KR=new V,Cg=new V,Mg=new V,Tg=new V,zA=new V,Ig=new V,JR=new V,Dg=new V,Ht=class extends yi{constructor(e=new pr,t=new yn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){Ig.set(0,0,0);for(let l=0,c=s.length;l<c;l++){let d=a[l],u=s[l];d!==0&&(zA.fromBufferAttribute(u,e),o?Ig.addScaledVector(zA,d):Ig.addScaledVector(zA.sub(t),d))}t.add(Ig)}return t}raycast(e,t){let n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Eg.copy(n.boundingSphere),Eg.applyMatrix4(s),Cl.copy(e.ray).recast(e.near),!(Eg.containsPoint(Cl.origin)===!1&&(Cl.intersectSphere(Eg,KR)===null||Cl.origin.distanceToSquared(KR)>(e.far-e.near)**2))&&(QR.copy(s).invert(),Cl.copy(e.ray).applyMatrix4(QR),!(n.boundingBox!==null&&Cl.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Cl)))}_computeIntersections(e,t,n){let r,s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,u=s.attributes.normal,h=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){let g=h[p],m=o[g.materialIndex],y=Math.max(g.start,f.start),w=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));for(let A=y,C=w;A<C;A+=3){let E=a.getX(A),T=a.getX(A+1),L=a.getX(A+2);r=Pg(this,m,e,n,c,d,u,E,T,L),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let p=Math.max(0,f.start),v=Math.min(a.count,f.start+f.count);for(let g=p,m=v;g<m;g+=3){let y=a.getX(g),w=a.getX(g+1),A=a.getX(g+2);r=Pg(this,o,e,n,c,d,u,y,w,A),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){let g=h[p],m=o[g.materialIndex],y=Math.max(g.start,f.start),w=Math.min(l.count,Math.min(g.start+g.count,f.start+f.count));for(let A=y,C=w;A<C;A+=3){let E=A,T=A+1,L=A+2;r=Pg(this,m,e,n,c,d,u,E,T,L),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let p=Math.max(0,f.start),v=Math.min(l.count,f.start+f.count);for(let g=p,m=v;g<m;g+=3){let y=g,w=g+1,A=g+2;r=Pg(this,o,e,n,c,d,u,y,w,A),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}}};function G7(i,e,t,n,r,s,o,a){let l;if(e.side===Ki?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Us,a),l===null)return null;Dg.copy(a),Dg.applyMatrix4(i.matrixWorld);let c=t.ray.origin.distanceTo(Dg);return c<t.near||c>t.far?null:{distance:c,point:Dg.clone(),object:i}}function Pg(i,e,t,n,r,s,o,a,l,c){i.getVertexPosition(a,Cg),i.getVertexPosition(l,Mg),i.getVertexPosition(c,Tg);let d=G7(i,e,t,n,Cg,Mg,Tg,JR);if(d){let u=new V;Rl.getBarycoord(JR,Cg,Mg,Tg,u),r&&(d.uv=Rl.getInterpolatedAttribute(r,a,l,c,u,new ye)),s&&(d.uv1=Rl.getInterpolatedAttribute(s,a,l,c,u,new ye)),o&&(d.normal=Rl.getInterpolatedAttribute(o,a,l,c,u,new V),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));let h={a,b:l,c,normal:new V,materialIndex:0};Rl.getNormal(Cg,Mg,Tg,h.normal),d.face=h,d.barycoord=u}return d}var Do=class i extends pr{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let l=[],c=[],d=[],u=[],h=0,f=0;p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Ji(c,3)),this.setAttribute("normal",new Ji(d,3)),this.setAttribute("uv",new Ji(u,2));function p(v,g,m,y,w,A,C,E,T,L,S){let _=A/T,P=C/L,U=A/2,O=C/2,z=E/2,q=T+1,Q=L+1,K=0,W=0,Ee=new V;for(let Te=0;Te<Q;Te++){let ke=Te*P-O;for(let We=0;We<q;We++){let at=We*_-U;Ee[v]=at*y,Ee[g]=ke*w,Ee[m]=z,c.push(Ee.x,Ee.y,Ee.z),Ee[v]=0,Ee[g]=0,Ee[m]=E>0?1:-1,d.push(Ee.x,Ee.y,Ee.z),u.push(We/T),u.push(1-Te/L),K+=1}}for(let Te=0;Te<L;Te++)for(let ke=0;ke<T;ke++){let We=h+ke+q*Te,at=h+ke+q*(Te+1),se=h+(ke+1)+q*(Te+1),xe=h+(ke+1)+q*Te;l.push(We,at,xe),l.push(at,se,xe),W+=6}a.addGroup(f,W,S),f+=W,h+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Ld(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Vi(i){let e={};for(let t=0;t<i.length;t++){let n=Ld(i[t]);for(let r in n)e[r]=n[r]}return e}function W7(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function uk(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ut.workingColorSpace}var q7={clone:Ld,merge:Vi},Z7=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,X7=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Hs=class extends Mn{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Z7,this.fragmentShader=X7,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ld(e.uniforms),this.uniformsGroups=W7(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},n0=class extends yi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new yt,this.projectionMatrix=new yt,this.projectionMatrixInverse=new yt,this.coordinateSystem=So}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Ia=new V,$R=new ye,eL=new ye,Fn=class extends n0{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Rd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Dh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Rd*2*Math.atan(Math.tan(Dh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Ia.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Ia.x,Ia.y).multiplyScalar(-e/Ia.z),Ia.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ia.x,Ia.y).multiplyScalar(-e/Ia.z)}getViewSize(e,t){return this.getViewBounds(e,$R,eL),t.subVectors(eL,$R)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Dh*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},hd=-90,fd=1,W1=class extends yi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Fn(hd,fd,e,t);r.layers=this.layers,this.add(r);let s=new Fn(hd,fd,e,t);s.layers=this.layers,this.add(s);let o=new Fn(hd,fd,e,t);o.layers=this.layers,this.add(o);let a=new Fn(hd,fd,e,t);a.layers=this.layers,this.add(a);let l=new Fn(hd,fd,e,t);l.layers=this.layers,this.add(l);let c=new Fn(hd,fd,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,l]=t;for(let c of t)this.remove(c);if(e===So)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Kg)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,l,c,d]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;let v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,c),n.texture.generateMipmaps=v,e.setRenderTarget(n,5,r),e.render(t,d),e.setRenderTarget(u,h,f),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}},i0=class extends Br{constructor(e,t,n,r,s,o,a,l,c,d){e=e!==void 0?e:[],t=t!==void 0?t:Cd,super(e,t,n,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},q1=class extends To{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new i0(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Qi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Do(5,5,5),s=new Hs({name:"CubemapFromEquirect",uniforms:Ld(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ki,blending:Ra});s.uniforms.tEquirect.value=t;let o=new Ht(r,s),a=t.minFilter;return t.minFilter===Bs&&(t.minFilter=Qi),new W1(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}},jA=new V,Y7=new V,Q7=new It,fs=class{constructor(e=new V(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=jA.subVectors(n,t).cross(Y7.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(jA),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||Q7.getNormalMatrix(e),r=this.coplanarPoint(jA).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ml=new fr,Rg=new V,Vh=class{constructor(e=new fs,t=new fs,n=new fs,r=new fs,s=new fs,o=new fs){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=So){let n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],d=r[5],u=r[6],h=r[7],f=r[8],p=r[9],v=r[10],g=r[11],m=r[12],y=r[13],w=r[14],A=r[15];if(n[0].setComponents(l-s,h-c,g-f,A-m).normalize(),n[1].setComponents(l+s,h+c,g+f,A+m).normalize(),n[2].setComponents(l+o,h+d,g+p,A+y).normalize(),n[3].setComponents(l-o,h-d,g-p,A-y).normalize(),n[4].setComponents(l-a,h-u,g-v,A-w).normalize(),t===So)n[5].setComponents(l+a,h+u,g+v,A+w).normalize();else if(t===Kg)n[5].setComponents(a,u,v,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ml.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Ml.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ml)}intersectsSprite(e){return Ml.center.set(0,0,0),Ml.radius=.7071067811865476,Ml.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ml)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(Rg.x=r.normal.x>0?e.max.x:e.min.x,Rg.y=r.normal.y>0?e.max.y:e.min.y,Rg.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Rg)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function hk(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function K7(i){let e=new WeakMap;function t(a,l){let c=a.array,d=a.usage,u=c.byteLength,h=i.createBuffer();i.bindBuffer(l,h),i.bufferData(l,c,d),a.onUploadCallback();let f;if(c instanceof Float32Array)f=i.FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?f=i.HALF_FLOAT:f=i.UNSIGNED_SHORT;else if(c instanceof Int16Array)f=i.SHORT;else if(c instanceof Uint32Array)f=i.UNSIGNED_INT;else if(c instanceof Int32Array)f=i.INT;else if(c instanceof Int8Array)f=i.BYTE;else if(c instanceof Uint8Array)f=i.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)f=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:f,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:u}}function n(a,l,c){let d=l.array,u=l.updateRanges;if(i.bindBuffer(c,a),u.length===0)i.bufferSubData(c,0,d);else{u.sort((f,p)=>f.start-p.start);let h=0;for(let f=1;f<u.length;f++){let p=u[h],v=u[f];v.start<=p.start+p.count+1?p.count=Math.max(p.count,v.start+v.count-p.start):(++h,u[h]=v)}u.length=h+1;for(let f=0,p=u.length;f<p;f++){let v=u[f];i.bufferSubData(c,v.start*d.BYTES_PER_ELEMENT,d,v.start,v.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let l=e.get(a);l&&(i.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let d=e.get(a);(!d||d.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let c=e.get(a);if(c===void 0)e.set(a,t(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,a,l),c.version=a.version}}return{get:r,remove:s,update:o}}var r0=class i extends pr{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,d=l+1,u=e/a,h=t/l,f=[],p=[],v=[],g=[];for(let m=0;m<d;m++){let y=m*h-o;for(let w=0;w<c;w++){let A=w*u-s;p.push(A,-y,0),v.push(0,0,1),g.push(w/a),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let y=0;y<a;y++){let w=y+c*m,A=y+c*(m+1),C=y+1+c*(m+1),E=y+1+c*m;f.push(w,A,E),f.push(A,C,E)}this.setIndex(f),this.setAttribute("position",new Ji(p,3)),this.setAttribute("normal",new Ji(v,3)),this.setAttribute("uv",new Ji(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.widthSegments,e.heightSegments)}},J7=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,$7=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,e9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,t9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,n9=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,i9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,r9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,s9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,o9=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,a9=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,l9=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,c9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,d9=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,u9=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,h9=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,f9=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,p9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,m9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,g9=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,v9=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,x9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,w9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,y9=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,b9=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,A9=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,_9=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,S9=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,E9=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,C9=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,M9=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,T9="gl_FragColor = linearToOutputTexel( gl_FragColor );",I9=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,D9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,P9=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,R9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,L9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,k9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,N9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,F9=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,O9=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,B9=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,V9=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,U9=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,H9=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,z9=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,j9=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,G9=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,W9=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,q9=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Z9=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,X9=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Y9=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Q9=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,K9=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,J9=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,$9=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,ej=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tj=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nj=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ij=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,rj=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sj=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,oj=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aj=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lj=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cj=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dj=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,uj=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,hj=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,fj=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,pj=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,mj=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,gj=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,vj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,xj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wj=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,yj=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,bj=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Aj=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,_j=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Sj=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Ej=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Cj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Mj=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Tj=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Ij=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Dj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Pj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Rj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Lj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,kj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Nj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Fj=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Oj=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Bj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Vj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Uj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Hj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,zj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,jj=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Gj=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Wj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,qj=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Zj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Xj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Yj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Qj=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Kj=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Jj=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$j=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,eG=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nG=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,rG=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,sG=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,oG=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,aG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,lG=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cG=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dG=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,hG=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fG=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pG=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mG=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,gG=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vG=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,xG=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,wG=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yG=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bG=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,AG=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_G=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,SG=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EG=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,CG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,MG=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TG=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,IG=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,DG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pt={alphahash_fragment:J7,alphahash_pars_fragment:$7,alphamap_fragment:e9,alphamap_pars_fragment:t9,alphatest_fragment:n9,alphatest_pars_fragment:i9,aomap_fragment:r9,aomap_pars_fragment:s9,batching_pars_vertex:o9,batching_vertex:a9,begin_vertex:l9,beginnormal_vertex:c9,bsdfs:d9,iridescence_fragment:u9,bumpmap_pars_fragment:h9,clipping_planes_fragment:f9,clipping_planes_pars_fragment:p9,clipping_planes_pars_vertex:m9,clipping_planes_vertex:g9,color_fragment:v9,color_pars_fragment:x9,color_pars_vertex:w9,color_vertex:y9,common:b9,cube_uv_reflection_fragment:A9,defaultnormal_vertex:_9,displacementmap_pars_vertex:S9,displacementmap_vertex:E9,emissivemap_fragment:C9,emissivemap_pars_fragment:M9,colorspace_fragment:T9,colorspace_pars_fragment:I9,envmap_fragment:D9,envmap_common_pars_fragment:P9,envmap_pars_fragment:R9,envmap_pars_vertex:L9,envmap_physical_pars_fragment:G9,envmap_vertex:k9,fog_vertex:N9,fog_pars_vertex:F9,fog_fragment:O9,fog_pars_fragment:B9,gradientmap_pars_fragment:V9,lightmap_pars_fragment:U9,lights_lambert_fragment:H9,lights_lambert_pars_fragment:z9,lights_pars_begin:j9,lights_toon_fragment:W9,lights_toon_pars_fragment:q9,lights_phong_fragment:Z9,lights_phong_pars_fragment:X9,lights_physical_fragment:Y9,lights_physical_pars_fragment:Q9,lights_fragment_begin:K9,lights_fragment_maps:J9,lights_fragment_end:$9,logdepthbuf_fragment:ej,logdepthbuf_pars_fragment:tj,logdepthbuf_pars_vertex:nj,logdepthbuf_vertex:ij,map_fragment:rj,map_pars_fragment:sj,map_particle_fragment:oj,map_particle_pars_fragment:aj,metalnessmap_fragment:lj,metalnessmap_pars_fragment:cj,morphinstance_vertex:dj,morphcolor_vertex:uj,morphnormal_vertex:hj,morphtarget_pars_vertex:fj,morphtarget_vertex:pj,normal_fragment_begin:mj,normal_fragment_maps:gj,normal_pars_fragment:vj,normal_pars_vertex:xj,normal_vertex:wj,normalmap_pars_fragment:yj,clearcoat_normal_fragment_begin:bj,clearcoat_normal_fragment_maps:Aj,clearcoat_pars_fragment:_j,iridescence_pars_fragment:Sj,opaque_fragment:Ej,packing:Cj,premultiplied_alpha_fragment:Mj,project_vertex:Tj,dithering_fragment:Ij,dithering_pars_fragment:Dj,roughnessmap_fragment:Pj,roughnessmap_pars_fragment:Rj,shadowmap_pars_fragment:Lj,shadowmap_pars_vertex:kj,shadowmap_vertex:Nj,shadowmask_pars_fragment:Fj,skinbase_vertex:Oj,skinning_pars_vertex:Bj,skinning_vertex:Vj,skinnormal_vertex:Uj,specularmap_fragment:Hj,specularmap_pars_fragment:zj,tonemapping_fragment:jj,tonemapping_pars_fragment:Gj,transmission_fragment:Wj,transmission_pars_fragment:qj,uv_pars_fragment:Zj,uv_pars_vertex:Xj,uv_vertex:Yj,worldpos_vertex:Qj,background_vert:Kj,background_frag:Jj,backgroundCube_vert:$j,backgroundCube_frag:eG,cube_vert:tG,cube_frag:nG,depth_vert:iG,depth_frag:rG,distanceRGBA_vert:sG,distanceRGBA_frag:oG,equirect_vert:aG,equirect_frag:lG,linedashed_vert:cG,linedashed_frag:dG,meshbasic_vert:uG,meshbasic_frag:hG,meshlambert_vert:fG,meshlambert_frag:pG,meshmatcap_vert:mG,meshmatcap_frag:gG,meshnormal_vert:vG,meshnormal_frag:xG,meshphong_vert:wG,meshphong_frag:yG,meshphysical_vert:bG,meshphysical_frag:AG,meshtoon_vert:_G,meshtoon_frag:SG,points_vert:EG,points_frag:CG,shadow_vert:MG,shadow_frag:TG,sprite_vert:IG,sprite_frag:DG},Ie={common:{diffuse:{value:new ft(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new It},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new It}},envmap:{envMap:{value:null},envMapRotation:{value:new It},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new It}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new It}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new It},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new It},normalScale:{value:new ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new It},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new It}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new It}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new It}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0},uvTransform:{value:new It}},sprite:{diffuse:{value:new ft(16777215)},opacity:{value:1},center:{value:new ye(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new It},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0}}},Os={basic:{uniforms:Vi([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.fog]),vertexShader:Pt.meshbasic_vert,fragmentShader:Pt.meshbasic_frag},lambert:{uniforms:Vi([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,Ie.lights,{emissive:{value:new ft(0)}}]),vertexShader:Pt.meshlambert_vert,fragmentShader:Pt.meshlambert_frag},phong:{uniforms:Vi([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,Ie.lights,{emissive:{value:new ft(0)},specular:{value:new ft(1118481)},shininess:{value:30}}]),vertexShader:Pt.meshphong_vert,fragmentShader:Pt.meshphong_frag},standard:{uniforms:Vi([Ie.common,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.roughnessmap,Ie.metalnessmap,Ie.fog,Ie.lights,{emissive:{value:new ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag},toon:{uniforms:Vi([Ie.common,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.gradientmap,Ie.fog,Ie.lights,{emissive:{value:new ft(0)}}]),vertexShader:Pt.meshtoon_vert,fragmentShader:Pt.meshtoon_frag},matcap:{uniforms:Vi([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,{matcap:{value:null}}]),vertexShader:Pt.meshmatcap_vert,fragmentShader:Pt.meshmatcap_frag},points:{uniforms:Vi([Ie.points,Ie.fog]),vertexShader:Pt.points_vert,fragmentShader:Pt.points_frag},dashed:{uniforms:Vi([Ie.common,Ie.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pt.linedashed_vert,fragmentShader:Pt.linedashed_frag},depth:{uniforms:Vi([Ie.common,Ie.displacementmap]),vertexShader:Pt.depth_vert,fragmentShader:Pt.depth_frag},normal:{uniforms:Vi([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,{opacity:{value:1}}]),vertexShader:Pt.meshnormal_vert,fragmentShader:Pt.meshnormal_frag},sprite:{uniforms:Vi([Ie.sprite,Ie.fog]),vertexShader:Pt.sprite_vert,fragmentShader:Pt.sprite_frag},background:{uniforms:{uvTransform:{value:new It},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pt.background_vert,fragmentShader:Pt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new It}},vertexShader:Pt.backgroundCube_vert,fragmentShader:Pt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pt.cube_vert,fragmentShader:Pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pt.equirect_vert,fragmentShader:Pt.equirect_frag},distanceRGBA:{uniforms:Vi([Ie.common,Ie.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pt.distanceRGBA_vert,fragmentShader:Pt.distanceRGBA_frag},shadow:{uniforms:Vi([Ie.lights,Ie.fog,{color:{value:new ft(0)},opacity:{value:1}}]),vertexShader:Pt.shadow_vert,fragmentShader:Pt.shadow_frag}};Os.physical={uniforms:Vi([Os.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new It},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new It},clearcoatNormalScale:{value:new ye(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new It},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new It},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new It},sheen:{value:0},sheenColor:{value:new ft(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new It},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new It},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new It},transmissionSamplerSize:{value:new ye},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new It},attenuationDistance:{value:0},attenuationColor:{value:new ft(0)},specularColor:{value:new ft(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new It},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new It},anisotropyVector:{value:new ye},anisotropyMap:{value:null},anisotropyMapTransform:{value:new It}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag};var Lg={r:0,b:0,g:0},Tl=new Fl,PG=new yt;function RG(i,e,t,n,r,s,o){let a=new ft(0),l=s===!0?0:1,c,d,u=null,h=0,f=null;function p(y){let w=y.isScene===!0?y.background:null;return w&&w.isTexture&&(w=(y.backgroundBlurriness>0?t:e).get(w)),w}function v(y){let w=!1,A=p(y);A===null?m(a,l):A&&A.isColor&&(m(A,1),w=!0);let C=i.xr.getEnvironmentBlendMode();C==="additive"?n.buffers.color.setClear(0,0,0,1,o):C==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||w)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function g(y,w){let A=p(w);A&&(A.isCubeTexture||A.mapping===I0)?(d===void 0&&(d=new Ht(new Do(1,1,1),new Hs({name:"BackgroundCubeMaterial",uniforms:Ld(Os.backgroundCube.uniforms),vertexShader:Os.backgroundCube.vertexShader,fragmentShader:Os.backgroundCube.fragmentShader,side:Ki,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(C,E,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),Tl.copy(w.backgroundRotation),Tl.x*=-1,Tl.y*=-1,Tl.z*=-1,A.isCubeTexture&&A.isRenderTargetTexture===!1&&(Tl.y*=-1,Tl.z*=-1),d.material.uniforms.envMap.value=A,d.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(PG.makeRotationFromEuler(Tl)),d.material.toneMapped=Ut.getTransfer(A.colorSpace)!==an,(u!==A||h!==A.version||f!==i.toneMapping)&&(d.material.needsUpdate=!0,u=A,h=A.version,f=i.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null)):A&&A.isTexture&&(c===void 0&&(c=new Ht(new r0(2,2),new Hs({name:"BackgroundMaterial",uniforms:Ld(Os.background.uniforms),vertexShader:Os.background.vertexShader,fragmentShader:Os.background.fragmentShader,side:Us,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=A,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=Ut.getTransfer(A.colorSpace)!==an,A.matrixAutoUpdate===!0&&A.updateMatrix(),c.material.uniforms.uvTransform.value.copy(A.matrix),(u!==A||h!==A.version||f!==i.toneMapping)&&(c.material.needsUpdate=!0,u=A,h=A.version,f=i.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null))}function m(y,w){y.getRGB(Lg,uk(i)),n.buffers.color.setClear(Lg.r,Lg.g,Lg.b,w,o)}return{getClearColor:function(){return a},setClearColor:function(y,w=1){a.set(y),l=w,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,m(a,l)},render:v,addToRenderList:g}}function LG(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=h(null),s=r,o=!1;function a(_,P,U,O,z){let q=!1,Q=u(O,U,P);s!==Q&&(s=Q,c(s.object)),q=f(_,O,U,z),q&&p(_,O,U,z),z!==null&&e.update(z,i.ELEMENT_ARRAY_BUFFER),(q||o)&&(o=!1,A(_,P,U,O),z!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function l(){return i.createVertexArray()}function c(_){return i.bindVertexArray(_)}function d(_){return i.deleteVertexArray(_)}function u(_,P,U){let O=U.wireframe===!0,z=n[_.id];z===void 0&&(z={},n[_.id]=z);let q=z[P.id];q===void 0&&(q={},z[P.id]=q);let Q=q[O];return Q===void 0&&(Q=h(l()),q[O]=Q),Q}function h(_){let P=[],U=[],O=[];for(let z=0;z<t;z++)P[z]=0,U[z]=0,O[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:U,attributeDivisors:O,object:_,attributes:{},index:null}}function f(_,P,U,O){let z=s.attributes,q=P.attributes,Q=0,K=U.getAttributes();for(let W in K)if(K[W].location>=0){let Te=z[W],ke=q[W];if(ke===void 0&&(W==="instanceMatrix"&&_.instanceMatrix&&(ke=_.instanceMatrix),W==="instanceColor"&&_.instanceColor&&(ke=_.instanceColor)),Te===void 0||Te.attribute!==ke||ke&&Te.data!==ke.data)return!0;Q++}return s.attributesNum!==Q||s.index!==O}function p(_,P,U,O){let z={},q=P.attributes,Q=0,K=U.getAttributes();for(let W in K)if(K[W].location>=0){let Te=q[W];Te===void 0&&(W==="instanceMatrix"&&_.instanceMatrix&&(Te=_.instanceMatrix),W==="instanceColor"&&_.instanceColor&&(Te=_.instanceColor));let ke={};ke.attribute=Te,Te&&Te.data&&(ke.data=Te.data),z[W]=ke,Q++}s.attributes=z,s.attributesNum=Q,s.index=O}function v(){let _=s.newAttributes;for(let P=0,U=_.length;P<U;P++)_[P]=0}function g(_){m(_,0)}function m(_,P){let U=s.newAttributes,O=s.enabledAttributes,z=s.attributeDivisors;U[_]=1,O[_]===0&&(i.enableVertexAttribArray(_),O[_]=1),z[_]!==P&&(i.vertexAttribDivisor(_,P),z[_]=P)}function y(){let _=s.newAttributes,P=s.enabledAttributes;for(let U=0,O=P.length;U<O;U++)P[U]!==_[U]&&(i.disableVertexAttribArray(U),P[U]=0)}function w(_,P,U,O,z,q,Q){Q===!0?i.vertexAttribIPointer(_,P,U,z,q):i.vertexAttribPointer(_,P,U,O,z,q)}function A(_,P,U,O){v();let z=O.attributes,q=U.getAttributes(),Q=P.defaultAttributeValues;for(let K in q){let W=q[K];if(W.location>=0){let Ee=z[K];if(Ee===void 0&&(K==="instanceMatrix"&&_.instanceMatrix&&(Ee=_.instanceMatrix),K==="instanceColor"&&_.instanceColor&&(Ee=_.instanceColor)),Ee!==void 0){let Te=Ee.normalized,ke=Ee.itemSize,We=e.get(Ee);if(We===void 0)continue;let at=We.buffer,se=We.type,xe=We.bytesPerElement,Ne=se===i.INT||se===i.UNSIGNED_INT||Ee.gpuType===T_;if(Ee.isInterleavedBufferAttribute){let pe=Ee.data,je=pe.stride,dt=Ee.offset;if(pe.isInstancedInterleavedBuffer){for(let ut=0;ut<W.locationSize;ut++)m(W.location+ut,pe.meshPerAttribute);_.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let ut=0;ut<W.locationSize;ut++)g(W.location+ut);i.bindBuffer(i.ARRAY_BUFFER,at);for(let ut=0;ut<W.locationSize;ut++)w(W.location+ut,ke/W.locationSize,se,Te,je*xe,(dt+ke/W.locationSize*ut)*xe,Ne)}else{if(Ee.isInstancedBufferAttribute){for(let pe=0;pe<W.locationSize;pe++)m(W.location+pe,Ee.meshPerAttribute);_.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=Ee.meshPerAttribute*Ee.count)}else for(let pe=0;pe<W.locationSize;pe++)g(W.location+pe);i.bindBuffer(i.ARRAY_BUFFER,at);for(let pe=0;pe<W.locationSize;pe++)w(W.location+pe,ke/W.locationSize,se,Te,ke*xe,ke/W.locationSize*pe*xe,Ne)}}else if(Q!==void 0){let Te=Q[K];if(Te!==void 0)switch(Te.length){case 2:i.vertexAttrib2fv(W.location,Te);break;case 3:i.vertexAttrib3fv(W.location,Te);break;case 4:i.vertexAttrib4fv(W.location,Te);break;default:i.vertexAttrib1fv(W.location,Te)}}}}y()}function C(){L();for(let _ in n){let P=n[_];for(let U in P){let O=P[U];for(let z in O)d(O[z].object),delete O[z];delete P[U]}delete n[_]}}function E(_){if(n[_.id]===void 0)return;let P=n[_.id];for(let U in P){let O=P[U];for(let z in O)d(O[z].object),delete O[z];delete P[U]}delete n[_.id]}function T(_){for(let P in n){let U=n[P];if(U[_.id]===void 0)continue;let O=U[_.id];for(let z in O)d(O[z].object),delete O[z];delete U[_.id]}}function L(){S(),o=!0,s!==r&&(s=r,c(s.object))}function S(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:L,resetDefaultState:S,dispose:C,releaseStatesOfGeometry:E,releaseStatesOfProgram:T,initAttributes:v,enableAttribute:g,disableUnusedAttributes:y}}function kG(i,e,t){let n;function r(c){n=c}function s(c,d){i.drawArrays(n,c,d),t.update(d,n,1)}function o(c,d,u){u!==0&&(i.drawArraysInstanced(n,c,d,u),t.update(d,n,u))}function a(c,d,u){if(u===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,d,0,u);let f=0;for(let p=0;p<u;p++)f+=d[p];t.update(f,n,1)}function l(c,d,u,h){if(u===0)return;let f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<c.length;p++)o(c[p],d[p],h[p]);else{f.multiDrawArraysInstancedWEBGL(n,c,0,d,0,h,0,u);let p=0;for(let v=0;v<u;v++)p+=d[v]*h[v];t.update(p,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function NG(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let T=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(T){return!(T!==Lr&&n.convert(T)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(T){let L=T===Jh&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(T!==Co&&n.convert(T)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&T!==gs&&!L)}function l(T){if(T==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp",d=l(c);d!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);let u=t.logarithmicDepthBuffer===!0,h=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),f=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),p=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=i.getParameter(i.MAX_TEXTURE_SIZE),g=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),m=i.getParameter(i.MAX_VERTEX_ATTRIBS),y=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),w=i.getParameter(i.MAX_VARYING_VECTORS),A=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),C=p>0,E=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:u,reverseDepthBuffer:h,maxTextures:f,maxVertexTextures:p,maxTextureSize:v,maxCubemapSize:g,maxAttributes:m,maxVertexUniforms:y,maxVaryings:w,maxFragmentUniforms:A,vertexTextures:C,maxSamples:E}}function FG(i){let e=this,t=null,n=0,r=!1,s=!1,o=new fs,a=new It,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){let f=u.length!==0||h||n!==0||r;return r=h,n=u.length,f},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,h){t=d(u,h,0)},this.setState=function(u,h,f){let p=u.clippingPlanes,v=u.clipIntersection,g=u.clipShadows,m=i.get(u);if(!r||p===null||p.length===0||s&&!g)s?d(null):c();else{let y=s?0:n,w=y*4,A=m.clippingState||null;l.value=A,A=d(p,h,w,f);for(let C=0;C!==w;++C)A[C]=t[C];m.clippingState=A,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(u,h,f,p){let v=u!==null?u.length:0,g=null;if(v!==0){if(g=l.value,p!==!0||g===null){let m=f+v*4,y=h.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<m)&&(g=new Float32Array(m));for(let w=0,A=f;w!==v;++w,A+=4)o.copy(u[w]).applyMatrix4(y,a),o.normal.toArray(g,A),g[A+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function OG(i){let e=new WeakMap;function t(o,a){return a===f1?o.mapping=Cd:a===p1&&(o.mapping=Md),o}function n(o){if(o&&o.isTexture){let a=o.mapping;if(a===f1||a===p1)if(e.has(o)){let l=e.get(o).texture;return t(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new q1(l.height);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var kd=class extends n0{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=n-e,o=n+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},vd=4,tL=[.125,.215,.35,.446,.526,.582],Ll=20,GA=new kd,nL=new ft,WA=null,qA=0,ZA=0,XA=!1,Dl=(1+Math.sqrt(5))/2,pd=1/Dl,iL=[new V(-Dl,pd,0),new V(Dl,pd,0),new V(-pd,0,Dl),new V(pd,0,Dl),new V(0,Dl,-pd),new V(0,Dl,pd),new V(-1,1,-1),new V(1,1,-1),new V(-1,1,1),new V(1,1,1)],s0=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){WA=this._renderer.getRenderTarget(),qA=this._renderer.getActiveCubeFace(),ZA=this._renderer.getActiveMipmapLevel(),XA=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=oL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=sL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(WA,qA,ZA),this._renderer.xr.enabled=XA,e.scissorTest=!1,kg(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Cd||e.mapping===Md?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),WA=this._renderer.getRenderTarget(),qA=this._renderer.getActiveCubeFace(),ZA=this._renderer.getActiveMipmapLevel(),XA=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Qi,minFilter:Qi,generateMipmaps:!1,type:Jh,format:Lr,colorSpace:Mi,depthBuffer:!1},r=rL(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=rL(e,t,n);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=BG(s)),this._blurMaterial=VG(s,e,t)}return r}_compileMaterial(e){let t=new Ht(this._lodPlanes[0],e);this._renderer.compile(t,GA)}_sceneToCubeUV(e,t,n,r){let a=new Fn(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,u=d.autoClear,h=d.toneMapping;d.getClearColor(nL),d.toneMapping=La,d.autoClear=!1;let f=new yn({name:"PMREM.Background",side:Ki,depthWrite:!1,depthTest:!1}),p=new Ht(new Do,f),v=!1,g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,v=!0):(f.color.copy(nL),v=!0);for(let m=0;m<6;m++){let y=m%3;y===0?(a.up.set(0,l[m],0),a.lookAt(c[m],0,0)):y===1?(a.up.set(0,0,l[m]),a.lookAt(0,c[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,c[m]));let w=this._cubeSize;kg(r,y*w,m>2?w:0,w,w),d.setRenderTarget(r),v&&d.render(p,a),d.render(e,a)}p.geometry.dispose(),p.material.dispose(),d.toneMapping=h,d.autoClear=u,e.background=g}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===Cd||e.mapping===Md;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=oL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=sL());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ht(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let l=this._cubeSize;kg(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,GA)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let s=1;s<r;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=iL[(r-s-1)%iL.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){let l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let d=3,u=new Ht(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Ll-1),v=s/p,g=isFinite(s)?1+Math.floor(d*v):Ll;g>Ll&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Ll}`);let m=[],y=0;for(let T=0;T<Ll;++T){let L=T/v,S=Math.exp(-L*L/2);m.push(S),T===0?y+=S:T<g&&(y+=2*S)}for(let T=0;T<m.length;T++)m[T]=m[T]/y;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:w}=this;h.dTheta.value=p,h.mipInt.value=w-n;let A=this._sizeLods[r],C=3*A*(r>w-vd?r-w+vd:0),E=4*(this._cubeSize-A);kg(t,C,E,3*A,2*A),l.setRenderTarget(t),l.render(u,GA)}};function BG(i){let e=[],t=[],n=[],r=i,s=i-vd+1+tL.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let l=1/a;o>i-vd?l=tL[o-i+vd-1]:o===0&&(l=0),n.push(l);let c=1/(a-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],f=6,p=6,v=3,g=2,m=1,y=new Float32Array(v*p*f),w=new Float32Array(g*p*f),A=new Float32Array(m*p*f);for(let E=0;E<f;E++){let T=E%3*2/3-1,L=E>2?0:-1,S=[T,L,0,T+2/3,L,0,T+2/3,L+1,0,T,L,0,T+2/3,L+1,0,T,L+1,0];y.set(S,v*p*E),w.set(h,g*p*E);let _=[E,E,E,E,E,E];A.set(_,m*p*E)}let C=new pr;C.setAttribute("position",new Jn(y,v)),C.setAttribute("uv",new Jn(w,g)),C.setAttribute("faceIndex",new Jn(A,m)),e.push(C),r>vd&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function rL(i,e,t){let n=new To(i,e,t);return n.texture.mapping=I0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function kg(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function VG(i,e,t){let n=new Float32Array(Ll),r=new V(0,1,0);return new Hs({name:"SphericalGaussianBlur",defines:{n:Ll,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:F_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ra,depthTest:!1,depthWrite:!1})}function sL(){return new Hs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:F_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ra,depthTest:!1,depthWrite:!1})}function oL(){return new Hs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:F_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ra,depthTest:!1,depthWrite:!1})}function F_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function UG(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let l=a.mapping,c=l===f1||l===p1,d=l===Cd||l===Md;if(c||d){let u=e.get(a),h=u!==void 0?u.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return t===null&&(t=new s0(i)),u=c?t.fromEquirectangular(a,u):t.fromCubemap(a,u),u.texture.pmremVersion=a.pmremVersion,e.set(a,u),u.texture;if(u!==void 0)return u.texture;{let f=a.image;return c&&f&&f.height>0||d&&f&&r(f)?(t===null&&(t=new s0(i)),u=c?t.fromEquirectangular(a):t.fromCubemap(a),u.texture.pmremVersion=a.pmremVersion,e.set(a,u),a.addEventListener("dispose",s),u.texture):null}}}return a}function r(a){let l=0,c=6;for(let d=0;d<c;d++)a[d]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function HG(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let r=t(n);return r===null&&Mh("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function zG(i,e,t,n){let r={},s=new WeakMap;function o(u){let h=u.target;h.index!==null&&e.remove(h.index);for(let p in h.attributes)e.remove(h.attributes[p]);for(let p in h.morphAttributes){let v=h.morphAttributes[p];for(let g=0,m=v.length;g<m;g++)e.remove(v[g])}h.removeEventListener("dispose",o),delete r[h.id];let f=s.get(h);f&&(e.remove(f),s.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(u,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h}function l(u){let h=u.attributes;for(let p in h)e.update(h[p],i.ARRAY_BUFFER);let f=u.morphAttributes;for(let p in f){let v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],i.ARRAY_BUFFER)}}function c(u){let h=[],f=u.index,p=u.attributes.position,v=0;if(f!==null){let y=f.array;v=f.version;for(let w=0,A=y.length;w<A;w+=3){let C=y[w+0],E=y[w+1],T=y[w+2];h.push(C,E,E,T,T,C)}}else if(p!==void 0){let y=p.array;v=p.version;for(let w=0,A=y.length/3-1;w<A;w+=3){let C=w+0,E=w+1,T=w+2;h.push(C,E,E,T,T,C)}}else return;let g=new(ck(h)?t0:e0)(h,1);g.version=v;let m=s.get(u);m&&e.remove(m),s.set(u,g)}function d(u){let h=s.get(u);if(h){let f=u.index;f!==null&&h.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:d}}function jG(i,e,t){let n;function r(h){n=h}let s,o;function a(h){s=h.type,o=h.bytesPerElement}function l(h,f){i.drawElements(n,f,s,h*o),t.update(f,n,1)}function c(h,f,p){p!==0&&(i.drawElementsInstanced(n,f,s,h*o,p),t.update(f,n,p))}function d(h,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,f,0,s,h,0,p);let g=0;for(let m=0;m<p;m++)g+=f[m];t.update(g,n,1)}function u(h,f,p,v){if(p===0)return;let g=e.get("WEBGL_multi_draw");if(g===null)for(let m=0;m<h.length;m++)c(h[m]/o,f[m],v[m]);else{g.multiDrawElementsInstancedWEBGL(n,f,0,s,h,0,v,0,p);let m=0;for(let y=0;y<p;y++)m+=f[y]*v[y];t.update(m,n,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=d,this.renderMultiDrawInstances=u}function GG(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function WG(i,e,t){let n=new WeakMap,r=new Jt;function s(o,a,l){let c=o.morphTargetInfluences,d=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=d!==void 0?d.length:0,h=n.get(a);if(h===void 0||h.count!==u){let _=function(){L.dispose(),n.delete(a),a.removeEventListener("dispose",_)};var f=_;h!==void 0&&h.texture.dispose();let p=a.morphAttributes.position!==void 0,v=a.morphAttributes.normal!==void 0,g=a.morphAttributes.color!==void 0,m=a.morphAttributes.position||[],y=a.morphAttributes.normal||[],w=a.morphAttributes.color||[],A=0;p===!0&&(A=1),v===!0&&(A=2),g===!0&&(A=3);let C=a.attributes.position.count*A,E=1;C>e.maxTextureSize&&(E=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);let T=new Float32Array(C*E*4*u),L=new $g(T,C,E,u);L.type=gs,L.needsUpdate=!0;let S=A*4;for(let P=0;P<u;P++){let U=m[P],O=y[P],z=w[P],q=C*E*4*P;for(let Q=0;Q<U.count;Q++){let K=Q*S;p===!0&&(r.fromBufferAttribute(U,Q),T[q+K+0]=r.x,T[q+K+1]=r.y,T[q+K+2]=r.z,T[q+K+3]=0),v===!0&&(r.fromBufferAttribute(O,Q),T[q+K+4]=r.x,T[q+K+5]=r.y,T[q+K+6]=r.z,T[q+K+7]=0),g===!0&&(r.fromBufferAttribute(z,Q),T[q+K+8]=r.x,T[q+K+9]=r.y,T[q+K+10]=r.z,T[q+K+11]=z.itemSize===4?r.w:1)}}h={count:u,texture:L,size:new ye(C,E)},n.set(a,h),a.addEventListener("dispose",_)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let p=0;for(let g=0;g<c.length;g++)p+=c[g];let v=a.morphTargetsRelative?1:1-p;l.getUniforms().setValue(i,"morphTargetBaseInfluence",v),l.getUniforms().setValue(i,"morphTargetInfluences",c)}l.getUniforms().setValue(i,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",h.size)}return{update:s}}function qG(i,e,t,n){let r=new WeakMap;function s(l){let c=n.render.frame,d=l.geometry,u=e.get(l,d);if(r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){let h=l.skeleton;r.get(h)!==c&&(h.update(),r.set(h,c))}return u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}var o0=class extends Br{constructor(e,t,n,r,s,o,a,l,c,d=yd){if(d!==yd&&d!==Id)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&d===yd&&(n=Nl),n===void 0&&d===Id&&(n=Td),super(null,r,s,o,a,l,d,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Ci,this.minFilter=l!==void 0?l:Ci,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},fk=new Br,aL=new o0(1,1),pk=new $g,mk=new G1,gk=new i0,lL=[],cL=[],dL=new Float32Array(16),uL=new Float32Array(9),hL=new Float32Array(4);function Hd(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,s=lL[r];if(s===void 0&&(s=new Float32Array(r),lL[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function $n(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ei(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function L0(i,e){let t=cL[e];t===void 0&&(t=new Int32Array(e),cL[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function ZG(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function XG(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($n(t,e))return;i.uniform2fv(this.addr,e),ei(t,e)}}function YG(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if($n(t,e))return;i.uniform3fv(this.addr,e),ei(t,e)}}function QG(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($n(t,e))return;i.uniform4fv(this.addr,e),ei(t,e)}}function KG(i,e){let t=this.cache,n=e.elements;if(n===void 0){if($n(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ei(t,e)}else{if($n(t,n))return;hL.set(n),i.uniformMatrix2fv(this.addr,!1,hL),ei(t,n)}}function JG(i,e){let t=this.cache,n=e.elements;if(n===void 0){if($n(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ei(t,e)}else{if($n(t,n))return;uL.set(n),i.uniformMatrix3fv(this.addr,!1,uL),ei(t,n)}}function $G(i,e){let t=this.cache,n=e.elements;if(n===void 0){if($n(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ei(t,e)}else{if($n(t,n))return;dL.set(n),i.uniformMatrix4fv(this.addr,!1,dL),ei(t,n)}}function eW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function tW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($n(t,e))return;i.uniform2iv(this.addr,e),ei(t,e)}}function nW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($n(t,e))return;i.uniform3iv(this.addr,e),ei(t,e)}}function iW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($n(t,e))return;i.uniform4iv(this.addr,e),ei(t,e)}}function rW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function sW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($n(t,e))return;i.uniform2uiv(this.addr,e),ei(t,e)}}function oW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($n(t,e))return;i.uniform3uiv(this.addr,e),ei(t,e)}}function aW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($n(t,e))return;i.uniform4uiv(this.addr,e),ei(t,e)}}function lW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(aL.compareFunction=lk,s=aL):s=fk,t.setTexture2D(e||s,r)}function cW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||mk,r)}function dW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||gk,r)}function uW(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||pk,r)}function hW(i){switch(i){case 5126:return ZG;case 35664:return XG;case 35665:return YG;case 35666:return QG;case 35674:return KG;case 35675:return JG;case 35676:return $G;case 5124:case 35670:return eW;case 35667:case 35671:return tW;case 35668:case 35672:return nW;case 35669:case 35673:return iW;case 5125:return rW;case 36294:return sW;case 36295:return oW;case 36296:return aW;case 35678:case 36198:case 36298:case 36306:case 35682:return lW;case 35679:case 36299:case 36307:return cW;case 35680:case 36300:case 36308:case 36293:return dW;case 36289:case 36303:case 36311:case 36292:return uW}}function fW(i,e){i.uniform1fv(this.addr,e)}function pW(i,e){let t=Hd(e,this.size,2);i.uniform2fv(this.addr,t)}function mW(i,e){let t=Hd(e,this.size,3);i.uniform3fv(this.addr,t)}function gW(i,e){let t=Hd(e,this.size,4);i.uniform4fv(this.addr,t)}function vW(i,e){let t=Hd(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function xW(i,e){let t=Hd(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function wW(i,e){let t=Hd(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function yW(i,e){i.uniform1iv(this.addr,e)}function bW(i,e){i.uniform2iv(this.addr,e)}function AW(i,e){i.uniform3iv(this.addr,e)}function _W(i,e){i.uniform4iv(this.addr,e)}function SW(i,e){i.uniform1uiv(this.addr,e)}function EW(i,e){i.uniform2uiv(this.addr,e)}function CW(i,e){i.uniform3uiv(this.addr,e)}function MW(i,e){i.uniform4uiv(this.addr,e)}function TW(i,e,t){let n=this.cache,r=e.length,s=L0(t,r);$n(n,s)||(i.uniform1iv(this.addr,s),ei(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||fk,s[o])}function IW(i,e,t){let n=this.cache,r=e.length,s=L0(t,r);$n(n,s)||(i.uniform1iv(this.addr,s),ei(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||mk,s[o])}function DW(i,e,t){let n=this.cache,r=e.length,s=L0(t,r);$n(n,s)||(i.uniform1iv(this.addr,s),ei(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||gk,s[o])}function PW(i,e,t){let n=this.cache,r=e.length,s=L0(t,r);$n(n,s)||(i.uniform1iv(this.addr,s),ei(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||pk,s[o])}function RW(i){switch(i){case 5126:return fW;case 35664:return pW;case 35665:return mW;case 35666:return gW;case 35674:return vW;case 35675:return xW;case 35676:return wW;case 5124:case 35670:return yW;case 35667:case 35671:return bW;case 35668:case 35672:return AW;case 35669:case 35673:return _W;case 5125:return SW;case 36294:return EW;case 36295:return CW;case 36296:return MW;case 35678:case 36198:case 36298:case 36306:case 35682:return TW;case 35679:case 36299:case 36307:return IW;case 35680:case 36300:case 36308:case 36293:return DW;case 36289:case 36303:case 36311:case 36292:return PW}}var Z1=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=hW(t.type)}},X1=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=RW(t.type)}},Y1=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],n)}}},YA=/(\w+)(\])?(\[|\.)?/g;function fL(i,e){i.seq.push(e),i.map[e.id]=e}function LW(i,e,t){let n=i.name,r=n.length;for(YA.lastIndex=0;;){let s=YA.exec(n),o=YA.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){fL(t,c===void 0?new Z1(a,i,e):new X1(a,i,e));break}else{let u=t.map[a];u===void 0&&(u=new Y1(a),fL(t,u)),t=u}}}var Ad=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);LW(s,o,this)}}setValue(e,t,n,r){let s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&n.push(o)}return n}};function pL(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}var kW=37297,NW=0;function FW(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}var mL=new It;function OW(i){Ut._getMatrix(mL,Ut.workingColorSpace,i);let e=`mat3( ${mL.elements.map(t=>t.toFixed(4))} )`;switch(Ut.getTransfer(i)){case P0:return[e,"LinearTransferOETF"];case an:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function gL(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+FW(i.getShaderSource(e),o)}else return r}function BW(i,e){let t=OW(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function VW(i,e){let t;switch(e){case Xz:t="Linear";break;case Yz:t="Reinhard";break;case Qz:t="Cineon";break;case Kz:t="ACESFilmic";break;case $z:t="AgX";break;case e7:t="Neutral";break;case Jz:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var Ng=new V;function UW(){Ut.getLuminanceCoefficients(Ng);let i=Ng.x.toFixed(4),e=Ng.y.toFixed(4),t=Ng.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function HW(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Th).join(`
`)}function zW(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function jW(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let s=i.getActiveAttrib(e,r),o=s.name,a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function Th(i){return i!==""}function vL(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function xL(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var GW=/^[ \t]*#include +<([\w\d./]+)>/gm;function Q1(i){return i.replace(GW,qW)}var WW=new Map;function qW(i,e){let t=Pt[e];if(t===void 0){let n=WW.get(e);if(n!==void 0)t=Pt[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Q1(t)}var ZW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wL(i){return i.replace(ZW,XW)}function XW(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function yL(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function YW(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===YL?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Mz?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Ao&&(e="SHADOWMAP_TYPE_VSM"),e}function QW(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Cd:case Md:e="ENVMAP_TYPE_CUBE";break;case I0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function KW(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Md:e="ENVMAP_MODE_REFRACTION";break}return e}function JW(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case QL:e="ENVMAP_BLENDING_MULTIPLY";break;case qz:e="ENVMAP_BLENDING_MIX";break;case Zz:e="ENVMAP_BLENDING_ADD";break}return e}function $W(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function eq(i,e,t,n){let r=i.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,l=YW(t),c=QW(t),d=KW(t),u=JW(t),h=$W(t),f=HW(t),p=zW(s),v=r.createProgram(),g,m,y=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Th).join(`
`),g.length>0&&(g+=`
`),m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Th).join(`
`),m.length>0&&(m+=`
`)):(g=[yL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Th).join(`
`),m=[yL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==La?"#define TONE_MAPPING":"",t.toneMapping!==La?Pt.tonemapping_pars_fragment:"",t.toneMapping!==La?VW("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pt.colorspace_pars_fragment,BW("linearToOutputTexel",t.outputColorSpace),UW(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Th).join(`
`)),o=Q1(o),o=vL(o,t),o=xL(o,t),a=Q1(a),a=vL(a,t),a=xL(a,t),o=wL(o),a=wL(a),t.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",t.glslVersion===LR?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===LR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let w=y+g+o,A=y+m+a,C=pL(r,r.VERTEX_SHADER,w),E=pL(r,r.FRAGMENT_SHADER,A);r.attachShader(v,C),r.attachShader(v,E),t.index0AttributeName!==void 0?r.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v);function T(P){if(i.debug.checkShaderErrors){let U=r.getProgramInfoLog(v).trim(),O=r.getShaderInfoLog(C).trim(),z=r.getShaderInfoLog(E).trim(),q=!0,Q=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(q=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,v,C,E);else{let K=gL(r,C,"vertex"),W=gL(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Material Name: `+P.name+`
Material Type: `+P.type+`

Program Info Log: `+U+`
`+K+`
`+W)}else U!==""?console.warn("THREE.WebGLProgram: Program Info Log:",U):(O===""||z==="")&&(Q=!1);Q&&(P.diagnostics={runnable:q,programLog:U,vertexShader:{log:O,prefix:g},fragmentShader:{log:z,prefix:m}})}r.deleteShader(C),r.deleteShader(E),L=new Ad(r,v),S=jW(r,v)}let L;this.getUniforms=function(){return L===void 0&&T(this),L};let S;this.getAttributes=function(){return S===void 0&&T(this),S};let _=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return _===!1&&(_=r.getProgramParameter(v,kW)),_},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=NW++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=C,this.fragmentShader=E,this}var tq=0,K1=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new J1(e),t.set(e,n)),n}},J1=class{constructor(e){this.id=tq++,this.code=e,this.usedTimes=0}};function nq(i,e,t,n,r,s,o){let a=new Bh,l=new K1,c=new Set,d=[],u=r.logarithmicDepthBuffer,h=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(S){return c.add(S),S===0?"uv":`uv${S}`}function g(S,_,P,U,O){let z=U.fog,q=O.geometry,Q=S.isMeshStandardMaterial?U.environment:null,K=(S.isMeshStandardMaterial?t:e).get(S.envMap||Q),W=K&&K.mapping===I0?K.image.height:null,Ee=p[S.type];S.precision!==null&&(f=r.getMaxPrecision(S.precision),f!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",f,"instead."));let Te=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,ke=Te!==void 0?Te.length:0,We=0;q.morphAttributes.position!==void 0&&(We=1),q.morphAttributes.normal!==void 0&&(We=2),q.morphAttributes.color!==void 0&&(We=3);let at,se,xe,Ne;if(Ee){let rn=Os[Ee];at=rn.vertexShader,se=rn.fragmentShader}else at=S.vertexShader,se=S.fragmentShader,l.update(S),xe=l.getVertexShaderID(S),Ne=l.getFragmentShaderID(S);let pe=i.getRenderTarget(),je=i.state.buffers.depth.getReversed(),dt=O.isInstancedMesh===!0,ut=O.isBatchedMesh===!0,Xt=!!S.map,ue=!!S.matcap,Ae=!!K,N=!!S.aoMap,Ke=!!S.lightMap,we=!!S.bumpMap,Ve=!!S.normalMap,Ce=!!S.displacementMap,lt=!!S.emissiveMap,Oe=!!S.metalnessMap,k=!!S.roughnessMap,D=S.anisotropy>0,X=S.clearcoat>0,oe=S.dispersion>0,me=S.iridescence>0,ae=S.sheen>0,Ze=S.transmission>0,De=D&&!!S.anisotropyMap,Be=X&&!!S.clearcoatMap,Bt=X&&!!S.clearcoatNormalMap,be=X&&!!S.clearcoatRoughnessMap,Ue=me&&!!S.iridescenceMap,ct=me&&!!S.iridescenceThicknessMap,pt=ae&&!!S.sheenColorMap,He=ae&&!!S.sheenRoughnessMap,jt=!!S.specularMap,Dt=!!S.specularColorMap,un=!!S.specularIntensityMap,H=Ze&&!!S.transmissionMap,Pe=Ze&&!!S.thicknessMap,ie=!!S.gradientMap,de=!!S.alphaMap,Fe=S.alphaTest>0,Re=!!S.alphaHash,St=!!S.extensions,Dn=La;S.toneMapped&&(pe===null||pe.isXRRenderTarget===!0)&&(Dn=i.toneMapping);let bi={shaderID:Ee,shaderType:S.type,shaderName:S.name,vertexShader:at,fragmentShader:se,defines:S.defines,customVertexShaderID:xe,customFragmentShaderID:Ne,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:f,batching:ut,batchingColor:ut&&O._colorsTexture!==null,instancing:dt,instancingColor:dt&&O.instanceColor!==null,instancingMorph:dt&&O.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:pe===null?i.outputColorSpace:pe.isXRRenderTarget===!0?pe.texture.colorSpace:Mi,alphaToCoverage:!!S.alphaToCoverage,map:Xt,matcap:ue,envMap:Ae,envMapMode:Ae&&K.mapping,envMapCubeUVHeight:W,aoMap:N,lightMap:Ke,bumpMap:we,normalMap:Ve,displacementMap:h&&Ce,emissiveMap:lt,normalMapObjectSpace:Ve&&S.normalMapType===s7,normalMapTangentSpace:Ve&&S.normalMapType===ak,metalnessMap:Oe,roughnessMap:k,anisotropy:D,anisotropyMap:De,clearcoat:X,clearcoatMap:Be,clearcoatNormalMap:Bt,clearcoatRoughnessMap:be,dispersion:oe,iridescence:me,iridescenceMap:Ue,iridescenceThicknessMap:ct,sheen:ae,sheenColorMap:pt,sheenRoughnessMap:He,specularMap:jt,specularColorMap:Dt,specularIntensityMap:un,transmission:Ze,transmissionMap:H,thicknessMap:Pe,gradientMap:ie,opaque:S.transparent===!1&&S.blending===wd&&S.alphaToCoverage===!1,alphaMap:de,alphaTest:Fe,alphaHash:Re,combine:S.combine,mapUv:Xt&&v(S.map.channel),aoMapUv:N&&v(S.aoMap.channel),lightMapUv:Ke&&v(S.lightMap.channel),bumpMapUv:we&&v(S.bumpMap.channel),normalMapUv:Ve&&v(S.normalMap.channel),displacementMapUv:Ce&&v(S.displacementMap.channel),emissiveMapUv:lt&&v(S.emissiveMap.channel),metalnessMapUv:Oe&&v(S.metalnessMap.channel),roughnessMapUv:k&&v(S.roughnessMap.channel),anisotropyMapUv:De&&v(S.anisotropyMap.channel),clearcoatMapUv:Be&&v(S.clearcoatMap.channel),clearcoatNormalMapUv:Bt&&v(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:be&&v(S.clearcoatRoughnessMap.channel),iridescenceMapUv:Ue&&v(S.iridescenceMap.channel),iridescenceThicknessMapUv:ct&&v(S.iridescenceThicknessMap.channel),sheenColorMapUv:pt&&v(S.sheenColorMap.channel),sheenRoughnessMapUv:He&&v(S.sheenRoughnessMap.channel),specularMapUv:jt&&v(S.specularMap.channel),specularColorMapUv:Dt&&v(S.specularColorMap.channel),specularIntensityMapUv:un&&v(S.specularIntensityMap.channel),transmissionMapUv:H&&v(S.transmissionMap.channel),thicknessMapUv:Pe&&v(S.thicknessMap.channel),alphaMapUv:de&&v(S.alphaMap.channel),vertexTangents:!!q.attributes.tangent&&(Ve||D),vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!q.attributes.color&&q.attributes.color.itemSize===4,pointsUvs:O.isPoints===!0&&!!q.attributes.uv&&(Xt||de),fog:!!z,useFog:S.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:S.flatShading===!0,sizeAttenuation:S.sizeAttenuation===!0,logarithmicDepthBuffer:u,reverseDepthBuffer:je,skinning:O.isSkinnedMesh===!0,morphTargets:q.morphAttributes.position!==void 0,morphNormals:q.morphAttributes.normal!==void 0,morphColors:q.morphAttributes.color!==void 0,morphTargetsCount:ke,morphTextureStride:We,numDirLights:_.directional.length,numPointLights:_.point.length,numSpotLights:_.spot.length,numSpotLightMaps:_.spotLightMap.length,numRectAreaLights:_.rectArea.length,numHemiLights:_.hemi.length,numDirLightShadows:_.directionalShadowMap.length,numPointLightShadows:_.pointShadowMap.length,numSpotLightShadows:_.spotShadowMap.length,numSpotLightShadowsWithMaps:_.numSpotLightShadowsWithMaps,numLightProbes:_.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:S.dithering,shadowMapEnabled:i.shadowMap.enabled&&P.length>0,shadowMapType:i.shadowMap.type,toneMapping:Dn,decodeVideoTexture:Xt&&S.map.isVideoTexture===!0&&Ut.getTransfer(S.map.colorSpace)===an,decodeVideoTextureEmissive:lt&&S.emissiveMap.isVideoTexture===!0&&Ut.getTransfer(S.emissiveMap.colorSpace)===an,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===ps,flipSided:S.side===Ki,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionClipCullDistance:St&&S.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(St&&S.extensions.multiDraw===!0||ut)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()};return bi.vertexUv1s=c.has(1),bi.vertexUv2s=c.has(2),bi.vertexUv3s=c.has(3),c.clear(),bi}function m(S){let _=[];if(S.shaderID?_.push(S.shaderID):(_.push(S.customVertexShaderID),_.push(S.customFragmentShaderID)),S.defines!==void 0)for(let P in S.defines)_.push(P),_.push(S.defines[P]);return S.isRawShaderMaterial===!1&&(y(_,S),w(_,S),_.push(i.outputColorSpace)),_.push(S.customProgramCacheKey),_.join()}function y(S,_){S.push(_.precision),S.push(_.outputColorSpace),S.push(_.envMapMode),S.push(_.envMapCubeUVHeight),S.push(_.mapUv),S.push(_.alphaMapUv),S.push(_.lightMapUv),S.push(_.aoMapUv),S.push(_.bumpMapUv),S.push(_.normalMapUv),S.push(_.displacementMapUv),S.push(_.emissiveMapUv),S.push(_.metalnessMapUv),S.push(_.roughnessMapUv),S.push(_.anisotropyMapUv),S.push(_.clearcoatMapUv),S.push(_.clearcoatNormalMapUv),S.push(_.clearcoatRoughnessMapUv),S.push(_.iridescenceMapUv),S.push(_.iridescenceThicknessMapUv),S.push(_.sheenColorMapUv),S.push(_.sheenRoughnessMapUv),S.push(_.specularMapUv),S.push(_.specularColorMapUv),S.push(_.specularIntensityMapUv),S.push(_.transmissionMapUv),S.push(_.thicknessMapUv),S.push(_.combine),S.push(_.fogExp2),S.push(_.sizeAttenuation),S.push(_.morphTargetsCount),S.push(_.morphAttributeCount),S.push(_.numDirLights),S.push(_.numPointLights),S.push(_.numSpotLights),S.push(_.numSpotLightMaps),S.push(_.numHemiLights),S.push(_.numRectAreaLights),S.push(_.numDirLightShadows),S.push(_.numPointLightShadows),S.push(_.numSpotLightShadows),S.push(_.numSpotLightShadowsWithMaps),S.push(_.numLightProbes),S.push(_.shadowMapType),S.push(_.toneMapping),S.push(_.numClippingPlanes),S.push(_.numClipIntersection),S.push(_.depthPacking)}function w(S,_){a.disableAll(),_.supportsVertexTextures&&a.enable(0),_.instancing&&a.enable(1),_.instancingColor&&a.enable(2),_.instancingMorph&&a.enable(3),_.matcap&&a.enable(4),_.envMap&&a.enable(5),_.normalMapObjectSpace&&a.enable(6),_.normalMapTangentSpace&&a.enable(7),_.clearcoat&&a.enable(8),_.iridescence&&a.enable(9),_.alphaTest&&a.enable(10),_.vertexColors&&a.enable(11),_.vertexAlphas&&a.enable(12),_.vertexUv1s&&a.enable(13),_.vertexUv2s&&a.enable(14),_.vertexUv3s&&a.enable(15),_.vertexTangents&&a.enable(16),_.anisotropy&&a.enable(17),_.alphaHash&&a.enable(18),_.batching&&a.enable(19),_.dispersion&&a.enable(20),_.batchingColor&&a.enable(21),S.push(a.mask),a.disableAll(),_.fog&&a.enable(0),_.useFog&&a.enable(1),_.flatShading&&a.enable(2),_.logarithmicDepthBuffer&&a.enable(3),_.reverseDepthBuffer&&a.enable(4),_.skinning&&a.enable(5),_.morphTargets&&a.enable(6),_.morphNormals&&a.enable(7),_.morphColors&&a.enable(8),_.premultipliedAlpha&&a.enable(9),_.shadowMapEnabled&&a.enable(10),_.doubleSided&&a.enable(11),_.flipSided&&a.enable(12),_.useDepthPacking&&a.enable(13),_.dithering&&a.enable(14),_.transmission&&a.enable(15),_.sheen&&a.enable(16),_.opaque&&a.enable(17),_.pointsUvs&&a.enable(18),_.decodeVideoTexture&&a.enable(19),_.decodeVideoTextureEmissive&&a.enable(20),_.alphaToCoverage&&a.enable(21),S.push(a.mask)}function A(S){let _=p[S.type],P;if(_){let U=Os[_];P=q7.clone(U.uniforms)}else P=S.uniforms;return P}function C(S,_){let P;for(let U=0,O=d.length;U<O;U++){let z=d[U];if(z.cacheKey===_){P=z,++P.usedTimes;break}}return P===void 0&&(P=new eq(i,_,S,s),d.push(P)),P}function E(S){if(--S.usedTimes===0){let _=d.indexOf(S);d[_]=d[d.length-1],d.pop(),S.destroy()}}function T(S){l.remove(S)}function L(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:A,acquireProgram:C,releaseProgram:E,releaseShaderCache:T,programs:d,dispose:L}}function iq(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let a=i.get(o);return a===void 0&&(a={},i.set(o,a)),a}function n(o){i.delete(o)}function r(o,a,l){i.get(o)[a]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function rq(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function bL(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function AL(){let i=[],e=0,t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(u,h,f,p,v,g){let m=i[e];return m===void 0?(m={id:u.id,object:u,geometry:h,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:g},i[e]=m):(m.id=u.id,m.object=u,m.geometry=h,m.material=f,m.groupOrder=p,m.renderOrder=u.renderOrder,m.z=v,m.group=g),e++,m}function a(u,h,f,p,v,g){let m=o(u,h,f,p,v,g);f.transmission>0?n.push(m):f.transparent===!0?r.push(m):t.push(m)}function l(u,h,f,p,v,g){let m=o(u,h,f,p,v,g);f.transmission>0?n.unshift(m):f.transparent===!0?r.unshift(m):t.unshift(m)}function c(u,h){t.length>1&&t.sort(u||rq),n.length>1&&n.sort(h||bL),r.length>1&&r.sort(h||bL)}function d(){for(let u=e,h=i.length;u<h;u++){let f=i[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:d,sort:c}}function sq(){let i=new WeakMap;function e(n,r){let s=i.get(n),o;return s===void 0?(o=new AL,i.set(n,[o])):r>=s.length?(o=new AL,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function oq(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new V,color:new ft};break;case"SpotLight":t={position:new V,direction:new V,color:new ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new V,color:new ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new V,skyColor:new ft,groundColor:new ft};break;case"RectAreaLight":t={color:new ft,position:new V,halfWidth:new V,halfHeight:new V};break}return i[e.id]=t,t}}}function aq(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var lq=0;function cq(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function dq(i){let e=new oq,t=aq(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new V);let r=new V,s=new yt,o=new yt;function a(c){let d=0,u=0,h=0;for(let S=0;S<9;S++)n.probe[S].set(0,0,0);let f=0,p=0,v=0,g=0,m=0,y=0,w=0,A=0,C=0,E=0,T=0;c.sort(cq);for(let S=0,_=c.length;S<_;S++){let P=c[S],U=P.color,O=P.intensity,z=P.distance,q=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)d+=U.r*O,u+=U.g*O,h+=U.b*O;else if(P.isLightProbe){for(let Q=0;Q<9;Q++)n.probe[Q].addScaledVector(P.sh.coefficients[Q],O);T++}else if(P.isDirectionalLight){let Q=e.get(P);if(Q.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){let K=P.shadow,W=t.get(P);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,n.directionalShadow[f]=W,n.directionalShadowMap[f]=q,n.directionalShadowMatrix[f]=P.shadow.matrix,y++}n.directional[f]=Q,f++}else if(P.isSpotLight){let Q=e.get(P);Q.position.setFromMatrixPosition(P.matrixWorld),Q.color.copy(U).multiplyScalar(O),Q.distance=z,Q.coneCos=Math.cos(P.angle),Q.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),Q.decay=P.decay,n.spot[v]=Q;let K=P.shadow;if(P.map&&(n.spotLightMap[C]=P.map,C++,K.updateMatrices(P),P.castShadow&&E++),n.spotLightMatrix[v]=K.matrix,P.castShadow){let W=t.get(P);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,n.spotShadow[v]=W,n.spotShadowMap[v]=q,A++}v++}else if(P.isRectAreaLight){let Q=e.get(P);Q.color.copy(U).multiplyScalar(O),Q.halfWidth.set(P.width*.5,0,0),Q.halfHeight.set(0,P.height*.5,0),n.rectArea[g]=Q,g++}else if(P.isPointLight){let Q=e.get(P);if(Q.color.copy(P.color).multiplyScalar(P.intensity),Q.distance=P.distance,Q.decay=P.decay,P.castShadow){let K=P.shadow,W=t.get(P);W.shadowIntensity=K.intensity,W.shadowBias=K.bias,W.shadowNormalBias=K.normalBias,W.shadowRadius=K.radius,W.shadowMapSize=K.mapSize,W.shadowCameraNear=K.camera.near,W.shadowCameraFar=K.camera.far,n.pointShadow[p]=W,n.pointShadowMap[p]=q,n.pointShadowMatrix[p]=P.shadow.matrix,w++}n.point[p]=Q,p++}else if(P.isHemisphereLight){let Q=e.get(P);Q.skyColor.copy(P.color).multiplyScalar(O),Q.groundColor.copy(P.groundColor).multiplyScalar(O),n.hemi[m]=Q,m++}}g>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ie.LTC_FLOAT_1,n.rectAreaLTC2=Ie.LTC_FLOAT_2):(n.rectAreaLTC1=Ie.LTC_HALF_1,n.rectAreaLTC2=Ie.LTC_HALF_2)),n.ambient[0]=d,n.ambient[1]=u,n.ambient[2]=h;let L=n.hash;(L.directionalLength!==f||L.pointLength!==p||L.spotLength!==v||L.rectAreaLength!==g||L.hemiLength!==m||L.numDirectionalShadows!==y||L.numPointShadows!==w||L.numSpotShadows!==A||L.numSpotMaps!==C||L.numLightProbes!==T)&&(n.directional.length=f,n.spot.length=v,n.rectArea.length=g,n.point.length=p,n.hemi.length=m,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=A+C-E,n.spotLightMap.length=C,n.numSpotLightShadowsWithMaps=E,n.numLightProbes=T,L.directionalLength=f,L.pointLength=p,L.spotLength=v,L.rectAreaLength=g,L.hemiLength=m,L.numDirectionalShadows=y,L.numPointShadows=w,L.numSpotShadows=A,L.numSpotMaps=C,L.numLightProbes=T,n.version=lq++)}function l(c,d){let u=0,h=0,f=0,p=0,v=0,g=d.matrixWorldInverse;for(let m=0,y=c.length;m<y;m++){let w=c[m];if(w.isDirectionalLight){let A=n.directional[u];A.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(g),u++}else if(w.isSpotLight){let A=n.spot[f];A.position.setFromMatrixPosition(w.matrixWorld),A.position.applyMatrix4(g),A.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(g),f++}else if(w.isRectAreaLight){let A=n.rectArea[p];A.position.setFromMatrixPosition(w.matrixWorld),A.position.applyMatrix4(g),o.identity(),s.copy(w.matrixWorld),s.premultiply(g),o.extractRotation(s),A.halfWidth.set(w.width*.5,0,0),A.halfHeight.set(0,w.height*.5,0),A.halfWidth.applyMatrix4(o),A.halfHeight.applyMatrix4(o),p++}else if(w.isPointLight){let A=n.point[h];A.position.setFromMatrixPosition(w.matrixWorld),A.position.applyMatrix4(g),h++}else if(w.isHemisphereLight){let A=n.hemi[v];A.direction.setFromMatrixPosition(w.matrixWorld),A.direction.transformDirection(g),v++}}}return{setup:a,setupView:l,state:n}}function _L(i){let e=new dq(i),t=[],n=[];function r(d){c.camera=d,t.length=0,n.length=0}function s(d){t.push(d)}function o(d){n.push(d)}function a(){e.setup(t)}function l(d){e.setupView(t,d)}let c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function uq(i){let e=new WeakMap;function t(r,s=0){let o=e.get(r),a;return o===void 0?(a=new _L(i),e.set(r,[a])):s>=o.length?(a=new _L(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}var $1=class extends Mn{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=i7,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},e_=class extends Mn{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},hq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function pq(i,e,t){let n=new Vh,r=new ye,s=new ye,o=new Jt,a=new $1({depthPacking:r7}),l=new e_,c={},d=t.maxTextureSize,u={[Us]:Ki,[Ki]:Us,[ps]:ps},h=new Hs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ye},radius:{value:4}},vertexShader:hq,fragmentShader:fq}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new pr;p.setAttribute("position",new Jn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new Ht(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YL;let m=this.type;this.render=function(E,T,L){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||E.length===0)return;let S=i.getRenderTarget(),_=i.getActiveCubeFace(),P=i.getActiveMipmapLevel(),U=i.state;U.setBlending(Ra),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);let O=m!==Ao&&this.type===Ao,z=m===Ao&&this.type!==Ao;for(let q=0,Q=E.length;q<Q;q++){let K=E[q],W=K.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;r.copy(W.mapSize);let Ee=W.getFrameExtents();if(r.multiply(Ee),s.copy(W.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/Ee.x),r.x=s.x*Ee.x,W.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/Ee.y),r.y=s.y*Ee.y,W.mapSize.y=s.y)),W.map===null||O===!0||z===!0){let ke=this.type!==Ao?{minFilter:Ci,magFilter:Ci}:{};W.map!==null&&W.map.dispose(),W.map=new To(r.x,r.y,ke),W.map.texture.name=K.name+".shadowMap",W.camera.updateProjectionMatrix()}i.setRenderTarget(W.map),i.clear();let Te=W.getViewportCount();for(let ke=0;ke<Te;ke++){let We=W.getViewport(ke);o.set(s.x*We.x,s.y*We.y,s.x*We.z,s.y*We.w),U.viewport(o),W.updateMatrices(K,ke),n=W.getFrustum(),A(T,L,W.camera,K,this.type)}W.isPointLightShadow!==!0&&this.type===Ao&&y(W,L),W.needsUpdate=!1}m=this.type,g.needsUpdate=!1,i.setRenderTarget(S,_,P)};function y(E,T){let L=e.update(v);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new To(r.x,r.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,i.setRenderTarget(E.mapPass),i.clear(),i.renderBufferDirect(T,null,L,h,v,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,i.setRenderTarget(E.map),i.clear(),i.renderBufferDirect(T,null,L,f,v,null)}function w(E,T,L,S){let _=null,P=L.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(P!==void 0)_=P;else if(_=L.isPointLight===!0?l:a,i.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0){let U=_.uuid,O=T.uuid,z=c[U];z===void 0&&(z={},c[U]=z);let q=z[O];q===void 0&&(q=_.clone(),z[O]=q,T.addEventListener("dispose",C)),_=q}if(_.visible=T.visible,_.wireframe=T.wireframe,S===Ao?_.side=T.shadowSide!==null?T.shadowSide:T.side:_.side=T.shadowSide!==null?T.shadowSide:u[T.side],_.alphaMap=T.alphaMap,_.alphaTest=T.alphaTest,_.map=T.map,_.clipShadows=T.clipShadows,_.clippingPlanes=T.clippingPlanes,_.clipIntersection=T.clipIntersection,_.displacementMap=T.displacementMap,_.displacementScale=T.displacementScale,_.displacementBias=T.displacementBias,_.wireframeLinewidth=T.wireframeLinewidth,_.linewidth=T.linewidth,L.isPointLight===!0&&_.isMeshDistanceMaterial===!0){let U=i.properties.get(_);U.light=L}return _}function A(E,T,L,S,_){if(E.visible===!1)return;if(E.layers.test(T.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&_===Ao)&&(!E.frustumCulled||n.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,E.matrixWorld);let O=e.update(E),z=E.material;if(Array.isArray(z)){let q=O.groups;for(let Q=0,K=q.length;Q<K;Q++){let W=q[Q],Ee=z[W.materialIndex];if(Ee&&Ee.visible){let Te=w(E,Ee,S,_);E.onBeforeShadow(i,E,T,L,O,Te,W),i.renderBufferDirect(L,null,O,Te,E,W),E.onAfterShadow(i,E,T,L,O,Te,W)}}}else if(z.visible){let q=w(E,z,S,_);E.onBeforeShadow(i,E,T,L,O,q,null),i.renderBufferDirect(L,null,O,q,E,null),E.onAfterShadow(i,E,T,L,O,q,null)}}let U=E.children;for(let O=0,z=U.length;O<z;O++)A(U[O],T,L,S,_)}function C(E){E.target.removeEventListener("dispose",C);for(let L in c){let S=c[L],_=E.target.uuid;_ in S&&(S[_].dispose(),delete S[_])}}}var mq={[o1]:a1,[l1]:u1,[c1]:h1,[Ed]:d1,[a1]:o1,[u1]:l1,[h1]:c1,[d1]:Ed};function gq(i,e){function t(){let H=!1,Pe=new Jt,ie=null,de=new Jt(0,0,0,0);return{setMask:function(Fe){ie!==Fe&&!H&&(i.colorMask(Fe,Fe,Fe,Fe),ie=Fe)},setLocked:function(Fe){H=Fe},setClear:function(Fe,Re,St,Dn,bi){bi===!0&&(Fe*=Dn,Re*=Dn,St*=Dn),Pe.set(Fe,Re,St,Dn),de.equals(Pe)===!1&&(i.clearColor(Fe,Re,St,Dn),de.copy(Pe))},reset:function(){H=!1,ie=null,de.set(-1,0,0,0)}}}function n(){let H=!1,Pe=!1,ie=null,de=null,Fe=null;return{setReversed:function(Re){if(Pe!==Re){let St=e.get("EXT_clip_control");Pe?St.clipControlEXT(St.LOWER_LEFT_EXT,St.ZERO_TO_ONE_EXT):St.clipControlEXT(St.LOWER_LEFT_EXT,St.NEGATIVE_ONE_TO_ONE_EXT);let Dn=Fe;Fe=null,this.setClear(Dn)}Pe=Re},getReversed:function(){return Pe},setTest:function(Re){Re?pe(i.DEPTH_TEST):je(i.DEPTH_TEST)},setMask:function(Re){ie!==Re&&!H&&(i.depthMask(Re),ie=Re)},setFunc:function(Re){if(Pe&&(Re=mq[Re]),de!==Re){switch(Re){case o1:i.depthFunc(i.NEVER);break;case a1:i.depthFunc(i.ALWAYS);break;case l1:i.depthFunc(i.LESS);break;case Ed:i.depthFunc(i.LEQUAL);break;case c1:i.depthFunc(i.EQUAL);break;case d1:i.depthFunc(i.GEQUAL);break;case u1:i.depthFunc(i.GREATER);break;case h1:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}de=Re}},setLocked:function(Re){H=Re},setClear:function(Re){Fe!==Re&&(Pe&&(Re=1-Re),i.clearDepth(Re),Fe=Re)},reset:function(){H=!1,ie=null,de=null,Fe=null,Pe=!1}}}function r(){let H=!1,Pe=null,ie=null,de=null,Fe=null,Re=null,St=null,Dn=null,bi=null;return{setTest:function(rn){H||(rn?pe(i.STENCIL_TEST):je(i.STENCIL_TEST))},setMask:function(rn){Pe!==rn&&!H&&(i.stencilMask(rn),Pe=rn)},setFunc:function(rn,Zr,Zs){(ie!==rn||de!==Zr||Fe!==Zs)&&(i.stencilFunc(rn,Zr,Zs),ie=rn,de=Zr,Fe=Zs)},setOp:function(rn,Zr,Zs){(Re!==rn||St!==Zr||Dn!==Zs)&&(i.stencilOp(rn,Zr,Zs),Re=rn,St=Zr,Dn=Zs)},setLocked:function(rn){H=rn},setClear:function(rn){bi!==rn&&(i.clearStencil(rn),bi=rn)},reset:function(){H=!1,Pe=null,ie=null,de=null,Fe=null,Re=null,St=null,Dn=null,bi=null}}}let s=new t,o=new n,a=new r,l=new WeakMap,c=new WeakMap,d={},u={},h=new WeakMap,f=[],p=null,v=!1,g=null,m=null,y=null,w=null,A=null,C=null,E=null,T=new ft(0,0,0),L=0,S=!1,_=null,P=null,U=null,O=null,z=null,q=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Q=!1,K=0,W=i.getParameter(i.VERSION);W.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(W)[1]),Q=K>=1):W.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(W)[1]),Q=K>=2);let Ee=null,Te={},ke=i.getParameter(i.SCISSOR_BOX),We=i.getParameter(i.VIEWPORT),at=new Jt().fromArray(ke),se=new Jt().fromArray(We);function xe(H,Pe,ie,de){let Fe=new Uint8Array(4),Re=i.createTexture();i.bindTexture(H,Re),i.texParameteri(H,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(H,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let St=0;St<ie;St++)H===i.TEXTURE_3D||H===i.TEXTURE_2D_ARRAY?i.texImage3D(Pe,0,i.RGBA,1,1,de,0,i.RGBA,i.UNSIGNED_BYTE,Fe):i.texImage2D(Pe+St,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Fe);return Re}let Ne={};Ne[i.TEXTURE_2D]=xe(i.TEXTURE_2D,i.TEXTURE_2D,1),Ne[i.TEXTURE_CUBE_MAP]=xe(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ne[i.TEXTURE_2D_ARRAY]=xe(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ne[i.TEXTURE_3D]=xe(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),pe(i.DEPTH_TEST),o.setFunc(Ed),we(!1),Ve(_R),pe(i.CULL_FACE),N(Ra);function pe(H){d[H]!==!0&&(i.enable(H),d[H]=!0)}function je(H){d[H]!==!1&&(i.disable(H),d[H]=!1)}function dt(H,Pe){return u[H]!==Pe?(i.bindFramebuffer(H,Pe),u[H]=Pe,H===i.DRAW_FRAMEBUFFER&&(u[i.FRAMEBUFFER]=Pe),H===i.FRAMEBUFFER&&(u[i.DRAW_FRAMEBUFFER]=Pe),!0):!1}function ut(H,Pe){let ie=f,de=!1;if(H){ie=h.get(Pe),ie===void 0&&(ie=[],h.set(Pe,ie));let Fe=H.textures;if(ie.length!==Fe.length||ie[0]!==i.COLOR_ATTACHMENT0){for(let Re=0,St=Fe.length;Re<St;Re++)ie[Re]=i.COLOR_ATTACHMENT0+Re;ie.length=Fe.length,de=!0}}else ie[0]!==i.BACK&&(ie[0]=i.BACK,de=!0);de&&i.drawBuffers(ie)}function Xt(H){return p!==H?(i.useProgram(H),p=H,!0):!1}let ue={[Pl]:i.FUNC_ADD,[Iz]:i.FUNC_SUBTRACT,[Dz]:i.FUNC_REVERSE_SUBTRACT};ue[Pz]=i.MIN,ue[Rz]=i.MAX;let Ae={[Lz]:i.ZERO,[kz]:i.ONE,[Nz]:i.SRC_COLOR,[r1]:i.SRC_ALPHA,[Hz]:i.SRC_ALPHA_SATURATE,[Vz]:i.DST_COLOR,[Oz]:i.DST_ALPHA,[Fz]:i.ONE_MINUS_SRC_COLOR,[s1]:i.ONE_MINUS_SRC_ALPHA,[Uz]:i.ONE_MINUS_DST_COLOR,[Bz]:i.ONE_MINUS_DST_ALPHA,[zz]:i.CONSTANT_COLOR,[jz]:i.ONE_MINUS_CONSTANT_COLOR,[Gz]:i.CONSTANT_ALPHA,[Wz]:i.ONE_MINUS_CONSTANT_ALPHA};function N(H,Pe,ie,de,Fe,Re,St,Dn,bi,rn){if(H===Ra){v===!0&&(je(i.BLEND),v=!1);return}if(v===!1&&(pe(i.BLEND),v=!0),H!==Tz){if(H!==g||rn!==S){if((m!==Pl||A!==Pl)&&(i.blendEquation(i.FUNC_ADD),m=Pl,A=Pl),rn)switch(H){case wd:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case SR:i.blendFunc(i.ONE,i.ONE);break;case ER:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case CR:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}else switch(H){case wd:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case SR:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case ER:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case CR:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}y=null,w=null,C=null,E=null,T.set(0,0,0),L=0,g=H,S=rn}return}Fe=Fe||Pe,Re=Re||ie,St=St||de,(Pe!==m||Fe!==A)&&(i.blendEquationSeparate(ue[Pe],ue[Fe]),m=Pe,A=Fe),(ie!==y||de!==w||Re!==C||St!==E)&&(i.blendFuncSeparate(Ae[ie],Ae[de],Ae[Re],Ae[St]),y=ie,w=de,C=Re,E=St),(Dn.equals(T)===!1||bi!==L)&&(i.blendColor(Dn.r,Dn.g,Dn.b,bi),T.copy(Dn),L=bi),g=H,S=!1}function Ke(H,Pe){H.side===ps?je(i.CULL_FACE):pe(i.CULL_FACE);let ie=H.side===Ki;Pe&&(ie=!ie),we(ie),H.blending===wd&&H.transparent===!1?N(Ra):N(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.blendColor,H.blendAlpha,H.premultipliedAlpha),o.setFunc(H.depthFunc),o.setTest(H.depthTest),o.setMask(H.depthWrite),s.setMask(H.colorWrite);let de=H.stencilWrite;a.setTest(de),de&&(a.setMask(H.stencilWriteMask),a.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),a.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),lt(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),H.alphaToCoverage===!0?pe(i.SAMPLE_ALPHA_TO_COVERAGE):je(i.SAMPLE_ALPHA_TO_COVERAGE)}function we(H){_!==H&&(H?i.frontFace(i.CW):i.frontFace(i.CCW),_=H)}function Ve(H){H!==Ez?(pe(i.CULL_FACE),H!==P&&(H===_R?i.cullFace(i.BACK):H===Cz?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):je(i.CULL_FACE),P=H}function Ce(H){H!==U&&(Q&&i.lineWidth(H),U=H)}function lt(H,Pe,ie){H?(pe(i.POLYGON_OFFSET_FILL),(O!==Pe||z!==ie)&&(i.polygonOffset(Pe,ie),O=Pe,z=ie)):je(i.POLYGON_OFFSET_FILL)}function Oe(H){H?pe(i.SCISSOR_TEST):je(i.SCISSOR_TEST)}function k(H){H===void 0&&(H=i.TEXTURE0+q-1),Ee!==H&&(i.activeTexture(H),Ee=H)}function D(H,Pe,ie){ie===void 0&&(Ee===null?ie=i.TEXTURE0+q-1:ie=Ee);let de=Te[ie];de===void 0&&(de={type:void 0,texture:void 0},Te[ie]=de),(de.type!==H||de.texture!==Pe)&&(Ee!==ie&&(i.activeTexture(ie),Ee=ie),i.bindTexture(H,Pe||Ne[H]),de.type=H,de.texture=Pe)}function X(){let H=Te[Ee];H!==void 0&&H.type!==void 0&&(i.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)}function oe(){try{i.compressedTexImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function me(){try{i.compressedTexImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function ae(){try{i.texSubImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ze(){try{i.texSubImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function De(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Be(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Bt(){try{i.texStorage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function be(){try{i.texStorage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ue(){try{i.texImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function ct(){try{i.texImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function pt(H){at.equals(H)===!1&&(i.scissor(H.x,H.y,H.z,H.w),at.copy(H))}function He(H){se.equals(H)===!1&&(i.viewport(H.x,H.y,H.z,H.w),se.copy(H))}function jt(H,Pe){let ie=c.get(Pe);ie===void 0&&(ie=new WeakMap,c.set(Pe,ie));let de=ie.get(H);de===void 0&&(de=i.getUniformBlockIndex(Pe,H.name),ie.set(H,de))}function Dt(H,Pe){let de=c.get(Pe).get(H);l.get(Pe)!==de&&(i.uniformBlockBinding(Pe,de,H.__bindingPointIndex),l.set(Pe,de))}function un(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},Ee=null,Te={},u={},h=new WeakMap,f=[],p=null,v=!1,g=null,m=null,y=null,w=null,A=null,C=null,E=null,T=new ft(0,0,0),L=0,S=!1,_=null,P=null,U=null,O=null,z=null,at.set(0,0,i.canvas.width,i.canvas.height),se.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:pe,disable:je,bindFramebuffer:dt,drawBuffers:ut,useProgram:Xt,setBlending:N,setMaterial:Ke,setFlipSided:we,setCullFace:Ve,setLineWidth:Ce,setPolygonOffset:lt,setScissorTest:Oe,activeTexture:k,bindTexture:D,unbindTexture:X,compressedTexImage2D:oe,compressedTexImage3D:me,texImage2D:Ue,texImage3D:ct,updateUBOMapping:jt,uniformBlockBinding:Dt,texStorage2D:Bt,texStorage3D:be,texSubImage2D:ae,texSubImage3D:Ze,compressedTexSubImage2D:De,compressedTexSubImage3D:Be,scissor:pt,viewport:He,reset:un}}function SL(i,e,t,n){let r=vq(n);switch(t){case ek:return i*e;case nk:return i*e;case ik:return i*e*2;case P_:return i*e/r.components*r.byteLength;case R_:return i*e/r.components*r.byteLength;case rk:return i*e*2/r.components*r.byteLength;case L_:return i*e*2/r.components*r.byteLength;case tk:return i*e*3/r.components*r.byteLength;case Lr:return i*e*4/r.components*r.byteLength;case k_:return i*e*4/r.components*r.byteLength;case qg:case Zg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Xg:case Yg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case g1:case x1:return Math.max(i,16)*Math.max(e,8)/4;case m1:case v1:return Math.max(i,8)*Math.max(e,8)/2;case w1:case y1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case b1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case A1:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case _1:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case S1:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case E1:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case C1:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case M1:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case T1:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case I1:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case D1:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case P1:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case R1:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case L1:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case k1:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case N1:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Qg:case F1:case O1:return Math.ceil(i/4)*Math.ceil(e/4)*16;case sk:case B1:return Math.ceil(i/4)*Math.ceil(e/4)*8;case V1:case U1:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function vq(i){switch(i){case Co:case KL:return{byteLength:1,components:1};case Fh:case JL:case Jh:return{byteLength:2,components:1};case I_:case D_:return{byteLength:2,components:4};case Nl:case T_:case gs:return{byteLength:4,components:1};case $L:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}function xq(i,e,t,n,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new ye,d=new WeakMap,u,h=new WeakMap,f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(k,D){return f?new OffscreenCanvas(k,D):Oh("canvas")}function v(k,D,X){let oe=1,me=Oe(k);if((me.width>X||me.height>X)&&(oe=X/Math.max(me.width,me.height)),oe<1)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap||typeof VideoFrame<"u"&&k instanceof VideoFrame){let ae=Math.floor(oe*me.width),Ze=Math.floor(oe*me.height);u===void 0&&(u=p(ae,Ze));let De=D?p(ae,Ze):u;return De.width=ae,De.height=Ze,De.getContext("2d").drawImage(k,0,0,ae,Ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+me.width+"x"+me.height+") to ("+ae+"x"+Ze+")."),De}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+me.width+"x"+me.height+")."),k;return k}function g(k){return k.generateMipmaps}function m(k){i.generateMipmap(k)}function y(k){return k.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:k.isWebGL3DRenderTarget?i.TEXTURE_3D:k.isWebGLArrayRenderTarget||k.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function w(k,D,X,oe,me=!1){if(k!==null){if(i[k]!==void 0)return i[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let ae=D;if(D===i.RED&&(X===i.FLOAT&&(ae=i.R32F),X===i.HALF_FLOAT&&(ae=i.R16F),X===i.UNSIGNED_BYTE&&(ae=i.R8)),D===i.RED_INTEGER&&(X===i.UNSIGNED_BYTE&&(ae=i.R8UI),X===i.UNSIGNED_SHORT&&(ae=i.R16UI),X===i.UNSIGNED_INT&&(ae=i.R32UI),X===i.BYTE&&(ae=i.R8I),X===i.SHORT&&(ae=i.R16I),X===i.INT&&(ae=i.R32I)),D===i.RG&&(X===i.FLOAT&&(ae=i.RG32F),X===i.HALF_FLOAT&&(ae=i.RG16F),X===i.UNSIGNED_BYTE&&(ae=i.RG8)),D===i.RG_INTEGER&&(X===i.UNSIGNED_BYTE&&(ae=i.RG8UI),X===i.UNSIGNED_SHORT&&(ae=i.RG16UI),X===i.UNSIGNED_INT&&(ae=i.RG32UI),X===i.BYTE&&(ae=i.RG8I),X===i.SHORT&&(ae=i.RG16I),X===i.INT&&(ae=i.RG32I)),D===i.RGB_INTEGER&&(X===i.UNSIGNED_BYTE&&(ae=i.RGB8UI),X===i.UNSIGNED_SHORT&&(ae=i.RGB16UI),X===i.UNSIGNED_INT&&(ae=i.RGB32UI),X===i.BYTE&&(ae=i.RGB8I),X===i.SHORT&&(ae=i.RGB16I),X===i.INT&&(ae=i.RGB32I)),D===i.RGBA_INTEGER&&(X===i.UNSIGNED_BYTE&&(ae=i.RGBA8UI),X===i.UNSIGNED_SHORT&&(ae=i.RGBA16UI),X===i.UNSIGNED_INT&&(ae=i.RGBA32UI),X===i.BYTE&&(ae=i.RGBA8I),X===i.SHORT&&(ae=i.RGBA16I),X===i.INT&&(ae=i.RGBA32I)),D===i.RGB&&X===i.UNSIGNED_INT_5_9_9_9_REV&&(ae=i.RGB9_E5),D===i.RGBA){let Ze=me?P0:Ut.getTransfer(oe);X===i.FLOAT&&(ae=i.RGBA32F),X===i.HALF_FLOAT&&(ae=i.RGBA16F),X===i.UNSIGNED_BYTE&&(ae=Ze===an?i.SRGB8_ALPHA8:i.RGBA8),X===i.UNSIGNED_SHORT_4_4_4_4&&(ae=i.RGBA4),X===i.UNSIGNED_SHORT_5_5_5_1&&(ae=i.RGB5_A1)}return(ae===i.R16F||ae===i.R32F||ae===i.RG16F||ae===i.RG32F||ae===i.RGBA16F||ae===i.RGBA32F)&&e.get("EXT_color_buffer_float"),ae}function A(k,D){let X;return k?D===null||D===Nl||D===Td?X=i.DEPTH24_STENCIL8:D===gs?X=i.DEPTH32F_STENCIL8:D===Fh&&(X=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):D===null||D===Nl||D===Td?X=i.DEPTH_COMPONENT24:D===gs?X=i.DEPTH_COMPONENT32F:D===Fh&&(X=i.DEPTH_COMPONENT16),X}function C(k,D){return g(k)===!0||k.isFramebufferTexture&&k.minFilter!==Ci&&k.minFilter!==Qi?Math.log2(Math.max(D.width,D.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?D.mipmaps.length:1}function E(k){let D=k.target;D.removeEventListener("dispose",E),L(D),D.isVideoTexture&&d.delete(D)}function T(k){let D=k.target;D.removeEventListener("dispose",T),_(D)}function L(k){let D=n.get(k);if(D.__webglInit===void 0)return;let X=k.source,oe=h.get(X);if(oe){let me=oe[D.__cacheKey];me.usedTimes--,me.usedTimes===0&&S(k),Object.keys(oe).length===0&&h.delete(X)}n.remove(k)}function S(k){let D=n.get(k);i.deleteTexture(D.__webglTexture);let X=k.source,oe=h.get(X);delete oe[D.__cacheKey],o.memory.textures--}function _(k){let D=n.get(k);if(k.depthTexture&&(k.depthTexture.dispose(),n.remove(k.depthTexture)),k.isWebGLCubeRenderTarget)for(let oe=0;oe<6;oe++){if(Array.isArray(D.__webglFramebuffer[oe]))for(let me=0;me<D.__webglFramebuffer[oe].length;me++)i.deleteFramebuffer(D.__webglFramebuffer[oe][me]);else i.deleteFramebuffer(D.__webglFramebuffer[oe]);D.__webglDepthbuffer&&i.deleteRenderbuffer(D.__webglDepthbuffer[oe])}else{if(Array.isArray(D.__webglFramebuffer))for(let oe=0;oe<D.__webglFramebuffer.length;oe++)i.deleteFramebuffer(D.__webglFramebuffer[oe]);else i.deleteFramebuffer(D.__webglFramebuffer);if(D.__webglDepthbuffer&&i.deleteRenderbuffer(D.__webglDepthbuffer),D.__webglMultisampledFramebuffer&&i.deleteFramebuffer(D.__webglMultisampledFramebuffer),D.__webglColorRenderbuffer)for(let oe=0;oe<D.__webglColorRenderbuffer.length;oe++)D.__webglColorRenderbuffer[oe]&&i.deleteRenderbuffer(D.__webglColorRenderbuffer[oe]);D.__webglDepthRenderbuffer&&i.deleteRenderbuffer(D.__webglDepthRenderbuffer)}let X=k.textures;for(let oe=0,me=X.length;oe<me;oe++){let ae=n.get(X[oe]);ae.__webglTexture&&(i.deleteTexture(ae.__webglTexture),o.memory.textures--),n.remove(X[oe])}n.remove(k)}let P=0;function U(){P=0}function O(){let k=P;return k>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+r.maxTextures),P+=1,k}function z(k){let D=[];return D.push(k.wrapS),D.push(k.wrapT),D.push(k.wrapR||0),D.push(k.magFilter),D.push(k.minFilter),D.push(k.anisotropy),D.push(k.internalFormat),D.push(k.format),D.push(k.type),D.push(k.generateMipmaps),D.push(k.premultiplyAlpha),D.push(k.flipY),D.push(k.unpackAlignment),D.push(k.colorSpace),D.join()}function q(k,D){let X=n.get(k);if(k.isVideoTexture&&Ce(k),k.isRenderTargetTexture===!1&&k.version>0&&X.__version!==k.version){let oe=k.image;if(oe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(oe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{se(X,k,D);return}}t.bindTexture(i.TEXTURE_2D,X.__webglTexture,i.TEXTURE0+D)}function Q(k,D){let X=n.get(k);if(k.version>0&&X.__version!==k.version){se(X,k,D);return}t.bindTexture(i.TEXTURE_2D_ARRAY,X.__webglTexture,i.TEXTURE0+D)}function K(k,D){let X=n.get(k);if(k.version>0&&X.__version!==k.version){se(X,k,D);return}t.bindTexture(i.TEXTURE_3D,X.__webglTexture,i.TEXTURE0+D)}function W(k,D){let X=n.get(k);if(k.version>0&&X.__version!==k.version){xe(X,k,D);return}t.bindTexture(i.TEXTURE_CUBE_MAP,X.__webglTexture,i.TEXTURE0+D)}let Ee={[kl]:i.REPEAT,[_o]:i.CLAMP_TO_EDGE,[Nh]:i.MIRRORED_REPEAT},Te={[Ci]:i.NEAREST,[M_]:i.NEAREST_MIPMAP_NEAREST,[gd]:i.NEAREST_MIPMAP_LINEAR,[Qi]:i.LINEAR,[Ih]:i.LINEAR_MIPMAP_NEAREST,[Bs]:i.LINEAR_MIPMAP_LINEAR},ke={[o7]:i.NEVER,[h7]:i.ALWAYS,[a7]:i.LESS,[lk]:i.LEQUAL,[l7]:i.EQUAL,[u7]:i.GEQUAL,[c7]:i.GREATER,[d7]:i.NOTEQUAL};function We(k,D){if(D.type===gs&&e.has("OES_texture_float_linear")===!1&&(D.magFilter===Qi||D.magFilter===Ih||D.magFilter===gd||D.magFilter===Bs||D.minFilter===Qi||D.minFilter===Ih||D.minFilter===gd||D.minFilter===Bs)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(k,i.TEXTURE_WRAP_S,Ee[D.wrapS]),i.texParameteri(k,i.TEXTURE_WRAP_T,Ee[D.wrapT]),(k===i.TEXTURE_3D||k===i.TEXTURE_2D_ARRAY)&&i.texParameteri(k,i.TEXTURE_WRAP_R,Ee[D.wrapR]),i.texParameteri(k,i.TEXTURE_MAG_FILTER,Te[D.magFilter]),i.texParameteri(k,i.TEXTURE_MIN_FILTER,Te[D.minFilter]),D.compareFunction&&(i.texParameteri(k,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(k,i.TEXTURE_COMPARE_FUNC,ke[D.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(D.magFilter===Ci||D.minFilter!==gd&&D.minFilter!==Bs||D.type===gs&&e.has("OES_texture_float_linear")===!1)return;if(D.anisotropy>1||n.get(D).__currentAnisotropy){let X=e.get("EXT_texture_filter_anisotropic");i.texParameterf(k,X.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,r.getMaxAnisotropy())),n.get(D).__currentAnisotropy=D.anisotropy}}}function at(k,D){let X=!1;k.__webglInit===void 0&&(k.__webglInit=!0,D.addEventListener("dispose",E));let oe=D.source,me=h.get(oe);me===void 0&&(me={},h.set(oe,me));let ae=z(D);if(ae!==k.__cacheKey){me[ae]===void 0&&(me[ae]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,X=!0),me[ae].usedTimes++;let Ze=me[k.__cacheKey];Ze!==void 0&&(me[k.__cacheKey].usedTimes--,Ze.usedTimes===0&&S(D)),k.__cacheKey=ae,k.__webglTexture=me[ae].texture}return X}function se(k,D,X){let oe=i.TEXTURE_2D;(D.isDataArrayTexture||D.isCompressedArrayTexture)&&(oe=i.TEXTURE_2D_ARRAY),D.isData3DTexture&&(oe=i.TEXTURE_3D);let me=at(k,D),ae=D.source;t.bindTexture(oe,k.__webglTexture,i.TEXTURE0+X);let Ze=n.get(ae);if(ae.version!==Ze.__version||me===!0){t.activeTexture(i.TEXTURE0+X);let De=Ut.getPrimaries(Ut.workingColorSpace),Be=D.colorSpace===Da?null:Ut.getPrimaries(D.colorSpace),Bt=D.colorSpace===Da||De===Be?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,D.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,D.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Bt);let be=v(D.image,!1,r.maxTextureSize);be=lt(D,be);let Ue=s.convert(D.format,D.colorSpace),ct=s.convert(D.type),pt=w(D.internalFormat,Ue,ct,D.colorSpace,D.isVideoTexture);We(oe,D);let He,jt=D.mipmaps,Dt=D.isVideoTexture!==!0,un=Ze.__version===void 0||me===!0,H=ae.dataReady,Pe=C(D,be);if(D.isDepthTexture)pt=A(D.format===Id,D.type),un&&(Dt?t.texStorage2D(i.TEXTURE_2D,1,pt,be.width,be.height):t.texImage2D(i.TEXTURE_2D,0,pt,be.width,be.height,0,Ue,ct,null));else if(D.isDataTexture)if(jt.length>0){Dt&&un&&t.texStorage2D(i.TEXTURE_2D,Pe,pt,jt[0].width,jt[0].height);for(let ie=0,de=jt.length;ie<de;ie++)He=jt[ie],Dt?H&&t.texSubImage2D(i.TEXTURE_2D,ie,0,0,He.width,He.height,Ue,ct,He.data):t.texImage2D(i.TEXTURE_2D,ie,pt,He.width,He.height,0,Ue,ct,He.data);D.generateMipmaps=!1}else Dt?(un&&t.texStorage2D(i.TEXTURE_2D,Pe,pt,be.width,be.height),H&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,be.width,be.height,Ue,ct,be.data)):t.texImage2D(i.TEXTURE_2D,0,pt,be.width,be.height,0,Ue,ct,be.data);else if(D.isCompressedTexture)if(D.isCompressedArrayTexture){Dt&&un&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Pe,pt,jt[0].width,jt[0].height,be.depth);for(let ie=0,de=jt.length;ie<de;ie++)if(He=jt[ie],D.format!==Lr)if(Ue!==null)if(Dt){if(H)if(D.layerUpdates.size>0){let Fe=SL(He.width,He.height,D.format,D.type);for(let Re of D.layerUpdates){let St=He.data.subarray(Re*Fe/He.data.BYTES_PER_ELEMENT,(Re+1)*Fe/He.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,ie,0,0,Re,He.width,He.height,1,Ue,St)}D.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,ie,0,0,0,He.width,He.height,be.depth,Ue,He.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,ie,pt,He.width,He.height,be.depth,0,He.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Dt?H&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,ie,0,0,0,He.width,He.height,be.depth,Ue,ct,He.data):t.texImage3D(i.TEXTURE_2D_ARRAY,ie,pt,He.width,He.height,be.depth,0,Ue,ct,He.data)}else{Dt&&un&&t.texStorage2D(i.TEXTURE_2D,Pe,pt,jt[0].width,jt[0].height);for(let ie=0,de=jt.length;ie<de;ie++)He=jt[ie],D.format!==Lr?Ue!==null?Dt?H&&t.compressedTexSubImage2D(i.TEXTURE_2D,ie,0,0,He.width,He.height,Ue,He.data):t.compressedTexImage2D(i.TEXTURE_2D,ie,pt,He.width,He.height,0,He.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Dt?H&&t.texSubImage2D(i.TEXTURE_2D,ie,0,0,He.width,He.height,Ue,ct,He.data):t.texImage2D(i.TEXTURE_2D,ie,pt,He.width,He.height,0,Ue,ct,He.data)}else if(D.isDataArrayTexture)if(Dt){if(un&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Pe,pt,be.width,be.height,be.depth),H)if(D.layerUpdates.size>0){let ie=SL(be.width,be.height,D.format,D.type);for(let de of D.layerUpdates){let Fe=be.data.subarray(de*ie/be.data.BYTES_PER_ELEMENT,(de+1)*ie/be.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,de,be.width,be.height,1,Ue,ct,Fe)}D.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,be.width,be.height,be.depth,Ue,ct,be.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,pt,be.width,be.height,be.depth,0,Ue,ct,be.data);else if(D.isData3DTexture)Dt?(un&&t.texStorage3D(i.TEXTURE_3D,Pe,pt,be.width,be.height,be.depth),H&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,be.width,be.height,be.depth,Ue,ct,be.data)):t.texImage3D(i.TEXTURE_3D,0,pt,be.width,be.height,be.depth,0,Ue,ct,be.data);else if(D.isFramebufferTexture){if(un)if(Dt)t.texStorage2D(i.TEXTURE_2D,Pe,pt,be.width,be.height);else{let ie=be.width,de=be.height;for(let Fe=0;Fe<Pe;Fe++)t.texImage2D(i.TEXTURE_2D,Fe,pt,ie,de,0,Ue,ct,null),ie>>=1,de>>=1}}else if(jt.length>0){if(Dt&&un){let ie=Oe(jt[0]);t.texStorage2D(i.TEXTURE_2D,Pe,pt,ie.width,ie.height)}for(let ie=0,de=jt.length;ie<de;ie++)He=jt[ie],Dt?H&&t.texSubImage2D(i.TEXTURE_2D,ie,0,0,Ue,ct,He):t.texImage2D(i.TEXTURE_2D,ie,pt,Ue,ct,He);D.generateMipmaps=!1}else if(Dt){if(un){let ie=Oe(be);t.texStorage2D(i.TEXTURE_2D,Pe,pt,ie.width,ie.height)}H&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Ue,ct,be)}else t.texImage2D(i.TEXTURE_2D,0,pt,Ue,ct,be);g(D)&&m(oe),Ze.__version=ae.version,D.onUpdate&&D.onUpdate(D)}k.__version=D.version}function xe(k,D,X){if(D.image.length!==6)return;let oe=at(k,D),me=D.source;t.bindTexture(i.TEXTURE_CUBE_MAP,k.__webglTexture,i.TEXTURE0+X);let ae=n.get(me);if(me.version!==ae.__version||oe===!0){t.activeTexture(i.TEXTURE0+X);let Ze=Ut.getPrimaries(Ut.workingColorSpace),De=D.colorSpace===Da?null:Ut.getPrimaries(D.colorSpace),Be=D.colorSpace===Da||Ze===De?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,D.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,D.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Be);let Bt=D.isCompressedTexture||D.image[0].isCompressedTexture,be=D.image[0]&&D.image[0].isDataTexture,Ue=[];for(let de=0;de<6;de++)!Bt&&!be?Ue[de]=v(D.image[de],!0,r.maxCubemapSize):Ue[de]=be?D.image[de].image:D.image[de],Ue[de]=lt(D,Ue[de]);let ct=Ue[0],pt=s.convert(D.format,D.colorSpace),He=s.convert(D.type),jt=w(D.internalFormat,pt,He,D.colorSpace),Dt=D.isVideoTexture!==!0,un=ae.__version===void 0||oe===!0,H=me.dataReady,Pe=C(D,ct);We(i.TEXTURE_CUBE_MAP,D);let ie;if(Bt){Dt&&un&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Pe,jt,ct.width,ct.height);for(let de=0;de<6;de++){ie=Ue[de].mipmaps;for(let Fe=0;Fe<ie.length;Fe++){let Re=ie[Fe];D.format!==Lr?pt!==null?Dt?H&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe,0,0,Re.width,Re.height,pt,Re.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe,jt,Re.width,Re.height,0,Re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Dt?H&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe,0,0,Re.width,Re.height,pt,He,Re.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe,jt,Re.width,Re.height,0,pt,He,Re.data)}}}else{if(ie=D.mipmaps,Dt&&un){ie.length>0&&Pe++;let de=Oe(Ue[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Pe,jt,de.width,de.height)}for(let de=0;de<6;de++)if(be){Dt?H&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,0,0,Ue[de].width,Ue[de].height,pt,He,Ue[de].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,jt,Ue[de].width,Ue[de].height,0,pt,He,Ue[de].data);for(let Fe=0;Fe<ie.length;Fe++){let St=ie[Fe].image[de].image;Dt?H&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe+1,0,0,St.width,St.height,pt,He,St.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe+1,jt,St.width,St.height,0,pt,He,St.data)}}else{Dt?H&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,0,0,pt,He,Ue[de]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,jt,pt,He,Ue[de]);for(let Fe=0;Fe<ie.length;Fe++){let Re=ie[Fe];Dt?H&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe+1,0,0,pt,He,Re.image[de]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+de,Fe+1,jt,pt,He,Re.image[de])}}}g(D)&&m(i.TEXTURE_CUBE_MAP),ae.__version=me.version,D.onUpdate&&D.onUpdate(D)}k.__version=D.version}function Ne(k,D,X,oe,me,ae){let Ze=s.convert(X.format,X.colorSpace),De=s.convert(X.type),Be=w(X.internalFormat,Ze,De,X.colorSpace),Bt=n.get(D),be=n.get(X);if(be.__renderTarget=D,!Bt.__hasExternalTextures){let Ue=Math.max(1,D.width>>ae),ct=Math.max(1,D.height>>ae);me===i.TEXTURE_3D||me===i.TEXTURE_2D_ARRAY?t.texImage3D(me,ae,Be,Ue,ct,D.depth,0,Ze,De,null):t.texImage2D(me,ae,Be,Ue,ct,0,Ze,De,null)}t.bindFramebuffer(i.FRAMEBUFFER,k),Ve(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,oe,me,be.__webglTexture,0,we(D)):(me===i.TEXTURE_2D||me>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&me<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,oe,me,be.__webglTexture,ae),t.bindFramebuffer(i.FRAMEBUFFER,null)}function pe(k,D,X){if(i.bindRenderbuffer(i.RENDERBUFFER,k),D.depthBuffer){let oe=D.depthTexture,me=oe&&oe.isDepthTexture?oe.type:null,ae=A(D.stencilBuffer,me),Ze=D.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,De=we(D);Ve(D)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,De,ae,D.width,D.height):X?i.renderbufferStorageMultisample(i.RENDERBUFFER,De,ae,D.width,D.height):i.renderbufferStorage(i.RENDERBUFFER,ae,D.width,D.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ze,i.RENDERBUFFER,k)}else{let oe=D.textures;for(let me=0;me<oe.length;me++){let ae=oe[me],Ze=s.convert(ae.format,ae.colorSpace),De=s.convert(ae.type),Be=w(ae.internalFormat,Ze,De,ae.colorSpace),Bt=we(D);X&&Ve(D)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Bt,Be,D.width,D.height):Ve(D)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Bt,Be,D.width,D.height):i.renderbufferStorage(i.RENDERBUFFER,Be,D.width,D.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function je(k,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,k),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let oe=n.get(D.depthTexture);oe.__renderTarget=D,(!oe.__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),q(D.depthTexture,0);let me=oe.__webglTexture,ae=we(D);if(D.depthTexture.format===yd)Ve(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0,ae):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,me,0);else if(D.depthTexture.format===Id)Ve(D)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0,ae):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,me,0);else throw new Error("Unknown depthTexture format")}function dt(k){let D=n.get(k),X=k.isWebGLCubeRenderTarget===!0;if(D.__boundDepthTexture!==k.depthTexture){let oe=k.depthTexture;if(D.__depthDisposeCallback&&D.__depthDisposeCallback(),oe){let me=()=>{delete D.__boundDepthTexture,delete D.__depthDisposeCallback,oe.removeEventListener("dispose",me)};oe.addEventListener("dispose",me),D.__depthDisposeCallback=me}D.__boundDepthTexture=oe}if(k.depthTexture&&!D.__autoAllocateDepthBuffer){if(X)throw new Error("target.depthTexture not supported in Cube render targets");je(D.__webglFramebuffer,k)}else if(X){D.__webglDepthbuffer=[];for(let oe=0;oe<6;oe++)if(t.bindFramebuffer(i.FRAMEBUFFER,D.__webglFramebuffer[oe]),D.__webglDepthbuffer[oe]===void 0)D.__webglDepthbuffer[oe]=i.createRenderbuffer(),pe(D.__webglDepthbuffer[oe],k,!1);else{let me=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ae=D.__webglDepthbuffer[oe];i.bindRenderbuffer(i.RENDERBUFFER,ae),i.framebufferRenderbuffer(i.FRAMEBUFFER,me,i.RENDERBUFFER,ae)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,D.__webglFramebuffer),D.__webglDepthbuffer===void 0)D.__webglDepthbuffer=i.createRenderbuffer(),pe(D.__webglDepthbuffer,k,!1);else{let oe=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,me=D.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,me),i.framebufferRenderbuffer(i.FRAMEBUFFER,oe,i.RENDERBUFFER,me)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function ut(k,D,X){let oe=n.get(k);D!==void 0&&Ne(oe.__webglFramebuffer,k,k.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),X!==void 0&&dt(k)}function Xt(k){let D=k.texture,X=n.get(k),oe=n.get(D);k.addEventListener("dispose",T);let me=k.textures,ae=k.isWebGLCubeRenderTarget===!0,Ze=me.length>1;if(Ze||(oe.__webglTexture===void 0&&(oe.__webglTexture=i.createTexture()),oe.__version=D.version,o.memory.textures++),ae){X.__webglFramebuffer=[];for(let De=0;De<6;De++)if(D.mipmaps&&D.mipmaps.length>0){X.__webglFramebuffer[De]=[];for(let Be=0;Be<D.mipmaps.length;Be++)X.__webglFramebuffer[De][Be]=i.createFramebuffer()}else X.__webglFramebuffer[De]=i.createFramebuffer()}else{if(D.mipmaps&&D.mipmaps.length>0){X.__webglFramebuffer=[];for(let De=0;De<D.mipmaps.length;De++)X.__webglFramebuffer[De]=i.createFramebuffer()}else X.__webglFramebuffer=i.createFramebuffer();if(Ze)for(let De=0,Be=me.length;De<Be;De++){let Bt=n.get(me[De]);Bt.__webglTexture===void 0&&(Bt.__webglTexture=i.createTexture(),o.memory.textures++)}if(k.samples>0&&Ve(k)===!1){X.__webglMultisampledFramebuffer=i.createFramebuffer(),X.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,X.__webglMultisampledFramebuffer);for(let De=0;De<me.length;De++){let Be=me[De];X.__webglColorRenderbuffer[De]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,X.__webglColorRenderbuffer[De]);let Bt=s.convert(Be.format,Be.colorSpace),be=s.convert(Be.type),Ue=w(Be.internalFormat,Bt,be,Be.colorSpace,k.isXRRenderTarget===!0),ct=we(k);i.renderbufferStorageMultisample(i.RENDERBUFFER,ct,Ue,k.width,k.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+De,i.RENDERBUFFER,X.__webglColorRenderbuffer[De])}i.bindRenderbuffer(i.RENDERBUFFER,null),k.depthBuffer&&(X.__webglDepthRenderbuffer=i.createRenderbuffer(),pe(X.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(ae){t.bindTexture(i.TEXTURE_CUBE_MAP,oe.__webglTexture),We(i.TEXTURE_CUBE_MAP,D);for(let De=0;De<6;De++)if(D.mipmaps&&D.mipmaps.length>0)for(let Be=0;Be<D.mipmaps.length;Be++)Ne(X.__webglFramebuffer[De][Be],k,D,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+De,Be);else Ne(X.__webglFramebuffer[De],k,D,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+De,0);g(D)&&m(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ze){for(let De=0,Be=me.length;De<Be;De++){let Bt=me[De],be=n.get(Bt);t.bindTexture(i.TEXTURE_2D,be.__webglTexture),We(i.TEXTURE_2D,Bt),Ne(X.__webglFramebuffer,k,Bt,i.COLOR_ATTACHMENT0+De,i.TEXTURE_2D,0),g(Bt)&&m(i.TEXTURE_2D)}t.unbindTexture()}else{let De=i.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(De=k.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(De,oe.__webglTexture),We(De,D),D.mipmaps&&D.mipmaps.length>0)for(let Be=0;Be<D.mipmaps.length;Be++)Ne(X.__webglFramebuffer[Be],k,D,i.COLOR_ATTACHMENT0,De,Be);else Ne(X.__webglFramebuffer,k,D,i.COLOR_ATTACHMENT0,De,0);g(D)&&m(De),t.unbindTexture()}k.depthBuffer&&dt(k)}function ue(k){let D=k.textures;for(let X=0,oe=D.length;X<oe;X++){let me=D[X];if(g(me)){let ae=y(k),Ze=n.get(me).__webglTexture;t.bindTexture(ae,Ze),m(ae),t.unbindTexture()}}}let Ae=[],N=[];function Ke(k){if(k.samples>0){if(Ve(k)===!1){let D=k.textures,X=k.width,oe=k.height,me=i.COLOR_BUFFER_BIT,ae=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ze=n.get(k),De=D.length>1;if(De)for(let Be=0;Be<D.length;Be++)t.bindFramebuffer(i.FRAMEBUFFER,Ze.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ze.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ze.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ze.__webglFramebuffer);for(let Be=0;Be<D.length;Be++){if(k.resolveDepthBuffer&&(k.depthBuffer&&(me|=i.DEPTH_BUFFER_BIT),k.stencilBuffer&&k.resolveStencilBuffer&&(me|=i.STENCIL_BUFFER_BIT)),De){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ze.__webglColorRenderbuffer[Be]);let Bt=n.get(D[Be]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Bt,0)}i.blitFramebuffer(0,0,X,oe,0,0,X,oe,me,i.NEAREST),l===!0&&(Ae.length=0,N.length=0,Ae.push(i.COLOR_ATTACHMENT0+Be),k.depthBuffer&&k.resolveDepthBuffer===!1&&(Ae.push(ae),N.push(ae),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,N)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Ae))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),De)for(let Be=0;Be<D.length;Be++){t.bindFramebuffer(i.FRAMEBUFFER,Ze.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.RENDERBUFFER,Ze.__webglColorRenderbuffer[Be]);let Bt=n.get(D[Be]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ze.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Be,i.TEXTURE_2D,Bt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ze.__webglMultisampledFramebuffer)}else if(k.depthBuffer&&k.resolveDepthBuffer===!1&&l){let D=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[D])}}}function we(k){return Math.min(r.maxSamples,k.samples)}function Ve(k){let D=n.get(k);return k.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&D.__useRenderToTexture!==!1}function Ce(k){let D=o.render.frame;d.get(k)!==D&&(d.set(k,D),k.update())}function lt(k,D){let X=k.colorSpace,oe=k.format,me=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||X!==Mi&&X!==Da&&(Ut.getTransfer(X)===an?(oe!==Lr||me!==Co)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",X)),D}function Oe(k){return typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement?(c.width=k.naturalWidth||k.width,c.height=k.naturalHeight||k.height):typeof VideoFrame<"u"&&k instanceof VideoFrame?(c.width=k.displayWidth,c.height=k.displayHeight):(c.width=k.width,c.height=k.height),c}this.allocateTextureUnit=O,this.resetTextureUnits=U,this.setTexture2D=q,this.setTexture2DArray=Q,this.setTexture3D=K,this.setTextureCube=W,this.rebindTextures=ut,this.setupRenderTarget=Xt,this.updateRenderTargetMipmap=ue,this.updateMultisampleRenderTarget=Ke,this.setupDepthRenderbuffer=dt,this.setupFrameBufferTexture=Ne,this.useMultisampledRTT=Ve}function wq(i,e){function t(n,r=Da){let s,o=Ut.getTransfer(r);if(n===Co)return i.UNSIGNED_BYTE;if(n===I_)return i.UNSIGNED_SHORT_4_4_4_4;if(n===D_)return i.UNSIGNED_SHORT_5_5_5_1;if(n===$L)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===KL)return i.BYTE;if(n===JL)return i.SHORT;if(n===Fh)return i.UNSIGNED_SHORT;if(n===T_)return i.INT;if(n===Nl)return i.UNSIGNED_INT;if(n===gs)return i.FLOAT;if(n===Jh)return i.HALF_FLOAT;if(n===ek)return i.ALPHA;if(n===tk)return i.RGB;if(n===Lr)return i.RGBA;if(n===nk)return i.LUMINANCE;if(n===ik)return i.LUMINANCE_ALPHA;if(n===yd)return i.DEPTH_COMPONENT;if(n===Id)return i.DEPTH_STENCIL;if(n===P_)return i.RED;if(n===R_)return i.RED_INTEGER;if(n===rk)return i.RG;if(n===L_)return i.RG_INTEGER;if(n===k_)return i.RGBA_INTEGER;if(n===qg||n===Zg||n===Xg||n===Yg)if(o===an)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===qg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Zg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Xg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Yg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===qg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Zg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Xg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Yg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===m1||n===g1||n===v1||n===x1)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===m1)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===g1)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===v1)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===x1)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===w1||n===y1||n===b1)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===w1||n===y1)return o===an?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===b1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===A1||n===_1||n===S1||n===E1||n===C1||n===M1||n===T1||n===I1||n===D1||n===P1||n===R1||n===L1||n===k1||n===N1)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===A1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===_1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===S1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===E1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===C1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===M1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===T1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===I1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===D1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===P1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===R1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===L1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===k1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===N1)return o===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Qg||n===F1||n===O1)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Qg)return o===an?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===F1)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===O1)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===sk||n===B1||n===V1||n===U1)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===Qg)return s.COMPRESSED_RED_RGTC1_EXT;if(n===B1)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===V1)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===U1)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Td?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}var t_=class extends Fn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Vs=class extends yi{constructor(){super(),this.isGroup=!0,this.type="Group"}},yq={type:"move"},Rh=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Vs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Vs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new V,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new V),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Vs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new V,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new V),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null,a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(let v of e.hand.values()){let g=t.getJointPose(v,n),m=this._getHandJoint(c,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}let d=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],h=d.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(yq)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new Vs;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},bq=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Aq=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,n_=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let r=new Br,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,n=new Hs({vertexShader:bq,fragmentShader:Aq,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ht(new r0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},i_=class extends Mo{constructor(e,t){super();let n=this,r=null,s=1,o=null,a="local-floor",l=1,c=null,d=null,u=null,h=null,f=null,p=null,v=new n_,g=t.getContextAttributes(),m=null,y=null,w=[],A=[],C=new ye,E=null,T=new Fn;T.viewport=new Jt;let L=new Fn;L.viewport=new Jt;let S=[T,L],_=new t_,P=null,U=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let xe=w[se];return xe===void 0&&(xe=new Rh,w[se]=xe),xe.getTargetRaySpace()},this.getControllerGrip=function(se){let xe=w[se];return xe===void 0&&(xe=new Rh,w[se]=xe),xe.getGripSpace()},this.getHand=function(se){let xe=w[se];return xe===void 0&&(xe=new Rh,w[se]=xe),xe.getHandSpace()};function O(se){let xe=A.indexOf(se.inputSource);if(xe===-1)return;let Ne=w[xe];Ne!==void 0&&(Ne.update(se.inputSource,se.frame,c||o),Ne.dispatchEvent({type:se.type,data:se.inputSource}))}function z(){r.removeEventListener("select",O),r.removeEventListener("selectstart",O),r.removeEventListener("selectend",O),r.removeEventListener("squeeze",O),r.removeEventListener("squeezestart",O),r.removeEventListener("squeezeend",O),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",q);for(let se=0;se<w.length;se++){let xe=A[se];xe!==null&&(A[se]=null,w[se].disconnect(xe))}P=null,U=null,v.reset(),e.setRenderTarget(m),f=null,h=null,u=null,r=null,y=null,at.stop(),n.isPresenting=!1,e.setPixelRatio(E),e.setSize(C.width,C.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){s=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){a=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(se){c=se},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(se){return ce(this,null,function*(){if(r=se,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",O),r.addEventListener("selectstart",O),r.addEventListener("selectend",O),r.addEventListener("squeeze",O),r.addEventListener("squeezestart",O),r.addEventListener("squeezeend",O),r.addEventListener("end",z),r.addEventListener("inputsourceschange",q),g.xrCompatible!==!0&&(yield t.makeXRCompatible()),E=e.getPixelRatio(),e.getSize(C),r.renderState.layers===void 0){let xe={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,xe),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new To(f.framebufferWidth,f.framebufferHeight,{format:Lr,type:Co,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let xe=null,Ne=null,pe=null;g.depth&&(pe=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,xe=g.stencil?Id:yd,Ne=g.stencil?Td:Nl);let je={colorFormat:t.RGBA8,depthFormat:pe,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(je),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),y=new To(h.textureWidth,h.textureHeight,{format:Lr,type:Co,depthTexture:new o0(h.textureWidth,h.textureHeight,Ne,void 0,void 0,void 0,void 0,void 0,void 0,xe),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1})}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),at.setContext(r),at.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};function q(se){for(let xe=0;xe<se.removed.length;xe++){let Ne=se.removed[xe],pe=A.indexOf(Ne);pe>=0&&(A[pe]=null,w[pe].disconnect(Ne))}for(let xe=0;xe<se.added.length;xe++){let Ne=se.added[xe],pe=A.indexOf(Ne);if(pe===-1){for(let dt=0;dt<w.length;dt++)if(dt>=A.length){A.push(Ne),pe=dt;break}else if(A[dt]===null){A[dt]=Ne,pe=dt;break}if(pe===-1)break}let je=w[pe];je&&je.connect(Ne)}}let Q=new V,K=new V;function W(se,xe,Ne){Q.setFromMatrixPosition(xe.matrixWorld),K.setFromMatrixPosition(Ne.matrixWorld);let pe=Q.distanceTo(K),je=xe.projectionMatrix.elements,dt=Ne.projectionMatrix.elements,ut=je[14]/(je[10]-1),Xt=je[14]/(je[10]+1),ue=(je[9]+1)/je[5],Ae=(je[9]-1)/je[5],N=(je[8]-1)/je[0],Ke=(dt[8]+1)/dt[0],we=ut*N,Ve=ut*Ke,Ce=pe/(-N+Ke),lt=Ce*-N;if(xe.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(lt),se.translateZ(Ce),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert(),je[10]===-1)se.projectionMatrix.copy(xe.projectionMatrix),se.projectionMatrixInverse.copy(xe.projectionMatrixInverse);else{let Oe=ut+Ce,k=Xt+Ce,D=we-lt,X=Ve+(pe-lt),oe=ue*Xt/k*Oe,me=Ae*Xt/k*Oe;se.projectionMatrix.makePerspective(D,X,oe,me,Oe,k),se.projectionMatrixInverse.copy(se.projectionMatrix).invert()}}function Ee(se,xe){xe===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(xe.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(r===null)return;let xe=se.near,Ne=se.far;v.texture!==null&&(v.depthNear>0&&(xe=v.depthNear),v.depthFar>0&&(Ne=v.depthFar)),_.near=L.near=T.near=xe,_.far=L.far=T.far=Ne,(P!==_.near||U!==_.far)&&(r.updateRenderState({depthNear:_.near,depthFar:_.far}),P=_.near,U=_.far),T.layers.mask=se.layers.mask|2,L.layers.mask=se.layers.mask|4,_.layers.mask=T.layers.mask|L.layers.mask;let pe=se.parent,je=_.cameras;Ee(_,pe);for(let dt=0;dt<je.length;dt++)Ee(je[dt],pe);je.length===2?W(_,T,L):_.projectionMatrix.copy(T.projectionMatrix),Te(se,_,pe)};function Te(se,xe,Ne){Ne===null?se.matrix.copy(xe.matrixWorld):(se.matrix.copy(Ne.matrixWorld),se.matrix.invert(),se.matrix.multiply(xe.matrixWorld)),se.matrix.decompose(se.position,se.quaternion,se.scale),se.updateMatrixWorld(!0),se.projectionMatrix.copy(xe.projectionMatrix),se.projectionMatrixInverse.copy(xe.projectionMatrixInverse),se.isPerspectiveCamera&&(se.fov=Rd*2*Math.atan(1/se.projectionMatrix.elements[5]),se.zoom=1)}this.getCamera=function(){return _},this.getFoveation=function(){if(!(h===null&&f===null))return l},this.setFoveation=function(se){l=se,h!==null&&(h.fixedFoveation=se),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=se)},this.hasDepthSensing=function(){return v.texture!==null},this.getDepthSensingMesh=function(){return v.getMesh(_)};let ke=null;function We(se,xe){if(d=xe.getViewerPose(c||o),p=xe,d!==null){let Ne=d.views;f!==null&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let pe=!1;Ne.length!==_.cameras.length&&(_.cameras.length=0,pe=!0);for(let dt=0;dt<Ne.length;dt++){let ut=Ne[dt],Xt=null;if(f!==null)Xt=f.getViewport(ut);else{let Ae=u.getViewSubImage(h,ut);Xt=Ae.viewport,dt===0&&(e.setRenderTargetTextures(y,Ae.colorTexture,h.ignoreDepthValues?void 0:Ae.depthStencilTexture),e.setRenderTarget(y))}let ue=S[dt];ue===void 0&&(ue=new Fn,ue.layers.enable(dt),ue.viewport=new Jt,S[dt]=ue),ue.matrix.fromArray(ut.transform.matrix),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale),ue.projectionMatrix.fromArray(ut.projectionMatrix),ue.projectionMatrixInverse.copy(ue.projectionMatrix).invert(),ue.viewport.set(Xt.x,Xt.y,Xt.width,Xt.height),dt===0&&(_.matrix.copy(ue.matrix),_.matrix.decompose(_.position,_.quaternion,_.scale)),pe===!0&&_.cameras.push(ue)}let je=r.enabledFeatures;if(je&&je.includes("depth-sensing")){let dt=u.getDepthInformation(Ne[0]);dt&&dt.isValid&&dt.texture&&v.init(e,dt,r.renderState)}}for(let Ne=0;Ne<w.length;Ne++){let pe=A[Ne],je=w[Ne];pe!==null&&je!==void 0&&je.update(pe,xe,c||o)}ke&&ke(se,xe),xe.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:xe}),p=null}let at=new hk;at.setAnimationLoop(We),this.setAnimationLoop=function(se){ke=se},this.dispose=function(){}}},Il=new Fl,_q=new yt;function Sq(i,e){function t(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function n(g,m){m.color.getRGB(g.fogColor.value,uk(i)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,y,w,A){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),u(g,m)):m.isMeshPhongMaterial?(s(g,m),d(g,m)):m.isMeshStandardMaterial?(s(g,m),h(g,m),m.isMeshPhysicalMaterial&&f(g,m,A)):m.isMeshMatcapMaterial?(s(g,m),p(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&a(g,m)):m.isPointsMaterial?l(g,m,y,w):m.isSpriteMaterial?c(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===Ki&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===Ki&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let y=e.get(m),w=y.envMap,A=y.envMapRotation;w&&(g.envMap.value=w,Il.copy(A),Il.x*=-1,Il.y*=-1,Il.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(Il.y*=-1,Il.z*=-1),g.envMapRotation.value.setFromMatrix4(_q.makeRotationFromEuler(Il)),g.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap&&(g.lightMap.value=m.lightMap,g.lightMapIntensity.value=m.lightMapIntensity,t(m.lightMap,g.lightMapTransform)),m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,y,w){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*y,g.scale.value=w*.5,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function d(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function u(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),m.envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function f(g,m,y){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Ki&&g.clearcoatNormalScale.value.negate())),m.dispersion>0&&(g.dispersion.value=m.dispersion),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){let y=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(y.matrixWorld),g.nearDistance.value=y.shadow.camera.near,g.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Eq(i,e,t,n){let r={},s={},o=[],a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(y,w){let A=w.program;n.uniformBlockBinding(y,A)}function c(y,w){let A=r[y.id];A===void 0&&(p(y),A=d(y),r[y.id]=A,y.addEventListener("dispose",g));let C=w.program;n.updateUBOMapping(y,C);let E=e.render.frame;s[y.id]!==E&&(h(y),s[y.id]=E)}function d(y){let w=u();y.__bindingPointIndex=w;let A=i.createBuffer(),C=y.__size,E=y.usage;return i.bindBuffer(i.UNIFORM_BUFFER,A),i.bufferData(i.UNIFORM_BUFFER,C,E),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,w,A),A}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){let w=r[y.id],A=y.uniforms,C=y.__cache;i.bindBuffer(i.UNIFORM_BUFFER,w);for(let E=0,T=A.length;E<T;E++){let L=Array.isArray(A[E])?A[E]:[A[E]];for(let S=0,_=L.length;S<_;S++){let P=L[S];if(f(P,E,S,C)===!0){let U=P.__offset,O=Array.isArray(P.value)?P.value:[P.value],z=0;for(let q=0;q<O.length;q++){let Q=O[q],K=v(Q);typeof Q=="number"||typeof Q=="boolean"?(P.__data[0]=Q,i.bufferSubData(i.UNIFORM_BUFFER,U+z,P.__data)):Q.isMatrix3?(P.__data[0]=Q.elements[0],P.__data[1]=Q.elements[1],P.__data[2]=Q.elements[2],P.__data[3]=0,P.__data[4]=Q.elements[3],P.__data[5]=Q.elements[4],P.__data[6]=Q.elements[5],P.__data[7]=0,P.__data[8]=Q.elements[6],P.__data[9]=Q.elements[7],P.__data[10]=Q.elements[8],P.__data[11]=0):(Q.toArray(P.__data,z),z+=K.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,U,P.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function f(y,w,A,C){let E=y.value,T=w+"_"+A;if(C[T]===void 0)return typeof E=="number"||typeof E=="boolean"?C[T]=E:C[T]=E.clone(),!0;{let L=C[T];if(typeof E=="number"||typeof E=="boolean"){if(L!==E)return C[T]=E,!0}else if(L.equals(E)===!1)return L.copy(E),!0}return!1}function p(y){let w=y.uniforms,A=0,C=16;for(let T=0,L=w.length;T<L;T++){let S=Array.isArray(w[T])?w[T]:[w[T]];for(let _=0,P=S.length;_<P;_++){let U=S[_],O=Array.isArray(U.value)?U.value:[U.value];for(let z=0,q=O.length;z<q;z++){let Q=O[z],K=v(Q),W=A%C,Ee=W%K.boundary,Te=W+Ee;A+=Ee,Te!==0&&C-Te<K.storage&&(A+=C-Te),U.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),U.__offset=A,A+=K.storage}}}let E=A%C;return E>0&&(A+=C-E),y.__size=A,y.__cache={},this}function v(y){let w={boundary:0,storage:0};return typeof y=="number"||typeof y=="boolean"?(w.boundary=4,w.storage=4):y.isVector2?(w.boundary=8,w.storage=8):y.isVector3||y.isColor?(w.boundary=16,w.storage=12):y.isVector4?(w.boundary=16,w.storage=16):y.isMatrix3?(w.boundary=48,w.storage=48):y.isMatrix4?(w.boundary=64,w.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),w}function g(y){let w=y.target;w.removeEventListener("dispose",g);let A=o.indexOf(w.__bindingPointIndex);o.splice(A,1),i.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function m(){for(let y in r)i.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}var Nd=class{constructor(e={}){let{canvas:t=I7(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:u=!1,reverseDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let f;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=o;let p=new Uint32Array(4),v=new Int32Array(4),g=null,m=null,y=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fi,this.toneMapping=La,this.toneMappingExposure=1;let A=this,C=!1,E=0,T=0,L=null,S=-1,_=null,P=new Jt,U=new Jt,O=null,z=new ft(0),q=0,Q=t.width,K=t.height,W=1,Ee=null,Te=null,ke=new Jt(0,0,Q,K),We=new Jt(0,0,Q,K),at=!1,se=new Vh,xe=!1,Ne=!1,pe=new yt,je=new yt,dt=new V,ut=new Jt,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},ue=!1;function Ae(){return L===null?W:1}let N=n;function Ke(R,j){return t.getContext(R,j)}try{let R={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${C_}`),t.addEventListener("webglcontextlost",de,!1),t.addEventListener("webglcontextrestored",Fe,!1),t.addEventListener("webglcontextcreationerror",Re,!1),N===null){let j="webgl2";if(N=Ke(j,R),N===null)throw Ke(j)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(R){throw console.error("THREE.WebGLRenderer: "+R.message),R}let we,Ve,Ce,lt,Oe,k,D,X,oe,me,ae,Ze,De,Be,Bt,be,Ue,ct,pt,He,jt,Dt,un,H;function Pe(){we=new HG(N),we.init(),Dt=new wq(N,we),Ve=new NG(N,we,e,Dt),Ce=new gq(N,we),Ve.reverseDepthBuffer&&h&&Ce.buffers.depth.setReversed(!0),lt=new GG(N),Oe=new iq,k=new xq(N,we,Ce,Oe,Ve,Dt,lt),D=new OG(A),X=new UG(A),oe=new K7(N),un=new LG(N,oe),me=new zG(N,oe,lt,un),ae=new qG(N,me,oe,lt),pt=new WG(N,Ve,k),be=new FG(Oe),Ze=new nq(A,D,X,we,Ve,un,be),De=new Sq(A,Oe),Be=new sq,Bt=new uq(we),ct=new RG(A,D,X,Ce,ae,f,l),Ue=new pq(A,ae,Ve),H=new Eq(N,lt,Ve,Ce),He=new kG(N,we,lt),jt=new jG(N,we,lt),lt.programs=Ze.programs,A.capabilities=Ve,A.extensions=we,A.properties=Oe,A.renderLists=Be,A.shadowMap=Ue,A.state=Ce,A.info=lt}Pe();let ie=new i_(A,N);this.xr=ie,this.getContext=function(){return N},this.getContextAttributes=function(){return N.getContextAttributes()},this.forceContextLoss=function(){let R=we.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){let R=we.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(R){R!==void 0&&(W=R,this.setSize(Q,K,!1))},this.getSize=function(R){return R.set(Q,K)},this.setSize=function(R,j,J=!0){if(ie.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Q=R,K=j,t.width=Math.floor(R*W),t.height=Math.floor(j*W),J===!0&&(t.style.width=R+"px",t.style.height=j+"px"),this.setViewport(0,0,R,j)},this.getDrawingBufferSize=function(R){return R.set(Q*W,K*W).floor()},this.setDrawingBufferSize=function(R,j,J){Q=R,K=j,W=J,t.width=Math.floor(R*J),t.height=Math.floor(j*J),this.setViewport(0,0,R,j)},this.getCurrentViewport=function(R){return R.copy(P)},this.getViewport=function(R){return R.copy(ke)},this.setViewport=function(R,j,J,$){R.isVector4?ke.set(R.x,R.y,R.z,R.w):ke.set(R,j,J,$),Ce.viewport(P.copy(ke).multiplyScalar(W).round())},this.getScissor=function(R){return R.copy(We)},this.setScissor=function(R,j,J,$){R.isVector4?We.set(R.x,R.y,R.z,R.w):We.set(R,j,J,$),Ce.scissor(U.copy(We).multiplyScalar(W).round())},this.getScissorTest=function(){return at},this.setScissorTest=function(R){Ce.setScissorTest(at=R)},this.setOpaqueSort=function(R){Ee=R},this.setTransparentSort=function(R){Te=R},this.getClearColor=function(R){return R.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(R=!0,j=!0,J=!0){let $=0;if(R){let G=!1;if(L!==null){let _e=L.texture.format;G=_e===k_||_e===L_||_e===R_}if(G){let _e=L.texture.type,Le=_e===Co||_e===Nl||_e===Fh||_e===Td||_e===I_||_e===D_,Xe=ct.getClearColor(),Ye=ct.getClearAlpha(),gt=Xe.r,Et=Xe.g,Qe=Xe.b;Le?(p[0]=gt,p[1]=Et,p[2]=Qe,p[3]=Ye,N.clearBufferuiv(N.COLOR,0,p)):(v[0]=gt,v[1]=Et,v[2]=Qe,v[3]=Ye,N.clearBufferiv(N.COLOR,0,v))}else $|=N.COLOR_BUFFER_BIT}j&&($|=N.DEPTH_BUFFER_BIT),J&&($|=N.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),N.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",de,!1),t.removeEventListener("webglcontextrestored",Fe,!1),t.removeEventListener("webglcontextcreationerror",Re,!1),Be.dispose(),Bt.dispose(),Oe.dispose(),D.dispose(),X.dispose(),ae.dispose(),un.dispose(),H.dispose(),Ze.dispose(),ie.dispose(),ie.removeEventListener("sessionstart",OC),ie.removeEventListener("sessionend",BC),Ya.stop()};function de(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;let R=lt.autoReset,j=Ue.enabled,J=Ue.autoUpdate,$=Ue.needsUpdate,G=Ue.type;Pe(),lt.autoReset=R,Ue.enabled=j,Ue.autoUpdate=J,Ue.needsUpdate=$,Ue.type=G}function Re(R){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",R.statusMessage)}function St(R){let j=R.target;j.removeEventListener("dispose",St),Dn(j)}function Dn(R){bi(R),Oe.remove(R)}function bi(R){let j=Oe.get(R).programs;j!==void 0&&(j.forEach(function(J){Ze.releaseProgram(J)}),R.isShaderMaterial&&Ze.releaseShaderCache(R))}this.renderBufferDirect=function(R,j,J,$,G,_e){j===null&&(j=Xt);let Le=G.isMesh&&G.matrixWorld.determinant()<0,Xe=Y3(R,j,J,$,G);Ce.setMaterial($,Le);let Ye=J.index,gt=1;if($.wireframe===!0){if(Ye=me.getWireframeAttribute(J),Ye===void 0)return;gt=2}let Et=J.drawRange,Qe=J.attributes.position,Kt=Et.start*gt,hn=(Et.start+Et.count)*gt;_e!==null&&(Kt=Math.max(Kt,_e.start*gt),hn=Math.min(hn,(_e.start+_e.count)*gt)),Ye!==null?(Kt=Math.max(Kt,0),hn=Math.min(hn,Ye.count)):Qe!=null&&(Kt=Math.max(Kt,0),hn=Math.min(hn,Qe.count));let vn=hn-Kt;if(vn<0||vn===1/0)return;un.setup(G,$,Xe,J,Ye);let Hi,$t=He;if(Ye!==null&&(Hi=oe.get(Ye),$t=jt,$t.setIndex(Hi)),G.isMesh)$.wireframe===!0?(Ce.setLineWidth($.wireframeLinewidth*Ae()),$t.setMode(N.LINES)):$t.setMode(N.TRIANGLES);else if(G.isLine){let $e=$.linewidth;$e===void 0&&($e=1),Ce.setLineWidth($e*Ae()),G.isLineSegments?$t.setMode(N.LINES):G.isLineLoop?$t.setMode(N.LINE_LOOP):$t.setMode(N.LINE_STRIP)}else G.isPoints?$t.setMode(N.POINTS):G.isSprite&&$t.setMode(N.TRIANGLES);if(G.isBatchedMesh)if(G._multiDrawInstances!==null)$t.renderMultiDrawInstances(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount,G._multiDrawInstances);else if(we.get("WEBGL_multi_draw"))$t.renderMultiDraw(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount);else{let $e=G._multiDrawStarts,Xs=G._multiDrawCounts,en=G._multiDrawCount,Xr=Ye?oe.get(Ye).bytesPerElement:1,$l=Oe.get($).currentProgram.getUniforms();for(let rr=0;rr<en;rr++)$l.setValue(N,"_gl_DrawID",rr),$t.render($e[rr]/Xr,Xs[rr])}else if(G.isInstancedMesh)$t.renderInstances(Kt,vn,G.count);else if(J.isInstancedBufferGeometry){let $e=J._maxInstanceCount!==void 0?J._maxInstanceCount:1/0,Xs=Math.min(J.instanceCount,$e);$t.renderInstances(Kt,vn,Xs)}else $t.render(Kt,vn)};function rn(R,j,J){R.transparent===!0&&R.side===ps&&R.forceSinglePass===!1?(R.side=Ki,R.needsUpdate=!0,Mf(R,j,J),R.side=Us,R.needsUpdate=!0,Mf(R,j,J),R.side=ps):Mf(R,j,J)}this.compile=function(R,j,J=null){J===null&&(J=R),m=Bt.get(J),m.init(j),w.push(m),J.traverseVisible(function(G){G.isLight&&G.layers.test(j.layers)&&(m.pushLight(G),G.castShadow&&m.pushShadow(G))}),R!==J&&R.traverseVisible(function(G){G.isLight&&G.layers.test(j.layers)&&(m.pushLight(G),G.castShadow&&m.pushShadow(G))}),m.setupLights();let $=new Set;return R.traverse(function(G){if(!(G.isMesh||G.isPoints||G.isLine||G.isSprite))return;let _e=G.material;if(_e)if(Array.isArray(_e))for(let Le=0;Le<_e.length;Le++){let Xe=_e[Le];rn(Xe,J,G),$.add(Xe)}else rn(_e,J,G),$.add(_e)}),w.pop(),m=null,$},this.compileAsync=function(R,j,J=null){let $=this.compile(R,j,J);return new Promise(G=>{function _e(){if($.forEach(function(Le){Oe.get(Le).currentProgram.isReady()&&$.delete(Le)}),$.size===0){G(R);return}setTimeout(_e,10)}we.get("KHR_parallel_shader_compile")!==null?_e():setTimeout(_e,10)})};let Zr=null;function Zs(R){Zr&&Zr(R)}function OC(){Ya.stop()}function BC(){Ya.start()}let Ya=new hk;Ya.setAnimationLoop(Zs),typeof self<"u"&&Ya.setContext(self),this.setAnimationLoop=function(R){Zr=R,ie.setAnimationLoop(R),R===null?Ya.stop():Ya.start()},ie.addEventListener("sessionstart",OC),ie.addEventListener("sessionend",BC),this.render=function(R,j){if(j!==void 0&&j.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;if(R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),j.parent===null&&j.matrixWorldAutoUpdate===!0&&j.updateMatrixWorld(),ie.enabled===!0&&ie.isPresenting===!0&&(ie.cameraAutoUpdate===!0&&ie.updateCamera(j),j=ie.getCamera()),R.isScene===!0&&R.onBeforeRender(A,R,j,L),m=Bt.get(R,w.length),m.init(j),w.push(m),je.multiplyMatrices(j.projectionMatrix,j.matrixWorldInverse),se.setFromProjectionMatrix(je),Ne=this.localClippingEnabled,xe=be.init(this.clippingPlanes,Ne),g=Be.get(R,y.length),g.init(),y.push(g),ie.enabled===!0&&ie.isPresenting===!0){let _e=A.xr.getDepthSensingMesh();_e!==null&&fx(_e,j,-1/0,A.sortObjects)}fx(R,j,0,A.sortObjects),g.finish(),A.sortObjects===!0&&g.sort(Ee,Te),ue=ie.enabled===!1||ie.isPresenting===!1||ie.hasDepthSensing()===!1,ue&&ct.addToRenderList(g,R),this.info.render.frame++,xe===!0&&be.beginShadows();let J=m.state.shadowsArray;Ue.render(J,R,j),xe===!0&&be.endShadows(),this.info.autoReset===!0&&this.info.reset();let $=g.opaque,G=g.transmissive;if(m.setupLights(),j.isArrayCamera){let _e=j.cameras;if(G.length>0)for(let Le=0,Xe=_e.length;Le<Xe;Le++){let Ye=_e[Le];UC($,G,R,Ye)}ue&&ct.render(R);for(let Le=0,Xe=_e.length;Le<Xe;Le++){let Ye=_e[Le];VC(g,R,Ye,Ye.viewport)}}else G.length>0&&UC($,G,R,j),ue&&ct.render(R),VC(g,R,j);L!==null&&(k.updateMultisampleRenderTarget(L),k.updateRenderTargetMipmap(L)),R.isScene===!0&&R.onAfterRender(A,R,j),un.resetDefaultState(),S=-1,_=null,w.pop(),w.length>0?(m=w[w.length-1],xe===!0&&be.setGlobalState(A.clippingPlanes,m.state.camera)):m=null,y.pop(),y.length>0?g=y[y.length-1]:g=null};function fx(R,j,J,$){if(R.visible===!1)return;if(R.layers.test(j.layers)){if(R.isGroup)J=R.renderOrder;else if(R.isLOD)R.autoUpdate===!0&&R.update(j);else if(R.isLight)m.pushLight(R),R.castShadow&&m.pushShadow(R);else if(R.isSprite){if(!R.frustumCulled||se.intersectsSprite(R)){$&&ut.setFromMatrixPosition(R.matrixWorld).applyMatrix4(je);let Le=ae.update(R),Xe=R.material;Xe.visible&&g.push(R,Le,Xe,J,ut.z,null)}}else if((R.isMesh||R.isLine||R.isPoints)&&(!R.frustumCulled||se.intersectsObject(R))){let Le=ae.update(R),Xe=R.material;if($&&(R.boundingSphere!==void 0?(R.boundingSphere===null&&R.computeBoundingSphere(),ut.copy(R.boundingSphere.center)):(Le.boundingSphere===null&&Le.computeBoundingSphere(),ut.copy(Le.boundingSphere.center)),ut.applyMatrix4(R.matrixWorld).applyMatrix4(je)),Array.isArray(Xe)){let Ye=Le.groups;for(let gt=0,Et=Ye.length;gt<Et;gt++){let Qe=Ye[gt],Kt=Xe[Qe.materialIndex];Kt&&Kt.visible&&g.push(R,Le,Kt,J,ut.z,Qe)}}else Xe.visible&&g.push(R,Le,Xe,J,ut.z,null)}}let _e=R.children;for(let Le=0,Xe=_e.length;Le<Xe;Le++)fx(_e[Le],j,J,$)}function VC(R,j,J,$){let G=R.opaque,_e=R.transmissive,Le=R.transparent;m.setupLightsView(J),xe===!0&&be.setGlobalState(A.clippingPlanes,J),$&&Ce.viewport(P.copy($)),G.length>0&&Cf(G,j,J),_e.length>0&&Cf(_e,j,J),Le.length>0&&Cf(Le,j,J),Ce.buffers.depth.setTest(!0),Ce.buffers.depth.setMask(!0),Ce.buffers.color.setMask(!0),Ce.setPolygonOffset(!1)}function UC(R,j,J,$){if((J.isScene===!0?J.overrideMaterial:null)!==null)return;m.state.transmissionRenderTarget[$.id]===void 0&&(m.state.transmissionRenderTarget[$.id]=new To(1,1,{generateMipmaps:!0,type:we.has("EXT_color_buffer_half_float")||we.has("EXT_color_buffer_float")?Jh:Co,minFilter:Bs,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ut.workingColorSpace}));let _e=m.state.transmissionRenderTarget[$.id],Le=$.viewport||P;_e.setSize(Le.z,Le.w);let Xe=A.getRenderTarget();A.setRenderTarget(_e),A.getClearColor(z),q=A.getClearAlpha(),q<1&&A.setClearColor(16777215,.5),A.clear(),ue&&ct.render(J);let Ye=A.toneMapping;A.toneMapping=La;let gt=$.viewport;if($.viewport!==void 0&&($.viewport=void 0),m.setupLightsView($),xe===!0&&be.setGlobalState(A.clippingPlanes,$),Cf(R,J,$),k.updateMultisampleRenderTarget(_e),k.updateRenderTargetMipmap(_e),we.has("WEBGL_multisampled_render_to_texture")===!1){let Et=!1;for(let Qe=0,Kt=j.length;Qe<Kt;Qe++){let hn=j[Qe],vn=hn.object,Hi=hn.geometry,$t=hn.material,$e=hn.group;if($t.side===ps&&vn.layers.test($.layers)){let Xs=$t.side;$t.side=Ki,$t.needsUpdate=!0,HC(vn,J,$,Hi,$t,$e),$t.side=Xs,$t.needsUpdate=!0,Et=!0}}Et===!0&&(k.updateMultisampleRenderTarget(_e),k.updateRenderTargetMipmap(_e))}A.setRenderTarget(Xe),A.setClearColor(z,q),gt!==void 0&&($.viewport=gt),A.toneMapping=Ye}function Cf(R,j,J){let $=j.isScene===!0?j.overrideMaterial:null;for(let G=0,_e=R.length;G<_e;G++){let Le=R[G],Xe=Le.object,Ye=Le.geometry,gt=$===null?Le.material:$,Et=Le.group;Xe.layers.test(J.layers)&&HC(Xe,j,J,Ye,gt,Et)}}function HC(R,j,J,$,G,_e){R.onBeforeRender(A,j,J,$,G,_e),R.modelViewMatrix.multiplyMatrices(J.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),G.onBeforeRender(A,j,J,$,R,_e),G.transparent===!0&&G.side===ps&&G.forceSinglePass===!1?(G.side=Ki,G.needsUpdate=!0,A.renderBufferDirect(J,j,$,G,R,_e),G.side=Us,G.needsUpdate=!0,A.renderBufferDirect(J,j,$,G,R,_e),G.side=ps):A.renderBufferDirect(J,j,$,G,R,_e),R.onAfterRender(A,j,J,$,G,_e)}function Mf(R,j,J){j.isScene!==!0&&(j=Xt);let $=Oe.get(R),G=m.state.lights,_e=m.state.shadowsArray,Le=G.state.version,Xe=Ze.getParameters(R,G.state,_e,j,J),Ye=Ze.getProgramCacheKey(Xe),gt=$.programs;$.environment=R.isMeshStandardMaterial?j.environment:null,$.fog=j.fog,$.envMap=(R.isMeshStandardMaterial?X:D).get(R.envMap||$.environment),$.envMapRotation=$.environment!==null&&R.envMap===null?j.environmentRotation:R.envMapRotation,gt===void 0&&(R.addEventListener("dispose",St),gt=new Map,$.programs=gt);let Et=gt.get(Ye);if(Et!==void 0){if($.currentProgram===Et&&$.lightsStateVersion===Le)return jC(R,Xe),Et}else Xe.uniforms=Ze.getUniforms(R),R.onBeforeCompile(Xe,A),Et=Ze.acquireProgram(Xe,Ye),gt.set(Ye,Et),$.uniforms=Xe.uniforms;let Qe=$.uniforms;return(!R.isShaderMaterial&&!R.isRawShaderMaterial||R.clipping===!0)&&(Qe.clippingPlanes=be.uniform),jC(R,Xe),$.needsLights=K3(R),$.lightsStateVersion=Le,$.needsLights&&(Qe.ambientLightColor.value=G.state.ambient,Qe.lightProbe.value=G.state.probe,Qe.directionalLights.value=G.state.directional,Qe.directionalLightShadows.value=G.state.directionalShadow,Qe.spotLights.value=G.state.spot,Qe.spotLightShadows.value=G.state.spotShadow,Qe.rectAreaLights.value=G.state.rectArea,Qe.ltc_1.value=G.state.rectAreaLTC1,Qe.ltc_2.value=G.state.rectAreaLTC2,Qe.pointLights.value=G.state.point,Qe.pointLightShadows.value=G.state.pointShadow,Qe.hemisphereLights.value=G.state.hemi,Qe.directionalShadowMap.value=G.state.directionalShadowMap,Qe.directionalShadowMatrix.value=G.state.directionalShadowMatrix,Qe.spotShadowMap.value=G.state.spotShadowMap,Qe.spotLightMatrix.value=G.state.spotLightMatrix,Qe.spotLightMap.value=G.state.spotLightMap,Qe.pointShadowMap.value=G.state.pointShadowMap,Qe.pointShadowMatrix.value=G.state.pointShadowMatrix),$.currentProgram=Et,$.uniformsList=null,Et}function zC(R){if(R.uniformsList===null){let j=R.currentProgram.getUniforms();R.uniformsList=Ad.seqWithValue(j.seq,R.uniforms)}return R.uniformsList}function jC(R,j){let J=Oe.get(R);J.outputColorSpace=j.outputColorSpace,J.batching=j.batching,J.batchingColor=j.batchingColor,J.instancing=j.instancing,J.instancingColor=j.instancingColor,J.instancingMorph=j.instancingMorph,J.skinning=j.skinning,J.morphTargets=j.morphTargets,J.morphNormals=j.morphNormals,J.morphColors=j.morphColors,J.morphTargetsCount=j.morphTargetsCount,J.numClippingPlanes=j.numClippingPlanes,J.numIntersection=j.numClipIntersection,J.vertexAlphas=j.vertexAlphas,J.vertexTangents=j.vertexTangents,J.toneMapping=j.toneMapping}function Y3(R,j,J,$,G){j.isScene!==!0&&(j=Xt),k.resetTextureUnits();let _e=j.fog,Le=$.isMeshStandardMaterial?j.environment:null,Xe=L===null?A.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:Mi,Ye=($.isMeshStandardMaterial?X:D).get($.envMap||Le),gt=$.vertexColors===!0&&!!J.attributes.color&&J.attributes.color.itemSize===4,Et=!!J.attributes.tangent&&(!!$.normalMap||$.anisotropy>0),Qe=!!J.morphAttributes.position,Kt=!!J.morphAttributes.normal,hn=!!J.morphAttributes.color,vn=La;$.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(vn=A.toneMapping);let Hi=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,$t=Hi!==void 0?Hi.length:0,$e=Oe.get($),Xs=m.state.lights;if(xe===!0&&(Ne===!0||R!==_)){let wr=R===_&&$.id===S;be.setState($,R,wr)}let en=!1;$.version===$e.__version?($e.needsLights&&$e.lightsStateVersion!==Xs.state.version||$e.outputColorSpace!==Xe||G.isBatchedMesh&&$e.batching===!1||!G.isBatchedMesh&&$e.batching===!0||G.isBatchedMesh&&$e.batchingColor===!0&&G.colorTexture===null||G.isBatchedMesh&&$e.batchingColor===!1&&G.colorTexture!==null||G.isInstancedMesh&&$e.instancing===!1||!G.isInstancedMesh&&$e.instancing===!0||G.isSkinnedMesh&&$e.skinning===!1||!G.isSkinnedMesh&&$e.skinning===!0||G.isInstancedMesh&&$e.instancingColor===!0&&G.instanceColor===null||G.isInstancedMesh&&$e.instancingColor===!1&&G.instanceColor!==null||G.isInstancedMesh&&$e.instancingMorph===!0&&G.morphTexture===null||G.isInstancedMesh&&$e.instancingMorph===!1&&G.morphTexture!==null||$e.envMap!==Ye||$.fog===!0&&$e.fog!==_e||$e.numClippingPlanes!==void 0&&($e.numClippingPlanes!==be.numPlanes||$e.numIntersection!==be.numIntersection)||$e.vertexAlphas!==gt||$e.vertexTangents!==Et||$e.morphTargets!==Qe||$e.morphNormals!==Kt||$e.morphColors!==hn||$e.toneMapping!==vn||$e.morphTargetsCount!==$t)&&(en=!0):(en=!0,$e.__version=$.version);let Xr=$e.currentProgram;en===!0&&(Xr=Mf($,j,G));let $l=!1,rr=!1,$d=!1,xn=Xr.getUniforms(),ys=$e.uniforms;if(Ce.useProgram(Xr.program)&&($l=!0,rr=!0,$d=!0),$.id!==S&&(S=$.id,rr=!0),$l||_!==R){Ce.buffers.depth.getReversed()?(pe.copy(R.projectionMatrix),P7(pe),R7(pe),xn.setValue(N,"projectionMatrix",pe)):xn.setValue(N,"projectionMatrix",R.projectionMatrix),xn.setValue(N,"viewMatrix",R.matrixWorldInverse);let qo=xn.map.cameraPosition;qo!==void 0&&qo.setValue(N,dt.setFromMatrixPosition(R.matrixWorld)),Ve.logarithmicDepthBuffer&&xn.setValue(N,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&xn.setValue(N,"isOrthographic",R.isOrthographicCamera===!0),_!==R&&(_=R,rr=!0,$d=!0)}if(G.isSkinnedMesh){xn.setOptional(N,G,"bindMatrix"),xn.setOptional(N,G,"bindMatrixInverse");let wr=G.skeleton;wr&&(wr.boneTexture===null&&wr.computeBoneTexture(),xn.setValue(N,"boneTexture",wr.boneTexture,k))}G.isBatchedMesh&&(xn.setOptional(N,G,"batchingTexture"),xn.setValue(N,"batchingTexture",G._matricesTexture,k),xn.setOptional(N,G,"batchingIdTexture"),xn.setValue(N,"batchingIdTexture",G._indirectTexture,k),xn.setOptional(N,G,"batchingColorTexture"),G._colorsTexture!==null&&xn.setValue(N,"batchingColorTexture",G._colorsTexture,k));let eu=J.morphAttributes;if((eu.position!==void 0||eu.normal!==void 0||eu.color!==void 0)&&pt.update(G,J,Xr),(rr||$e.receiveShadow!==G.receiveShadow)&&($e.receiveShadow=G.receiveShadow,xn.setValue(N,"receiveShadow",G.receiveShadow)),$.isMeshGouraudMaterial&&$.envMap!==null&&(ys.envMap.value=Ye,ys.flipEnvMap.value=Ye.isCubeTexture&&Ye.isRenderTargetTexture===!1?-1:1),$.isMeshStandardMaterial&&$.envMap===null&&j.environment!==null&&(ys.envMapIntensity.value=j.environmentIntensity),rr&&(xn.setValue(N,"toneMappingExposure",A.toneMappingExposure),$e.needsLights&&Q3(ys,$d),_e&&$.fog===!0&&De.refreshFogUniforms(ys,_e),De.refreshMaterialUniforms(ys,$,W,K,m.state.transmissionRenderTarget[R.id]),Ad.upload(N,zC($e),ys,k)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(Ad.upload(N,zC($e),ys,k),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&xn.setValue(N,"center",G.center),xn.setValue(N,"modelViewMatrix",G.modelViewMatrix),xn.setValue(N,"normalMatrix",G.normalMatrix),xn.setValue(N,"modelMatrix",G.matrixWorld),$.isShaderMaterial||$.isRawShaderMaterial){let wr=$.uniformsGroups;for(let qo=0,Zo=wr.length;qo<Zo;qo++){let GC=wr[qo];H.update(GC,Xr),H.bind(GC,Xr)}}return Xr}function Q3(R,j){R.ambientLightColor.needsUpdate=j,R.lightProbe.needsUpdate=j,R.directionalLights.needsUpdate=j,R.directionalLightShadows.needsUpdate=j,R.pointLights.needsUpdate=j,R.pointLightShadows.needsUpdate=j,R.spotLights.needsUpdate=j,R.spotLightShadows.needsUpdate=j,R.rectAreaLights.needsUpdate=j,R.hemisphereLights.needsUpdate=j}function K3(R){return R.isMeshLambertMaterial||R.isMeshToonMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isShadowMaterial||R.isShaderMaterial&&R.lights===!0}this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(R,j,J){Oe.get(R.texture).__webglTexture=j,Oe.get(R.depthTexture).__webglTexture=J;let $=Oe.get(R);$.__hasExternalTextures=!0,$.__autoAllocateDepthBuffer=J===void 0,$.__autoAllocateDepthBuffer||we.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(R,j){let J=Oe.get(R);J.__webglFramebuffer=j,J.__useDefaultFramebuffer=j===void 0},this.setRenderTarget=function(R,j=0,J=0){L=R,E=j,T=J;let $=!0,G=null,_e=!1,Le=!1;if(R){let Ye=Oe.get(R);if(Ye.__useDefaultFramebuffer!==void 0)Ce.bindFramebuffer(N.FRAMEBUFFER,null),$=!1;else if(Ye.__webglFramebuffer===void 0)k.setupRenderTarget(R);else if(Ye.__hasExternalTextures)k.rebindTextures(R,Oe.get(R.texture).__webglTexture,Oe.get(R.depthTexture).__webglTexture);else if(R.depthBuffer){let Qe=R.depthTexture;if(Ye.__boundDepthTexture!==Qe){if(Qe!==null&&Oe.has(Qe)&&(R.width!==Qe.image.width||R.height!==Qe.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");k.setupDepthRenderbuffer(R)}}let gt=R.texture;(gt.isData3DTexture||gt.isDataArrayTexture||gt.isCompressedArrayTexture)&&(Le=!0);let Et=Oe.get(R).__webglFramebuffer;R.isWebGLCubeRenderTarget?(Array.isArray(Et[j])?G=Et[j][J]:G=Et[j],_e=!0):R.samples>0&&k.useMultisampledRTT(R)===!1?G=Oe.get(R).__webglMultisampledFramebuffer:Array.isArray(Et)?G=Et[J]:G=Et,P.copy(R.viewport),U.copy(R.scissor),O=R.scissorTest}else P.copy(ke).multiplyScalar(W).floor(),U.copy(We).multiplyScalar(W).floor(),O=at;if(Ce.bindFramebuffer(N.FRAMEBUFFER,G)&&$&&Ce.drawBuffers(R,G),Ce.viewport(P),Ce.scissor(U),Ce.setScissorTest(O),_e){let Ye=Oe.get(R.texture);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+j,Ye.__webglTexture,J)}else if(Le){let Ye=Oe.get(R.texture),gt=j||0;N.framebufferTextureLayer(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,Ye.__webglTexture,J||0,gt)}S=-1},this.readRenderTargetPixels=function(R,j,J,$,G,_e,Le){if(!(R&&R.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Xe=Oe.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&Le!==void 0&&(Xe=Xe[Le]),Xe){Ce.bindFramebuffer(N.FRAMEBUFFER,Xe);try{let Ye=R.texture,gt=Ye.format,Et=Ye.type;if(!Ve.textureFormatReadable(gt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ve.textureTypeReadable(Et)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}j>=0&&j<=R.width-$&&J>=0&&J<=R.height-G&&N.readPixels(j,J,$,G,Dt.convert(gt),Dt.convert(Et),_e)}finally{let Ye=L!==null?Oe.get(L).__webglFramebuffer:null;Ce.bindFramebuffer(N.FRAMEBUFFER,Ye)}}},this.readRenderTargetPixelsAsync=function(R,j,J,$,G,_e,Le){return ce(this,null,function*(){if(!(R&&R.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Xe=Oe.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&Le!==void 0&&(Xe=Xe[Le]),Xe){let Ye=R.texture,gt=Ye.format,Et=Ye.type;if(!Ve.textureFormatReadable(gt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ve.textureTypeReadable(Et))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(j>=0&&j<=R.width-$&&J>=0&&J<=R.height-G){Ce.bindFramebuffer(N.FRAMEBUFFER,Xe);let Qe=N.createBuffer();N.bindBuffer(N.PIXEL_PACK_BUFFER,Qe),N.bufferData(N.PIXEL_PACK_BUFFER,_e.byteLength,N.STREAM_READ),N.readPixels(j,J,$,G,Dt.convert(gt),Dt.convert(Et),0);let Kt=L!==null?Oe.get(L).__webglFramebuffer:null;Ce.bindFramebuffer(N.FRAMEBUFFER,Kt);let hn=N.fenceSync(N.SYNC_GPU_COMMANDS_COMPLETE,0);return N.flush(),yield D7(N,hn,4),N.bindBuffer(N.PIXEL_PACK_BUFFER,Qe),N.getBufferSubData(N.PIXEL_PACK_BUFFER,0,_e),N.deleteBuffer(Qe),N.deleteSync(hn),_e}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}})},this.copyFramebufferToTexture=function(R,j=null,J=0){R.isTexture!==!0&&(Mh("WebGLRenderer: copyFramebufferToTexture function signature has changed."),j=arguments[0]||null,R=arguments[1]);let $=Math.pow(2,-J),G=Math.floor(R.image.width*$),_e=Math.floor(R.image.height*$),Le=j!==null?j.x:0,Xe=j!==null?j.y:0;k.setTexture2D(R,0),N.copyTexSubImage2D(N.TEXTURE_2D,J,0,0,Le,Xe,G,_e),Ce.unbindTexture()},this.copyTextureToTexture=function(R,j,J=null,$=null,G=0){R.isTexture!==!0&&(Mh("WebGLRenderer: copyTextureToTexture function signature has changed."),$=arguments[0]||null,R=arguments[1],j=arguments[2],G=arguments[3]||0,J=null);let _e,Le,Xe,Ye,gt,Et,Qe,Kt,hn,vn=R.isCompressedTexture?R.mipmaps[G]:R.image;J!==null?(_e=J.max.x-J.min.x,Le=J.max.y-J.min.y,Xe=J.isBox3?J.max.z-J.min.z:1,Ye=J.min.x,gt=J.min.y,Et=J.isBox3?J.min.z:0):(_e=vn.width,Le=vn.height,Xe=vn.depth||1,Ye=0,gt=0,Et=0),$!==null?(Qe=$.x,Kt=$.y,hn=$.z):(Qe=0,Kt=0,hn=0);let Hi=Dt.convert(j.format),$t=Dt.convert(j.type),$e;j.isData3DTexture?(k.setTexture3D(j,0),$e=N.TEXTURE_3D):j.isDataArrayTexture||j.isCompressedArrayTexture?(k.setTexture2DArray(j,0),$e=N.TEXTURE_2D_ARRAY):(k.setTexture2D(j,0),$e=N.TEXTURE_2D),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,j.flipY),N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),N.pixelStorei(N.UNPACK_ALIGNMENT,j.unpackAlignment);let Xs=N.getParameter(N.UNPACK_ROW_LENGTH),en=N.getParameter(N.UNPACK_IMAGE_HEIGHT),Xr=N.getParameter(N.UNPACK_SKIP_PIXELS),$l=N.getParameter(N.UNPACK_SKIP_ROWS),rr=N.getParameter(N.UNPACK_SKIP_IMAGES);N.pixelStorei(N.UNPACK_ROW_LENGTH,vn.width),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,vn.height),N.pixelStorei(N.UNPACK_SKIP_PIXELS,Ye),N.pixelStorei(N.UNPACK_SKIP_ROWS,gt),N.pixelStorei(N.UNPACK_SKIP_IMAGES,Et);let $d=R.isDataArrayTexture||R.isData3DTexture,xn=j.isDataArrayTexture||j.isData3DTexture;if(R.isRenderTargetTexture||R.isDepthTexture){let ys=Oe.get(R),eu=Oe.get(j),wr=Oe.get(ys.__renderTarget),qo=Oe.get(eu.__renderTarget);Ce.bindFramebuffer(N.READ_FRAMEBUFFER,wr.__webglFramebuffer),Ce.bindFramebuffer(N.DRAW_FRAMEBUFFER,qo.__webglFramebuffer);for(let Zo=0;Zo<Xe;Zo++)$d&&N.framebufferTextureLayer(N.READ_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Oe.get(R).__webglTexture,G,Et+Zo),R.isDepthTexture?(xn&&N.framebufferTextureLayer(N.DRAW_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Oe.get(j).__webglTexture,G,hn+Zo),N.blitFramebuffer(Ye,gt,_e,Le,Qe,Kt,_e,Le,N.DEPTH_BUFFER_BIT,N.NEAREST)):xn?N.copyTexSubImage3D($e,G,Qe,Kt,hn+Zo,Ye,gt,_e,Le):N.copyTexSubImage2D($e,G,Qe,Kt,hn+Zo,Ye,gt,_e,Le);Ce.bindFramebuffer(N.READ_FRAMEBUFFER,null),Ce.bindFramebuffer(N.DRAW_FRAMEBUFFER,null)}else xn?R.isDataTexture||R.isData3DTexture?N.texSubImage3D($e,G,Qe,Kt,hn,_e,Le,Xe,Hi,$t,vn.data):j.isCompressedArrayTexture?N.compressedTexSubImage3D($e,G,Qe,Kt,hn,_e,Le,Xe,Hi,vn.data):N.texSubImage3D($e,G,Qe,Kt,hn,_e,Le,Xe,Hi,$t,vn):R.isDataTexture?N.texSubImage2D(N.TEXTURE_2D,G,Qe,Kt,_e,Le,Hi,$t,vn.data):R.isCompressedTexture?N.compressedTexSubImage2D(N.TEXTURE_2D,G,Qe,Kt,vn.width,vn.height,Hi,vn.data):N.texSubImage2D(N.TEXTURE_2D,G,Qe,Kt,_e,Le,Hi,$t,vn);N.pixelStorei(N.UNPACK_ROW_LENGTH,Xs),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,en),N.pixelStorei(N.UNPACK_SKIP_PIXELS,Xr),N.pixelStorei(N.UNPACK_SKIP_ROWS,$l),N.pixelStorei(N.UNPACK_SKIP_IMAGES,rr),G===0&&j.generateMipmaps&&N.generateMipmap($e),Ce.unbindTexture()},this.copyTextureToTexture3D=function(R,j,J=null,$=null,G=0){return R.isTexture!==!0&&(Mh("WebGLRenderer: copyTextureToTexture3D function signature has changed."),J=arguments[0]||null,$=arguments[1]||null,R=arguments[2],j=arguments[3],G=arguments[4]||0),Mh('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(R,j,J,$,G)},this.initRenderTarget=function(R){Oe.get(R).__webglFramebuffer===void 0&&k.setupRenderTarget(R)},this.initTexture=function(R){R.isCubeTexture?k.setTextureCube(R,0):R.isData3DTexture?k.setTexture3D(R,0):R.isDataArrayTexture||R.isCompressedArrayTexture?k.setTexture2DArray(R,0):k.setTexture2D(R,0),Ce.unbindTexture()},this.resetState=function(){E=0,T=0,L=null,Ce.reset(),un.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return So}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=Ut._getDrawingBufferColorSpace(e),t.unpackColorSpace=Ut._getUnpackColorSpace()}};var Fd=class extends yi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Fl,this.environmentIntensity=1,this.environmentRotation=new Fl,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},Uh=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=H1,this.updateRanges=[],this.version=0,this.uuid=kr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=kr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=kr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Bi=new V,Hh=class i{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix4(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyNormalMatrix(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.transformDirection(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ms(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=on(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=on(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=on(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=on(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=on(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ms(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ms(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ms(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ms(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=on(t,this.array),n=on(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=on(t,this.array),n=on(n,this.array),r=on(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=on(t,this.array),n=on(n,this.array),r=on(r,this.array),s=on(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Jn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new i(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};var EL=new V,CL=new Jt,ML=new Jt,Cq=new V,TL=new yt,Fg=new V,QA=new fr,IL=new yt,KA=new Io,a0=class extends Ht{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=MR,this.bindMatrix=new yt,this.bindMatrixInverse=new yt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Nr),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Fg),this.boundingBox.expandByPoint(Fg)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new fr),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Fg),this.boundingSphere.expandByPoint(Fg)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),QA.copy(this.boundingSphere),QA.applyMatrix4(r),e.ray.intersectsSphere(QA)!==!1&&(IL.copy(r).invert(),KA.copy(e.ray).applyMatrix4(IL),!(this.boundingBox!==null&&KA.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,KA)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Jt,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===MR?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===t7?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,r=this.geometry;CL.fromBufferAttribute(r.attributes.skinIndex,e),ML.fromBufferAttribute(r.attributes.skinWeight,e),EL.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){let o=ML.getComponent(s);if(o!==0){let a=CL.getComponent(s);TL.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Cq.copy(EL).applyMatrix4(TL),o)}}return t.applyMatrix4(this.bindMatrixInverse)}},zh=class extends yi{constructor(){super(),this.isBone=!0,this.type="Bone"}},l0=class extends Br{constructor(e=null,t=1,n=1,r,s,o,a,l,c=Ci,d=Ci,u,h){super(null,o,a,l,c,d,r,s,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},DL=new yt,Mq=new yt,c0=class i{constructor(e=[],t=[]){this.uuid=kr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new yt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new yt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){let a=e[s]?e[s].matrixWorld:Mq;DL.multiplyMatrices(a,t[s]),DL.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new i(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new l0(t,e,e,Lr,gs);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let s=e.bones[n],o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new zh),this.bones.push(o),this.boneInverses.push(new yt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){let o=t[r];e.bones.push(o.uuid);let a=n[r];e.boneInverses.push(a.toArray())}return e}},Ol=class extends Jn{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},md=new yt,PL=new yt,Og=[],RL=new Nr,Tq=new yt,_h=new Ht,Sh=new fr,d0=class extends Ht{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ol(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Tq)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Nr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,md),RL.copy(e.boundingBox).applyMatrix4(md),this.boundingBox.union(RL)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new fr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,md),Sh.copy(e.boundingSphere).applyMatrix4(md),this.boundingSphere.union(Sh)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let a=0;a<n.length;a++)n[a]=r[o+a]}raycast(e,t){let n=this.matrixWorld,r=this.count;if(_h.geometry=this.geometry,_h.material=this.material,_h.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Sh.copy(this.boundingSphere),Sh.applyMatrix4(n),e.ray.intersectsSphere(Sh)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,md),PL.multiplyMatrices(n,md),_h.matrixWorld=PL,_h.raycast(e,Og);for(let o=0,a=Og.length;o<a;o++){let l=Og[o];l.instanceId=s,l.object=this,t.push(l)}Og.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ol(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new l0(new Float32Array(r*this.count),r,this.count,P_,gs));let s=this.morphTexture.source.data.data,o=0;for(let c=0;c<n.length;c++)o+=n[c];let a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};var jh=class extends Mn{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new ft(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},u0=new V,h0=new V,LL=new yt,Eh=new Io,Bg=new fr,JA=new V,kL=new V,Od=class extends yi{constructor(e=new pr,t=new jh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)u0.fromBufferAttribute(t,r-1),h0.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=u0.distanceTo(h0);e.setAttribute("lineDistance",new Ji(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Bg.copy(n.boundingSphere),Bg.applyMatrix4(r),Bg.radius+=s,e.ray.intersectsSphere(Bg)===!1)return;LL.copy(r).invert(),Eh.copy(e.ray).applyMatrix4(LL);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,d=n.index,h=n.attributes.position;if(d!==null){let f=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);for(let v=f,g=p-1;v<g;v+=c){let m=d.getX(v),y=d.getX(v+1),w=Vg(this,e,Eh,l,m,y);w&&t.push(w)}if(this.isLineLoop){let v=d.getX(p-1),g=d.getX(f),m=Vg(this,e,Eh,l,v,g);m&&t.push(m)}}else{let f=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let v=f,g=p-1;v<g;v+=c){let m=Vg(this,e,Eh,l,v,v+1);m&&t.push(m)}if(this.isLineLoop){let v=Vg(this,e,Eh,l,p-1,f);v&&t.push(v)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function Vg(i,e,t,n,r,s){let o=i.geometry.attributes.position;if(u0.fromBufferAttribute(o,r),h0.fromBufferAttribute(o,s),t.distanceSqToSegment(u0,h0,JA,kL)>n)return;JA.applyMatrix4(i.matrixWorld);let l=e.ray.origin.distanceTo(JA);if(!(l<e.near||l>e.far))return{distance:l,point:kL.clone().applyMatrix4(i.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:i}}var NL=new V,FL=new V,f0=class extends Od{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)NL.fromBufferAttribute(t,r),FL.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+NL.distanceTo(FL);e.setAttribute("lineDistance",new Ji(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},p0=class extends Od{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},Gh=class extends Mn{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},OL=new yt,r_=new Io,Ug=new fr,Hg=new V,m0=class extends yi{constructor(e=new pr,t=new Gh){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ug.copy(n.boundingSphere),Ug.applyMatrix4(r),Ug.radius+=s,e.ray.intersectsSphere(Ug)===!1)return;OL.copy(r).invert(),r_.copy(e.ray).applyMatrix4(OL);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(c!==null){let h=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=h,v=f;p<v;p++){let g=c.getX(p);Hg.fromBufferAttribute(u,g),BL(Hg,g,l,r,e,t,this)}}else{let h=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=h,v=f;p<v;p++)Hg.fromBufferAttribute(u,p),BL(Hg,p,l,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function BL(i,e,t,n,r,s,o){let a=r_.distanceSqToPoint(i);if(a<t){let l=new V;r_.closestPointToPoint(i,l),l.applyMatrix4(n);let c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}var Fr=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,s=n.length,o;t?o=t:o=e*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);let d=n[r],h=n[r+1]-d,f=(o-d)/h;return(r+f)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);let o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new ye:new V);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new V,r=[],s=[],o=[],a=new V,l=new yt;for(let f=0;f<=e;f++){let p=f/e;r[f]=this.getTangentAt(p,new V)}s[0]=new V,o[0]=new V;let c=Number.MAX_VALUE,d=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);d<=c&&(c=d,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),h<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(Kn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(t===!0){let f=Math.acos(Kn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Wh=class extends Fr{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new ye){let n=t,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let d=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*d-f*u+this.aX,c=h*u+f*d+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},s_=class extends Wh{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}};function O_(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,d,u){let h=(o-s)/c-(a-s)/(c+d)+(a-o)/d,f=(a-o)/d-(l-o)/(d+u)+(l-a)/u;h*=d,f*=d,r(o,a,h,f)},calc:function(s){let o=s*s,a=o*s;return i+e*s+t*o+n*a}}}var zg=new V,$A=new O_,e1=new O_,t1=new O_,o_=class extends Fr{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new V){let n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,d;this.closed||a>0?c=r[(a-1)%s]:(zg.subVectors(r[0],r[1]).add(r[0]),c=zg);let u=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(zg.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=zg),this.curveType==="centripetal"||this.curveType==="chordal"){let f=this.curveType==="chordal"?.5:.25,p=Math.pow(c.distanceToSquared(u),f),v=Math.pow(u.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f);v<1e-4&&(v=1),p<1e-4&&(p=v),g<1e-4&&(g=v),$A.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,p,v,g),e1.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,p,v,g),t1.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,p,v,g)}else this.curveType==="catmullrom"&&($A.initCatmullRom(c.x,u.x,h.x,d.x,this.tension),e1.initCatmullRom(c.y,u.y,h.y,d.y,this.tension),t1.initCatmullRom(c.z,u.z,h.z,d.z,this.tension));return n.set($A.calc(l),e1.calc(l),t1.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new V().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function VL(i,e,t,n,r){let s=(n-e)*.5,o=(r-t)*.5,a=i*i,l=i*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*i+t}function Iq(i,e){let t=1-i;return t*t*e}function Dq(i,e){return 2*(1-i)*i*e}function Pq(i,e){return i*i*e}function Lh(i,e,t,n){return Iq(i,e)+Dq(i,t)+Pq(i,n)}function Rq(i,e){let t=1-i;return t*t*t*e}function Lq(i,e){let t=1-i;return 3*t*t*i*e}function kq(i,e){return 3*(1-i)*i*i*e}function Nq(i,e){return i*i*i*e}function kh(i,e,t,n,r){return Rq(i,e)+Lq(i,t)+kq(i,n)+Nq(i,r)}var g0=class extends Fr{constructor(e=new ye,t=new ye,n=new ye,r=new ye){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ye){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(kh(e,r.x,s.x,o.x,a.x),kh(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},a_=class extends Fr{constructor(e=new V,t=new V,n=new V,r=new V){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new V){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(kh(e,r.x,s.x,o.x,a.x),kh(e,r.y,s.y,o.y,a.y),kh(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},v0=class extends Fr{constructor(e=new ye,t=new ye){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ye){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ye){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},l_=class extends Fr{constructor(e=new V,t=new V){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new V){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new V){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},x0=class extends Fr{constructor(e=new ye,t=new ye,n=new ye){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ye){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Lh(e,r.x,s.x,o.x),Lh(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},c_=class extends Fr{constructor(e=new V,t=new V,n=new V){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new V){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Lh(e,r.x,s.x,o.x),Lh(e,r.y,s.y,o.y),Lh(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},w0=class extends Fr{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ye){let n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],d=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(VL(a,l.x,c.x,d.x,u.x),VL(a,l.y,c.y,d.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new ye().fromArray(r))}return this}},d_=Object.freeze({__proto__:null,ArcCurve:s_,CatmullRomCurve3:o_,CubicBezierCurve:g0,CubicBezierCurve3:a_,EllipseCurve:Wh,LineCurve:v0,LineCurve3:l_,QuadraticBezierCurve:x0,QuadraticBezierCurve3:c_,SplineCurve:w0}),u_=class extends Fr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new d_[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=n){let o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,s=this.curves;r<s.length;r++){let o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){let d=l[c];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(new d_[r.type]().fromJSON(r))}return this}},qh=class extends u_{constructor(e){super(),this.type="Path",this.currentPoint=new ye,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new v0(this.currentPoint.clone(),new ye(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let s=new x0(this.currentPoint.clone(),new ye(e,t),new ye(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){let a=new g0(this.currentPoint.clone(),new ye(e,t),new ye(n,r),new ye(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new w0(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){let a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){let c=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+c,t+d,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){let c=new Wh(e,t,n,r,s,o,a,l);if(this.curves.length>0){let u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);let d=c.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};var _d=class extends qh{constructor(e){super(e),this.uuid=kr(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(new qh().fromJSON(r))}return this}},Fq={triangulate:function(i,e,t=2){let n=e&&e.length,r=n?e[0]*t:i.length,s=vk(i,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,d,u,h,f;if(n&&(s=Hq(i,e,s,t)),i.length>80*t){a=c=i[0],l=d=i[1];for(let p=t;p<r;p+=t)u=i[p],h=i[p+1],u<a&&(a=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);f=Math.max(c-a,d-l),f=f!==0?32767/f:0}return Zh(s,o,t,a,l,f,0),o}};function vk(i,e,t,n,r){let s,o;if(r===Jq(i,e,t,n)>0)for(s=e;s<t;s+=n)o=UL(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=UL(s,i[s],i[s+1],o);return o&&k0(o,o.next)&&(Yh(o),o=o.next),o}function Bl(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(k0(t,t.next)||Cn(t.prev,t,t.next)===0)){if(Yh(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Zh(i,e,t,n,r,s,o){if(!i)return;!o&&s&&qq(i,n,r,s);let a=i,l,c;for(;i.prev!==i.next;){if(l=i.prev,c=i.next,s?Bq(i,n,r,s):Oq(i)){e.push(l.i/t|0),e.push(i.i/t|0),e.push(c.i/t|0),Yh(i),i=c.next,a=c.next;continue}if(i=c,i===a){o?o===1?(i=Vq(Bl(i),e,t),Zh(i,e,t,n,r,s,2)):o===2&&Uq(i,e,t,n,r,s):Zh(Bl(i),e,t,n,r,s,1);break}}}function Oq(i){let e=i.prev,t=i,n=i.next;if(Cn(e,t,n)>=0)return!1;let r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,c=n.y,d=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=n.next;for(;p!==e;){if(p.x>=d&&p.x<=h&&p.y>=u&&p.y<=f&&xd(r,a,s,l,o,c,p.x,p.y)&&Cn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Bq(i,e,t,n){let r=i.prev,s=i,o=i.next;if(Cn(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,d=r.y,u=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,p=d<u?d<h?d:h:u<h?u:h,v=a>l?a>c?a:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,m=h_(f,p,e,t,n),y=h_(v,g,e,t,n),w=i.prevZ,A=i.nextZ;for(;w&&w.z>=m&&A&&A.z<=y;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&xd(a,d,l,u,c,h,w.x,w.y)&&Cn(w.prev,w,w.next)>=0||(w=w.prevZ,A.x>=f&&A.x<=v&&A.y>=p&&A.y<=g&&A!==r&&A!==o&&xd(a,d,l,u,c,h,A.x,A.y)&&Cn(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;w&&w.z>=m;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&xd(a,d,l,u,c,h,w.x,w.y)&&Cn(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;A&&A.z<=y;){if(A.x>=f&&A.x<=v&&A.y>=p&&A.y<=g&&A!==r&&A!==o&&xd(a,d,l,u,c,h,A.x,A.y)&&Cn(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Vq(i,e,t){let n=i;do{let r=n.prev,s=n.next.next;!k0(r,s)&&xk(r,n,n.next,s)&&Xh(r,s)&&Xh(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Yh(n),Yh(n.next),n=i=s),n=n.next}while(n!==i);return Bl(n)}function Uq(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Yq(o,a)){let l=wk(o,a);o=Bl(o,o.next),l=Bl(l,l.next),Zh(o,e,t,n,r,s,0),Zh(l,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function Hq(i,e,t,n){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,c=vk(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Xq(c));for(r.sort(zq),s=0;s<r.length;s++)t=jq(r[s],t);return t}function zq(i,e){return i.x-e.x}function jq(i,e){let t=Gq(i,e);if(!t)return e;let n=wk(t,i);return Bl(n,n.next),Bl(t,t.next)}function Gq(i,e){let t=e,n=-1/0,r,s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>n&&(n=h,r=t.x<t.next.x?t:t.next,h===s))return r}t=t.next}while(t!==e);if(!r)return null;let a=r,l=r.x,c=r.y,d=1/0,u;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&xd(o<c?s:n,o,l,c,o<c?n:s,o,t.x,t.y)&&(u=Math.abs(o-t.y)/(s-t.x),Xh(t,i)&&(u<d||u===d&&(t.x>r.x||t.x===r.x&&Wq(r,t)))&&(r=t,d=u)),t=t.next;while(t!==a);return r}function Wq(i,e){return Cn(i.prev,i,e.prev)<0&&Cn(e.next,i,i.next)<0}function qq(i,e,t,n){let r=i;do r.z===0&&(r.z=h_(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,Zq(r)}function Zq(i){let e,t,n,r,s,o,a,l,c=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,c*=2}while(o>1);return i}function h_(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Xq(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function xd(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function Yq(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Qq(i,e)&&(Xh(i,e)&&Xh(e,i)&&Kq(i,e)&&(Cn(i.prev,i,e.prev)||Cn(i,e.prev,e))||k0(i,e)&&Cn(i.prev,i,i.next)>0&&Cn(e.prev,e,e.next)>0)}function Cn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function k0(i,e){return i.x===e.x&&i.y===e.y}function xk(i,e,t,n){let r=Gg(Cn(i,e,t)),s=Gg(Cn(i,e,n)),o=Gg(Cn(t,n,i)),a=Gg(Cn(t,n,e));return!!(r!==s&&o!==a||r===0&&jg(i,t,e)||s===0&&jg(i,n,e)||o===0&&jg(t,i,n)||a===0&&jg(t,e,n))}function jg(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Gg(i){return i>0?1:i<0?-1:0}function Qq(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&xk(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Xh(i,e){return Cn(i.prev,i,i.next)<0?Cn(i,e,i.next)>=0&&Cn(i,i.prev,e)>=0:Cn(i,e,i.prev)<0||Cn(i,i.next,e)<0}function Kq(i,e){let t=i,n=!1,r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function wk(i,e){let t=new f_(i.i,i.x,i.y),n=new f_(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function UL(i,e,t,n){let r=new f_(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Yh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function f_(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jq(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}var Sd=class i{static area(e){let t=e.length,n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return i.area(e)<0}static triangulateShape(e,t){let n=[],r=[],s=[];HL(e),zL(n,e);let o=e.length;t.forEach(HL);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,zL(n,t[l]);let a=Fq.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}};function HL(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function zL(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var y0=class i extends pr{constructor(e=new _d([new ye(.5,.5),new ye(-.5,.5),new ye(-.5,-.5),new ye(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){let c=e[a];o(c)}this.setAttribute("position",new Ji(r,3)),this.setAttribute("uv",new Ji(s,2)),this.computeVertexNormals();function o(a){let l=[],c=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,u=t.depth!==void 0?t.depth:1,h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,f=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:f-.1,v=t.bevelOffset!==void 0?t.bevelOffset:0,g=t.bevelSegments!==void 0?t.bevelSegments:3,m=t.extrudePath,y=t.UVGenerator!==void 0?t.UVGenerator:$q,w,A=!1,C,E,T,L;m&&(w=m.getSpacedPoints(d),A=!0,h=!1,C=m.computeFrenetFrames(d,!1),E=new V,T=new V,L=new V),h||(g=0,f=0,p=0,v=0);let S=a.extractPoints(c),_=S.shape,P=S.holes;if(!Sd.isClockWise(_)){_=_.reverse();for(let ue=0,Ae=P.length;ue<Ae;ue++){let N=P[ue];Sd.isClockWise(N)&&(P[ue]=N.reverse())}}let O=Sd.triangulateShape(_,P),z=_;for(let ue=0,Ae=P.length;ue<Ae;ue++){let N=P[ue];_=_.concat(N)}function q(ue,Ae,N){return Ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),ue.clone().addScaledVector(Ae,N)}let Q=_.length,K=O.length;function W(ue,Ae,N){let Ke,we,Ve,Ce=ue.x-Ae.x,lt=ue.y-Ae.y,Oe=N.x-ue.x,k=N.y-ue.y,D=Ce*Ce+lt*lt,X=Ce*k-lt*Oe;if(Math.abs(X)>Number.EPSILON){let oe=Math.sqrt(D),me=Math.sqrt(Oe*Oe+k*k),ae=Ae.x-lt/oe,Ze=Ae.y+Ce/oe,De=N.x-k/me,Be=N.y+Oe/me,Bt=((De-ae)*k-(Be-Ze)*Oe)/(Ce*k-lt*Oe);Ke=ae+Ce*Bt-ue.x,we=Ze+lt*Bt-ue.y;let be=Ke*Ke+we*we;if(be<=2)return new ye(Ke,we);Ve=Math.sqrt(be/2)}else{let oe=!1;Ce>Number.EPSILON?Oe>Number.EPSILON&&(oe=!0):Ce<-Number.EPSILON?Oe<-Number.EPSILON&&(oe=!0):Math.sign(lt)===Math.sign(k)&&(oe=!0),oe?(Ke=-lt,we=Ce,Ve=Math.sqrt(D)):(Ke=Ce,we=lt,Ve=Math.sqrt(D/2))}return new ye(Ke/Ve,we/Ve)}let Ee=[];for(let ue=0,Ae=z.length,N=Ae-1,Ke=ue+1;ue<Ae;ue++,N++,Ke++)N===Ae&&(N=0),Ke===Ae&&(Ke=0),Ee[ue]=W(z[ue],z[N],z[Ke]);let Te=[],ke,We=Ee.concat();for(let ue=0,Ae=P.length;ue<Ae;ue++){let N=P[ue];ke=[];for(let Ke=0,we=N.length,Ve=we-1,Ce=Ke+1;Ke<we;Ke++,Ve++,Ce++)Ve===we&&(Ve=0),Ce===we&&(Ce=0),ke[Ke]=W(N[Ke],N[Ve],N[Ce]);Te.push(ke),We=We.concat(ke)}for(let ue=0;ue<g;ue++){let Ae=ue/g,N=f*Math.cos(Ae*Math.PI/2),Ke=p*Math.sin(Ae*Math.PI/2)+v;for(let we=0,Ve=z.length;we<Ve;we++){let Ce=q(z[we],Ee[we],Ke);pe(Ce.x,Ce.y,-N)}for(let we=0,Ve=P.length;we<Ve;we++){let Ce=P[we];ke=Te[we];for(let lt=0,Oe=Ce.length;lt<Oe;lt++){let k=q(Ce[lt],ke[lt],Ke);pe(k.x,k.y,-N)}}}let at=p+v;for(let ue=0;ue<Q;ue++){let Ae=h?q(_[ue],We[ue],at):_[ue];A?(T.copy(C.normals[0]).multiplyScalar(Ae.x),E.copy(C.binormals[0]).multiplyScalar(Ae.y),L.copy(w[0]).add(T).add(E),pe(L.x,L.y,L.z)):pe(Ae.x,Ae.y,0)}for(let ue=1;ue<=d;ue++)for(let Ae=0;Ae<Q;Ae++){let N=h?q(_[Ae],We[Ae],at):_[Ae];A?(T.copy(C.normals[ue]).multiplyScalar(N.x),E.copy(C.binormals[ue]).multiplyScalar(N.y),L.copy(w[ue]).add(T).add(E),pe(L.x,L.y,L.z)):pe(N.x,N.y,u/d*ue)}for(let ue=g-1;ue>=0;ue--){let Ae=ue/g,N=f*Math.cos(Ae*Math.PI/2),Ke=p*Math.sin(Ae*Math.PI/2)+v;for(let we=0,Ve=z.length;we<Ve;we++){let Ce=q(z[we],Ee[we],Ke);pe(Ce.x,Ce.y,u+N)}for(let we=0,Ve=P.length;we<Ve;we++){let Ce=P[we];ke=Te[we];for(let lt=0,Oe=Ce.length;lt<Oe;lt++){let k=q(Ce[lt],ke[lt],Ke);A?pe(k.x,k.y+w[d-1].y,w[d-1].x+N):pe(k.x,k.y,u+N)}}}se(),xe();function se(){let ue=r.length/3;if(h){let Ae=0,N=Q*Ae;for(let Ke=0;Ke<K;Ke++){let we=O[Ke];je(we[2]+N,we[1]+N,we[0]+N)}Ae=d+g*2,N=Q*Ae;for(let Ke=0;Ke<K;Ke++){let we=O[Ke];je(we[0]+N,we[1]+N,we[2]+N)}}else{for(let Ae=0;Ae<K;Ae++){let N=O[Ae];je(N[2],N[1],N[0])}for(let Ae=0;Ae<K;Ae++){let N=O[Ae];je(N[0]+Q*d,N[1]+Q*d,N[2]+Q*d)}}n.addGroup(ue,r.length/3-ue,0)}function xe(){let ue=r.length/3,Ae=0;Ne(z,Ae),Ae+=z.length;for(let N=0,Ke=P.length;N<Ke;N++){let we=P[N];Ne(we,Ae),Ae+=we.length}n.addGroup(ue,r.length/3-ue,1)}function Ne(ue,Ae){let N=ue.length;for(;--N>=0;){let Ke=N,we=N-1;we<0&&(we=ue.length-1);for(let Ve=0,Ce=d+g*2;Ve<Ce;Ve++){let lt=Q*Ve,Oe=Q*(Ve+1),k=Ae+Ke+lt,D=Ae+we+lt,X=Ae+we+Oe,oe=Ae+Ke+Oe;dt(k,D,X,oe)}}}function pe(ue,Ae,N){l.push(ue),l.push(Ae),l.push(N)}function je(ue,Ae,N){ut(ue),ut(Ae),ut(N);let Ke=r.length/3,we=y.generateTopUV(n,r,Ke-3,Ke-2,Ke-1);Xt(we[0]),Xt(we[1]),Xt(we[2])}function dt(ue,Ae,N,Ke){ut(ue),ut(Ae),ut(Ke),ut(Ae),ut(N),ut(Ke);let we=r.length/3,Ve=y.generateSideWallUV(n,r,we-6,we-3,we-2,we-1);Xt(Ve[0]),Xt(Ve[1]),Xt(Ve[3]),Xt(Ve[1]),Xt(Ve[2]),Xt(Ve[3])}function ut(ue){r.push(l[ue*3+0]),r.push(l[ue*3+1]),r.push(l[ue*3+2])}function Xt(ue){s.push(ue.x),s.push(ue.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return eZ(t,n,e)}static fromJSON(e,t){let n=[];for(let s=0,o=e.shapes.length;s<o;s++){let a=t[e.shapes[s]];n.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new d_[r.type]().fromJSON(r)),new i(n,e.options)}},$q={generateTopUV:function(i,e,t,n,r){let s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],c=e[r*3],d=e[r*3+1];return[new ye(s,o),new ye(a,l),new ye(c,d)]},generateSideWallUV:function(i,e,t,n,r,s){let o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[n*3],d=e[n*3+1],u=e[n*3+2],h=e[r*3],f=e[r*3+1],p=e[r*3+2],v=e[s*3],g=e[s*3+1],m=e[s*3+2];return Math.abs(a-d)<Math.abs(o-c)?[new ye(o,1-l),new ye(c,1-u),new ye(h,1-p),new ye(v,1-m)]:[new ye(a,1-l),new ye(d,1-u),new ye(f,1-p),new ye(g,1-m)]}};function eZ(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var Bd=class extends Mn{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ak,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Fl,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},mr=class extends Bd{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ye(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Kn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ft(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ft(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ft(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};function Wg(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function tZ(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function nZ(i){function e(r,s){return i[r]-i[s]}let t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function jL(i,e,t){let n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){let a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function yk(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}var ka=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],s=t[n-1];n:{e:{let o;t:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break e}o=t.length;break t}if(!(e>=s)){let a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break e}o=n,n=0;break t}break n}for(;n<o;){let a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},p_=class extends ka{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:IR,endingEnd:IR}}intervalChanged_(e,t,n){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case DR:s=e,a=2*t-n;break;case PR:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case DR:o=e,l=2*n-t;break;case PR:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}let c=(n-t)*.5,d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),v=p*p,g=v*p,m=-h*g+2*h*v-h*p,y=(1+h)*g+(-1.5-2*h)*v+(-.5+h)*p+1,w=(-1-f)*g+(1.5+f)*v+.5*p,A=f*g-f*v;for(let C=0;C!==a;++C)s[C]=m*o[d+C]+y*o[c+C]+w*o[l+C]+A*o[u+C];return s}},m_=class extends ka{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(n-t)/(r-t),u=1-d;for(let h=0;h!==a;++h)s[h]=o[c+h]*u+o[l+h]*d;return s}},g_=class extends ka{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},Or=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Wg(t,this.TimeBufferType),this.values=Wg(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Wg(e.times,Array),values:Wg(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new g_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new m_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new p_(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Dd:t=this.InterpolantFactoryMethodDiscrete;break;case Pd:t=this.InterpolantFactoryMethodLinear;break;case _A:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Dd;case this.InterpolantFactoryMethodLinear:return Pd;case this.InterpolantFactoryMethodSmooth:return _A}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&tZ(r))for(let a=0,l=r.length;a!==l;++a){let c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===_A,s=e.length-1,o=1;for(let a=1;a<s;++a){let l=!1,c=e[a],d=e[a+1];if(c!==d&&(a!==1||c!==e[0]))if(r)l=!0;else{let u=a*n,h=u-n,f=u+n;for(let p=0;p!==n;++p){let v=t[u+p];if(v!==t[h+p]||v!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];let u=a*n,h=o*n;for(let f=0;f!==n;++f)t[h+f]=t[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};Or.prototype.TimeBufferType=Float32Array;Or.prototype.ValueBufferType=Float32Array;Or.prototype.DefaultInterpolation=Pd;var Na=class extends Or{constructor(e,t,n){super(e,t,n)}};Na.prototype.ValueTypeName="bool";Na.prototype.ValueBufferType=Array;Na.prototype.DefaultInterpolation=Dd;Na.prototype.InterpolantFactoryMethodLinear=void 0;Na.prototype.InterpolantFactoryMethodSmooth=void 0;var b0=class extends Or{};b0.prototype.ValueTypeName="color";var Po=class extends Or{};Po.prototype.ValueTypeName="number";var v_=class extends ka{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t),c=e*a;for(let d=c+a;c!==d;c+=4)$i.slerpFlat(s,0,o,c-a,o,c,l);return s}},Ro=class extends Or{InterpolantFactoryMethodLinear(e){return new v_(this.times,this.values,this.getValueSize(),e)}};Ro.prototype.ValueTypeName="quaternion";Ro.prototype.InterpolantFactoryMethodSmooth=void 0;var Fa=class extends Or{constructor(e,t,n){super(e,t,n)}};Fa.prototype.ValueTypeName="string";Fa.prototype.ValueBufferType=Array;Fa.prototype.DefaultInterpolation=Dd;Fa.prototype.InterpolantFactoryMethodLinear=void 0;Fa.prototype.InterpolantFactoryMethodSmooth=void 0;var Lo=class extends Or{};Lo.prototype.ValueTypeName="vector";var A0=class{constructor(e="",t=-1,n=[],r=n7){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=kr(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(rZ(n[o]).scale(r));let s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(Or.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){let s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);let d=nZ(l);l=jL(l,1,d),c=jL(c,1,d),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Po(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){let c=e[a],d=c.name.match(s);if(d&&d.length>1){let u=d[1],h=r[u];h||(r[u]=h=[]),h.push(c)}}let o=[];for(let a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(u,h,f,p,v){if(f.length!==0){let g=[],m=[];yk(f,g,m,p),g.length!==0&&v.push(new u(h,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode,l=e.length||-1,c=e.hierarchy||[];for(let u=0;u<c.length;u++){let h=c[u].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let f={},p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let v=0;v<h[p].morphTargets.length;v++)f[h[p].morphTargets[v]]=-1;for(let v in f){let g=[],m=[];for(let y=0;y!==h[p].morphTargets.length;++y){let w=h[p];g.push(w.time),m.push(w.morphTarget===v?1:0)}r.push(new Po(".morphTargetInfluence["+v+"]",g,m))}l=f.length*o}else{let f=".bones["+t[u].name+"]";n(Lo,f+".position",h,"pos",r),n(Ro,f+".quaternion",h,"rot",r),n(Lo,f+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function iZ(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Po;case"vector":case"vector2":case"vector3":case"vector4":return Lo;case"color":return b0;case"quaternion":return Ro;case"bool":case"boolean":return Na;case"string":return Fa}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function rZ(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=iZ(i.type);if(i.times===void 0){let t=[],n=[];yk(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var Pa={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},x_=class{constructor(e,t,n){let r=this,s=!1,o=0,a=0,l,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,u){return c.push(d,u),this},this.removeHandler=function(d){let u=c.indexOf(d);return u!==-1&&c.splice(u,2),this},this.getHandler=function(d){for(let u=0,h=c.length;u<h;u+=2){let f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(d))return p}return null}}},sZ=new x_,Va=(()=>{class i{constructor(t){this.manager=t!==void 0?t:sZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){let r=this;return new Promise(function(s,o){r.load(t,s,n,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return i.DEFAULT_MATERIAL_NAME="__DEFAULT",i})(),bo={},w_=class extends Error{constructor(e,t){super(e),this.response=t}},Vl=class extends Va{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=Pa.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(bo[e]!==void 0){bo[e].push({onLoad:t,onProgress:n,onError:r});return}bo[e]=[],bo[e].push({onLoad:t,onProgress:n,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let d=bo[e],u=c.body.getReader(),h=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),f=h?parseInt(h):0,p=f!==0,v=0,g=new ReadableStream({start(m){y();function y(){u.read().then(({done:w,value:A})=>{if(w)m.close();else{v+=A.byteLength;let C=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:f});for(let E=0,T=d.length;E<T;E++){let L=d[E];L.onProgress&&L.onProgress(C)}m.enqueue(A),y()}},w=>{m.error(w)})}}});return new Response(g)}else throw new w_(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return c.json();default:if(a===void 0)return c.text();{let u=/charset="?([^;"\s]*)"?/i.exec(a),h=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Pa.add(e,c);let d=bo[e];delete bo[e];for(let u=0,h=d.length;u<h;u++){let f=d[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{let d=bo[e];if(d===void 0)throw this.manager.itemError(e),c;delete bo[e];for(let u=0,h=d.length;u<h;u++){let f=d[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};var y_=class extends Va{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=Pa.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;let a=Oh("img");function l(){d(),Pa.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(u){d(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}};var _0=class extends Va{constructor(e){super(e)}load(e,t,n,r){let s=new Br,o=new y_(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}},Vd=class extends yi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ft(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}};var n1=new yt,GL=new V,WL=new V,Qh=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ye(512,512),this.map=null,this.mapPass=null,this.matrix=new yt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Vh,this._frameExtents=new ye(1,1),this._viewportCount=1,this._viewports=[new Jt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;GL.setFromMatrixPosition(e.matrixWorld),t.position.copy(GL),WL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(WL),t.updateMatrixWorld(),n1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n1),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(n1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},b_=class extends Qh{constructor(){super(new Fn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=Rd*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},S0=class extends Vd{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(yi.DEFAULT_UP),this.updateMatrix(),this.target=new yi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new b_}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},qL=new yt,Ch=new V,i1=new V,A_=class extends Qh{constructor(){super(new Fn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ye(4,2),this._viewportCount=6,this._viewports=[new Jt(2,1,1,1),new Jt(0,1,1,1),new Jt(3,1,1,1),new Jt(1,1,1,1),new Jt(3,0,1,1),new Jt(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Ch.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ch),i1.copy(n.position),i1.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(i1),n.updateMatrixWorld(),r.makeTranslation(-Ch.x,-Ch.y,-Ch.z),qL.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qL)}},E0=class extends Vd{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new A_}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},__=class extends Qh{constructor(){super(new kd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},zs=class extends Vd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(yi.DEFAULT_UP),this.updateMatrix(),this.target=new yi,this.shadow=new __}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Oa=class extends Vd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};var Ba=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var C0=class extends Va{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=Pa.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{r&&r(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;let l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Pa.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),Pa.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Pa.add(e,l),s.manager.itemStart(e)}};var B_="\\[\\]\\.:\\/",oZ=new RegExp("["+B_+"]","g"),V_="[^"+B_+"]",aZ="[^"+B_.replace("\\.","")+"]",lZ=/((?:WC+[\/:])*)/.source.replace("WC",V_),cZ=/(WCOD+)?/.source.replace("WCOD",aZ),dZ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",V_),uZ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",V_),hZ=new RegExp("^"+lZ+cZ+dZ+uZ+"$"),fZ=["material","materials","bones","map"],S_=class{constructor(e,t,n){let r=n||En.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},En=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(oZ,"")}static parseTrackName(t){let n=hZ.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);fZ.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){let r=function(o){for(let a=0;a<o.length;a++){let l=o[a];if(l.name===n||l.uuid===n)return l;let c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,s=n.propertyName,o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let d=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===d){d=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(d!==void 0){if(t[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[d]}}let a=t[s];if(a===void 0){let d=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+s+" but it wasn't found.",t);return}let l=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=S_,i})();En.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};En.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};En.prototype.GetterByBindingType=[En.prototype._getValue_direct,En.prototype._getValue_array,En.prototype._getValue_arrayElement,En.prototype._getValue_toArray];En.prototype.SetterByBindingTypeAndVersioning=[[En.prototype._setValue_direct,En.prototype._setValue_direct_setNeedsUpdate,En.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[En.prototype._setValue_array,En.prototype._setValue_array_setNeedsUpdate,En.prototype._setValue_array_setMatrixWorldNeedsUpdate],[En.prototype._setValue_arrayElement,En.prototype._setValue_arrayElement_setNeedsUpdate,En.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[En.prototype._setValue_fromArray,En.prototype._setValue_fromArray_setNeedsUpdate,En.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var ohe=new Float32Array(1);var ZL=new yt,Ud=class{constructor(e,t,n=0,r=1/0){this.ray=new Io(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Bh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ZL.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ZL),this}intersectObject(e,t=!0,n=[]){return E_(e,this,n,t),n.sort(XL),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)E_(e[r],this,n,t);return n.sort(XL),n}};function XL(i,e){return i.distance-e.distance}function E_(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){let s=i.children;for(let o=0,a=s.length;o<a;o++)E_(s[o],e,t,!0)}}var Kh=class{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Kn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var M0=class{constructor(){this.type="ShapePath",this.color=new ft,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new qh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(m){let y=[];for(let w=0,A=m.length;w<A;w++){let C=m[w],E=new _d;E.curves=C.curves,y.push(E)}return y}function n(m,y){let w=y.length,A=!1;for(let C=w-1,E=0;E<w;C=E++){let T=y[C],L=y[E],S=L.x-T.x,_=L.y-T.y;if(Math.abs(_)>Number.EPSILON){if(_<0&&(T=y[E],S=-S,L=y[C],_=-_),m.y<T.y||m.y>L.y)continue;if(m.y===T.y){if(m.x===T.x)return!0}else{let P=_*(m.x-T.x)-S*(m.y-T.y);if(P===0)return!0;if(P<0)continue;A=!A}}else{if(m.y!==T.y)continue;if(L.x<=m.x&&m.x<=T.x||T.x<=m.x&&m.x<=L.x)return!0}}return A}let r=Sd.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l,c=[];if(s.length===1)return a=s[0],l=new _d,l.curves=a.curves,c.push(l),c;let d=!r(s[0].getPoints());d=e?!d:d;let u=[],h=[],f=[],p=0,v;h[p]=void 0,f[p]=[];for(let m=0,y=s.length;m<y;m++)a=s[m],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!d&&h[p]&&p++,h[p]={s:new _d,p:v},h[p].s.curves=a.curves,d&&p++,f[p]=[]):f[p].push({h:a,p:v[0]});if(!h[0])return t(s);if(h.length>1){let m=!1,y=0;for(let w=0,A=h.length;w<A;w++)u[w]=[];for(let w=0,A=h.length;w<A;w++){let C=f[w];for(let E=0;E<C.length;E++){let T=C[E],L=!0;for(let S=0;S<h.length;S++)n(T.p,h[S].p)&&(w!==S&&y++,L?(L=!1,u[S].push(T)):m=!0);L&&u[w].push(T)}}y>0&&m===!1&&(f=u)}let g;for(let m=0,y=h.length;m<y;m++){l=h[m].s,c.push(l),g=f[m];for(let w=0,A=g.length;w<A;w++)l.holes.push(g[w].h)}return c}},T0=class extends Mo{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:C_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=C_);function U_(i,e){if(e===ok)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===$h||e===D0){let t=i.getIndex();if(t===null){let o=[],a=i.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let n=t.count-2,r=[];if(e===$h)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var jl=class extends Va{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Z_(t)}),this.register(function(t){return new X_(t)}),this.register(function(t){return new iS(t)}),this.register(function(t){return new rS(t)}),this.register(function(t){return new sS(t)}),this.register(function(t){return new Q_(t)}),this.register(function(t){return new K_(t)}),this.register(function(t){return new J_(t)}),this.register(function(t){return new $_(t)}),this.register(function(t){return new q_(t)}),this.register(function(t){return new eS(t)}),this.register(function(t){return new Y_(t)}),this.register(function(t){return new nS(t)}),this.register(function(t){return new tS(t)}),this.register(function(t){return new G_(t)}),this.register(function(t){return new oS(t)}),this.register(function(t){return new aS(t)})}load(e,t,n,r){let s=this,o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){let c=Ba.extractUrlBase(e);o=Ba.resolveURL(c,this.path)}else o=Ba.extractUrlBase(e);this.manager.itemStart(e);let a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Vl(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s,o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===Ck){try{o[Ot.KHR_BINARY_GLTF]=new lS(e)}catch(u){r&&r(u);return}s=JSON.parse(o[Ot.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let c=new mS(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){let u=this.pluginCallbacks[d](c);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){let u=s.extensionsUsed[d],h=s.extensionsRequired||[];switch(u){case Ot.KHR_MATERIALS_UNLIT:o[u]=new W_;break;case Ot.KHR_DRACO_MESH_COMPRESSION:o[u]=new cS(s,this.dracoLoader);break;case Ot.KHR_TEXTURE_TRANSFORM:o[u]=new dS;break;case Ot.KHR_MESH_QUANTIZATION:o[u]=new uS;break;default:h.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){let n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}};function pZ(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var Ot={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},G_=class{constructor(e){this.parser=e,this.name=Ot.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){let s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;let s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],c,d=new ft(16777215);l.color!==void 0&&d.setRGB(l.color[0],l.color[1],l.color[2],Mi);let u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new zs(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new E0(d),c.distance=u;break;case"spot":c=new S0(d),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,ko(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}},W_=class{constructor(){this.name=Ot.KHR_MATERIALS_UNLIT}getMaterialType(){return yn}extendParams(e,t,n){let r=[];e.color=new ft(1,1,1),e.opacity=1;let s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Mi),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,fi))}return Promise.all(r)}},q_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},Z_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){let a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ye(a,a)}return Promise.all(s)}},X_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_DISPERSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},Y_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},Q_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_SHEEN}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[];t.sheenColor=new ft(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){let a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Mi)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,fi)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},K_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},J_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_VOLUME}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new ft().setRGB(a[0],a[1],a[2],Mi),Promise.all(s)}},$_=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_IOR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},eS=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_SPECULAR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new ft().setRGB(a[0],a[1],a[2],Mi),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,fi)),Promise.all(s)}},tS=class{constructor(e){this.parser=e,this.name=Ot.EXT_MATERIALS_BUMP}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}},nS=class{constructor(e){this.parser=e,this.name=Ot.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:mr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},iS=class{constructor(e){this.parser=e,this.name=Ot.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;let s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}},rS=class{constructor(e){this.parser=e,this.name=Ot.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=n.textureLoader;if(a.uri){let c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},sS=class{constructor(e){this.parser=e,this.name=Ot.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],l=n.textureLoader;if(a.uri){let c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},oS=class{constructor(e){this.name=Ot.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){let r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){let l=r.byteOffset||0,c=r.byteLength||0,d=r.count,u=r.byteStride,h=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,u,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){let f=new ArrayBuffer(d*u);return o.decodeGltfBuffer(new Uint8Array(f),d,u,h,r.mode,r.filter),f})})}else return null}},aS=class{constructor(e){this.name=Ot.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;let r=t.meshes[n.mesh];for(let c of r.primitives)if(c.mode!==Vr.TRIANGLES&&c.mode!==Vr.TRIANGLE_STRIP&&c.mode!==Vr.TRIANGLE_FAN&&c.mode!==void 0)return null;let o=n.extensions[this.name].attributes,a=[],l={};for(let c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{let d=c.pop(),u=d.isGroup?d.children:[d],h=c[0].count,f=[];for(let p of u){let v=new yt,g=new V,m=new $i,y=new V(1,1,1),w=new d0(p.geometry,p.material,h);for(let A=0;A<h;A++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,A),l.ROTATION&&m.fromBufferAttribute(l.ROTATION,A),l.SCALE&&y.fromBufferAttribute(l.SCALE,A),w.setMatrixAt(A,v.compose(g,m,y));for(let A in l)if(A==="_COLOR_0"){let C=l[A];w.instanceColor=new Ol(C.array,C.itemSize,C.normalized)}else A!=="TRANSLATION"&&A!=="ROTATION"&&A!=="SCALE"&&p.geometry.setAttribute(A,l[A]);yi.prototype.copy.call(w,p),this.parser.assignFinalMaterial(w),f.push(w)}return d.isGroup?(d.clear(),d.add(...f),d):f[0]}))}},Ck="glTF",ef=12,Ak={JSON:1313821514,BIN:5130562},lS=class{constructor(e){this.name=Ot.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,ef),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Ck)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-ef,s=new DataView(e,ef),o=0;for(;o<r;){let a=s.getUint32(o,!0);o+=4;let l=s.getUint32(o,!0);if(o+=4,l===Ak.JSON){let c=new Uint8Array(e,ef+o,a);this.content=n.decode(c)}else if(l===Ak.BIN){let c=ef+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},cS=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ot.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(let d in o){let u=fS[d]||d.toLowerCase();a[u]=o[d]}for(let d in e.attributes){let u=fS[d]||d.toLowerCase();if(o[d]!==void 0){let h=n.accessors[e.attributes[d]],f=zd[h.componentType];c[u]=f.name,l[u]=h.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(u,h){r.decodeDracoFile(d,function(f){for(let p in f.attributes){let v=f.attributes[p],g=l[p];g!==void 0&&(v.normalized=g)}u(f)},a,c,Mi,h)})})}},dS=class{constructor(){this.name=Ot.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},uS=class{constructor(){this.name=Ot.KHR_MESH_QUANTIZATION}},N0=class extends ka{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,d=r-t,u=(n-t)/d,h=u*u,f=h*u,p=e*c,v=p-c,g=-2*f+3*h,m=f-h,y=1-g,w=m-h+u;for(let A=0;A!==a;A++){let C=o[v+A+a],E=o[v+A+l]*d,T=o[p+A+a],L=o[p+A]*d;s[A]=y*C+w*E+g*T+m*L}return s}},mZ=new $i,hS=class extends N0{interpolate_(e,t,n,r){let s=super.interpolate_(e,t,n,r);return mZ.fromArray(s).normalize().toArray(s),s}},Vr={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},zd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_k={9728:Ci,9729:Qi,9984:M_,9985:Ih,9986:gd,9987:Bs},Sk={33071:_o,33648:Nh,10497:kl},H_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fS={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ua={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gZ={CUBICSPLINE:void 0,LINEAR:Pd,STEP:Dd},z_={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function vZ(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Bd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Us})),i.DefaultMaterial}function zl(i,e,t){for(let n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function ko(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function xZ(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){let u=e[c];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);let o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){let u=e[c];if(n){let h=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):i.attributes.position;o.push(h)}if(r){let h=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):i.attributes.normal;a.push(h)}if(s){let h=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):i.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){let d=c[0],u=c[1],h=c[2];return n&&(i.morphAttributes.position=d),r&&(i.morphAttributes.normal=u),s&&(i.morphAttributes.color=h),i.morphTargetsRelative=!0,i})}function wZ(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function yZ(i){let e,t=i.extensions&&i.extensions[Ot.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+j_(t.attributes):e=i.indices+":"+j_(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+j_(i.targets[n]);return e}function j_(i){let e="",t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function pS(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function bZ(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":i.search(/\.ktx2($|\?)/i)>0||i.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}var AZ=new yt,mS=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new pZ,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,s=!1,o=-1;if(typeof navigator<"u"){let a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;let l=a.match(/Version\/(\d+)/);r=n&&l?parseInt(l[1],10):-1,s=a.indexOf("Firefox")>-1,o=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||s&&o<98?this.textureLoader=new _0(this.options.manager):this.textureLoader=new C0(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Vl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){let a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return zl(s,a,r),ko(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(let l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){let o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;let r=n.clone(),s=(o,a)=>{let l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(let[c,d]of o.children.entries())s(d,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let r=e(t[n]);if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let r=0;r<t.length;r++){let s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){let n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ot.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(s,o){n.load(Ba.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){let r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){let t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){let o=H_[r.type],a=zd[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Jn(c,o,l))}let s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){let a=o[0],l=H_[r.type],c=zd[r.componentType],d=c.BYTES_PER_ELEMENT,u=d*l,h=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0,v,g;if(f&&f!==u){let m=Math.floor(h/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count,w=t.cache.get(y);w||(v=new c(a,m*f,r.count*f/d),w=new Uh(v,f/d),t.cache.add(y,w)),g=new Hh(w,l,h%f/d,p)}else a===null?v=new c(r.count*l):v=new c(a,h,r.count*l),g=new Jn(v,l,p);if(r.sparse!==void 0){let m=H_.SCALAR,y=zd[r.sparse.indices.componentType],w=r.sparse.indices.byteOffset||0,A=r.sparse.values.byteOffset||0,C=new y(o[1],w,r.sparse.count*m),E=new c(o[2],A,r.sparse.count*l);a!==null&&(g=new Jn(g.array.slice(),g.itemSize,g.normalized)),g.normalized=!1;for(let T=0,L=C.length;T<L;T++){let S=C[T];if(g.setX(S,E[T*l]),l>=2&&g.setY(S,E[T*l+1]),l>=3&&g.setZ(S,E[T*l+2]),l>=4&&g.setW(S,E[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}g.normalized=p}return g})}loadTexture(e){let t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s],a=this.textureLoader;if(o.uri){let l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){let r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let c=this.loadImageSource(t,n).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",d.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(d.name=a.uri);let h=(s.samplers||{})[o.sampler]||{};return d.magFilter=_k[h.magFilter]||Qi,d.minFilter=_k[h.minFilter]||Bs,d.wrapS=Sk[h.wrapS]||kl,d.wrapT=Sk[h.wrapT]||kl,d.generateMipmaps=!d.isCompressedTexture&&d.minFilter!==Ci&&d.minFilter!==Qi,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){let n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());let o=r.images[e],a=self.URL||self.webkitURL,l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(u){c=!0;let h=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let d=Promise.resolve(l).then(function(u){return new Promise(function(h,f){let p=h;t.isImageBitmapLoader===!0&&(p=function(v){let g=new Br(v);g.needsUpdate=!0,h(g)}),t.load(Ba.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),ko(u,o),u.userData.mimeType=o.mimeType||bZ(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=d,d}assignTexture(e,t,n,r){let s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[Ot.KHR_TEXTURE_TRANSFORM]){let a=n.extensions!==void 0?n.extensions[Ot.KHR_TEXTURE_TRANSFORM]:void 0;if(a){let l=s.associations.get(o);o=s.extensions[Ot.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){let t=e.geometry,n=e.material,r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+n.uuid,l=this.cache.get(a);l||(l=new Gh,Mn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){let a="LineBasicMaterial:"+n.uuid,l=this.cache.get(a);l||(l=new jh,Mn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return Bd}loadMaterial(e){let t=this,n=this.json,r=this.extensions,s=n.materials[e],o,a={},l=s.extensions||{},c=[];if(l[Ot.KHR_MATERIALS_UNLIT]){let u=r[Ot.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,t))}else{let u=s.pbrMetallicRoughness||{};if(a.color=new ft(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){let h=u.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],Mi),a.opacity=h[3]}u.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",u.baseColorTexture,fi)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=ps);let d=s.alphaMode||z_.OPAQUE;if(d===z_.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,d===z_.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==yn&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ye(1,1),s.normalTexture.scale!==void 0)){let u=s.normalTexture.scale;a.normalScale.set(u,u)}if(s.occlusionTexture!==void 0&&o!==yn&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==yn){let u=s.emissiveFactor;a.emissive=new ft().setRGB(u[0],u[1],u[2],Mi)}return s.emissiveTexture!==void 0&&o!==yn&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,fi)),Promise.all(c).then(function(){let u=new o(a);return s.name&&(u.name=s.name),ko(u,s),t.associations.set(u,{materials:e}),s.extensions&&zl(r,u,s),u})}createUniqueName(e){let t=En.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[Ot.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return Ek(l,a,t)})}let o=[];for(let a=0,l=e.length;a<l;a++){let c=e[a],d=yZ(c),u=r[d];if(u)o.push(u.promise);else{let h;c.extensions&&c.extensions[Ot.KHR_DRACO_MESH_COMPRESSION]?h=s(c):h=Ek(new pr,c,t),r[d]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){let t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){let d=o[l].material===void 0?vZ(this.cache):this.getDependency("material",o[l].material);a.push(d)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){let c=l.slice(0,l.length-1),d=l[l.length-1],u=[];for(let f=0,p=d.length;f<p;f++){let v=d[f],g=o[f],m,y=c[f];if(g.mode===Vr.TRIANGLES||g.mode===Vr.TRIANGLE_STRIP||g.mode===Vr.TRIANGLE_FAN||g.mode===void 0)m=s.isSkinnedMesh===!0?new a0(v,y):new Ht(v,y),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===Vr.TRIANGLE_STRIP?m.geometry=U_(m.geometry,D0):g.mode===Vr.TRIANGLE_FAN&&(m.geometry=U_(m.geometry,$h));else if(g.mode===Vr.LINES)m=new f0(v,y);else if(g.mode===Vr.LINE_STRIP)m=new Od(v,y);else if(g.mode===Vr.LINE_LOOP)m=new p0(v,y);else if(g.mode===Vr.POINTS)m=new m0(v,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&wZ(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),ko(m,s),g.extensions&&zl(r,m,g),t.assignFinalMaterial(m),u.push(m)}for(let f=0,p=u.length;f<p;f++)t.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return s.extensions&&zl(r,u[0],s),u[0];let h=new Vs;s.extensions&&zl(r,h,s),t.associations.set(h,{meshes:e});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}loadCamera(e){let t,n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Fn(R0.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new kd(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ko(t,n),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){let s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){let u=o[c];if(u){a.push(u);let h=new yt;s!==null&&h.fromArray(s.array,c*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new c0(a,l)})}loadAnimation(e){let t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],d=[];for(let u=0,h=r.channels.length;u<h;u++){let f=r.channels[u],p=r.samplers[f.sampler],v=f.target,g=v.node,m=r.parameters!==void 0?r.parameters[p.input]:p.input,y=r.parameters!==void 0?r.parameters[p.output]:p.output;v.node!==void 0&&(o.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",m)),l.push(this.getDependency("accessor",y)),c.push(p),d.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(d)]).then(function(u){let h=u[0],f=u[1],p=u[2],v=u[3],g=u[4],m=[];for(let y=0,w=h.length;y<w;y++){let A=h[y],C=f[y],E=p[y],T=v[y],L=g[y];if(A===void 0)continue;A.updateMatrix&&A.updateMatrix();let S=n._createAnimationTracks(A,C,E,T,L);if(S)for(let _=0;_<S.length;_++)m.push(S[_])}return new A0(s,void 0,m)})}createNodeMesh(e){let t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){let o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){let t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,d=a.length;c<d;c++)o.push(n.getDependency("node",a[c]));let l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){let d=c[0],u=c[1],h=c[2];h!==null&&d.traverse(function(f){f.isSkinnedMesh&&f.bind(h,AZ)});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}_loadNodeShallow(e){let t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let d;if(s.isBone===!0?d=new zh:c.length>1?d=new Vs:c.length===1?d=c[0]:d=new yi,d!==c[0])for(let u=0,h=c.length;u<h;u++)d.add(c[u]);if(s.name&&(d.userData.name=s.name,d.name=o),ko(d,s),s.extensions&&zl(n,d,s),s.matrix!==void 0){let u=new yt;u.fromArray(s.matrix),d.applyMatrix4(u)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){let t=this.extensions,n=this.json.scenes[e],r=this,s=new Vs;n.name&&(s.name=r.createUniqueName(n.name)),ko(s,n),n.extensions&&zl(t,s,n);let o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,u=l.length;d<u;d++)s.add(l[d]);let c=d=>{let u=new Map;for(let[h,f]of r.associations)(h instanceof Mn||h instanceof Br)&&u.set(h,f);return d.traverse(h=>{let f=r.associations.get(h);f!=null&&u.set(h,f)}),u};return r.associations=c(s),s})}_createAnimationTracks(e,t,n,r,s){let o=[],a=e.name?e.name:e.uuid,l=[];Ua[s.path]===Ua.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(a);let c;switch(Ua[s.path]){case Ua.weights:c=Po;break;case Ua.rotation:c=Ro;break;case Ua.position:case Ua.scale:c=Lo;break;default:switch(n.itemSize){case 1:c=Po;break;case 2:case 3:default:c=Lo;break}break}let d=r.interpolation!==void 0?gZ[r.interpolation]:Pd,u=this._getArrayFromAccessor(n);for(let h=0,f=l.length;h<f;h++){let p=new c(l[h]+"."+Ua[s.path],t.array,u,d);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let n=pS(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){let r=this instanceof Ro?hS:N0;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function _Z(i,e,t){let n=e.attributes,r=new Nr;if(n.POSITION!==void 0){let a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new V(l[0],l[1],l[2]),new V(c[0],c[1],c[2])),a.normalized){let d=pS(zd[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let s=e.targets;if(s!==void 0){let a=new V,l=new V;for(let c=0,d=s.length;c<d;c++){let u=s[c];if(u.POSITION!==void 0){let h=t.json.accessors[u.POSITION],f=h.min,p=h.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),h.normalized){let v=pS(zd[h.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;let o=new fr;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function Ek(i,e,t){let n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(let o in n){let a=fS[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!i.index){let o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return Ut.workingColorSpace!==Mi&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Ut.workingColorSpace}" not supported.`),ko(i,e),_Z(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?xZ(i,e.targets,t):i})}var Mk={type:"change"},vS={type:"start"},Ik={type:"end"},F0=new Io,Tk=new fs,SZ=Math.cos(70*R0.DEG2RAD),ti=new V,er=2*Math.PI,ln={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},gS=1e-6,Ha=class extends T0{constructor(e,t=null){super(e,t),this.state=ln.NONE,this.enabled=!0,this.target=new V,this.cursor=new V,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ul.ROTATE,MIDDLE:Ul.DOLLY,RIGHT:Ul.PAN},this.touches={ONE:Hl.ROTATE,TWO:Hl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new V,this._lastQuaternion=new $i,this._lastTargetPosition=new V,this._quat=new $i().setFromUnitVectors(e.up,new V(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Kh,this._sphericalDelta=new Kh,this._scale=1,this._panOffset=new V,this._rotateStart=new ye,this._rotateEnd=new ye,this._rotateDelta=new ye,this._panStart=new ye,this._panEnd=new ye,this._panDelta=new ye,this._dollyStart=new ye,this._dollyEnd=new ye,this._dollyDelta=new ye,this._dollyDirection=new V,this._mouse=new ye,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=CZ.bind(this),this._onPointerDown=EZ.bind(this),this._onPointerUp=MZ.bind(this),this._onContextMenu=kZ.bind(this),this._onMouseWheel=DZ.bind(this),this._onKeyDown=PZ.bind(this),this._onTouchStart=RZ.bind(this),this._onTouchMove=LZ.bind(this),this._onMouseDown=TZ.bind(this),this._onMouseMove=IZ.bind(this),this._interceptControlDown=NZ.bind(this),this._interceptControlUp=FZ.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Mk),this.update(),this.state=ln.NONE}update(e=null){let t=this.object.position;ti.copy(t).sub(this.target),ti.applyQuaternion(this._quat),this._spherical.setFromVector3(ti),this.autoRotate&&this.state===ln.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=er:n>Math.PI&&(n-=er),r<-Math.PI?r+=er:r>Math.PI&&(r-=er),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(ti.setFromSpherical(this._spherical),ti.applyQuaternion(this._quatInverse),t.copy(this.target).add(ti),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){let a=ti.length();o=this._clampDistance(a*this._scale);let l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){let a=new V(this._mouse.x,this._mouse.y,0);a.unproject(this.object);let l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;let c=new V(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),o=ti.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(F0.origin.copy(this.object.position),F0.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(F0.direction))<SZ?this.object.lookAt(this.target):(Tk.setFromNormalAndCoplanarPoint(this.object.up,this.target),F0.intersectPlane(Tk,this.target))))}else if(this.object.isOrthographicCamera){let o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>gS||8*(1-this._lastQuaternion.dot(this.object.quaternion))>gS||this._lastTargetPosition.distanceToSquared(this.target)>gS?(this.dispatchEvent(Mk),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?er/60*this.autoRotateSpeed*e:er/60/60*this.autoRotateSpeed}_getZoomScale(e){let t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){ti.setFromMatrixColumn(t,0),ti.multiplyScalar(-e),this._panOffset.add(ti)}_panUp(e,t){this.screenSpacePanning===!0?ti.setFromMatrixColumn(t,1):(ti.setFromMatrixColumn(t,0),ti.crossVectors(this.object.up,ti)),ti.multiplyScalar(e),this._panOffset.add(ti)}_pan(e,t){let n=this.domElement;if(this.object.isPerspectiveCamera){let r=this.object.position;ti.copy(r).sub(this.target);let s=ti.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,o=n.width,a=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(er*this._rotateDelta.x/t.clientHeight),this._rotateUp(er*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(er*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-er*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(er*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-er*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{let n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(er*this._rotateDelta.x/t.clientHeight),this._rotateUp(er*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new ye,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}};function EZ(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function CZ(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function MZ(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Ik),this.state=ln.NONE;break;case 1:let e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function TZ(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ul.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=ln.DOLLY;break;case Ul.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=ln.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=ln.ROTATE}break;case Ul.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=ln.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=ln.PAN}break;default:this.state=ln.NONE}this.state!==ln.NONE&&this.dispatchEvent(vS)}function IZ(i){switch(this.state){case ln.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case ln.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case ln.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function DZ(i){this.enabled===!1||this.enableZoom===!1||this.state!==ln.NONE||(i.preventDefault(),this.dispatchEvent(vS),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(Ik))}function PZ(i){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(i)}function RZ(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case Hl.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=ln.TOUCH_ROTATE;break;case Hl.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=ln.TOUCH_PAN;break;default:this.state=ln.NONE}break;case 2:switch(this.touches.TWO){case Hl.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=ln.TOUCH_DOLLY_PAN;break;case Hl.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=ln.TOUCH_DOLLY_ROTATE;break;default:this.state=ln.NONE}break;default:this.state=ln.NONE}this.state!==ln.NONE&&this.dispatchEvent(vS)}function LZ(i){switch(this._trackPointer(i),this.state){case ln.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case ln.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case ln.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case ln.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=ln.NONE}}function kZ(i){this.enabled!==!1&&i.preventDefault()}function NZ(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function FZ(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var Ur=class extends y0{constructor(e,t={}){let h=t,{bevelEnabled:n=!1,bevelSize:r=8,bevelThickness:s=10,font:o,height:a=50,size:l=100,lineHeight:c=1,letterSpacing:d=0}=h,u=mx(h,["bevelEnabled","bevelSize","bevelThickness","font","height","size","lineHeight","letterSpacing"]);if(o===void 0)super();else{let f=o.generateShapes(e,l,{lineHeight:c,letterSpacing:d});super(f,Ge(re({},u),{bevelEnabled:n,bevelSize:r,bevelThickness:s,depth:a}))}this.type="TextGeometry"}};var OZ=Object.defineProperty,BZ=(i,e,t)=>e in i?OZ(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xS=(i,e,t)=>(BZ(i,typeof e!="symbol"?e+"":e,t),t),Gl=class extends Va{constructor(e){super(e)}load(e,t,n,r){let s=new Vl(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{if(typeof o!="string")throw new Error("unsupported data type");let a=JSON.parse(o),l=this.parse(a);t&&t(l)},n,r)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new jd(e)}},jd=class{constructor(e){xS(this,"data"),this.data=e}generateShapes(e,t=100,n){let r=[],s=re({letterSpacing:0,lineHeight:1},n),o=VZ(e,t,this.data,s);for(let a=0,l=o.length;a<l;a++)Array.prototype.push.apply(r,o[a].toShapes(!1));return r}};xS(jd,"isFont");xS(jd,"type");function VZ(i,e,t,n){let r=Array.from(i),s=e/t.resolution,o=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*s,a=[],l=0,c=0;for(let d=0;d<r.length;d++){let u=r[d];if(u===`
`)l=0,c-=o*n.lineHeight;else{let h=UZ(u,s,l,c,t);h&&(l+=h.offsetX+n.letterSpacing,a.push(h.path))}}return a}function UZ(i,e,t,n,r){let s=r.glyphs[i]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+i+'" does not exists in font family '+r.familyName+".");return}let o=new M0,a,l,c,d,u,h,f,p;if(s.o){let v=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let g=0,m=v.length;g<m;)switch(v[g++]){case"m":a=parseInt(v[g++])*e+t,l=parseInt(v[g++])*e+n,o.moveTo(a,l);break;case"l":a=parseInt(v[g++])*e+t,l=parseInt(v[g++])*e+n,o.lineTo(a,l);break;case"q":c=parseInt(v[g++])*e+t,d=parseInt(v[g++])*e+n,u=parseInt(v[g++])*e+t,h=parseInt(v[g++])*e+n,o.quadraticCurveTo(u,h,c,d);break;case"b":c=parseInt(v[g++])*e+t,d=parseInt(v[g++])*e+n,u=parseInt(v[g++])*e+t,h=parseInt(v[g++])*e+n,f=parseInt(v[g++])*e+t,p=parseInt(v[g++])*e+n,o.bezierCurveTo(u,h,f,p,c,d);break}}return{offsetX:s.ha*e,path:o}}var za=class i{constructor(){this.checkScreenSize()}checkScreenSize(){window.addEventListener("resize",this.onResize.bind(this))}onResize(){location.reload()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var HZ=["modelContainer"];function zZ(i,e){if(i&1){let t=rt();x(0,"button",16),Z("click",function(){he(t);let r=Y();return r.changeModel("assets/model/mapTerrain.glb"),fe(r.mapTerrain=!0)}),x(1,"div",17),te(),x(2,"svg",18),B(3,"path",19),b()()()}}function jZ(i,e){if(i&1){let t=rt();x(0,"button",20),Z("click",function(){he(t);let r=Y();return r.changeModel("assets/model/map.glb"),fe(r.mapTerrain=!1)}),x(1,"div",21),te(),x(2,"svg",18),B(3,"path",19),b()()()}}function GZ(i,e){i&1&&B(0,"div",22)}function WZ(i,e){if(i&1){let t=rt();x(0,"div",23)(1,"div",24)(2,"p",25),M(3," Kiosk"),x(4,"b"),M(5),b(),M(6," already occupied, please select other kiosk!"),b()(),x(7,"div",26)(8,"button",27),Z("click",function(){he(t);let r=Y();return fe(r.router.navigate(["/dashboard"]))}),M(9,"Go back"),b(),x(10,"button",28),Z("click",function(){he(t);let r=Y();return fe(r.errorMessage="")}),M(11,"Okay"),b()()()}if(i&2){let t=Y();I(5),ge(t.kioskName)}}function qZ(i,e){if(i&1){let t=rt();x(0,"div",23)(1,"div",29)(2,"div",30),B(3,"img",31),b(),x(4,"div",32)(5,"p",33),M(6," Are you willing to procceed, using this kiosk "),x(7,"b"),M(8),b(),M(9,"?"),b(),x(10,"p",34),M(11," Description:"),x(12,"textarea",35),M(13),b()()(),x(14,"div",36)(15,"button",27),Z("click",function(){he(t);let r=Y();return fe(r.errorMessage="")}),M(16,"No"),b(),x(17,"button",28),Z("click",function(){he(t);let r=Y();return fe(r.toApplication())}),M(18,"Yes"),b()()()()}if(i&2){let t=Y();I(3),Mr("src","https://mapp-thesis.infotech3c.com/public/dbAssets/kioskImages/",t.kioskImage,"",_i),I(5),Qt("",t.kioskName," "),I(5),Qt("",t.kioskDescription," ")}}var O0=class i{constructor(e,t,n){this.router=e;this.screenSizeService=t;this.eventService=n;this.scene=new Fd,this.camera=new Fn(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new Nd({antialias:!0}),this.fontLoader=new Gl}kioskData=[];scene;camera;renderer;model;controls;raycaster=new Ud;pointer=new ye;clickableObjects=[];errorMessage="";fontLoader;isMap=!1;kioskName="";eventId="";kioskId="";kioskStatus="";kioskDescription="";mapTerrain=!1;kioskImage="";currentModel;modelContainer;ngOnChanges(e){}ngOnInit(){this.renderer.domElement.addEventListener("click",r=>this.onMouseClick(r)),this.controls=new Ha(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let e=new Oa(4210752);this.scene.add(e);let t=new zs(16777215,1);t.position.set(20,20,20).normalize(),this.scene.add(t);let n=sessionStorage.getItem("eventId")??"";console.log(n),this.eventService.getKioskMap(n).subscribe(r=>{this.kioskData=r,r.forEach(s=>{let o=new Do(.15,.15,.15);if(s.status=="available"){let a=new yn({color:5405039}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="pending"){let a=new yn({color:16760331}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="unavailable"){let a=new yn({color:10289672}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,kiosk:s},this.scene.add(l),this.clickableObjects.push(l)}s.status!="disable"&&this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",a=>{let l=new Ur(s.kiosk_name.replace(/\D/g,""),{font:a,size:.08,height:.05,curveSegments:12}),c=new yn({color:16381939}),d=new Ht(l,c);this.scene.add(d),d.position.set(s.position_x,.8,s.position_y),d.scale.z=-1})}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new Ur("Gym",{font:s,size:.5,height:.05,curveSegments:12}),a=new yn({color:3096134}),l=new Ht(o,a);this.scene.add(l),l.position.set(1,1.8,1),l.scale.z=-1}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new Ur("Field",{font:s,size:.5,height:.05,curveSegments:12}),a=new yn({color:3096134}),l=new Ht(o,a);this.scene.add(l),l.position.set(-1.5,1.8,0),l.scale.z=-1})}),this.loadModel("assets/model/map.glb")}loadModel(e){let t=new jl;this.removeModel(),t.load(e,n=>{this.currentModel=n.scene,this.scene.add(this.currentModel)},void 0,n=>{console.error("An error occurred while loading the model:",n)})}removeModel(){this.currentModel&&(this.scene.remove(this.currentModel),this.currentModel.traverse(e=>{e instanceof Ht&&(e.geometry&&e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(t=>{t instanceof Mn&&t.dispose()}):e.material instanceof Mn&&e.material.dispose())}),this.currentModel=void 0)}changeModel(e){this.loadModel(e),this.renderer.domElement.addEventListener("click",r=>this.onMouseClick(r)),this.controls=new Ha(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let t=new Oa(4210752);this.scene.add(t);let n=new zs(16777215,1);n.position.set(20,20,20).normalize(),this.scene.add(n)}onMouseClick(e){this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);let t=this.raycaster.intersectObjects(this.clickableObjects);if(t.length>0){let n=t[0].object,r=n.position.y,s=n.userData;if(s.kioskStatus=="available"){console.log("User data:",s);let o=s.kioskId,a=s.name,l=s.eventId,c=s.kioskStatus,d=s.kioskDescription,u=s.kioskImage;this.errorMessage="done",this.eventId=l,this.kioskId=o,this.kioskName=a,this.kioskStatus=c,this.kioskDescription=d,this.kioskImage=u}else this.errorMessage="occupied"}}toApplication(){sessionStorage.setItem("kioskStatus",this.kioskStatus),sessionStorage.setItem("kioskName",this.kioskName),sessionStorage.setItem("kioskId",this.kioskId),this.router.navigate(["/application-form"])}ngAfterViewInit(){this.modelContainer.nativeElement.appendChild(this.renderer.domElement),this.animate()}loadModelTerrain(){new jl().load("assets/model/mapTerrain.glb",t=>{this.model=t.scene,this.model.scale.set(1,1,1),this.model.position.set(0,0,0),this.scene.add(this.model)},void 0,t=>{console.error("An error occurred while loading the model:",t)})}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}ngOnDestroy(){this.model&&(this.scene.remove(this.model),this.model.traverse(t=>{t instanceof Ht&&(t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(n=>{n instanceof Mn&&n.dispose()}):t.material instanceof Mn&&t.material.dispose())})),this.renderer&&this.renderer.dispose();let e=this.renderer.domElement;e.parentElement&&e.parentElement.removeChild(e),this.controls&&this.controls.dispose()}static \u0275fac=function(t){return new(t||i)(ne(et),ne(za),ne(di))};static \u0275cmp=vt({type:i,selectors:[["app-map-viewer"]],viewQuery:function(t,n){if(t&1&&ai(HZ,7),t&2){let r;zn(r=jn())&&(n.modelContainer=r.first)}},standalone:!0,features:[Ni,_t],decls:23,vars:5,consts:[["modelContainer",""],[1,"w-full","h-full","fixed"],[1,"w-full","h-full","overflow-x-hidden"],[1,"z-10","fixed","top-20","right-0","w-[350px]","bg-transparent","p-4"],[1,"w-full","grid","grid-cols-2","bg-gray-400","p-4","rounded-xl","gap-2"],[1,"flex","justify-center","align-center","w-full","h-full","pt-8"],["class","size-full hover:bg-green-700 hover:text-gray-50 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],["class","size-full  hover:bg-green-700 hover:text-gray-200 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],[1,"grid","grid-cols-2","gap-2","justify-center","px-4"],[1,"text-gray-50","text-lg","col-span-2","font-bold","text-left"],[1,"size-6","bg-red-500","rounded-lg"],[1,"text-gray-50","text-xs"],[1,"size-6","bg-green-500","rounded-lg"],[1,"size-6","bg-yellow-500","rounded-lg"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-full w-full z-20",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[8rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[580px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],[1,"size-full","hover:bg-green-700","hover:text-gray-50","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-7","text-center","justify-center","text-gray-50"],["width","32px","height","32px","viewBox","0 0 100 100","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","aria-hidden","true","role","img","preserveAspectRatio","xMidYMid meet",1,"iconify","iconify--gis"],["d","M50 5L24.637 30.469H41.34v20.705h17.32V30.469h16.703zM28.135 37.309a3.5 3.5 0 0 0-2.668 1.234L.832 67.559a3.5 3.5 0 0 0 2.67 5.765l93-.064a3.5 3.5 0 0 0 2.666-5.766L74.59 38.543a3.5 3.5 0 0 0-2.668-1.234H64.66c-.002 2.333-.008 4.666-.008 7h5.649l18.64 21.957l-77.873.052l18.686-22.01h5.586c.002-2.333.003-4.666 0-7zM89.91 78.264l-9.178.007l8.211 9.67l-77.875.053l8.22-9.682l-9.188.008L.832 89.234A3.5 3.5 0 0 0 3.502 95l93-.064a3.5 3.5 0 0 0 2.666-5.766z","fill","#161a1d"],[1,"size-full","hover:bg-green-700","hover:text-gray-200","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-7","text-center","justify-center","text-gray-300"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-full","w-full","z-20"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[8rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[580px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"grid","grid-cols-[60%_40%]","md:grid-cols-2","gap-2"],[1,"row-span-2","py-4"],[1,"rounded-xl","h-full","object-cover",3,"src"],[1,"flex-cols","items-center","h-full","w-full","my-8"],[1,"text-gray-50","text-left","text-xl"],[1,"pt-8","text-gray-50","text-left","leading-none","h-68","md:h-44"],["readonly","",1,"h-32","bg-inherit","min-h-32","max-h-32","w-full","text-xs","mt-2","focus:outline-none","outline-none","overflow-y-scroll"],[1,"relative","-top-4","flex","justify-between","space-x-2","w-full"]],template:function(t,n){t&1&&(x(0,"div",1),B(1,"div",2,0),b(),x(3,"div",3)(4,"div",4)(5,"div",5),ee(6,zZ,4,0,"button",6)(7,jZ,4,0,"button",7),b(),x(8,"div",8)(9,"p",9),M(10,"Legend:"),b(),B(11,"div",10),x(12,"p",11),M(13,"Unavailable"),b(),B(14,"div",12),x(15,"p",11),M(16,"Available"),b(),B(17,"div",13),x(18,"p",11),M(19,"Pending"),b()()()(),ee(20,GZ,1,0,"div",14)(21,WZ,12,1,"div",15)(22,qZ,19,4,"div",15)),t&2&&(I(6),F("ngIf",!n.mapTerrain),I(),F("ngIf",n.mapTerrain),I(13),F("ngIf",n.errorMessage),I(),F("ngIf",n.errorMessage!="done"&&n.errorMessage!=""),I(),F("ngIf",n.errorMessage=="done"))},dependencies:[Mt,Nt],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var qn=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files/";getUser(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-user.php`,t)}getNotification(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-notification.php`,t)}getTransaction(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-transaction.php`,t)}updateMessage(e,t){let n={notificationId:e,status:t};return this.http.post(`${this.apiUrl}/update-message.php`,n)}submitApplication(e){return this.http.post(`${this.apiUrl}/submit-application.php`,e).pipe(Gi(t=>(console.error("HTTP error:",t),yr(()=>new Error("Submission failed.")))))}submitReference(e,t){let n={formId:e,receiptNumber:t};return this.http.post(`${this.apiUrl}/submitReferenceNumber.php`,n)}static \u0275fac=function(t){return new(t||i)(Me(uo))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var Dk=()=>({standalone:!0});function ZZ(i,e){if(i&1&&(x(0,"span",37),M(1),b()),i&2){let t=Y();I(),ge(t.loiFileName)}}function XZ(i,e){i&1&&(x(0,"span",37),M(1,"Upload a file"),b())}function YZ(i,e){if(i&1&&(x(0,"p",38),M(1),b()),i&2){let t=Y();I(),ge(t.errorMessage)}}function QZ(i,e){i&1&&B(0,"div",39)}function KZ(i,e){if(i&1){let t=rt();x(0,"div",40)(1,"div",41)(2,"p",42),M(3," Thank you for using our kiosk!, Admin has been notfied!"),B(4,"br"),M(5," Select okay to view transaction. "),b()(),x(6,"div",43)(7,"button",44),Z("click",function(){he(t);let r=Y();return fe(r.router.navigate(["/dashboard"]))}),M(8,"Back"),b(),x(9,"button",45),Z("click",function(){he(t);let r=Y();return fe(r.router.navigate(["/transaction"]))}),M(10,"Okay"),b()()()}}var B0=class i{constructor(e,t,n){this.authService=e;this.router=t;this.userService=n}userName="";eventName="";kioskName="";purpose="";loiFile=null;loiFileName="";dateRequested="";successMessage="";errorMessage="";tokenId="";userId="";eventId="";kioskId="";ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.userName=sessionStorage.getItem("userName")??"",this.eventName=sessionStorage.getItem("eventName")??"",this.kioskName=sessionStorage.getItem("kioskName")??"",this.userId=sessionStorage.getItem("userId")??"",this.kioskId=sessionStorage.getItem("kioskId")??"",this.eventId=sessionStorage.getItem("eventId")??""}handleFileChange(e){let t=e.target;t&&t.files&&t.files.length>0?(this.loiFile=t.files[0],this.loiFileName=t.files[0].name):(this.loiFile=null,this.loiFileName="")}onSubmit(){if(!this.userId||!this.kioskId||!this.eventId||!this.loiFileName||!this.purpose||!this.dateRequested){this.errorMessage="All fields are required!";return}let e=new Date;if(new Date(this.dateRequested)<=e){this.errorMessage="The requested date must be in the future!";return}let n=new FormData;n.append("userId",this.userId),n.append("eventId",this.eventId),n.append("kioskId",this.kioskId),n.append("dateRequested",this.dateRequested),n.append("purpose",this.purpose),this.loiFile&&n.append("loi",this.loiFile,this.loiFile.name),console.log(n.get("userId")),console.log(n.get("eventId")),console.log(n.get("kioskId")),console.log(n.get("dateRequested")),console.log(n.get("purpose")),console.log(n.get("loi")),this.userService.submitApplication(n).subscribe({next:r=>{console.log(r.message,r.success),r.success&&(this.successMessage="success",cs.send("service_l1qrwc6","template_bm2axpf",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",from_kiosk:this.kioskName,from_event:this.eventName,from_email:sessionStorage.getItem("email")??"",submission_date:new Date().toLocaleString()},"Tv0xOXxLvWH60MEV_").then(s=>{console.log("Email sent successfully!",s.text)}).catch(s=>{console.error("Email sending failed:",s)}),this.resetForm())},error:r=>{this.errorMessage="Error submitting the application. Please try again.",console.error(r)}})}resetForm(){sessionStorage.removeItem("eventId"),sessionStorage.removeItem("kioskId"),sessionStorage.removeItem("eventName"),sessionStorage.removeItem("kioskName"),this.userName="",this.eventName="",this.kioskName="",this.purpose="",this.loiFile=null,this.loiFileName="",this.dateRequested="",this.tokenId="",this.userId="",this.eventId="",this.kioskId=""}static \u0275fac=function(t){return new(t||i)(ne(ui),ne(et),ne(qn))};static \u0275cmp=vt({type:i,selectors:[["app-application-form"]],standalone:!0,features:[_t],decls:66,vars:17,consts:[["fileInput",""],[1,"h-full","flex","items-center","justify-center"],[1,"sm:grid","grid-cols-1","lg:grid-cols-2","items-start","shadow-bottom","shadow-black","pt-28","md:px-8","min-h-screen-sm","max-w-screen-xl","rounded-xl"],[1,"justify-center","items-center","h-full","w-full","bg-gray-50"],["src","assets/images/rulesRegulation.jpg",1,"size-full","rounded-l-xl","object-full","object-center"],[1,"h-full","w-full","px-5","py-2","md:p-8","justify-center","items-center","bg-customDarkGreen","lg:rounded-l-none","rounded-l-xl","rounded-r-xl"],[1,"w-full","h-28","md:pt-0","pt-20","flex","flex-col","items-center","md:flex-row","md:justify-center","md:top-0","top-12","md:left-6","relative"],[1,"w-[20rem]","md:w-[24rem]","h-16","pt-5","border-b-4","px-4","md:px-20","relative"],[1,"size-8","bg-gray-50","rounded-full","relative","-top-[2rem]","left-40","md:top-[1.90rem]","md:left-0","mt-4","md:mt-0"],[1,"relative","text-md","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold","leading-none"],[1,"text-xs","text-gray-50"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[4.75rem]","md:top-[1.90rem]","md:right-[13.5rem]","mt-4","md:mt-0"],[1,"relative","text-sm","w-40","text-center","-top-10","-left-[4.0rem]","md:-left-16","text-white","font-bold","leading-none"],[1,"text-xs","text-gray-300"],[1,"size-5","bg-green-300","rounded-full","relative","-top-[7rem]","-left-[10rem]","md:top-[1.9rem]","md:-left-[28rem]","mt-4","md:mt-0"],[1,"text-center","text-3xl","text-gray-50","md:pt-0","pt-20"],[1,"pt-4","px-4","space-y-2",3,"ngSubmit"],[1,"form-group","col-span-1","pt-2"],[1,"text-white"],["readonly","","type","text","id","userName","name","userName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],[1,"grid","grid-cols-2","gap-x-2"],[1,"form-group","col-span-1"],["readonly","","type","text","id","eventName","name","eventName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],["readonly","","type","text","id","kioskName","name","kioskName",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","placeholder"],["type","date","id","dateRequested","name","dateRequested","required","","placeholder","Date requested",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","id","purpose","name","purpose","required","","placeholder","Purpose",1,"h-12","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue",3,"ngModelChange","ngModel","ngModelOptions"],[1,"block","text-sm","font-medium","mb-2","text-white"],[1,"relative","h-12","bg-white","rounded-xl","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","loi","name","loi","required","",1,"hidden",3,"change"],[1,"form-group","col-span-2","p-1"],["type","submit","id","submit","name","submit",1,"h-12","w-32","rounded-xl","text-white","text-sm","px-4","py-2","bg-green-800","hover:bg-green-900","border","border-gray-300","focus:outline-none","hover:ring-[3px]","hover:ring-green-300"],[1,"form-group","col-span-2","h-2","p-1"],["class","text-center text-red-700 text-sm ",4,"ngIf"],["class","animate-fadeIn absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-20",4,"ngIf"],["class","animate-fadeIn absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],[1,"text-gray-700"],[1,"text-center","text-red-700","text-sm"],[1,"animate-fadeIn","absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-20"],[1,"animate-fadeIn","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"]],template:function(t,n){if(t&1){let r=rt();x(0,"div",1)(1,"div",2)(2,"div",3),B(3,"img",4),b(),x(4,"div",5)(5,"div",6),B(6,"div",7),x(7,"div",8)(8,"p",9),M(9," STEP 3 "),x(10,"span",10),B(11,"br"),M(12,"Application"),b()()(),x(13,"div",11)(14,"p",12),M(15," STEP 2 "),x(16,"span",13),B(17,"br"),M(18,"Kiosk Selection"),b()()(),x(19,"div",14)(20,"p",12),M(21," STEP 1 "),x(22,"span",13),B(23,"br"),M(24,"Event Selection"),b()()()(),x(25,"h6",15),M(26,"Application form"),b(),x(27,"form",16),Z("ngSubmit",function(){return he(r),fe(n.onSubmit())}),x(28,"div",17)(29,"label",18),M(30,"Username"),b(),x(31,"input",19),nt("ngModelChange",function(o){return he(r),it(n.userName,o)||(n.userName=o),fe(o)}),b()(),x(32,"div",20)(33,"div",21)(34,"label",18),M(35,"Event Name"),b(),x(36,"input",22),nt("ngModelChange",function(o){return he(r),it(n.eventName,o)||(n.eventName=o),fe(o)}),b()(),x(37,"div",21)(38,"label",18),M(39,"Kiosk Name"),b(),x(40,"input",23),nt("ngModelChange",function(o){return he(r),it(n.kioskName,o)||(n.kioskName=o),fe(o)}),b()()(),x(41,"div",21)(42,"label",18),M(43,"Date Requested"),b(),x(44,"input",24),nt("ngModelChange",function(o){return he(r),it(n.dateRequested,o)||(n.dateRequested=o),fe(o)}),b()(),x(45,"div",21)(46,"label",18),M(47,"Purpose"),b(),x(48,"input",25),nt("ngModelChange",function(o){return he(r),it(n.purpose,o)||(n.purpose=o),fe(o)}),b()(),x(49,"div",21)(50,"label",26),M(51,"Letter Of Intent"),b(),x(52,"div",27),Z("click",function(){he(r);let o=is(58);return fe(o.click())}),ee(53,ZZ,2,1,"span",28)(54,XZ,2,0,"span",28),x(55,"button",29),M(56," Browse "),b()(),x(57,"input",30,0),Z("change",function(o){return he(r),fe(n.handleFileChange(o))}),b()(),x(59,"div",31)(60,"button",32),M(61," Submit "),b()(),x(62,"div",33),ee(63,YZ,2,1,"p",34),b()()()()(),ee(64,QZ,1,0,"div",35)(65,KZ,11,0,"div",36)}t&2&&(I(31),Eu("placeholder",n.userName),tt("ngModel",n.userName),I(5),Eu("placeholder",n.eventName),tt("ngModel",n.eventName),I(4),Eu("placeholder",n.kioskName),tt("ngModel",n.kioskName),I(4),tt("ngModel",n.dateRequested),F("ngModelOptions",Xi(15,Dk)),I(4),tt("ngModel",n.purpose),F("ngModelOptions",Xi(16,Dk)),I(5),F("ngIf",n.loiFile),I(),F("ngIf",!n.loiFile),I(9),F("ngIf",n.errorMessage),I(),F("ngIf",n.successMessage=="success"),I(),F("ngIf",n.successMessage=="success"))},dependencies:[mn,Dr,bn,An,Ir,_l,wn,dr,Mt,Nt],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var JZ=(i,e,t,n)=>({"text-green-300":i,"text-orange-300":e,"text-red-300":t,"text-yellow-300":n});function $Z(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",27)(2,"line",28)(3,"line",29),b())}function eX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",30)(2,"line",31)(3,"line",32),b())}function tX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",27)(2,"line",28)(3,"line",29),b())}function nX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",30)(2,"line",31)(3,"line",32),b())}function iX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",27)(2,"line",28)(3,"line",29),b())}function rX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",30)(2,"line",31)(3,"line",32),b())}function sX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",27)(2,"line",28)(3,"line",29),b())}function oX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",30)(2,"line",31)(3,"line",32),b())}function aX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",27)(2,"line",28)(3,"line",29),b())}function lX(i,e){i&1&&(te(),x(0,"svg",26),B(1,"path",30)(2,"line",31)(3,"line",32),b())}function cX(i,e){if(i&1){let t=rt();x(0,"button",39),Z("click",function(){he(t);let r=Y().$implicit,s=Y();return s.referenceNumber=!s.referenceNumber,fe(s.formId=r.form_id)}),te(),x(1,"svg",40),B(2,"path",41)(3,"polygon",42),b()()}}function dX(i,e){if(i&1){let t=rt();x(0,"div",33)(1,"div",34),M(2),b(),x(3,"div",16),M(4),b(),x(5,"div",16),M(6),b(),x(7,"div",16),M(8),b(),x(9,"div",35),ee(10,cX,4,0,"button",36),M(11),b(),x(12,"div",37)(13,"button",38),Z("click",function(){let r=he(t).$implicit,s=Y();return fe(s.downloadForm(r.form_id))}),M(14," Download forms "),b()()()}if(i&2){let t=e.$implicit,n=Y();I(2),ge(n.formatDate(t.date_req)),I(2),ge(t.event_name),I(2),ge(t.kiosk_name),I(2),ge(t.purpose?t.purpose:"----"),I(),F("ngClass",$I(7,JZ,t.status==="finished"||t.status==="approved",t.status==="pending",t.status==="denied",t.status==="paid")),I(),F("ngIf",t.status==="paid"),I(),Qt(" ",n.statusViewer(t.status)," ")}}function uX(i,e){if(i&1){let t=rt();x(0,"div",43)(1,"div",44)(2,"div",45)(3,"p",46),M(4,"Please input your"),x(5,"b"),M(6," Reference Number "),b(),B(7,"br"),M(8,"in the field provided!"),b(),x(9,"input",47),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.reference,r)||(s.reference=r),fe(r)}),b()()(),x(10,"div",48)(11,"button",49),Z("click",function(){he(t);let r=Y();return r.referenceNumber=!1,fe(r.reference="")}),M(12,"Cancel"),b(),x(13,"button",50),Z("click",function(){he(t);let r=Y();return r.checkerReference=!r.checkerReference,r.referenceNumber=!r.referenceNumber,fe(r.reference=r.reference)}),M(14,"Submit"),b()()()}if(i&2){let t=Y();I(9),tt("ngModel",t.reference)}}function hX(i,e){if(i&1){let t=rt();x(0,"div",51)(1,"div",44)(2,"p",52),M(3," Are you sure your your Reference Number: "),x(4,"b"),M(5),b(),M(6," is correct ? "),b()(),x(7,"div",48)(8,"button",49),Z("click",function(){he(t);let r=Y();return r.checkerReference=!1,fe(r.referenceNumber=!0)}),M(9,"No "),b(),x(10,"button",50),Z("click",function(){he(t);let r=Y();return fe(r.submitReference())}),M(11,"Yes"),b()()()}if(i&2){let t=Y();I(5),ge(t.reference)}}function fX(i,e){i&1&&B(0,"div",53)}function pX(i,e){if(i&1){let t=rt();x(0,"div",51)(1,"div",44)(2,"p",52),M(3," Error please input valid reference number! "),b()(),x(4,"div",54)(5,"button",55),Z("click",function(){he(t);let r=Y();return r.errorMessage="",r.checkerReference=!1,fe(r.referenceNumber=!0)}),M(6,"Okay "),b()()()}}function mX(i,e){if(i&1){let t=rt();x(0,"div",56)(1,"div",44)(2,"p",52),M(3," Thank you for paying, reference number is already submitted! "),b()(),x(4,"div",54)(5,"button",55),Z("click",function(){he(t);let r=Y();return r.errorMessage="",fe(r.checkerReference=!1)}),M(6,"Okay "),b()()()}}var V0=class i{constructor(e,t,n){this.router=e;this.userService=t;this.eventService=n}userTransaction=[];eventData=[];kioskData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascStatus=!1;ascEvent=!1;ascKiosk=!1;reference="";checkerReference=!1;ascPurpose=!1;ascDate=!1;referenceNumber=!1;formId="";errorMessage="";submitReference(){!this.formId||!this.reference?this.errorMessage="error":this.userService.submitReference(this.formId,this.reference).subscribe(e=>{e.success&&(this.errorMessage="none",cs.send("service_yb4nng9","template_5dtjkq9",{referenceNumber:this.reference,from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(t=>{console.log("Email sent successfully!",t.text),window.location.reload()}))})}getTransaction(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getTransaction(this.token).subscribe(e=>{this.userTransaction=e})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getKioskName(e){let t=this.kioskData.find(n=>n.kiosk_id==e);return t?t.kiosk_name:"Unknown Kiosk"}getKiosk(){this.eventService.getKiosk().subscribe(e=>{this.kioskData=e})}getEvent(){this.eventService.getEvents().subscribe(e=>{this.eventData=e})}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}toLowerCaseSafe(e){return e?e.toLowerCase():""}getTransactionsToDisplay(){let e=this.userTransaction.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.kiosk_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.purpose).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userTransaction.length&&(console.log(this.userTransaction.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.firstName=sessionStorage.getItem("firstName")??"",this.lastName=sessionStorage.getItem("lastName")??"",this.eventService.downloadForm(e,this.firstName,this.lastName)}statusViewer(e){return e=="approved"?"approved":e=="pending"?"booked":e=="finished"?"completed":e=="paid"?e:"cancelled"}ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.getEvent(),this.getKiosk(),this.getTransaction()}static \u0275fac=function(t){return new(t||i)(ne(et),ne(qn),ne(di))};static \u0275cmp=vt({type:i,selectors:[["app-transaction"]],standalone:!0,features:[_t],decls:78,vars:20,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","pt-24","md:px-8","text-black"],[1,"block"],[1,"flex","justify-between","h-full","w-full","px-0","md:px-8","items-center"],[1,"bg-green-200","size-36","px-2","text-center","rounded-xl","shadow-md","shadow-gray-500","justify-center","grid","items-center"],[1,"text-8xl","text-gray-600"],[1,"text-md","text-gray-600","font-bold"],[1,"text-md","text-gray-600","font-bold","w-full"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-6","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-sm","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"block",3,"click"],["class","grid grid-cols-6 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["class","animate-fadeIn overflow-hidden  absolute top-[15rem] px-8 grid justify-center items-center  left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-20",4,"ngIf"],["class","overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-6","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-xs","md:text-sm","flex","justify-center","items-center"],[1,"flex","justify-center","items-center",3,"ngClass"],["class","pr-2",3,"click",4,"ngIf"],[1,"flex","justify-between","items-center"],[1,"bg-green-800","h-8","w-full","md:text-sm","rounded-lg","hover:bg-green-900","hover:text-white",3,"click"],[1,"pr-2",3,"click"],["width","18px","height","18px","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M20,16v4a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4H8","fill","none","stroke","#ffe5ec","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["fill","none","points","12.5 15.8 22 6.2 17.8 2 8.3 11.5 8 16 12.5 15.8","stroke","#ffe5ec","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"animate-fadeIn","overflow-hidden","absolute","top-[15rem]","px-8","grid","justify-center","items-center","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"block","w-80"],[1,"text-lg","text-center","text-gray-200","pb-4"],["type","text","placeholder","Reference Number:","name","reference",1,"w-full","h-12","rounded-lg","outline-none","px-2",3,"ngModelChange","ngModel"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-600","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-20"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),M(5),b(),x(6,"div",5),M(7,"PAID"),b()(),x(8,"div",3)(9,"div",4),M(10),b(),x(11,"div",6),M(12,"FINISHED"),b()(),x(13,"div",3)(14,"div",4),M(15),b(),x(16,"div",6),M(17,"TRANSACTION"),b()()(),x(18,"div",7)(19,"div",8)(20,"p"),M(21," Transaction History:"),b()(),x(22,"div",9),te(),x(23,"svg",10)(24,"g")(25,"g"),B(26,"path",11),b()()(),ot(),x(27,"input",12),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(28,"div",13)(29,"div",14)(30,"button",15),Z("click",function(){return n.onSortChange("date_req"),n.ascDate=!n.ascDate}),x(31,"div",16),ee(32,$Z,4,0,"svg",17)(33,eX,4,0,"svg",17),x(34,"p"),M(35,"Date"),b()()()(),x(36,"div",14)(37,"button",15),Z("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),x(38,"div",16),ee(39,tX,4,0,"svg",17)(40,nX,4,0,"svg",17),x(41,"p"),M(42,"Event Name"),b()()()(),x(43,"div",14)(44,"button",15),Z("click",function(){return n.onSortChange("kiosk_name"),n.ascKiosk=!n.ascKiosk}),x(45,"div",16),ee(46,iX,4,0,"svg",17)(47,rX,4,0,"svg",17),x(48,"p"),M(49,"Kiosk Name"),b()()()(),x(50,"div",14)(51,"button",18),Z("click",function(){return n.onSortChange("purpose"),n.ascPurpose=!n.ascPurpose}),x(52,"div",16),ee(53,sX,4,0,"svg",17)(54,oX,4,0,"svg",17),x(55,"p"),M(56,"Purpose"),b()()()(),x(57,"div",14)(58,"button",15),Z("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),x(59,"div",16),ee(60,aX,4,0,"svg",17)(61,lX,4,0,"svg",17),x(62,"p"),M(63,"Status"),b()()()(),x(64,"div",16),M(65,"Pdf file"),b()(),ee(66,dX,15,12,"div",19),x(67,"div",20)(68,"button",21),Z("click",function(){return n.prevTransaction()}),M(69," Prev "),b(),x(70,"button",21),Z("click",function(){return n.nextTransaction()}),M(71," Next "),b()()(),B(72,"div"),ee(73,uX,15,1,"div",22)(74,hX,12,1,"div",23)(75,fX,1,0,"div",24)(76,pX,7,0,"div",23)(77,mX,7,0,"div",25),b()),t&2&&(I(5),ge(n.counterPaid(n.userTransaction)),I(5),ge(n.counterFinished(n.userTransaction)),I(5),ge(n.userTransaction.length),I(12),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascDate),I(),F("ngIf",!n.ascDate),I(6),F("ngIf",n.ascEvent),I(),F("ngIf",!n.ascEvent),I(6),F("ngIf",n.ascKiosk),I(),F("ngIf",!n.ascKiosk),I(6),F("ngIf",n.ascPurpose),I(),F("ngIf",!n.ascPurpose),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(5),F("ngForOf",n.getTransactionsToDisplay()),I(7),F("ngIf",n.referenceNumber),I(),F("ngIf",n.checkerReference),I(),F("ngIf",n.referenceNumber||n.checkerReference||n.errorMessage),I(),F("ngIf",n.errorMessage=="error"),I(),F("ngIf",n.errorMessage=="none"))},dependencies:[Mt,Ns,pn,Nt,mn,bn,An,wn],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var U0=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isSelectedEvent()?!0:(this.router.navigate(["/dashboard"]),!1)}static \u0275fac=function(t){return new(t||i)(Me(ui),Me(et))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var H0=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isApplied()?!0:(this.router.navigate(["/dashboard"]),!1)}static \u0275fac=function(t){return new(t||i)(Me(ui),Me(et))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var gn=class i{constructor(e){this.http=e}apiUrl="https://mapp-thesis.infotech3c.com/services/php-files-admin";getUsers(){return this.http.get(this.apiUrl+"/fetch-user.php")}getKiosk(){return this.http.get(`${this.apiUrl}/fetch-kiosk.php`)}getEvent(){return this.http.get(`${this.apiUrl}/fetch-events.php`)}getPastEvent(){return this.http.get(`${this.apiUrl}/fetch-past-events.php`)}getTransaction(){return this.http.get(`${this.apiUrl}/fetch-transaction.php`)}getNotification(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/fetch-notification.php`,t)}updateStatus(e,t,n,r,s){let o={status:e,userId:t,eventId:n,kioskId:r,formId:s};return this.http.post(`${this.apiUrl}/update-status.php`,o)}updateUserStatus(e,t){let n={userId:t,status:e};return this.http.post(`${this.apiUrl}/update-user-status.php`,n)}updateUserType(e,t){let n={userId:t,userType:e};return this.http.post(`${this.apiUrl}/update-user-type.php`,n)}dynamicController(e){let t={tokenId:e};return this.http.post(`${this.apiUrl}/dynamic-control.php`,t)}userControl(e,t,n){let r={userId:e,permission:t,value:n};return this.http.post(`${this.apiUrl}/user-control.php`,r)}updateEvents(e){return console.log(e.get("eventId")),console.log("checked"),this.http.post(`${this.apiUrl}/update-events.php`,e).pipe(Gi(t=>(console.error("HTTP error:",t),yr(()=>new Error("Submission failed.")))))}updateKiosk(e){return this.http.post(`${this.apiUrl}/update-kiosk.php`,e).pipe(Gi(t=>(console.error("HTTP error:",t),yr(()=>new Error("Submission failed.")))))}getKioskMap(e){let t={eventId:e};return console.log(e),this.http.post(`${this.apiUrl}/fetch-kiosks-map.php`,t)}disableEvent(e){let t={eventId:e};return this.http.post(`${this.apiUrl}/update-event-status.php`,t)}createEvents(e){return this.http.post(`${this.apiUrl}/add-events.php`,e).pipe(Gi(t=>(console.error("HTTP error:",t),yr(()=>new Error("Submission failed.")))))}getEventsReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-events-report.php`,t)}getBusinessReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-business.php`,t)}getKioskReport(e){console.log(e);let t={eventId:e};return this.http.post(`${this.apiUrl}/fetch-kiosk-business.php`,t)}static \u0275fac=function(t){return new(t||i)(Me(uo))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var gX=i=>({marginLeft:i});function vX(i,e){if(i&1&&(x(0,"div",10),M(1),b()),i&2){let t=e.$implicit;I(),ge(t)}}function xX(i,e){if(i&1&&(x(0,"div",14),M(1),b()),i&2){let t=Y().$implicit;I(),Qt(" ",t.date," ")}}function wX(i,e){if(i&1&&(x(0,"div",17),M(1),b()),i&2){let t=Y().$implicit;I(),Qt(" ",t.title," ")}}function yX(i,e){if(i&1&&(x(0,"div",18),M(1),b()),i&2){let t=Y().$implicit,n=Y().$implicit,r=Y();F("ngStyle",mm(2,gX,r.getEventCenterPosition(n.date,t)+"rem")),I(),Qt(" ",t.title," ")}}function bX(i,e){if(i&1&&(x(0,"div",15),ee(1,wX,2,1,"div",16)(2,yX,2,4,"ng-template",null,0,Cu),b()),i&2){let t=e.$implicit,n=is(3),r=Y().$implicit,s=Y();I(),F("ngIf",s.isEventMiddle(r.date,t))("ngIfElse",n)}}function AX(i,e){if(i&1&&(x(0,"div",11),ee(1,xX,2,1,"div",12)(2,bX,4,2,"div",13),b()),i&2){let t=e.$implicit;I(),F("ngIf",t.date),I(),F("ngForOf",t.events)}}var z0=class i{constructor(e){this.adminService=e;this.generateCalendarDays()}currentYear=new Date().getFullYear();currentMonth=new Date().getMonth();daysOfWeek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];months=["January","February","March","April","May","June","July","August","September","October","November","December"];calendarDays=[];events=[];fetchEvents(){this.adminService.getEvent().subscribe(e=>{this.events=e.map(t=>{let n=new Date(t.event_start);return n.setDate(n.getDate()-1),{title:t.event_name,startDate:n,endDate:new Date(t.event_end),color:"bg-blue-500"}}),this.generateCalendarDays()})}generateCalendarDays(){let e=new Date(this.currentYear,this.currentMonth,1).getDay(),t=new Date(this.currentYear,this.currentMonth+1,0).getDate();this.calendarDays=[];for(let n=0;n<e;n++)this.calendarDays.push({date:null,events:[]});for(let n=1;n<=t;n++){let r=new Date(this.currentYear,this.currentMonth,n),s=this.events.filter(o=>r>=o.startDate&&r<=o.endDate);this.calendarDays.push({date:n,events:s})}}prevMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--,this.generateCalendarDays()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++,this.generateCalendarDays()}handleDayClick(e){e&&console.log(`Clicked date: ${this.currentYear}-${this.currentMonth+1}-${e}`)}getEventCenterPosition(e,t){if(!e)return null;let n=t.startDate.getDate(),r=t.endDate.getDate();return e%2===0?(n+r)/2:null}isEventMiddle(e,t){if(!e)return!1;let n=t.startDate.getDate(),r=t.endDate.getDate();return Math.floor((n+r)/2)===e}ngOnInit(){this.fetchEvents()}static \u0275fac=function(t){return new(t||i)(ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-calendar"]],standalone:!0,features:[_t],decls:15,vars:4,consts:[["centerPosition",""],[1,"w-full","max-w-full","p-4","bg-white","shadow","rounded-3xl"],[1,"text-gray-700","text-2xl"],[1,"flex","justify-between","items-center","mt-4","mb-4","bg-[#006d77]","text-gray-50"],[1,"text-lg","font-bold","px-4","py-2","hover:text-gray-400","rounded",3,"click"],[1,"text-xl","font-bold"],[1,"grid","grid-cols-7","gap-1","text-center","font-semibold","text-gray-50"],["class","bg-[#246a73] py-1 px-4 md:px-2",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],["class","relative py-2 text-center text-xs sm:text-sm md:text-md h-20 w-full flex flex-col items-center justify-start bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-[#246a73]","py-1","px-4","md:px-2"],[1,"relative","py-2","text-center","text-xs","sm:text-sm","md:text-md","h-20","w-full","flex","flex-col","items-center","justify-start","bg-gray-50"],["class","text-gray-50 w-full bg-[#368f8b] font-bold justify-center align-center border  ",4,"ngIf"],["class","text-gray-50 font-bold w-full flex-col justify-self-center align-center bg-[#3c6e71]",4,"ngFor","ngForOf"],[1,"text-gray-50","w-full","bg-[#368f8b]","font-bold","justify-center","align-center","border"],[1,"text-gray-50","font-bold","w-full","flex-col","justify-self-center","align-center","bg-[#3c6e71]"],["class","h-6 font-bold md:text-sm text-xs text-gray-50 bg-[#3c6e71]",4,"ngIf","ngIfElse"],[1,"h-6","font-bold","md:text-sm","text-xs","text-gray-50","bg-[#3c6e71]"],[1,"h-6","y","bg-[#3c6e71]",3,"ngStyle"]],template:function(t,n){t&1&&(x(0,"div",1)(1,"p",2),M(2,"Event Calendar"),b(),B(3,"hr"),x(4,"div",3)(5,"button",4),Z("click",function(){return n.prevMonth()}),M(6,"<"),b(),x(7,"span",5),M(8),b(),x(9,"button",4),Z("click",function(){return n.nextMonth()}),M(10,">"),b()(),x(11,"div",6),ee(12,vX,2,1,"div",7),b(),x(13,"div",8),ee(14,AX,3,2,"div",9),b()()),t&2&&(I(8),jy("",n.months[n.currentMonth]," ",n.currentYear,""),I(4),F("ngForOf",n.daysOfWeek),I(2),F("ngForOf",n.calendarDays))},dependencies:[Mt,pn,Nt,mD],styles:[".calendar[_ngcontent-%COMP%]{width:300px;margin:20px auto;font-family:Arial,sans-serif}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function _X(i,e){i&1&&(x(0,"div",38)(1,"div",39),M(2," No Image provided"),b()())}function SX(i,e){if(i&1&&(x(0,"div",34),ee(1,_X,3,0,"div",35),x(2,"div",36),B(3,"img",37),b()()),i&2){let t=e.$implicit,n=Y();I(),F("ngIf",n.events.length==0),I(2),F("src",n.urlImage+t.event_image,_i)}}var j0=class i{constructor(e,t,n){this.adminService=e;this.router=t;this.screenSizeService=n}events=[];kiosk=[];user=[];transaction=[];urlImage="https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/";ngOnInit(){sessionStorage.getItem("runOnce")=="false"&&(sessionStorage.setItem("runOnce","true"),window.location.reload()),this.fetchTransaction(),this.fetchEvents(),this.fetchUser(),this.fetchKiosk()}getAvailableKioskCount(){return this.kiosk.filter(e=>e.status==="available").length}getUnavailableKioskCount(){return this.kiosk.filter(e=>e.status==="unavailable").length}fetchTransaction(){this.adminService.getTransaction().subscribe(e=>{this.transaction=e})}fetchEvents(){this.adminService.getEvent().subscribe(e=>{this.events=e})}fetchUser(){this.adminService.getUsers().subscribe(e=>{this.user=e})}fetchKiosk(){this.adminService.getKiosk().subscribe(e=>{this.kiosk=e})}ngAfterViewInit(){let e=new ls(".default-carousel",{loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swipe-next",prevEl:".swipe-prev"}});setInterval(()=>{e.slideNext()},3e3)}static \u0275fac=function(t){return new(t||i)(ne(gn),ne(et),ne(za))};static \u0275cmp=vt({type:i,selectors:[["app-admin-dashboard"]],standalone:!0,features:[_t],decls:60,vars:5,consts:[[1,"w-full","flex","flex-cols","justify-center","align-center"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-2"],[1,"col-span-1","md:col-span-3","text-gray-500","grid","grid-cols-2","md:grid-cols-4","gap-x-2","p-2","justify-center","align-center","rounded-3xl","h-full","w-full","border","border-gray-300","rounded-3xl","shadow-md","shadow-gray-400"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#62b6cb]","justify-center","items-center","rounded-xl"],[1,"w-full","flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#62b6cb","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","8","r","4"],["d","M12 14c-5 0-7 3-7 3v2h14v-2s-2-3-7-3z"],[1,"text-center","text-sm","font-semibold"],[1,"text-xl"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#ff4d6d]","justify-center","items-center","rounded-xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#ff4d6d","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["d","M12 2C8.13 2 5 5.13 5 8c0 3.75 7 10 7 10s7-6.25 7-10c0-2.87-3.13-6-7-6z"],["cx","12","cy","8","r","3"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#80ed99]","justify-center","items-center","rounded-xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","96","height","96","fill","#80ed99","stroke","#e3d5ca","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],[1,"w-full","px-2","h-48","bg-gray-100","flex","flex-col","border-4","border-[#f28f3b]","justify-center","items-center","rounded-xl"],["fill","#f28f3b","width","96","height","96","stroke","#e3d5ca","stroke-width","1","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],[1,"col-span-1","md:col-span-2","w-full","border","border-gray-300","shadow-md","shadow-gray-400","rounded-3xl"],[1,"col-span-1","rounded-3xl","h-full","w-full","border","border-gray-300","rounded-3xl","shadow-md","shadow-gray-400"],[1,"text-gray-700","text-2xl","mt-4","px-4"],[1,"text-gray-700","text-xl","mx-4"],[1,"h-5/6","justify-center","itens-center","flex","bg-transparent"],[1,"swiper","justify-center","itens-center","default-carousel"],[1,"swiper-wrapper","bg-transparent"],["class","swiper-slide bg-gray-50  border-gray-50",4,"ngFor","ngForOf"],[1,"swipe-prev","absolute","top-72","z-10","-left-4","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-10","w-10","text-gray-600","hover:text-gray-900"],["points","15 18 9 12 15 6"],[1,"swipe-next","absolute","top-72","z-[10]","-right-4","transform","-translate-y-1/2","bg-transparent","p-2","rounded-full","text-gray-700","text-7xl"],["points","9 18 15 12 9 6"],[1,"relative","-top-2"],[1,"swiper-pagination"],[1,"swiper-slide","bg-gray-50","border-gray-50"],["class","h-full w-full flex justify-center items-center ",4,"ngIf"],[1,"h-full","w-full","flex","justify-center","items-center","bg-transparent"],[1,"rounded-3xl","opacity-80","h-full","w-full","object-contain",3,"src"],[1,"h-full","w-full","flex","justify-center","items-center"],[1,"h-[500px]","w-full","object-cover","flex","text-gray-50","justify-center","items-center"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),te(),x(5,"svg",5),B(6,"circle",6)(7,"path",7),b()(),ot(),x(8,"div",8)(9,"p"),M(10,"Total Registered Users"),b(),x(11,"p",9),M(12),b()()(),x(13,"div",10)(14,"div",4),te(),x(15,"svg",11),B(16,"path",12)(17,"circle",13),b()(),ot(),x(18,"div",8)(19,"p"),M(20,"Total Available Kiosk"),b(),x(21,"p",9),M(22),b()()(),x(23,"div",14)(24,"div",4),te(),x(25,"svg",15),B(26,"path",12)(27,"circle",13),b()(),ot(),x(28,"div",8)(29,"p"),M(30,"Total Unavailable Kiosk"),b(),x(31,"p",9),M(32),b()()(),x(33,"div",16)(34,"div",4),te(),x(35,"svg",17),B(36,"path",18),b()(),ot(),x(37,"div",8)(38,"p"),M(39,"Total Transaction"),b(),x(40,"p",9),M(41),b()()()(),x(42,"div",19),B(43,"app-calendar"),b(),x(44,"div",20)(45,"p",21),M(46,"Upcoming Events"),b(),B(47,"hr",22),x(48,"div",23)(49,"div",24)(50,"div",25),ee(51,SX,4,2,"div",26),b(),x(52,"button",27),te(),x(53,"svg",28),B(54,"polyline",29),b()(),ot(),x(55,"button",30),te(),x(56,"svg",28),B(57,"polyline",31),b()(),ot(),x(58,"div",32),B(59,"div",33),b()()()()()()),t&2&&(I(12),ge(n.user.length),I(10),ge(n.getAvailableKioskCount()),I(10),ge(n.getUnavailableKioskCount()),I(9),ge(n.transaction.length),I(10),F("ngForOf",n.events))},dependencies:[z0,Mt,pn,Nt],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var zr=class i{constructor(e,t){this.authService=e;this.router=t}canActivate(){let e=sessionStorage.getItem("userType");return this.authService.checkUserLogin()&&e!="user"?!0:(this.router.navigate(["/login"]),!1)}cantLogin(){return this.authService.checkUserLogin()?(this.router.navigate(["/admin-dashboard"]),!1):!0}static \u0275fac=function(t){return new(t||i)(Me(ui),Me(et))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})};var QE={};nN(QE,{AbortException:()=>bY,AnnotationEditorLayer:()=>AY,AnnotationEditorParamsType:()=>_Y,AnnotationEditorType:()=>t3,AnnotationEditorUIManager:()=>SY,AnnotationLayer:()=>EY,AnnotationMode:()=>CY,CMapCompressionType:()=>MY,ColorPicker:()=>TY,DOMSVGFactory:()=>IY,DrawLayer:()=>DY,FeatureTest:()=>PY,GlobalWorkerOptions:()=>n3,ImageKind:()=>RY,InvalidPDFException:()=>LY,MissingPDFException:()=>kY,OPS:()=>NY,PDFDataRangeTransport:()=>FY,PDFDateString:()=>OY,PDFWorker:()=>BY,PasswordResponses:()=>VY,PermissionFlag:()=>UY,PixelsPerInch:()=>HY,RenderingCancelledException:()=>zY,TextLayer:()=>jY,UnexpectedResponseException:()=>GY,Util:()=>WY,VerbosityLevel:()=>YE,XfaLayer:()=>qY,build:()=>ZY,createValidAbsoluteUrl:()=>XY,fetchData:()=>YY,getDocument:()=>i3,getFilenameFromUrl:()=>QY,getPdfFilenameFromUrl:()=>KY,getXfaPageViewport:()=>JY,isDataScheme:()=>$Y,isPdfFile:()=>eQ,noContextMenu:()=>tQ,normalizeUnicode:()=>nQ,setLayerDimensions:()=>iQ,shadow:()=>rQ,version:()=>r3});var of={};of.d=(i,e)=>{for(var t in e)of.o(e,t)&&!of.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};of.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var xt=globalThis.pdfjsLib={};of.d(xt,{AbortException:()=>Ho,AnnotationEditorLayer:()=>yY,AnnotationEditorParamsType:()=>mt,AnnotationEditorType:()=>zt,AnnotationEditorUIManager:()=>hf,AnnotationLayer:()=>BE,AnnotationMode:()=>Ga,CMapCompressionType:()=>CS,ColorPicker:()=>Tv,DOMSVGFactory:()=>cf,DrawLayer:()=>jE,FeatureTest:()=>Di,GlobalWorkerOptions:()=>ql,ImageKind:()=>Q0,InvalidPDFException:()=>$0,MissingPDFException:()=>Uo,OPS:()=>vs,PDFDataRangeTransport:()=>mv,PDFDateString:()=>av,PDFWorker:()=>Wd,PasswordResponses:()=>IX,PermissionFlag:()=>TX,PixelsPerInch:()=>Wa,RenderingCancelledException:()=>uf,TextLayer:()=>mf,UnexpectedResponseException:()=>qd,Util:()=>qe,VerbosityLevel:()=>Dv,XfaLayer:()=>xv,build:()=>xY,createValidAbsoluteUrl:()=>LX,fetchData:()=>kv,getDocument:()=>pY,getFilenameFromUrl:()=>UX,getPdfFilenameFromUrl:()=>HX,getXfaPageViewport:()=>zX,isDataScheme:()=>Nv,isPdfFile:()=>WE,noContextMenu:()=>Gr,normalizeUnicode:()=>BX,setLayerDimensions:()=>Zl,shadow:()=>qt,version:()=>vY});var Ii=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),qk=[1,0,0,1,0,0],ES=[.001,0,0,.001,0,0],EX=1e7,Y0=1.35,CX=.35,Khe=CX/Y0,vr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ga={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},MX="pdfjs_internal_editor_",zt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},mt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},TX={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ti={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Q0={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ni={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var tf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var Dv={ERRORS:0,WARNINGS:1,INFOS:5},CS={NONE:0,BINARY:1},vs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},IX={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Pv=Dv.WARNINGS;function DX(i){Number.isInteger(i)&&(Pv=i)}function PX(){return Pv}function Rv(i){Pv>=Dv.INFOS&&console.log(`Info: ${i}`)}function Ft(i){Pv>=Dv.WARNINGS&&console.log(`Warning: ${i}`)}function Xn(i){throw new Error(i)}function ii(i,e){i||Xn(e)}function RX(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function LX(i,e=null,t=null){if(!i)return null;try{if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=OX(i)}catch{}let n=e?new URL(i,e):new URL(i);if(RX(n))return n}catch{}return null}function qt(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}var qa=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}(),af=class extends qa{constructor(e,t){super(e,"PasswordException"),this.code=t}},lf=class extends qa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},$0=class extends qa{constructor(e){super(e,"InvalidPDFException")}},Uo=class extends qa{constructor(e){super(e,"MissingPDFException")}},qd=class extends qa{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},MS=class extends qa{constructor(e){super(e,"FormatError")}},Ho=class extends qa{constructor(e){super(e,"AbortException")}};function Zk(i){(typeof i!="object"||i?.length===void 0)&&Xn("Invalid argument for bytesToString");let e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);let n=[];for(let r=0;r<e;r+=t){let s=Math.min(r+t,e),o=i.subarray(r,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function Lv(i){typeof i!="string"&&Xn("Invalid argument for stringToBytes");let e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function kX(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function GE(i){let e=Object.create(null);for(let[t,n]of i)e[t]=n;return e}function NX(){let i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function FX(){try{return new Function(""),!0}catch{return!1}}var Di=class{static get isLittleEndian(){return qt(this,"isLittleEndian",NX())}static get isEvalSupported(){return qt(this,"isEvalSupported",FX())}static get isOffscreenCanvasSupported(){return qt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?qt(this,"platform",{isMac:navigator.platform.includes("Mac")}):qt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return qt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},yS=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0")),qe=class{static makeHexColor(e,t,n){return`#${yS[e]}${yS[t]}${yS[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let n=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[n,r]}static applyInverseTransform(e,t){let n=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[r,s]}static getAxialAlignedBoundingBox(e,t){let n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],s[0],o[0]),Math.min(n[1],r[1],s[1],o[1]),Math.max(n[0],r[0],s[0],o[0]),Math.max(n[1],r[1],s[1],o[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(n+o)/2,l=Math.sqrt((n+o)**2-4*(n*o-s*r))/2,c=a+l||1,d=a-l||1;return[Math.sqrt(c),Math.sqrt(d)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;let s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[n,s,r,o]}static#e(e,t,n,r,s,o,a,l,c,d){if(c<=0||c>=1)return;let u=1-c,h=c*c,f=h*c,p=u*(u*(u*e+3*c*t)+3*h*n)+f*r,v=u*(u*(u*s+3*c*o)+3*h*a)+f*l;d[0]=Math.min(d[0],p),d[1]=Math.min(d[1],v),d[2]=Math.max(d[2],p),d[3]=Math.max(d[3],v)}static#t(e,t,n,r,s,o,a,l,c,d,u,h){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&this.#e(e,t,n,r,s,o,a,l,-u/d,h);return}let f=d**2-4*u*c;if(f<0)return;let p=Math.sqrt(f),v=2*c;this.#e(e,t,n,r,s,o,a,l,(-d+p)/v,h),this.#e(e,t,n,r,s,o,a,l,(-d-p)/v,h)}static bezierBoundingBox(e,t,n,r,s,o,a,l,c){return c?(c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],this.#t(e,n,s,a,t,r,o,l,3*(-e+3*(n-s)+a),6*(e-2*n+s),3*(n-e),c),this.#t(e,n,s,a,t,r,o,l,3*(-t+3*(r-o)+l),6*(t-2*r+o),3*(r-t),c),c}};function OX(i){return decodeURIComponent(escape(i))}var bS=null,Pk=null;function BX(i){return bS||(bS=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pk=new Map([["\uFB05","\u017Ft"]])),i.replaceAll(bS,(e,t,n)=>t?t.normalize("NFKC"):Pk.get(n))}function VX(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let i=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(i);else for(let e=0;e<32;e++)i[e]=Math.floor(Math.random()*255);return Zk(i)}var Xk="pdfjs_internal_id_",Fo={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8},ev=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,s){return"none"}destroy(e=!1){}},tv=class{#e=!1;constructor({enableHWA:e=!1}={}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Xn("Abstract method `_createCanvas` called.")}},nv=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}fetch(t){return ce(this,arguments,function*({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let n=this.baseUrl+e+(this.isCompressed?".bcmap":""),r=this.isCompressed?CS.BINARY:CS.NONE;return this._fetchData(n,r).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${n}`)})})}_fetchData(e,t){Xn("Abstract method `_fetchData` called.")}},iv=class{constructor({baseUrl:e=null}){this.baseUrl=e}fetch(t){return ce(this,arguments,function*({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let n=`${this.baseUrl}${e}`;return this._fetchData(n).catch(r=>{throw new Error(`Unable to load font data at: ${n}`)})})}_fetchData(e){Xn("Abstract method `_fetchData` called.")}},TS=class{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Xn("Abstract method `_createSVG` called.")}},Bo="http://www.w3.org/2000/svg",Wa=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF},IS=class extends ev{#e;#t;#n;#i;#r;#s;#a=0;constructor({docId:e,ownerDocument:t=globalThis.document}={}){super(),this.#i=e,this.#r=t}get#l(){return this.#t||=new Map}get#u(){return this.#s||=new Map}get#c(){if(!this.#n){let e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let n=this.#r.createElementNS(Bo,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#r.createElementNS(Bo,"defs"),e.append(n),n.append(this.#n),this.#r.body.append(e)}return this.#n}#d(e){if(e.length===1){let l=e[0],c=new Array(256);for(let u=0;u<256;u++)c[u]=l[u]/255;let d=c.join(",");return[d,d,d]}let[t,n,r]=e,s=new Array(256),o=new Array(256),a=new Array(256);for(let l=0;l<256;l++)s[l]=t[l]/255,o[l]=n[l]/255,a[l]=r[l]/255;return[s.join(","),o.join(","),a.join(",")]}#o(e){if(this.#e===void 0){this.#e="";let t=this.#r.URL;t!==this.#r.baseURI&&(Nv(t)?Ft('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#l.get(e);if(t)return t;let[n,r,s]=this.#d(e),o=e.length===1?n:`${n}${r}${s}`;if(t=this.#l.get(o),t)return this.#l.set(e,t),t;let a=`g_${this.#i}_transfer_map_${this.#a++}`,l=this.#o(a);this.#l.set(e,l),this.#l.set(o,l);let c=this.#f(a);return this.#v(n,r,s,c),l}addHCMFilter(e,t){let n=`${e}-${t}`,r="base",s=this.#u.get(r);if(s?.key===n||(s?(s.filter?.remove(),s.key=n,s.url="none",s.filter=null):(s={key:n,url:"none",filter:null},this.#u.set(r,s)),!e||!t))return s.url;let o=this.#x(e);e=qe.makeHexColor(...o);let a=this.#x(t);if(t=qe.makeHexColor(...a),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;let l=new Array(256);for(let f=0;f<=255;f++){let p=f/255;l[f]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}let c=l.join(","),d=`g_${this.#i}_hcm_filter`,u=s.filter=this.#f(d);this.#v(c,c,c,u),this.#p(u);let h=(f,p)=>{let v=o[f]/255,g=a[f]/255,m=new Array(p+1);for(let y=0;y<=p;y++)m[y]=v+y/p*(g-v);return m.join(",")};return this.#v(h(0,5),h(1,5),h(2,5),u),s.url=this.#o(d),s.url}addAlphaFilter(e){let t=this.#l.get(e);if(t)return t;let[n]=this.#d([e]),r=`alpha_${n}`;if(t=this.#l.get(r),t)return this.#l.set(e,t),t;let s=`g_${this.#i}_alpha_map_${this.#a++}`,o=this.#o(s);this.#l.set(e,o),this.#l.set(r,o);let a=this.#f(s);return this.#g(n,a),o}addLuminosityFilter(e){let t=this.#l.get(e||"luminosity");if(t)return t;let n,r;if(e?([n]=this.#d([e]),r=`luminosity_${n}`):r="luminosity",t=this.#l.get(r),t)return this.#l.set(e,t),t;let s=`g_${this.#i}_luminosity_map_${this.#a++}`,o=this.#o(s);this.#l.set(e,o),this.#l.set(r,o);let a=this.#f(s);return this.#h(a),e&&this.#g(n,a),o}addHighlightHCMFilter(e,t,n,r,s){let o=`${t}-${n}-${r}-${s}`,a=this.#u.get(e);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#u.set(e,a)),!t||!n))return a.url;let[l,c]=[t,n].map(this.#x.bind(this)),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[h,f]=[r,s].map(this.#x.bind(this));u<d&&([d,u,h,f]=[u,d,f,h]),this.#c.style.color="";let p=(m,y,w)=>{let A=new Array(256),C=(u-d)/w,E=m/255,T=(y-m)/(255*w),L=0;for(let S=0;S<=w;S++){let _=Math.round(d+S*C),P=E+S*T;for(let U=L;U<=_;U++)A[U]=P;L=_+1}for(let S=L;S<256;S++)A[S]=A[L-1];return A.join(",")},v=`g_${this.#i}_hcm_${e}_filter`,g=a.filter=this.#f(v);return this.#p(g),this.#v(p(h[0],f[0],5),p(h[1],f[1],5),p(h[2],f[2],5),g),a.url=this.#o(v),a.url}destroy(e=!1){e&&this.#u.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#a=0)}#h(e){let t=this.#r.createElementNS(Bo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){let t=this.#r.createElementNS(Bo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){let t=this.#r.createElementNS(Bo,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#m(e,t,n){let r=this.#r.createElementNS(Bo,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)}#v(e,t,n,r){let s=this.#r.createElementNS(Bo,"feComponentTransfer");r.append(s),this.#m(s,"feFuncR",e),this.#m(s,"feFuncG",t),this.#m(s,"feFuncB",n)}#g(e,t){let n=this.#r.createElementNS(Bo,"feComponentTransfer");t.append(n),this.#m(n,"feFuncA",e)}#x(e){return this.#c.style.color=e,qE(getComputedStyle(this.#c).getPropertyValue("color"))}},DS=class extends tv{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}={}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let n=this._document.createElement("canvas");return n.width=e,n.height=t,n}};function kv(i,e="text"){return ce(this,null,function*(){if(sf(i,document.baseURI)){let t=yield fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{let r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})})}var rv=class extends nv{_fetchData(e,t){return kv(e,this.isCompressed?"arraybuffer":"text").then(n=>({cMapData:n instanceof ArrayBuffer?new Uint8Array(n):Lv(n),compressionType:t}))}},sv=class extends iv{_fetchData(e){return kv(e,"arraybuffer").then(t=>new Uint8Array(t))}},cf=class extends TS{_createSVG(e){return document.createElementNS(Bo,e)}},df=class i{constructor({viewBox:e,scale:t,rotation:n,offsetX:r=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=r,this.offsetY=s;let a=(e[2]+e[0])/2,l=(e[3]+e[1])/2,c,d,u,h;switch(n%=360,n<0&&(n+=360),n){case 180:c=-1,d=0,u=0,h=1;break;case 90:c=0,d=1,u=1,h=0;break;case 270:c=0,d=-1,u=-1,h=0;break;case 0:c=1,d=0,u=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(u=-u,h=-h);let f,p,v,g;c===0?(f=Math.abs(l-e[1])*t+r,p=Math.abs(a-e[0])*t+s,v=(e[3]-e[1])*t,g=(e[2]-e[0])*t):(f=Math.abs(a-e[0])*t+r,p=Math.abs(l-e[1])*t+s,v=(e[2]-e[0])*t,g=(e[3]-e[1])*t),this.transform=[c*t,d*t,u*t,h*t,f-c*t*a-u*t*l,p-d*t*a-h*t*l],this.width=v,this.height=g}get rawDims(){let{viewBox:e}=this;return qt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new i({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){return qe.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=qe.applyTransform([e[0],e[1]],this.transform),n=qe.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return qe.applyInverseTransform([e,t],this.transform)}},uf=class extends qa{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function Nv(i){let e=i.length,t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function WE(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function UX(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function HX(i,e="document.pdf"){if(typeof i!="string")return e;if(Nv(i))return Ft('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(i),s=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||e}var ov=class{started=Object.create(null);times=[];time(e){e in this.started&&Ft(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ft(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:n}of this.times)t=Math.max(n.length,t);for(let{name:n,start:r,end:s}of this.times)e.push(`${n.padEnd(t)} ${s-r}ms
`);return e.join("")}};function sf(i,e){try{let{protocol:t}=e?new URL(i,e):new URL(i);return t==="http:"||t==="https:"}catch{return!1}}function Gr(i){i.preventDefault()}var Rk,av=class{static toDateObject(e){if(!e||typeof e!="string")return null;Rk||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=Rk.exec(e);if(!t)return null;let n=parseInt(t[1],10),r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;let c=t[7]||"Z",d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(o+=d,a+=u):c==="+"&&(o-=d,a-=u),new Date(Date.UTC(n,r,s,o,a,l))}};function zX(i,{scale:e=1,rotation:t=0}){let{width:n,height:r}=i.attributes.style,s=[0,0,parseInt(n),parseInt(r)];return new df({viewBox:s,scale:e,rotation:t})}function qE(i){if(i.startsWith("#")){let e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ft(`Not a valid color format: "${i}"`),[0,0,0])}function jX(i){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of i.keys()){e.style.color=t;let n=window.getComputedStyle(e).color;i.set(t,qE(n))}e.remove()}function Tn(i){let{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform();return[e,t,n,r,s,o]}function Oo(i){let{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform().invertSelf();return[e,t,n,r,s,o]}function Zl(i,e,t=!1,n=!0){if(e instanceof df){let{pageWidth:r,pageHeight:s}=e.rawDims,{style:o}=i,a=Di.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,c=`var(--scale-factor) * ${s}px`,d=a?`round(${l}, 1px)`:`calc(${l})`,u=a?`round(${c}, 1px)`:`calc(${c})`;!t||e.rotation%180===0?(o.width=d,o.height=u):(o.width=u,o.height=d)}n&&i.setAttribute("data-main-rotation",e.rotation)}var PS=class i{#e=null;#t=null;#n;#i=null;#r=null;static#s=null;constructor(e){this.#n=e,i.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#e=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");let t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Gr,{signal:t}),e.addEventListener("pointerdown",i.#a,{signal:t});let n=this.#i=document.createElement("div");n.className="buttons",e.append(n);let r=this.#n.toolbarPosition;if(r){let{style:s}=e,o=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}static#a(e){e.stopPropagation()}#l(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#u(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#c(e){let t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Gr,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#d(){let{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",i.#s[e]),this.#c(n),n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#i.append(n)}get#o(){let e=document.createElement("div");return e.className="divider",e}addAltText(e){return ce(this,null,function*(){let t=yield e.render();this.#c(t),this.#i.prepend(t,this.#o),this.#r=e})}addColorPicker(e){this.#t=e;let t=e.renderButton();this.#c(t),this.#i.prepend(t,this.#o)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}},RS=class{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){let e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Gr,{signal:this.#n._signal});let t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#r(e,t){let n=0,r=0;for(let s of e){let o=s.y+s.height;if(o<n)continue;let a=s.x+(t?s.width:0);if(o>n){r=a,n=o;continue}t?a>r&&(r=a):a<r&&(r=a)}return[t?1-r:r,n]}show(e,t,n){let[r,s]=this.#r(t,n),{style:o}=this.#t||=this.#i();e.append(this.#t),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let n=this.#n._signal;e.addEventListener("contextmenu",Gr,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}};function lv(i,e,t){for(let n of t)e.addEventListener(n,i[n].bind(i))}function GX(i){return Math.round(Math.min(255,Math.max(1,255*i))).toString(16).padStart(2,"0")}var LS=class{#e=0;get id(){return`${MX}${this.#e++}`}},kS=class i{#e=VX();#t=0;#n=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;let s=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return qt(this,"_isSVGFittingCanvas",s)}#i(e,t){return ce(this,null,function*(){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(n.url=t,r=yield kv(t,"blob")):r=n.file=t,r.type==="image/svg+xml"){let s=i._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,d)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,c()},o.onload=()=>ce(this,null,function*(){let u=n.svgUrl=o.result;a.src=(yield s)?`${u}#svgView(preserveAspectRatio(none))`:u}),a.onerror=o.onerror=d});o.readAsDataURL(r),yield l}else n.bitmap=yield createImageBitmap(r);n.refCounter=1}catch(r){console.error(r),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n})}getFromFile(e){return ce(this,null,function*(){let{lastModified:t,name:n,size:r,type:s}=e;return this.#i(`${t}_${n}_${r}_${s}`,e)})}getFromUrl(e){return ce(this,null,function*(){return this.#i(e,e)})}getFromId(e){return ce(this,null,function*(){this.#n||=new Map;let t=this.#n.get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null})}getSvgUrl(e){let t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;let t=this.#n.get(e);t&&(t.refCounter-=1,t.refCounter===0&&(t.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#e}_`)}},NS=class{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:r,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(r&&e(),this.#t)return;let l={cmd:e,undo:t,post:n,type:s};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(o&&this.#e[this.#i].type===s){a&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}let c=this.#i+1;c===this.#n?this.#e.splice(0,1):(this.#i=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;let{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;let{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}destroy(){this.#e=null}},Xl=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Di.platform;for(let[n,r,s={}]of e)for(let o of n){let a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let n=this.callbacks.get(this.#e(t));if(!n)return;let{callback:r,options:{bubbles:s=!1,args:o=[],checker:a=null}}=n;a&&!a(e,t)||(r.bind(e,...o,t)(),s||(t.stopPropagation(),t.preventDefault()))}},FS=class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return jX(e),qt(this,"_colors",e)}convert(e){let t=qE(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[n,r]of this._colors)if(r.every((s,o)=>s===t[o]))return i._colorsMapping.get(n);return t}getHexCode(e){let t=this._colors.get(e);return t?qe.makeHexColor(...t):e}},hf=(()=>{class i{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#r=null;#s=null;#a=null;#l=new NS;#u=null;#c=0;#d=new Set;#o=null;#h=null;#p=new Set;#f=!1;#m=!1;#v=!1;#g=null;#x=null;#y=null;#A=null;#b=!1;#S=null;#D=new LS;#M=!1;#_=!1;#T=null;#C=null;#P=null;#k=null;#E=zt.NONE;#w=new Set;#I=null;#R=null;#F=null;#H={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#V=[0,0];#N=null;#O=null;#B=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=i.prototype,n=a=>a.#O.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:l})=>{if(l instanceof HTMLInputElement){let{type:c}=l;return c!=="text"&&c!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return qt(this,"_keyboardManager",new Xl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#O.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#O.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:n}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:n}]]))}constructor(t,n,r,s,o,a,l,c,d,u,h){let f=this._signal=this.#e.signal;this.#O=t,this.#B=n,this.#r=r,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:f}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:f}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:f}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:f}),s._on("setpreference",this.onSetPreference.bind(this),{signal:f}),s._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:f}),this.#$(),this.#ie(),this.#q(),this.#s=o.annotationStorage,this.#g=o.filterFactory,this.#R=a,this.#A=l||null,this.#f=c,this.#m=d,this.#v=u,this.#k=h||null,this.viewParameters={realScale:Wa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#e?.abort(),this.#e=null,this._signal=null;for(let t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#w.clear(),this.#l.destroy(),this.#r?.destroy(),this.#S?.hide(),this.#S=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#N&&(clearTimeout(this.#N),this.#N=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#k}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return qt(this,"hcmFilter",this.#R?this.#g.addHCMFilter(this.#R.foreground,this.#R.background):"none")}get direction(){return qt(this,"direction",getComputedStyle(this.#O).direction)}get highlightColors(){return qt(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(t=>t.split("=").map(n=>n.trim()))):null)}get highlightColorNames(){return qt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#P=t}editAltText(t,n=!1){this.#r?.editAltText(this,t,n)}switchToMode(t,n){this._eventBus.on("annotationeditormodechanged",n,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,n){this._eventBus.dispatch("setpreference",{source:this,name:t,value:n})}onSetPreference({name:t,value:n}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=n;break}}onPageChanging({pageNumber:t}){this.#c=t-1}focusMainContainer(){this.#O.focus()}findParent(t,n){for(let r of this.#i.values()){let{x:s,y:o,width:a,height:l}=r.div.getBoundingClientRect();if(t>=s&&t<=s+a&&n>=o&&n<=o+l)return r}return null}disableUserSelect(t=!1){this.#B.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Wa.PDF_TO_CSS_UNITS;for(let n of this.#p)n.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#U({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#W(t){let{currentLayer:n}=this;if(n.hasTextLayer(t))return n;for(let r of this.#i.values())if(r.hasTextLayer(t))return r;return null}highlightSelection(t=""){let n=document.getSelection();if(!n||n.isCollapsed)return;let{anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a}=n,l=n.toString(),d=this.#U(n).closest(".textLayer"),u=this.getSelectionBoxes(d);if(!u)return;n.empty();let h=this.#W(d),f=this.#E===zt.NONE,p=()=>{h?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a,text:l}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(zt.HIGHLIGHT,p);return}p()}#K(){let t=document.getSelection();if(!t||t.isCollapsed)return;let r=this.#U(t).closest(".textLayer"),s=this.getSelectionBoxes(r);s&&(this.#S||=new RS(this),this.#S.show(r,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#J(){let t=document.getSelection();if(!t||t.isCollapsed){this.#I&&(this.#S?.hide(),this.#I=null,this.#L({hasSelectedText:!1}));return}let{anchorNode:n}=t;if(n===this.#I)return;let s=this.#U(t).closest(".textLayer");if(!s){this.#I&&(this.#S?.hide(),this.#I=null,this.#L({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#I=n,this.#L({hasSelectedText:!0}),!(this.#E!==zt.HIGHLIGHT&&this.#E!==zt.NONE)&&(this.#E===zt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){let o=this.#E===zt.HIGHLIGHT?this.#W(s):null;o?.toggleDrawing();let a=new AbortController,l=this.combinedSignal(a),c=d=>{d.type==="pointerup"&&d.button!==0||(a.abort(),o?.toggleDrawing(!0),d.type==="pointerup"&&this.#G("main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}}#G(t=""){this.#E===zt.HIGHLIGHT?this.highlightSelection(t):this.#f&&this.#K()}#$(){document.addEventListener("selectionchange",this.#J.bind(this),{signal:this._signal})}#ee(){if(this.#y)return;this.#y=new AbortController;let t=this.combinedSignal(this.#y);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#te(){this.#y?.abort(),this.#y=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#G("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let n of this.#w)if(n.div.contains(t)){this.#C=[n,t],n._focusEventsAllowed=!1;break}}focus(){if(!this.#C)return;let[t,n]=this.#C;this.#C=null,n.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),n.focus()}#q(){if(this.#T)return;this.#T=new AbortController;let t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ne(){this.#T?.abort(),this.#T=null}#Z(){if(this.#u)return;this.#u=new AbortController;let t=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#X(){this.#u?.abort(),this.#u=null}#ie(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#q(),this.#Z()}removeEditListeners(){this.#ne(),this.#X()}dragOver(t){for(let{type:n}of t.dataTransfer.items)for(let r of this.#h)if(r.isHandlingMimeForPasting(n)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let n of t.dataTransfer.items)for(let r of this.#h)if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let n=[];for(let r of this.#w){let s=r.serialize(!0);s&&n.push(s)}n.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();let{clipboardData:n}=t;for(let o of n.items)for(let a of this.#h)if(a.isHandlingMimeForPasting(o.type)){a.paste(o,this.currentLayer);return}let r=n.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(o){Ft(`paste: "${o.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();let s=this.currentLayer;try{let o=[];for(let c of r){let d=s.deserialize(c);if(!d)return;o.push(d)}let a=()=>{for(let c of o)this.#Y(c);this.#Q(o)},l=()=>{for(let c of o)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(o){Ft(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==zt.NONE&&!this.isEditorHandlingKeyboard&&i._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#G("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#L(t){Object.entries(t).some(([r,s])=>this.#H[r]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#H,t)}),this.#E===zt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#z([[mt.HIGHLIGHT_FREE,!0]]))}#z(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ee(),this.#Z(),this.#L({isEditing:this.#E!==zt.NONE,isEmpty:this.#j(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#te(),this.#X(),this.#L({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(let n of this.#h)this.#z(n.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#i.get(this.#c)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#c}addLayer(t){this.#i.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}updateMode(t,n=null,r=!1){if(this.#E!==t){if(this.#E=t,t===zt.NONE){this.setEditingState(!1),this.#se();return}this.setEditingState(!0),this.#re(),this.unselectAll();for(let s of this.#i.values())s.updateMode(t);if(!n&&r){this.addNewEditorFromKeyboard();return}if(n){for(let s of this.#n.values())if(s.annotationElementId===n){this.setSelected(s),s.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,n){if(this.#h){switch(t){case mt.CREATE:this.currentLayer.addNewEditor();return;case mt.HIGHLIGHT_DEFAULT_COLOR:this.#P?.updateColor(n);break;case mt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#F||=new Map).set(t,n),this.showAllEditors("highlight",n);break}for(let r of this.#w)r.updateParams(t,n);for(let r of this.#h)r.updateDefaultParams(t,n)}}showAllEditors(t,n,r=!1){for(let o of this.#n.values())o.editorType===t&&o.show(n);(this.#F?.get(mt.HIGHLIGHT_SHOW_ALL)??!0)!==n&&this.#z([[mt.HIGHLIGHT_SHOW_ALL,n]])}enableWaiting(t=!1){if(this.#_!==t){this.#_=t;for(let n of this.#i.values())t?n.disableClick():n.enableClick(),n.div.classList.toggle("waiting",t)}}#re(){if(!this.#M){this.#M=!0;for(let t of this.#i.values())t.enable();for(let t of this.#n.values())t.enable()}}#se(){if(this.unselectAll(),this.#M){this.#M=!1;for(let t of this.#i.values())t.disable();for(let t of this.#n.values())t.disable()}}getEditors(t){let n=[];for(let r of this.#n.values())r.pageIndex===t&&n.push(r);return n}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#d.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#d.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#d.has(t)}removeDeletedAnnotationElement(t){this.#d.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Y(t){let n=this.#i.get(t.pageIndex);n?n.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#z(t.propertiesToUpdate))}get#oe(){let t=null;for(t of this.#w);return t}updateUI(t){this.#oe===t&&this.#z(t.propertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#L({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#L({hasSelectedEditor:!0})}setSelected(t){for(let n of this.#w)n!==t&&n.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#L({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#L({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#L({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#j()})}redo(){this.#l.redo(),this.#L({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#j()})}addCommands(t){this.#l.add(t),this.#L({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#j()})}#j(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(let t of this.#n.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let t=[...this.#w],n=()=>{for(let s of t)s.remove()},r=()=>{for(let s of t)this.#Y(s)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Q(t){for(let n of this.#w)n.unselect();this.#w.clear();for(let n of t)n.isEmpty()||(this.#w.add(n),n.select());this.#L({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#w)t.commit();this.#Q(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#E!==zt.NONE))&&this.hasSelection){for(let t of this.#w)t.unselect();this.#w.clear(),this.#L({hasSelectedEditor:!1})}}translateSelectedEditors(t,n,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;this.#V[0]+=t,this.#V[1]+=n;let[s,o]=this.#V,a=[...this.#w],l=1e3;this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.#N=null,this.#V[0]=this.#V[1]=0,this.addCommands({cmd:()=>{for(let c of a)this.#n.has(c.id)&&c.translateInPage(s,o)},undo:()=>{for(let c of a)this.#n.has(c.id)&&c.translateInPage(-s,-o)},mustExec:!1})},l);for(let c of a)c.translateInPage(t,n)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#o=new Map;for(let t of this.#w)this.#o.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#o)return!1;this.disableUserSelect(!1);let t=this.#o;this.#o=null;let n=!1;for(let[{x:s,y:o,pageIndex:a},l]of t)l.newX=s,l.newY=o,l.newPageIndex=a,n||=s!==l.savedX||o!==l.savedY||a!==l.savedPageIndex;if(!n)return!1;let r=(s,o,a,l)=>{if(this.#n.has(s.id)){let c=this.#i.get(l);c?s._setParentAndPosition(c,o,a):(s.pageIndex=l,s.x=o,s.y=a)}};return this.addCommands({cmd:()=>{for(let[s,{newX:o,newY:a,newPageIndex:l}]of t)r(s,o,a,l)},undo:()=>{for(let[s,{savedX:o,savedY:a,savedPageIndex:l}]of t)r(s,o,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,n){if(this.#o)for(let r of this.#o.keys())r.drag(t,n)}rebuild(t){if(t.parent===null){let n=this.getLayer(t.pageIndex);n?(n.changeParent(t),n.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#E}get imageManager(){return qt(this,"imageManager",new kS)}getSelectionBoxes(t){if(!t)return null;let n=document.getSelection();for(let d=0,u=n.rangeCount;d<u;d++)if(!t.contains(n.getRangeAt(d).commonAncestorContainer))return null;let{x:r,y:s,width:o,height:a}=t.getBoundingClientRect(),l;switch(t.getAttribute("data-main-rotation")){case"90":l=(d,u,h,f)=>({x:(u-s)/a,y:1-(d+h-r)/o,width:f/a,height:h/o});break;case"180":l=(d,u,h,f)=>({x:1-(d+h-r)/o,y:1-(u+f-s)/a,width:h/o,height:f/a});break;case"270":l=(d,u,h,f)=>({x:1-(u+f-s)/a,y:(d-r)/o,width:f/a,height:h/o});break;default:l=(d,u,h,f)=>({x:(d-r)/o,y:(u-s)/a,width:h/o,height:f/a});break}let c=[];for(let d=0,u=n.rangeCount;d<u;d++){let h=n.getRangeAt(d);if(!h.collapsed)for(let{x:f,y:p,width:v,height:g}of h.getClientRects())v===0||g===0||c.push(l(f,p,v,g))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:n}){(this.#a||=new Map).set(t,n)}removeChangedExistingAnnotation({annotationElementId:t}){this.#a?.delete(t)}renderAnnotationElement(t){let n=this.#a?.get(t.data.id);if(!n)return;let r=this.#s.getRawValue(n);r&&(this.#E===zt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}}return i})(),Lk=(()=>{class i{#e=null;#t=!1;#n=null;#i=null;#r=null;#s=!1;#a=null;#l=null;#u=null;#c=null;#d=!1;static _l10nPromise=null;constructor(t){this.#l=t,this.#d=t._uiManager.useNewAltTextFlow}static initialize(t){i._l10nPromise||=t}render(){return ce(this,null,function*(){let t=this.#n=document.createElement("button");t.className="altText";let n;this.#d?(t.classList.add("new"),n=yield i._l10nPromise.get("pdfjs-editor-new-alt-text-missing-button-label")):n=yield i._l10nPromise.get("pdfjs-editor-alt-text-button-label"),t.textContent=n,t.setAttribute("aria-label",n),t.tabIndex="0";let r=this.#l._uiManager._signal;t.addEventListener("contextmenu",Gr,{signal:r}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:r});let s=o=>{o.preventDefault(),this.#l._uiManager.editAltText(this.#l),this.#d&&this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#o}})};return t.addEventListener("click",s,{capture:!0,signal:r}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#s=!0,s(o))},{signal:r}),yield this.#h(),t})}get#o(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#u:this.isEmpty()}get guessedText(){return this.#u}setGuessedText(t){return ce(this,null,function*(){this.#e===null&&(this.#u=t,this.#c=yield i._l10nPromise.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer")({generatedAltText:t}),this.#h())})}toggleAltTextBadge(t=!1){if(!this.#d||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){let n=this.#a=document.createElement("div");n.className="noAltTextBadge",this.#l.div.append(n)}this.#a.classList.toggle("hidden",!t)}serialize(t){let n=this.#e;return!t&&this.#u===n&&(n=this.#c),{altText:n,decorative:this.#t,guessedText:this.#u,textWithDisclaimer:this.#c}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:t,decorative:n,guessedText:r,textWithDisclaimer:s,cancel:o=!1}){r&&(this.#u=r,this.#c=s),!(this.#e===t&&this.#t===n)&&(o||(this.#e=t,this.#t=n),this.#h())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#o}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a?.remove(),this.#a=null}#h(){return ce(this,null,function*(){let t=this.#n;if(!t)return;if(this.#d){let s=this.#o,o=s==="review"?"to-review":s;if(t.classList.toggle("done",!!this.#e),i._l10nPromise.get(`pdfjs-editor-new-alt-text-${o}-button-label`).then(a=>{t.setAttribute("aria-label",a);for(let l of t.childNodes)if(l.nodeType===Node.TEXT_NODE){l.textContent=a;break}}),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){t.classList.remove("done"),this.#i?.remove();return}t.classList.add("done"),i._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(s=>{t.setAttribute("aria-label",s)})}let n=this.#i;if(!n){this.#i=n=document.createElement("span"),n.className="tooltip",n.setAttribute("role","tooltip");let s=n.id=`alt-text-tooltip-${this.#l.id}`;t.setAttribute("aria-describedby",s);let o=100,a=this.#l._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#i.classList.add("show"),this.#l._reportTelemetry({action:"alt_text_tooltip"})},o)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i?.classList.remove("show")},{signal:a})}n.innerText=this.#t?yield i._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):this.#e,n.parentNode||t.append(n),this.#l.getImageForAltText()?.setAttribute("aria-describedby",n.id)})}}return i})(),nn=class i{#e=null;#t=null;#n=null;#i=!1;#r=!1;#s=null;#a=null;#l=null;#u="";#c=!1;#d=null;#o=!1;#h=!1;#p=!1;#f=null;#m=0;#v=0;#g=null;_editToolbar=null;_initialOptions=Object.create(null);_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10nPromise=null;static _l10nResizer=null;#x=!1;#y=i._zIndex++;static _borderLineWidth=-1;static _colorManager=new FS;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=i.prototype._resizeWithKeyboard,t=hf.TRANSLATE_SMALL,n=hf.TRANSLATE_BIG;return qt(this,"_resizerKeyboardManager",new Xl([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],i.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[s,o];let[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return qt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new OS({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t,n){if(i._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),i._l10nPromise||=new Map([...["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-new-alt-text-added-button-label","pdfjs-editor-new-alt-text-missing-button-label","pdfjs-editor-new-alt-text-to-review-button-label"].map(s=>[s,e.get(s)]),...["pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer"].map(s=>[s,e.get.bind(e,s)])]),n?.strings)for(let s of n.strings)i._l10nPromise.set(s,e.get(s));if(i._borderLineWidth!==-1)return;let r=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Xn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(e){this.#x=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#y}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#F(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#c?this.#c=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){let[s,o]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/s,this.y=(t+r)/o,this.fixAndSetPosition()}#A([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this.fixAndSetPosition()}translate(e,t){this.#A(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y],this.#A(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#d||=[this.x,this.y];let[n,r]=this.parentDimensions;if(this.x+=e/n,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this,[a,l]=this.getBaseTranslation();s+=a,o+=l,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:n}=i,r=n/e,s=n/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let[t,n]=this.pageDimensions,{x:r,y:s,width:o,height:a}=this;if(o*=t,a*=n,r*=t,s*=n,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(t-o,r)),s=Math.max(0,Math.min(n-a,s));break;case 90:r=Math.max(0,Math.min(t-a,r)),s=Math.min(n,Math.max(o,s));break;case 180:r=Math.min(t,Math.max(o,r)),s=Math.min(n,Math.max(a,s));break;case 270:r=Math.min(t,Math.max(a,r)),s=Math.max(0,Math.min(n-o,s));break}this.x=r/=t,this.y=s/=n;let[l,c]=this.getBaseTranslation();r+=l,s+=c;let{style:d}=this.div;d.left=`${(100*r).toFixed(2)}%`,d.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#b(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return i.#b(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return i.#b(e,t,360-this.parentRotation)}#S(e){switch(e){case 90:{let[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,n]}=this,r=t*e,s=n*e;return Di.isCSSRoundSupported?[Math.round(r),Math.round(s)]:[r,s]}setDims(e,t){let[n,r]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#r||(this.div.style.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),s=!this.#r&&t.endsWith("%");if(r&&s)return;let[o,a]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!this.#r&&!s&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#D(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let n of e){let r=document.createElement("div");this.#s.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#M.bind(this,n),{signal:t}),r.addEventListener("contextmenu",Gr,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#s)}#M(e,t){t.preventDefault();let{isMac:n}=Di.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);let r=this._isDraggable;this._isDraggable=!1;let s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#T.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("contextmenu",Gr,{signal:o});let a=this.x,l=this.y,c=this.width,d=this.height,u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#_(a,l,c,d)};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#_(e,t,n,r){let s=this.x,o=this.y,a=this.width,l=this.height;s===e&&o===t&&a===n&&l===r||this.addCommands({cmd:()=>{this.width=a,this.height=l,this.x=s,this.y=o;let[c,d]=this.parentDimensions;this.setDims(c*a,d*l),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=r,this.x=e,this.y=t;let[c,d]=this.parentDimensions;this.setDims(c*n,d*r),this.fixAndSetPosition()},mustExec:!0})}#T(e,t){let[n,r]=this.parentDimensions,s=this.x,o=this.y,a=this.width,l=this.height,c=i.MIN_SIZE/n,d=i.MIN_SIZE/r,u=K=>Math.round(K*1e4)/1e4,h=this.#S(this.rotation),f=(K,W)=>[h[0]*K+h[2]*W,h[1]*K+h[3]*W],p=this.#S(360-this.rotation),v=(K,W)=>[p[0]*K+p[2]*W,p[1]*K+p[3]*W],g,m,y=!1,w=!1;switch(e){case"topLeft":y=!0,g=(K,W)=>[0,0],m=(K,W)=>[K,W];break;case"topMiddle":g=(K,W)=>[K/2,0],m=(K,W)=>[K/2,W];break;case"topRight":y=!0,g=(K,W)=>[K,0],m=(K,W)=>[0,W];break;case"middleRight":w=!0,g=(K,W)=>[K,W/2],m=(K,W)=>[0,W/2];break;case"bottomRight":y=!0,g=(K,W)=>[K,W],m=(K,W)=>[0,0];break;case"bottomMiddle":g=(K,W)=>[K/2,W],m=(K,W)=>[K/2,0];break;case"bottomLeft":y=!0,g=(K,W)=>[0,W],m=(K,W)=>[K,0];break;case"middleLeft":w=!0,g=(K,W)=>[0,W/2],m=(K,W)=>[K,W/2];break}let A=g(a,l),C=m(a,l),E=f(...C),T=u(s+E[0]),L=u(o+E[1]),S=1,_=1,[P,U]=this.screenToPageTranslation(t.movementX,t.movementY);if([P,U]=v(P/n,U/r),y){let K=Math.hypot(a,l);S=_=Math.max(Math.min(Math.hypot(C[0]-A[0]-P,C[1]-A[1]-U)/K,1/a,1/l),c/a,d/l)}else w?S=Math.max(c,Math.min(1,Math.abs(C[0]-A[0]-P)))/a:_=Math.max(d,Math.min(1,Math.abs(C[1]-A[1]-U)))/l;let O=u(a*S),z=u(l*_);E=f(...m(O,z));let q=T-E[0],Q=L-E[1];this.width=O,this.height=z,this.x=q,this.y=Q,this.setDims(n*O,r*z),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}addEditToolbar(){return ce(this,null,function*(){return this._editToolbar||this.#h?this._editToolbar:(this._editToolbar=new PS(this),this.div.append(this._editToolbar.render()),this.#n&&(yield this._editToolbar.addAltText(this.#n)),this._editToolbar)})}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return ce(this,null,function*(){this.#n||(Lk.initialize(i._l10nPromise),this.#n=new Lk(this),this.#e&&(this.#n.data=this.#e,this.#e=null),yield this.addEditToolbar())})}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}setGuessedAltText(e){return ce(this,null,function*(){yield this.#n?.setGuessedText(e)})}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#k();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[n,r]=this.getInitialTranslation();return this.translate(n,r),lv(this,this.div,["pointerdown"]),this.div}pointerdown(e){let{isMac:t}=Di.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#c=!0,this._isDraggable){this.#P(e);return}this.#C(e)}#C(e){let{isMac:t}=Di.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(e){let t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let n=new AbortController,r=this._uiManager.combinedSignal(n);if(t){this.div.classList.add("moving"),this.#m=e.clientX,this.#v=e.clientY;let o=a=>{let{clientX:l,clientY:c}=a,[d,u]=this.screenToPageTranslation(l-this.#m,c-this.#v);this.#m=l,this.#v=c,this._uiManager.dragSelectedEditors(d,u)};window.addEventListener("pointermove",o,{passive:!0,capture:!0,signal:r})}let s=()=>{n.abort(),t&&this.div.classList.remove("moving"),this.#c=!1,this._uiManager.endDragSession()||this.#C(e)};window.addEventListener("pointerup",s,{signal:r}),window.addEventListener("blur",s,{signal:r})}moveInDOM(){this.#f&&clearTimeout(this.#f),this.#f=setTimeout(()=>{this.#f=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t,n=this.rotation){let r=this.parentScale,[s,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/r,d=t/r,u=this.x*s,h=this.y*o,f=this.width*s,p=this.height*o;switch(n){case 0:return[u+c+a,o-h-d-p+l,u+c+f+a,o-h-d+l];case 90:return[u+d+a,o-h+c+l,u+d+p+a,o-h+c+f+l];case 180:return[u-c-f+a,o-h+d+l,u-c+a,o-h+d+p+l];case 270:return[u-d-p+a,o-h-c-f+l,u-d+a,o-h-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[n,r,s,o]=e,a=s-n,l=o-r;switch(this.rotation){case 0:return[n,t-o,a,l];case 90:return[n,t-r,l,a];case 180:return[s,t-r,a,l];case 270:return[s,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#k(){if(this.#l||!this.div)return;this.#l=new AbortController;let e=this._uiManager.combinedSignal(this.#l);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#k()}rotate(e){}serialize(e=!1,t=null){Xn("An editor must be serializable")}static deserialize(e,t,n){let r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation,r.#e=e.accessibilityData;let[s,o]=r.pageDimensions,[a,l,c,d]=r.getRectInCurrentCoords(e.rect,o);return r.x=a/s,r.y=l/o,r.width=c/s,r.height=d/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#l?.abort(),this.#l=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#f&&(clearTimeout(this.#f),this.#f=null),this.#F(),this.removeEditToolbar(),this.#g){for(let e of this.#g.values())clearTimeout(e);this.#g=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#D(),this.#s.classList.remove("hidden"),lv(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#a={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#s.children;if(!this.#t){this.#t=Array.from(t);let o=this.#E.bind(this),a=this.#w.bind(this),l=this._uiManager._signal;for(let c of this.#t){let d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",this.#I.bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",i._l10nResizer[d])}}let n=this.#t[0],r=0;for(let o of t){if(o===n)break;r++}let s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==r){if(s<r)for(let a=0;a<r-s;a++)this.#s.append(this.#s.firstChild);else if(s>r)for(let a=0;a<s-r;a++)this.#s.firstChild.before(this.#s.lastChild);let o=0;for(let a of t){let c=this.#t[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",i._l10nResizer[c])}}this.#R(0),this.#p=!0,this.#s.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#E(e){i._resizerKeyboardManager.exec(this,e)}#w(e){this.#p&&e.relatedTarget?.parentNode!==this.#s&&this.#F()}#I(e){this.#u=this.#p?e:""}#R(e){if(this.#t)for(let t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#T(this.#u,{movementX:e,movementY:t})}#F(){if(this.#p=!1,this.#R(-1),this.#a){let{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=this.#a;this.#_(e,t,n,r),this.#a=null}}_stopResizingWithKeyboard(){this.#F(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#o}set isEditing(e){this.#o=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#r=!0;let n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#g||=new Map;let{action:n}=e,r=this.#g.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#g.delete(n),this.#g.size===0&&(this.#g=null)},i._telemetryTimeout),this.#g.set(n,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},OS=class extends nn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}},kk=3285377520,jr=4294901760,js=65535,cv=class{constructor(e){this.h1=e?e&4294967295:kk,this.h2=e?e&4294967295:kk}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let v=0,g=e.length;v<g;v++){let m=e.charCodeAt(v);m<=255?t[n++]=m:(t[n++]=m>>>8,t[n++]=m&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let r=n>>2,s=n-r*4,o=new Uint32Array(t.buffer,0,r),a=0,l=0,c=this.h1,d=this.h2,u=3432918353,h=461845907,f=u&js,p=h&js;for(let v=0;v<r;v++)v&1?(a=o[v],a=a*u&jr|a*f&js,a=a<<15|a>>>17,a=a*h&jr|a*p&js,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[v],l=l*u&jr|l*f&js,l=l<<15|l>>>17,l=l*h&jr|l*p&js,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,s){case 3:a^=t[r*4+2]<<16;case 2:a^=t[r*4+1]<<8;case 1:a^=t[r*4],a=a*u&jr|a*f&js,a=a<<15|a>>>17,a=a*h&jr|a*p&js,r&1?c^=a:d^=a}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&jr|e*36045&js,t=t*4283543511&jr|((t<<16|e>>>16)*2950163797&jr)>>>16,e^=t>>>1,e=e*444984403&jr|e*60499&js,t=t*3301882366&jr|((t<<16|e>>>16)*3120437893&jr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},BS=Object.freeze({map:null,hash:"",transfer:void 0}),ff=class{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#n.values())if(t instanceof nn)return;this.onAnnotationEditor(null)}}setValue(e,t){let n=this.#n.get(e),r=!1;if(n!==void 0)for(let[s,o]of Object.entries(t))n[s]!==o&&(r=!0,n[s]=o);else r=!0,this.#n.set(e,t);r&&this.#i(),t instanceof nn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?GE(this.#n):null}setAll(e){for(let[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new dv(this)}get serializable(){if(this.#n.size===0)return BS;let e=new Map,t=new cv,n=[],r=Object.create(null),s=!1;for(let[o,a]of this.#n){let l=a instanceof nn?a.serialize(!1,r):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(let o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:BS}get editorStats(){let e=null,t=new Map;for(let n of this.#n.values()){if(!(n instanceof nn))continue;let r=n.telemetryFinalData;if(!r)continue;let{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(n).constructor),e||=Object.create(null);let o=e[s]||=new Map;for(let[a,l]of Object.entries(r)){if(a==="type")continue;let c=o.get(a);c||(c=new Map,o.set(a,c));let d=c.get(l)??0;c.set(l,d+1)}}for(let[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;let e=[];for(let t of this.#n.values())!(t instanceof nn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}},dv=class extends ff{#e;constructor(e){super();let{map:t,hash:n,transfer:r}=e.serializable,s=structuredClone(t,r?{transfer:r}:null);this.#e={map:s,hash:n,transfer:r}}get print(){Xn("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return qt(this,"modifiedIds",{ids:new Set,hash:""})}},VS=class{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(n){return ce(this,arguments,function*({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(ii(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:r,src:s,style:o}=e,a=new FontFace(r,s,o);this.addNativeFontFace(a);try{yield a.load(),this.#e.add(r),t?.(e)}catch{Ft(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Xn("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(e){return ce(this,null,function*(){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){yield this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{yield n.loaded}catch(r){throw Ft(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;yield new Promise(n=>{let r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}})}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return qt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Ii||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),qt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(ii(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){let s=n.shift();setTimeout(s.callback,0)}}let{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return qt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(A,C){return A.charCodeAt(C)<<24|A.charCodeAt(C+1)<<16|A.charCodeAt(C+2)<<8|A.charCodeAt(C+3)&255}function r(A,C,E,T){let L=A.substring(0,C),S=A.substring(C+E);return L+T+S}let s,o,a=this._document.createElement("canvas");a.width=1,a.height=1;let l=a.getContext("2d"),c=0;function d(A,C){if(++c>30){Ft("Load test font never loaded."),C();return}if(l.font="30px "+A,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(d.bind(null,A,C))}let u=`lt${Date.now()}${this.loadTestFontId++}`,h=this._loadTestFont;h=r(h,976,u.length,u);let p=16,v=1482184792,g=n(h,p);for(s=0,o=u.length-3;s<o;s+=4)g=g-v+n(u,s)|0;s<u.length&&(g=g-v+n(u+"XXX",s)|0),h=r(h,p,4,kX(g));let m=`url(data:font/opentype;base64,${btoa(h)});`,y=`@font-face {font-family:"${u}";src:${m}}`;this.insertRule(y);let w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(let A of[e.loadedName,u]){let C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=A,w.append(C)}this._document.body.append(w),d(u,()=>{w.remove(),t.complete()})}},US=class{constructor(e,{disableFontFace:t=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(let r in e)this[r]=e[r];this.disableFontFace=t===!0,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=Zk(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`,n;if(!this.cssFontInfo)n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${t}}`}return this._inspectFont?.(this,t),n}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(s){Ft(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[t]=function(s,o){};let r=[];for(let s=0,o=n.length;s<o;)switch(n[s++]){case Fo.BEZIER_CURVE_TO:{let[a,l,c,d,u,h]=n.slice(s,s+6);r.push(f=>f.bezierCurveTo(a,l,c,d,u,h)),s+=6}break;case Fo.MOVE_TO:{let[a,l]=n.slice(s,s+2);r.push(c=>c.moveTo(a,l)),s+=2}break;case Fo.LINE_TO:{let[a,l]=n.slice(s,s+2);r.push(c=>c.lineTo(a,l)),s+=2}break;case Fo.QUADRATIC_CURVE_TO:{let[a,l,c,d]=n.slice(s,s+4);r.push(u=>u.quadraticCurveTo(a,l,c,d)),s+=4}break;case Fo.RESTORE:r.push(a=>a.restore());break;case Fo.SAVE:r.push(a=>a.save());break;case Fo.SCALE:ii(r.length===2,"Scale command is only valid at the third position.");break;case Fo.TRANSFORM:{let[a,l,c,d,u,h]=n.slice(s,s+6);r.push(f=>f.transform(a,l,c,d,u,h)),s+=6}break;case Fo.TRANSLATE:{let[a,l]=n.slice(s,s+2);r.push(c=>c.translate(a,l)),s+=2}break}return this.compiledGlyphs[t]=function(o,a){r[0](o),r[1](o),o.scale(a,-a);for(let l=2,c=r.length;l<c;l++)r[l](o)}}};Ii&&(K0=Promise.withResolvers(),J0=null,ce(void 0,null,function*(){let e=yield import("./chunk-L2HEV66R.js"),t=yield import("./chunk-BMBYILCS.js"),n=yield import("./chunk-ALIQTIYY.js"),r=yield import("./chunk-NYZOWURK.js"),s,o;return new Map(Object.entries({fs:e,http:t,https:n,url:r,canvas:s,path2d:o}))}).then(e=>{J0=e,K0.resolve()},e=>{Ft(`loadPackages: ${e}`),J0=new Map,K0.resolve()}));var K0,J0,Gs=class{static get promise(){return K0.promise}static get(e){return J0?.get(e)}},Yk=function(i){return Gs.get("fs").promises.readFile(i).then(t=>new Uint8Array(t))},HS=class extends ev{},zS=class extends tv{_createCanvas(e,t){return Gs.get("canvas").createCanvas(e,t)}},jS=class extends nv{_fetchData(e,t){return Yk(e).then(n=>({cMapData:n,compressionType:t}))}},GS=class extends iv{_fetchData(e){return Yk(e)}},Ui={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function WS(i,e){if(!e)return;let t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),i.clip(r)}var pf=class{getPattern(){Xn("Abstract method `getPattern` called.")}},qS=class extends pf{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,r){let s;if(r===Ui.STROKE||r===Ui.FILL){let o=t.current.getClippedPathBoundingBox(r,Tn(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l,!0),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),n=qe.transform(n,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),WS(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=e.createPattern(c.canvas,"no-repeat");let u=new DOMMatrix(n);s.setTransform(u)}else WS(e,this._bbox),s=this._createGradient(e);return s}};function AS(i,e,t,n,r,s,o,a){let l=e.coords,c=e.colors,d=i.data,u=i.width*4,h;l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=s,s=o,o=h),l[n+1]>l[r+1]&&(h=n,n=r,r=h,h=o,o=a,a=h),l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=s,s=o,o=h);let f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,v=(l[n]+e.offsetX)*e.scaleX,g=(l[n+1]+e.offsetY)*e.scaleY,m=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY;if(p>=y)return;let w=c[s],A=c[s+1],C=c[s+2],E=c[o],T=c[o+1],L=c[o+2],S=c[a],_=c[a+1],P=c[a+2],U=Math.round(p),O=Math.round(y),z,q,Q,K,W,Ee,Te,ke;for(let We=U;We<=O;We++){if(We<g){let pe=We<p?0:(p-We)/(p-g);z=f-(f-v)*pe,q=w-(w-E)*pe,Q=A-(A-T)*pe,K=C-(C-L)*pe}else{let pe;We>y?pe=1:g===y?pe=0:pe=(g-We)/(g-y),z=v-(v-m)*pe,q=E-(E-S)*pe,Q=T-(T-_)*pe,K=L-(L-P)*pe}let at;We<p?at=0:We>y?at=1:at=(p-We)/(p-y),W=f-(f-m)*at,Ee=w-(w-S)*at,Te=A-(A-_)*at,ke=C-(C-P)*at;let se=Math.round(Math.min(z,W)),xe=Math.round(Math.max(z,W)),Ne=u*We+se*4;for(let pe=se;pe<=xe;pe++)at=(z-pe)/(z-W),at<0?at=0:at>1&&(at=1),d[Ne++]=q-(q-Ee)*at|0,d[Ne++]=Q-(Q-Te)*at|0,d[Ne++]=K-(K-ke)*at|0,d[Ne++]=255}}function WX(i,e,t){let n=e.coords,r=e.colors,s,o;switch(e.type){case"lattice":let a=e.verticesPerRow,l=Math.floor(n.length/a)-1,c=a-1;for(s=0;s<l;s++){let d=s*a;for(let u=0;u<c;u++,d++)AS(i,t,n[d],n[d+1],n[d+a],r[d],r[d+1],r[d+a]),AS(i,t,n[d+a+1],n[d+1],n[d+a],r[d+a+1],r[d+1],r[d+a])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)AS(i,t,n[s],n[s+1],n[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}var ZS=class extends pf{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){let a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),f=c/u,p=d/h,v={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/f,scaleY:1/p},g=u+2*2,m=h+2*2,y=n.getCanvas("mesh",g,m,!1),w=y.context,A=w.createImageData(u,h);if(t){let E=A.data;for(let T=0,L=E.length;T<L;T+=4)E[T]=t[0],E[T+1]=t[1],E[T+2]=t[2],E[T+3]=255}for(let E of this._figures)WX(A,E,v);return w.putImageData(A,2,2),{canvas:y.canvas,offsetX:a-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}getPattern(e,t,n,r){WS(e,this._bbox);let s;if(r===Ui.SHADING)s=qe.singularValueDecompose2dScale(Tn(e));else if(s=qe.singularValueDecompose2dScale(t.baseTransform),this.matrix){let a=qe.singularValueDecompose2dScale(this.matrix);s=[s[0]*a[0],s[1]*a[1]]}let o=this._createMeshCanvas(s,r===Ui.SHADING?null:this._background,t.cachedCanvases);return r!==Ui.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}},XS=class extends pf{getPattern(){return"hotpink"}};function qX(i){switch(i[0]){case"RadialAxial":return new qS(i);case"Mesh":return new ZS(i);case"Dummy":return new XS}throw new Error(`Unknown IR type: ${i[0]}`)}var Nk={COLORED:1,UNCOLORED:2},ZX=(()=>{class i{static MAX_PATTERN_SIZE=3e3;constructor(t,n,r,s,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=n,this.ctx=r,this.canvasGraphicsFactory=s,this.baseTransform=o}createPatternCanvas(t){let n=this.operatorList,r=this.bbox,s=this.xstep,o=this.ystep,a=this.paintType,l=this.tilingType,c=this.color,d=this.canvasGraphicsFactory;Rv("TilingType: "+l);let u=r[0],h=r[1],f=r[2],p=r[3],v=qe.singularValueDecompose2dScale(this.matrix),g=qe.singularValueDecompose2dScale(this.baseTransform),m=[v[0]*g[0],v[1]*g[1]],y=this.getSizeAndScale(s,this.ctx.canvas.width,m[0]),w=this.getSizeAndScale(o,this.ctx.canvas.height,m[1]),A=t.cachedCanvases.getCanvas("pattern",y.size,w.size,!0),C=A.context,E=d.createCanvasGraphics(C);E.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(E,a,c);let T=u,L=h,S=f,_=p;return u<0&&(T=0,S+=Math.abs(u)),h<0&&(L=0,_+=Math.abs(h)),C.translate(-(y.scale*T),-(w.scale*L)),E.transform(y.scale,0,0,w.scale,0,0),C.save(),this.clipBbox(E,T,L,S,_),E.baseTransform=Tn(E.ctx),E.executeOperatorList(n),E.endDrawing(),{canvas:A.canvas,scaleX:y.scale,scaleY:w.scale,offsetX:T,offsetY:L}}getSizeAndScale(t,n,r){t=Math.abs(t);let s=Math.max(i.MAX_PATTERN_SIZE,n),o=Math.ceil(t*r);return o>=s?o=s:r=o/t,{scale:r,size:o}}clipBbox(t,n,r,s,o){let a=s-n,l=o-r;t.ctx.rect(n,r,a,l),t.current.updateRectMinMax(Tn(t.ctx),[n,r,s,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,n,r){let s=t.ctx,o=t.current;switch(n){case Nk.COLORED:let a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,o.fillColor=a.fillStyle,o.strokeColor=a.strokeStyle;break;case Nk.UNCOLORED:let l=qe.makeHexColor(r[0],r[1],r[2]);s.fillStyle=l,s.strokeStyle=l,o.fillColor=l,o.strokeColor=l;break;default:throw new MS(`Unsupported paint type: ${n}`)}}getPattern(t,n,r,s){let o=r;s!==Ui.SHADING&&(o=qe.transform(o,n.baseTransform),this.matrix&&(o=qe.transform(o,this.matrix)));let a=this.createPatternCanvas(n),l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);let c=t.createPattern(a.canvas,"repeat");return c.setTransform(l),c}}return i})();function XX({src:i,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:s=4294967295,inverseDecode:o=!1}){let a=Di.isLittleEndian?4278190080:255,[l,c]=o?[s,a]:[a,s],d=n>>3,u=n&7,h=i.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<r;p++){for(let g=e+d;e<g;e++){let m=e<h?i[e]:255;t[f++]=m&128?c:l,t[f++]=m&64?c:l,t[f++]=m&32?c:l,t[f++]=m&16?c:l,t[f++]=m&8?c:l,t[f++]=m&4?c:l,t[f++]=m&2?c:l,t[f++]=m&1?c:l}if(u===0)continue;let v=e<h?i[e++]:255;for(let g=0;g<u;g++)t[f++]=v&1<<7-g?c:l}return{srcPos:e,destPos:f}}var Fk=16,Ok=100,YX=15,Bk=10,Vk=1e3,nr=16;function QX(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(n,r){e.translate(n,r),this.__originalTranslate(n,r)},i.scale=function(n,r){e.scale(n,r),this.__originalScale(n,r)},i.transform=function(n,r,s,o,a,l){e.transform(n,r,s,o,a,l),this.__originalTransform(n,r,s,o,a,l)},i.setTransform=function(n,r,s,o,a,l){e.setTransform(n,r,s,o,a,l),this.__originalSetTransform(n,r,s,o,a,l)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(n){e.rotate(n),this.__originalRotate(n)},i.clip=function(n){e.clip(n),this.__originalClip(n)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,r,s,o,a){e.bezierCurveTo(t,n,r,s,o,a),this.__originalBezierCurveTo(t,n,r,s,o,a)},i.rect=function(t,n,r,s){e.rect(t,n,r,s),this.__originalRect(t,n,r,s)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var YS=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function G0(i,e,t,n,r,s,o,a,l,c){let[d,u,h,f,p,v]=Tn(i);if(u===0&&h===0){let y=o*d+p,w=Math.round(y),A=a*f+v,C=Math.round(A),E=(o+l)*d+p,T=Math.abs(Math.round(E)-w)||1,L=(a+c)*f+v,S=Math.abs(Math.round(L)-C)||1;return i.setTransform(Math.sign(d),0,0,Math.sign(f),w,C),i.drawImage(e,t,n,r,s,0,0,T,S),i.setTransform(d,u,h,f,p,v),[T,S]}if(d===0&&f===0){let y=a*h+p,w=Math.round(y),A=o*u+v,C=Math.round(A),E=(a+c)*h+p,T=Math.abs(Math.round(E)-w)||1,L=(o+l)*u+v,S=Math.abs(Math.round(L)-C)||1;return i.setTransform(0,Math.sign(u),Math.sign(h),0,w,C),i.drawImage(e,t,n,r,s,0,0,S,T),i.setTransform(d,u,h,f,p,v),[S,T]}i.drawImage(e,t,n,r,s,o,a,l,c);let g=Math.hypot(d,u),m=Math.hypot(h,f);return[g*l,m*c]}function KX(i){let{width:e,height:t}=i;if(e>Vk||t>Vk)return null;let n=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1,o=new Uint8Array(s*(t+1)),a,l,c,d=e+7&-8,u=new Uint8Array(d*t),h=0;for(let m of i.data){let y=128;for(;y>0;)u[h++]=m&y?0:255,y>>=1}let f=0;for(h=0,u[h]!==0&&(o[0]=1,++f),l=1;l<e;l++)u[h]!==u[h+1]&&(o[l]=u[h]?2:1,++f),h++;for(u[h]!==0&&(o[l]=2,++f),a=1;a<t;a++){h=a*d,c=a*s,u[h-d]!==u[h]&&(o[c]=u[h]?1:8,++f);let m=(u[h]?4:0)+(u[h-d]?8:0);for(l=1;l<e;l++)m=(m>>2)+(u[h+1]?4:0)+(u[h-d+1]?8:0),r[m]&&(o[c+l]=r[m],++f),h++;if(u[h-d]!==u[h]&&(o[c+l]=u[h]?2:4,++f),f>n)return null}for(h=d*(t-1),c=a*s,u[h]!==0&&(o[c]=8,++f),l=1;l<e;l++)u[h]!==u[h+1]&&(o[c+l]=u[h]?4:8,++f),h++;if(u[h]!==0&&(o[c+l]=4,++f),f>n)return null;let p=new Int32Array([0,s,-1,0,-s,0,0,0,1]),v=new Path2D;for(a=0;f&&a<=t;a++){let m=a*s,y=m+e;for(;m<y&&!o[m];)m++;if(m===y)continue;v.moveTo(m%s,a);let w=m,A=o[m];do{let C=p[A];do m+=C;while(!o[m]);let E=o[m];E!==5&&E!==10?(A=E,o[m]=0):(A=E&51*A>>4,o[m]&=A>>2|A<<2),v.lineTo(m%s,m/s|0),o[m]||--f}while(w!==m);--a}return u=null,o=null,function(m){m.save(),m.scale(1/e,-1/t),m.translate(0,-t),m.fill(v),m.beginPath(),m.restore()}}var uv=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=qk,this.textMatrixScale=1,this.fontMatrix=ES,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ti.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=qe.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){let n=qe.applyTransform(t,e),r=qe.applyTransform(t.slice(2),e),s=qe.applyTransform([t[0],t[3]],e),o=qe.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],r[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],r[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],r[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],r[1],s[1],o[1])}updateScalingPathMinMax(e,t){qe.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,r,s,o,a,l,c,d){let u=qe.bezierBoundingBox(t,n,r,s,o,a,l,c,d);d||this.updateRectMinMax(e,u)}getPathBoundingBox(e=Ui.FILL,t=null){let n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ui.STROKE){t||Xn("Stroke bounding box must include transform.");let r=qe.singularValueDecompose2dScale(t),s=r[0]*this.lineWidth/2,o=r[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){let e=qe.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ui.FILL,t=null){return qe.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function Uk(i,e){if(typeof ImageData<"u"&&e instanceof ImageData){i.putImageData(e,0,0);return}let t=e.height,n=e.width,r=t%nr,s=(t-r)/nr,o=r===0?s:s+1,a=i.createImageData(n,nr),l=0,c,d=e.data,u=a.data,h,f,p,v;if(e.kind===Q0.GRAYSCALE_1BPP){let g=d.byteLength,m=new Uint32Array(u.buffer,0,u.byteLength>>2),y=m.length,w=n+7>>3,A=4294967295,C=Di.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(p=h<s?nr:r,c=0,f=0;f<p;f++){let E=g-l,T=0,L=E>w?n:E*8-7,S=L&-8,_=0,P=0;for(;T<S;T+=8)P=d[l++],m[c++]=P&128?A:C,m[c++]=P&64?A:C,m[c++]=P&32?A:C,m[c++]=P&16?A:C,m[c++]=P&8?A:C,m[c++]=P&4?A:C,m[c++]=P&2?A:C,m[c++]=P&1?A:C;for(;T<L;T++)_===0&&(P=d[l++],_=128),m[c++]=P&_?A:C,_>>=1}for(;c<y;)m[c++]=0;i.putImageData(a,0,h*nr)}}else if(e.kind===Q0.RGBA_32BPP){for(f=0,v=n*nr*4,h=0;h<s;h++)u.set(d.subarray(l,l+v)),l+=v,i.putImageData(a,0,f),f+=nr;h<o&&(v=n*r*4,u.set(d.subarray(l,l+v)),i.putImageData(a,0,f))}else if(e.kind===Q0.RGB_24BPP)for(p=nr,v=n*p,h=0;h<o;h++){for(h>=s&&(p=r,v=n*p),c=0,f=v;f--;)u[c++]=d[l++],u[c++]=d[l++],u[c++]=d[l++],u[c++]=255;i.putImageData(a,0,h*nr)}else throw new Error(`bad image kind: ${e.kind}`)}function Hk(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}let t=e.height,n=e.width,r=t%nr,s=(t-r)/nr,o=r===0?s:s+1,a=i.createImageData(n,nr),l=0,c=e.data,d=a.data;for(let u=0;u<o;u++){let h=u<s?nr:r;({srcPos:l}=XX({src:c,srcPos:l,dest:d,width:n,height:h,nonBlackColor:0})),i.putImageData(a,0,u*nr)}}function nf(i,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function W0(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!Ii){let{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}}function zk(i,e){if(e)return!0;let t=qe.singularValueDecompose2dScale(i);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let n=Math.fround((globalThis.devicePixelRatio||1)*Wa.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}var JX=["butt","round","square"],$X=["miter","round","bevel"],eY={},jk={},Gd=class i{constructor(e,t,n,r,s,{optionalContentConfig:o,markedContentStack:a=null},l,c){this.ctx=e,this.current=new uv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new YS(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){let s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,n){let l=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Tn(this.compositeCtx))}this.ctx.save(),W0(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Tn(this.ctx)}executeOperatorList(e,t,n,r){let s=e.argsArray,o=e.fnArray,a=t||0,l=s.length;if(l===a)return a;let c=l-a>Bk&&typeof n=="function",d=c?Date.now()+YX:0,u=0,h=this.commonObjs,f=this.objs,p;for(;;){if(r!==void 0&&a===r.nextBreakPoint)return r.breakIt(a,n),a;if(p=o[a],p!==vs.dependency)this[p].apply(this,s[a]);else for(let v of s[a]){let g=v.startsWith("g_")?h:f;if(!g.has(v))return g.get(v,n),a}if(a++,a===l)return a;if(c&&++u>Bk){if(Date.now()>d)return n(),a;u=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let n=e.width,r=e.height,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=n,l=r,c="prescale1",d,u;for(;s>2&&a>1||o>2&&l>1;){let h=a,f=l;s>2&&a>1&&(h=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/h),o>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/f),d=this.cachedCanvases.getCanvas(c,h,f),u=d.context,u.clearRect(0,0,h,f),u.drawImage(e,0,0,a,l,0,0,h,f),e=d.canvas,a=h,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){let t=this.ctx,{width:n,height:r}=e,s=this.current.fillColor,o=this.current.patternFill,a=Tn(t),l,c,d,u;if((e.bitmap||e.data)&&e.count>1){let L=e.bitmap||e.data.buffer;c=JSON.stringify(o?a:[a.slice(0,4),s]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));let S=l.get(c);if(S&&!o){let _=Math.round(Math.min(a[0],a[2])+a[4]),P=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:S,offsetX:_,offsetY:P}}d=S}d||(u=this.cachedCanvases.getCanvas("maskCanvas",n,r),Hk(u.context,e));let h=qe.transform(a,[1/n,0,0,-1/r,0,0]);h=qe.transform(h,[1,0,0,1,0,-r]);let[f,p,v,g]=qe.getAxialAlignedBoundingBox([0,0,n,r],h),m=Math.round(v-f)||1,y=Math.round(g-p)||1,w=this.cachedCanvases.getCanvas("fillCanvas",m,y),A=w.context,C=f,E=p;A.translate(-C,-E),A.transform(...h),d||(d=this._scaleImage(u.canvas,Oo(A)),d=d.img,l&&o&&l.set(c,d)),A.imageSmoothingEnabled=zk(Tn(A),e.interpolate),G0(A,d,0,0,d.width,d.height,0,0,n,r),A.globalCompositeOperation="source-in";let T=qe.transform(Oo(A),[1,0,0,1,-C,-E]);return A.fillStyle=o?s.getPattern(t,this,T,Ui.FILL):s,A.fillRect(0,0,n,r),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,w.canvas)),{canvas:w.canvas,offsetX:Math.round(C),offsetY:Math.round(E)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=JX[e]}setLineJoin(e){this.ctx.lineJoin=$X[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;let s=this.ctx;s.setTransform(...Tn(this.suspendedCtx)),nf(this.suspendedCtx,s),QX(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),nf(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){let s=r[0],o=r[1],a=r[2]-s,l=r[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,n,a,l,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,s,o,a,l,c,d,u){let h=e.canvas,f=l-d,p=c-u;if(o){if(f<0||p<0||f+n>h.width||p+r>h.height){let g=this.cachedCanvases.getCanvas("maskExtension",n,r),m=g.context;m.drawImage(h,-f,-p),o.some(y=>y!==0)&&(m.globalCompositeOperation="destination-atop",m.fillStyle=qe.makeHexColor(...o),m.fillRect(0,0,n,r),m.globalCompositeOperation="source-over"),h=g.canvas,f=p=0}else if(o.some(g=>g!==0)){e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let g=new Path2D;g.rect(f,p,n,r),e.clip(g),e.globalCompositeOperation="destination-atop",e.fillStyle=qe.makeHexColor(...o),e.fillRect(f,p,n,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));let v=new Path2D;v.rect(l,c,n,r),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(h,f,p,n,r,l,c,n,r),t.restore()}save(){this.inSMaskMode?(nf(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),nf(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,s,o){this.ctx.transform(e,t,n,r,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let r=this.ctx,s=this.current,o=s.x,a=s.y,l,c,d=Tn(r),u=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,h=u?n.slice(0):null;for(let f=0,p=0,v=e.length;f<v;f++)switch(e[f]|0){case vs.rectangle:o=t[p++],a=t[p++];let g=t[p++],m=t[p++],y=o+g,w=a+m;r.moveTo(o,a),g===0||m===0?r.lineTo(y,w):(r.lineTo(y,a),r.lineTo(y,w),r.lineTo(o,w)),u||s.updateRectMinMax(d,[o,a,y,w]),r.closePath();break;case vs.moveTo:o=t[p++],a=t[p++],r.moveTo(o,a),u||s.updatePathMinMax(d,o,a);break;case vs.lineTo:o=t[p++],a=t[p++],r.lineTo(o,a),u||s.updatePathMinMax(d,o,a);break;case vs.curveTo:l=o,c=a,o=t[p+4],a=t[p+5],r.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],o,a),s.updateCurvePathMinMax(d,l,c,t[p],t[p+1],t[p+2],t[p+3],o,a,h),p+=6;break;case vs.curveTo2:l=o,c=a,r.bezierCurveTo(o,a,t[p],t[p+1],t[p+2],t[p+3]),s.updateCurvePathMinMax(d,l,c,o,a,t[p],t[p+1],t[p+2],t[p+3],h),o=t[p+2],a=t[p+3],p+=4;break;case vs.curveTo3:l=o,c=a,o=t[p+2],a=t[p+3],r.bezierCurveTo(t[p],t[p+1],o,a,o,a),s.updateCurvePathMinMax(d,l,c,t[p],t[p+1],o,a,o,a,h),p+=4;break;case vs.closePath:r.closePath();break}u&&s.updateScalingPathMinMax(d,h),s.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,Oo(t),Ui.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,n=this.current.fillColor,r=this.current.patternFill,s=!1;r&&(t.save(),t.fillStyle=n.getPattern(t,this,Oo(t),Ui.FILL),s=!0);let o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=eY}eoClip(){this.pendingClip=jk}beginText(){this.current.textMatrix=qk,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(let n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||ES,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ft("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;let s=n.loadedName||"sans-serif",o=n.systemFontInfo?.css||`"${s}", ${n.fallbackName}`,a="normal";n.black?a="900":n.bold&&(a="bold");let l=n.italic?"italic":"normal",c=t;t<Fk?c=Fk:t>Ok&&(c=Ok),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${a} ${c}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,s,o){this.current.textMatrix=[e,t,n,r,s,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,r){let s=this.ctx,o=this.current,a=o.font,l=o.textRenderingMode,c=o.fontSize/o.fontSizeScale,d=l&Ti.FILL_STROKE_MASK,u=!!(l&Ti.ADD_TO_PATH_FLAG),h=o.patternFill&&!a.missingFile,f;(a.disableFontFace||u||h)&&(f=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||h?(s.save(),s.translate(t,n),s.beginPath(),f(s,c),r&&s.setTransform(...r),(d===Ti.FILL||d===Ti.FILL_STROKE)&&s.fill(),(d===Ti.STROKE||d===Ti.FILL_STROKE)&&s.stroke(),s.restore()):((d===Ti.FILL||d===Ti.FILL_STROKE)&&s.fillText(e,t,n),(d===Ti.STROKE||d===Ti.FILL_STROKE)&&s.strokeText(e,t,n)),u&&(this.pendingTextPaths||=[]).push({transform:Tn(s),x:t,y:n,fontSize:c,addToPath:f})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return qt(this,"isFontSubpixelAAEnabled",n)}showText(e){let t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);let r=t.fontSize;if(r===0)return;let s=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,d=t.textHScale*c,u=e.length,h=n.vertical,f=h?1:-1,p=n.defaultVMetrics,v=r*t.fontMatrix[0],g=t.textRenderingMode===Ti.FILL&&!n.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),c>0?s.scale(d,-1):s.scale(d,1);let m;if(t.patternFill){s.save();let E=t.fillColor.getPattern(s,this,Oo(s),Ui.FILL);m=Tn(s),s.restore(),s.fillStyle=E}let y=t.lineWidth,w=t.textMatrixScale;if(w===0||y===0){let E=t.textRenderingMode&Ti.FILL_STROKE_MASK;(E===Ti.STROKE||E===Ti.FILL_STROKE)&&(y=this.getSinglePixelWidth())}else y/=w;if(o!==1&&(s.scale(o,o),y/=o),s.lineWidth=y,n.isInvalidPDFjsFont){let E=[],T=0;for(let L of e)E.push(L.unicode),T+=L.width;s.fillText(E.join(""),0,0),t.x+=T*v*d,s.restore(),this.compose();return}let A=0,C;for(C=0;C<u;++C){let E=e[C];if(typeof E=="number"){A+=f*E*r/1e3;continue}let T=!1,L=(E.isSpace?l:0)+a,S=E.fontChar,_=E.accent,P,U,O=E.width;if(h){let q=E.vmetric||p,Q=-(E.vmetric?q[1]:O*.5)*v,K=q[2]*v;O=q?-q[0]:O,P=Q/o,U=(A+K)/o}else P=A/o,U=0;if(n.remeasure&&O>0){let q=s.measureText(S).width*1e3/r*o;if(O<q&&this.isFontSubpixelAAEnabled){let Q=O/q;T=!0,s.save(),s.scale(Q,1),P/=Q}else O!==q&&(P+=(O-q)/2e3*r/o)}if(this.contentVisible&&(E.isInFont||n.missingFile)){if(g&&!_)s.fillText(S,P,U);else if(this.paintChar(S,P,U,m),_){let q=P+r*_.offset.x/o,Q=U-r*_.offset.y/o;this.paintChar(_.fontChar,q,Q,m)}}let z=h?O*v-L*c:O*v+L*c;A+=z,T&&s.restore()}h?t.y-=A:t.x+=A*d,s.restore(),this.compose()}showType3Text(e){let t=this.ctx,n=this.current,r=n.font,s=n.fontSize,o=n.fontDirection,a=r.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,d=n.textHScale*o,u=n.fontMatrix||ES,h=e.length,f=n.textRenderingMode===Ti.INVISIBLE,p,v,g,m;if(!(f||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(d,o),p=0;p<h;++p){if(v=e[p],typeof v=="number"){m=a*v*s/1e3,this.ctx.translate(m,0),n.x+=m*d;continue}let y=(v.isSpace?c:0)+l,w=r.charProcOperatorList[v.operatorListId];if(!w){Ft(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),t.scale(s,s),t.transform(...u),this.executeOperatorList(w),this.restore()),g=qe.applyTransform([v.width,0],u)[0]*s+y,t.translate(g,0),n.x+=g*d}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,s,o){this.ctx.rect(n,r,s-n,o-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let n=e[1],r=this.baseTransform||Tn(this.ctx),s={createCanvasGraphics:o=>new i(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ZX(e,n,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=qe.makeHexColor(e,t,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=qe.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=qX(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Oo(t),Ui.SHADING);let r=Oo(t);if(r){let{width:s,height:o}=t.canvas,[a,l,c,d]=qe.getAxialAlignedBoundingBox([0,0,s,o],r);this.ctx.fillRect(a,l,c-a,d-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Xn("Should not call beginInlineImage")}beginImageData(){Xn("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Tn(this.ctx),t)){let n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.current.updateRectMinMax(Tn(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||Rv("TODO: Support non-isolated groups."),e.knockout&&Ft("Knockout groups not supported.");let n=Tn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=qe.getAxialAlignedBoundingBox(e.bbox,Tn(t)),s=[0,0,t.canvas.width,t.canvas.height];r=qe.intersect(r,s)||[0,0,0,0];let o=Math.floor(r[0]),a=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-o,1),c=Math.max(Math.ceil(r[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);let u=this.cachedCanvases.getCanvas(d,l,c),h=u.context;h.translate(-o,-a),h.transform(...n),e.smask?this.smaskStack.push({canvas:u.canvas,context:h,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),nf(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let r=Tn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);let s=qe.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,n,r,s){if(this.#e(),W0(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let o=t[2]-t[0],a=t[3]-t[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;let[l,c]=qe.singularValueDecompose2dScale(Tn(this.ctx)),{viewportScale:d}=this,u=Math.ceil(o*this.outputScaleX*d),h=Math.ceil(a*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(u,h);let{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),W0(this.ctx)}else W0(this.ctx),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.endPath()}this.current=new uv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let n=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=KX(e)),r.compiled)){r.compiled(n);return}let s=this._createMaskCanvas(e),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,r=0,s,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);let a=this.ctx;a.save();let l=Tn(a);a.transform(t,n,r,s,0,0);let c=this._createMaskCanvas(e);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let d=0,u=o.length;d<u;d+=2){let h=qe.transform(l,[t,n,r,s,o[d],o[d+1]]),[f,p]=qe.applyTransform([0,0],h);a.drawImage(c.canvas,f,p)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(let s of e){let{data:o,width:a,height:l,transform:c}=s,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),u=d.context;u.save();let h=this.getObject(o,s);Hk(u,h),u.globalCompositeOperation="source-in",u.fillStyle=r?n.getPattern(u,this,Oo(t),Ui.FILL):n,u.fillRect(0,0,a,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),G0(t,d.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){Ft("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,r){if(!this.contentVisible)return;let s=this.getObject(e);if(!s){Ft("Dependent image isn't ready yet");return}let o=s.width,a=s.height,l=[];for(let c=0,d=r.length;c<d;c+=2)l.push({transform:[t,0,0,n,r[c],r[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:n,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,r),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,n=e.height,r=this.ctx;if(this.save(),!Ii){let{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none")}r.scale(1/t,-1/n);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{let l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;Uk(l,e),s=this.applyTransferMapsToCanvas(l)}let o=this._scaleImage(s,Oo(r));r.imageSmoothingEnabled=zk(Tn(r),e.interpolate),G0(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let n=this.ctx,r;if(e.bitmap)r=e.bitmap;else{let s=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,o).context;Uk(l,e),r=this.applyTransferMapsToCanvas(l)}for(let s of t)n.save(),n.transform(...s.transform),n.scale(1,-1),G0(n,r,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let n=this.ctx;this.pendingClip&&(t||(this.pendingClip===jk?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=Tn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:n,c:r,d:s}=this.ctx.getTransform(),o,a;if(n===0&&r===0){let l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)o=a=1/l;else{let d=l*e;o=a=d<1?1/d:1}else if(e===0)o=1/l,a=1/c;else{let d=l*e,u=c*e;o=d<1?1/d:1,a=u<1?1/u:1}}else{let l=Math.abs(t*s-n*r),c=Math.hypot(t,n),d=Math.hypot(r,s);if(e===0)o=d/l,a=c/l;else{let u=e*l;o=d>u?d/u:1,a=c>u?c/u:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:n}=this.current,[r,s]=this.getScaleForStroking();if(t.lineWidth=n||1,r===1&&s===1){t.stroke();return}let o=t.getLineDash();if(e&&t.save(),t.scale(r,s),o.length>0){let a=Math.max(r,s);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let i in vs)Gd.prototype[i]!==void 0&&(Gd.prototype[vs[i]]=Gd.prototype[i]);var ql=class{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}},q0={UNKNOWN:0,DATA:1,ERROR:2},Zn={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function gr(i){switch(i instanceof Error||typeof i=="object"&&i!==null||Xn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Ho(i.message);case"MissingPDFException":return new Uo(i.message);case"PasswordException":return new af(i.message,i.code);case"UnexpectedResponseException":return new qd(i.message,i.status);case"UnknownErrorException":return new lf(i.message,i.details);default:return new lf(i.message,i.toString())}}var Wl=class{constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=r=>{let s=r.data;if(s.targetName!==this.sourceName)return;if(s.stream){this.#t(s);return}if(s.callback){let a=s.callbackId,l=this.callbackCapabilities[a];if(!l)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],s.callback===q0.DATA)l.resolve(s.data);else if(s.callback===q0.ERROR)l.reject(gr(s.reason));else throw new Error("Unexpected callback case");return}let o=this.actionHandler[s.action];if(!o)throw new Error(`Unknown action from worker: ${s.action}`);if(s.callbackId){let a=this.sourceName,l=s.sourceName;new Promise(function(c){c(o(s.data))}).then(function(c){n.postMessage({sourceName:a,targetName:l,callback:q0.DATA,callbackId:s.callbackId,data:c})},function(c){n.postMessage({sourceName:a,targetName:l,callback:q0.ERROR,callbackId:s.callbackId,reason:gr(c)})});return}if(s.streamId){this.#e(s);return}o(s.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){let n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){let r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,n,r){let s=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{let d=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:c.desiredSize},r),d.promise},pull:c=>{let d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,l.postMessage({sourceName:o,targetName:a,stream:Zn.PULL,streamId:s,desiredSize:c.desiredSize}),d.promise},cancel:c=>{ii(c instanceof Error,"cancel must have a valid reason");let d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Zn.CANCEL,streamId:s,reason:gr(c)}),d.promise}},n)}#e(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(c,d=1,u){if(this.isCancelled)return;let h=this.desiredSize;this.desiredSize-=d,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:r,stream:Zn.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Zn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){ii(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Zn.ERROR,streamId:t,reason:gr(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(c){c(a(e.data,l))}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Zn.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:n,targetName:r,stream:Zn.START_COMPLETE,streamId:t,reason:gr(c)})})}#t(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Zn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(gr(e.reason));break;case Zn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(gr(e.reason));break;case Zn.PULL:if(!a){s.postMessage({sourceName:n,targetName:r,stream:Zn.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(l){l(a.onPull?.())}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Zn.PULL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:n,targetName:r,stream:Zn.PULL_COMPLETE,streamId:t,reason:gr(l)})});break;case Zn.ENQUEUE:if(ii(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Zn.CLOSE:if(ii(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#n(o,t);break;case Zn.ERROR:ii(o,"error should have stream controller"),o.controller.error(gr(e.reason)),this.#n(o,t);break;case Zn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(gr(e.reason)),this.#n(o,t);break;case Zn.CANCEL:if(!a)break;new Promise(function(l){l(a.onCancel?.(gr(e.reason)))}).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Zn.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:n,targetName:r,stream:Zn.CANCEL_COMPLETE,streamId:t,reason:gr(l)})}),a.sinkCapability.reject(gr(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}#n(e,t){return ce(this,null,function*(){yield Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]})}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},QS=class{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return GE(this.#e)}has(e){return this.#e.has(e)}},ja=Symbol("INTERNAL"),KS=class{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:n,usage:r}){this.#e=!!(e&vr.DISPLAY),this.#t=!!(e&vr.PRINT),this.name=t,this.intent=n,this.usage=r}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;let{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==ja&&Xn("Internal method `_setVisible` called."),this.#n=n,this.#i=t}},JS=class{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=vr.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(let n of e.groups)this.#t.set(n.id,new KS(t,n));if(e.baseState==="OFF")for(let n of this.#t.values())n._setVisible(ja,!1);for(let n of e.on)this.#t.get(n)._setVisible(ja,!0);for(let n of e.off)this.#t.get(n)._setVisible(ja,!1);this.#n=this.getHash()}}#r(e){let t=e.length;if(t<2)return!0;let n=e[0];for(let r=1;r<t;r++){let s=e[r],o;if(Array.isArray(s))o=this.#r(s);else if(this.#t.has(s))o=this.#t.get(s).visible;else return Ft(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Rv("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ft(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#t.has(t))return Ft(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#t.has(t))return Ft(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#t.has(t))return Ft(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#t.has(t))return Ft(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ft(`Unknown optional content policy ${e.policy}.`),!0}return Ft(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){let n=this.#t.get(e);if(!n){Ft(`Optional content group not found: ${e}`);return}n._setVisible(ja,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(let r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}let s=this.#t.get(r);if(s)switch(n){case"ON":s._setVisible(ja,!0);break;case"OFF":s._setVisible(ja,!1);break;case"Toggle":s._setVisible(ja,!s.visible);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?GE(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;let e=new cv;for(let[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}},$S=class{constructor(e,{disableRange:t=!1,disableStream:n=!1}){ii(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:r,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,s?.length>0){let l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{let r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(n),!0)});ii(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ii(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new eE(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new tE(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},eE=class{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=WE(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(let s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return ce(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},tE=class{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return ce(this,null,function*(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function tY(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let d=a(t);return d=unescape(d),d=l(d),d=c(d),s(d)}if(t=o(i),t){let d=c(t);return s(d)}if(t=n("filename","i").exec(i),t){t=t[1];let d=a(t);return d=c(d),s(d)}function n(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function r(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{let h=new TextDecoder(d,{fatal:!0}),f=Lv(u);u=h.decode(f),e=!1}catch{}}return u}function s(d){return e&&/[\x80-\xff]/.test(d)&&(d=r("utf-8",d),e&&(d=r("iso-8859-1",d))),d}function o(d){let u=[],h,f=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=f.exec(d))!==null;){let[,v,g,m]=h;if(v=parseInt(v,10),v in u){if(v===0)break;continue}u[v]=[g,m]}let p=[];for(let v=0;v<u.length&&v in u;++v){let[g,m]=u[v];m=a(m),g&&(m=unescape(m),v===0&&(m=l(m))),p.push(m)}return p.join("")}function a(d){if(d.startsWith('"')){let u=d.slice(1).split('\\"');for(let h=0;h<u.length;++h){let f=u[h].indexOf('"');f!==-1&&(u[h]=u[h].slice(0,f),u.length=h+1),u[h]=u[h].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function l(d){let u=d.indexOf("'");if(u===-1)return d;let h=d.slice(0,u),p=d.slice(u+1).replace(/^[^']*'/,"");return r(h,p)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,h,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,g){return String.fromCharCode(parseInt(g,16))}),r(h,p);try{p=atob(p)}catch{}return r(h,p)})}return""}function ZE({getResponseHeader:i,isHttp:e,rangeChunkSize:t,disableRange:n}){let r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(i("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||n||!e||i("Accept-Ranges")!=="bytes"||(i("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function XE(i){let e=i("Content-Disposition");if(e){let t=tY(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(WE(t))return t}return null}function Fv(i,e){return i===404||i===0&&e.startsWith("file:")?new Uo('Missing PDF "'+e+'".'):new qd(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i)}function Qk(i){return i===200||i===206}function Kk(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Jk(i){let e=new Headers;for(let t in i){let n=i[t];n!==void 0&&e.append(t,n)}return e}function $k(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Ft(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}var hv=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ii(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new nE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new iE(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},nE=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=Jk(this._stream.httpHeaders);let n=t.url;fetch(n,Kk(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!Qk(r.status))throw Fv(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();let s=l=>r.headers.get(l),{allowRangeRequests:o,suggestedLength:a}=ZE({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=XE(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ho("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ce(this,null,function*(){yield this._headersCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$k(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},iE=class{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;let r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController,this._headers=Jk(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${n-1}`);let s=r.url;fetch(s,Kk(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!Qk(o.status))throw Fv(o.status,s);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return ce(this,null,function*(){yield this._readCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:$k(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},_S=200,SS=206;function nY(i){let e=i.response;return typeof e!="string"?e:Lv(e).buffer}var rE=class{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){let r={begin:e,end:t};for(let s in n)r[s]=n[s];return this.request(r)}requestFull(e){return this.request(e)}request(e){let t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let s in this.httpHeaders){let o=this.httpHeaders[s];o!==void 0&&t.setRequestHeader(s,o)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=SS):r.expectedStatus=_S,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){let n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){let n=this.pendingRequests[e];if(!n)return;let r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError?.(r.status);return}let s=r.status||_S;if(!(s===_S&&n.expectedStatus===SS)&&s!==n.expectedStatus){n.onError?.(r.status);return}let a=nY(r);if(s===SS){let l=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);n.onDone({begin:parseInt(c[1],10),chunk:a})}else a?n.onDone({begin:0,chunk:a}):n.onError?.(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},sE=class{constructor(e){this._source=e,this._manager=new rE(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ii(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new oE(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let n=new aE(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},oE=class{constructor(e,t){this._manager=e;let n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=o=>t.getResponseHeader(o),{allowRangeRequests:r,suggestedLength:s}=ZE({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=XE(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Fv(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return ce(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},aE=class{constructor(e,t,n){this._manager=e;let r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=Fv(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}read(){return ce(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},iY=/^[a-z][a-z0-9\-+.]+:/i;function rY(i){if(iY.test(i))return new URL(i);let e=Gs.get("url");return new URL(e.pathToFileURL(i))}function e3(i,e,t){return i.protocol==="http:"?Gs.get("http").request(i,{headers:e},t):Gs.get("https").request(i,{headers:e},t)}var lE=class{constructor(e){this.source=e,this.url=rY(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ii(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new uE(this):new cE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=this.isFsUrl?new hE(this,e,t):new dE(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},fv=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ce(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ho("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},pv=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return ce(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},cE=class extends fv{constructor(e){super(e);let t=n=>{if(n.statusCode===404){let a=new Uo(`Missing PDF "${this._url}".`);this._storedError=a,this._headersCapability.reject(a);return}this._headersCapability.resolve(),this._setReadableStream(n);let r=a=>this._readableStream.headers[a.toLowerCase()],{allowRangeRequests:s,suggestedLength:o}=ZE({getResponseHeader:r,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=o||this._contentLength,this._filename=XE(r)};this._request=e3(this._url,e.httpHeaders,t),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}},dE=class extends pv{constructor(e,t,n){super(e),this._httpHeaders={};for(let s in e.httpHeaders){let o=e.httpHeaders[s];o!==void 0&&(this._httpHeaders[s]=o)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;let r=s=>{if(s.statusCode===404){let o=new Uo(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(s)};this._request=e3(this._url,this._httpHeaders,r),this._request.on("error",s=>{this._storedError=s}),this._request.end()}},uE=class extends fv{constructor(e){super(e);let t=Gs.get("fs");t.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Uo(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}},hE=class extends pv{constructor(e,t,n){super(e);let r=Gs.get("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:n-1}))}},sY=1e5,tr=30,oY=.8,mf=class i{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#a=0;#l=0;#u=null;#c=null;#d=0;#o=0;#h=Object.create(null);#p=[];#f=null;#m=[];#v=new WeakMap;#g=null;static#x=new Map;static#y=new Map;static#A=null;static#b=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#o=n.scale*(globalThis.devicePixelRatio||1),this.#d=n.rotation,this.#s={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null};let{pageWidth:r,pageHeight:s,pageX:o,pageY:a}=n.rawDims;this.#g=[1,0,0,-1,-o,a+s],this.#l=r,this.#a=s,i.#T(),Zl(t,n),this.#e.promise.catch(()=>{}).then(()=>{i.#b.delete(this),this.#s=null,this.#h=null})}render(){let e=()=>{this.#u.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#h,t.styles),this.#S(t.items),e()},this.#e.reject)};return this.#u=this.#f.getReader(),i.#b.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){let n=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#d&&(t?.(),this.#d=r,Zl(this.#c,{rotation:r})),n!==this.#o){t?.(),this.#o=n;let s={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:i.#_(this.#r)};for(let o of this.#m)s.properties=this.#v.get(o),s.div=o,this.#M(s)}}cancel(){let e=new Ho("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#p}#S(e){if(this.#n)return;this.#s.ctx??=i.#_(this.#r);let t=this.#m,n=this.#p;for(let r of e){if(t.length>sY){Ft("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){let s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),s.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(r.str),this.#D(r)}}#D(e){let t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#m.push(t);let r=qe.transform(this.#g,e.transform),s=Math.atan2(r[1],r[0]),o=this.#h[e.fontName];o.vertical&&(s+=Math.PI/2);let a=this.#i&&o.fontSubstitution||o.fontFamily,l=Math.hypot(r[2],r[3]),c=l*i.#C(a,this.#r),d,u;s===0?(d=r[4],u=r[5]-c):(d=r[4]+c*Math.sin(s),u=r[5]-c*Math.cos(s));let h="calc(var(--scale-factor)*",f=t.style;this.#t===this.#c?(f.left=`${(100*d/this.#l).toFixed(2)}%`,f.top=`${(100*u/this.#a).toFixed(2)}%`):(f.left=`${h}${d.toFixed(2)}px)`,f.top=`${h}${u.toFixed(2)}px)`),f.fontSize=`${h}${(i.#A*l).toFixed(2)}px)`,f.fontFamily=a,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(n.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let v=Math.abs(e.transform[0]),g=Math.abs(e.transform[3]);v!==g&&Math.max(v,g)/Math.min(v,g)>1.5&&(p=!0)}if(p&&(n.canvasWidth=o.vertical?e.height:e.width),this.#v.set(t,n),this.#s.div=t,this.#s.properties=n,this.#M(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){let v=document.createElement("br");v.setAttribute("role","presentation"),this.#t.append(v)}}#M(e){let{div:t,properties:n,ctx:r,prevFontSize:s,prevFontFamily:o}=e,{style:a}=t,l="";if(i.#A>1&&(l=`scale(${1/i.#A})`),n.canvasWidth!==0&&n.hasText){let{fontFamily:c}=a,{canvasWidth:d,fontSize:u}=n;(s!==u||o!==c)&&(r.font=`${u*this.#o}px ${c}`,e.prevFontSize=u,e.prevFontFamily=c);let{width:h}=r.measureText(t.textContent);h>0&&(l=`scaleX(${d*this.#o/h}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#b.size>0)){this.#x.clear();for(let{canvas:e}of this.#y.values())e.remove();this.#y.clear()}}static#_(e=null){let t=this.#y.get(e||="");if(!t){let n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(e,t)}return t}static#T(){if(this.#A!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#C(e,t){let n=this.#x.get(e);if(n)return n;let r=this.#_(t),s=r.font;r.canvas.width=r.canvas.height=tr,r.font=`${tr}px ${e}`;let o=r.measureText(""),a=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);if(a){let u=a/(a+l);return this.#x.set(e,u),r.canvas.width=r.canvas.height=0,r.font=s,u}r.strokeStyle="red",r.clearRect(0,0,tr,tr),r.strokeText("g",0,0);let c=r.getImageData(0,0,tr,tr).data;l=0;for(let u=c.length-1-3;u>=0;u-=4)if(c[u]>0){l=Math.ceil(u/4/tr);break}r.clearRect(0,0,tr,tr),r.strokeText("A",0,tr),c=r.getImageData(0,0,tr,tr).data,a=0;for(let u=0,h=c.length;u<h;u+=4)if(c[u]>0){a=tr-Math.floor(u/4/tr);break}r.canvas.width=r.canvas.height=0,r.font=s;let d=a?a/(a+l):oY;return this.#x.set(e,d),d}},gf=class i{static textContent(e){let t=[],n={items:t,styles:Object.create(null)};function r(s){if(!s)return;let o=null,a=s.name;if(a==="#text")o=s.value;else if(i.shouldBuildText(a))s?.attributes?.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(let l of s.children)r(l)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},aY=65536,lY=100,cY=5e3,dY=Ii?zS:DS,uY=Ii?jS:rv,hY=Ii?HS:IS,fY=Ii?GS:sv;function pY(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});let e=new fE,{docId:t}=e,n=i.url?mY(i.url):null,r=i.data?gY(i.data):null,s=i.httpHeaders||null,o=i.withCredentials===!0,a=i.password??null,l=i.range instanceof mv?i.range:null,c=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:aY,d=i.worker instanceof Wd?i.worker:null,u=i.verbosity,h=typeof i.docBaseUrl=="string"&&!Nv(i.docBaseUrl)?i.docBaseUrl:null,f=typeof i.cMapUrl=="string"?i.cMapUrl:null,p=i.cMapPacked!==!1,v=i.CMapReaderFactory||uY,g=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,m=i.StandardFontDataFactory||fY,y=i.stopAtErrors!==!0,w=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,A=i.isEvalSupported!==!1,C=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Ii,E=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,T=typeof i.disableFontFace=="boolean"?i.disableFontFace:Ii,L=i.fontExtraProperties===!0,S=i.enableXfa===!0,_=i.ownerDocument||globalThis.document,P=i.disableRange===!0,U=i.disableStream===!0,O=i.disableAutoFetch===!0,z=i.pdfBug===!0,q=i.enableHWA===!0,Q=l?l.length:i.length??NaN,K=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Ii&&!T,W=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:v===rv&&m===sv&&f&&g&&sf(f,document.baseURI)&&sf(g,document.baseURI),Ee=i.canvasFactory||new dY({ownerDocument:_,enableHWA:q}),Te=i.filterFactory||new hY({docId:t,ownerDocument:_}),ke=null;DX(u);let We={canvasFactory:Ee,filterFactory:Te};if(W||(We.cMapReaderFactory=new v({baseUrl:f,isCompressed:p}),We.standardFontDataFactory=new m({baseUrl:g})),!d){let xe={verbosity:u,port:ql.workerPort};d=xe.port?Wd.fromPort(xe):new Wd(xe),e._worker=d}let at={docId:t,apiVersion:"4.6.82",data:r,password:a,disableAutoFetch:O,rangeChunkSize:c,length:Q,docBaseUrl:h,enableXfa:S,evaluatorOptions:{maxImageSize:w,disableFontFace:T,ignoreErrors:y,isEvalSupported:A,isOffscreenCanvasSupported:C,canvasMaxAreaInBytes:E,fontExtraProperties:L,useSystemFonts:K,cMapUrl:W?f:null,standardFontDataUrl:W?g:null}},se={disableFontFace:T,fontExtraProperties:L,ownerDocument:_,pdfBug:z,styleElement:ke,loadingParams:{disableAutoFetch:O,enableXfa:S}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");let xe=d.messageHandler.sendWithPromise("GetDocRequest",at,r?[r.buffer]:null),Ne;if(l)Ne=new $S(l,{disableRange:P,disableStream:U});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");Ne=(je=>Ii?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&sf(je.url)?new hv(je):new lE(je):sf(je.url)?new hv(je):new sE(je))({url:n,length:Q,httpHeaders:s,withCredentials:o,rangeChunkSize:c,disableRange:P,disableStream:U})}return xe.then(pe=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");let je=new Wl(t,pe,d.port),dt=new vE(je,e,Ne,se,We);e._transport=dt,je.send("Ready",null)})}).catch(e._capability.reject),e}function mY(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(Ii&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function gY(i){if(Ii&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Lv(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Gk(i){return typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0}var fE=class i{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${i.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return ce(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}},mv=class{constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Xn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},pE=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return qt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},mE=class{#e=null;#t=!1;constructor(e,t,n,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new ov:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new gv,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:s=!1}={}){return new df({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return qt(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return ce(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:r=Ga.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:u=!1}){this._stats?.time("Overall");let h=this._transport.getRenderingIntent(n,r,d,u),{renderingIntent:f,cacheKey:p}=h;this.#t=!1,this.#i(),a||=this._transport.getOptionalContentConfig(f);let v=this._intentStates.get(p);v||(v=Object.create(null),this._intentStates.set(p,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);let g=!!(f&vr.PRINT);v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));let m=A=>{v.renderTasks.delete(y),(this._maybeCleanupAfterRender||g)&&(this.#t=!0),this.#n(!g),A?(y.capability.reject(A),this._abortOperatorList({intentState:v,reason:A instanceof Error?A:new Error(A)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new wE({callback:m,params:{canvasContext:e,viewport:t,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!g,pdfBug:this._pdfBug,pageColors:c});(v.renderTasks||=new Set).add(y);let w=y.task;return Promise.all([v.displayReadyCapability.promise,a]).then(([A,C])=>{if(this.destroyed){m();return}if(this._stats?.time("Rendering"),!(C.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:A,optionalContentConfig:C}),y.operatorListChanged()}).catch(m),w}getOperatorList({intent:e="display",annotationMode:t=Ga.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}let o=this._transport.getRenderingIntent(e,t,n,r,!0),a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>gf.textContent(n));let t=this.streamTextContent(e);return new Promise(function(n,r){function s(){o.read().then(function({value:l,done:c}){if(c){n(a);return}a.lang??=l.lang,Object.assign(a.styles,l.styles),a.items.push(...l.items),s()},r)}let o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let t=this.#n(!1);return e&&t&&(this._stats&&=new ov),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},cY),!1;for(let{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){let n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){let{map:s,transfer:o}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},o).getReader(),c=this._intentStates.get(t);c.streamReader=l;let d=()=>{l.read().then(({value:u,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),d())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(let h of c.renderTasks)h.operatorListChanged();this.#n(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof uf){let r=lY;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Ho(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}},gE=class{#e=new Set;#t=Promise.resolve();postMessage(e,t){let n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(let r of this.#e)r.call(this,n)})}addEventListener(e,t){this.#e.add(t)}removeEventListener(e,t){this.#e.delete(t)}terminate(){this.#e.clear()}},Wd=class i{static#e=0;static#t=!1;static#n;static{Ii&&(this.#t=!0,ql.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}let r=new URL(t,n);return n.origin===r.origin},this._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:n=PX()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(i.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(i.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return Ii?Promise.all([Gs.promise,this._readyCapability.promise]):this._readyCapability.promise}#i(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Wl("main","worker",e),this._messageHandler.on("ready",function(){}),this.#i()}_initialize(){if(i.#t||i.#r){this._setupFakeWorker();return}let{workerSrc:e}=i;try{i._isSameOrigin(window.location.href,e)||(e=i._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),n=new Wl("main","worker",t),r=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:s.signal}),n.on("test",a=>{if(s.abort(),this.destroyed||!a){r();return}this._messageHandler=n,this._port=t,this._webWorker=t,this.#i()}),n.on("ready",a=>{if(s.abort(),this.destroyed){r();return}try{o()}catch{this._setupFakeWorker()}});let o=()=>{let a=new Uint8Array;n.send("test",a,[a.buffer])};o();return}catch{Rv("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){i.#t||(Ft("Setting up fake worker."),i.#t=!0),i._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new gE;this._port=t;let n=`fake${i.#e++}`,r=new Wl(n+"_worker",n,t);e.setup(r,t),this._messageHandler=new Wl(n,n+"_worker",t),this.#i()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),i.#n?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new i(e)}static get workerSrc(){if(ql.workerSrc)return ql.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#r(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return qt(this,"_setupFakeWorkerGlobal",ce(this,null,function*(){return this.#r?this.#r:(yield import(this.workerSrc)).WorkerMessageHandler}))}},vE=class{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#r=null;constructor(e,t,n,r,s){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new gv,this.fontLoader=new VS({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){let n=this.#e.get(e);if(n)return n;let r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return qt(this,"annotationStorage",new ff)}getRenderingIntent(e,t=Ga.ENABLE,n=null,r=!1,s=!1){let o=vr.DISPLAY,a=BS;switch(e){case"any":o=vr.ANY;break;case"display":break;case"print":o=vr.PRINT;break;default:Ft(`getRenderingIntent - invalid intent: ${e}`)}let l=o&vr.PRINT&&n instanceof dv?n:this.annotationStorage;switch(t){case Ga.DISABLE:o+=vr.ANNOTATIONS_DISABLE;break;case Ga.ENABLE:break;case Ga.ENABLE_FORMS:o+=vr.ANNOTATIONS_FORMS;break;case Ga.ENABLE_STORAGE:o+=vr.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ft(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=vr.IS_EDITING),s&&(o+=vr.OPLIST);let{ids:c,hash:d}=l.modifiedIds,u=[o,a.hash,d];return{renderingIntent:o,cacheKey:u.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),mf.cleanup(),this._networkStream?.cancelAllRequests(new Ho("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{ii(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){r.close();return}ii(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",n=>{let r=Promise.withResolvers(),s=this._fullReader;return s.headersReady.then(()=>{(!s.isStreamingSupported||!s.isRangeSupported)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),s.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),r.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},r.reject),r.promise}),e.on("GetRangeReader",(n,r)=>{ii(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){r.close();return}ii(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{s.cancel(o),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new pE(n,this))}),e.on("DocException",function(n){let r;switch(n.name){case"PasswordException":r=new af(n.message,n.code);break;case"InvalidPDFException":r=new $0(n.message);break;case"MissingPDFException":r=new Uo(n.message);break;case"UnexpectedResponseException":r=new qd(n.message,n.status);break;case"UnknownErrorException":r=new lf(n.message,n.details);break;default:Xn("DocException - expected a valid Error.")}t._capability.reject(r)}),e.on("PasswordRequest",n=>{if(this.#r=Promise.withResolvers(),t.onPassword){let r=s=>{s instanceof Error?this.#r.reject(s):this.#r.resolve({password:s})};try{t.onPassword(r,n.code)}catch(s){this.#r.reject(s)}}else this.#r.reject(new af(n.message,n.code));return this.#r.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,s])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":let{disableFontFace:o,fontExtraProperties:a,pdfBug:l}=this._params;if("error"in s){let h=s.error;Ft(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}let c=l&&globalThis.FontInspector?.enabled?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,d=new US(s,{disableFontFace:o,inspectFont:c});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!a&&d.data&&(d.data=null),this.commonObjs.resolve(n,d)});break;case"CopyLocalImage":let{imageRef:u}=s;ii(u,"The imageRef must be defined.");for(let h of this.#t.values())for(let[,f]of h.objs)if(f?.ref===u)return f.dataLen?(this.commonObjs.resolve(n,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,s,o])=>{if(this.destroyed)return;let a=this.#t.get(r);if(!a.objs.has(n)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(s){case"Image":a.objs.resolve(n,o),o?.dataLen>EX&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ft("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,n=this.#n.get(t);if(n)return n;let r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#i.set(s.refStr,e);let o=new mE(t,s,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,r),r}getPageIndex(e){return Gk(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new JS(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#e.get(e);if(t)return t;let n=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new QS(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return ce(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),mf.cleanup()}})}cachedPageNumber(e){if(!Gk(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}},Z0=Symbol("INITIAL_DATA"),gv=class{#e=Object.create(null);#t(e){return this.#e[e]||=Ge(re({},Promise.withResolvers()),{data:Z0})}get(e,t=null){if(t){let r=this.#t(e);return r.promise.then(()=>t(r.data)),null}let n=this.#e[e];if(!n||n.data===Z0)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){let t=this.#e[e];return!!t&&t.data!==Z0}resolve(e,t=null){let n=this.#t(e);n.data=t,n.resolve()}clear(){for(let e in this.#e){let{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(let e in this.#e){let{data:t}=this.#e[e];t!==Z0&&(yield[e,t])}}},xE=class{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}},wE=class i{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:h=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new xE(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(i.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");i.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:n,viewport:r,transform:s,background:o}=this.params;this.gfx=new Gd(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),i.#t.delete(this._canvas),this.callback(e||new uf(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return ce(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),i.#t.delete(this._canvas),this.callback())))})}},vY="4.6.82",xY="9b541910f";function Wk(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function rf(i){return Math.max(0,Math.min(255,255*i))}var vv=class{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=rf(e),[e,e,e]}static G_HTML([e]){let t=Wk(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(rf)}static RGB_HTML(e){return`#${e.map(Wk).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[rf(1-Math.min(1,e+r)),rf(1-Math.min(1,n+r)),rf(1-Math.min(1,t+r))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){let r=1-e,s=1-t,o=1-n,a=Math.min(r,s,o);return["CMYK",r,s,o,a]}},xv=class{static setupStorage(e,t,n,r,s){let o=r.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{r.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(let a of n.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{let l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:s}){let{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(let[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&s.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){let t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,s=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:s,linkService:n});let a=s!=="richText",l=e.div;if(l.append(o),e.viewport){let u=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=u}a&&l.setAttribute("class","xfaLayer xfaFont");let c=[];if(r.children.length===0){if(r.value){let u=document.createTextNode(r.value);o.append(u),a&&gf.shouldBuildText(r.name)&&c.push(u)}return{textDivs:c}}let d=[[r,-1,o]];for(;d.length>0;){let[u,h,f]=d.at(-1);if(h+1===u.children.length){d.pop();continue}let p=u.children[++d.at(-1)[1]];if(p===null)continue;let{name:v}=p;if(v==="#text"){let m=document.createTextNode(p.value);c.push(m),f.append(m);continue}let g=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,v):document.createElement(v);if(f.append(g),p.attributes&&this.setAttributes({html:g,element:p,storage:t,intent:s,linkService:n}),p.children?.length>0)d.push([p,-1,g]);else if(p.value){let m=document.createTextNode(p.value);a&&gf.shouldBuildText(v)&&c.push(m),g.append(m)}}for(let u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},wf=1e3,wY=9,Yl=new WeakSet;function Vo(i){return{width:i[2]-i[0],height:i[3]-i[1]}}var yE=class{static create(e){switch(e.data.annotationType){case ni.LINK:return new wv(e);case ni.TEXT:return new bE(e);case ni.WIDGET:switch(e.data.fieldType){case"Tx":return new AE(e);case"Btn":return e.data.radioButton?new yv(e):e.data.checkBox?new SE(e):new EE(e);case"Ch":return new CE(e);case"Sig":return new _E(e)}return new zo(e);case ni.POPUP:return new vf(e);case ni.FREETEXT:return new bv(e);case ni.LINE:return new TE(e);case ni.SQUARE:return new IE(e);case ni.CIRCLE:return new DE(e);case ni.POLYLINE:return new Av(e);case ni.CARET:return new RE(e);case ni.INK:return new _v(e);case ni.POLYGON:return new PE(e);case ni.HIGHLIGHT:return new LE(e);case ni.UNDERLINE:return new kE(e);case ni.SQUIGGLY:return new NE(e);case ni.STRIKEOUT:return new FE(e);case ni.STAMP:return new Sv(e);case ni.FILEATTACHMENT:return new OE(e);default:return new On(e)}}},On=class i{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return i._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){let{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}}}=this;n?.splice(0,4,...e);let{width:c,height:d}=Vo(e);t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+l)/o}%`,r===0?(t.width=`${100*c/s}%`,t.height=`${100*d/o}%`):this.setRotation(r)}_createContainer(e){let{data:t,parent:{page:n,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof zo||(s.tabIndex=wf);let{style:o}=s;if(o.zIndex=this.parent.zIndex++,t.popupRef&&s.setAttribute("aria-haspopup","dialog"),t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof vf){let{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,s),s}let{width:a,height:l}=Vo(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;let v=t.borderStyle.horizontalCornerRadius,g=t.borderStyle.verticalCornerRadius;if(v>0||g>0){let y=`calc(${v}px * var(--scale-factor)) / calc(${g}px * var(--scale-factor))`;o.borderRadius=y}else if(this instanceof yv){let y=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=y}switch(t.borderStyle.style){case tf.SOLID:o.borderStyle="solid";break;case tf.DASHED:o.borderStyle="dashed";break;case tf.BEVELED:Ft("Unimplemented border style: beveled");break;case tf.INSET:Ft("Unimplemented border style: inset");break;case tf.UNDERLINE:o.borderBottomStyle="solid";break;default:break}let m=t.borderColor||null;m?(this.#t=!0,o.borderColor=qe.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):o.borderWidth=0}let c=qe.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:d,pageHeight:u,pageX:h,pageY:f}=r.rawDims;o.left=`${100*(c[0]-h)/d}%`,o.top=`${100*(c[1]-f)/u}%`;let{rotation:p}=t;return t.hasOwnCanvas||p===0?(o.width=`${100*a/d}%`,o.height=`${100*l/u}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:s,height:o}=Vo(this.data.rect),a,l;e%180===0?(a=100*s/n,l=100*o/r):(a=100*o/n,l=100*s/r),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,n,r)=>{let s=r.detail[t],o=s[0],a=s.slice(1);r.target.style[n]=vv[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[n]:vv[`${o}_rgb`](a)})};return qt(this,"_commonActions",{display:t=>{let{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){let n=this._commonActions;for(let r of Object.keys(t.detail))(e[r]||n[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let n=this._commonActions;for(let[r,s]of Object.entries(t)){let o=n[r];if(o){let a={detail:{[r]:s},target:e};o(a),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,n,r,s]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){let[v,g,m,y]=e.subarray(2,6);if(r===v&&s===g&&t===m&&n===y)return}let{style:o}=this.container,a;if(this.#t){let{borderColor:v,borderWidth:g}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${g}">`],this.container.classList.add("hasBorder")}let l=r-t,c=s-n,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);let h=d.createElement("defs");u.append(h);let f=d.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),h.append(f);for(let v=2,g=e.length;v<g;v+=8){let m=e[v],y=e[v+1],w=e[v+2],A=e[v+3],C=d.createElement("rect"),E=(w-t)/l,T=(s-y)/c,L=(m-w)/l,S=(y-A)/c;C.setAttribute("x",E),C.setAttribute("y",T),C.setAttribute("width",L),C.setAttribute("height",S),f.append(C),a?.push(`<rect vector-effect="non-scaling-stroke" x="${E}" y="${T}" width="${L}" height="${S}"/>`)}this.#t&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath=`url(#${p})`}_createPopup(){let{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");let n=this.#n=new vf({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(n.render())}render(){Xn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let n=[];if(this._fieldObjects){let r=this._fieldObjects[e];if(r)for(let{page:s,id:o,exportValues:a}of r){if(s===-1||o===t)continue;let l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!Yl.has(c)){Ft(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:l,domElement:c})}return n}for(let r of document.getElementsByName(e)){let{exportValue:s}=r,o=r.getAttribute("data-element-id");o!==t&&Yl.has(r)&&n.push({id:o,exportValue:s,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},wv=class extends On{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#n(n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let r of Object.keys(t.actions)){let s=n.get(r);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){let n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ft('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();let{fields:r,refs:s,include:o}=t,a=[];if(r.length!==0||s.length!==0){let d=new Set(s);for(let u of r){let h=this._fieldObjects[u]||[];for(let{id:f}of h)d.add(f)}for(let u of Object.values(this._fieldObjects))for(let h of u)d.has(h.id)===o&&a.push(h)}else for(let d of Object.values(this._fieldObjects))a.push(...d);let l=this.annotationStorage,c=[];for(let d of a){let{id:u}=d;switch(c.push(u),d.type){case"text":{let f=d.defaultValue||"";l.setValue(u,{value:f});break}case"checkbox":case"radiobutton":{let f=d.defaultValue===d.exportValues;l.setValue(u,{value:f});break}case"combobox":case"listbox":{let f=d.defaultValue||"";l.setValue(u,{value:f});break}default:continue}let h=document.querySelector(`[data-element-id="${u}"]`);if(h){if(!Yl.has(h)){Ft(`_bindResetFormAction - element not allowed: ${u}`);continue}}else continue;h.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}},bE=class extends On{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},zo=class extends On{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Di.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,s){n.includes("mouse")?e.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o)}})})}_setEventListeners(e,t,n,r){for(let[s,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":qe.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||wY,s=e.style,o,a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){let c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(c/(Y0*r))||1,u=c/d;o=Math.min(r,l(u/Y0))}else{let c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(r,l(c/Y0))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=qe.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},AE=class extends zo{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){let s=this.annotationStorage;for(let o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),s.setValue(o.id,{[r]:n})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){let r=e.getValue(t,{value:this.data.fieldValue}),s=r.value||"",o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let a=r.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));let l={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=a??s,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",a??s),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Yl.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=wf,this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",d=>{e.setValue(t,{value:d.target.value}),this.setPropertyOnSiblings(n,"value",d.target.value,"value"),l.formattedValue=null}),n.addEventListener("resetform",d=>{let u=this.data.defaultFieldValue??"";n.value=l.userValue=u,l.formattedValue=null});let c=d=>{let{formattedValue:u}=l;u!=null&&(d.target.value=u),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",u=>{if(l.focused)return;let{target:h}=u;l.userValue&&(h.value=l.userValue),l.lastCommittedValue=h.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),n.addEventListener("updatefromsandbox",u=>{this.showElementAndHideCanvas(u.target);let h={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){let{formattedValue:p}=f.detail;l.formattedValue=p,p!=null&&f.target!==document.activeElement&&(f.target.value=p),e.setValue(t,{formattedValue:p})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{let{charLimit:p}=f.detail,{target:v}=f;if(p===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",p);let g=l.userValue;!g||g.length<=p||(g=g.slice(0,p),v.value=l.userValue=g,e.setValue(t,{value:g}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(h,u)}),n.addEventListener("keydown",u=>{l.commitKey=1;let h=-1;if(u.key==="Escape"?h=0:u.key==="Enter"&&!this.data.multiLine?h=2:u.key==="Tab"&&(l.commitKey=3),h===-1)return;let{value:f}=u.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:h,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}))});let d=c;c=null,n.addEventListener("blur",u=>{if(!l.focused||!u.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);let{value:h}=u.target;l.userValue=h,l.lastCommittedValue!==h&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,willCommit:!0,commitKey:l.commitKey,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}),d(u)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",u=>{l.lastCommittedValue=null;let{data:h,target:f}=u,{value:p,selectionStart:v,selectionEnd:g}=f,m=v,y=g;switch(u.inputType){case"deleteWordBackward":{let w=p.substring(0,v).match(/\w*[^\w]*$/);w&&(m-=w[0].length);break}case"deleteWordForward":{let w=p.substring(v).match(/^[^\w]*\w*/);w&&(y+=w[0].length);break}case"deleteContentBackward":v===g&&(m-=1);break;case"deleteContentForward":v===g&&(y+=1);break}u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:h||"",willCommit:!1,selStart:m,selEnd:y}})}),this._setEventListeners(n,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.value)}if(c&&n.addEventListener("blur",c),this.data.comb){let u=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},_E=class extends zo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},SE=class extends zo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let s=document.createElement("input");return Yl.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=wf,s.addEventListener("change",o=>{let{name:a,checked:l}=o.target;for(let c of this._getElementsByName(a,n)){let d=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{let a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},yv=class extends zo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(let o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});let s=document.createElement("input");if(Yl.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=wf,s.addEventListener("change",o=>{let{name:a,checked:l}=o.target;for(let c of this._getElementsByName(a,n))e.setValue(c.id,{value:!1});e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){let o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{let l={value:c=>{let d=o===c.detail.value;for(let u of this._getElementsByName(c.target.name)){let h=d&&u.id===n;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},EE=class extends wv{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}},CE=class extends zo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Yl.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=wf;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",d=>{let u=this.data.defaultFieldValue;for(let h of r.options)h.selected=h.value===u});for(let d of this.data.options){let u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,n.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),s=!1),r.append(u)}let o=null;if(s){let d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),r.prepend(d),o=()=>{d.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}let a=d=>{let u=d?"value":"textContent",{options:h,multiple:f}=r;return f?Array.prototype.filter.call(h,p=>p.selected).map(p=>p[u]):h.selectedIndex===-1?null:h[h.selectedIndex][u]},l=a(!1),c=d=>{let u=d.target.options;return Array.prototype.map.call(u,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",d=>{let u={value(h){o?.();let f=h.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(let v of r.options)v.selected=p.has(v.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(h){r.multiple=!0},remove(h){let f=r.options,p=h.detail.remove;f[p].selected=!1,r.remove(p),f.length>0&&Array.prototype.findIndex.call(f,g=>g.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},clear(h){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(h){let{index:f,displayValue:p,exportValue:v}=h.detail.insert,g=r.children[f],m=document.createElement("option");m.textContent=p,m.value=v,g?g.before(m):r.append(m),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},items(h){let{items:f}=h.detail;for(;r.length!==0;)r.remove(0);for(let p of f){let{displayValue:v,exportValue:g}=p,m=document.createElement("option");m.textContent=v,m.value=g,r.append(m)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},indices(h){let f=new Set(h.detail.indices);for(let p of h.target.options)p.selected=f.has(p.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(u,d)}),r.addEventListener("input",d=>{let u=a(!0),h=a(!1);e.setValue(t,{value:u}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:h,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):r.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},vf=class extends On{constructor(e){let{data:t,elements:n}=e;super(e,{isRenderable:On._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new ME({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let n of this.elements)n.popup=e,t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${Xk}${n}`).join(",")),this.container}},ME=class{#e=this.#D.bind(this);#t=this.#C.bind(this);#n=this.#T.bind(this);#i=this.#_.bind(this);#r=null;#s=null;#a=null;#l=null;#u=null;#c=null;#d=null;#o=!1;#h=null;#p=null;#f=null;#m=null;#v=null;#g=null;#x=!1;constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:c,parentRect:d,open:u}){this.#s=e,this.#v=r,this.#a=o,this.#m=a,this.#c=l,this.#r=t,this.#f=c,this.#d=d,this.#u=n,this.#l=av.toDateObject(s),this.trigger=n.flatMap(h=>h.getElementsToTriggerPopup());for(let h of this.trigger)h.addEventListener("click",this.#i),h.addEventListener("mouseenter",this.#n),h.addEventListener("mouseleave",this.#t),h.classList.add("popupTriggerArea");for(let h of n)h.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,u&&this.#_()}render(){if(this.#h)return;let e=this.#h=document.createElement("div");if(e.className="popup",this.#r){let s=e.style.outlineColor=qe.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=qe.makeHexColor(...this.#r.map(a=>Math.floor(.7*(255-a)+a)))}let t=document.createElement("span");t.className="header";let n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#v,e.append(t),this.#l){let s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),t.append(s)}let r=this.#y;if(r)xv.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let s=this._formatContents(this.#a);e.append(s)}this.#s.append(e)}get#y(){let e=this.#m,t=this.#a;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#A(){return this.#y?.attributes?.style?.fontSize||0}get#b(){return this.#y?.attributes?.style?.color||null}#S(e){let t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#b,fontSize:this.#A?`calc(${this.#A}px * var(--scale-factor))`:""}};for(let s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return n}_formatContents({str:e,dir:t}){let n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;let r=e.split(/(?:\r\n?|\n)/);for(let s=0,o=r.length;s<o;++s){let a=r[s];n.append(document.createTextNode(a)),s<o-1&&n.append(document.createElement("br"))}return n}#D(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#o)&&this.#_()}updateEdited({rect:e,popupContent:t}){this.#g||={contentsObj:this.#a,richText:this.#m},e&&(this.#p=null),t&&(this.#m=this.#S(t),this.#a=null),this.#h?.remove(),this.#h=null}resetEdited(){this.#g&&({contentsObj:this.#a,richText:this.#m}=this.#g,this.#g=null,this.#h?.remove(),this.#h=null,this.#p=null)}#M(){if(this.#p!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:s}}}=this.#c,o=!!this.#d,a=o?this.#d:this.#f;for(let p of this.#u)if(!a||qe.intersect(p.data.rect,a)!==null){a=p.data.rect,o=!0;break}let l=qe.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,u=l[0]+d,h=l[1];this.#p=[100*(u-r)/t,100*(h-s)/n];let{style:f}=this.#s;f.left=`${this.#p[0]}%`,f.top=`${this.#p[1]}%`}#_(){this.#o=!this.#o,this.#o?(this.#T(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#e)):(this.#C(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#e))}#T(){this.#h||this.render(),this.isVisible?this.#o&&this.#s.classList.add("focused"):(this.#M(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#o||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#s.hidden=!0)}maybeShow(){this.#x&&(this.#h||this.#T(),this.#x=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}},bv=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=zt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},TE=class extends On{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:n}=Vo(e.rect),r=this.svgFactory.create(t,n,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},IE=class extends On{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:n}=Vo(e.rect),r=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",t-s),o.setAttribute("height",n-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},DE=class extends On{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:n}=Vo(e.rect),r=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-s/2),o.setAttribute("ry",n/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Av=class extends On{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:n,popupRef:r}}=this;if(!t)return this.container;let{width:s,height:o}=Vo(e),a=this.svgFactory.create(s,o,!0),l=[];for(let d=0,u=t.length;d<u;d+=2){let h=t[d]-e[0],f=e[3]-t[d+1];l.push(`${h},${f}`)}l=l.join(" ");let c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},PE=class extends Av{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},RE=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},_v=class extends On{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=zt.INK}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,inkLists:t,borderStyle:n,popupRef:r}}=this,{width:s,height:o}=Vo(e),a=this.svgFactory.create(s,o,!0);for(let l of t){let c=[];for(let u=0,h=l.length;u<h;u+=2){let f=l[u]-e[0],p=e[3]-l[u+1];c.push(`${f},${p}`)}c=c.join(" ");let d=this.svgFactory.createElement(this.svgElementName);this.#e.push(d),d.setAttribute("points",c),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),!r&&this.hasPopupData&&this._createPopup(),a.append(d)}return this.container.append(a),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},LE=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}},kE=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},NE=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},FE=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},Sv=class extends On{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},OE=class extends On{#e=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",re({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;let{isMac:r}=Di.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(r?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},BE=class{#e=null;#t=null;#n=new Map;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:s,viewport:o}){this.div=e,this.#e=t,this.#t=n,this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}#i(e,t){let n=e.firstChild||e;n.id=`${Xk}${t}`,this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1)}render(e){return ce(this,null,function*(){let{annotations:t}=e,n=this.div;Zl(n,this.viewport);let r=new Map,s={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new cf,annotationStorage:e.annotationStorage||new ff,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let o of t){if(o.noHTML)continue;let a=o.annotationType===ni.POPUP;if(a){let d=r.get(o.id);if(!d)continue;s.elements=d}else{let{width:d,height:u}=Vo(o.rect);if(d<=0||u<=0)continue}s.data=o;let l=yE.create(s);if(!l.isRenderable)continue;if(!a&&o.popupRef){let d=r.get(o.popupRef);d?d.push(l):r.set(o.popupRef,[l])}let c=l.render();o.hidden&&(c.style.visibility="hidden"),this.#i(c,o.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#r()})}update({viewport:e}){let t=this.div;this.viewport=e,Zl(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;let e=this.div;for(let[t,n]of this.#t){let r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;n.className="annotationContent";let{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):r.append(n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}},X0=/\r\n?|\n/g,VE=class i extends nn{#e;#t="";#n=`${this.id}-editor`;#i=null;#r;#s=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=i.prototype,t=s=>s.isEmpty(),n=hf.TRANSLATE_SMALL,r=hf.TRANSLATE_BIG;return qt(this,"_keyboardManager",new Xl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=zt.FREETEXT;constructor(e){super(Ge(re({},e),{name:"freeTextEditor"})),this.#e=e.color||i._defaultColor||nn._defaultLineColor,this.#r=e.fontSize||i._defaultFontSize}static initialize(e,t){nn.initialize(e,t,{strings:["pdfjs-free-text-default-content"]});let n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case mt.FREETEXT_SIZE:i._defaultFontSize=t;break;case mt.FREETEXT_COLOR:i._defaultColor=t;break}}updateParams(e,t){switch(e){case mt.FREETEXT_SIZE:this.#a(t);break;case mt.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[mt.FREETEXT_SIZE,i._defaultFontSize],[mt.FREETEXT_COLOR,i._defaultColor||nn._defaultLineColor]]}get propertiesToUpdate(){return[[mt.FREETEXT_SIZE,this.#r],[mt.FREETEXT_COLOR,this.#e]]}#a(e){let t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#c()},n=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){let t=r=>{this.#e=this.editorDiv.style.color=r},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-i._internalPadding*e,-(i._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(zt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;let e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#u(){let e=[];this.editorDiv.normalize();for(let t of this.editorDiv.childNodes)e.push(i.#d(t));return e.join(`
`)}#c(){let[e,t]=this.parentDimensions,n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{let{currentLayer:r,div:s}=this,o=s.style.display,a=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",r.div.append(this.div),n=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#t,t=this.#t=this.#u().trimEnd();if(e===t)return;let n=r=>{if(this.#t=r,!r){this.remove();return}this.#o(),this._uiManager.rebuild(this),this.#c()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){i._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),nn._l10nPromise.get("pdfjs-free-text-default-content").then(r=>this.editorDiv?.setAttribute("default-content",r)),this.editorDiv.contentEditable=!0;let{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#r}px * var(--scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),lv(this,this.div,["dblclick","keydown"]),this.width){let[r,s]=this.parentDimensions;if(this.annotationElementId){let{position:o}=this.#s,[a,l]=this.getInitialTranslation();[a,l]=this.pageTranslationToScreen(a,l);let[c,d]=this.pageDimensions,[u,h]=this.pageTranslation,f,p;switch(this.rotation){case 0:f=e+(o[0]-u)/c,p=t+this.height-(o[1]-h)/d;break;case 90:f=e+(o[0]-u)/c,p=t-(o[1]-h)/d,[a,l]=[l,-a];break;case 180:f=e-this.width+(o[0]-u)/c,p=t-(o[1]-h)/d,[a,l]=[-a,-l];break;case 270:f=e+(o[0]-u-this.height*d)/c,p=t+(o[1]-h-this.width*c)/d,[a,l]=[-l,a];break}this.setAt(f*r,p*s,a,l)}else this.setAt(e*r,t*s,this.width*r,this.height*s);this.#o(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#d(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(X0,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();let r=i.#p(t.getData("text")||"").replaceAll(X0,`
`);if(!r)return;let s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();let o=s.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),s.collapseToStart();return}let{startContainer:a,startOffset:l}=o,c=[],d=[];if(a.nodeType===Node.TEXT_NODE){let f=a.parentElement;if(d.push(a.nodeValue.slice(l).replaceAll(X0,"")),f!==this.editorDiv){let p=c;for(let v of this.editorDiv.childNodes){if(v===f){p=d;continue}p.push(i.#d(v))}}c.push(a.nodeValue.slice(0,l).replaceAll(X0,""))}else if(a===this.editorDiv){let f=c,p=0;for(let v of this.editorDiv.childNodes)p++===l&&(f=d),f.push(i.#d(v))}this.#t=`${c.join(`
`)}${r}${d.join(`
`)}`,this.#o();let u=new Range,h=c.reduce((f,p)=>f+p.length,0);for(let{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){let p=f.nodeValue.length;if(h<=p){u.setStart(f,h),u.setEnd(f,h);break}h-=p}s.removeAllRanges(),s.addRange(u)}#o(){if(this.editorDiv.replaceChildren(),!!this.#t)for(let e of this.#t.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#t.replaceAll("\xA0"," ")}static#p(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){let r=null;if(e instanceof bv){let{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:l,rotation:c,id:d},textContent:u,textPosition:h,parent:{page:{pageNumber:f}}}=e;if(!u||u.length===0)return null;r=e={annotationType:zt.FREETEXT,color:Array.from(a),fontSize:o,value:u.join(`
`),position:h,pageIndex:f-1,rect:l.slice(0),rotation:c,id:d,deleted:!1}}let s=super.deserialize(e,t,n);return s.#r=e.fontSize,s.#e=qe.makeHexColor(...e.color),s.#t=i.#p(e.value),s.annotationElementId=e.id||null,s.#s=r,s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};let t=i._internalPadding*this.parentScale,n=this.getRect(t,t),r=nn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),s={annotationType:zt.FREETEXT,color:r,fontSize:this.#r,value:this.#h(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(e){let{value:t,fontSize:n,color:r,pageIndex:s}=this.#s;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((o,a)=>o!==r[a])||e.pageIndex!==s}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:n}=t;n.fontSize=`calc(${this.#r}px * var(--scale-factor))`,n.color=this.#e,t.replaceChildren();for(let s of this.#t.split(`
`)){let o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}let r=i._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},Ev=class{#e;#t=[];#n=[];constructor(e,t=0,n=0,r=!0){let s=1/0,o=-1/0,a=1/0,l=-1/0,d=10**-4;for(let{x:m,y,width:w,height:A}of e){let C=Math.floor((m-t)/d)*d,E=Math.ceil((m+w+t)/d)*d,T=Math.floor((y-t)/d)*d,L=Math.ceil((y+A+t)/d)*d,S=[C,T,L,!0],_=[E,T,L,!1];this.#t.push(S,_),s=Math.min(s,C),o=Math.max(o,E),a=Math.min(a,T),l=Math.max(l,L)}let u=o-s+2*n,h=l-a+2*n,f=s-n,p=a-n,v=this.#t.at(r?-1:-2),g=[v[0],v[2]];for(let m of this.#t){let[y,w,A]=m;m[0]=(y-f)/u,m[1]=(w-p)/h,m[2]=(A-p)/h}this.#e={x:f,y:p,width:u,height:h,lastPoint:g}}getOutlines(){this.#t.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);let e=[];for(let t of this.#t)t[3]?(e.push(...this.#l(t)),this.#s(t)):(this.#a(t),e.push(...this.#l(t)));return this.#i(e)}#i(e){let t=[],n=new Set;for(let o of e){let[a,l,c]=o;t.push([a,l,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){let l=t[o][2],c=t[o+1][2];l.push(c),c.push(l),n.add(l),n.add(c)}let r=[],s;for(;n.size>0;){let o=n.values().next().value,[a,l,c,d,u]=o;n.delete(o);let h=a,f=l;for(s=[a,c],r.push(s);;){let p;if(n.has(d))p=d;else if(n.has(u))p=u;else break;n.delete(p),[a,l,c,d,u]=p,h!==a&&(s.push(h,f,a,f===l?l:c),h=a),f=f===l?c:l}s.push(h,f)}return new UE(r,this.#e)}#r(e){let t=this.#n,n=0,r=t.length-1;for(;n<=r;){let s=n+r>>1,o=t[s][0];if(o===e)return s;o<e?n=s+1:r=s-1}return r+1}#s([,e,t]){let n=this.#r(e);this.#n.splice(n,0,[e,t])}#a([,e,t]){let n=this.#r(e);for(let r=n;r<this.#n.length;r++){let[s,o]=this.#n[r];if(s!==e)break;if(s===e&&o===t){this.#n.splice(r,1);return}}for(let r=n-1;r>=0;r--){let[s,o]=this.#n[r];if(s!==e)break;if(s===e&&o===t){this.#n.splice(r,1);return}}}#l(e){let[t,n,r]=e,s=[[t,n,r]],o=this.#r(r);for(let a=0;a<o;a++){let[l,c]=this.#n[a];for(let d=0,u=s.length;d<u;d++){let[,h,f]=s[d];if(!(c<=h||f<=l)){if(h>=l){if(f>c)s[d][1]=c;else{if(u===1)return[];s.splice(d,1),d--,u--}continue}s[d][2]=l,f>c&&s.push([t,c,f])}}}return s}},Cv=class{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(e,t){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof xf}},UE=class extends Cv{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){let e=[];for(let t of this.#t){let[n,r]=t;e.push(`M${n} ${r}`);for(let s=2;s<t.length;s+=2){let o=t[s],a=t[s+1];o===n?(e.push(`V${a}`),r=a):a===r&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,t,n,r],s){let o=[],a=n-e,l=r-t;for(let c of this.#t){let d=new Array(c.length);for(let u=0;u<c.length;u+=2)d[u]=e+c[u]*a,d[u+1]=r-c[u+1]*l;o.push(d)}return o}get box(){return this.#e}},Mv=class i{#e;#t=[];#n;#i;#r=[];#s=new Float64Array(18);#a;#l;#u;#c;#d;#o;#h=[];static#p=8;static#f=2;static#m=i.#p+i.#f;constructor({x:e,y:t},n,r,s,o,a=0){this.#e=n,this.#o=s*r,this.#i=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#c=i.#p*r,this.#u=i.#m*r,this.#d=r,this.#h.push(e,t)}get free(){return!0}isEmpty(){return isNaN(this.#s[8])}#v(){let e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,r,s,o]=this.#e;return[(this.#a+(e[0]-t[0])/2-n)/s,(this.#l+(e[1]-t[1])/2-r)/o,(this.#a+(t[0]-e[0])/2-n)/s,(this.#l+(t[1]-e[1])/2-r)/o]}add({x:e,y:t}){this.#a=e,this.#l=t;let[n,r,s,o]=this.#e,[a,l,c,d]=this.#s.subarray(8,12),u=e-c,h=t-d,f=Math.hypot(u,h);if(f<this.#u)return!1;let p=f-this.#c,v=p/f,g=v*u,m=v*h,y=a,w=l;a=c,l=d,c+=g,d+=m,this.#h?.push(e,t);let A=-m/p,C=g/p,E=A*this.#o,T=C*this.#o;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([c+E,d+T],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([c-E,d-T],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([a+E,l+T],2),this.#r.push(NaN,NaN,NaN,NaN,(a+E-n)/s,(l+T-r)/o),this.#s.set([a-E,l-T],14),this.#t.push(NaN,NaN,NaN,NaN,(a-E-n)/s,(l-T-r)/o)),this.#s.set([y,w,a,l,c,d],6),!this.isEmpty()):(this.#s.set([y,w,a,l,c,d],6),Math.abs(Math.atan2(w-l,y-a)-Math.atan2(m,g))<Math.PI/2?([a,l,c,d]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((a+c)/2-n)/s,((l+d)/2-r)/o),[a,l,y,w]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((y+a)/2-n)/s,((w+l)/2-r)/o),!0):([y,w,a,l,c,d]=this.#s.subarray(0,6),this.#r.push(((y+5*a)/6-n)/s,((w+5*l)/6-r)/o,((5*a+c)/6-n)/s,((5*l+d)/6-r)/o,((a+c)/2-n)/s,((l+d)/2-r)/o),[c,d,a,l,y,w]=this.#s.subarray(12,18),this.#t.push(((y+5*a)/6-n)/s,((w+5*l)/6-r)/o,((5*a+c)/6-n)/s,((5*l+d)/6-r)/o,((a+c)/2-n)/s,((l+d)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#r,t=this.#t,n=this.#s.subarray(4,6),r=this.#s.subarray(16,18),[s,o,a,l]=this.#e,[c,d,u,h]=this.#v();if(isNaN(this.#s[6])&&!this.isEmpty())return`M${(this.#s[2]-s)/a} ${(this.#s[3]-o)/l} L${(this.#s[4]-s)/a} ${(this.#s[5]-o)/l} L${c} ${d} L${u} ${h} L${(this.#s[16]-s)/a} ${(this.#s[17]-o)/l} L${(this.#s[14]-s)/a} ${(this.#s[15]-o)/l} Z`;let f=[];f.push(`M${e[4]} ${e[5]}`);for(let p=6;p<e.length;p+=6)isNaN(e[p])?f.push(`L${e[p+4]} ${e[p+5]}`):f.push(`C${e[p]} ${e[p+1]} ${e[p+2]} ${e[p+3]} ${e[p+4]} ${e[p+5]}`);f.push(`L${(n[0]-s)/a} ${(n[1]-o)/l} L${c} ${d} L${u} ${h} L${(r[0]-s)/a} ${(r[1]-o)/l}`);for(let p=t.length-6;p>=6;p-=6)isNaN(t[p])?f.push(`L${t[p+4]} ${t[p+5]}`):f.push(`C${t[p]} ${t[p+1]} ${t[p+2]} ${t[p+3]} ${t[p+4]} ${t[p+5]}`);return f.push(`L${t[4]} ${t[5]} Z`),f.join(" ")}getOutlines(){let e=this.#r,t=this.#t,n=this.#s,r=n.subarray(4,6),s=n.subarray(16,18),[o,a,l,c]=this.#e,d=new Float64Array((this.#h?.length??0)+2);for(let m=0,y=d.length-2;m<y;m+=2)d[m]=(this.#h[m]-o)/l,d[m+1]=(this.#h[m+1]-a)/c;d[d.length-2]=(this.#a-o)/l,d[d.length-1]=(this.#l-a)/c;let[u,h,f,p]=this.#v();if(isNaN(n[6])&&!this.isEmpty()){let m=new Float64Array(36);return m.set([NaN,NaN,NaN,NaN,(n[2]-o)/l,(n[3]-a)/c,NaN,NaN,NaN,NaN,(n[4]-o)/l,(n[5]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(n[16]-o)/l,(n[17]-a)/c,NaN,NaN,NaN,NaN,(n[14]-o)/l,(n[15]-a)/c],0),new xf(m,d,this.#e,this.#d,this.#n,this.#i)}let v=new Float64Array(this.#r.length+24+this.#t.length),g=e.length;for(let m=0;m<g;m+=2){if(isNaN(e[m])){v[m]=v[m+1]=NaN;continue}v[m]=e[m],v[m+1]=e[m+1]}v.set([NaN,NaN,NaN,NaN,(r[0]-o)/l,(r[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-o)/l,(s[1]-a)/c],g),g+=24;for(let m=t.length-6;m>=6;m-=6)for(let y=0;y<6;y+=2){if(isNaN(t[m+y])){v[g]=v[g+1]=NaN,g+=2;continue}v[g]=t[m+y],v[g+1]=t[m+y+1],g+=2}return v.set([NaN,NaN,NaN,NaN,t[4],t[5]],g),new xf(v,d,this.#e,this.#d,this.#n,this.#i)}},xf=class extends Cv{#e;#t=null;#n;#i;#r;#s;#a;constructor(e,t,n,r,s,o){super(),this.#a=e,this.#r=t,this.#e=n,this.#s=r,this.#n=s,this.#i=o,this.#c(o);let{x:a,y:l,width:c,height:d}=this.#t;for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-a)/c,e[u+1]=(e[u+1]-l)/d;for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-a)/c,t[u+1]=(t[u+1]-l)/d}toSVGPath(){let e=[`M${this.#a[4]} ${this.#a[5]}`];for(let t=6,n=this.#a.length;t<n;t+=6){if(isNaN(this.#a[t])){e.push(`L${this.#a[t+4]} ${this.#a[t+5]}`);continue}e.push(`C${this.#a[t]} ${this.#a[t+1]} ${this.#a[t+2]} ${this.#a[t+3]} ${this.#a[t+4]} ${this.#a[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,r],s){let o=n-e,a=r-t,l,c;switch(s){case 0:l=this.#l(this.#a,e,r,o,-a),c=this.#l(this.#r,e,r,o,-a);break;case 90:l=this.#u(this.#a,e,t,o,a),c=this.#u(this.#r,e,t,o,a);break;case 180:l=this.#l(this.#a,n,t,-o,a),c=this.#l(this.#r,n,t,-o,a);break;case 270:l=this.#u(this.#a,n,r,-o,-a),c=this.#u(this.#r,n,r,-o,-a);break}return{outline:Array.from(l),points:[Array.from(c)]}}#l(e,t,n,r,s){let o=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*r,o[a+1]=n+e[a+1]*s;return o}#u(e,t,n,r,s){let o=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*r,o[a+1]=n+e[a]*s;return o}#c(e){let t=this.#a,n=t[4],r=t[5],s=n,o=r,a=n,l=r,c=n,d=r,u=e?Math.max:Math.min;for(let g=6,m=t.length;g<m;g+=6){if(isNaN(t[g]))s=Math.min(s,t[g+4]),o=Math.min(o,t[g+5]),a=Math.max(a,t[g+4]),l=Math.max(l,t[g+5]),d<t[g+5]?(c=t[g+4],d=t[g+5]):d===t[g+5]&&(c=u(c,t[g+4]));else{let y=qe.bezierBoundingBox(n,r,...t.slice(g,g+6));s=Math.min(s,y[0]),o=Math.min(o,y[1]),a=Math.max(a,y[2]),l=Math.max(l,y[3]),d<y[3]?(c=y[2],d=y[3]):d===y[3]&&(c=u(c,y[2]))}n=t[g+4],r=t[g+5]}let h=s-this.#n,f=o-this.#n,p=a-s+2*this.#n,v=l-o+2*this.#n;this.#t={x:h,y:f,width:p,height:v,lastPoint:[c,d]}}get box(){return this.#t}getNewOutline(e,t){let{x:n,y:r,width:s,height:o}=this.#t,[a,l,c,d]=this.#e,u=s*c,h=o*d,f=n*c+a,p=r*d+l,v=new Mv({x:this.#r[0]*u+f,y:this.#r[1]*h+p},this.#e,this.#s,e,this.#i,t??this.#n);for(let g=2;g<this.#r.length;g+=2)v.add({x:this.#r[g]*u+f,y:this.#r[g+1]*h+p});return v.getOutlines()}},Tv=class i{#e=this.#f.bind(this);#t=this.#v.bind(this);#n=null;#i=null;#r;#s=null;#a=!1;#l=!1;#u=null;#c;#d=null;#o;static get _keyboardManager(){return qt(this,"_keyboardManager",new Xl([[["Escape","mac+Escape"],i.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],i.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],i.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],i.prototype._moveToPrevious],[["Home","mac+Home"],i.prototype._moveToBeginning],[["End","mac+End"],i.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#l=!1,this.#o=mt.HIGHLIGHT_COLOR,this.#u=e):(this.#l=!0,this.#o=mt.HIGHLIGHT_DEFAULT_COLOR),this.#d=e?._uiManager||t,this.#c=this.#d._eventBus,this.#r=e?.color||this.#d?.highlightColors.values().next().value||"#FFFF98"}renderButton(){let e=this.#n=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#d._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#e,{signal:t});let n=this.#i=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#r,e.append(n),e}renderMainDropdown(){let e=this.#s=this.#h();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#h(){let e=document.createElement("div"),t=this.#d._signal;e.addEventListener("contextmenu",Gr,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[n,r]of this.#d.highlightColors){let s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=n,s.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${n}`);let o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=r,s.setAttribute("aria-selected",r===this.#r),s.addEventListener("click",this.#p.bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#e,{signal:t}),e}#p(e,t){t.stopPropagation(),this.#c.dispatch("switchannotationeditorparams",{source:this,type:this.#o,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#n){this.#m(e);return}let t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#g){this.#m(e);return}if(e.target===this.#n){this.#s.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#s?.firstChild||e.target===this.#n){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#m(e);return}this.#s.firstChild?.focus()}_moveToEnd(e){if(!this.#g){this.#m(e);return}this.#s.lastChild?.focus()}#f(e){i._keyboardManager.exec(this,e)}#m(e){if(this.#g){this.hideDropdown();return}if(this.#a=e.detail===0,window.addEventListener("pointerdown",this.#t,{signal:this.#d._signal}),this.#s){this.#s.classList.remove("hidden");return}let t=this.#s=this.#h();this.#n.append(t)}#v(e){this.#s?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),window.removeEventListener("pointerdown",this.#t)}get#g(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#l){if(!this.#g){this.#u?.unselect();return}this.hideDropdown(),this.#n.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#i&&(this.#i.style.backgroundColor=e),!this.#s)return;let t=this.#d.highlightColors.values();for(let n of this.#s.children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s?.remove(),this.#s=null}},Iv=class i extends nn{#e=null;#t=0;#n;#i=null;#r=null;#s=null;#a=null;#l=0;#u=null;#c=null;#d=null;#o=!1;#h=null;#p;#f=null;#m="";#v;#g="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _l10nPromise;static _type="highlight";static _editorType=zt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=i.prototype;return qt(this,"_keyboardManager",new Xl([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(Ge(re({},e),{name:"highlightEditor"})),this.color=e.color||i._defaultColor,this.#v=e.thickness||i._defaultThickness,this.#p=e.opacity||i._defaultOpacity,this.#n=e.boxes||null,this.#g=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#o=!0,this.#y(e),this.#M()):(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#a=e.focusNode,this.#l=e.focusOffset,this.#x(),this.#M(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#o?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#v,methodOfCreation:this.#g}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#x(){let e=new Ev(this.#n,.001);this.#c=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#c.box;let t=new Ev(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();let{lastPoint:n}=this.#s.box;this.#h=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#y({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#c=e;let r=1.5;if(this.#s=e.getNewOutline(this.#v/2+r,.0025),t>=0)this.#d=t,this.#i=n,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.highlightOutline(this.#s);else if(this.parent){let d=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#d,e),this.parent.drawLayer.updateBox(this.#d,i.#_(this.#c.box,(d-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#s),this.parent.drawLayer.updateBox(this.#f,i.#_(this.#s.box,d))}let{x:s,y:o,width:a,height:l}=e.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=a,this.height=l;break;case 90:{let[d,u]=this.parentDimensions;this.x=o,this.y=1-s,this.width=a*u/d,this.height=l*d/u;break}case 180:this.x=1-s,this.y=1-o,this.width=a,this.height=l;break;case 270:{let[d,u]=this.parentDimensions;this.x=1-o,this.y=s,this.width=a*u/d,this.height=l*d/u;break}}let{lastPoint:c}=this.#s.box;this.#h=[(c[0]-s)/a,(c[1]-o)/l]}static initialize(e,t){nn.initialize(e,t),i._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case mt.HIGHLIGHT_DEFAULT_COLOR:i._defaultColor=t;break;case mt.HIGHLIGHT_THICKNESS:i._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#h}updateParams(e,t){switch(e){case mt.HIGHLIGHT_COLOR:this.#A(t);break;case mt.HIGHLIGHT_THICKNESS:this.#b(t);break}}static get defaultPropertiesToUpdate(){return[[mt.HIGHLIGHT_DEFAULT_COLOR,i._defaultColor],[mt.HIGHLIGHT_THICKNESS,i._defaultThickness]]}get propertiesToUpdate(){return[[mt.HIGHLIGHT_COLOR,this.color||i._defaultColor],[mt.HIGHLIGHT_THICKNESS,this.#v||i._defaultThickness],[mt.HIGHLIGHT_FREE,this.#o]]}#A(e){let t=r=>{this.color=r,this.parent?.drawLayer.changeColor(this.#d,r),this.#r?.updateColor(r)},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#b(e){let t=this.#v,n=r=>{this.#v=r,this.#S(r)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}addEditToolbar(){return ce(this,null,function*(){let e=yield YC(i.prototype,this,"addEditToolbar").call(this);return e?(this._uiManager.highlightColors&&(this.#r=new Tv({editor:this}),e.addColorPicker(this.#r)),e):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#D(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#M(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#D():e&&(this.#M(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#o)return;this.#y({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#D(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#M(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=e.drawLayer.highlight(this.#c,this.color,this.#p),this.#f=e.drawLayer.highlightOutline(this.#s),this.#u&&(this.#u.style.clipPath=this.#i))}static#_({x:e,y:t,width:n,height:r},s){switch(s){case 90:return{x:1-t-r,y:e,width:r,height:n};case 180:return{x:1-e-n,y:1-t-r,width:n,height:r};case 270:return{x:t,y:1-e-n,width:r,height:n}}return{x:e,y:t,width:n,height:r}}rotate(e){let{drawLayer:t}=this.parent,n;this.#o?(e=(e-this.rotation+360)%360,n=i.#_(this.#c.box,e)):n=i.#_(this,e),t.rotate(this.#d,e),t.rotate(this.#f,e),t.updateBox(this.#d,n),t.updateBox(this.#f,i.#_(this.#s.box,e))}render(){if(this.div)return this.div;let e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#o?e.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});let t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;let[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),lv(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.parent.drawLayer.removeClass(this.#f,"hovered")}#T(e){i._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(e){if(!this.#e)return;let t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#a,this.#l)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#o||this.#C(!1))}get _mustFixPosition(){return!this.#o}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#d,e),this.parent.drawLayer.show(this.#f,e))}#P(){return this.#o?this.rotation:0}#k(){if(this.#o)return null;let[e,t]=this.pageDimensions,[n,r]=this.pageTranslation,s=this.#n,o=new Float32Array(s.length*8),a=0;for(let{x:l,y:c,width:d,height:u}of s){let h=l*e+n,f=(1-c-u)*t+r;o[a]=o[a+4]=h,o[a+1]=o[a+3]=f,o[a+2]=o[a+6]=h+d*e,o[a+5]=o[a+7]=f+u*t,a+=8}return o}#E(e){return this.#c.serialize(e,this.#P())}static startHighlighting(e,t,{target:n,x:r,y:s}){let{x:o,y:a,width:l,height:c}=n.getBoundingClientRect(),d=new AbortController,u=e.combinedSignal(d),h=p=>{p.preventDefault(),p.stopPropagation()},f=p=>{d.abort(),this.#I(e,p)};window.addEventListener("blur",f,{signal:u}),window.addEventListener("pointerup",f,{signal:u}),window.addEventListener("pointerdown",h,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",Gr,{signal:u}),n.addEventListener("pointermove",this.#w.bind(this,e),{signal:u}),this._freeHighlight=new Mv({x:r,y:s},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#w(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#I(e,t){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,n){let r=super.deserialize(e,t,n),{rect:[s,o,a,l],color:c,quadPoints:d}=e;r.color=qe.makeHexColor(...c),r.#p=e.opacity;let[u,h]=r.pageDimensions;r.width=(a-s)/u,r.height=(l-o)/h;let f=r.#n=[];for(let p=0;p<d.length;p+=8)f.push({x:(d[4]-a)/u,y:(l-(1-d[p+5]))/h,width:(d[p+2]-d[p])/u,height:(d[p+5]-d[p+1])/h});return r.#x(),r}serialize(e=!1){if(this.isEmpty()||e)return null;let t=this.getRect(0,0),n=nn._colorManager.convert(this.color);return{annotationType:zt.HIGHLIGHT,color:n,opacity:this.#p,thickness:this.#v,quadPoints:this.#k(),outlines:this.#E(t),pageIndex:this.pageIndex,rect:t,rotation:this.#P(),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}},HE=class i extends nn{#e=0;#t=0;#n=null;#i=new Path2D;#r=!1;#s=null;#a=!1;#l=!1;#u=null;#c=null;#d=0;#o=0;#h=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=zt.INK;constructor(e){super(Ge(re({},e),{name:"inkEditor"})),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){nn.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case mt.INK_THICKNESS:i._defaultThickness=t;break;case mt.INK_COLOR:i._defaultColor=t;break;case mt.INK_OPACITY:i._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case mt.INK_THICKNESS:this.#p(t);break;case mt.INK_COLOR:this.#f(t);break;case mt.INK_OPACITY:this.#m(t);break}}static get defaultPropertiesToUpdate(){return[[mt.INK_THICKNESS,i._defaultThickness],[mt.INK_COLOR,i._defaultColor||nn._defaultLineColor],[mt.INK_OPACITY,Math.round(i._defaultOpacity*100)]]}get propertiesToUpdate(){return[[mt.INK_THICKNESS,this.thickness||i._defaultThickness],[mt.INK_COLOR,this.color||i._defaultColor||nn._defaultLineColor],[mt.INK_OPACITY,Math.round(100*(this.opacity??i._defaultOpacity))]]}#p(e){let t=r=>{this.thickness=r,this.#U()},n=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#f(e){let t=r=>{this.color=r,this.#_()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#m(e){let t=r=>{this.opacity=r,this.#_()};e/=100;let n=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#k(),this.#E()),this.isAttachedToDOM||(this.parent.add(this),this.#w()),this.#U()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#u?.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){let[e,t]=this.parentDimensions,n=this.width*e,r=this.height*t;this.setDimensions(n,r)}enableEditMode(){this.#r||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#T())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#C())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#v(){let{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#g(){let{ctx:e,color:t,opacity:n,thickness:r,parentScale:s,scaleFactor:o}=this;e.lineWidth=r*s/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${GX(n)}`}#x(e,t){this.canvas.addEventListener("contextmenu",Gr,{signal:this._uiManager._signal}),this.#C(),this.#s=new AbortController;let n=this._uiManager.combinedSignal(this.#s);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,this.#l||(this.#l=!0,this.#w(),this.thickness||=i._defaultThickness,this.color||=i._defaultColor||nn._defaultLineColor,this.opacity??=i._defaultOpacity),this.currentPath.push([e,t]),this.#a=!1,this.#g(),this.#h=()=>{this.#S(),this.#h&&window.requestAnimationFrame(this.#h)},window.requestAnimationFrame(this.#h)}#y(e,t){let[n,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===r)return;let s=this.currentPath,o=this.#i;if(s.push([e,t]),this.#a=!0,s.length<=2){o.moveTo(...s[0]),o.lineTo(e,t);return}s.length===3&&(this.#i=o=new Path2D,o.moveTo(...s[0])),this.#D(o,...s.at(-3),...s.at(-2),e,t)}#A(){if(this.currentPath.length===0)return;let e=this.currentPath.at(-1);this.#i.lineTo(...e)}#b(e,t){this.#h=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#y(e,t),this.#A();let n;if(this.currentPath.length!==1)n=this.#M();else{let l=[e,t];n=[[l,l.slice(),l.slice(),l]]}let r=this.#i,s=this.currentPath;this.currentPath=[],this.#i=new Path2D;let o=()=>{this.allRawPaths.push(s),this.paths.push(n),this.bezierPath2D.push(r),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#k(),this.#E()),this.#U())};this.addCommands({cmd:o,undo:a,mustExec:!0})}#S(){if(!this.#a)return;this.#a=!1;let e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),n=t.map(d=>d[0]),r=t.map(d=>d[1]),s=Math.min(...n)-e,o=Math.max(...n)+e,a=Math.min(...r)-e,l=Math.max(...r)+e,{ctx:c}=this;c.save(),c.clearRect(0,0,this.canvas.width,this.canvas.height);for(let d of this.bezierPath2D)c.stroke(d);c.stroke(this.#i),c.restore()}#D(e,t,n,r,s,o,a){let l=(t+r)/2,c=(n+s)/2,d=(r+o)/2,u=(s+a)/2;e.bezierCurveTo(l+2*(r-l)/3,c+2*(s-c)/3,d+2*(r-d)/3,u+2*(s-u)/3,d,u)}#M(){let e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];let t=[],n,[r,s]=e[0];for(n=1;n<e.length-2;n++){let[h,f]=e[n],[p,v]=e[n+1],g=(h+p)/2,m=(f+v)/2,y=[r+2*(h-r)/3,s+2*(f-s)/3],w=[g+2*(h-g)/3,m+2*(f-m)/3];t.push([[r,s],y,w,[g,m]]),[r,s]=[g,m]}let[o,a]=e[n],[l,c]=e[n+1],d=[r+2*(o-r)/3,s+2*(a-s)/3],u=[l+2*(o-l)/3,c+2*(a-c)/3];return t.push([[r,s],d,u,[l,c]]),t}#_(){if(this.isEmpty()){this.#R();return}this.#g();let{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#R();for(let n of this.bezierPath2D)t.stroke(n)}commit(){this.#r||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#r=!0,this.div.classList.add("disabled"),this.#U(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#T(){if(this.#c)return;this.#c=new AbortController;let e=this._uiManager.combinedSignal(this.#c);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#C(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#r||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#x(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#y(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#P(e)}canvasPointerleave(e){this.#P(e)}#P(e){this.#s?.abort(),this.#s=null,this.#T(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",Gr)},10),this.#b(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#k(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#E(){this.#u=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#u.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#u?.disconnect(),this.#u=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#r}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");let[n,r,s,o]=this.#v();if(this.setAt(n,r,0,0),this.setDims(s,o),this.#k(),this.width){let[a,l]=this.parentDimensions;this.setAspectRatio(this.width*a,this.height*l),this.setAt(e*a,t*l,this.width*a,this.height*l),this.#l=!0,this.#w(),this.setDims(this.width*a,this.height*l),this.#_(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#E(),this.div}#w(){if(!this.#l)return;let[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#R()}setDimensions(e,t){let n=Math.round(e),r=Math.round(t);if(this.#d===n&&this.#o===r)return;this.#d=n,this.#o=r,this.canvas.style.visibility="hidden";let[s,o]=this.parentDimensions;this.width=e/s,this.height=t/o,this.fixAndSetPosition(),this.#r&&this.#I(e,t),this.#w(),this.#_(),this.canvas.style.visibility="visible",this.fixDims()}#I(e,t){let n=this.#B(),r=(e-n)/this.#t,s=(t-n)/this.#e;this.scaleFactor=Math.min(r,s)}#R(){let e=this.#B()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#F(e){let t=new Path2D;for(let n=0,r=e.length;n<r;n++){let[s,o,a,l]=e[n];n===0&&t.moveTo(...s),t.bezierCurveTo(o[0],o[1],a[0],a[1],l[0],l[1])}return t}static#H(e,t,n){let[r,s,o,a]=t;switch(n){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]+=r,e[l+1]=a-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=e[l+1]+r,e[l+1]=d+s}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=o-e[l],e[l+1]+=s;break;case 270:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=o-e[l+1],e[l+1]=a-d}break;default:throw new Error("Invalid rotation")}return e}static#V(e,t,n){let[r,s,o,a]=t;switch(n){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]-=r,e[l+1]=a-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=e[l+1]-s,e[l+1]=d-r}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=o-e[l],e[l+1]-=s;break;case 270:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=a-e[l+1],e[l+1]=o-d}break;default:throw new Error("Invalid rotation")}return e}#N(e,t,n,r){let s=[],o=this.thickness/2,a=e*t+o,l=e*n+o;for(let c of this.paths){let d=[],u=[];for(let h=0,f=c.length;h<f;h++){let[p,v,g,m]=c[h];if(p[0]===m[0]&&p[1]===m[1]&&f===1){let _=e*p[0]+a,P=e*p[1]+l;d.push(_,P),u.push(_,P);break}let y=e*p[0]+a,w=e*p[1]+l,A=e*v[0]+a,C=e*v[1]+l,E=e*g[0]+a,T=e*g[1]+l,L=e*m[0]+a,S=e*m[1]+l;h===0&&(d.push(y,w),u.push(y,w)),d.push(A,C,E,T,L,S),u.push(A,C),h===f-1&&u.push(L,S)}s.push({bezier:i.#H(d,r,this.rotation),points:i.#H(u,r,this.rotation)})}return s}#O(){let e=1/0,t=-1/0,n=1/0,r=-1/0;for(let s of this.paths)for(let[o,a,l,c]of s){let d=qe.bezierBoundingBox(...o,...a,...l,...c);e=Math.min(e,d[0]),n=Math.min(n,d[1]),t=Math.max(t,d[2]),r=Math.max(r,d[3])}return[e,n,t,r]}#B(){return this.#r?Math.ceil(this.thickness*this.parentScale):0}#U(e=!1){if(this.isEmpty())return;if(!this.#r){this.#_();return}let t=this.#O(),n=this.#B();this.#t=Math.max(nn.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(nn.MIN_SIZE,t[3]-t[1]);let r=Math.ceil(n+this.#t*this.scaleFactor),s=Math.ceil(n+this.#e*this.scaleFactor),[o,a]=this.parentDimensions;this.width=r/o,this.height=s/a,this.setAspectRatio(r,s);let l=this.translationX,c=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#w(),this.#_(),this.#d=r,this.#o=s,this.setDims(r,s);let d=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-d,c-this.translationY-d)}static deserialize(e,t,n){if(e instanceof _v)return null;let r=super.deserialize(e,t,n);r.thickness=e.thickness,r.color=qe.makeHexColor(...e.color),r.opacity=e.opacity;let[s,o]=r.pageDimensions,a=r.width*s,l=r.height*o,c=r.parentScale,d=e.thickness/2;r.#r=!0,r.#d=Math.round(a),r.#o=Math.round(l);let{paths:u,rect:h,rotation:f}=e;for(let{bezier:v}of u){v=i.#V(v,h,f);let g=[];r.paths.push(g);let m=c*(v[0]-d),y=c*(v[1]-d);for(let A=2,C=v.length;A<C;A+=6){let E=c*(v[A]-d),T=c*(v[A+1]-d),L=c*(v[A+2]-d),S=c*(v[A+3]-d),_=c*(v[A+4]-d),P=c*(v[A+5]-d);g.push([[m,y],[E,T],[L,S],[_,P]]),m=_,y=P}let w=this.#F(g);r.bezierPath2D.push(w)}let p=r.#O();return r.#t=Math.max(nn.MIN_SIZE,p[2]-p[0]),r.#e=Math.max(nn.MIN_SIZE,p[3]-p[1]),r.#I(a,l),r}serialize(){if(this.isEmpty())return null;let e=this.getRect(0,0),t=nn._colorManager.convert(this.ctx.strokeStyle);return{annotationType:zt.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#N(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}},zE=class i extends nn{#e=null;#t=null;#n=null;#i=null;#r=null;#s="";#a=null;#l=null;#u=null;#c=!1;#d=!1;static _type="stamp";static _editorType=zt.STAMP;constructor(e){super(Ge(re({},e),{name:"stampEditor"})),this.#i=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){nn.initialize(e,t)}static get supportedTypes(){return qt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return qt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(zt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#o(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#c=e.isSvg),e.file&&(this.#s=e.file.name),this.#f()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}mlGuessAltText(e=null,t=!0){return ce(this,null,function*(){if(this.hasAltTextData())return null;let{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!(yield n.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");let{data:r,width:s,height:o}=e||this.copyCanvas(null,!0).imageData,a=yield n.guess({name:"altText",request:{data:r,width:s,height:o,channels:r.length/(s*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");let l=a.output;return yield this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l})}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#o(n,!0)).finally(()=>this.#h());return}if(this.#i){let n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#o(r)).finally(()=>this.#h());return}if(this.#r){let n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(r=>this.#o(r)).finally(()=>this.#h());return}let e=document.createElement("input");e.type="file",e.accept=i.supportedTypesStr;let t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",()=>ce(this,null,function*(){if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let r=yield this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#o(r)}n()}),{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#h()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#a?.remove(),this.#a=null,this.#l?.disconnect(),this.#l=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#a===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#e?this.#f():this.#p(),this.width){let[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r)}return this.div}#f(){let{div:e}=this,{width:t,height:n}=this.#e,[r,s]=this.pageDimensions,o=.75;if(this.width)t=this.width*r,n=this.height*s;else if(t>o*r||n>o*s){let d=Math.min(o*r/t,o*s/n);t*=d,n*=d}let[a,l]=this.parentDimensions;this.setDims(t*a/r,n*l/s),this._uiManager.enableWaiting(!1);let c=this.#a=document.createElement("canvas");e.append(c),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow)&&(e.hidden=!1),this.#g(t,n),this.#y(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&c.setAttribute("aria-label",this.#s)}copyCanvas(e,t=!1){e||(e=224);let{width:n,height:r}=this.#e,s=document.createElement("canvas"),o=this.#e,a=n,l=r;if(n>e||r>e){let v=Math.min(e/n,e/r);a=Math.floor(n*v),l=Math.floor(r*v),this.#c||(o=this.#v(a,l))}s.width=a,s.height=l;let c=s.getContext("2d");c.filter=this._uiManager.hcmFilter;let d="white",u="#cfcfd8";this._uiManager.hcmFilter!=="none"?u="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(d="#8f8f9d",u="#42414d");let h=15,f=new OffscreenCanvas(h*2,h*2),p=f.getContext("2d");if(p.fillStyle=d,p.fillRect(0,0,h*2,h*2),p.fillStyle=u,p.fillRect(0,0,h,h),p.fillRect(h,h,h,h),c.fillStyle=c.createPattern(f,"repeat"),c.fillRect(0,0,a,l),t){let v=new OffscreenCanvas(a,l),g=v.getContext("2d",{willReadFrequently:!0});g.drawImage(o,0,0,o.width,o.height,0,0,a,l);let m=g.getImageData(0,0,a,l).data;return c.drawImage(v,0,0),{canvas:s,imageData:{width:a,height:l,data:m}}}return c.drawImage(o,0,0,o.width,o.height,0,0,a,l),{canvas:s,imageData:null}}#m(e,t){let[n,r]=this.parentDimensions;this.width=e/n,this.height=t/r,this.setDims(e,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#u!==null&&clearTimeout(this.#u);let s=200;this.#u=setTimeout(()=>{this.#u=null,this.#g(e,t)},s)}#v(e,t){let{width:n,height:r}=this.#e,s=n,o=r,a=this.#e;for(;s>2*e||o>2*t;){let l=s,c=o;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));let d=new OffscreenCanvas(s,o);d.getContext("2d").drawImage(a,0,0,l,c,0,0,s,o),a=d.transferToImageBitmap()}return a}#g(e,t){e=Math.ceil(e),t=Math.ceil(t);let n=this.#a;if(!n||n.width===e&&n.height===t)return;n.width=e,n.height=t;let r=this.#c?this.#e:this.#v(e,t),s=n.getContext("2d");s.filter=this._uiManager.hcmFilter,s.drawImage(r,0,0,r.width,r.height,0,0,e,t)}getImageForAltText(){return this.#a}#x(e){if(e){if(this.#c){let r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#c){let[t,n]=this.pageDimensions,r=Math.round(this.width*t*Wa.PDF_TO_CSS_UNITS),s=Math.round(this.height*n*Wa.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,s);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,s),o.transferToImageBitmap()}return structuredClone(this.#e)}#y(){this._uiManager._signal&&(this.#l=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.#m(t.width,t.height)}),this.#l.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#l?.disconnect(),this.#l=null},{once:!0}))}static deserialize(e,t,n){if(e instanceof Sv)return null;let r=super.deserialize(e,t,n),{rect:s,bitmapUrl:o,bitmapId:a,isSvg:l,accessibilityData:c}=e;a&&n.imageManager.isValidId(a)?r.#t=a:r.#i=o,r.#c=l;let[d,u]=r.pageDimensions;return r.width=(s[2]-s[0])/d,r.height=(s[3]-s[1])/u,c&&(r.altTextData=c),r}serialize(e=!1,t=null){if(this.isEmpty())return null;let n={annotationType:zt.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#x(!0),n.accessibilityData=this.serializeAltText(!0),n;let{decorative:r,altText:s}=this.serializeAltText(!1);if(!r&&s&&(n.accessibilityData={type:"Figure",alt:s}),t===null)return n;t.stamps||=new Map;let o=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:n}),n.bitmap=this.#x(!1);else if(this.#c){let a=t.stamps.get(this.#t);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#x(!1))}return n}},yY=(()=>{class i{#e;#t=!1;#n=null;#i=null;#r=null;#s=new Map;#a=!1;#l=!1;#u=!1;#c=null;#d=null;#o;static _initialized=!1;static#h=new Map([VE,HE,zE,Iv].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:n,div:r,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:d}){let u=[...i.#h.values()];if(!i._initialized){i._initialized=!0;for(let h of u)h.initialize(d,t)}t.registerEditorTypes(u),this.#o=t,this.pageIndex=n,this.div=r,this.#e=s,this.#n=o,this.viewport=c,this.#c=l,this.drawLayer=a,this.#o.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===zt.NONE}updateToolbar(t){this.#o.updateToolbar(t)}updateMode(t=this.#o.getMode()){switch(this.#g(),t){case zt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case zt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case zt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:n}=this.div;for(let r of i.#h.values())n.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#c?.div}addInkEditorIfNeeded(t){if(this.#o.getMode()!==zt.INK)return;if(!t){for(let r of this.#s.values())if(r.isEmpty()){r.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#o.setEditingState(t)}addCommands(t){this.#o.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let r of this.#s.values())r.enableEditing(),r.show(!0),r.annotationElementId&&(this.#o.removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!this.#n)return;let n=this.#n.getEditableAnnotations();for(let r of n){if(r.hide(),this.#o.isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;let s=this.deserialize(r);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){this.#u=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,n=new Map;for(let s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else n.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){let s=this.#n.getEditableAnnotations();for(let o of s){let{id:a}=o.data;if(this.#o.isDeletedAnnotationElement(a))continue;let l=n.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=t.get(a),l&&(this.#o.addChangedExistingAnnotation(l),l.renderAnnotationElement(o),l.show(!1)),o.show()}}this.#g(),this.isEmpty&&(this.div.hidden=!0);let{classList:r}=this.div;for(let s of i.#h.values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#u=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#o.getActive()!==t&&this.#o.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#c?.div&&!this.#d){this.#d=new AbortController;let t=this.#o.combinedSignal(this.#d);this.#c.div.addEventListener("pointerdown",this.#p.bind(this),{signal:t}),this.#c.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#c?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#c.div.classList.remove("highlighting"))}#p(t){this.#o.unselectAll();let{target:n}=t;if(n===this.#c.div||n.classList.contains("endOfContent")&&this.#c.div.contains(n)){let{isMac:r}=Di.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#o.showAllEditors("highlight",!0,!0),this.#c.div.classList.add("free"),this.toggleDrawing(),Iv.startHighlighting(this,this.#o.direction==="ltr",t),this.#c.div.addEventListener("pointerup",()=>{this.#c.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#o._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;let t=this.#o.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);let{annotationElementId:n}=t;n&&this.#o.isDeletedAnnotationElement(n)&&this.#o.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv),!this.#u&&t.annotationElementId&&this.#o.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#o.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#o.addDeletedAnnotationElement(t.annotationElementId),nn.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#o.addEditor(t),this.attach(t),!t.isAttachedToDOM){let n=t.render();this.div.append(n),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#o.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:n}=document;t.div.contains(n)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#o._signal}),n.focus())},0)),t._structTreeParentId=this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let n=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:n,undo:r,mustExec:!1})}getNextId(){return this.#o.getId()}get#f(){return i.#h.get(this.#o.getMode())}combinedSignal(t){return this.#o.combinedSignal(t)}#m(t){let n=this.#f;return n?new n.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(t,n){this.#o.updateToolbar(t),this.#o.updateMode(t);let{offsetX:r,offsetY:s}=this.#v(),o=this.getNextId(),a=this.#m(re({parent:this,id:o,x:r,y:s,uiManager:this.#o,isCentered:!0},n));a&&this.add(a)}deserialize(t){return i.#h.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#o)||null}createAndAddNewEditor(t,n,r={}){let s=this.getNextId(),o=this.#m(re({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#o,isCentered:n},r));return o&&this.add(o),o}#v(){let{x:t,y:n,width:r,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,t),a=Math.max(0,n),l=Math.min(window.innerWidth,t+r),c=Math.min(window.innerHeight,n+s),d=(o+l)/2-t,u=(a+c)/2-n,[h,f]=this.viewport.rotation%180===0?[d,u]:[u,d];return{offsetX:h,offsetY:f}}addNewEditor(){this.createAndAddNewEditor(this.#v(),!0)}setSelected(t){this.#o.setSelected(t)}toggleSelected(t){this.#o.toggleSelected(t)}isSelected(t){return this.#o.isSelected(t)}unselect(t){this.#o.unselect(t)}pointerup(t){let{isMac:n}=Di.platform;if(!(t.button!==0||t.ctrlKey&&n)&&t.target===this.div&&this.#a){if(this.#a=!1,!this.#t){this.#t=!0;return}if(this.#o.getMode()===zt.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#o.getMode()===zt.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}let{isMac:n}=Di.platform;if(t.button!==0||t.ctrlKey&&n||t.target!==this.div)return;this.#a=!0;let r=this.#o.getActive();this.#t=!r||r.isEmpty()}findNewParent(t,n,r){let s=this.#o.findParent(n,r);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(let t of this.#s.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#o.removeLayer(this)}#g(){this.#l=!0;for(let t of this.#s.values())t.isEmpty()&&t.remove();this.#l=!1}render({viewport:t}){this.viewport=t,Zl(this.div,t);for(let n of this.#o.getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update({viewport:t}){this.#o.commitOrRemove(),this.#g();let n=this.viewport.rotation,r=t.rotation;if(this.viewport=t,Zl(this.div,{rotation:r}),n!==r)for(let s of this.#s.values())s.rotate(r);this.addInkEditorIfNeeded(!1)}get pageDimensions(){let{pageWidth:t,pageHeight:n}=this.viewport.rawDims;return[t,n]}get scale(){return this.#o.viewParameters.realScale}}return i})(),jE=class i{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(let t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return qt(this,"_svgFactory",new cf)}static#r(e,{x:t=0,y:n=0,width:r=1,height:s=1}={}){let{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*s}%`}#s(e){let t=i._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),i.#r(t,e),t}#a(e,t){let n=i._svgFactory.createElement("clipPath");e.append(n);let r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");let s=i._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r}highlight(e,t,n,r=!1){let s=this.#t++,o=this.#s(e.box);o.classList.add("highlight"),e.free&&o.classList.add("free");let a=i._svgFactory.createElement("defs");o.append(a);let l=i._svgFactory.createElement("path");a.append(l);let c=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",c),l.setAttribute("d",e.toSVGPath()),r&&this.#i.set(s,l);let d=this.#a(a,c),u=i._svgFactory.createElement("use");return o.append(u),o.setAttribute("fill",t),o.setAttribute("fill-opacity",n),u.setAttribute("href",`#${c}`),this.#n.set(s,o),{id:s,clipPathId:`url(#${d})`}}highlightOutline(e){let t=this.#t++,n=this.#s(e.box);n.classList.add("highlightOutline");let r=i._svgFactory.createElement("defs");n.append(r);let s=i._svgFactory.createElement("path");r.append(s);let o=`path_p${this.pageIndex}_${t}`;s.setAttribute("id",o),s.setAttribute("d",e.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let a;if(e.free){n.classList.add("free");let d=i._svgFactory.createElement("mask");r.append(d),a=`mask_p${this.pageIndex}_${t}`,d.setAttribute("id",a),d.setAttribute("maskUnits","objectBoundingBox");let u=i._svgFactory.createElement("rect");d.append(u),u.setAttribute("width","1"),u.setAttribute("height","1"),u.setAttribute("fill","white");let h=i._svgFactory.createElement("use");d.append(h),h.setAttribute("href",`#${o}`),h.setAttribute("stroke","none"),h.setAttribute("fill","black"),h.setAttribute("fill-rule","nonzero"),h.classList.add("mask")}let l=i._svgFactory.createElement("use");n.append(l),l.setAttribute("href",`#${o}`),a&&l.setAttribute("mask",`url(#${a})`);let c=l.cloneNode();return n.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.#n.set(t,n),t}finalizeLine(e,t){let n=this.#i.get(e);this.#i.delete(e),this.updateBox(e,t.box),n.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}removeFreeHighlight(e){this.remove(e),this.#i.delete(e)}updatePath(e,t){this.#i.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){i.#r(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}remove(e){this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(let e of this.#n.values())e.remove();this.#n.clear()}};var bY=xt.AbortException,AY=xt.AnnotationEditorLayer,_Y=xt.AnnotationEditorParamsType,t3=xt.AnnotationEditorType,SY=xt.AnnotationEditorUIManager,EY=xt.AnnotationLayer,CY=xt.AnnotationMode,MY=xt.CMapCompressionType,TY=xt.ColorPicker,IY=xt.DOMSVGFactory,DY=xt.DrawLayer,PY=xt.FeatureTest,n3=xt.GlobalWorkerOptions,RY=xt.ImageKind,LY=xt.InvalidPDFException,kY=xt.MissingPDFException,NY=xt.OPS,FY=xt.PDFDataRangeTransport,OY=xt.PDFDateString,BY=xt.PDFWorker,VY=xt.PasswordResponses,UY=xt.PermissionFlag,HY=xt.PixelsPerInch,zY=xt.RenderingCancelledException,jY=xt.TextLayer,GY=xt.UnexpectedResponseException,WY=xt.Util,YE=xt.VerbosityLevel,qY=xt.XfaLayer,ZY=xt.build,XY=xt.createValidAbsoluteUrl,YY=xt.fetchData,i3=xt.getDocument,QY=xt.getFilenameFromUrl,KY=xt.getPdfFilenameFromUrl,JY=xt.getXfaPageViewport,$Y=xt.isDataScheme,eQ=xt.isPdfFile,tQ=xt.noContextMenu,nQ=xt.normalizeUnicode,iQ=xt.setLayerDimensions,rQ=xt.shadow,r3=xt.version;var bf={};bf.d=(i,e)=>{for(var t in e)bf.o(e,t)&&!bf.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};bf.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var In=globalThis.pdfjsViewer={};bf.d(In,{AnnotationLayerBuilder:()=>qv,DownloadManager:()=>dC,EventBus:()=>Zv,FindState:()=>Za,GenericL10n:()=>Qd,LinkTarget:()=>Ql,PDFFindController:()=>lC,PDFHistory:()=>bC,PDFLinkService:()=>Gv,PDFPageView:()=>$v,PDFScriptingManager:()=>DC,PDFSinglePageViewer:()=>LC,PDFViewer:()=>ex,ProgressBar:()=>aC,RenderingStates:()=>Rn,ScrollMode:()=>Zt,SimpleLinkService:()=>_f,SpreadMode:()=>Pi,StructTreeLayerBuilder:()=>Qv,TextLayerBuilder:()=>Kv,XfaLayerBuilder:()=>Jv,parseQueryString:()=>tx});var sQ="auto",B3=1,s3=1.1,oQ=.1,aQ=10,KE=0,lQ=1.25,o3=40,a3=5,Rn={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Zd={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var Ws={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Zt={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Pi={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};var oC=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}};function V3(i,e,t=!1){let n=i.offsetParent;if(!n){console.error("offsetParent is not set -- cannot scroll");return}let r=i.offsetTop+i.clientTop,s=i.offsetLeft+i.clientLeft;for(;n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||t&&(n.classList.contains("markedContent")||getComputedStyle(n).overflow==="hidden");)if(r+=n.offsetTop,s+=n.offsetLeft,n=n.offsetParent,!n)return;e&&(e.top!==void 0&&(r+=e.top),e.left!==void 0&&(s+=e.left,n.scrollLeft=s)),n.scrollTop=r}function cQ(i,e,t=void 0){let n=function(o){s||(s=window.requestAnimationFrame(function(){s=null;let l=i.scrollLeft,c=r.lastX;l!==c&&(r.right=l>c),r.lastX=l;let d=i.scrollTop,u=r.lastY;d!==u&&(r.down=d>u),r.lastY=d,e(r)}))},r={right:!0,down:!0,lastX:i.scrollLeft,lastY:i.scrollTop,_eventHandler:n},s=null;return i.addEventListener("scroll",n,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(s),{once:!0}),r}function tx(i){let e=new Map;for(let[t,n]of new URLSearchParams(i))e.set(t.toLowerCase(),n);return e}var l3=/[\x00-\x1F]/g;function jv(i,e=!1){return l3.test(i)?e?i.replaceAll(l3,t=>t==="\0"?"":" "):i.replaceAll("\0",""):i}function Af(i,e,t=0){let n=t,r=i.length-1;if(r<0||!e(i[r]))return i.length;if(e(i[n]))return n;for(;n<r;){let s=n+r>>1,o=i[s];e(o)?r=s:n=s+1}return n}function c3(i){if(Math.floor(i)===i)return[i,1];let e=1/i,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];let n=i>1?e:i,r=0,s=1,o=1,a=1;for(;;){let c=r+o,d=s+a;if(d>t)break;n<=c/d?(o=c,a=d):(r=c,s=d)}let l;return n-r/s<o/a-n?l=n===i?[r,s]:[s,r]:l=n===i?[o,a]:[a,o],l}function Ov(i,e){return i-i%e}function dQ(i,e,t){if(i<2)return i;let n=e[i].div,r=n.offsetTop+n.clientTop;r>=t&&(n=e[i-1].div,r=n.offsetTop+n.clientTop);for(let s=i-2;s>=0&&(n=e[s].div,!(n.offsetTop+n.clientTop+n.clientHeight<=r));--s)i=s;return i}function uQ({scrollEl:i,views:e,sortByVisibility:t=!1,horizontal:n=!1,rtl:r=!1}){let s=i.scrollTop,o=s+i.clientHeight,a=i.scrollLeft,l=a+i.clientWidth;function c(y){let w=y.div;return w.offsetTop+w.clientTop+w.clientHeight>s}function d(y){let w=y.div,A=w.offsetLeft+w.clientLeft,C=A+w.clientWidth;return r?A<l:C>a}let u=[],h=new Set,f=e.length,p=Af(e,n?d:c);p>0&&p<f&&!n&&(p=dQ(p,e,s));let v=n?l:-1;for(let y=p;y<f;y++){let w=e[y],A=w.div,C=A.offsetLeft+A.clientLeft,E=A.offsetTop+A.clientTop,T=A.clientWidth,L=A.clientHeight,S=C+T,_=E+L;if(v===-1)_>=o&&(v=_);else if((n?C:E)>v)break;if(_<=s||E>=o||S<=a||C>=l)continue;let P=Math.max(0,s-E)+Math.max(0,_-o),U=Math.max(0,a-C)+Math.max(0,S-l),O=(L-P)/L,z=(T-U)/T,q=O*z*100|0;u.push({id:w.id,x:C,y:E,view:w,percent:q,widthPercent:z*100|0}),h.add(w.id)}let g=u[0],m=u.at(-1);return t&&u.sort(function(y,w){let A=y.percent-w.percent;return Math.abs(A)>.001?-A:y.id-w.id}),{first:g,last:m,views:u,ids:h}}function U3(i){return Number.isInteger(i)&&i%90===0}function hQ(i){return Number.isInteger(i)&&Object.values(Zt).includes(i)&&i!==Zt.UNKNOWN}function fQ(i){return Number.isInteger(i)&&Object.values(Pi).includes(i)&&i!==Pi.UNKNOWN}function d3(i){return i.width<=i.height}var $he=new Promise(function(i){window.requestAnimationFrame(i)}),pQ=document.documentElement.style;function mQ(i,e,t){return Math.min(Math.max(i,e),t)}var aC=class{#e=null;#t=null;#n=0;#i=null;#r=!0;constructor(e){this.#e=e.classList,this.#i=e.style}get percent(){return this.#n}set percent(e){if(this.#n=mQ(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#i.setProperty("--progressBar-percent",`${this.#n}%`)}setWidth(e){if(!e)return;let n=e.parentNode.offsetWidth-e.offsetWidth;n>0&&this.#i.setProperty("--progressBar-end-offset",`${n}px`)}setDisableAutoFetch(e=5e3){this.#n===100||isNaN(this.#n)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#r&&(this.#r=!1,this.#e.add("hidden"))}show(){this.#r||(this.#r=!0,this.#e.remove("hidden"))}};function gQ(i){let e=Zt.VERTICAL,t=Pi.NONE;switch(i){case"SinglePage":e=Zt.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=Zt.PAGE;case"TwoColumnLeft":t=Pi.ODD;break;case"TwoPageRight":e=Zt.PAGE;case"TwoColumnRight":t=Pi.EVEN;break}return{scrollMode:e,spreadMode:t}}var xs={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function vQ(i){return i<11904}function xQ(i){return(i&65408)===0}function wQ(i){return i>=97&&i<=122||i>=65&&i<=90}function yQ(i){return i>=48&&i<=57}function bQ(i){return i===32||i===9||i===13||i===10}function AQ(i){return i>=13312&&i<=40959||i>=63744&&i<=64255}function _Q(i){return i>=12448&&i<=12543}function SQ(i){return i>=12352&&i<=12447}function EQ(i){return i>=65376&&i<=65439}function CQ(i){return(i&65408)===3584}function Bv(i){return vQ(i)?xQ(i)?bQ(i)?xs.SPACE:wQ(i)||yQ(i)||i===95?xs.ALPHA_LETTER:xs.PUNCT:CQ(i)?xs.THAI_LETTER:i===160?xs.SPACE:xs.ALPHA_LETTER:AQ(i)?xs.HAN_LETTER:_Q(i)?xs.KATAKANA_LETTER:SQ(i)?xs.HIRAGANA_LETTER:EQ(i)?xs.HALFWIDTH_KATAKANA_LETTER:xs.ALPHA_LETTER}var u3;function MQ(){return u3||="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6",u3}var Za={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},TQ=250,IQ=-50,DQ=-400,h3={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"},f3=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),p3,PQ=new RegExp("\\p{M}+","gu"),RQ=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),LQ=new RegExp("([^\\p{M}])\\p{M}*$","u"),kQ=new RegExp("^\\p{M}*([^\\p{M}])","u"),NQ=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,m3=new Map,FQ="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",g3=new Map,JE=null,$E=null;function eC(i){let e=[],t;for(;(t=NQ.exec(i))!==null;){let{index:f}=t;for(let p of t[0]){let v=m3.get(p);v||(v=p.normalize("NFD").length,m3.set(p,v)),e.push([v,f++])}}let n;if(e.length===0&&JE)n=JE;else if(e.length>0&&$E)n=$E;else{let f=Object.keys(h3).join(""),p=MQ(),m=`([${f}])|([${p}])|((?:\u3099|\u309A)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30FF])\\n)|(\\n)`;e.length===0?n=JE=new RegExp(m+"|(\\u0000)","gum"):n=$E=new RegExp(m+`|(${FQ})`,"gum")}let r=[];for(;(t=PQ.exec(i))!==null;)r.push([t[0].length,t.index]);let s=i.normalize("NFD"),o=[[0,0]],a=0,l=0,c=0,d=0,u=0,h=!1;return s=s.replace(n,(f,p,v,g,m,y,w,A,C,E)=>{if(E-=d,p){let T=h3[p],L=T.length;for(let S=1;S<L;S++)o.push([E-c+S,c-S]);return c-=L-1,T}if(v){let T=g3.get(v);T||(T=v.normalize("NFKC"),g3.set(v,T));let L=T.length;for(let S=1;S<L;S++)o.push([E-c+S,c-S]);return c-=L-1,T}if(g)return h=!0,E+u===r[a]?.[1]?++a:(o.push([E-1-c+1,c-1]),c-=1,d+=1),o.push([E-c+1,c]),d+=1,u+=1,g.charAt(0);if(m){let T=m.endsWith(`
`),L=T?m.length-2:m.length;h=!0;let S=L;E+u===r[a]?.[1]&&(S-=r[a][0],++a);for(let _=1;_<=S;_++)o.push([E-1-c+_,c-_]);return c-=S,d+=S,T?(E+=L-1,o.push([E-c+1,1+c]),c+=1,d+=1,u+=1,m.slice(0,L)):m}if(y){let T=y.length-2;return o.push([E-c+T,1+c]),c+=1,d+=1,u+=1,y.slice(0,-2)}if(w){let T=w.length-1;return o.push([E-c+T,c]),d+=1,u+=1,w.slice(0,-1)}if(A)return o.push([E-c+1,c-1]),c-=1,d+=1,u+=1," ";if(E+u===e[l]?.[1]){let T=e[l][0]-1;++l;for(let L=1;L<=T;L++)o.push([E-(c-L),c-L]);c-=T,d+=T}return C}),o.push([s.length,c]),[s,o,h]}function OQ(i,e,t){if(!i)return[e,t];let n=e,r=e+t-1,s=Af(i,d=>d[0]>=n);i[s][0]>n&&--s;let o=Af(i,d=>d[0]>=r,s);i[o][0]>r&&--o;let a=n+i[s][1],c=r+i[o][1]+1-a;return[a,c]}var lC=class{#e=null;#t=!0;#n=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:n=!0}){this._linkService=e,this._eventBus=t,this.#t=n,this.onIsPageVisible=null,this.#r(),t._on("find",this.#i.bind(this)),t._on("findbarclose",this.#x.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#r(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#i(e){if(!e)return;let t=this._pdfDocument,{type:n}=e;(this.#e===null||this.#a(e))&&(this._dirtyMatch=!0),this.#e=e,n!=="highlightallchange"&&this.#b(Za.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#d();let r=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?this.#p():n==="again"?(this.#p(),r&&this.#e.highlightAll&&this.#h()):n==="highlightallchange"?(s?this.#p():this._highlightMatches=!0,this.#h()):this.#p():this._findTimeout=setTimeout(()=>{this.#p(),this._findTimeout=null},TQ)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:n=-1,matchIndex:r=-1}){if(!this._scrollMatches||!e)return;if(r===-1||r!==this._selected.matchIdx)return;if(n===-1||n!==this._selected.pageIdx)return;this._scrollMatches=!1;let s={top:IQ,left:t+DQ};V3(e,s,!0)}#r(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#n=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#s(){let{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=eC(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>eC(t)[0])}#a(e){let t=e.query,n=this.#e.query,r=typeof t;if(r!==typeof n)return!0;if(r==="string"){if(t!==n)return!0}else if(JSON.stringify(t)!==JSON.stringify(n))return!0;switch(e.type){case"again":let o=this._selected.pageIdx+1,a=this._linkService;return o>=1&&o<=a.pagesCount&&o!==a.page&&!(this.onIsPageVisible?.(o)??!0);case"highlightallchange":return!1}return!0}#l(e,t,n){let r=e.slice(0,t).match(LQ);if(r){let s=e.charCodeAt(t),o=r[1].charCodeAt(0);if(Bv(s)===Bv(o))return!1}if(r=e.slice(t+n).match(kQ),r){let s=e.charCodeAt(t+n-1),o=r[1].charCodeAt(0);if(Bv(s)===Bv(o))return!1}return!0}#u(e,t){let{matchDiacritics:n}=this.#e,r=!1;e=e.replaceAll(RQ,(o,a,l,c,d,u)=>a?`[ ]*\\${a}[ ]*`:l?`[ ]*${l}[ ]*`:c?"[ ]+":n?d||u:d?f3.has(d.charCodeAt(0))?d:"":t?(r=!0,`${u}\\p{M}*`):u);let s="[ ]*";return e.endsWith(s)&&(e=e.slice(0,e.length-s.length)),n&&t&&(p3||=String.fromCharCode(...f3),r=!0,e=`${e}(?=[${p3}]|[^\\p{M}]|$)`),[r,e]}#c(e){let t=this.#s;if(t.length===0)return;let n=this._pageContents[e],r=this.match(t,n,e),s=this._pageMatches[e]=[],o=this._pageMatchesLength[e]=[],a=this._pageDiffs[e];r?.forEach(({index:c,length:d})=>{let[u,h]=OQ(a,c,d);h&&(s.push(u),o.push(h))}),this.#e.highlightAll&&this.#o(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#m());let l=s.length;this._matchesCountTotal+=l,this.#t?l>0&&this.#A():++this.#n===this._linkService.pagesCount&&this.#A()}match(e,t,n){let r=this._hasDiacritics[n],s=!1;if(typeof e=="string"?[s,e]=this.#u(e,r):e=e.sort().reverse().map(u=>{let[h,f]=this.#u(u,r);return s||=h,`(${f})`}).join("|"),!e)return;let{caseSensitive:o,entireWord:a}=this.#e,l=`g${s?"u":""}${o?"":"i"}`;e=new RegExp(e,l);let c=[],d;for(;(d=e.exec(t))!==null;)a&&!this.#l(t,d.index,d[0].length)||c.push({index:d.index,length:d[0].length});return c}#d(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve(),t={disableNormalization:!0};for(let n=0,r=this._linkService.pagesCount;n<r;n++){let{promise:s,resolve:o}=Promise.withResolvers();this._extractTextPromises[n]=s,e=e.then(()=>this._pdfDocument.getPage(n+1).then(a=>a.getTextContent(t)).then(a=>{let l=[];for(let c of a.items)l.push(c.str),c.hasEOL&&l.push(`
`);[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=eC(l.join("")),o()},a=>{console.error(`Unable to get text content for page ${n+1}`,a),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,o()}))}}#o(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#h(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#p(){let e=this.#e.findPrevious,t=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#n=0,this._matchesCountTotal=0,this.#h();for(let o=0;o<n;o++)this._pendingFindMatches.has(o)||(this._pendingFindMatches.add(o),this._extractTextPromises[o].then(()=>{this._pendingFindMatches.delete(o),this.#c(o)}))}if(this.#s.length===0){this.#b(Za.FOUND);return}if(this._resumePageIdx)return;let s=this._offset;if(this._pagesToSearch=n,s.matchIdx!==null){let o=this._pageMatches[s.pageIdx].length;if(!e&&s.matchIdx+1<o||e&&s.matchIdx>0){s.matchIdx=e?s.matchIdx-1:s.matchIdx+1,this.#g(!0);return}this.#v(e)}this.#m()}#f(e){let t=this._offset,n=e.length,r=this.#e.findPrevious;return n?(t.matchIdx=r?n-1:0,this.#g(!0),!0):(this.#v(r),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#g(!1),!0):!1)}#m(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{let t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#f(e))}#v(e){let t=this._offset,n=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=n||t.pageIdx<0)&&(t.pageIdx=e?n-1:0,t.wrapped=!0)}#g(e=!1){let t=Za.NOT_FOUND,n=this._offset.wrapped;if(this._offset.wrapped=!1,e){let r=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=n?Za.WRAPPED:Za.FOUND,r!==-1&&r!==this._selected.pageIdx&&this.#o(r)}this.#b(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#o(this._selected.pageIdx))}#x(e){let t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#b(Za.FOUND),this._highlightMatches=!1,this.#h())})}#y(){let{pageIdx:e,matchIdx:t}=this._selected,n=0,r=this._matchesCountTotal;if(t!==-1){for(let s=0;s<e;s++)n+=this._pageMatches[s]?.length||0;n+=t+1}return(n<1||n>r)&&(n=r=0),{current:n,total:r}}#A(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#y()})}#b(e,t=!1){!this.#t&&(this.#n!==this._linkService.pagesCount||e===Za.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#y(),rawQuery:this.#e?.query??null})}},BQ="noopener noreferrer nofollow",Ql={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},Gv=class i{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:n=null,ignoreDestinationZoom:r=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=n,this._ignoreDestinationZoom=r,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}goToDestination(e){return ce(this,null,function*(){if(!this.pdfDocument)return;let t,n,r;if(typeof e=="string"?(t=e,n=yield this.pdfDocument.getDestination(e)):(t=null,n=yield e),!Array.isArray(n)){console.error(`goToDestination: "${n}" is not a valid destination array, for dest="${e}".`);return}let[s]=n;if(s&&typeof s=="object"){if(r=this.pdfDocument.cachedPageNumber(s),!r)try{r=(yield this.pdfDocument.getPageIndex(s))+1}catch{console.error(`goToDestination: "${s}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(s)&&(r=s+1);if(!r||r<1||r>this.pagesCount){console.error(`goToDestination: "${r}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:n,pageNumber:r})),this.pdfViewer.scrollPageIntoView({pageNumber:r,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom})})}goToPage(e){if(!this.pdfDocument)return;let t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,n=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');let r=n?Ql.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let o="";switch(r){case Ql.NONE:break;case Ql.SELF:o="_self";break;case Ql.BLANK:o="_blank";break;case Ql.PARENT:o="_parent";break;case Ql.TOP:o="_top";break}e.target=o,e.rel=typeof s=="string"?s:BQ}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){let t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,n;if(e.includes("=")){let r=tx(e);if(r.has("search")){let s=r.get("search").replaceAll('"',""),o=r.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:o?s:s.match(/\S+/g)})}if(r.has("page")&&(t=r.get("page")|0||1),r.has("zoom")){let s=r.get("zoom").split(","),o=s[0],a=parseFloat(o);o.includes("Fit")?o==="Fit"||o==="FitB"?n=[null,{name:o}]:o==="FitH"||o==="FitBH"||o==="FitV"||o==="FitBV"?n=[null,{name:o},s.length>1?s[1]|0:null]:o==="FitR"?s.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):n=[null,{name:o},s[1]|0,s[2]|0,s[3]|0,s[4]|0]:console.error(`PDFLinkService.setHash: "${o}" is not a valid zoom value.`):n=[null,{name:"XYZ"},s.length>1?s[1]|0:null,s.length>2?s[2]|0:null,a?a/100:o]}n?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:n,allowNegativeOffset:!0}):t&&(this.page=t),r.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:r.get("pagemode")}),r.has("nameddest")&&this.goToDestination(r.get("nameddest"));return}n=unescape(e);try{n=JSON.parse(n),Array.isArray(n)||(n=n.toString())}catch{}if(typeof n=="string"||i.#e(n)){this.goToDestination(n);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}executeSetOCGState(e){return ce(this,null,function*(){if(!this.pdfDocument)return;let t=this.pdfDocument,n=yield this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(n.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(n))})}static#e(e){if(!Array.isArray(e)||e.length<2)return!1;let[t,n,...r]=e;if(!(typeof t=="object"&&Number.isInteger(t?.num)&&Number.isInteger(t?.gen))&&!Number.isInteger(t)||!(typeof n=="object"&&typeof n?.name=="string"))return!1;let s=r.length,o=!0;switch(n.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;o=!1;break;default:return!1}for(let a of r)if(!(typeof a=="number"||o&&a===null))return!1;return!0}},_f=class extends Gv{setDocument(e,t=null){}},{AbortException:VQ,AnnotationEditorLayer:UQ,AnnotationEditorParamsType:efe,AnnotationEditorType:xr,AnnotationEditorUIManager:HQ,AnnotationLayer:zQ,AnnotationMode:Go,build:tfe,CMapCompressionType:nfe,ColorPicker:ife,createValidAbsoluteUrl:jQ,DOMSVGFactory:rfe,DrawLayer:GQ,FeatureTest:sfe,fetchData:v3,getDocument:ofe,getFilenameFromUrl:afe,getPdfFilenameFromUrl:WQ,getXfaPageViewport:lfe,GlobalWorkerOptions:cfe,ImageKind:dfe,InvalidPDFException:ufe,isDataScheme:hfe,isPdfFile:qQ,MissingPDFException:ffe,noContextMenu:pfe,normalizeUnicode:ZQ,OPS:mfe,PasswordResponses:gfe,PDFDataRangeTransport:vfe,PDFDateString:xfe,PDFWorker:wfe,PermissionFlag:Vv,PixelsPerInch:jo,RenderingCancelledException:cC,setLayerDimensions:XQ,shadow:Wv,TextLayer:YQ,UnexpectedResponseException:yfe,Util:bfe,VerbosityLevel:Afe,version:x3,XfaLayer:tC}=globalThis.pdfjsLib,qv=class{#e=null;#t=null;constructor({pdfPage:e,linkService:t,downloadManager:n,annotationStorage:r=null,imageResourcesPath:s="",renderForms:o=!0,enableScripting:a=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:c=null,annotationCanvasMap:d=null,accessibilityManager:u=null,annotationEditorUIManager:h=null,onAppend:f=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=n,this.imageResourcesPath=s,this.renderForms=o,this.annotationStorage=r,this.enableScripting=a,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=c||Promise.resolve(null),this._annotationCanvasMap=d,this._accessibilityManager=u,this._annotationEditorUIManager=h,this.#e=f,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}render(e,t="display"){return ce(this,null,function*(){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}let[n,r,s]=yield Promise.all([this.pdfPage.getAnnotations({intent:t}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;let o=this.div=document.createElement("div");if(o.className="annotationLayer",this.#e?.(o),n.length===0){this.hide();return}this.annotationLayer=new zQ({div:o,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0})}),yield this.annotationLayer.render({annotations:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:r,fieldObjects:s}),this.linkService.isInPresentationMode&&this.#n(Zd.FULLSCREEN),this.#t||(this.#t=new AbortController,this._eventBus?._on("presentationmodechanged",a=>{this.#n(a.state)},{signal:this.#t.signal}))})}cancel(){this._cancelled=!0,this.#t?.abort(),this.#t=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#n(e){if(!this.div)return;let t=!1;switch(e){case Zd.FULLSCREEN:t=!0;break;case Zd.NORMAL:break;default:return}for(let n of this.div.childNodes)n.hasAttribute("data-internal-link")||(n.inert=t)}};function w3(i,e){let t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=i,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}var dC=class{#e=new WeakMap;downloadData(e,t,n){let r=URL.createObjectURL(new Blob([e],{type:n}));w3(r,t)}openOrDownloadData(e,t,n=null){let s=qQ(t)?"application/pdf":"";return this.downloadData(e,t,s),!1}download(e,t,n){let r;if(e)r=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!jQ(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}r=t+"#pdfjs.action=download"}w3(r,n)}},y3={EVENT:"event",TIMEOUT:"timeout"};function QQ(n){return ce(this,arguments,function*({target:i,name:e,delay:t=0}){if(typeof i!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");let{promise:r,resolve:s}=Promise.withResolvers(),o=new AbortController;function a(d){o.abort(),clearTimeout(c),s(d)}let l=i instanceof Zv?"_on":"addEventListener";i[l](e,a.bind(null,y3.EVENT),{signal:o.signal});let c=setTimeout(a.bind(null,y3.TIMEOUT),t);return r})}var Zv=class{#e=Object.create(null);on(e,t,n=null){this._on(e,t,{external:!0,once:n?.once,signal:n?.signal})}off(e,t,n=null){this._off(e,t)}dispatch(e,t){let n=this.#e[e];if(!n||n.length===0)return;let r;for(let{listener:s,external:o,once:a}of n.slice(0)){if(a&&this._off(e,s),o){(r||=[]).push(s);continue}s(t)}if(r){for(let s of r)s(t);r=null}}_on(e,t,n=null){let r=null;if(n?.signal instanceof AbortSignal){let{signal:o}=n;if(o.aborted){console.error("Cannot use an `aborted` signal.");return}let a=()=>this._off(e,t);r=()=>o.removeEventListener("abort",a),o.addEventListener("abort",a)}(this.#e[e]||=[]).push({listener:t,external:n?.external===!0,once:n?.once===!0,rmAbort:r})}_off(e,t,n=null){let r=this.#e[e];if(r)for(let s=0,o=r.length;s<o;s++){let a=r[s];if(a.listener===t){a.rmAbort?.(),r.splice(s,1);return}}}};var Xd=class{constructor(e){this.value=e}valueOf(){return this.value}},Ln=class extends Xd{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},ws=class extends Xd{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},Jl=class extends Xd{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},b3=100,KQ="\u2068",JQ="\u2069";function $Q(i,e,t){if(t===e||t instanceof ws&&e instanceof ws&&t.value===e.value)return!0;if(e instanceof ws&&typeof t=="string"){let n=i.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===n)return!0}return!1}function A3(i,e,t){return e[t]?Yd(i,e[t].value):(i.reportError(new RangeError("No default")),new Ln)}function uC(i,e){let t=[],n=Object.create(null);for(let r of e)r.type==="narg"?n[r.name]=Sf(i,r.value):t.push(Sf(i,r));return{positional:t,named:n}}function Sf(i,e){switch(e.type){case"str":return e.value;case"num":return new ws(e.value,{minimumFractionDigits:e.precision});case"var":return eK(i,e);case"mesg":return tK(i,e);case"term":return nK(i,e);case"func":return iK(i,e);case"select":return rK(i,e);default:return new Ln}}function eK(i,{name:e}){let t;if(i.params)if(Object.prototype.hasOwnProperty.call(i.params,e))t=i.params[e];else return new Ln(`$${e}`);else if(i.args&&Object.prototype.hasOwnProperty.call(i.args,e))t=i.args[e];else return i.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Ln(`$${e}`);if(t instanceof Xd)return t;switch(typeof t){case"string":return t;case"number":return new ws(t);case"object":if(t instanceof Date)return new Jl(t.getTime());default:return i.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Ln(`$${e}`)}}function tK(i,{name:e,attr:t}){let n=i.bundle._messages.get(e);if(!n)return i.reportError(new ReferenceError(`Unknown message: ${e}`)),new Ln(e);if(t){let r=n.attributes[t];return r?Yd(i,r):(i.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Ln(`${e}.${t}`))}return n.value?Yd(i,n.value):(i.reportError(new ReferenceError(`No value: ${e}`)),new Ln(e))}function nK(i,{name:e,attr:t,args:n}){let r=`-${e}`,s=i.bundle._terms.get(r);if(!s)return i.reportError(new ReferenceError(`Unknown term: ${r}`)),new Ln(r);if(t){let a=s.attributes[t];if(a){i.params=uC(i,n).named;let l=Yd(i,a);return i.params=null,l}return i.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Ln(`${r}.${t}`)}i.params=uC(i,n).named;let o=Yd(i,s.value);return i.params=null,o}function iK(i,{name:e,args:t}){let n=i.bundle._functions[e];if(!n)return i.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Ln(`${e}()`);if(typeof n!="function")return i.reportError(new TypeError(`Function ${e}() is not callable`)),new Ln(`${e}()`);try{let r=uC(i,t);return n(r.positional,r.named)}catch(r){return i.reportError(r),new Ln(`${e}()`)}}function rK(i,{selector:e,variants:t,star:n}){let r=Sf(i,e);if(r instanceof Ln)return A3(i,t,n);for(let s of t){let o=Sf(i,s.key);if($Q(i,r,o))return Yd(i,s.value)}return A3(i,t,n)}function H3(i,e){if(i.dirty.has(e))return i.reportError(new RangeError("Cyclic reference")),new Ln;i.dirty.add(e);let t=[],n=i.bundle._useIsolating&&e.length>1;for(let r of e){if(typeof r=="string"){t.push(i.bundle._transform(r));continue}if(i.placeables++,i.placeables>b3)throw i.dirty.delete(e),new RangeError(`Too many placeables expanded: ${i.placeables}, max allowed is ${b3}`);n&&t.push(KQ),t.push(Sf(i,r).toString(i)),n&&t.push(JQ)}return i.dirty.delete(e),t.join("")}function Yd(i,e){return typeof e=="string"?i.bundle._transform(e):H3(i,e)}var hC=class{constructor(e,t,n){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=n}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let n=this.bundle._intls.get(e);n||(n={},this.bundle._intls.set(e,n));let r=JSON.stringify(t);return n[r]||(n[r]=new e(this.bundle.locales,t)),n[r]}};function Xv(i,e){let t=Object.create(null);for(let[n,r]of Object.entries(i))e.includes(n)&&(t[n]=r.valueOf());return t}var _3=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function sK(i,e){let t=i[0];if(t instanceof Ln)return new Ln(`NUMBER(${t.valueOf()})`);if(t instanceof ws)return new ws(t.valueOf(),re(re({},t.opts),Xv(e,_3)));if(t instanceof Jl)return new ws(t.valueOf(),re({},Xv(e,_3)));throw new TypeError("Invalid argument to NUMBER")}var S3=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function oK(i,e){let t=i[0];if(t instanceof Ln)return new Ln(`DATETIME(${t.valueOf()})`);if(t instanceof Jl)return new Jl(t.valueOf(),re(re({},t.opts),Xv(e,S3)));if(t instanceof ws)return new Jl(t.valueOf(),re({},Xv(e,S3)));throw new TypeError("Invalid argument to DATETIME")}var E3=new Map;function aK(i){let e=Array.isArray(i)?i.join(" "):i,t=E3.get(e);return t===void 0&&(t=new Map,E3.set(e,t)),t}var fC=class{constructor(e,{functions:t,useIsolating:n=!0,transform:r=s=>s}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=re({NUMBER:sK,DATETIME:oK},t),this._useIsolating=n,this._transform=r,this._intls=aK(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let n=[];for(let r=0;r<e.body.length;r++){let s=e.body[r];if(s.id.startsWith("-")){if(t===!1&&this._terms.has(s.id)){n.push(new Error(`Attempt to override an existing term: "${s.id}"`));continue}this._terms.set(s.id,s)}else{if(t===!1&&this._messages.has(s.id)){n.push(new Error(`Attempt to override an existing message: "${s.id}"`));continue}this._messages.set(s.id,s)}}return n}formatPattern(e,t=null,n=null){if(typeof e=="string")return this._transform(e);let r=new hC(this,n,t);try{return H3(r,e).toString(r)}catch(s){if(r.errors&&s instanceof Error)return r.errors.push(s),new Ln().toString(r);throw s}}},nC=/^(-?[a-zA-Z][\w-]*) *= */gm,C3=/\.([a-zA-Z][\w-]*) *= */y,lK=/\*?\[/y,iC=/(-?[0-9]+(?:\.([0-9]+))?)/y,cK=/([a-zA-Z][\w-]*)/y,M3=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,dK=/^[A-Z][A-Z0-9_-]*$/,Uv=/([^{}\n\r]+)/y,uK=/([^\\"\n\r]*)/y,T3=/\\([\\"])/y,I3=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,hK=/^\n+/,D3=/ +$/,fK=/ *\r?\n/g,pK=/( *)$/,mK=/{\s*/y,P3=/\s*}/y,gK=/\[\s*/y,vK=/\s*] */y,xK=/\s*\(\s*/y,wK=/\s*->\s*/y,yK=/\s*:\s*/y,bK=/\s*,?\s*/y,AK=/\s+/y,pC=class{constructor(e){this.body=[],nC.lastIndex=0;let t=0;for(;;){let S=nC.exec(e);if(S===null)break;t=nC.lastIndex;try{this.body.push(l(S[1]))}catch(_){if(_ instanceof SyntaxError)continue;throw _}}function n(S){return S.lastIndex=t,S.test(e)}function r(S,_){if(e[t]===S)return t++,!0;if(_)throw new _(`Expected ${S}`);return!1}function s(S,_){if(n(S))return t=S.lastIndex,!0;if(_)throw new _(`Expected ${S.toString()}`);return!1}function o(S){S.lastIndex=t;let _=S.exec(e);if(_===null)throw new SyntaxError(`Expected ${S.toString()}`);return t=S.lastIndex,_}function a(S){return o(S)[1]}function l(S){let _=d(),P=c();if(_===null&&Object.keys(P).length===0)throw new SyntaxError("Expected message value or attributes");return{id:S,value:_,attributes:P}}function c(){let S=Object.create(null);for(;n(C3);){let _=a(C3),P=d();if(P===null)throw new SyntaxError("Expected attribute value");S[_]=P}return S}function d(){let S;if(n(Uv)&&(S=a(Uv)),e[t]==="{"||e[t]==="}")return u(S?[S]:[],1/0);let _=E();return _?S?u([S,_],_.length):(_.value=T(_.value,hK),u([_],_.length)):S?T(S,D3):null}function u(S=[],_){for(;;){if(n(Uv)){S.push(a(Uv));continue}if(e[t]==="{"){S.push(h());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let z=E();if(z){S.push(z),_=Math.min(_,z.length);continue}break}let P=S.length-1,U=S[P];typeof U=="string"&&(S[P]=T(U,D3));let O=[];for(let z of S)z instanceof Yv&&(z=z.value.slice(0,z.value.length-_)),z&&O.push(z);return O}function h(){s(mK,SyntaxError);let S=f();if(s(P3))return S;if(s(wK)){let _=g();return s(P3,SyntaxError),re({type:"select",selector:S},_)}throw new SyntaxError("Unclosed placeable")}function f(){if(e[t]==="{")return h();if(n(M3)){let[,S,_,P=null]=o(M3);if(S==="$")return{type:"var",name:_};if(s(xK)){let U=p();if(S==="-")return{type:"term",name:_,attr:P,args:U};if(dK.test(_))return{type:"func",name:_,args:U};throw new SyntaxError("Function names must be all upper-case")}return S==="-"?{type:"term",name:_,attr:P,args:[]}:{type:"mesg",name:_,attr:P}}return y()}function p(){let S=[];for(;;){switch(e[t]){case")":return t++,S;case void 0:throw new SyntaxError("Unclosed argument list")}S.push(v()),s(bK)}}function v(){let S=f();return S.type!=="mesg"?S:s(yK)?{type:"narg",name:S.name,value:y()}:S}function g(){let S=[],_=0,P;for(;n(lK);){r("*")&&(P=_);let U=m(),O=d();if(O===null)throw new SyntaxError("Expected variant value");S[_++]={key:U,value:O}}if(_===0)return null;if(P===void 0)throw new SyntaxError("Expected default variant");return{variants:S,star:P}}function m(){s(gK,SyntaxError);let S;return n(iC)?S=w():S={type:"str",value:a(cK)},s(vK,SyntaxError),S}function y(){if(n(iC))return w();if(e[t]==='"')return A();throw new SyntaxError("Invalid expression")}function w(){let[,S,_=""]=o(iC),P=_.length;return{type:"num",value:parseFloat(S),precision:P}}function A(){r('"',SyntaxError);let S="";for(;;){if(S+=a(uK),e[t]==="\\"){S+=C();continue}if(r('"'))return{type:"str",value:S};throw new SyntaxError("Unclosed string literal")}}function C(){if(n(T3))return a(T3);if(n(I3)){let[,S,_]=o(I3),P=parseInt(S||_,16);return P<=55295||57344<=P?String.fromCodePoint(P):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function E(){let S=t;switch(s(AK),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return L(e.slice(S,t))}return e[t-1]===" "?L(e.slice(S,t)):!1}function T(S,_){return S.replace(_,"")}function L(S){let _=S.replace(fK,`
`),P=pK.exec(S)[1].length;return new Yv(_,P)}}},Yv=class{constructor(e,t){this.value=e,this.length=t}},_K=/<|&#?\w+;/,SK={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},EK={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function CK(i,e){let{value:t}=e;if(typeof t=="string")if(i.localName==="title"&&i.namespaceURI==="http://www.w3.org/1999/xhtml")i.textContent=t;else if(!_K.test(t))i.textContent=t;else{let n=i.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");n.innerHTML=t,MK(n.content,i)}z3(e,i)}function MK(i,e){for(let t of i.childNodes)if(t.nodeType!==t.TEXT_NODE){if(t.hasAttribute("data-l10n-name")){let n=IK(e,t);i.replaceChild(n,t);continue}if(PK(t)){let n=DK(t);i.replaceChild(n,t);continue}console.warn(`An element of forbidden type "${t.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),i.replaceChild(mC(t),t)}e.textContent="",e.appendChild(i)}function TK(i,e){if(!i)return!1;for(let t of i)if(t.name===e)return!0;return!1}function z3(i,e){let t=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map(n=>n.trim()):null;for(let n of Array.from(e.attributes))R3(n.name,e,t)&&!TK(i.attributes,n.name)&&e.removeAttribute(n.name);if(i.attributes)for(let n of Array.from(i.attributes))R3(n.name,e,t)&&e.getAttribute(n.name)!==n.value&&e.setAttribute(n.name,n.value)}function IK(i,e){let t=e.getAttribute("data-l10n-name"),n=i.querySelector(`[data-l10n-name="${t}"]`);if(!n)return console.warn(`An element named "${t}" wasn't found in the source.`),mC(e);if(n.localName!==e.localName)return console.warn(`An element named "${t}" was found in the translation but its type ${e.localName} didn't match the element found in the source (${n.localName}).`),mC(e);i.removeChild(n);let r=n.cloneNode(!1);return j3(e,r)}function DK(i){let e=i.ownerDocument.createElement(i.localName);return j3(i,e)}function mC(i){return i.ownerDocument.createTextNode(i.textContent)}function PK(i){let e=SK[i.namespaceURI];return e&&e.includes(i.localName)}function R3(i,e,t=null){if(t&&t.includes(i))return!0;let n=EK[e.namespaceURI];if(!n)return!1;let r=i.toLowerCase(),s=e.localName;if(n.global.includes(r))return!0;if(!n[s])return!1;if(n[s].includes(r))return!0;if(e.namespaceURI==="http://www.w3.org/1999/xhtml"&&s==="input"&&r==="value"){let o=e.type.toLowerCase();if(o==="submit"||o==="button"||o==="reset")return!0}return!1}function j3(i,e){return e.textContent=i.textContent,z3(i,e),e}var gC=class extends Array{static from(e){return e instanceof this?e:new this(e)}};var vC=class extends gC{constructor(e){if(super(),Symbol.asyncIterator in Object(e))this.iterator=e[Symbol.asyncIterator]();else if(Symbol.iterator in Object(e))this.iterator=e[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){let e=this,t=0;return{next(){return ce(this,null,function*(){return e.length<=t&&e.push(e.iterator.next()),e[t++]})}}}touchNext(e=1){return ce(this,null,function*(){let t=0;for(;t++<e;){let n=this[this.length-1];if(n&&(yield n).done)break;this.push(this.iterator.next())}return this[this.length-1]})}},xC=class{constructor(e=[],t){this.resourceIds=e,this.generateBundles=t,this.onChange(!0)}addResourceIds(e,t=!1){return this.resourceIds.push(...e),this.onChange(t),this.resourceIds.length}removeResourceIds(e){return this.resourceIds=this.resourceIds.filter(t=>!e.includes(t)),this.onChange(),this.resourceIds.length}formatWithFallback(e,t){return ce(this,null,function*(){let n=[],r=!1;try{for(var s=QC(this.bundles),o,a,l;o=!(a=yield s.next()).done;o=!1){let c=a.value;r=!0;let d=kK(t,c,e,n);if(d.size===0)break;if(typeof console<"u"){let u=c.locales[0],h=Array.from(d).join(", ");console.warn(`[fluent] Missing translations in ${u}: ${h}`)}}}catch{l=[a]}finally{try{o&&(a=s.return)&&(yield a.call(s))}finally{if(l)throw l[0]}}return!r&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(e)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),n})}formatMessages(e){return this.formatWithFallback(e,LK)}formatValues(e){return this.formatWithFallback(e,RK)}formatValue(e,t){return ce(this,null,function*(){let[n]=yield this.formatValues([{id:e,args:t}]);return n})}handleEvent(){this.onChange()}onChange(e=!1){this.bundles=vC.from(this.generateBundles(this.resourceIds)),e&&this.bundles.touchNext(2)}};function RK(i,e,t,n){return t.value?i.formatPattern(t.value,n,e):null}function LK(i,e,t,n){let r={value:null,attributes:null};t.value&&(r.value=i.formatPattern(t.value,n,e));let s=Object.keys(t.attributes);if(s.length>0){r.attributes=new Array(s.length);for(let[o,a]of s.entries()){let l=i.formatPattern(t.attributes[a],n,e);r.attributes[o]={name:a,value:l}}}return r}function kK(i,e,t,n){let r=[],s=new Set;return t.forEach(({id:o,args:a},l)=>{if(n[l]!==void 0)return;let c=e.getMessage(o);if(c){if(r.length=0,n[l]=i(e,r,c,a),r.length>0&&typeof console<"u"){let d=e.locales[0],u=r.join(", ");console.warn(`[fluent][resolver] errors in ${d}/${o}: ${u}.`)}}else s.add(o)}),s}var Kl="data-l10n-id",yf="data-l10n-args",NK=`[${Kl}]`,wC=class extends xC{constructor(e,t){super(e,t),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[Kl,yf]}}onChange(e=!1){super.onChange(e),this.roots&&this.translateRoots()}setAttributes(e,t,n){return e.setAttribute(Kl,t),n?e.setAttribute(yf,JSON.stringify(n)):e.removeAttribute(yf),e}getAttributes(e){return{id:e.getAttribute(Kl),args:JSON.parse(e.getAttribute(yf)||null)}}connectRoot(e){for(let t of this.roots)if(t===e||t.contains(e)||e.contains(t))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==e.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=e.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(t=>this.translateMutations(t));this.roots.add(e),this.mutationObserver.observe(e,this.observerConfig)}disconnectRoot(e){return this.roots.delete(e),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){let e=Array.from(this.roots);return Promise.all(e.map(t=>this.translateFragment(t)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(let e of this.roots)this.mutationObserver.observe(e,this.observerConfig)}translateMutations(e){for(let t of e)switch(t.type){case"attributes":t.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(t.target);break;case"childList":for(let n of t.addedNodes)if(n.nodeType===n.ELEMENT_NODE)if(n.childElementCount)for(let r of this.getTranslatables(n))this.pendingElements.add(r);else n.hasAttribute(Kl)&&this.pendingElements.add(n);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(e){return this.translateElements(this.getTranslatables(e))}translateElements(e){return ce(this,null,function*(){if(!e.length)return;let t=e.map(this.getKeysForElement),n=yield this.formatMessages(t);return this.applyTranslations(e,n)})}applyTranslations(e,t){this.pauseObserving();for(let n=0;n<e.length;n++)t[n]!==void 0&&CK(e[n],t[n]);this.resumeObserving()}getTranslatables(e){let t=Array.from(e.querySelectorAll(NK));return typeof e.hasAttribute=="function"&&e.hasAttribute(Kl)&&t.push(e),t}getKeysForElement(e){return{id:e.getAttribute(Kl),args:JSON.parse(e.getAttribute(yf)||null)}}},yC=class i{#e;#t=new Set;#n;#i;constructor({lang:e,isRTL:t},n=null){this.#n=i.#r(e),this.#i=n,this.#e=t??i.#s(this.#n)?"rtl":"ltr"}_setL10n(e){this.#i=e}getLanguage(){return this.#n}getDirection(){return this.#e}get(e,t=null,n){return ce(this,null,function*(){return Array.isArray(e)?(e=e.map(o=>({id:o})),(yield this.#i.formatMessages(e)).map(o=>o.value)):(yield this.#i.formatMessages([{id:e,args:t}]))[0]?.value||n})}translate(e){return ce(this,null,function*(){this.#t.add(e);try{this.#i.connectRoot(e),yield this.#i.translateRoots()}catch{}})}translateOnce(e){return ce(this,null,function*(){try{yield this.#i.translateElements([e])}catch(t){console.error(`translateOnce: "${t}".`)}})}destroy(){return ce(this,null,function*(){for(let e of this.#t)this.#i.disconnectRoot(e);this.#t.clear(),this.#i.pauseObserving()})}pause(){this.#i.pauseObserving()}resume(){this.#i.resumeObserving()}static#r(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#s(e){let t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}};function L3(i,e){let t=new pC(e),n=new fC(i),r=n.addResource(t);return r.length&&console.error("L10n errors",r),n}var Qd=class i extends yC{constructor(e){super({lang:e});let t=e?i.#e.bind(i,"en-us",this.getLanguage()):i.#i.bind(i,this.getLanguage());this._setL10n(new wC([],t))}static#e(e,t){return gx(this,null,function*(){let{baseURL:n,paths:r}=yield new If(this.#n()),s=[t];if(e!==t){let o=t.split("-",1)[0];o!==t&&s.push(o),s.push(e)}for(let o of s){let a=yield new If(this.#t(o,n,r));a?yield a:o==="en-us"&&(yield this.#r(o))}})}static#t(e,t,n){return ce(this,null,function*(){let r=n[e];if(!r)return null;let s=new URL(r,t),o=yield v3(s,"text");return L3(e,o)})}static#n(){return ce(this,null,function*(){try{let{href:e}=document.querySelector('link[type="application/l10n"]'),t=yield v3(e,"json");return{baseURL:e.replace(/[^/]*$/,"")||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}})}static#i(e){return gx(this,null,function*(){yield this.#r(e)})}static#r(e){return ce(this,null,function*(){return L3(e,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties\u2026
pdfjs-document-properties-button-label = Document Properties\u2026
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing\u2026
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document\u2026
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text =
    .aria-label = Text Editor
pdfjs-free-text-default-content = Start typing\u2026
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner \u2014 resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle \u2014 resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner \u2014 resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right \u2014 resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner \u2014 resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle \u2014 resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner \u2014 resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left \u2014 resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here\u2026
pdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close`)})}},FK=1e3,rC=50,k3=1e3;function sC(){return document.location.hash}var bC=class{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",n=>{this._isPagesLoaded=!!n.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:n=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();let r=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=n===!0,this._initialized=!0,this.#d();let s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=sC(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#r(s,!0)||t){let{hash:a,page:l,rotation:c}=this.#a(!0);if(!a||r||t){this.#t(null,!0);return}this.#t({hash:a,page:l,rotation:c},!0);return}let o=s.destination;this.#s(o,s.uid,!0),o.rotation!==void 0&&(this._initialRotation=o.rotation),o.dest?(this._initialBookmark=JSON.stringify(o.dest),this._destination.page=null):o.hash?this._initialBookmark=o.hash:o.page&&(this._initialBookmark=`page=${o.page}`)}reset(){this._initialized&&(this.#c(),this._initialized=!1,this.#o()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:n}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#i(n)&&(n!==null||this._destination)){console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}let r=e||JSON.stringify(t);if(!r)return;let s=!1;if(this._destination&&(OK(this._destination.hash,r)||BK(this._destination.dest,t))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#t({dest:t,hash:r,page:n,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#i(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#n()}back(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#r(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#r(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){let n=t||!this._destination,r={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:e};this.#s(e,r.uid);let s;if(this._updateUrl&&e?.hash){let o=document.location.href.split("#",1)[0];o.startsWith("file://")||(s=`${o}#${e.hash}`)}n?window.history.replaceState(r,"",s):window.history.pushState(r,"",s)}#n(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&(rC<=0||this._numPositionUpdates<=rC))return;let n=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;n=!0}this.#t(t,n)}#i(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#r(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;let[n]=performance.getEntriesByType("navigation");if(n?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#s(e,t,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#a(e=!1){let t=unescape(sC()).substring(1),n=tx(t),r=n.get("nameddest")||"",s=n.get("page")|0;return(!this.#i(s)||e&&r.length>0)&&(s=null),{hash:t,page:s,rotation:this.linkService.rotation}}#l({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(rC>0&&this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,k3>0&&(this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#n(!0),this._updateViewareaTimeout=null},k3)))}#u({state:e}){let t=sC(),n=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;let{hash:s,page:o,rotation:a}=this.#a();this.#t({hash:s,page:o,rotation:a},!0);return}if(!this.#r(e))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,QQ({target:window,name:"hashchange",delay:FK}).then(()=>{this._blockHashChange--}));let r=e.destination;this.#s(r,e.uid,!0),U3(r.rotation)&&(this.linkService.rotation=r.rotation),r.dest?this.linkService.goToDestination(r.dest):r.hash?this.linkService.setHash(r.hash):r.page&&(this.linkService.page=r.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#c(){(!this._destination||this._destination.temporary)&&this.#n()}#d(){if(this.#e)return;this.#e=new AbortController;let{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#l.bind(this),{signal:e}),window.addEventListener("popstate",this.#u.bind(this),{signal:e}),window.addEventListener("pagehide",this.#c.bind(this),{signal:e})}#o(){this.#e?.abort(),this.#e=null}};function OK(i,e){return typeof i!="string"||typeof e!="string"?!1:i===e||tx(i).get("nameddest")===e}function BK(i,e){function t(n,r){if(typeof n!=typeof r||Array.isArray(n)||Array.isArray(r))return!1;if(n!==null&&typeof n=="object"&&r!==null){if(Object.keys(n).length!==Object.keys(r).length)return!1;for(let s in n)if(!t(n[s],r[s]))return!1;return!0}return n===r||Number.isNaN(n)&&Number.isNaN(r)}if(!(Array.isArray(i)&&Array.isArray(e))||i.length!==e.length)return!1;for(let n=0,r=i.length;n<r;n++)if(!t(i[n],e[n]))return!1;return!0}var AC=class{#e=null;#t=null;#n=null;#i=null;#r;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,this.l10n||=new Qd,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#r=e.uiManager,this.#e=e.annotationLayer||null,this.#i=e.textLayer||null,this.#t=e.drawLayer||null,this.#n=e.onAppend||null}render(e,t="display"){return ce(this,null,function*(){if(t!=="display"||this._cancelled)return;let n=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:n}),this.show();return}let r=this.div=document.createElement("div");r.className="annotationEditorLayer",r.hidden=!0,r.dir=this.#r.direction,this.#n?.(r),this.annotationEditorLayer=new UQ({uiManager:this.#r,div:r,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:this.#e,textLayer:this.#i,drawLayer:this.#t});let s={viewport:n,div:r,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()})}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}};{zv=new Map;let i=navigator.userAgent||"",e=navigator.platform||"",t=navigator.maxTouchPoints||1,n=/Android/.test(i),r=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||e==="MacIntel"&&t>1;(function(){(r||n)&&zv.set("maxCanvasPixels",5242880)})(),function(){n&&zv.set("useSystemFonts",!1)}()}var zv,le={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},_C={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},qs={allowedGlobalEvents:{value:null,kind:le.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:le.BROWSER+le.API},isInAutomation:{value:!1,kind:le.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:le.BROWSER},nimbusDataStr:{value:"",kind:le.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:le.BROWSER},supportsDocumentFonts:{value:!0,kind:le.BROWSER},supportsIntegratedFind:{value:!1,kind:le.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:le.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:le.BROWSER},supportsPinchToZoom:{value:!0,kind:le.BROWSER},toolbarDensity:{value:0,kind:le.BROWSER+le.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:le.VIEWER+le.PREFERENCE},annotationEditorMode:{value:0,kind:le.VIEWER+le.PREFERENCE},annotationMode:{value:2,kind:le.VIEWER+le.PREFERENCE},cursorToolOnLoad:{value:0,kind:le.VIEWER+le.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:le.VIEWER},defaultZoomDelay:{value:400,kind:le.VIEWER+le.PREFERENCE},defaultZoomValue:{value:"",kind:le.VIEWER+le.PREFERENCE},disableHistory:{value:!1,kind:le.VIEWER},disablePageLabels:{value:!1,kind:le.VIEWER+le.PREFERENCE},enableAltText:{value:!1,kind:le.VIEWER+le.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:le.VIEWER+le.PREFERENCE+le.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:le.VIEWER+le.PREFERENCE+le.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:le.VIEWER+le.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:le.VIEWER+le.PREFERENCE},enablePermissions:{value:!1,kind:le.VIEWER+le.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:le.VIEWER+le.PREFERENCE},enableScripting:{value:!0,kind:le.VIEWER+le.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:le.VIEWER+le.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:le.VIEWER},externalLinkTarget:{value:0,kind:le.VIEWER+le.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:le.VIEWER+le.PREFERENCE},historyUpdateUrl:{value:!1,kind:le.VIEWER+le.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:le.VIEWER+le.PREFERENCE},imageResourcesPath:{value:"./images/",kind:le.VIEWER},maxCanvasPixels:{value:2**25,kind:le.VIEWER},forcePageColors:{value:!1,kind:le.VIEWER+le.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:le.VIEWER+le.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:le.VIEWER+le.PREFERENCE},pdfBugEnabled:{value:!1,kind:le.VIEWER+le.PREFERENCE},printResolution:{value:150,kind:le.VIEWER},sidebarViewOnLoad:{value:-1,kind:le.VIEWER+le.PREFERENCE},scrollModeOnLoad:{value:-1,kind:le.VIEWER+le.PREFERENCE},spreadModeOnLoad:{value:-1,kind:le.VIEWER+le.PREFERENCE},textLayerMode:{value:1,kind:le.VIEWER+le.PREFERENCE},viewOnLoad:{value:0,kind:le.VIEWER+le.PREFERENCE},cMapPacked:{value:!0,kind:le.API},cMapUrl:{value:"../web/cmaps/",kind:le.API},disableAutoFetch:{value:!1,kind:le.API+le.PREFERENCE},disableFontFace:{value:!1,kind:le.API+le.PREFERENCE},disableRange:{value:!1,kind:le.API+le.PREFERENCE},disableStream:{value:!1,kind:le.API+le.PREFERENCE},docBaseUrl:{value:"",kind:le.API},enableHWA:{value:!0,kind:le.API+le.VIEWER+le.PREFERENCE},enableXfa:{value:!0,kind:le.API+le.PREFERENCE},fontExtraProperties:{value:!1,kind:le.API},isEvalSupported:{value:!0,kind:le.API},isOffscreenCanvasSupported:{value:!0,kind:le.API},maxImageSize:{value:-1,kind:le.API},pdfBug:{value:!1,kind:le.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:le.API},useSystemFonts:{value:void 0,kind:le.API,type:_C.BOOLEAN+_C.UNDEFINED},verbosity:{value:1,kind:le.API},workerPort:{value:null,kind:le.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:le.WORKER}};qs.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:le.VIEWER},qs.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:le.VIEWER},qs.viewerCssTheme={value:0,kind:le.VIEWER+le.PREFERENCE},qs.enableFakeMLManager={value:!0,kind:le.VIEWER};qs.disablePreferences={value:!1,kind:le.VIEWER};var SC=class{static eventBus;static#e=new Map;static{for(let e in qs)this.#e.set(e,qs[e].value);for(let[e,t]of zv)this.#e.set(e,t);this._hasInvokedSet=!1,this._checkDisablePreferences=()=>this.get("disablePreferences")?!0:(this._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)}static get(e){return this.#e.get(e)}static getAll(e=null,t=!1){let n=Object.create(null);for(let r in qs){let s=qs[r];e&&!(e&s.kind)||(n[r]=t?s.value:this.#e.get(r))}return n}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){this._hasInvokedSet||=!0;let n;for(let r in e){let s=qs[r],o=e[r];if(!s||!(typeof o==typeof s.value||_C[(typeof o).toUpperCase()]&s.type))continue;let{kind:a}=s;t&&!(a&le.BROWSER||a&le.PREFERENCE)||(this.eventBus&&a&le.EVENT_DISPATCH&&(n||=new Map).set(r,o),this.#e.set(r,o))}if(n)for(let[r,s]of n)this.eventBus.dispatch(r.toLowerCase(),{source:this,value:s})}},EC=class{#e=null;constructor(e){this.pageIndex=e.pageIndex}render(e="display"){return ce(this,null,function*(){e!=="display"||this.#e||this._cancelled||(this.#e=new GQ({pageIndex:this.pageIndex}))})}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}},N3={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},VK=/^H(\d+)$/,Qv=class{#e=void 0;get renderingDone(){return this.#e!==void 0}render(e){if(this.#e!==void 0)return this.#e;let t=this.#n(e);return t?.classList.add("structTree"),this.#e=t}hide(){this.#e&&!this.#e.hidden&&(this.#e.hidden=!0)}show(){this.#e?.hidden&&(this.#e.hidden=!1)}#t(e,t){let{alt:n,id:r,lang:s}=e;n!==void 0&&t.setAttribute("aria-label",jv(n)),r!==void 0&&t.setAttribute("aria-owns",r),s!==void 0&&t.setAttribute("lang",jv(s,!0))}#n(e){if(!e)return null;let t=document.createElement("span");if("role"in e){let{role:n}=e,r=n.match(VK);r?(t.setAttribute("role","heading"),t.setAttribute("aria-level",r[1])):N3[n]&&t.setAttribute("role",N3[n])}if(this.#t(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#t(e.children[0],t);else for(let n of e.children)t.append(this.#n(n));return t}},CC=class i{#e=!1;#t=null;#n=new Map;#i=new Map;setTextMapping(e){this.#t=e}static#r(e,t){let n=e.getBoundingClientRect(),r=t.getBoundingClientRect();if(n.width===0&&n.height===0)return 1;if(r.width===0&&r.height===0)return-1;let s=n.y,o=n.y+n.height,a=n.y+n.height/2,l=r.y,c=r.y+r.height,d=r.y+r.height/2;if(a<=l&&d>=o)return-1;if(d<=s&&a>=c)return 1;let u=n.x+n.width/2,h=r.x+r.width/2;return u-h}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(i.#r),this.#n.size>0){let e=this.#t;for(let[t,n]of this.#n){if(!document.getElementById(t)){this.#n.delete(t);continue}this.#s(t,e[n])}}for(let[e,t]of this.#i)this.addPointerInTextLayer(e,t);this.#i.clear()}disable(){this.#e&&(this.#i.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#i.delete(e);return}let t=this.#t;if(!t||t.length===0)return;let{id:n}=e,r=this.#n.get(n);if(r===void 0)return;let s=t[r];this.#n.delete(n);let o=s.getAttribute("aria-owns");o?.includes(n)&&(o=o.split(" ").filter(a=>a!==n).join(" "),o?s.setAttribute("aria-owns",o):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#s(e,t){let n=t.getAttribute("aria-owns");n?.includes(e)||t.setAttribute("aria-owns",n?`${n} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){let{id:n}=e;if(!n)return null;if(!this.#e)return this.#i.set(e,t),null;t&&this.removePointerInTextLayer(e);let r=this.#t;if(!r||r.length===0)return null;let s=Af(r,c=>i.#r(e,c)<0),o=Math.max(0,s-1),a=r[o];this.#s(n,a),this.#n.set(n,o);let l=a.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(e,t,n,r){let s=this.addPointerInTextLayer(n,r);if(!e.hasChildNodes())return e.append(t),s;let o=Array.from(e.childNodes).filter(c=>c!==t);if(o.length===0)return s;let a=n||t,l=Af(o,c=>i.#r(a,c)<0);return l===0?o[0].before(t):o[l-1].after(t),s}},MC=class{#e=null;constructor({findController:e,eventBus:t,pageIndex:n}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=n,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];let{textContentItemsStr:n}=this,r=0,s=0,o=n.length-1,a=[];for(let l=0,c=e.length;l<c;l++){let d=e[l];for(;r!==o&&d>=s+n[r].length;)s+=n[r].length,r++;r===n.length&&console.error("Could not find a matching mapping");let u={begin:{divIdx:r,offset:d-s}};for(d+=t[l];r!==o&&d>s+n[r].length;)s+=n[r].length,r++;u.end={divIdx:r,offset:d-s},a.push(u)}return a}_renderMatches(e){if(e.length===0)return;let{findController:t,pageIdx:n}=this,{textContentItemsStr:r,textDivs:s}=this,o=n===t.selected.pageIdx,a=t.selected.matchIdx,l=t.state.highlightAll,c=null,d={divIdx:-1,offset:void 0};function u(m,y){let w=m.divIdx;return s[w].textContent="",h(w,0,m.offset,y)}function h(m,y,w,A){let C=s[m];if(C.nodeType===Node.TEXT_NODE){let L=document.createElement("span");C.before(L),L.append(C),s[m]=L,C=L}let E=r[m].substring(y,w),T=document.createTextNode(E);if(A){let L=document.createElement("span");return L.className=`${A} appended`,L.append(T),C.append(L),A.includes("selected")?L.offsetLeft:0}return C.append(T),0}let f=a,p=f+1;if(l)f=0,p=e.length;else if(!o)return;let v=-1,g=-1;for(let m=f;m<p;m++){let y=e[m],w=y.begin;if(w.divIdx===v&&w.offset===g)continue;v=w.divIdx,g=w.offset;let A=y.end,C=o&&m===a,E=C?" selected":"",T=0;if(!c||w.divIdx!==c.divIdx?(c!==null&&h(c.divIdx,c.offset,d.offset),u(w)):h(c.divIdx,c.offset,w.offset),w.divIdx===A.divIdx)T=h(w.divIdx,w.offset,A.offset,"highlight"+E);else{T=h(w.divIdx,w.offset,d.offset,"highlight begin"+E);for(let L=w.divIdx+1,S=A.divIdx;L<S;L++)s[L].className="highlight middle"+E;u(A,"highlight end"+E)}c=A,C&&t.scrollMatchIntoView({element:s[w.divIdx],selectedLeft:T,pageIndex:n,matchIndex:a})}c&&h(c.divIdx,c.offset,d.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;let{findController:t,matches:n,pageIdx:r}=this,{textContentItemsStr:s,textDivs:o}=this,a=-1;for(let d of n){let u=Math.max(a,d.begin.divIdx);for(let h=u,f=d.end.divIdx;h<=f;h++){let p=o[h];p.textContent=s[h],p.className=""}a=d.end.divIdx+1}if(!t?.highlightMatches||e)return;let l=t.pageMatches[r]||null,c=t.pageMatchesLength[r]||null;this.matches=this._convertMatches(l,c),this._renderMatches(this.matches)}},Kv=class i{#e=!1;#t=null;#n=!1;#i=null;static#r=new Map;static#s=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:n=null,enablePermissions:r=!1,onAppend:s=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=n,this.#e=r===!0,this.#t=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}render(e,t=null){return ce(this,null,function*(){if(this.#n&&this.#i){this.#i.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#i=new YQ({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});let{textDivs:n,textContentItemsStr:r}=this.#i;this.highlighter?.setTextMapping(n,r),this.accessibilityManager?.setTextMapping(n),yield this.#i.render(),this.#n=!0;let s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#a(s),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()})}hide(){!this.div.hidden&&this.#n&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#n&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#i?.cancel(),this.#i=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),i.#l(this.div)}#a(e){let{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",n=>{if(!this.#e){let r=document.getSelection();n.clipboardData.setData("text/plain",jv(ZQ(r.toString())))}n.preventDefault(),n.stopPropagation()}),i.#r.set(t,e),i.#u()}static#l(e){this.#r.delete(e),this.#r.size===0&&(this.#s?.abort(),this.#s=null)}static#u(){if(this.#s)return;this.#s=new AbortController;let{signal:e}=this.#s,t=(o,a)=>{a.append(o),o.style.width="",o.style.height="",a.classList.remove("selecting")},n=!1;document.addEventListener("pointerdown",()=>{n=!0},{signal:e}),document.addEventListener("pointerup",()=>{n=!1,this.#r.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{n=!1,this.#r.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{n||this.#r.forEach(t)},{signal:e});var r,s;document.addEventListener("selectionchange",()=>{let o=document.getSelection();if(o.rangeCount===0){this.#r.forEach(t);return}let a=new Set;for(let f=0;f<o.rangeCount;f++){let p=o.getRangeAt(f);for(let v of this.#r.keys())!a.has(v)&&p.intersectsNode(v)&&a.add(v)}for(let[f,p]of this.#r)a.has(f)?f.classList.add("selecting"):t(p,f);if(r??=getComputedStyle(this.#r.values().next().value).getPropertyValue("-moz-user-select")==="none",r)return;let l=o.getRangeAt(0),c=s&&(l.compareBoundaryPoints(Range.END_TO_END,s)===0||l.compareBoundaryPoints(Range.START_TO_END,s)===0),d=c?l.startContainer:l.endContainer;d.nodeType===Node.TEXT_NODE&&(d=d.parentNode);let u=d.parentElement.closest(".textLayer"),h=this.#r.get(u);h&&(h.style.width=u.style.width,h.style.height=u.style.height,d.parentElement.insertBefore(h,c?d:d.nextSibling)),s=l.cloneRange()},{signal:e})}},Jv=class{constructor({pdfPage:e,annotationStorage:t=null,linkService:n,xfaHtml:r=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=n,this.xfaHtml=r,this.div=null,this._cancelled=!1}render(e,t="display"){return ce(this,null,function*(){if(t==="print"){let s={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),s.div=this.div,tC.render(s)}let n=yield this.pdfPage.getXfa();if(this._cancelled||!n)return{textDivs:[]};let r={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:n,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?tC.update(r):(this.div=document.createElement("div"),r.div=this.div,tC.render(r))})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}},UK={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new _f}},HK=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]),$v=class{#e=Go.ENABLE_FORMS;#t=!1;#n=!1;#i=!1;#r=null;#s=null;#a=null;#l=null;#u=Rn.INITIAL;#c=Ws.ENABLE;#d={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#o=new WeakMap;#h=[null,null,null,null];constructor(e){let t=e.container,n=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#r=e.layerProperties||UK,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||B3,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#c=e.textLayerMode??Ws.ENABLE,this.#e=e.annotationMode??Go.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.maxCanvasPixels=e.maxCanvasPixels??SC.get("maxCanvasPixels"),this.pageColors=e.pageColors||null,this.#t=e.enableHWA||!1,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n,this.l10n||=new Qd,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;let r=document.createElement("div");if(r.className="page",r.setAttribute("data-page-number",this.id),r.setAttribute("role","region"),r.setAttribute("data-l10n-id","pdfjs-page-landmark"),r.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=r,this.#f(),t?.append(r),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*jo.PDF_TO_CSS_UNITS);let{optionalContentConfigPromise:s}=e;s&&s.then(o=>{s===this._optionalContentConfigPromise&&(this.#d.initialOptionalContent=o.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#p(e,t){let n=HK.get(t),r=this.#h[n];if(this.#h[n]=e,r){r.replaceWith(e);return}for(let s=n-1;s>=0;s--){let o=this.#h[s];if(o){o.after(e);return}}this.div.prepend(e)}get renderingState(){return this.#u}set renderingState(e){if(e!==this.#u)switch(this.#u=e,this.#s&&(clearTimeout(this.#s),this.#s=null),e){case Rn.PAUSED:this.div.classList.remove("loading");break;case Rn.RUNNING:this.div.classList.add("loadingIcon"),this.#s=setTimeout(()=>{this.div.classList.add("loading"),this.#s=null},0);break;case Rn.INITIAL:case Rn.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#f(){let{viewport:e}=this;if(this.pdfPage){if(this.#a===e.rotation)return;this.#a=e.rotation}XQ(this.div,e,!0,!1)}setPdfPage(e){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;let t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*jo.PDF_TO_CSS_UNITS,rotation:t}),this.#f(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return Wv(this,"_textHighlighter",new MC({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#r.findController}))}#m(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}#v(){return ce(this,null,function*(){let e=null;try{yield this.annotationLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.#m("annotationlayerrendered",e)}})}#g(){return ce(this,null,function*(){let e=null;try{yield this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.#m("annotationeditorlayerrendered",e)}})}#x(){return ce(this,null,function*(){try{yield this.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}})}#y(){return ce(this,null,function*(){let e=null;try{let t=yield this.xfaLayer.render(this.viewport,"display");t?.textDivs&&this._textHighlighter&&this.#S(t.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#p(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#m("xfalayerrendered",e)}})}#A(){return ce(this,null,function*(){if(!this.textLayer)return;let e=null;try{yield this.textLayer.render(this.viewport)}catch(t){if(t instanceof VQ)return;console.error(`#renderTextLayer: "${t}".`),e=t}this.#m("textlayerrendered",e),this.#b()})}#b(){return ce(this,null,function*(){if(!this.textLayer)return;this.structTreeLayer||=new Qv;let e=yield this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree(),t=this.structTreeLayer?.render(e);t&&(this.l10n.pause(),this.canvas?.append(t),this.l10n.resume()),this.structTreeLayer?.show()})}#S(e){return ce(this,null,function*(){let t=yield this.pdfPage.getTextContent(),n=[];for(let r of t.items)n.push(r.str);this._textHighlighter.setTextMapping(e,n),this._textHighlighter.enable()})}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;let t=this.zoomLayer.firstChild;this.#o.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:r=!1,keepTextLayer:s=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:n,keepXfaLayer:r,keepTextLayer:s}),this.renderingState=Rn.INITIAL;let o=this.div,a=o.childNodes,l=e&&this.zoomLayer||null,c=t&&this.annotationLayer?.div||null,d=n&&this.annotationEditorLayer?.div||null,u=r&&this.xfaLayer?.div||null,h=s&&this.textLayer?.div||null;for(let f=a.length-1;f>=0;f--){let p=a[f];switch(p){case l:case c:case d:case u:case h:continue}p.remove();let v=this.#h.indexOf(p);v>=0&&(this.#h[v]=null)}o.removeAttribute("data-loaded"),c&&this.annotationLayer.hide(),d&&this.annotationEditorLayer.hide(),u&&this.xfaLayer.hide(),h&&this.textLayer.hide(),this.structTreeLayer?.hide(),l||(this.canvas&&(this.#o.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(e){this.hasEditableAnnotations()&&(this.#i=e,this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:n=null,drawingDelay:r=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),n instanceof Promise&&(this._optionalContentConfigPromise=n,n.then(o=>{n===this._optionalContentConfigPromise&&(this.#d.initialOptionalContent=o.hasInitialVisibility)})),this.#d.directDrawing=!0;let s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*jo.PDF_TO_CSS_UNITS,rotation:s}),this.#f(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let o=!1;if(this.#n){if(this.maxCanvasPixels===0)o=!0;else if(this.maxCanvasPixels>0){let{width:l,height:c}=this.viewport,{sx:d,sy:u}=this.outputScale;o=(Math.floor(l)*d|0)*(Math.floor(c)*u|0)>this.maxCanvasPixels}}let a=r>=0&&r<1e3;if(a||o){if(a&&!o&&this.renderingState!==Rn.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:r}),this.renderingState=Rn.FINISHED,this.#d.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!a,hideTextLayer:a}),a)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#l});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:n=!1,keepTextLayer:r=!1,cancelExtraDelay:s=0}={}){this.renderTask&&(this.renderTask.cancel(s),this.renderTask=null),this.resume=null,this.textLayer&&(!r||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!n||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:n=!1,redrawXfaLayer:r=!1,redrawTextLayer:s=!1,hideTextLayer:o=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);let{style:l}=e;l.width=l.height=""}let a=this.#o.get(e);if(this.viewport!==a){let l=this.viewport.rotation-a.rotation,c=Math.abs(l),d=1,u=1;if(c===90||c===270){let{width:h,height:f}=this.viewport;d=f/h,u=h/f}e.style.transform=`rotate(${l}deg) scale(${d}, ${u})`}t&&this.annotationLayer&&this.#v(),n&&this.annotationEditorLayer&&(this.drawLayer&&this.#x(),this.#g()),r&&this.xfaLayer&&this.#y(),this.textLayer&&(o?(this.textLayer.hide(),this.structTreeLayer?.hide()):s&&this.#A())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}#D(e,t=null){return ce(this,null,function*(){if(e===this.renderTask&&(this.renderTask=null),t instanceof cC){this.#l=null;return}if(this.#l=t,this.renderingState=Rn.FINISHED,this._resetZoomLayer(!0),this.#d.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#l}),t)throw t})}draw(){return ce(this,null,function*(){this.renderingState!==Rn.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());let{div:e,l10n:t,pageColors:n,pdfPage:r,viewport:s}=this;if(!r)throw this.renderingState=Rn.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Rn.RUNNING;let o=document.createElement("div");if(o.classList.add("canvasWrapper"),this.#p(o,"canvasWrapper"),!this.textLayer&&this.#c!==Ws.DISABLE&&!r.isPureXfa&&(this._accessibilityManager||=new CC,this.textLayer=new Kv({pdfPage:r,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#c===Ws.ENABLE_PERMISSIONS,onAppend:E=>{this.l10n.pause(),this.#p(E,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==Go.DISABLE){let{annotationStorage:E,annotationEditorUIManager:T,downloadManager:L,enableScripting:S,fieldObjectsPromise:_,hasJSActionsPromise:P,linkService:U}=this.#r;this._annotationCanvasMap||=new Map,this.annotationLayer=new qv({pdfPage:r,annotationStorage:E,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===Go.ENABLE_FORMS,linkService:U,downloadManager:L,enableScripting:S,hasJSActionsPromise:P,fieldObjectsPromise:_,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:T,onAppend:O=>{this.#p(O,"annotationLayer")}})}let a=E=>{if(h?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=Rn.PAUSED,this.resume=()=>{this.renderingState=Rn.RUNNING,E()};return}E()},{width:l,height:c}=s,d=document.createElement("canvas");d.setAttribute("role","presentation"),d.hidden=!0;let u=!!(n?.background&&n?.foreground),h=E=>{(!u||E)&&(d.hidden=!1,h=null)};o.append(d),this.canvas=d;let f=d.getContext("2d",{alpha:!1,willReadFrequently:!this.#t}),p=this.outputScale=new oC;if(this.maxCanvasPixels===0){let E=1/this.scale;p.sx*=E,p.sy*=E,this.#n=!0}else if(this.maxCanvasPixels>0){let E=l*c,T=Math.sqrt(this.maxCanvasPixels/E);p.sx>T||p.sy>T?(p.sx=T,p.sy=T,this.#n=!0):this.#n=!1}let v=c3(p.sx),g=c3(p.sy);d.width=Ov(l*p.sx,v[0]),d.height=Ov(c*p.sy,g[0]);let{style:m}=d;m.width=Ov(l,v[1])+"px",m.height=Ov(c,g[1])+"px",this.#o.set(d,s);let y=p.scaled?[p.sx,0,0,p.sy,0,0]:null,w={canvasContext:f,transform:y,viewport:s,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:n,isEditing:this.#i},A=this.renderTask=r.render(w);A.onContinue=a;let C=A.promise.then(()=>ce(this,null,function*(){h?.(!0),yield this.#D(A),this.#A(),this.annotationLayer&&(yield this.#v());let{annotationEditorUIManager:E}=this.#r;E&&(this.drawLayer||=new EC({pageIndex:this.id}),yield this.#x(),this.drawLayer.setParent(o),this.annotationEditorLayer||=new AC({uiManager:E,pdfPage:r,l10n:t,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:T=>{this.#p(T,"annotationEditorLayer")}}),this.#g())}),E=>(E instanceof cC||h?.(!0),this.#D(A,E)));if(r.isPureXfa){if(!this.xfaLayer){let{annotationStorage:E,linkService:T}=this.#r;this.xfaLayer=new Jv({pdfPage:r,annotationStorage:E,linkService:T})}this.#y()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),C})}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){let{directDrawing:e,initialOptionalContent:t,regularAnnotations:n}=this.#d;return e&&t&&n?this.canvas:null}};function zK(i){return ce(this,null,function*(){let e="",t=e.split("#",1)[0],{info:n,metadata:r,contentDispositionFilename:s,contentLength:o}=yield i.getMetadata();if(!o){let{length:a}=yield i.getDownloadInfo();o=a}return Ge(re({},n),{baseURL:t,filesize:o,filename:s||WQ(e),metadata:r?.getRaw(),authors:r?.get("dc:creator"),numPages:i.numPages,URL:e})})}var TC=class{constructor(e){this._ready=new Promise((t,n)=>{import(e).then(s=>{t(s.QuickJSSandbox())}).catch(n)})}createSandbox(e){return ce(this,null,function*(){(yield this._ready).create(e)})}dispatchEventInSandbox(e){return ce(this,null,function*(){let t=yield this._ready;setTimeout(()=>t.dispatchEvent(e),0)})}destroySandbox(){return ce(this,null,function*(){(yield this._ready).nukeSandbox()})}},IC=class{#e=null;#t=null;#n=null;#i=null;#r=null;#s=null;#a=null;#l=null;#u=!1;#c=null;#d=null;constructor({eventBus:e,externalServices:t=null,docProperties:n=null}){this.#r=e,this.#s=t,this.#n=n}setViewer(e){this.#l=e}setDocument(e){return ce(this,null,function*(){if(this.#a&&(yield this.#m()),this.#a=e,!e)return;let[t,n,r]=yield Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!r){yield this.#m();return}if(e!==this.#a)return;try{this.#c=this.#f()}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#m();return}let s=this.#r;this.#i=new AbortController;let{signal:o}=this.#i;s._on("updatefromsandbox",a=>{a?.source===window&&this.#o(a.detail)},{signal:o}),s._on("dispatcheventinsandbox",a=>{this.#c?.dispatchEventInSandbox(a.detail)},{signal:o}),s._on("pagechanging",({pageNumber:a,previous:l})=>{a!==l&&(this.#p(l),this.#h(a))},{signal:o}),s._on("pagerendered",({pageNumber:a})=>{this._pageOpenPending.has(a)&&a===this.#l.currentPageNumber&&this.#h(a)},{signal:o}),s._on("pagesdestroy",()=>ce(this,null,function*(){yield this.#p(this.#l.currentPageNumber),yield this.#c?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()}),{signal:o});try{let a=yield this.#n(e);if(e!==this.#a)return;yield this.#c.createSandbox({objects:t,calculationOrder:n,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:Ge(re({},a),{actions:r})}),s.dispatch("sandboxcreated",{source:this})}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#m();return}yield this.#c?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield this.#h(this.#l.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#a&&(this.#u=!0)})})}dispatchWillSave(){return ce(this,null,function*(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})}dispatchDidSave(){return ce(this,null,function*(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})}dispatchWillPrint(){return ce(this,null,function*(){if(this.#c){yield this.#d?.promise,this.#d=Promise.withResolvers();try{yield this.#c.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#d.resolve(),this.#d=null,e}yield this.#d.promise}})}dispatchDidPrint(){return ce(this,null,function*(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#u}get _pageOpenPending(){return Wv(this,"_pageOpenPending",new Set)}get _visitedPages(){return Wv(this,"_visitedPages",new Map)}#o(e){return ce(this,null,function*(){let t=this.#l,n=t.isInPresentationMode||t.isChangingPresentationMode,{id:r,siblings:s,command:o,value:a}=e;if(!r){switch(o){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(!n){let c=gQ(a);t.spreadMode=c.spreadMode}break;case"page-num":t.currentPageNumber=a+1;break;case"print":yield t.pagesPromise,this.#r.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":n||(t.currentScaleValue=a);break;case"SaveAs":this.#r.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":n||t.increaseScale();break;case"ZoomViewOut":n||t.decreaseScale();break;case"WillPrintFinished":this.#d?.resolve(),this.#d=null;break}return}if(n&&e.focus)return;delete e.id,delete e.siblings;let l=s?[r,...s]:[r];for(let c of l){let d=document.querySelector(`[data-element-id="${c}"]`);d?d.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#a?.annotationStorage.setValue(c,e)}})}#h(e,t=!1){return ce(this,null,function*(){let n=this.#a,r=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;let s=this.#l.getPageView(e-1);if(s?.renderingState!==Rn.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);let o=ce(this,null,function*(){let a=yield r.has(e)?null:s.pdfPage?.getJSActions();n===this.#a&&(yield this.#c?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:a}))});r.set(e,o)})}#p(e){return ce(this,null,function*(){let t=this.#a,n=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;let r=n.get(e);r&&(n.set(e,null),yield r,t===this.#a&&(yield this.#c?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})))})}#f(){if(this.#t=Promise.withResolvers(),this.#c)throw new Error("#initScripting: Scripting already exists.");return this.#s.createScripting()}#m(){return ce(this,null,function*(){if(!this.#c){this.#a=null,this.#t?.resolve();return}this.#e&&(yield Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#a=null;try{yield this.#c.destroySandbox()}catch{}this.#d?.reject(new Error("Scripting destroyed.")),this.#d=null,this.#i?.abort(),this.#i=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#c=null,this.#u=!1,this.#t?.resolve()})}},DC=class extends IC{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}),e.externalServices||={createScripting:()=>new TC(e.sandboxBundleSrc)},e.docProperties||=t=>zK(t),super(e)}},jK=3e4,PC=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),jK)))}getHighestPriority(e,t,n,r=!1){let s=e.views,o=s.length;if(o===0)return null;for(let u=0;u<o;u++){let h=s[u].view;if(!this.isViewFinished(h))return h}let a=e.first.id,l=e.last.id;if(l-a+1>o){let u=e.ids;for(let h=1,f=l-a;h<f;h++){let p=n?a+h:l-h;if(u.has(p))continue;let v=t[p-1];if(!this.isViewFinished(v))return v}}let c=n?l:a-2,d=t[c];return d&&!this.isViewFinished(d)||r&&(c+=n?1:-1,d=t[c],d&&!this.isViewFinished(d))?d:null}isViewFinished(e){return e.renderingState===Rn.FINISHED}renderView(e){switch(e.renderingState){case Rn.FINISHED:return!1;case Rn.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case Rn.RUNNING:this.highestPriorityPage=e.renderingId;break;case Rn.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof cC||console.error(`renderView: "${t}"`)});break}return!0}},F3=10,Hv={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function O3(i){return Object.values(xr).includes(i)&&i!==xr.DISABLE}var RC=class{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){let t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#n()}resize(e,t=null){this.#t=e;let n=this.#e;if(t){let r=n.size,s=1;for(let o of n)if(t.has(o.id)&&(n.delete(o),n.add(o)),++s>r)break}for(;n.size>this.#t;)this.#n()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#n(){let e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}},ex=class{#e=null;#t=null;#n=null;#i=xr.NONE;#r=null;#s=Go.ENABLE_FORMS;#a=null;#l=!1;#u=!1;#c=!1;#d=!1;#o=!1;#h=null;#p=null;#f=null;#m=null;#v=!1;#g=null;#x=!1;#y=0;#A=new ResizeObserver(this.#O.bind(this));#b=null;#S=null;#D=Ws.ENABLE;constructor(e){let t="4.6.82";if(x3!==t)throw new Error(`The API version "${x3}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#A.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new _f,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=r=>this._getVisiblePages().ids.has(r)),this._scriptingManager=e.scriptingManager||null,this.#D=e.textLayerMode??Ws.ENABLE,this.#s=e.annotationMode??Go.ENABLE_FORMS,this.#i=e.annotationEditorMode??xr.NONE,this.#n=e.annotationEditorHighlightColors||null,this.#u=e.enableHighlightFloatingButton===!0,this.#d=e.enableUpdatedAddImage===!0,this.#o=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n,this.l10n||=new Qd,this.#c=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#p=e.mlManager||null,this.#l=e.enableHWA||!1,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new PC,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;let{abortSignal:n}=e;n?.addEventListener("abort",()=>{this.#A.disconnect(),this.#A=null},{once:!0}),this.scroll=cQ(this.container,this._scrollUpdate.bind(this),n),this.presentationModeState=Zd.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#N(),this.eventBus._on("thumbnailrendered",({pageNumber:r,pdfPage:s})=>{let o=this._pages[r-1];this.#e.has(o)||s?.cleanup()}),e.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#s===Go.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#R(),!0;if(!(0<e&&e<=this.pagesCount))return!1;let n=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:n}),t&&this.#R(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){let n=this._pageLabels.indexOf(e);n>=0&&(t=n+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==KE?this._currentScale:B3}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#I(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#I(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!U3(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;let t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#I(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){let e=this;return Wv(this,"_layerProperties",{get annotationEditorUIManager(){return e.#r},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#M(e){let t={annotationEditorMode:this.#i,annotationMode:this.#s,textLayerMode:this.#D};return e&&(!e.includes(Vv.COPY)&&this.#D===Ws.ENABLE&&(t.textLayerMode=Ws.ENABLE_PERMISSIONS),e.includes(Vv.MODIFY_CONTENTS)||(t.annotationEditorMode=xr.DISABLE),!e.includes(Vv.MODIFY_ANNOTATIONS)&&!e.includes(Vv.FILL_INTERACTIVE_FORMS)&&this.#s===Go.ENABLE_FORMS&&(t.annotationMode=Go.ENABLE)),t}#_(e){return ce(this,null,function*(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;let t=Promise.withResolvers();function n(){document.visibilityState==="hidden"&&t.resolve()}document.addEventListener("visibilitychange",n,{signal:e}),yield Promise.race([this._onePageRenderedCapability.promise,t.promise]),document.removeEventListener("visibilitychange",n)})}getAllText(){return ce(this,null,function*(){let e=[],t=[];for(let n=1,r=this.pdfDocument.numPages;n<=r;++n){if(this.#x)return null;t.length=0;let s=yield this.pdfDocument.getPage(n),{items:o}=yield s.getTextContent();for(let a of o)a.str&&t.push(a.str),a.hasEOL&&t.push(`
`);e.push(jv(t.join("")))}return e.join(`
`)})}#T(e,t){let n=document.getSelection(),{focusNode:r,anchorNode:s}=n;if(s&&r&&n.containsNode(this.#g)){if(this.#v||e===Ws.ENABLE_PERMISSIONS){t.preventDefault(),t.stopPropagation();return}this.#v=!0;let{classList:o}=this.viewer;o.add("copyAll");let a=new AbortController;window.addEventListener("keydown",l=>this.#x=l.key==="Escape",{signal:a.signal}),this.getAllText().then(l=>ce(this,null,function*(){l!==null&&(yield navigator.clipboard.writeText(l))})).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#v=!1,this.#x=!1,a.abort(),o.remove("copyAll")}),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#r?.destroy(),this.#r=null),this.pdfDocument=e,!e)return;let t=e.numPages,n=e.getPage(1),r=e.getOptionalContentConfig({intent:"display"}),s=this.#c?e.getPermissions():Promise.resolve(),{eventBus:o,pageColors:a,viewer:l}=this;this.#h=new AbortController;let{signal:c}=this.#h;if(t>Hv.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");let h=this._scrollMode=Zt.PAGE;o.dispatch("scrollmodechanged",{source:this,mode:h})}this._pagesCapability.promise.then(()=>{o.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});let d=h=>{let f=this._pages[h.pageNumber-1];f&&this.#e.push(f)};o._on("pagerender",d,{signal:c});let u=h=>{h.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:h.timestamp}),o._off("pagerendered",u))};o._on("pagerendered",u,{signal:c}),Promise.all([n,s]).then(([h,f])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(h),this._optionalContentConfigPromise=r;let{annotationEditorMode:p,annotationMode:v,textLayerMode:g}=this.#M(f);if(g!==Ws.DISABLE){let A=this.#g=document.createElement("div");A.id="hiddenCopyElement",l.before(A)}if(typeof AbortSignal.any=="function"&&p!==xr.DISABLE){let A=p;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):O3(A)?(this.#r=new HQ(this.container,l,this.#t,o,e,a,this.#n,this.#u,this.#d,this.#o,this.#p),o.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#r}),A!==xr.NONE&&(A===xr.STAMP&&this.#p?.loadModel("altText"),this.#r.updateMode(A))):console.error(`Invalid AnnotationEditor mode: ${A}`)}let m=this._scrollMode===Zt.PAGE?null:l,y=this.currentScale,w=h.getViewport({scale:y*jo.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",w.scale),(a?.foreground==="CanvasText"||a?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let A=1;A<=t;++A){let C=new $v({container:m,eventBus:o,id:A,scale:y,defaultViewport:w.clone(),optionalContentConfigPromise:r,renderingQueue:this.renderingQueue,textLayerMode:g,annotationMode:v,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:a,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#l});this._pages.push(C)}this._pages[0]?.setPdfPage(h),this._scrollMode===Zt.PAGE?this.#C():this._spreadMode!==Pi.NONE&&this._updateSpreadMode(),this.#_(c).then(()=>ce(this,null,function*(){if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#g&&document.addEventListener("copy",this.#T.bind(this,g),{signal:c}),this.#r&&o.dispatch("annotationeditormodechanged",{source:this,mode:this.#i}),e.loadingParams.disableAutoFetch||t>Hv.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let A=t-1;if(A<=0){this._pagesCapability.resolve();return}for(let C=2;C<=t;++C){let E=e.getPage(C).then(T=>{let L=this._pages[C-1];L.pdfPage||L.setPdfPage(T),--A===0&&this._pagesCapability.resolve()},T=>{console.error(`Unable to get page ${C} to initialize viewer`,T),--A===0&&this._pagesCapability.resolve()});C%Hv.PAUSE_EAGER_PAGE_INIT===0&&(yield E)}})),o.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:A})=>{e===this.pdfDocument&&A.Language&&(l.lang=A.Language)}),this.defaultRenderingQueue&&this.update()}).catch(h=>{console.error("Unable to initialize viewer",h),this._pagesCapability.reject(h)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,n=this._pages.length;t<n;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=KE,this._currentScaleValue=null,this._pageLabels=null,this.#e=new RC(F3),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Zt.VERTICAL,this._previousScrollMode=Zt.UNKNOWN,this._spreadMode=Pi.NONE,this.#b={previousPageNumber:1,scrollDown:!0,pages:[]},this.#h?.abort(),this.#h=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#g?.remove(),this.#g=null,this.#B()}#C(){if(this._scrollMode!==Zt.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");let e=this._currentPageNumber,t=this.#b,n=this.viewer;if(n.textContent="",t.pages.length=0,this._spreadMode===Pi.NONE&&!this.isInPresentationMode){let r=this._pages[e-1];n.append(r.div),t.pages.push(r)}else{let r=new Set,s=this._spreadMode-1;s===-1?r.add(e-1):e%2!==s?(r.add(e-1),r.add(e)):(r.add(e-2),r.add(e-1));let o=document.createElement("div");if(o.className="spread",this.isInPresentationMode){let a=document.createElement("div");a.className="dummyPage",o.append(a)}for(let a of r){let l=this._pages[a];l&&(o.append(l.div),t.pages.push(l))}n.append(o)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#P(e,t=null){let{div:n,id:r}=e;if(this._currentPageNumber!==r&&this._setCurrentPageNumber(r),this._scrollMode===Zt.PAGE&&(this.#C(),this.update()),!t&&!this.isInPresentationMode){let s=n.offsetLeft+n.clientLeft,o=s+n.clientWidth,{scrollLeft:a,clientWidth:l}=this.container;(this._scrollMode===Zt.HORIZONTAL||s<a||o>a+l)&&(t={left:0,top:0})}V3(n,t),!this._currentScaleValue&&this._location&&(this._location=null)}#k(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#E(e,t,{noScroll:n=!1,preset:r=!1,drawingDelay:s=-1,origin:o=null}){if(this._currentScaleValue=t.toString(),this.#k(e)){r&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*jo.PDF_TO_CSS_UNITS);let a=s>=0&&s<1e3;this.refresh(!0,{scale:e,drawingDelay:a?s:-1}),a&&(this.#S=setTimeout(()=>{this.#S=null,this.refresh()},s));let l=this._currentScale;if(this._currentScale=e,!n){let c=this._currentPageNumber,d;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(c=this._location.pageNumber,d=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:c,destArray:d,allowNegativeOffset:!0}),Array.isArray(o)){let u=e/l-1,[h,f]=this.containerTopLeft;this.container.scrollLeft+=(o[0]-f)*u,this.container.scrollTop+=(o[1]-h)*u}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:r?t:void 0}),this.defaultRenderingQueue&&this.update()}get#w(){return this._spreadMode!==Pi.NONE&&this._scrollMode!==Zt.HORIZONTAL?2:1}#I(e,t){let n=parseFloat(e);if(n>0)t.preset=!1,this.#E(n,e,t);else{let r=this._pages[this._currentPageNumber-1];if(!r)return;let s=o3,o=a3;this.isInPresentationMode?(s=o=4,this._spreadMode!==Pi.NONE&&(s*=2)):this.removePageBorders?s=o=0:this._scrollMode===Zt.HORIZONTAL&&([s,o]=[o,s]);let a=(this.container.clientWidth-s)/r.width*r.scale/this.#w,l=(this.container.clientHeight-o)/r.height*r.scale;switch(e){case"page-actual":n=1;break;case"page-width":n=a;break;case"page-height":n=l;break;case"page-fit":n=Math.min(a,l);break;case"auto":let c=d3(r)?a:Math.min(l,a);n=Math.min(lQ,c);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#E(n,e,t)}}#R(){let e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#I(this._currentScaleValue,{noScroll:!0}),this.#P(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;let t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:n=!1,ignoreDestinationZoom:r=!1}){if(!this.pdfDocument)return;let s=Number.isInteger(e)&&this._pages[e-1];if(!s){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let o=0,a=0,l=0,c=0,d,u,h=s.rotation%180!==0,f=(h?s.height:s.width)/s.scale/jo.PDF_TO_CSS_UNITS,p=(h?s.width:s.height)/s.scale/jo.PDF_TO_CSS_UNITS,v=0;switch(t[1].name){case"XYZ":o=t[2],a=t[3],v=t[4],o=o!==null?o:0,a=a!==null?a:p;break;case"Fit":case"FitB":v="page-fit";break;case"FitH":case"FitBH":a=t[2],v="page-width",a===null&&this._location?(o=this._location.left,a=this._location.top):(typeof a!="number"||a<0)&&(a=p);break;case"FitV":case"FitBV":o=t[2],l=f,c=p,v="page-height";break;case"FitR":o=t[2],a=t[3],l=t[4]-o,c=t[5]-a;let w=o3,A=a3;this.removePageBorders&&(w=A=0),d=(this.container.clientWidth-w)/l/jo.PDF_TO_CSS_UNITS,u=(this.container.clientHeight-A)/c/jo.PDF_TO_CSS_UNITS,v=Math.min(Math.abs(d),Math.abs(u));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(r||(v&&v!==this._currentScale?this.currentScaleValue=v:this._currentScale===KE&&(this.currentScaleValue=sQ)),v==="page-fit"&&!t[4]){this.#P(s);return}let g=[s.viewport.convertToViewportPoint(o,a),s.viewport.convertToViewportPoint(o+l,a+c)],m=Math.min(g[0][0],g[1][0]),y=Math.min(g[0][1],g[1][1]);n||(m=Math.max(m,0),y=Math.max(y,0)),this.#P(s,{left:m,top:y})}_updateLocation(e){let t=this._currentScale,n=this._currentScaleValue,r=parseFloat(n)===t?Math.round(t*1e4)/100:n,s=e.id,o=this._pages[s-1],a=this.container,l=o.getPagePoint(a.scrollLeft-e.x,a.scrollTop-e.y),c=Math.round(l[0]),d=Math.round(l[1]),u=`#page=${s}`;this.isInPresentationMode||(u+=`&zoom=${r},${c},${d}`),this._location={pageNumber:s,scale:r,top:d,left:c,rotation:this._pagesRotation,pdfOpenParams:u}}update(){let e=this._getVisiblePages(),t=e.views,n=t.length;if(n===0)return;let r=Math.max(F3,2*n+1);this.#e.resize(r,e.ids),this.renderingQueue.renderHighestPriority(e);let s=this._spreadMode===Pi.NONE&&(this._scrollMode===Zt.PAGE||this._scrollMode===Zt.VERTICAL),o=this._currentPageNumber,a=!1;for(let l of t){if(l.percent<100)break;if(l.id===o&&s){a=!0;break}}this._setCurrentPageNumber(a?o:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#F(){let e=this._getVisiblePages(),t=[],{ids:n,views:r}=e;for(let s of r){let{view:o}=s;if(!o.hasEditableAnnotations()){n.delete(o.id);continue}t.push(s)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:n}),n)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===Zd.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===Zd.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){let e=this._scrollMode===Zt.PAGE?this.#b.pages:this._pages,t=this._scrollMode===Zt.HORIZONTAL,n=t&&this._isContainerRtl;return uQ({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:n})}cleanup(){for(let e of this._pages)e.renderingState!==Rn.FINISHED&&e.reset()}_cancelRendering(){for(let e of this._pages)e.cancelRendering()}#H(e){return ce(this,null,function*(){if(e.pdfPage)return e.pdfPage;try{let t=yield this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}})}#V(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Zt.PAGE:return this.#b.scrollDown;case Zt.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){let t=e||this._getVisiblePages(),n=this.#V(t),r=this._spreadMode!==Pi.NONE&&this._scrollMode!==Zt.HORIZONTAL,s=this.renderingQueue.getHighestPriority(t,this._pages,n,r);return s?(this.#H(s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}get hasEqualPageSizes(){let e=this._pages[0];for(let t=1,n=this._pages.length;t<n;++t){let r=this._pages[t];if(r.width!==e.width||r.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{let n=t.pdfPage.getViewport({scale:1}),r=d3(n);if(e===void 0)e=r;else if(this.enablePrintAutoRotate&&r!==e)return{width:n.height,height:n.width,rotation:(n.rotation-90)%360};return{width:n.width,height:n.height,rotation:n.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!hQ(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>Hv.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){let t=this._scrollMode,n=this.viewer;n.classList.toggle("scrollHorizontal",t===Zt.HORIZONTAL),n.classList.toggle("scrollWrapped",t===Zt.WRAPPED),!(!this.pdfDocument||!e)&&(t===Zt.PAGE?this.#C():this._previousScrollMode===Zt.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!fQ(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;let t=this.viewer,n=this._pages;if(this._scrollMode===Zt.PAGE)this.#C();else if(t.textContent="",this._spreadMode===Pi.NONE)for(let r of this._pages)t.append(r.div);else{let r=this._spreadMode-1,s=null;for(let o=0,a=n.length;o<a;++o)s===null?(s=document.createElement("div"),s.className="spread",t.append(s)):o%2===r&&(s=s.cloneNode(!1),t.append(s)),s.append(n[o].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case Zt.WRAPPED:{let{views:n}=this._getVisiblePages(),r=new Map;for(let{id:s,y:o,percent:a,widthPercent:l}of n){if(a===0||l<100)continue;let c=r.get(o);c||r.set(o,c||=[]),c.push(s)}for(let s of r.values()){let o=s.indexOf(e);if(o===-1)continue;let a=s.length;if(a===1)break;if(t)for(let l=o-1,c=0;l>=c;l--){let d=s[l],u=s[l+1]-1;if(d<u)return e-u}else for(let l=o+1,c=a;l<c;l++){let d=s[l],u=s[l-1]+1;if(d>u)return u-e}if(t){let l=s[0];if(l<e)return e-l+1}else{let l=s[a-1];if(l>e)return l-e+1}break}break}case Zt.HORIZONTAL:break;case Zt.PAGE:case Zt.VERTICAL:{if(this._spreadMode===Pi.NONE)break;let n=this._spreadMode-1;if(t&&e%2!==n)break;if(!t&&e%2===n)break;let{views:r}=this._getVisiblePages(),s=t?e-1:e+1;for(let{id:o,percent:a,widthPercent:l}of r)if(o===s){if(a>0&&l===100)return 2;break}break}}return 1}nextPage(){let e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;let n=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+n,t),!0}previousPage(){let e=this._currentPageNumber;if(e<=1)return!1;let t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:n=null,origin:r}){if(n===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(t>0&&t!==1)s=Math.round(s*t*100)/100;else if(n){let o=n>0?s3:1/s3,a=n>0?Math.ceil:Math.floor;n=Math.abs(n);do s=a((s*o).toFixed(2)*10)/10;while(--n>0)}s=Math.max(oQ,Math.min(aQ,s)),this.#I(s,{noScroll:!1,drawingDelay:e,origin:r})}increaseScale(e={}){this.updateScale(Ge(re({},e),{steps:e.steps??1}))}decreaseScale(e={}){this.updateScale(Ge(re({},e),{steps:-(e.steps??1)}))}#N(e=this.container.clientHeight){e!==this.#y&&(this.#y=e,pQ.setProperty("--viewer-container-height",`${e}px`))}#O(e){for(let t of e)if(t.target===this.container){this.#N(Math.floor(t.borderBoxSize[0].blockSize)),this.#a=null;break}}get containerTopLeft(){return this.#a||=[this.container.offsetTop,this.container.offsetLeft]}#B(){this.#f&&(this.eventBus._off("pagerendered",this.#f),this.#f=null),this.#m!==null&&(clearTimeout(this.#m),this.#m=null)}get annotationEditorMode(){return this.#r?this.#i:xr.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:n=!1}){if(!this.#r)throw new Error("The AnnotationEditor is not enabled.");if(this.#i===e)return;if(!O3(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;e===xr.STAMP&&this.#p?.loadModel("altText");let{eventBus:r}=this,s=()=>{this.#B(),this.#i=e,this.#r.updateMode(e,t,n),r.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===xr.NONE||this.#i===xr.NONE){let o=e!==xr.NONE;o||this.pdfDocument.annotationStorage.resetModifiedIds();for(let l of this._pages)l.toggleEditingMode(o);let a=this.#F();if(o&&a){this.#B(),this.#f=({pageNumber:c})=>{a.delete(c),a.size===0&&(this.#m=setTimeout(s,0))};let{signal:l}=this.#h;r._on("pagerendered",this.#f,{signal:l});return}}s()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(let n of this._pages)n.update(t);this.#S!==null&&(clearTimeout(this.#S),this.#S=null),e||this.update()}}},LC=class extends ex{_resetView(){super._resetView(),this._scrollMode=Zt.PAGE,this._spreadMode=Pi.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}};var _fe=In.AnnotationLayerBuilder,Sfe=In.DownloadManager,Efe=In.EventBus,Cfe=In.FindState,GK=In.GenericL10n,WK=In.LinkTarget,qK=In.PDFFindController,Mfe=In.PDFHistory,ZK=In.PDFLinkService,Tfe=In.PDFPageView,Ife=In.PDFScriptingManager,XK=In.PDFSinglePageViewer,YK=In.PDFViewer,Dfe=In.ProgressBar,Pfe=In.RenderingStates,Rfe=In.ScrollMode,Lfe=In.SimpleLinkService,kfe=In.SpreadMode,Nfe=In.StructTreeLayerBuilder,Ffe=In.TextLayerBuilder,Ofe=In.XfaLayerBuilder,Bfe=In.parseQueryString;function KK(i,e,t){i[e]=t}function JK(){return typeof window>"u"}JK()||KK(QE,"verbosity",YE.INFOS);typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let i,e;return{promise:new Promise((n,r)=>{i=n,e=r}),resolve:i,reject:e}});var Wr=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({})}return i})();var Ef=function(i){return i[i.DISABLE=0]="DISABLE",i[i.ENABLE=1]="ENABLE",i[i.ENABLE_FORMS=2]="ENABLE_FORMS",i[i.ENABLE_STORAGE=3]="ENABLE_STORAGE",i}(Ef||{});var Wo={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},$K=typeof window>"u"?!1:!!globalThis.MSInputMethodContext&&!!document.documentMode,eJ=typeof navigator>"u"||/Edge\/\d./i.test(navigator.userAgent),tJ=typeof ReadableStream>"u"||typeof Promise.allSettled>"u",nJ="4.7.697",iJ="4.7.697";function Kd(i){return i?.includes("bleeding-edge")?iJ:nJ}function Xa(i,e=""){return i.includes("://")?i:`./${i+e}`}var ir={needsES5:$K||eJ||tJ,annotationEditorMode:0,annotationMode:Ef.ENABLE_FORMS,defaultZoomDelay:400,cursorToolOnLoad:0,defaultUrl:"",defaultZoomValue:"",disableHistory:!1,disablePageLabels:!1,enablePermissions:!1,docBaseUrl:"",enablePrintAutoRotate:!0,externalLinkRel:"noopener noreferrer nofollow",externalLinkTarget:0,findController:void 0,historyUpdateUrl:!1,ignoreDestinationZoom:!1,imageResourcesPath:"./images/",maxCanvasPixels:-1,forcePageColors:!1,pageColorsBackground:"Canvas",pageColorsForeground:"CanvasText",pdfBugEnabled:!1,printResolution:150,rangeChunkSize:65536,removePageBorders:!1,enableXfa:!0,fontExtraProperties:!1,sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,viewOnLoad:0,cMapPacked:!0,cMapUrl:function(){return`${Xa(ir.assetsFolder,"/..")}/cmaps/`},disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!0,isEvalSupported:!0,isOffscreenCanvasSupported:!0,maxImageSize:-1,pdfBug:!1,verbosity:1,workerPort:null,assetsFolder:"assets",_internalFilenameSuffix:".min",sandboxBundleSrc:function(){return ir.needsES5?`./pdf.sandbox-${Kd(Xa(ir.assetsFolder))}-es5.mjs`:`./pdf.sandbox-${Kd(Xa(ir.assetsFolder))}${ir._internalFilenameSuffix}.mjs`},workerSrc:function(){return ir.needsES5?`${Xa(ir.assetsFolder)}/pdf.worker-${Kd(Xa(ir.assetsFolder))}-es5.mjs`:`${Xa(ir.assetsFolder)}/pdf.worker-${Kd(Xa(ir.assetsFolder))}${ir._internalFilenameSuffix}.mjs`},standardFontDataUrl:()=>`${Xa(ir.assetsFolder,"/..")}/standard_fonts/`,doubleTapZoomFactor:"page-width",doubleTapZoomsInHandMode:!0,doubleTapZoomsInTextSelectionMode:!1,doubleTapResetsZoomOnSecondDoubleTap:!1,enableScripting:!0,defaultCacheSize:50,passwordPrompt:void 0,enableHWA:!0};var rJ=(()=>{class i{onPDFJSInitSignal=pl(void 0);pdfjsVersion=Kd(ir.assetsFolder);constructor(){ym(()=>{this.onPDFJSInitSignal()&&(this.pdfjsVersion=Kd(ir.assetsFolder))})}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),sJ=(()=>{class i{rendererFactory;ngxExtendedPdfViewerInitialized=!1;secondaryMenuIsEmpty=!1;renderer;PDFViewerApplication;constructor(t,n){this.rendererFactory=t,this.renderer=this.rendererFactory.createRenderer(null,null),ym(()=>{this.PDFViewerApplication=n.onPDFJSInitSignal()})}find(t,n={}){if(this.ngxExtendedPdfViewerInitialized){if(!n.useSecondaryFindcontroller){let a=document.getElementById("findHighlightAll");a&&(a.checked=n.highlightAll??!1);let l=document.getElementById("findMatchCase");l&&(l.checked=n.matchCase??!1);let c=document.getElementById("findMultiple");c&&(c.checked=n.findMultiple??!1);let d=document.getElementById("findEntireWord");d&&(d.checked=n.wholeWords??!1);let u=document.getElementById("findMatchDiacritics");u&&(u.checked=n.matchDiacritics??!1);let h=document.getElementById("matchRegExp");h&&(h.checked=n.regexp??!1,h.checked&&(c&&(c.checked=!1),d&&(d.checked=!1),u&&(u.checked=!1)),c&&(c.disabled=h.checked),d&&(d.disabled=h.checked),u&&(u.disabled=h.checked));let f=document.getElementById("findInput");f&&typeof t=="string"&&(f.value=t)}let r={caseSensitive:n.matchCase??!1,entireWord:n.wholeWords??!1,highlightAll:n.highlightAll??!1,matchDiacritics:n.matchDiacritics??!1,findMultiple:n.findMultiple,matchRegExp:n.regexp??!1,findPrevious:!1,query:t,source:null,type:"find",dontScrollIntoView:n.dontScrollIntoView??!1};return(n.useSecondaryFindcontroller?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFind(r)}else{console.error("The PDF viewer hasn't finished initializing. Please call find() later.");return}}findNext(t=!1){return this.ngxExtendedPdfViewerInitialized?((t?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFindNext(),!0):(console.error("The PDF viewer hasn't finished initializing. Please call findNext() later."),!1)}findPrevious(t=!1){return this.ngxExtendedPdfViewerInitialized?((t?this.PDFViewerApplication?.customFindController:this.PDFViewerApplication?.findController)?.ngxFindPrevious(),!0):(console.error("The PDF viewer hasn't finished initializing. Please call findPrevious() later."),!1)}print(t){this.PDFViewerApplication&&(this.PDFViewerApplication?.PDFPrintServiceFactory?.isInPDFPrintRange!==void 0||(t||(t={}),this.setPrintRange(t),this.PDFViewerApplication?.printPdf(),this.PDFViewerApplication?.eventBus.on("afterprint",this.removePrintRange.bind(this),{once:!0})))}removePrintRange(){this.PDFViewerApplication?.PDFPrintServiceFactory&&(delete this.PDFViewerApplication.PDFPrintServiceFactory.isInPDFPrintRange,delete this.PDFViewerApplication.PDFPrintServiceFactory.filteredPageCount)}setPrintRange(t){if(!this.PDFViewerApplication?.PDFPrintServiceFactory){console.error("The print service hasn't been initialized yet.");return}this.PDFViewerApplication.PDFPrintServiceFactory.isInPDFPrintRange=n=>this.isInPDFPrintRange(n,t),this.PDFViewerApplication.PDFPrintServiceFactory.filteredPageCount=this.filteredPageCount(this.PDFViewerApplication?.pagesCount,t)}filteredPageCount(t,n){let r=0;for(let s=0;s<t;s++)this.isInPDFPrintRange(s,n)&&r++;return r}isInPDFPrintRange(t,n){let r=t+1;return!(n.from&&r<n.from||n.to&&r>n.to||n.excluded&&n.excluded.some(s=>s===r)||n.included&&!n.included.some(s=>s===r))}getPageAsLines(t){return ce(this,null,function*(){if(this.PDFViewerApplication){let o=(yield(yield(this.PDFViewerApplication?.pdfDocument).getPage(t)).getTextContent()).items.filter(v=>!v.type),a=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,u=0,h=0,f="",p=new Array;for(let v=0;v<o.length;v++){let g=o[v];if(!g.hasEOL){let y=g.transform[4],w=-g.transform[5],A=g.width,C=g.height;a=Math.min(a,y),l=Math.min(l,w),c=Math.max(c,y+A),d=Math.max(d,w+C),f+=g.str,g.dir==="rtl"&&h++,g.dir==="ltr"&&u++}if(v===o.length-1||g.hasEOL){let y;u>0&&h>0?y="both":u>0?y="ltr":h>0&&(y="rtl");let w={direction:y,x:a,y:l,width:c-a,height:d-l,text:f.trim()};p.push(w),a=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,u=0,h=0,f=""}}return p}return[]})}getPageAsText(t){return ce(this,null,function*(){if(!this.PDFViewerApplication)return"";let s=(yield(yield(this.PDFViewerApplication?.pdfDocument).getPage(t)).getTextContent()).items;return this.convertTextInfoToText(s)})}convertTextInfoToText(t){return t?t.filter(n=>!n.type).map(n=>n.hasEOL?n.str+`
`:n.str).join(""):""}getPageAsCanvas(a,l,c){return ce(this,arguments,function*(t,n,r,s="#FFFFFF",o=Ef.ENABLE){if(!this.PDFViewerApplication)return Promise.resolve(void 0);let u=yield this.PDFViewerApplication.pdfDocument.getPage(t);return this.draw(u,n,r,s,o)})}getPageAsImage(a,l,c){return ce(this,arguments,function*(t,n,r,s="#FFFFFF",o=Ef.ENABLE){return(yield this.getPageAsCanvas(t,n,r,s,o))?.toDataURL()})}draw(a,l,c){return ce(this,arguments,function*(t,n,r,s="#FFFFFF",o=Ef.ENABLE){let d=1;n.scale?d=n.scale:n.width?d=n.width/t.getViewport({scale:1}).width:n.height&&(d=n.height/t.getViewport({scale:1}).height);let u=t.getViewport({scale:d}),{ctx:h,canvas:f}=this.getPageDrawContext(u.width,u.height),p=u.clone(),v={canvasContext:h,viewport:p,background:r,backgroundColorToReplace:s,annotationMode:o},g=t.render(v),m=()=>Promise.resolve(f);return g.promise.then(m)})}getPageDrawContext(t,n){let r=document.createElement("canvas"),s=r.getContext("2d",{alpha:!0});if(!s)throw new Error("Couldn't create the 2d context");return r.width=t,r.height=n,this.renderer.setStyle(r,"width",`${t}px`),this.renderer.setStyle(r,"height",`${n}px`),{ctx:s,canvas:r}}getCurrentDocumentAsBlob(){return ce(this,null,function*(){return(yield this.PDFViewerApplication?.export())||void 0})}getFormData(t=!0){return ce(this,null,function*(){if(!this.PDFViewerApplication)return[];let n=this.PDFViewerApplication?.pdfDocument,r=96/72,s=[];for(let o=1;o<=n?.numPages;o++){let a=yield n.getPage(o);(yield a.getAnnotations()).filter(c=>c.subtype==="Widget").map(c=>re({},c)).forEach(c=>{let d=a.getViewport({scale:r}).convertToViewportRectangle(c.rect);if(t&&c.fieldName)try{if(c.exportValue){let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(c.id,c.fieldName+"/"+c.exportValue,"");c.value=u?.value}else if(c.radioButton){let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(c.id,c.fieldName+"/"+c.fieldValue,"");c.value=u?.value}else{let u=this.PDFViewerApplication?.pdfDocument.annotationStorage.getValue(c.id,c.fieldName,"");c.value=u?.value}}catch{}s.push({fieldAnnotation:c,fieldRect:d,pageNumber:o})})}return s})}addPageToRenderQueue(t){return this.PDFViewerApplication?.pdfViewer.addPageToRenderQueue(t)??!1}isRenderQueueEmpty(){return this.PDFViewerApplication?!this.PDFViewerApplication.pdfViewer.renderingQueue.getHighestPriority(this.PDFViewerApplication?.pdfViewer._getVisiblePages(),this.PDFViewerApplication?.pdfViewer._pages,!0,!1):!0}hasPageBeenRendered(t){if(!this.PDFViewerApplication)return!1;let n=this.PDFViewerApplication?.pdfViewer._pages;return n.length>t&&t>=0?n[t].renderingState===3:!1}sleep(t){return new Promise(n=>setTimeout(n,t))}renderPage(t){return ce(this,null,function*(){if(!this.hasPageBeenRendered(t))for(yield this.addPageToRenderQueue(t);!this.hasPageBeenRendered(t);)yield this.sleep(7)})}currentlyRenderedPages(){return this.PDFViewerApplication?(this.PDFViewerApplication?.pdfViewer._pages).filter(n=>n.renderingState===3).map(n=>n.id):[]}numberOfPages(){return this.PDFViewerApplication?(this.PDFViewerApplication?.pdfViewer._pages).length:0}getCurrentlyVisiblePageNumbers(){let t=this.PDFViewerApplication;return t?t.pdfViewer._getVisiblePages().views?.map(r=>r.id):[]}listLayers(){return ce(this,null,function*(){if(!this.PDFViewerApplication)return[];let t=yield this.PDFViewerApplication?.pdfViewer.optionalContentConfigPromise;if(t)return t.getOrder().filter(s=>typeof s!="object").map(s=>{let o=t.getGroup(s);return{layerId:s,name:o.name,visible:o.visible}})})}toggleLayer(t){return ce(this,null,function*(){if(!this.PDFViewerApplication)return;let n=yield this.PDFViewerApplication?.pdfViewer.optionalContentConfigPromise;if(n){let r=n.getGroup(t).visible,s=document.querySelector(`input[id='${t}']`);s&&(r=s.checked,s.checked=!r),n.setVisibility(t,!r),this.PDFViewerApplication?.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(n)})}})}scrollPageIntoView(t,n){this.PDFViewerApplication?.pdfViewer?.scrollPagePosIntoView(t,n)}getSerializedAnnotations(){return this.PDFViewerApplication?.pdfViewer.getSerializedAnnotations()}addEditorAnnotation(t){return ce(this,null,function*(){yield this.PDFViewerApplication?.pdfViewer.addEditorAnnotation(t)})}removeEditorAnnotations(t){this.PDFViewerApplication?.pdfViewer.removeEditorAnnotations(t)}loadImageAsDataURL(t){return ce(this,null,function*(){if(t.startsWith("data:"))return t;let n=yield fetch(t);if(!n.ok)throw new Error(`Failed to fetch the image from ${t}: ${n.statusText}`);return yield n.blob()})}addImageToAnnotationLayer(c){return ce(this,arguments,function*({urlOrDataUrl:t,page:n,left:r,bottom:s,right:o,top:a,rotation:l}){if(!this.PDFViewerApplication){console.error("The PDF viewer has not been initialized yet.");return}let d;n!==void 0?(n!==this.currentPageIndex()&&(yield this.renderPage(n)),d=n):d=this.currentPageIndex()??0;let u=this.PDFViewerApplication.pdfViewer.annotationEditorMode;this.switchAnnotationEdtorMode(13);let h=yield this.loadImageAsDataURL(t),f=this.PDFViewerApplication.pdfViewer._pages[d].pdfPage.view,p=f[0],v=f[1],g=f[2],m=f[3],y=g-p,w=m-v,A=this.PDFViewerApplication?.pdfViewer._pages[d].div.clientWidth,C=this.PDFViewerApplication?.pdfViewer._pages[d].div.clientHeight,E=this.convertToPDFCoordinates(r,y,0,A),T=this.convertToPDFCoordinates(s,w,0,C),L=this.convertToPDFCoordinates(o,y,y,A),S=this.convertToPDFCoordinates(a,w,w,C),_={annotationType:13,pageIndex:d,bitmapUrl:h,rect:[E,T,L,S],rotation:l??0};this.addEditorAnnotation(_),yield this.sleep(10),this.switchAnnotationEdtorMode(u)})}currentPageIndex(){let t=this.PDFViewerApplication?.pdfViewer;if(t)return t.currentPageNumber-1}convertToPDFCoordinates(t,n,r,s){return t?typeof t=="string"?t.endsWith("%")?parseInt(t,10)/100*n:t.endsWith("px")?parseInt(t,10)*(n/s):parseInt(t,10):t:r}switchAnnotationEdtorMode(t){this.PDFViewerApplication?.eventBus.dispatch("switchannotationeditormode",{mode:t})}set editorFontSize(t){this.setEditorProperty(Wo.FREETEXT_SIZE,t)}set editorFontColor(t){this.setEditorProperty(Wo.FREETEXT_COLOR,t)}set editorInkColor(t){this.setEditorProperty(Wo.INK_COLOR,t)}set editorInkOpacity(t){this.setEditorProperty(Wo.INK_OPACITY,t)}set editorInkThickness(t){this.setEditorProperty(Wo.INK_THICKNESS,t)}set editorHighlightColor(t){this.setEditorProperty(Wo.HIGHLIGHT_COLOR,t)}set editorHighlightDefaultColor(t){this.setEditorProperty(Wo.HIGHLIGHT_DEFAULT_COLOR,t)}set editorHighlightShowAll(t){this.setEditorProperty(Wo.HIGHLIGHT_SHOW_ALL,t)}set editorHighlightThickness(t){this.setEditorProperty(Wo.HIGHLIGHT_THICKNESS,t)}setEditorProperty(t,n){this.PDFViewerApplication?.eventBus.dispatch("switchannotationeditorparams",{type:t,value:n}),this.PDFViewerApplication?.eventBus.dispatch("annotationeditorparamschanged",{details:[[t,n]]})}static \u0275fac=function(n){return new(n||i)(Me(sa),Me(rJ))};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();Promise.allSettled||window.Zone&&!window["__zone_symbol__Promise.allSettled"]&&console.error("Please update zone.js to version 0.10.3 or higher. Otherwise, you'll run the slow ECMAScript 5 version even on modern browser that can run the fast ESMAScript 2015 version.");var qr=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({providers:[sJ],imports:[Mt,mn]})}return i})();var oJ=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500 hidden":!0}),aJ=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500":!0});function lJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function cJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function dJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function uJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function hJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function fJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function pJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function mJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function gJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function vJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function xJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function wJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function yJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",25)(2,"line",26)(3,"line",27),b())}function bJ(i,e){i&1&&(te(),x(0,"svg",24),B(1,"path",28)(2,"line",29)(3,"line",30),b())}function AJ(i,e){if(i&1&&(x(0,"option",40),M(1),b()),i&2){let t=e.$implicit,n=Y(2);F("ngClass",Xi(3,aJ))("value",t),I(),Qt(" ",n.statusViewer(t)," ")}}function _J(i,e){if(i&1){let t=rt();x(0,"button",41),Z("click",function(){he(t);let r=Y().$implicit,s=Y();return fe(s.viewPdfFile(r.file_name))}),M(1," View forms "),b()}}function SJ(i,e){i&1&&(x(0,"div",42),M(1," No forms "),b())}function EJ(i,e){if(i&1){let t=rt();x(0,"div",31)(1,"div",32),M(2),b(),x(3,"div",17),M(4),b(),x(5,"div",17),M(6),b(),x(7,"div",17),M(8),b(),x(9,"div",33),M(10),b(),x(11,"div",17)(12,"select",34),Z("change",function(r){let s=he(t).$implicit,o=Y();return fe(o.onOptionSelected(r,s.user_id,s.event_id,s.kiosk_id,s.form_id,s.Email,o.formatDate(s.date_req)))}),x(13,"option",35),M(14),b(),ee(15,AJ,2,4,"option",36),b()(),x(16,"div",17),M(17),b(),x(18,"div",37),ee(19,_J,2,0,"button",38)(20,SJ,2,0,"div",39),b()()}if(i&2){let t=e.$implicit,n=Y();I(2),ge(n.formatDate(t.date_req)),I(2),ge(t.First_name+" "+t.Last_name),I(2),ge(t.event_name),I(2),ge(t.kiosk_name),I(2),ge(t.purpose?t.purpose:"----"),I(3),F("ngClass",Xi(11,oJ)),I(),Qt(" ",n.statusViewer(t.status)||"Select an option"," "),I(),F("ngForOf",n.statusOptions),I(2),ge(t.receipt_number),I(2),F("ngIf",t.file_name),I(),F("ngIf",!t.file_name)}}function CJ(i,e){i&1&&(Hy(0),x(1,"div",46),M(2," No PDF found. "),b(),zy())}function MJ(i,e){if(i&1){let t=rt();x(0,"embed",47),Z("error",function(){he(t);let r=Y(2);return fe(r.onPdfError())}),b()}if(i&2){let t=Y(2);F("src",t.pdfUrl,_y)}}function TJ(i,e){if(i&1){let t=rt();x(0,"div",43)(1,"button",44),Z("click",function(){he(t);let r=Y();return fe(r.viewPdf=!r.viewPdf)}),M(2," x "),b(),ee(3,CJ,3,0,"ng-container",45)(4,MJ,1,1,"ng-template",null,0,Cu),b()}if(i&2){let t=is(5),n=Y();I(3),F("ngIf",n.pdfError)("ngIfElse",t)}}var nx=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userTransaction=[];eventData=[];kioskData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascStatus=!1;ascEvent=!1;ascKiosk=!1;ascRefNum=!1;ascUsername=!1;reference="";checkerReference=!1;ascPurpose=!1;ascDate=!1;referenceNumber=!1;formId="";errorMessage="";viewPdf=!1;statusOptions=["pending","approved","denied","finished","paid"];pdfError=!1;pdfUrl="";selectedOption="";onOptionSelected(e,t,n,r,s,o,a){this.selectedOption=e.target.value,this.adminService.updateStatus(this.selectedOption,t,n,r,s).subscribe(l=>{l.success&&(this.selectedOption=="approved"?cs.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:o,message:"Note: From "+a+" (requested date) you only have 3 days to comply with the requirements, Failure to comply within 3 days will result in your reservation being CANCELLED",status:this.selectedOption,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(c=>{console.log("Email sent successfully!",c.text),window.location.reload()}):cs.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:o,status:this.selectedOption,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(c=>{console.log("Email sent successfully!",c.text),window.location.reload()}))})}getTransaction(){this.token=sessionStorage.getItem("tokenId")??"",this.adminService.getTransaction().subscribe(e=>{this.userTransaction=e})}viewPdfFile(e){let t="http://localhost/mapp-thesis/public/dbAssets/userImages/"+e;this.viewPdf=!0,console.log(this.pdfUrl),this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t)}onPdfError(){this.pdfError=!0}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}statusViewer(e){return e=="approved"?"approved":e=="pending"?"booked":e=="finished"?"completed":e=="paid"?e:"cancelled"}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getKioskName(e){let t=this.kioskData.find(n=>n.kiosk_id==e);return t?t.kiosk_name:"Unknown Kiosk"}getKiosk(){this.eventService.getKiosk().subscribe(e=>{this.kioskData=e})}getEvent(){this.eventService.getEvents().subscribe(e=>{this.eventData=e})}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}toLowerCaseSafe(e){return e?e.toLowerCase():""}getTransactionsToDisplay(){let e=this.userTransaction.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.kiosk_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.purpose).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Username).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userTransaction.length&&(console.log(this.userTransaction.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.firstName=sessionStorage.getItem("firstName")??"",this.lastName=sessionStorage.getItem("lastName")??"",this.eventService.downloadForm(e,this.firstName,this.lastName)}ngOnInit(){sessionStorage.getItem("transactions")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getEvent(),this.getKiosk(),this.getTransaction()}static \u0275fac=function(t){return new(t||i)(ne(rs),ne(et),ne(qn),ne(di),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-transaction"]],standalone:!0,features:[_t],decls:87,vars:20,consts:[["showPdf",""],[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"flex","justify-between","h-full","w-full","px-0","md:px-2","items-center"],[1,"bg-green-200","size-36","px-2","text-center","rounded-xl","shadow-md","shadow-gray-500","justify-center","grid","items-center"],[1,"text-8xl","text-gray-600"],[1,"text-md","text-gray-600","font-bold"],[1,"text-md","text-gray-600","font-bold","w-full"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-8","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-sm","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"block",3,"click"],["class","grid grid-cols-8 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["class","absolute top-0 left-1/2 transform -translate-x-1/2 mt-4 border-4 border-gray-300 bg-gray-50 w-3/4 h-[90%] flex flex-col z-[1000] shadow-lg",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-8","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"text-xs","md:text-sm","flex","justify-center","items-center"],[1,"flex","justify-center","items-center","leading-none","text-sm"],["id","dropdown",1,"bg-customDarkGreen","border-none","outline-none",3,"change"],["value","","selected","",3,"ngClass"],["class","bg-customDarkGreen rounded-md",3,"ngClass","value",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center"],["class","bg-green-800 h-8 w-full md:text-sm rounded-lg hover:bg-green-900 hover:text-white",3,"click",4,"ngIf"],["class","flex justify-center items-center text-center bg-green-800 h-8 w-full md:text-sm rounded-lg hover:text-white",4,"ngIf"],[1,"bg-customDarkGreen","rounded-md",3,"ngClass","value"],[1,"bg-green-800","h-8","w-full","md:text-sm","rounded-lg","hover:bg-green-900","hover:text-white",3,"click"],[1,"flex","justify-center","items-center","text-center","bg-green-800","h-8","w-full","md:text-sm","rounded-lg","hover:text-white"],[1,"absolute","top-0","left-1/2","transform","-translate-x-1/2","mt-4","border-4","border-gray-300","bg-gray-50","w-3/4","h-[90%]","flex","flex-col","z-[1000]","shadow-lg"],[1,"absolute","top-2","right-2","py-1","hover:bg-green-700","hover:text-gray-200","text-lg","text-center","justify-center","items-center","cursor-pointer","text-gray-50","rounded-full","bg-customDarkGreen","size-10","flex","items-center","justify-center",3,"click"],[4,"ngIf","ngIfElse"],[1,"flex","items-center","justify-center","h-full","text-gray-500","text-lg"],["width","100%","height","100%","type","application/pdf",3,"error","src"]],template:function(t,n){t&1&&(x(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),M(5),b(),x(6,"div",6),M(7,"PAID"),b()(),x(8,"div",4)(9,"div",5),M(10),b(),x(11,"div",7),M(12,"FINISHED"),b()(),x(13,"div",4)(14,"div",5),M(15),b(),x(16,"div",7),M(17,"TRANSACTION"),b()()(),x(18,"div",8)(19,"div",9)(20,"p"),M(21," Transaction History:"),b()(),x(22,"div",10),te(),x(23,"svg",11)(24,"g")(25,"g"),B(26,"path",12),b()()(),ot(),x(27,"input",13),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(28,"div",14)(29,"div",15)(30,"button",16),Z("click",function(){return n.onSortChange("date_req"),n.ascDate=!n.ascDate}),x(31,"div",17),ee(32,lJ,4,0,"svg",18)(33,cJ,4,0,"svg",18),x(34,"p"),M(35,"Date"),b()()()(),x(36,"div",15)(37,"button",16),Z("click",function(){return n.onSortChange("Username"),n.ascUsername=!n.ascUsername}),x(38,"div",17),ee(39,dJ,4,0,"svg",18)(40,uJ,4,0,"svg",18),x(41,"p"),M(42,"Name"),b()()()(),x(43,"div",15)(44,"button",16),Z("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),x(45,"div",17),ee(46,hJ,4,0,"svg",18)(47,fJ,4,0,"svg",18),x(48,"p"),M(49,"Event Name"),b()()()(),x(50,"div",15)(51,"button",16),Z("click",function(){return n.onSortChange("kiosk_name"),n.ascKiosk=!n.ascKiosk}),x(52,"div",17),ee(53,pJ,4,0,"svg",18)(54,mJ,4,0,"svg",18),x(55,"p"),M(56,"Kiosk Name"),b()()()(),x(57,"div",15)(58,"button",19),Z("click",function(){return n.onSortChange("purpose"),n.ascPurpose=!n.ascPurpose}),x(59,"div",17),ee(60,gJ,4,0,"svg",18)(61,vJ,4,0,"svg",18),x(62,"p"),M(63,"Purpose"),b()()()(),x(64,"div",15)(65,"button",16),Z("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),x(66,"div",17),ee(67,xJ,4,0,"svg",18)(68,wJ,4,0,"svg",18),x(69,"p"),M(70,"Status"),b()()()(),x(71,"div",15)(72,"button",16),Z("click",function(){return n.onSortChange("receipt_number"),n.ascRefNum=!n.ascRefNum}),x(73,"div",17),ee(74,yJ,4,0,"svg",18)(75,bJ,4,0,"svg",18),x(76,"p"),M(77,"Receipt"),b()()()(),x(78,"div",17),M(79,"Pdf file"),b()(),ee(80,EJ,21,12,"div",20),x(81,"div",21)(82,"button",22),Z("click",function(){return n.prevTransaction()}),M(83," Prev "),b(),x(84,"button",22),Z("click",function(){return n.nextTransaction()}),M(85," Next "),b()()(),ee(86,TJ,6,2,"div",23),b()),t&2&&(I(5),ge(n.counterPaid(n.userTransaction)),I(5),ge(n.counterFinished(n.userTransaction)),I(5),ge(n.userTransaction.length),I(12),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascDate),I(),F("ngIf",!n.ascDate),I(6),F("ngIf",n.ascUsername),I(),F("ngIf",!n.ascUsername),I(6),F("ngIf",n.ascEvent),I(),F("ngIf",!n.ascEvent),I(6),F("ngIf",n.ascKiosk),I(),F("ngIf",!n.ascKiosk),I(6),F("ngIf",n.ascPurpose),I(),F("ngIf",!n.ascPurpose),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(6),F("ngIf",n.ascRefNum),I(),F("ngIf",!n.ascRefNum),I(5),F("ngForOf",n.getTransactionsToDisplay()),I(6),F("ngIf",n.viewPdf))},dependencies:[mn,ba,Aa,bn,An,wn,Mt,Ns,pn,Nt,Wr,qr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function IJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",23)(2,"line",24)(3,"line",25),b())}function DJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",26)(2,"line",27)(3,"line",28),b())}function PJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",23)(2,"line",24)(3,"line",25),b())}function RJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",26)(2,"line",27)(3,"line",28),b())}function LJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",23)(2,"line",24)(3,"line",25),b())}function kJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",26)(2,"line",27)(3,"line",28),b())}function NJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",23)(2,"line",24)(3,"line",25),b())}function FJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",26)(2,"line",27)(3,"line",28),b())}function OJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",23)(2,"line",24)(3,"line",25),b())}function BJ(i,e){i&1&&(te(),x(0,"svg",22),B(1,"path",26)(2,"line",27)(3,"line",28),b())}function VJ(i,e){i&1&&(x(0,"p",36),M(1,"Active"),b())}function UJ(i,e){if(i&1){let t=rt();x(0,"div",29)(1,"div",30),M(2),b(),x(3,"div",30),M(4),b(),x(5,"div",12),M(6),b(),x(7,"div",31),M(8),b(),x(9,"div",12),ee(10,VJ,2,0,"p",32),b(),x(11,"div",12),B(12,"img",33),b(),x(13,"div",12)(14,"button",34),Z("click",function(){let r=he(t).$implicit,s=Y();return s.isModalOpen=!s.isModalOpen,s.eventStart=r.event_start,s.eventEnd=r.event_end,s.eventName=r.event_name,s.eventDetails=r.details,s.eventId=r.event_id,fe(s.eventStatus=r.status)}),B(15,"img",35),b()()()}if(i&2){let t=e.$implicit,n=Y();I(2),ge(n.formatDate(t.event_start)),I(2),ge(n.formatDate(t.event_end)),I(2),ge(t.event_name),I(2),ge(t.details),I(2),F("ngIf",t.status==1),I(2),Mr("src","https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/",t.event_image,"",_i)}}function HJ(i,e){if(i&1&&(x(0,"span",65),M(1),b()),i&2){let t=Y(2);I(),ge(t.eventImage.name)}}function zJ(i,e){i&1&&(x(0,"span",65),M(1,"Upload image"),b())}function jJ(i,e){if(i&1&&(x(0,"div",44)(1,"p",66),M(2),b()()),i&2){let t=Y(2);I(2),ge(t.errorMessage)}}function GJ(i,e){if(i&1){let t=rt();x(0,"div",37)(1,"div",38)(2,"button",39),Z("click",function(){he(t);let r=Y();return fe(r.disable=!r.disable)}),te(),x(3,"svg",40)(4,"g")(5,"g"),B(6,"path",41),b()()()(),ot(),x(7,"h2",42),M(8,"Edit Event"),b(),x(9,"form",43),Z("ngSubmit",function(){he(t);let r=Y();return fe(r.onSubmit())}),x(10,"div",44)(11,"label",45),M(12,"Event Name"),b(),x(13,"input",46),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.eventName,r)||(s.eventName=r),fe(r)}),b()(),x(14,"div",47)(15,"div",44)(16,"label",48),M(17,"Event Start"),b(),x(18,"input",49),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.eventStart,r)||(s.eventStart=r),fe(r)}),b()(),x(19,"div",44)(20,"label",50),M(21,"Event End"),b(),x(22,"input",51),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.eventEnd,r)||(s.eventEnd=r),fe(r)}),b()()(),x(23,"div",44)(24,"label",52),M(25,"Details"),b(),x(26,"textarea",53),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.eventDetails,r)||(s.eventDetails=r),fe(r)}),b()(),x(27,"div",47)(28,"div",44)(29,"label",54),M(30,"Status"),b(),x(31,"input",55),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.eventStatusModel,r)||(s.eventStatusModel=r),fe(r)}),b()(),x(32,"div",44)(33,"label",56),M(34,"Event Image"),b(),x(35,"div",57),Z("click",function(){he(t);let r=is(41);return fe(r.click())}),ee(36,HJ,2,1,"span",58)(37,zJ,2,0,"span",58),x(38,"div",59),M(39," Browse "),b()(),x(40,"input",60,0),Z("change",function(r){he(t);let s=Y();return fe(s.onFileChange(r))}),b()()(),ee(42,jJ,3,1,"div",61),x(43,"div",62)(44,"button",63),Z("click",function(){he(t);let r=Y();return fe(r.closeModal())}),M(45," Cancel "),b(),x(46,"button",64),M(47," Save Changes "),b()()()()()}if(i&2){let t=Y();I(13),tt("ngModel",t.eventName),I(5),tt("ngModel",t.eventStart),I(4),tt("ngModel",t.eventEnd),I(4),tt("ngModel",t.eventDetails),I(5),tt("ngModel",t.eventStatusModel),I(5),F("ngIf",t.eventImage),I(),F("ngIf",!t.eventImage),I(5),F("ngIf",t.errorMessage)}}function WJ(i,e){i&1&&B(0,"div",67)}function qJ(i,e){if(i&1){let t=rt();x(0,"div",68)(1,"div",69)(2,"p",70),M(3," Events Updated Succesfully! "),b()(),x(4,"div",71)(5,"button",72),Z("click",function(){he(t);let r=Y();return fe(r.changeVal())}),M(6,"Okay "),b()()()}}function ZJ(i,e){i&1&&B(0,"div",73)}function XJ(i,e){if(i&1){let t=rt();x(0,"div",74)(1,"div",69)(2,"p",75),M(3," Are you sure you want to disable the event? "),B(4,"br")(5,"br"),x(6,"span",76),M(7,"Note: It will only be seen in the event history"),b()()(),x(8,"div",77)(9,"button",78),Z("click",function(){he(t);let r=Y();return fe(r.disable=!r.disable)}),M(10,"No "),b(),x(11,"button",72),Z("click",function(){he(t);let r=Y();return fe(r.eventDisable())}),M(12,"Yes "),b()()()}}var ix=class i{constructor(e,t,n,r,s,o){this.ngZone=e;this.sanitizer=t;this.router=n;this.userService=r;this.eventService=s;this.adminService=o}eventData=[];searchText="";pageIndex=0;pageSize=10;sortField="event_start";sortDirection="asc";ascStart=!1;ascEnd=!1;ascEvent=!1;ascDetails=!1;ascStatus=!1;errorMessage="";isModalOpen=!1;selectedEvent={};disable=!1;eventName="";eventStart="";eventStatus="";eventEnd="";eventDetails="";eventId="";eventImage=null;imageFileName="";submit="false";getDynamicImagePath(e){let t="/dbAssets/eventImages/",n=new Date().getTime();return`${t}${e}?t=${n}`}getSanitizedImagePath(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}eventDisable(){this.adminService.disableEvent(this.eventId).subscribe({next:e=>{e.success&&(this.closeModal(),this.eventId="",this.eventName="",this.eventStart="",this.eventEnd="",this.eventStatus="",this.eventDetails="",this.eventImage=null,this.imageFileName="",window.location.reload())},error:e=>{this.errorMessage="Error submitting the application. Please try again.",console.error(e)}})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getEvent(){this.adminService.getEvent().subscribe(e=>{this.eventData=e})}openModal(e){this.selectedEvent=re({},e),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){let e=new Date,t=new Date(this.eventStart),n=new Date(this.eventEnd);if(t.getTime()===n.getTime()){this.errorMessage="The start and end dates cannot be the same.";return}if(n<t){this.errorMessage="The end date must be later than the start date.";return}if(t<e){this.errorMessage="The start date must be in the future.";return}if(n<e){this.errorMessage="The end date must be in the future.";return}let r=new FormData;r.append("eventId",this.eventId),r.append("eventName",this.eventName),r.append("eventStart",this.eventStart),r.append("eventEnd",this.eventEnd),r.append("status",this.eventStatus),r.append("details",this.eventDetails),this.eventImage&&r.append("eventImage",this.eventImage,this.eventImage.name),this.adminService.updateEvents(r).subscribe({next:s=>{console.log(s.message,s.success),s.success&&(console.log("Event updated successfully."),console.log("Event Name:",r.get("eventName")),console.log("Event ID:",r.get("eventId")),sessionStorage.setItem("submit","true"),this.closeModal(),this.eventId="",this.eventName="",this.eventStart="",this.eventEnd="",this.eventStatus="",this.eventDetails="",this.eventImage=null,this.imageFileName="",window.location.reload())},error:s=>{this.errorMessage="Error submitting the application. Please try again.",console.error(s)}})}get eventStatusModel(){return this.eventStatus==="1"?"active":this.eventStatus}set eventStatusModel(e){this.eventStatus=e==="active"?"1":e}onStatusChange(e){console.log("Event Status Changed:",this.eventStatus)}toLowerCaseSafe(e){return e?e.toLowerCase():""}getEventsToDisplay(){let e=this.eventData.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_start).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_end).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe("active").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.details).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortEvents(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortEvents(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.eventData.length&&(console.log(this.eventData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}changeVal(){sessionStorage.setItem("submit","false"),this.submit="false"}ngOnInit(){sessionStorage.getItem("events")!="1"&&this.router.navigate(["/dashboard-admin"]),this.submit=sessionStorage.getItem("submit")??"",this.getEvent()}static \u0275fac=function(t){return new(t||i)(ne(sn),ne(rs),ne(et),ne(qn),ne(di),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-events-manage"]],standalone:!0,features:[_t],decls:67,vars:17,consts:[["fileInput",""],[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-7","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-sm","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["class","grid grid-cols-7 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["class","fixed inset-0 flex justify-center items-center bg-gray-700 bg-opacity-50 z-[1000]",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-20",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[100] bg-customDarkGreen",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-[1000]",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[1100] bg-customDarkGreen",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-7","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"flex","justify-center","items-center","text-sm"],[1,"flex","justify-center","items-center","text-xs","leading-none"],["class","text-green-200",4,"ngIf"],[1,"size-24","object-cover","border-2","border-gray-50","rounded-lg",3,"src"],[3,"click"],["src","/assets/svg/edit.svg",1,"size-8"],[1,"text-green-200"],[1,"fixed","inset-0","flex","justify-center","items-center","bg-gray-700","bg-opacity-50","z-[1000]"],[1,"bg-[#226f54]","rounded-lg","p-6","w-1/3","relative"],[1,"absolute","top-2","right-2","py-1","hover:bg-green-700","hover:text-gray-200","text-lg","text-center","justify-center","items-center","cursor-pointer","text-gray-50","rounded-full","bg-customDarkGreen","size-10","flex","items-center","justify-center",3,"click"],["fill","white","height","24px","width","24px","version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 512 512",0,"xml","space","preserve"],["d",`M256,0C114.615,0,0,114.616,0,256s114.615,256,256,256s256-114.616,256-256S397.385,0,256,0z M66.783,256
                       c0-104.503,84.716-189.217,189.217-189.217c40.19,0,77.446,12.541,108.089,33.907L100.689,364.089
                       C79.323,333.446,66.783,296.19,66.783,256z M256,445.217c-40.19,0-77.446-12.541-108.089-33.907l263.399-263.399
                       c21.366,30.643,33.907,67.899,33.907,108.089C445.217,360.501,360.501,445.217,256,445.217z`],[1,"text-xl","font-bold","mb-4","text-gray-50"],[3,"ngSubmit"],[1,"mb-4"],["for","event_name",1,"block","text-sm","font-medium","text-gray-50"],["id","event_name","name","event_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-2"],["for","event_start",1,"block","text-sm","font-medium","text-gray-50"],["id","event_start","name","event_start","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_end",1,"block","text-sm","font-medium","text-gray-50"],["id","event_end","name","event_end","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","details",1,"block","text-sm","font-medium","text-gray-50"],["id","details","name","details","rows","4",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_status",1,"block","text-sm","font-medium","text-gray-50"],["id","event_status","name","event_status","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","h-12","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"mt-1","relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","eventImage","name","eventImage","required","",1,"hidden",3,"change"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end"],["type","button",1,"px-4","py-2","mr-2","text-white","bg-gray-500","hover:bg-gray-700","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md"],[1,"text-gray-700"],[1,"text-center","text-md","text-gray-50"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-20"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-[1000]"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[1100]","bg-customDarkGreen"],[1,"text-gray-50","text-center","text-3xl","w-96","leading-none"],[1,"text-[18px]"],[1,"flex","justify-between","w-full"],[1,"h-12","w-24","bg-red-700","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-800","hover:shadow-md",3,"click"]],template:function(t,n){t&1&&(x(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"p"),M(5," Manage Events:"),b()(),x(6,"div",5),te(),x(7,"svg",6)(8,"g")(9,"g"),B(10,"path",7),b()()(),ot(),x(11,"input",8),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(12,"div",9)(13,"div",10)(14,"button",11),Z("click",function(){return n.onSortChange("event_start"),n.ascStart=!n.ascStart}),x(15,"div",12),ee(16,IJ,4,0,"svg",13)(17,DJ,4,0,"svg",13),x(18,"p"),M(19,"Date Started"),b()()()(),x(20,"div",10)(21,"button",11),Z("click",function(){return n.onSortChange("event_end"),n.ascEnd=!n.ascEnd}),x(22,"div",12),ee(23,PJ,4,0,"svg",13)(24,RJ,4,0,"svg",13),x(25,"p"),M(26,"Date Ended"),b()()()(),x(27,"div",10)(28,"button",11),Z("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),x(29,"div",12),ee(30,LJ,4,0,"svg",13)(31,kJ,4,0,"svg",13),x(32,"p"),M(33,"Event Name"),b()()()(),x(34,"div",10)(35,"button",11),Z("click",function(){return n.onSortChange("details"),n.ascDetails=!n.ascDetails}),x(36,"div",12),ee(37,NJ,4,0,"svg",13)(38,FJ,4,0,"svg",13),x(39,"p"),M(40,"Details"),b()()()(),x(41,"div",10)(42,"button",11),Z("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),x(43,"div",12),ee(44,OJ,4,0,"svg",13)(45,BJ,4,0,"svg",13),x(46,"p"),M(47,"Status"),b()()()(),x(48,"div",10)(49,"div",12)(50,"p"),M(51,"Images"),b()()(),x(52,"div",12)(53,"div",12)(54,"p"),M(55,"Review"),b()()()(),ee(56,UJ,16,7,"div",14),x(57,"div",15)(58,"button",16),Z("click",function(){return n.prevTransaction()}),M(59," Prev "),b(),x(60,"button",16),Z("click",function(){return n.nextTransaction()}),M(61," Next "),b()()(),ee(62,GJ,48,8,"div",17)(63,WJ,1,0,"div",18)(64,qJ,7,0,"div",19)(65,ZJ,1,0,"div",20)(66,XJ,13,0,"div",21),b()),t&2&&(I(11),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascStart),I(),F("ngIf",!n.ascStart),I(6),F("ngIf",n.ascEnd),I(),F("ngIf",!n.ascEnd),I(6),F("ngIf",n.ascEvent),I(),F("ngIf",!n.ascEvent),I(6),F("ngIf",n.ascDetails),I(),F("ngIf",!n.ascDetails),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(11),F("ngForOf",n.getEventsToDisplay()),I(6),F("ngIf",n.isModalOpen),I(),F("ngIf",n.submit=="true"),I(),F("ngIf",n.submit=="true"),I(),F("ngIf",n.disable),I(),F("ngIf",n.disable))},dependencies:[mn,Dr,bn,An,Ir,wn,dr,Mt,pn,Nt,Wr,qr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function YJ(i,e){if(i&1&&(x(0,"span",24),M(1),b()),i&2){let t=Y();I(),ge(t.eventImage.name)}}function QJ(i,e){i&1&&(x(0,"span",24),M(1,"Upload image"),b())}function KJ(i,e){if(i&1&&(x(0,"div",4)(1,"p",25),M(2),b()()),i&2){let t=Y();I(2),ge(t.errorMessage)}}function JJ(i,e){i&1&&B(0,"div",26)}function $J(i,e){if(i&1){let t=rt();x(0,"div",27)(1,"div",28)(2,"p",29),M(3," Event successfully created! "),b()(),x(4,"div",30)(5,"button",31),Z("click",function(){he(t);let r=Y();return fe(r.eventCreated())}),M(6,"Okay "),b()()()}}var rx=class i{constructor(e,t){this.router=e;this.adminService=t}errorMessage="";isModalOpen=!1;created=!1;eventName="";eventStart="";eventEnd="";eventDetails="";eventImage=null;imageFileName="";onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}openModal(e){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){let e=new Date,t=new Date(this.eventStart),n=new Date(this.eventEnd);if(t.getTime()===n.getTime()){this.errorMessage="The start and end dates cannot be the same.";return}if(n<t){this.errorMessage="The end date must be later than the start date.";return}if(t<e){this.errorMessage="The start date must be in the future.";return}if(n<e){this.errorMessage="The end date must be in the future.";return}let r=new FormData;r.append("eventName",this.eventName),r.append("eventStart",this.eventStart),r.append("eventEnd",this.eventEnd),r.append("details",this.eventDetails),this.eventImage&&r.append("eventImage",this.eventImage,this.eventImage.name),this.adminService.createEvents(r).subscribe({next:s=>{console.log(s.message,s.success),s.success&&(console.log("Event created successfully."),this.created=!0)},error:s=>{this.errorMessage="Error submitting the event. Please try again.",console.error(s)}})}eventCreated(){this.created=!this.created,this.closeModal(),this.eventName="",this.eventStart="",this.eventEnd="",this.eventDetails="",this.eventImage=null,this.imageFileName="",window.location.reload()}ngOnInit(){sessionStorage.getItem("events")!="1"&&this.router.navigate(["/dashboard-admin"])}static \u0275fac=function(t){return new(t||i)(ne(et),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-events-create"]],standalone:!0,features:[_t],decls:38,vars:9,consts:[["fileInput",""],[1,"bg-[#226f54]","rounded-lg","p-6","max-w-screen-xl","mx-auto"],[1,"text-2xl","font-bold","text-gray-50"],[1,"mt-4",3,"ngSubmit"],[1,"mb-4"],["for","event_name",1,"block","text-sm","font-medium","text-gray-50"],["id","event_name","name","event_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-x-2"],["for","event_start",1,"block","text-sm","font-medium","text-gray-50"],["id","event_start","name","event_start","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_end",1,"block","text-sm","font-medium","text-gray-50"],["id","event_end","name","event_end","type","datetime-local",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","details",1,"block","text-sm","font-medium","text-gray-50"],["id","details","name","details","rows","4",1,"mt-1","block","min-h-72","h-72","max-h-72","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","focus:outline-none","focus:ring-[3px]","focus:ring-customSkyBlue","flex","items-center","justify-between",3,"click"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","eventImage","name","eventImage","required","",1,"hidden",3,"change"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-[65rem] overflow-y-hidden w-full z-[1000]",4,"ngIf"],["class","animate-fadeIn overflow-hidden  absolute px-8 grid justify-center items-center top-[15rem] left-1/2 transform -translate-x-1/2 w-480px h-[380px]  md:h-[380px] md:w-[480px] border-2 border-green-50 shadow-gray-800 shadow-lg rounded-xl z-[1100] bg-customDarkGreen",4,"ngIf"],[1,"text-gray-700"],[1,"text-center","text-md","text-gray-50"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-[65rem]","overflow-y-hidden","w-full","z-[1000]"],[1,"animate-fadeIn","overflow-hidden","absolute","px-8","grid","justify-center","items-center","top-[15rem]","left-1/2","transform","-translate-x-1/2","w-480px","h-[380px]","md:h-[380px]","md:w-[480px]","border-2","border-green-50","shadow-gray-800","shadow-lg","rounded-xl","z-[1100]","bg-customDarkGreen"],[1,"flex","w-full","h-full","justify-center","items-center"],[1,"text-gray-50","text-center","text-3xl","w-80"],[1,"flex","justify-end","w-full"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"]],template:function(t,n){if(t&1){let r=rt();x(0,"div",1)(1,"h2",2),M(2,"Create Event"),b(),B(3,"hr"),x(4,"form",3),Z("ngSubmit",function(){return he(r),fe(n.onSubmit())}),x(5,"div",4)(6,"label",5),M(7,"Event Name"),b(),x(8,"input",6),nt("ngModelChange",function(o){return he(r),it(n.eventName,o)||(n.eventName=o),fe(o)}),b()(),x(9,"div",7)(10,"div",4)(11,"label",8),M(12,"Event Start"),b(),x(13,"input",9),nt("ngModelChange",function(o){return he(r),it(n.eventStart,o)||(n.eventStart=o),fe(o)}),b()(),x(14,"div",4)(15,"label",10),M(16,"Event End"),b(),x(17,"input",11),nt("ngModelChange",function(o){return he(r),it(n.eventEnd,o)||(n.eventEnd=o),fe(o)}),b()()(),x(18,"div",4)(19,"label",12),M(20,"Details"),b(),x(21,"textarea",13),nt("ngModelChange",function(o){return he(r),it(n.eventDetails,o)||(n.eventDetails=o),fe(o)}),b()(),x(22,"div",4)(23,"label",14),M(24,"Event Image"),b(),x(25,"div",15),Z("click",function(){he(r);let o=is(31);return fe(o.click())}),ee(26,YJ,2,1,"span",16)(27,QJ,2,0,"span",16),x(28,"button",17),M(29," Browse "),b()(),x(30,"input",18,0),Z("change",function(o){return he(r),fe(n.onFileChange(o))}),b()(),ee(32,KJ,3,1,"div",19),x(33,"div",20)(34,"button",21),M(35," Create Event "),b()()(),ee(36,JJ,1,0,"div",22)(37,$J,7,0,"div",23),b()}t&2&&(I(8),tt("ngModel",n.eventName),I(5),tt("ngModel",n.eventStart),I(4),tt("ngModel",n.eventEnd),I(4),tt("ngModel",n.eventDetails),I(5),F("ngIf",n.eventImage),I(),F("ngIf",!n.eventImage),I(5),F("ngIf",n.errorMessage),I(4),F("ngIf",n.created),I(),F("ngIf",n.created))},dependencies:[mn,Dr,bn,An,Ir,wn,dr,Mt,Nt,Wr,qr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var e$=["modelContainer"];function t$(i,e){if(i&1){let t=rt();x(0,"button",22),Z("click",function(){he(t);let r=Y();return r.changeModel("assets/model/mapTerrain.glb"),fe(r.mapTerrain=!0)}),x(1,"div",23),te(),x(2,"svg",24),B(3,"path",25),b()()()}}function n$(i,e){if(i&1){let t=rt();x(0,"button",26),Z("click",function(){he(t);let r=Y();return r.changeModel("assets/model/map.glb"),fe(r.mapTerrain=!1)}),x(1,"div",27),te(),x(2,"svg",24),B(3,"path",25),b()()()}}function i$(i,e){if(i&1&&(x(0,"option",28),M(1),b()),i&2){let t=e.$implicit;F("value",t.event_id),I(),Qt(" ",t.event_name," ")}}function r$(i,e){i&1&&B(0,"div",29)}function s$(i,e){if(i&1){let t=rt();x(0,"div",30)(1,"div",31)(2,"div"),B(3,"img",32),x(4,"p",33),M(5),b()(),x(6,"div",34)(7,"button",35),Z("click",function(){he(t);let r=Y();return fe(r.errorMessage="")}),M(8,"Close"),b(),x(9,"button",36),Z("click",function(){he(t);let r=Y();return r.isModalOpen=!r.isModalOpen,fe(r.errorMessage="")}),M(10,"Edit"),b()()()()}if(i&2){let t=Y();I(3),Mr("src","https://mapp-thesis.infotech3c.com/public/dbAssets/kioskImages/",t.kioskImage,"",_i),I(2),ge(t.kioskName)}}function o$(i,e){if(i&1&&(x(0,"span",59),M(1),b()),i&2){let t=Y(2);I(),ge(t.kioskUploadImage.name)}}function a$(i,e){i&1&&(x(0,"span",59),M(1,"Upload image"),b())}function l$(i,e){if(i&1&&(x(0,"div",39)(1,"p",60),M(2),b()()),i&2){let t=Y(2);I(2),ge(t.errorMessage)}}function c$(i,e){if(i&1){let t=rt();x(0,"div",30)(1,"div",31)(2,"h2",37),M(3,"Edit Kiosk"),b(),x(4,"form",38),Z("ngSubmit",function(){he(t);let r=Y();return fe(r.onSubmit())}),x(5,"div",39)(6,"label",40),M(7,"Kiosk Name"),b(),x(8,"input",41),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.kioskName,r)||(s.kioskName=r),fe(r)}),b()(),x(9,"div",39)(10,"label",42),M(11,"Status"),b(),x(12,"select",43),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.kioskStatus,r)||(s.kioskStatus=r),fe(r)}),x(13,"option",44),M(14,"Unavailable"),b(),x(15,"option",45),M(16,"Available"),b(),x(17,"option",46),M(18,"Disable"),b(),x(19,"option",47),M(20,"Pending"),b()()(),x(21,"div",39)(22,"label",48),M(23,"Description"),b(),x(24,"textarea",49),nt("ngModelChange",function(r){he(t);let s=Y();return it(s.kioskDescription,r)||(s.kioskDescription=r),fe(r)}),b()(),x(25,"div",39)(26,"label",50),M(27,"Kiosk Image"),b(),x(28,"div",51),ee(29,o$,2,1,"span",52)(30,a$,2,0,"span",52),x(31,"div",53),M(32,"Browse"),b()(),x(33,"input",54,1),Z("change",function(r){he(t);let s=Y();return fe(s.onFileChange(r))}),b()(),ee(35,l$,3,1,"div",55),x(36,"div",56)(37,"button",57),Z("click",function(){he(t);let r=Y();return fe(r.closeModal())}),M(38," Cancel "),b(),x(39,"button",58),M(40," Save Changes "),b()()()()()}if(i&2){let t=Y();I(8),tt("ngModel",t.kioskName),I(4),tt("ngModel",t.kioskStatus),I(12),tt("ngModel",t.kioskDescription),I(5),F("ngIf",t.kioskUploadImage),I(),F("ngIf",!t.kioskUploadImage),I(5),F("ngIf",t.errorMessage!="done"&&!t.errorMessage)}}function d$(i,e){i&1&&B(0,"div",29)}function u$(i,e){if(i&1){let t=rt();x(0,"div",30)(1,"div",61)(2,"p",62),M(3,"Kiosk Updated Successfully!"),b(),x(4,"div",63)(5,"button",64),Z("click",function(){he(t);let r=Y();return fe(r.changeVal())}),M(6," Okay "),b()()()()}}var sx=class i{constructor(e,t,n){this.router=e;this.screenSizeService=t;this.adminService=n;this.scene=new Fd,this.camera=new Fn(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new Nd({antialias:!0}),this.fontLoader=new Gl}kioskData=[];eventData=[];scene;camera;renderer;model;controls;raycaster=new Ud;pointer=new ye;clickableObjects=[];errorMessage="";fontLoader;isMap=!1;kioskName="";eventId="";kioskId="";submitKiosk="";kioskStatus="";posx="";posy="";kioskDescription="";kioskImage="";mapTerrain=!1;selectedEventId="";selectedEventName="Select events";currentModel;kioskUploadImage=null;kioskUploadImageName="";isModalOpen=!1;disable=!1;modelContainer;ngOnChanges(e){}onEventSelect(e){let n=e.target.value;sessionStorage.setItem("eventIdMap",this.selectedEventId);let r=this.eventData.find(s=>s.event_id===n);if(r){let s=r.event_name;sessionStorage.setItem("eventIdMap",n),sessionStorage.setItem("eventNameMap",s)}window.location.reload()}getEventName(){return sessionStorage.getItem("eventNameMap")??"Select events"}getEvents(){this.adminService.getEvent().subscribe(e=>{this.eventData=e.map(t=>({event_id:t.event_id,event_name:t.event_name}))},e=>{console.error("Error fetching events:",e)})}changeVal(){sessionStorage.setItem("submit","false"),this.submitKiosk="false"}ngOnInit(){this.submitKiosk=sessionStorage.getItem("submit")??"",this.addClickListener(),this.getEvents(),this.controls=new Ha(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let e=new Oa(4210752);this.scene.add(e);let t=new zs(16777215,1);t.position.set(20,20,20).normalize(),this.scene.add(t);let n=sessionStorage.getItem("eventIdMap")??"";console.log(n),this.adminService.getKioskMap(n).subscribe(r=>{this.kioskData=r,r.forEach(s=>{let o=new Do(.15,.15,.15);if(s.status=="available"){let a=new yn({color:5405039}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="pending"){let a=new yn({color:16760331}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else if(s.status=="unavailable"){let a=new yn({color:10289672}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,kiosk:s,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}else{let a=new yn({color:1779259}),l=new Ht(o,a);l.position.set(s.position_x,.65,s.position_y),l.userData={name:s.kiosk_name,eventId:s.event_id,kioskId:s.kiosk_id,kioskStatus:s.status,kioskDescription:s.kiosk_description,kioskImage:s.kiosk_image,kiosk:s,posx:s.position_x,posy:s.position_y},this.scene.add(l),this.clickableObjects.push(l)}this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",a=>{let l=new Ur(s.kiosk_name.replace(/\D/g,""),{font:a,size:.08,height:.05,curveSegments:12}),c=new yn({color:16381939}),d=new Ht(l,c);this.scene.add(d),d.position.set(s.position_x,.8,s.position_y),d.scale.z=-1})}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new Ur("Gym",{font:s,size:.5,height:.05,curveSegments:12}),a=new yn({color:3096134}),l=new Ht(o,a);this.scene.add(l),l.position.set(1,1.8,1),l.scale.z=-1}),this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",s=>{let o=new Ur("Field",{font:s,size:.5,height:.05,curveSegments:12}),a=new yn({color:3096134}),l=new Ht(o,a);this.scene.add(l),l.position.set(-1.5,1.8,0),l.scale.z=-1})}),this.loadModel("assets/model/map.glb")}loadModel(e){let t=new jl;this.removeModel(),t.load(e,n=>{this.currentModel=n.scene,this.scene.add(this.currentModel)},void 0,n=>{console.error("An error occurred while loading the model:",n)})}removeModel(){this.currentModel&&(this.scene.remove(this.currentModel),this.currentModel.traverse(e=>{e instanceof Ht&&(e.geometry&&e.geometry.dispose(),Array.isArray(e.material)?e.material.forEach(t=>{t instanceof Mn&&t.dispose()}):e.material instanceof Mn&&e.material.dispose())}),this.currentModel=void 0)}changeModel(e){this.loadModel(e),this.renderer.domElement.addEventListener("click",r=>this.onMouseClick(r)),this.controls=new Ha(this.camera,this.renderer.domElement),this.camera.position.set(0,.3,8.6),this.controls.minDistance=5,this.controls.maxDistance=30,this.renderer.setClearColor(16777215,1),this.renderer.setSize(window.innerWidth,window.innerHeight);let t=new Oa(4210752);this.scene.add(t);let n=new zs(16777215,1);n.position.set(20,20,20).normalize(),this.scene.add(n)}onMouseClick(e){this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);let t=this.raycaster.intersectObjects(this.clickableObjects);if(t.length>0){let n=t[0].object,r=n.position.y,s=n.userData;console.log("User data:",s);let o=s.kioskId,a=s.name,l=s.eventId,c=s.kioskStatus,d=s.kioskDescription,u=s.kioskImage,h=s.posx,f=s.posy;this.errorMessage="done",this.eventId=l,this.kioskId=o,this.kioskName=a,this.kioskStatus=c,this.kioskDescription=d,this.kioskImage=u,this.posx=h,this.posy=f}}addClickListener(){this.modelContainer.nativeElement.addEventListener("click",e=>this.onMouseClick(e))}ngAfterViewInit(){this.modelContainer&&this.modelContainer.nativeElement?(this.modelContainer.nativeElement.appendChild(this.renderer.domElement),this.animate()):console.error("Model container not found.")}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}ngOnDestroy(){this.model&&(this.scene.remove(this.model),this.model.traverse(t=>{t instanceof Ht&&(t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(n=>{n instanceof Mn&&n.dispose()}):t.material instanceof Mn&&t.material.dispose())})),this.renderer&&this.renderer.dispose();let e=this.renderer.domElement;e.parentElement&&e.parentElement.removeChild(e),this.controls&&this.controls.dispose()}openModal(e){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){let e=new FormData;e.append("kioskId",this.kioskId),e.append("kioskName",this.kioskName),e.append("posx",this.posx),e.append("posy",this.posy),e.append("kioskDescription",this.kioskDescription),e.append("status",this.kioskStatus),this.kioskUploadImage&&e.append("kioskUploadImage",this.kioskUploadImage,this.kioskUploadImage.name),this.adminService.updateKiosk(e).subscribe({next:t=>{console.log(t.message,t.success),t.success&&(sessionStorage.setItem("submit","true"),this.closeModal(),this.kioskId="",this.kioskName="",this.kioskDescription="",this.posx="",this.posy="",this.kioskStatus="",this.kioskUploadImage=null,this.kioskUploadImageName="",window.location.reload())},error:t=>{this.errorMessage="Error submitting the application. Please try again.",console.error(t)}})}onFileChange(e){this.isModalOpen=!0;let t=e.target;t.files&&t.files.length>0&&(this.kioskUploadImage=t.files[0],this.kioskUploadImageName=this.kioskUploadImage.name)}static \u0275fac=function(t){return new(t||i)(ne(et),ne(za),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-map-viewer"]],viewQuery:function(t,n){if(t&1&&ai(e$,7),t&2){let r;zn(r=jn())&&(n.modelContainer=r.first)}},standalone:!0,features:[Ni,_t],decls:34,vars:9,consts:[["modelContainer",""],["fileInput",""],[1,"w-full","h-full","overflow-hidden","absolute","left-[0.5rem]","top-[0rem]","z-[0]"],[1,"overflow-hidden"],[1,"z-[1000]","fixed","top-0","right-0","w-[550px]","sm:w-auto","p-4"],[1,"w-full","grid","grid-cols-2","bg-gray-400","p-4","rounded-xl","gap-2"],[1,"flex","justify-center","align-center","w-full","h-full","pt-12"],["class","size-20 hover:bg-green-700 hover:text-gray-50 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],["class","size-20  hover:bg-green-700 hover:text-gray-200 hover:shadow-[#87c38f] hover:shadow-md bg-green-500 text-white flex justify-center items-start rounded-xl",3,"click",4,"ngIf"],[1,"grid","grid-cols-2","gap-2","justify-center"],[1,"text-gray-50","text-lg","col-span-2","text-center"],[1,"size-6","bg-red-500","rounded-lg"],[1,"text-gray-50","text-xs"],[1,"size-6","bg-green-500","rounded-lg"],[1,"size-6","bg-yellow-500","rounded-lg"],[1,"size-6","bg-blue-500","rounded-lg"],["for","eventSelect",1,"col-span-2","text-left","text-lg","text-gray-50"],["id","eventSelect",1,"outline-none","w-full","justify","center","col-span-2",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","fixed inset-0 flex items-center justify-center bg-white bg-opacity-50 z-20",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center bg-gray-700 bg-opacity-50 z-[1000]",4,"ngIf"],[1,"size-20","hover:bg-green-700","hover:text-gray-50","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-6","justify-center","text-gray-50"],["width","24px","height","24px","viewBox","0 0 100 100","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","aria-hidden","true","role","img","preserveAspectRatio","xMidYMid meet",1,"iconify","iconify--gis"],["d","M50 5L24.637 30.469H41.34v20.705h17.32V30.469h16.703zM28.135 37.309a3.5 3.5 0 0 0-2.668 1.234L.832 67.559a3.5 3.5 0 0 0 2.67 5.765l93-.064a3.5 3.5 0 0 0 2.666-5.766L74.59 38.543a3.5 3.5 0 0 0-2.668-1.234H64.66c-.002 2.333-.008 4.666-.008 7h5.649l18.64 21.957l-77.873.052l18.686-22.01h5.586c.002-2.333.003-4.666 0-7zM89.91 78.264l-9.178.007l8.211 9.67l-77.875.053l8.22-9.682l-9.188.008L.832 89.234A3.5 3.5 0 0 0 3.502 95l93-.064a3.5 3.5 0 0 0 2.666-5.766z","fill","#161a1d"],[1,"size-20","hover:bg-green-700","hover:text-gray-200","hover:shadow-[#87c38f]","hover:shadow-md","bg-green-500","text-white","flex","justify-center","items-start","rounded-xl",3,"click"],[1,"flex","h-full","pt-6","justify-center","text-gray-300"],[3,"value"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","z-20"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-gray-700","bg-opacity-50","z-[1000]"],[1,"bg-[#226f54]","rounded-lg","p-6","w-1/3","absolute"],[1,"size-full","object-contain",3,"src"],[1,"text-center","text-lg","text-gray-50","mt-4"],[1,"flex","justify-between","w-full","mt-4"],[1,"h-12","w-24","bg-red-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-red-800","hover:text-gray-200","hover:shadow-red-900","hover:shadow-md",3,"click"],[1,"h-12","w-24","bg-green-400","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-green-800","hover:text-gray-200","hover:shadow-green-900","hover:shadow-md",3,"click"],[1,"text-xl","font-bold","mb-4","text-gray-50","text-center"],[3,"ngSubmit"],[1,"mb-4"],["for","kiosk_name",1,"block","text-sm","font-medium","text-gray-50"],["id","kiosk_name","name","kiosk_name","type","text",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","status",1,"block","text-sm","font-medium","text-gray-50"],["id","status","name","status",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","unavailable"],["value","available"],["value","disable"],["value","pending"],["for","kiosk_description",1,"block","text-sm","font-medium","text-gray-50"],["id","kiosk_description","name","kiosk_description","rows","3",1,"mt-1","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","event_image",1,"block","text-sm","font-medium","text-gray-50"],[1,"relative","h-12","bg-white","rounded-md","text-sm","px-4","py-2","w-full","border","border-gray-300","cursor-pointer","flex","items-center","justify-between"],["class","text-gray-700",4,"ngIf"],[1,"bg-green-800","text-white","px-3","py-1","rounded-md","text-xs","hover:bg-green-900"],["type","file","id","eventImage","name","eventImage",1,"hidden",3,"change"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end"],["type","button",1,"px-4","py-2","mr-2","text-white","bg-gray-500","hover:bg-gray-700","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","text-white","bg-green-700","hover:bg-green-800","rounded-md"],[1,"text-gray-700"],[1,"text-center","text-md","text-gray-50"],[1,"bg-[#226f54]","rounded-lg","p-6","w-1/3","h-[350px]","relative","flex","flex-col","justify-center"],[1,"text-gray-50","text-center","text-3xl","mb-4"],[1,"flex","justify-end","mt-36"],[1,"h-12","w-24","bg-dropDown","rounded-xl","text-gray-50","text-center","text-xl","hover:bg-hoverBar","hover:text-gray-200","hover:shadow-hoverBar","hover:shadow-md",3,"click"]],template:function(t,n){if(t&1){let r=rt();x(0,"div",2),B(1,"div",3,0),b(),x(3,"div",4)(4,"div",5)(5,"div",6),ee(6,t$,4,0,"button",7)(7,n$,4,0,"button",8),b(),x(8,"div",9)(9,"p",10),M(10,"Legend:"),b(),B(11,"div",11),x(12,"p",12),M(13,"Unavailable"),b(),B(14,"div",13),x(15,"p",12),M(16,"Available"),b(),B(17,"div",14),x(18,"p",12),M(19,"Pending"),b(),B(20,"div",15),x(21,"p",12),M(22,"Disable"),b()(),x(23,"label",16),M(24,"Select Events:"),b(),x(25,"select",17),Z("change",function(o){return he(r),fe(n.onEventSelect(o))}),x(26,"option",18),M(27),b(),ee(28,i$,2,2,"option",19),b()()(),ee(29,r$,1,0,"div",20)(30,s$,11,3,"div",21)(31,c$,41,6,"div",21)(32,d$,1,0,"div",20)(33,u$,7,0,"div",21)}t&2&&(I(6),F("ngIf",!n.mapTerrain),I(),F("ngIf",n.mapTerrain),I(20),ge(n.getEventName()),I(),F("ngForOf",n.eventData),I(),F("ngIf",n.errorMessage),I(),F("ngIf",n.errorMessage=="done"),I(),F("ngIf",n.isModalOpen),I(),F("ngIf",n.submitKiosk=="true"),I(),F("ngIf",n.submitKiosk=="true"))},dependencies:[Mt,pn,Nt,mn,Dr,ba,Aa,bn,ed,An,Ir,wn,dr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function h$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",17)(2,"line",18)(3,"line",19),b())}function f$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",20)(2,"line",21)(3,"line",22),b())}function p$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",17)(2,"line",18)(3,"line",19),b())}function m$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",20)(2,"line",21)(3,"line",22),b())}function g$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",17)(2,"line",18)(3,"line",19),b())}function v$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",20)(2,"line",21)(3,"line",22),b())}function x$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",17)(2,"line",18)(3,"line",19),b())}function w$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",20)(2,"line",21)(3,"line",22),b())}function y$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",17)(2,"line",18)(3,"line",19),b())}function b$(i,e){i&1&&(te(),x(0,"svg",16),B(1,"path",20)(2,"line",21)(3,"line",22),b())}function A$(i,e){i&1&&(x(0,"p",29),M(1,"Event Ended"),b())}function _$(i,e){i&1&&(x(0,"p",30),M(1,"Event Disabled"),b())}function S$(i,e){if(i&1&&(x(0,"div",23)(1,"div",24),M(2),b(),x(3,"div",24),M(4),b(),x(5,"div",11),M(6),b(),x(7,"div",25),M(8),b(),x(9,"div",11),ee(10,A$,2,0,"p",26)(11,_$,2,0,"p",27),b(),x(12,"div",11),B(13,"img",28),b()()),i&2){let t=e.$implicit,n=Y();I(2),ge(n.formatDate(t.event_start)),I(2),ge(n.formatDate(t.event_end)),I(2),ge(t.event_name),I(2),ge(t.details),I(2),F("ngIf",t.status==1),I(),F("ngIf",t.status==0),I(2),Mr("src","https://mapp-thesis.infotech3c.com/public/dbAssets/eventImages/",t.event_image,"",_i)}}var ox=class i{constructor(e,t,n,r,s,o){this.ngZone=e;this.sanitizer=t;this.router=n;this.userService=r;this.eventService=s;this.adminService=o}eventData=[];searchText="";pageIndex=0;pageSize=10;sortField="event_start";sortDirection="asc";ascStart=!1;ascEnd=!1;ascEvent=!1;ascDetails=!1;ascStatus=!1;errorMessage="";isModalOpen=!1;selectedEvent={};disable=!1;eventName="";eventStart="";eventStatus="";eventEnd="";eventDetails="";eventId="";eventImage=null;imageFileName="";submit="false";onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onFileChange(e){let t=e.target;t.files&&t.files.length>0&&(this.eventImage=t.files[0],this.imageFileName=this.eventImage.name)}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(e){let t=this.eventData.find(n=>n.event_id==e);return t?t.event_name:"Unknown Event"}getEvent(){this.adminService.getPastEvent().subscribe(e=>{this.eventData=e})}openModal(e){this.selectedEvent=re({},e),this.isModalOpen=!0}get eventStatusModel(){return this.eventStatus==="1"?"active":this.eventStatus}set eventStatusModel(e){this.eventStatus=e==="active"?"1":e}onStatusChange(e){console.log("Event Status Changed:",this.eventStatus)}toLowerCaseSafe(e){return e?e.toLowerCase():""}getEventsToDisplay(){let e=this.eventData.filter(r=>this.toLowerCaseSafe(r.event_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_start).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.event_end).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe("active").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.details).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortEvents(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortEvents(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.eventData.length&&(console.log(this.eventData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}changeVal(){sessionStorage.setItem("submit","false"),this.submit="false"}ngOnInit(){sessionStorage.getItem("history")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getEvent()}static \u0275fac=function(t){return new(t||i)(ne(sn),ne(rs),ne(et),ne(qn),ne(di),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-history"]],standalone:!0,features:[_t],decls:58,vars:12,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-lg","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","overflow-hidden","grid-cols-6","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-sm","md:text-lg","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["class","grid grid-cols-6 overflow-hidden bg-customDarkGreen border-b border-gray-50 border-b-[3px] text-center w-full h-full px-3 md:px-2 py-2 text-xs md:text-lg font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-6","overflow-hidden","bg-customDarkGreen","border-b","border-gray-50","border-b-[3px]","text-center","w-full","h-full","px-3","md:px-2","py-2","text-xs","md:text-lg","font-semibold","text-gray-200"],[1,"flex","justify-center","items-center","text-sm"],[1,"flex","justify-center","items-center","text-xs","leading-none"],["class","text-green-200",4,"ngIf"],["class","text-red-200",4,"ngIf"],[1,"size-24","object-cover","border-2","border-gray-50","rounded-xl",3,"src"],[1,"text-green-200"],[1,"text-red-200"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),M(5," Events History:"),b()(),x(6,"div",4),te(),x(7,"svg",5)(8,"g")(9,"g"),B(10,"path",6),b()()(),ot(),x(11,"input",7),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(12,"div",8)(13,"div",9)(14,"button",10),Z("click",function(){return n.onSortChange("event_start"),n.ascStart=!n.ascStart}),x(15,"div",11),ee(16,h$,4,0,"svg",12)(17,f$,4,0,"svg",12),x(18,"p"),M(19,"Date Started"),b()()()(),x(20,"div",9)(21,"button",10),Z("click",function(){return n.onSortChange("event_end"),n.ascEnd=!n.ascEnd}),x(22,"div",11),ee(23,p$,4,0,"svg",12)(24,m$,4,0,"svg",12),x(25,"p"),M(26,"Date Ended"),b()()()(),x(27,"div",9)(28,"button",10),Z("click",function(){return n.onSortChange("event_name"),n.ascEvent=!n.ascEvent}),x(29,"div",11),ee(30,g$,4,0,"svg",12)(31,v$,4,0,"svg",12),x(32,"p"),M(33,"Event Name"),b()()()(),x(34,"div",9)(35,"button",10),Z("click",function(){return n.onSortChange("details"),n.ascDetails=!n.ascDetails}),x(36,"div",11),ee(37,x$,4,0,"svg",12)(38,w$,4,0,"svg",12),x(39,"p"),M(40,"Details"),b()()()(),x(41,"div",9)(42,"button",10),Z("click",function(){return n.onSortChange("status"),n.ascStatus=!n.ascStatus}),x(43,"div",11),ee(44,y$,4,0,"svg",12)(45,b$,4,0,"svg",12),x(46,"p"),M(47,"Status"),b()()()(),x(48,"div",9)(49,"div",11)(50,"p"),M(51,"Images"),b()()()(),ee(52,S$,14,8,"div",13),x(53,"div",14)(54,"button",15),Z("click",function(){return n.prevTransaction()}),M(55," Prev "),b(),x(56,"button",15),Z("click",function(){return n.nextTransaction()}),M(57," Next "),b()()()()),t&2&&(I(11),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascStart),I(),F("ngIf",!n.ascStart),I(6),F("ngIf",n.ascEnd),I(),F("ngIf",!n.ascEnd),I(6),F("ngIf",n.ascEvent),I(),F("ngIf",!n.ascEvent),I(6),F("ngIf",n.ascDetails),I(),F("ngIf",!n.ascDetails),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(7),F("ngForOf",n.getEventsToDisplay()))},dependencies:[mn,bn,An,wn,Mt,pn,Nt,Wr,qr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var E$=(()=>{class i{_printStyle=[];_styleSheetFile="";setPrintStyle(t){this._printStyle=[];for(let n in t)t.hasOwnProperty(n)&&this._printStyle.push((n+JSON.stringify(t[n])).replace(/['"]+/g,""))}returnStyleValues(){return`<style> ${this._printStyle.join(" ").replace(/,/g,";")} </style>`}returnStyleSheetLinkTags(){return this._styleSheetFile}setStyleSheetFile(t){let n=function(r){return`<link rel="stylesheet" type="text/css" href="${r}">`};if(t.indexOf(",")!==-1){let r=t.split(",");this._styleSheetFile=r.map(s=>n(s)).join("")}else this._styleSheetFile=n(t)}updateInputDefaults(t){for(let n=0;n<t.length;n++){let r=t[n];r.defaultValue=r.value,r.checked&&(r.defaultChecked=!0)}}updateSelectDefaults(t){for(let n=0;n<t.length;n++){let r=t[n],s=r.selectedIndex,o=r.options[s];o.defaultSelected=!0}}updateTextAreaDefaults(t){for(let n=0;n<t.length;n++){let r=t[n];r.defaultValue=r.value}}canvasToImageHtml(t){return`<img src="${t.toDataURL()}" style="max-width: 100%;">`}updateCanvasToImage(t){for(let n=0;n<t.length;n++){let r=this.canvasToImageHtml(t[n]);t[n].insertAdjacentHTML("afterend",r),t[n].remove()}}getHtmlContents(t){let n=document.getElementById(t);if(!n)return null;let r=n.getElementsByTagName("input"),s=n.getElementsByTagName("select"),o=n.getElementsByTagName("textarea"),a=n.getElementsByTagName("canvas");return this.updateInputDefaults(r),this.updateSelectDefaults(s),this.updateTextAreaDefaults(o),this.updateCanvasToImage(a),n.innerHTML}getElementTag(t){let n=[],r=document.getElementsByTagName(t);for(let s=0;s<r.length;s++)n.push(r[s].outerHTML);return n.join(`\r
`)}print(t){let n="",r="",s="top=0,left=0,height=auto,width=auto",o=this.getElementTag("base");t.useExistingCss&&(n=this.getElementTag("style"),r=this.getElementTag("link")),t.openNewTab&&(s="");let a=this.getHtmlContents(t.printSectionId);if(!a){console.error(`Print section with id ${t.printSectionId} not found.`);return}let l=window.open("","_blank",s);if(!l){console.error("Could not open print window.");return}l.document.open(),l.document.write(`
          <html>
            <head>
              <title>${t.printTitle?t.printTitle:""}</title>
              ${o}
              ${this.returnStyleValues()}
              ${this.returnStyleSheetLinkTags()}
              ${n}
              ${r}
            </head>
            <body ${t.bodyClass?`class="${t.bodyClass}"`:""}>
              ${a}
              <script defer>
                function triggerPrint(event) {
                  window.removeEventListener('load', triggerPrint, false);
                  ${t.previewOnly?"":`setTimeout(function() {
                    closeWindow(window.print());
                  }, ${t.printDelay});`}
                }
                function closeWindow(){
                  ${t.closeWindow?"window.close();":""}
                }
                window.addEventListener('load', triggerPrint, false);
              <\/script>
            </body>
          </html>`),l.document.close()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Se({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var kC=class{printSectionId=null;printTitle=null;useExistingCss=!1;bodyClass="";openNewTab=!1;previewOnly=!1;closeWindow=!0;printDelay=0;constructor(e){e&&Object.assign(this,e)}},G3=(()=>{class i extends E${printOptions=new kC;set previewOnly(t){this.printOptions=Ge(re({},this.printOptions),{previewOnly:t})}set printSectionId(t){this.printOptions=Ge(re({},this.printOptions),{printSectionId:t})}set printTitle(t){this.printOptions=Ge(re({},this.printOptions),{printTitle:t})}set useExistingCss(t){this.printOptions=Ge(re({},this.printOptions),{useExistingCss:t})}set printDelay(t){this.printOptions=Ge(re({},this.printOptions),{printDelay:t})}set closeWindow(t){this.printOptions=Ge(re({},this.printOptions),{closeWindow:t})}set bodyClass(t){this.printOptions=Ge(re({},this.printOptions),{bodyClass:t})}set openNewTab(t){this.printOptions=Ge(re({},this.printOptions),{openNewTab:t})}set printStyle(t){super.setPrintStyle(t)}set styleSheetFile(t){super.setStyleSheetFile(t)}print(){super.print(this.printOptions)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=es(i)))(r||i)}})();static \u0275dir=dn({type:i,selectors:[["button","ngxPrint",""]],hostBindings:function(n,r){n&1&&Z("click",function(){return r.print()})},inputs:{previewOnly:"previewOnly",printSectionId:"printSectionId",printTitle:"printTitle",useExistingCss:"useExistingCss",printDelay:"printDelay",closeWindow:"closeWindow",bodyClass:"bodyClass",openNewTab:"openNewTab",printStyle:"printStyle",styleSheetFile:"styleSheetFile"},standalone:!0,features:[Zi]})}return i})(),W3=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({})}return i})();function M$(i,e){if(i&1&&(x(0,"option",32),M(1),b()),i&2){let t=e.$implicit;F("value",t),I(),ge(t)}}function T$(i,e){if(i&1&&(x(0,"option",32),M(1),b()),i&2){let t=e.$implicit;F("value",t.event_id),I(),Qt(" ",t.event_name," ")}}function I$(i,e){if(i&1&&(x(0,"div",34)(1,"div",25),M(2),b(),x(3,"div",25),M(4),b(),x(5,"div",25),B(6,"img",35),b()()),i&2){let t=e.$implicit;I(2),ge(t.kiosk_name),I(2),ge(t.kiosk_description),I(2),Mr("src","http://localhost/mapp-thesis/public/dbAssets/kioskImages/",t.kiosk_image,"",_i)}}function D$(i,e){if(i&1&&(x(0,"div"),ee(1,I$,7,4,"div",33),b()),i&2){let t=Y();I(),F("ngForOf",t.eventReportData.slice(0,t.itemsPerPage))}}function P$(i,e){if(i&1&&(x(0,"div",37)(1,"div",25),M(2),b(),x(3,"div",25),M(4),b(),x(5,"div",25),M(6),b()()),i&2){let t=e.$implicit;I(2),ge(t.Company_name),I(2),ge(t.First_name+" "+t.Last_name),I(2),ge(t.kiosk_name)}}function R$(i,e){if(i&1&&(x(0,"div"),ee(1,P$,7,3,"div",36),b()),i&2){let t=Y();I(),F("ngForOf",t.businessData.slice(0,t.itemsPerPage))}}function L$(i,e){if(i&1&&(x(0,"div",39)(1,"div",25),M(2),b(),x(3,"div",25),M(4),b(),x(5,"div",25),M(6),b(),x(7,"div",25),M(8),b(),x(9,"div",25),M(10),b()()),i&2){let t=e.$implicit,n=Y(2);I(2),Qt("",n.formatDate(t.date_created)," "),I(2),ge(t.kiosk_name),I(2),Qt("",t.First_name+" "+t.Last_name," "),I(2),ge(t.purpose),I(2),ge(t.status)}}function k$(i,e){if(i&1&&(x(0,"div"),ee(1,L$,11,5,"div",38),b()),i&2){let t=Y();I(),F("ngForOf",t.kioskReportData.slice(0,t.itemsPerPage))}}var ax=class i{constructor(e,t){this.adminService=e;this.router=t}eventData=[];userData=[];kioskData=[];eventReportData=[];transactionData=[];businessData=[];kioskReportData=[];finishedTransaction=0;approvedUser=0;activeEvents=0;selectedEventId="";itemsPerPage=5;pageOptions=[5,10,15,20];ngOnInit(){if(sessionStorage.getItem("reports")!=="1"){this.router.navigate(["/dashboard-admin"]);return}this.loadAllData()}ngDoCheck(){}loadAllData(){$a([this.adminService.getEvent(),this.adminService.getTransaction(),this.adminService.getUsers(),this.adminService.getKiosk()]).subscribe(([e,t,n,r])=>{this.eventData=e.map(s=>({event_id:s.event_id,event_name:s.event_name,status:s.status})),this.activeEvents=this.eventData.filter(s=>s.status==="1").length,this.transactionData=t,this.finishedTransaction=this.transactionData.filter(s=>s.status==="finished").length,this.userData=n,this.approvedUser=this.userData.filter(s=>s.status==="1").length,this.kioskData=r},e=>console.error("Error loading data:",e)),this.getBusinessReport(),this.getEventReport(),this.getKioskBusiness()}onEventSelect(e){let n=e.target.value,r=this.eventData.find(s=>s.event_id===n);r?(sessionStorage.setItem("eventIdMap",n),sessionStorage.setItem("eventNameMap",r.event_name),sessionStorage.setItem("eventIdReport",n)):console.log("Event not found."),window.location.reload()}getStoredEventId(){let e=sessionStorage.getItem("eventIdReport");return e?parseInt(e,10):null}getBusinessReport(){let e=this.getStoredEventId();e&&this.adminService.getBusinessReport(e).subscribe(t=>{this.businessData=t})}getKioskBusiness(){let e=this.getStoredEventId();e&&this.adminService.getKioskReport(e).subscribe(t=>{this.kioskReportData=t})}getEventReport(){let e=this.getStoredEventId();e&&this.adminService.getEventsReport(e).subscribe(t=>{this.eventReportData=t})}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}getEventName(){return sessionStorage.getItem("eventNameMap")??"Select events"}static \u0275fac=function(t){return new(t||i)(ne(gn),ne(et))};static \u0275cmp=vt({type:i,selectors:[["app-admin-reports"]],standalone:!0,features:[_t],decls:91,vars:14,consts:[[1,"max-w-screen-xl","min-h-screen"],["id","print-section-general",1,"max-w-screen-xl","bg-customDarkGreen","h-full","p-8","rounded-xl","shadow-md","shadow-green-900"],[1,"h-full","w-full","flex","justify-between"],[1,"text-gray-50","text-3xl","font-semibold"],[1,"grid","grid-cols-4","h-full","w-full","mt-4","gap-x-2","font-semibold"],[1,"bg-[#40916c]","flex","text-lg","justify-center","w-full","h-20","p-2","grid","rounded-lg"],[1,"text-center","text-gray-50"],[1,"flex","justify-center","align-center","text-gray-50"],[1,"text-left","text-gray-50"],[1,"max-w-screen-xl","bg-customDarkGreen","h-full","p-8","mt-2","rounded-xl","shadow-md","shadow-green-900"],[1,"h-full","w-full","flex","justify-between","my-2"],[1,"w-80","flex","justify-center","align-center"],[1,"w-40","flex","justify-center","align-center","text-gray-700","pr-2"],["for","itemsPerPage",1,"text-gray-50","pr-2","pt-2"],["id","itemsPerPage",1,"border","border-gray-300","outline-none","rounded-md","shadow-sm","w-full","px-1","text-sm","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","eventSelect",1,"border","border-gray-300","outline-none","rounded-md","shadow-sm","w-full","px-3","py-2","text-sm","focus:ring-indigo-500","focus:border-indigo-500",3,"change"],["value","","selected",""],[1,"grid","grid-cols-2","h-full","w-full","mt-8","gap-x-2","gap-y-5"],["id","print-section-kiosk",1,"col-span-2"],[1,"text-xl","text-gray-50","text-center","font-semibold","flex","justify-between","p-2"],["printSectionId","print-section-kiosk","ngxPrint","",1,"flex","justify-center","align-center","pt-1","h-8","w-8","bg-green-600","rounded-md","hover:bg-green-700",3,"useExistingCss"],["width","24px","height","24px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M17 7H7V6h10v1zm0 12H7v-6h10v6zm2-12V3H5v4H1v8.996C1 17.103 1.897 18 3.004 18H5v3h14v-3h1.996A2.004 2.004 0 0 0 23 15.996V7h-4z","fill","white"],[1,"grid","grid-cols-3","text-lg","text-gray-50","mt-4","font-semibold","py-2","border-y-2"],[1,"flex","justify-center","items-center","w-full","h-full"],[4,"ngIf"],["id","print-section-business",1,"col-span-2"],["printSectionId","print-section-business","ngxPrint","",1,"flex","justify-center","align-center","pt-1","h-8","w-8","bg-green-600","rounded-md","hover:bg-green-700",3,"useExistingCss"],["id","print-section-kiosk-business",1,"col-span-2","mt-8"],["printSectionId","print-section-kiosk-business","ngxPrint","",1,"flex","justify-center","align-center","pt-1","h-8","w-8","bg-green-600","rounded-md","hover:bg-green-700",3,"useExistingCss"],[1,"grid","grid-cols-5","text-lg","text-gray-50","mt-4","font-semibold","py-2","border-y-2"],[3,"value"],["class","grid grid-cols-3 text-gray-50 leading-none mt-2 py-2 border-b-2",4,"ngFor","ngForOf"],[1,"grid","grid-cols-3","text-gray-50","leading-none","mt-2","py-2","border-b-2"],["alt","Kiosk Image",1,"size-20",3,"src"],["class","grid grid-cols-3 text-gray-50 leading-none mt-[10px] py-2 border-b-2 h-24",4,"ngFor","ngForOf"],[1,"grid","grid-cols-3","text-gray-50","leading-none","mt-[10px]","py-2","border-b-2","h-24"],["class","grid grid-cols-5 text-gray-50 leading-none mt-[10px] py-2 border-b-2 h-24",4,"ngFor","ngForOf"],[1,"grid","grid-cols-5","text-gray-50","leading-none","mt-[10px]","py-2","border-b-2","h-24"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),M(4,"General Report"),b()(),B(5,"hr"),x(6,"div",4)(7,"div",5)(8,"p",6),M(9,"Total Approved Users"),b(),x(10,"p",7),M(11),b()(),x(12,"div",5)(13,"p",8),M(14,"Total Active Events"),b(),x(15,"p",7),M(16),b()(),x(17,"div",5)(18,"p",8),M(19,"Total Kiosks"),b(),x(20,"p",7),M(21),b()(),x(22,"div",5)(23,"p",8),M(24,"Total Paid Transactions"),b(),x(25,"p",7),M(26),b()()()(),x(27,"div",9)(28,"div",10)(29,"p",3),M(30,"Reports Per Event"),b(),x(31,"div",11)(32,"div",12)(33,"label",13),M(34,"Items: "),b(),x(35,"select",14),nt("ngModelChange",function(s){return it(n.itemsPerPage,s)||(n.itemsPerPage=s),s}),ee(36,M$,2,2,"option",15),b()(),x(37,"select",16),Z("change",function(s){return n.onEventSelect(s)}),x(38,"option",17),M(39),b(),ee(40,T$,2,2,"option",15),b()()(),x(41,"div",18)(42,"div",19)(43,"div",20)(44,"p"),M(45,"List of Kiosk"),b(),x(46,"button",21),te(),x(47,"svg",22),B(48,"path",23),b()()(),ot(),x(49,"div",24)(50,"div",25),M(51,"Kiosk Name"),b(),x(52,"div",25),M(53,"Description"),b(),x(54,"div",25),M(55,"Kiosk Image"),b()(),ee(56,D$,2,1,"div",26),b(),x(57,"div",27)(58,"div",20)(59,"p"),M(60,"List of Approved Business"),b(),x(61,"button",28),te(),x(62,"svg",22),B(63,"path",23),b()()(),ot(),x(64,"div",24)(65,"div",25),M(66,"Company"),b(),x(67,"div",25),M(68,"Owner"),b(),x(69,"div",25),M(70,"Kiosk Name"),b()(),ee(71,R$,2,1,"div",26),b(),x(72,"div",29)(73,"div",20)(74,"p"),M(75,"List of Kiosk Per Business Owner"),b(),x(76,"button",30),te(),x(77,"svg",22),B(78,"path",23),b()()(),ot(),x(79,"div",31)(80,"div",25),M(81,"Date Created"),b(),x(82,"div",25),M(83,"Kiosk Name"),b(),x(84,"div",25),M(85,"Owner"),b(),x(86,"div",25),M(87,"Purpose"),b(),x(88,"div",25),M(89,"Status"),b()(),ee(90,k$,2,1,"div",26),b()()()()),t&2&&(I(11),ge(n.approvedUser),I(5),ge(n.activeEvents),I(5),ge(n.kioskData.length),I(5),ge(n.finishedTransaction),I(9),tt("ngModel",n.itemsPerPage),I(),F("ngForOf",n.pageOptions),I(3),ge(n.getEventName()),I(),F("ngForOf",n.eventData),I(6),F("useExistingCss",!0),I(10),F("ngIf",n.eventReportData.length>0),I(5),F("useExistingCss",!0),I(10),F("ngIf",n.businessData.length>0),I(5),F("useExistingCss",!0),I(14),F("ngIf",n.kioskReportData.length>0))},dependencies:[mn,ba,Aa,ed,An,wn,Mt,pn,Nt,W3,G3],styles:["@media print{body[_ngcontent-%COMP%], *[_ngcontent-%COMP%]{color:#000!important}}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var q3=()=>({"bg-customDarkGreen rounded-md hover:bg-green-500":!0});function N$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function F$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function O$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function B$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function V$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function U$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function H$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function z$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function j$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function G$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function W$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function q$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function Z$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function X$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function Y$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",19)(2,"line",20)(3,"line",21),b())}function Q$(i,e){i&1&&(te(),x(0,"svg",18),B(1,"path",22)(2,"line",23)(3,"line",24),b())}function K$(i,e){i&1&&(x(0,"p"),M(1,"pending"),b())}function J$(i,e){i&1&&(x(0,"p"),M(1,"approved"),b())}function $$(i,e){i&1&&(x(0,"p"),M(1,"denied"),b())}function eee(i,e){if(i&1&&(x(0,"option",34),M(1),b()),i&2){let t=e.$implicit;F("ngClass",Xi(3,q3))("value",t.value),I(),Qt(" ",t.label," ")}}function tee(i,e){if(i&1&&(x(0,"option",34),M(1),b()),i&2){let t=e.$implicit;F("ngClass",Xi(3,q3))("value",t),I(),Qt(" ",t," ")}}function nee(i,e){if(i&1){let t=rt();x(0,"div",25)(1,"div",26),M(2),b(),x(3,"div",27),M(4),b(),x(5,"div",27),M(6),b(),x(7,"div",28),M(8),b(),x(9,"div",27),M(10),b(),x(11,"div",27),M(12),b(),x(13,"div",27)(14,"select",29),Z("change",function(r){let s=he(t).$implicit,o=Y();return fe(o.onStatusChange(r,s.user_info_id,s.Email))}),x(15,"option",30),ee(16,K$,2,0,"p",31)(17,J$,2,0,"p",31)(18,$$,2,0,"p",31),b(),ee(19,eee,2,4,"option",32),b()(),x(20,"div",11)(21,"select",29),Z("change",function(r){let s=he(t).$implicit,o=Y();return fe(o.onUserTypeChange(r,s.user_info_id))}),x(22,"option",33),M(23),b(),ee(24,tee,2,4,"option",32),b()()()}if(i&2){let t=e.$implicit,n=Y();I(2),Qt("",n.formatDate(t.date_registered)," "),I(2),ge(t.First_name),I(2),ge(t.Last_name),I(2),ge(t.Email),I(2),ge(t["Contact#"]),I(2),ge(t.Company_name),I(4),F("ngIf",t.status==0),I(),F("ngIf",t.status==1),I(),F("ngIf",t.status==2),I(),F("ngForOf",n.statusOptions),I(4),Qt(" ",t.User_type," "),I(),F("ngForOf",n.userTypeOptions)}}var lx=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascFName=!1;ascLName=!1;ascCompany=!1;ascEmail=!1;ascContact="";ascStatus=!1;ascUserType=!1;ascDate=!1;ascUsername=!1;referenceNumber=!1;formId="";errorMessage="";contact="Contact#";viewPdf=!1;statusOptions=[{value:0,label:"Pending"},{value:1,label:"Approved"},{value:2,label:"Denied"}];userTypeOptions=["user","admin","EX-Director","IGP"];pdfError=!1;pdfUrl="";selectedOption="";selectedUserType="";onUserTypeChange(e,t){this.selectedUserType=e.target.value,console.log(this.selectedUserType),this.adminService.updateUserType(this.selectedUserType,t).subscribe(n=>{n.success&&window.location.reload()})}onStatusChange(e,t,n){this.selectedOption=e.target.value,console.log(this.selectedOption),this.adminService.updateUserStatus(this.selectedOption,t).subscribe(r=>{if(r.success&&(this.selectedOption=="1"||this.selectedOption=="2")){let s="";this.selectedOption=="1"?s="Approved":s="Denied",cs.send("service_yb4nng9","template_xgi9te4",{from_name:sessionStorage.getItem("firstName")??""+sessionStorage.getItem("lastName")??"",to_email:n,status:s,submission_date:new Date().toLocaleString()},"02COKKG2ReUMrf5Ks").then(o=>{console.log("Email sent successfully!",o.text),window.location.reload()})}})}getUser(){this.adminService.getUsers().subscribe(e=>{this.userData=e})}viewPdfFile(e){let t="dbAssets/userImages/"+e;this.viewPdf=!0,console.log(this.pdfUrl),this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t)}onPdfError(){this.pdfError=!0}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}counterPaid(e){let t=0;for(let n of e)n.status==="paid"&&(t+=1);return t}toLowerCaseSafe(e){return e?e.toLowerCase():""}getUserToDisplay(){let e=this.userData.filter(r=>this.toLowerCaseSafe(r.First_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Last_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.contact+"#").includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Email).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.Company_name).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.status).includes(this.toLowerCaseSafe(this.searchText))||this.toLowerCaseSafe(r.User_type).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}updateStatus(e,t){console.log(e,t)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userData.length&&(console.log(this.userData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}counterFinished(e){let t=0;for(let n of e)n.status==="finished"&&(t+=1);return t}downloadForm(e){this.firstName=sessionStorage.getItem("firstName")??"",this.lastName=sessionStorage.getItem("lastName")??"",this.eventService.downloadForm(e,this.firstName,this.lastName)}ngOnInit(){sessionStorage.getItem("settings")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getUser()}static \u0275fac=function(t){return new(t||i)(ne(rs),ne(et),ne(qn),ne(di),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-user-manage"]],standalone:!0,features:[_t],decls:75,vars:18,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","overflow-hidden"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-md","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","grid-cols-9","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","md:text-md","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"border-r-2","col-span-2","border-green-900","flex","justify-center","items-center"],[1,"block",3,"click"],["class"," grid grid-cols-9 text-xs overflow-hidden bg-customDarkGreen text-xs border-b border-gray-50 border-b-[3px] text-left w-full h-full px-3 md:px-2 py-2  font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-9","text-xs","overflow-hidden","bg-customDarkGreen","text-xs","border-b","border-gray-50","border-b-[3px]","text-left","w-full","h-full","px-3","md:px-2","py-2","font-semibold","text-gray-200"],[1,"flex","justify-center","items-center","text-[10px]","leading-none"],[1,"flex","justify-center","items-center","leading-none"],[1,"flex","justify-center","col-span-2","items-center","leading-none"],["id","dropdown",1,"bg-customDarkGreen","border-none","outline-none",3,"change"],["disabled","","selected","",3,"value"],[4,"ngIf"],["class","bg-customDarkGreen rounded-md",3,"ngClass","value",4,"ngFor","ngForOf"],["selected",""],[1,"bg-customDarkGreen","rounded-md",3,"ngClass","value"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),M(5," User Management:"),b()(),x(6,"div",4),te(),x(7,"svg",5)(8,"g")(9,"g"),B(10,"path",6),b()()(),ot(),x(11,"input",7),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(12,"div",8)(13,"div",9)(14,"button",10),Z("click",function(){return n.onSortChange("date_registered"),n.ascDate=!n.ascDate}),x(15,"div",11),ee(16,N$,4,0,"svg",12)(17,F$,4,0,"svg",12),x(18,"p"),M(19,"Date"),b()()()(),x(20,"div",9)(21,"button",10),Z("click",function(){return n.onSortChange("First_name"),n.ascFName=!n.ascFName}),x(22,"div",11),ee(23,O$,4,0,"svg",12)(24,B$,4,0,"svg",12),x(25,"p"),M(26,"Firstname"),b()()()(),x(27,"div",9)(28,"button",10),Z("click",function(){return n.onSortChange("Last_name"),n.ascLName=!n.ascLName}),x(29,"div",11),ee(30,V$,4,0,"svg",12)(31,U$,4,0,"svg",12),x(32,"p"),M(33,"Lastname"),b()()()(),x(34,"div",13)(35,"button",14),Z("click",function(){return n.onSortChange("Email"),n.ascEmail=!n.ascEmail}),x(36,"div",11),ee(37,H$,4,0,"svg",12)(38,z$,4,0,"svg",12),x(39,"p"),M(40,"Email"),b()()()(),x(41,"div",9)(42,"button",10),Z("click",function(){return n.onSortChange("Contact#"),n.ascStatus=!n.ascStatus}),x(43,"div",11),ee(44,j$,4,0,"svg",12)(45,G$,4,0,"svg",12),x(46,"p"),M(47,"Contact"),b()()()(),x(48,"div",9)(49,"button",10),Z("click",function(){return n.onSortChange("Company_name"),n.ascCompany=!n.ascCompany}),x(50,"div",11),ee(51,W$,4,0,"svg",12)(52,q$,4,0,"svg",12),x(53,"p"),M(54,"Company"),b()()()(),x(55,"div",9)(56,"button",10),Z("click",function(){return n.onSortChange("Status"),n.ascStatus=!n.ascStatus}),x(57,"div",11),ee(58,Z$,4,0,"svg",12)(59,X$,4,0,"svg",12),x(60,"p"),M(61,"Status"),b()()()(),x(62,"div",11)(63,"button",10),Z("click",function(){return n.onSortChange("User_type"),n.ascUserType=!n.ascUserType}),x(64,"div",11),ee(65,Y$,4,0,"svg",12)(66,Q$,4,0,"svg",12),x(67,"p"),M(68,"User type"),b()()()()(),ee(69,nee,25,12,"div",15),x(70,"div",16)(71,"button",17),Z("click",function(){return n.prevTransaction()}),M(72," Prev "),b(),x(73,"button",17),Z("click",function(){return n.nextTransaction()}),M(74," Next "),b()()()()),t&2&&(I(11),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascDate),I(),F("ngIf",!n.ascDate),I(6),F("ngIf",n.ascFName),I(),F("ngIf",!n.ascFName),I(6),F("ngIf",n.ascLName),I(),F("ngIf",!n.ascLName),I(6),F("ngIf",n.ascEmail),I(),F("ngIf",!n.ascEmail),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(6),F("ngIf",n.ascCompany),I(),F("ngIf",!n.ascCompany),I(6),F("ngIf",n.ascStatus),I(),F("ngIf",!n.ascStatus),I(6),F("ngIf",n.ascUserType),I(),F("ngIf",!n.ascUserType),I(3),F("ngForOf",n.getUserToDisplay()))},dependencies:[mn,ba,Aa,bn,An,wn,Mt,Ns,pn,Nt,Wr,qr],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};function iee(i,e){i&1&&(te(),x(0,"svg",17),B(1,"path",18)(2,"line",19)(3,"line",20),b())}function ree(i,e){i&1&&(te(),x(0,"svg",17),B(1,"path",21)(2,"line",22)(3,"line",23),b())}function see(i,e){i&1&&(te(),x(0,"svg",17),B(1,"path",18)(2,"line",19)(3,"line",20),b())}function oee(i,e){i&1&&(te(),x(0,"svg",17),B(1,"path",21)(2,"line",22)(3,"line",23),b())}function aee(i,e){if(i&1){let t=rt();x(0,"div",24)(1,"div",25),M(2),b(),x(3,"div",26),M(4),b(),x(5,"div",11)(6,"label",27)(7,"input",28),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_events,r)||(s.access_permissions_events=r),fe(r)}),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"events",r.access_permissions_events))}),b(),x(8,"span",29),te(),x(9,"svg",30),B(10,"path",31),b()()()(),ot(),x(11,"div",11)(12,"label",27)(13,"input",32),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"transactions",r.access_permissions_transactions))}),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_transactions,r)||(s.access_permissions_transactions=r),fe(r)}),b(),x(14,"span",29),te(),x(15,"svg",30),B(16,"path",31),b()()()(),ot(),x(17,"div",11)(18,"label",27)(19,"input",32),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"reports",r.access_permissions_reports))}),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_reports,r)||(s.access_permissions_reports=r),fe(r)}),b(),x(20,"span",29),te(),x(21,"svg",30),B(22,"path",31),b()()()(),ot(),x(23,"div",11)(24,"label",27)(25,"input",32),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"user_settings",r.access_permissions_user_settings))}),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_user_settings,r)||(s.access_permissions_user_settings=r),fe(r)}),b(),x(26,"span",29),te(),x(27,"svg",30),B(28,"path",31),b()()()(),ot(),x(29,"div",11)(30,"label",27)(31,"input",32),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"access_control",r.access_permissions_access_control))}),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_access_control,r)||(s.access_permissions_access_control=r),fe(r)}),b(),x(32,"span",29),te(),x(33,"svg",30),B(34,"path",31),b()()()(),ot(),x(35,"div",11)(36,"label",27)(37,"input",32),Z("change",function(){let r=he(t).$implicit,s=Y();return fe(s.onPermissionChange(r.user_info_id,"history",r.access_permissions_history))}),nt("ngModelChange",function(r){let s=he(t).$implicit;return it(s.access_permissions_history,r)||(s.access_permissions_history=r),fe(r)}),b(),x(38,"span",29),te(),x(39,"svg",30),B(40,"path",31),b()()()()()}if(i&2){let t=e.$implicit;I(2),ge(t.First_name+" "+t.Last_name),I(2),ge(t.User_type),I(3),tt("ngModel",t.access_permissions_events),I(6),tt("ngModel",t.access_permissions_transactions),I(6),tt("ngModel",t.access_permissions_reports),I(6),tt("ngModel",t.access_permissions_user_settings),I(6),tt("ngModel",t.access_permissions_access_control),I(6),tt("ngModel",t.access_permissions_history)}}var cx=class i{constructor(e,t,n,r,s){this.sanitizer=e;this.router=t;this.userService=n;this.eventService=r;this.adminService=s}userData=[];token="";firstName="";lastName="";searchText="";pageIndex=0;pageSize=10;sortField="date_req";sortDirection="asc";ascDate=!1;ascType=!1;getUser(){this.adminService.getUsers().subscribe(e=>{this.userData=e.filter(t=>t.User_type!=="user")})}onSearchChange(e){console.log("im changing"),this.searchText=e,this.pageIndex=0}onPermissionChange(e,t,n){console.log(n),this.adminService.userControl(e,t,n).subscribe({next:r=>{console.log(r)}})}toLowerCaseSafe(e){return e?e.toLowerCase():""}getUserToDisplay(){let e=this.userData.filter(r=>this.toLowerCaseSafe(r.First_name).includes(this.toLowerCaseSafe(this.searchText)));e=this.sortTransactions(e);let t=this.pageIndex*this.pageSize,n=t+this.pageSize;return e.slice(t,n)}sortTransactions(e){return e.sort((t,n)=>this.sortDirection==="asc"?t[this.sortField]>n[this.sortField]?1:-1:t[this.sortField]<n[this.sortField]?1:-1)}onSortChange(e){this.sortField===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=e,this.sortDirection="asc")}nextTransaction(){this.pageIndex<this.userData.length&&(console.log(this.userData.length/10),console.log(this.pageIndex),this.pageIndex++)}prevTransaction(){this.pageIndex>0&&this.pageIndex--}isAscending(){return this.sortDirection==="asc"}resetPage(){this.pageIndex=0}ngOnInit(){sessionStorage.getItem("control")!="1"&&this.router.navigate(["/dashboard-admin"]),this.getUser()}static \u0275fac=function(t){return new(t||i)(ne(rs),ne(et),ne(qn),ne(di),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-user-control"]],standalone:!0,features:[_t],decls:45,vars:6,consts:[[1,"w-full","justify-center","align-center","h-full","min-h-screen","md:px-2","text-black"],[1,"block"],[1,"grid","grid-cols-3","justify-between","pt-8","pb-5","overflow-hidden"],[1,"text-gray-700","text-md","md:text-2xl","font-bold","col-span-1","flex","items-center"],[1,"col-span-2","flex","items-center","h-10","rounded-lg","border-gray-700","border-2","p-2"],["fill","#000000","height","28px","width","28px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 488.4 488.4",0,"xml","space","preserve",1,"pr-2"],["d",`M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6
			s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2
			S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7
			S381.9,104.65,381.9,203.25z`],["type","text","placeholder","Search",1,"w-full","text-gray-700","text-md","focus:outline-none",3,"ngModelChange","ngModel"],[1,"shadow-gray-500","border-4","border-green-900","shadow-sm","grid","grid-cols-8","bg-customDarkGreen","text-center","w-full","h-full","px-3","md:px-2","py-2","text-[10px]","md:text-[14px]","leading-none","font-semibold","text-gray-50"],[1,"border-r-2","border-green-900","flex","justify-center","py-4","items-center"],[1,"",3,"click"],[1,"flex","justify-center","items-center"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],[1,"border-r-2","border-green-900","flex","justify-center","items-center"],["class"," grid grid-cols-8  overflow-hidden bg-customDarkGreen text-md border-gray-50 border-b-[3px] text-left w-full h-full px-3 md:px-2 py-2  font-semibold text-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-1","justify-between"],[1,"bg-green-700","text-white","py-2","px-4","rounded-md","hover:bg-green-800","hover:shadow-md","hover:shadow-gray-400",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 20L6 14H18L12 20Z","fill","currentColor"],["x1","6","y1","10","x2","18","y2","10"],["x1","8","y1","6","x2","16","y2","6"],["d","M12 4L6 10H18L12 4Z","fill","currentColor"],["x1","6","y1","14","x2","18","y2","14"],["x1","8","y1","18","x2","16","y2","18"],[1,"grid","grid-cols-8","overflow-hidden","bg-customDarkGreen","text-md","border-gray-50","border-b-[3px]","text-left","w-full","h-full","px-3","md:px-2","py-2","font-semibold","text-gray-200"],[1,"flex","justify-center","text-center","items-center","leading-none"],[1,"flex","justify-center","items-center","leading-none"],[1,"flex","items-center","cursor-pointer","relative"],["type","checkbox",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-slate-300","checked:bg-green-600","checked:border-green-600",3,"ngModelChange","change","ngModel"],[1,"absolute","text-white","opacity-0","peer-checked:opacity-100","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","stroke","currentColor","stroke-width","1",1,"h-3.5","w-3.5"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["type","checkbox",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","shadow","hover:shadow-md","border","border-slate-300","checked:bg-green-600","checked:border-green-600",3,"change","ngModelChange","ngModel"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),M(5," User Control:"),b()(),x(6,"div",4),te(),x(7,"svg",5)(8,"g")(9,"g"),B(10,"path",6),b()()(),ot(),x(11,"input",7),nt("ngModelChange",function(s){return it(n.searchText,s)||(n.searchText=s),s}),Z("ngModelChange",function(s){return n.onSearchChange(s)}),b()()(),x(12,"div",8)(13,"div",9)(14,"button",10),Z("click",function(){return n.onSortChange("Firs_name"),n.ascDate=!n.ascDate}),x(15,"div",11),ee(16,iee,4,0,"svg",12)(17,ree,4,0,"svg",12),x(18,"p"),M(19,"Name"),b()()()(),x(20,"div",9)(21,"button",10),Z("click",function(){return n.onSortChange("User_type"),n.ascType=!n.ascType}),x(22,"div",11),ee(23,see,4,0,"svg",12)(24,oee,4,0,"svg",12),x(25,"p"),M(26,"User Type"),b()()()(),x(27,"div",13),M(28,"Access Events"),b(),x(29,"div",13),M(30,"Access Transactions"),b(),x(31,"div",13),M(32,"Access Reports"),b(),x(33,"div",13),M(34,"Access History"),b(),x(35,"div",13),M(36,"Access Users"),b(),x(37,"div",11),M(38,"Access Control"),b()(),ee(39,aee,41,8,"div",14),x(40,"div",15)(41,"button",16),Z("click",function(){return n.prevTransaction()}),M(42," Prev "),b(),x(43,"button",16),Z("click",function(){return n.nextTransaction()}),M(44," Next "),b()()()()),t&2&&(I(11),tt("ngModel",n.searchText),I(5),F("ngIf",n.ascDate),I(),F("ngIf",!n.ascDate),I(6),F("ngIf",n.ascType),I(),F("ngIf",!n.ascType),I(15),F("ngForOf",n.getUserToDisplay()))},dependencies:[mn,bn,mA,An,wn,Mt,pn,Nt,Wr,qr],styles:["label[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:16px}.checked-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#4caf50;border-color:#4caf50}input[type=checkbox][_ngcontent-%COMP%]:checked{border-color:#4caf50}.checked-checkbox[_ngcontent-%COMP%]{color:#4caf50}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var NC=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"transaction",component:V0,canActivate:[vh]},{path:"map-viewer",component:O0,canActivate:[U0]},{path:"login",component:dg,canActivate:[xh]},{path:"register",component:mg,canActivate:[xh]},{path:"dashboard",component:eg,canActivate:[vh]},{path:"dashboard-admin",component:j0,canActivate:[zr]},{path:"transaction-admin",component:nx,canActivate:[zr]},{path:"application-form",component:B0,canActivate:[H0]},{path:"manage-events",component:ix,canActivate:[zr]},{path:"add-events",component:rx,canActivate:[zr]},{path:"history",component:ox,canActivate:[zr]},{path:"reports",component:ax,canActivate:[zr]},{path:"manage-user",component:lx,canActivate:[zr]},{path:"user-control",component:cx,canActivate:[zr]},{path:"map-viewer-admin",component:sx,canActivate:[zr]},{path:"**",redirectTo:"/login",pathMatch:"full"}],Z3=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=gi({type:i});static \u0275inj=mi({imports:[ih.forRoot(NC,{useHash:!1}),ih]})};var lee=["sidebar"],cee=["button"],dee=["notifer"],uee=["notifyButton"],hee=["dropper"],fee=["drop"],pee=(i,e)=>({"animate-slide-in-right":i,"animate-slide-in-left":e}),X3=()=>({exact:!0});function mee(i,e){if(i&1&&(x(0,"span"),M(1),b()),i&2){let t=Y(3);I(),ge(t.getUnreadCount())}}function gee(i,e){i&1&&B(0,"img",31)}function vee(i,e){i&1&&(x(0,"span"),M(1,"..."),b())}function xee(i,e){i&1&&(te(),x(0,"svg",32),B(1,"path",33),b())}function wee(i,e){i&1&&(te(),x(0,"svg",32),B(1,"path",34),b())}function yee(i,e){if(i&1){let t=rt();x(0,"div",14)(1,"div",15)(2,"button",16,0),Z("click",function(){he(t);let r=Y(2);return fe(r.toggleSide())}),te(),x(4,"svg",17),B(5,"path",18),b()(),ot(),x(6,"img",19),Z("click",function(){he(t);let r=Y(2);return fe(r.refreshPage())}),b(),x(7,"h1",20),M(8,"Chmsu-A mAPP"),b()(),x(9,"div",21)(10,"button",22,1),Z("click",function(){he(t);let r=Y(2);return fe(r.toggleNotificationBar())}),te(),x(12,"svg",23),B(13,"path",24),b(),ot(),x(14,"p",25),ee(15,mee,2,1,"span",26),b()(),x(16,"div",27)(17,"div"),ee(18,gee,1,0,"img",28),b(),x(19,"button",29,2),Z("click",function(){he(t);let r=Y(2);return fe(r.toggleSettings())}),M(21),ml(22,"slice"),ee(23,vee,2,0,"span",26),x(24,"span"),ee(25,xee,2,0,"svg",30)(26,wee,2,0,"svg",30),b()()()()()}if(i&2){let t=e.$implicit,n=Y(2);I(15),F("ngIf",n.notification),I(3),F("ngIf",!t.profile_image),I(3),Qt(" ",Dc(22,6,t.First_name,0,6),""),I(2),F("ngIf",t.First_name.length>6),I(2),F("ngIf",n.isDropped),I(),F("ngIf",!n.isDropped)}}function bee(i,e){i&1&&B(0,"img",58)}function Aee(i,e){if(i&1){let t=rt();x(0,"div",37)(1,"div",38),ee(2,bee,1,0,"img",39),b(),x(3,"div",40),M(4),b(),B(5,"hr",41),x(6,"a",42)(7,"span",43),te(),x(8,"svg",44),B(9,"path",45)(10,"path",46),b()(),M(11," Dashboard "),b(),ot(),x(12,"a",47)(13,"span",43),te(),x(14,"svg",48),B(15,"path",49),b()(),M(16," Transaction "),b(),ot(),x(17,"a",50)(18,"span",43),te(),x(19,"svg",51)(20,"g",52)(21,"g",53)(22,"g",54),B(23,"path",55),b()()()()(),M(24,"Profile"),b(),ot(),x(25,"a",56)(26,"span",43),te(),x(27,"svg",51)(28,"g",52)(29,"g",53)(30,"g",54),B(31,"path",55),b()()()()(),M(32,"Notification"),b(),ot(),x(33,"a",57),Z("click",function(){he(t);let r=Y(3);return fe(r.logout())}),x(34,"span",43),te(),x(35,"svg",23),B(36,"path",24),b()(),M(37,"logout"),b()()}if(i&2){let t=e.$implicit;I(2),F("ngIf",!t.profile_image),I(2),ge(t.Username),I(2),F("routerLinkActiveOptions",Xi(3,X3))}}function _ee(i,e){if(i&1&&(x(0,"div",35,3),ee(2,Aee,38,4,"div",36),b()),i&2){let t=Y(2);F("ngClass",JI(2,pee,t.toggleSidebar,!t.toggleSidebar)),I(2),F("ngForOf",t.userData)}}function See(i,e){i&1&&(x(0,"div",67)(1,"div",68),M(2,"No new notifications"),b()())}function Eee(i,e){if(i&1){let t=rt();x(0,"button",75),Z("click",function(){he(t);let r=Y(2).$implicit,s=Y(3);return s.readMessage(r.notification_id,"read"),fe(s.refreshPage())}),M(1,"Read"),b()}}function Cee(i,e){if(i&1&&(x(0,"div",71)(1,"div",72),M(2),b(),x(3,"div",73)(4,"p"),M(5),b(),ee(6,Eee,2,0,"button",74),b()()),i&2){let t=Y().$implicit,n=Y(3);I(2),ge(t.message),I(3),ge(n.formatDate(t.date_created)),I(),F("ngIf",t.status=="unread")}}function Mee(i,e){if(i&1&&(x(0,"div")(1,"div",69),ee(2,Cee,7,3,"div",70),b()()),i&2){let t=e.$implicit;I(2),F("ngIf",t.status=="unread")}}function Tee(i,e){if(i&1&&(x(0,"div",67)(1,"div",76),M(2),b(),x(3,"div",77),M(4),b()()),i&2){let t=Y().$implicit,n=Y(3);I(2),ge(t.message),I(2),ge(n.formatDate(t.date_created))}}function Iee(i,e){if(i&1&&(x(0,"div"),ee(1,Tee,5,2,"div",65),b()),i&2){let t=e.$implicit;I(),F("ngIf",t.status=="read")}}function Dee(i,e){if(i&1&&(x(0,"div",59,4)(2,"div",60),B(3,"div",61),x(4,"div",62)(5,"div",63)(6,"div",64),M(7,"Unread Messages:"),b(),B(8,"hr"),ee(9,See,3,0,"div",65)(10,Mee,3,1,"div",66),x(11,"div",64),M(12,"Read Messages:"),b(),B(13,"hr"),ee(14,Iee,2,1,"div",66),b()()()()),i&2){let t=Y(2);I(9),F("ngIf",!t.hasUnreadMessages()),I(),F("ngForOf",t.notification),I(4),F("ngForOf",t.notification)}}function Pee(i,e){if(i&1){let t=rt();x(0,"div",80),B(1,"div",81),x(2,"div",82)(3,"div",37)(4,"div",83),M(5),b(),x(6,"div",84),M(7),b(),B(8,"hr"),x(9,"a",85)(10,"span",43),te(),x(11,"svg",44),B(12,"path",45)(13,"path",46),b()(),M(14," Dashboard "),b(),ot(),x(15,"a",47)(16,"span",43),te(),x(17,"svg",48),B(18,"path",49),b()(),M(19," Transaction "),b(),ot(),x(20,"a",50)(21,"span",43),te(),x(22,"svg",51)(23,"g",52)(24,"g",53)(25,"g",54),B(26,"path",55),b()()()()(),M(27," Profile "),b(),ot(),x(28,"a",86),Z("click",function(){he(t);let r=Y(3);return fe(r.logout())}),x(29,"span",43),te(),x(30,"svg",87),B(31,"path",88)(32,"path",89)(33,"path",90),b()(),M(34," logout "),b()()()()}if(i&2){let t=e.$implicit;I(5),ge(t.First_name+" "+t.Last_name),I(2),ge(t.Username),I(2),F("routerLinkActiveOptions",Xi(3,X3))}}function Ree(i,e){if(i&1&&(x(0,"div",78,5),ee(2,Pee,35,4,"div",79),b()),i&2){let t=Y(2);I(2),F("ngForOf",t.userData)}}function Lee(i,e){i&1&&(x(0,"div",91),B(1,"div",92),x(2,"p",93),M(3,"loading..."),b()())}function kee(i,e){if(i&1&&(x(0,"div",7),ee(1,yee,27,10,"div",8)(2,_ee,3,5,"div",9),x(3,"div",10),ee(4,Dee,15,3,"div",11)(5,Ree,3,1,"div",12),b(),ee(6,Lee,4,0,"div",13),b()),i&2){let t=Y();I(),F("ngForOf",t.userData),I(),F("ngIf",t.toggleSidebar),I(2),F("ngIf",t.toggleNotification),I(),F("ngIf",t.isDropped),I(),F("ngIf",t.loading)}}var dx=class i{constructor(e,t,n){this.router=e;this.renderer=t;this.userService=n}notification=[];showNotification=!1;loading=!1;toggleSidebar=!1;toggleNotification=!1;userData=[];userType="";sidebar;button;notifer;notifyButton;dropper;drop;open=!1;isDropped=!1;ngAfterViewInit(){this.renderer.listen("document","click",e=>this.onClickOutside(e))}sortNotifications(e){return e.sort((t,n)=>t.status==="read"&&n.status!=="read"?-1:t.status!=="read"&&n.status==="read"?1:0)}getUnreadCount(){return this.notification.reduce((e,t)=>t.status==="unread"?e+1:e,0)}refreshPage(){window.location.reload()}hasUnreadMessages(){return this.notification.some(e=>e.status==="unread")}isLastUnread(){return this.notification.map((t,n)=>t.status==="unread"?n:-1).filter(t=>t!==-1).pop()===this.notification.length-1}toggleSettings(){this.isDropped=!this.isDropped}readMessage(e,t){this.userService.updateMessage(e,t).subscribe(n=>{})}logout(){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("tokenId",""),this.router.navigate(["/login"]).then(()=>{window.location.reload()})},200)}toggleSide(){this.toggleSidebar=!this.toggleSidebar}toggleNotificationBar(){this.toggleNotification=!this.toggleNotification}onClickOutside(e){this.sidebar&&!this.sidebar.nativeElement.contains(e.target)&&!this.button.nativeElement.contains(e.target)&&this.toggleSidebar==!0?this.toggleSidebar=!1:e.stopPropagation(),this.notifer&&!this.notifer.nativeElement.contains(e.target)&&!this.notifyButton.nativeElement.contains(e.target)&&this.toggleNotification==!0?this.toggleNotification=!1:e.stopPropagation(),this.dropper&&!this.dropper.nativeElement.contains(e.target)&&!this.drop.nativeElement.contains(e.target)&&this.isDropped==!0?this.isDropped=!1:e.stopPropagation()}token="";fetchUser(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getUser(this.token).subscribe(e=>{this.userData=e,console.log(this.token)})}formatDate(e){let t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}ngOnInit(){sessionStorage.getItem("userType")=="admin"&&this.router.navigate(["/dashboard-admin"]),this.fetchUser(),this.getNotification(),this.userType=sessionStorage.getItem("userType")??""}ngDoCheck(){setTimeout(()=>{this.getNotification()},6e4)}getNotification(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getNotification(this.token).subscribe(e=>{this.notification=this.sortNotifications(e)})}static \u0275fac=function(t){return new(t||i)(ne(et),ne(Fi),ne(qn))};static \u0275cmp=vt({type:i,selectors:[["app-navbar"]],viewQuery:function(t,n){if(t&1&&(ai(lee,5),ai(cee,5),ai(dee,5),ai(uee,5),ai(hee,5),ai(fee,5)),t&2){let r;zn(r=jn())&&(n.sidebar=r.first),zn(r=jn())&&(n.button=r.first),zn(r=jn())&&(n.notifer=r.first),zn(r=jn())&&(n.notifyButton=r.first),zn(r=jn())&&(n.dropper=r.first),zn(r=jn())&&(n.drop=r.first)}},standalone:!0,features:[_t],decls:1,vars:1,consts:[["button",""],["notifyButton",""],["drop",""],["sidebar",""],["notifer",""],["dropper",""],["class","fixed w-full z-[100]",4,"ngIf"],[1,"fixed","w-full","z-[100]"],["class","flex max-full z-100 items-center justify-between bg-customDarkGreen px-6 py-4",4,"ngFor","ngForOf"],["class","md:hidden flex top-[0] relative min-h-screen max-w-[250px] bg-dropDown shadow-r-xl shadow-black p-2 z-[0]",3,"ngClass",4,"ngIf"],[1,"max-w-screen-xl","h-full","z-[1000]"],["class","grid animate-swipeDown absolute justify-self-end items-center right-0 min-h-[200px] max-w-[350px] shadow-r-md shadow-black p-2",4,"ngIf"],["class","hidden md:grid animate-swipeDown absolute justify-self-end items-center right-0 min-h-[200px] max-w-[350px] shadow-r-md shadow-black p-2",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-50 h-full w-full z-[100]",4,"ngIf"],[1,"flex","max-full","z-100","items-center","justify-between","bg-customDarkGreen","px-6","py-4"],[1,"flex","space-x-4","justify-self-center","items-center"],[1,"md:hidden","text-white","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png",1,"cursor-pointer","size-12",3,"click"],[1,"text-xl","font-bold","text-white","text-3xl","text-center"],[1,"flex","items-center","space-x-4"],[1,"text-white","rounded-md","text-sm","flex","items-center","justify-between","w-auto","pr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 48 48","fill","white"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],[1,"relative","size-5","bg-red-700","rounded-full","text-center","top-[-10px]","left-[-15px]"],[4,"ngIf"],[1,"md:flex","hidden","justify-center","items-center"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/defaultProfile.png","class","size-10 bg-black rounded-full ",4,"ngIf"],[1,"hidden","md:flex","text-gray-800","pl-2","text-white","text-xl","font-bold","justify-center","text-gray-200","hover:text-white","align-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","class","h-6 w-6  relative","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",4,"ngIf"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/defaultProfile.png",1,"size-10","bg-black","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-6","w-6","relative"],["d","M5 12h10L10 6z"],["d","M5 8h10l-5 6z"],[1,"md:hidden","flex","top-[0]","relative","min-h-screen","max-w-[250px]","bg-dropDown","shadow-r-xl","shadow-black","p-2","z-[0]",3,"ngClass"],["class","grid-cols-1 grid w-full h-full pl-2 span-8",4,"ngFor","ngForOf"],[1,"grid-cols-1","grid","w-full","h-full","pl-2","span-8"],[1,"flex","justify-center","align-center","pt-4","w-full"],["src","assets/images/defaultProfile.png","class","size-24 bg-black rounded-full border-2 border-white",4,"ngIf"],[1,"block","text-gray-800","text-lg","text-center","text-white","pb-1"],[1,"pt-4"],["routerLink"," /dashboard","routerLinkActive","active",1,"buttonSideBar",3,"routerLinkActiveOptions"],[1,"pr-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M3 3h18v18H3z"],["d","M3 9h18M9 3v18"],["routerLink","/transaction","routerLinkActive","active",1,"buttonSideBar"],["fill","white","width","26","height","26","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],["routerLink","/profile","routerLinkActive","active",1,"hidden"],["width","24","height","24","viewBox","0 0 20 20","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","Dribbble-Light-Preview","transform","translate(-420.000000, -2159.000000)","fill","white"],["id","icons","transform","translate(56.000000, 160.000000)"],["d","M374,2009 C371.794,2009 370,2007.206 370,2005 C370,2002.794 371.794,2001 374,2001 C376.206,2001 378,2002.794 378,2005 C378,2007.206 376.206,2009 374,2009 M377.758,2009.673 C379.124,2008.574 380,2006.89 380,2005 C380,2001.686 377.314,1999 374,1999 C370.686,1999 368,2001.686 368,2005 C368,2006.89 368.876,2008.574 370.242,2009.673 C366.583,2011.048 364,2014.445 364,2019 L366,2019 C366,2014 369.589,2011 374,2011 C378.411,2011 382,2014 382,2019 L384,2019 C384,2014.445 381.417,2011.048 377.758,2009.673","id","profile-[#1335]"],["routerLink","/notification","routerLinkActive","active",1,"buttonSideBar"],["routerLinkActive","active",1,"buttonSideBar","text-white",3,"click"],["src","assets/images/defaultProfile.png",1,"size-24","bg-black","rounded-full","border-2","border-white"],[1,"grid","animate-swipeDown","absolute","justify-self-end","items-center","right-0","min-h-[200px]","max-w-[350px]","shadow-r-md","shadow-black","p-2"],[1,"relative","max-w-sm","w-full","bg-dropDown","shadow-xl","rounded-lg","p-4"],[1,"relative","-top-8","-right-36","md:-right-5","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-dropDown"],[1,"h-96","w-56","pb-2","grid","overflow-hidden"],[1,"overflow-scrollable","h-[calc(100%-2rem)]","overflow-y-auto","px-2"],[1,"text-white","text-md","font-bold"],["class","block text-sm justify-self-start align-start py-2",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"block","text-sm","justify-self-start","align-start","py-2"],[1,"text-md","text-white","text-center"],[1,"text-gray-500","text-sm","mb-4","text-center"],["class"," py-2",4,"ngIf"],[1,"py-2"],[1,"text-md","text-white","text-left","leading-none"],[1,"text-[10px]","pt-1","text-right","text-white","flex","justify-between","align-center"],["class","text-gray-300 hover:text-gray-50 underline",3,"click",4,"ngIf"],[1,"text-gray-300","hover:text-gray-50","underline",3,"click"],[1,"text-md","text-white"],[1,"text-[10px]","pt-1","text-white","text-left"],[1,"hidden","md:grid","animate-swipeDown","absolute","justify-self-end","items-center","right-0","min-h-[200px]","max-w-[350px]","shadow-r-md","shadow-black","p-2"],["class","relative max-w-sm w-full h-full bg-dropDown shadow-md rounded-lg p-4",4,"ngFor","ngForOf"],[1,"relative","max-w-sm","w-full","h-full","bg-dropDown","shadow-md","rounded-lg","p-4"],[1,"relative","-top-8","-right-36","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-b-dropDown"],[1,"h-80","w-52","px-4"],[1,"text-center","text-lg","text-white"],[1,"text-center","text-sm","text-gray-200"],["routerLink","/dashboard","routerLinkActive","active",1,"buttonSideBar",3,"routerLinkActiveOptions"],["routerLinkActive","active",1,"buttonSideBar",3,"click"],["width","29","height","29","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M21 12L13 12","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M18 15L20.913 12.087V12.087C20.961 12.039 20.961 11.961 20.913 11.913V11.913L18 9","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M16 5V4.5V4.5C16 3.67157 15.3284 3 14.5 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H14.5C15.3284 21 16 20.3284 16 19.5V19.5V19","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-50","h-full","w-full","z-[100]"],[1,"animate-spin","rounded-full","size-20","border-t-4","border-black"],[1,"relative","left-[-65px]","font-bold","text-xs"]],template:function(t,n){t&1&&ee(0,kee,7,5,"div",6),t&2&&F("ngIf",n.userType=="user")},dependencies:[Mt,Ns,pn,Nt,Lc,Wc,ih,Km],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.buttonSideBar[_ngcontent-%COMP%]{display:flex;height:3rem;width:100%;align-items:center;justify-content:flex-start;padding:.5rem;font-size:1.125rem;line-height:1.75rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.buttonSideBar[_ngcontent-%COMP%]:hover{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(27 67 50 / var(--tw-bg-opacity));--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}.truncate[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"]})};var ux=class i{static \u0275fac=function(t){return new(t||i)};static \u0275cmp=vt({type:i,selectors:[["app-footer"]],standalone:!0,features:[_t],decls:3,vars:0,consts:[[1,"w-screen-xl","text-center","bg-gray-50","text-black","text-sm","pt-8"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"p"),M(2,"Copyright \xA92024 All rights reserved"),b()())}})};var Nee=()=>({exact:!0}),Fee=i=>({"rotate-180":i});function Oee(i,e){i&1&&(x(0,"a",27)(1,"span",7),te(),x(2,"svg",28),B(3,"path",29),b()(),M(4," Transaction "),b())}function Bee(i,e){i&1&&(x(0,"div",36)(1,"a",37),M(2," Create Events "),b(),x(3,"a",38),M(4," Manage Events "),b()())}function Vee(i,e){if(i&1){let t=rt();x(0,"div",30)(1,"a",31),Z("click",function(){he(t);let r=Y();return fe(r.toggleDropdown())}),x(2,"span",7),B(3,"img",32),b(),M(4," Events "),te(),x(5,"svg",33),B(6,"path",34),b()(),ee(7,Bee,5,0,"div",35),b()}if(i&2){let t=Y();I(5),F("ngClass",mm(2,Fee,t.isDropdownOpen)),I(2),F("ngIf",t.isDropdownOpen)}}function Uee(i,e){i&1&&(x(0,"a",39)(1,"span",7),te(),x(2,"svg",40),B(3,"path",41)(4,"path",42),b()(),M(5,"Users"),b())}function Hee(i,e){i&1&&(x(0,"a",43)(1,"span",7),te(),x(2,"svg",44)(3,"title"),M(4,"report"),b(),B(5,"path",45),b()(),M(6,"Reports"),b())}function zee(i,e){i&1&&(x(0,"a",46)(1,"span",7),te(),x(2,"svg",47),B(3,"path",48)(4,"path",49),b()(),M(5,"History"),b())}function jee(i,e){i&1&&(x(0,"a",50)(1,"span",7),te(),x(2,"svg",51)(3,"g",52)(4,"g",53),B(5,"path",54),b()()()(),M(6,"User Control"),b())}var hx=class i{constructor(e,t){this.router=e;this.adminService=t}loading=!1;toggleSidebar=!1;events="";transactions="";reports="";settings="";control="";history="";isDropdownOpen=!1;toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}refreshPage(){window.location.reload()}logout(){this.loading=!0,setTimeout(()=>{this.loading=!1,sessionStorage.setItem("tokenId",""),this.router.navigate(["/login"]).then(()=>{window.location.reload()})},200)}dynamicControl(){let e=sessionStorage.getItem("tokenId")??"";this.adminService.dynamicController(e).subscribe({next:t=>{console.log("check");let n=t.events,r=t.transactions,s=t.reports,o=t.settings,a=t.control,l=t.history;sessionStorage.setItem("events",n),sessionStorage.setItem("transactions",r),sessionStorage.setItem("reports",s),sessionStorage.setItem("settings",o),sessionStorage.setItem("control",a),sessionStorage.setItem("history",l),this.events=sessionStorage.getItem("events")??"",this.transactions=sessionStorage.getItem("transactions")??"",this.reports=sessionStorage.getItem("reports")??"",this.settings=sessionStorage.getItem("settings")??"",this.control=sessionStorage.getItem("control")??"",this.history=sessionStorage.getItem("history")??""}})}ngDoCheck(){setInterval(()=>{this.dynamicControl()},12e4)}ngOnInit(){this.dynamicControl()}static \u0275fac=function(t){return new(t||i)(ne(et),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-admin-navbar"]],standalone:!0,features:[_t],decls:37,vars:8,consts:[[1,"w-full","h-full","px-2","span-8","pt-4"],[1,"flex","justify-center","items-center","flex-col","h-32","w-full","mb-4"],["src","https://mapp-thesis.infotech3c.com/public/assets/images/chmsu_logo.png","alt","Logo",1,"size-24","mb-2","cursor-pointer",3,"click"],[1,"text-center","text-2xl","font-bold"],[1,"text-gray-50"],[1,"mb-2"],["routerLinkActive","active","routerLink","/dashboard-admin",1,"buttonSideBar",3,"routerLinkActiveOptions"],[1,"pr-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M3 3h18v18H3z"],["d","M3 9h18M9 3v18"],["routerLink","/transaction-admin","routerLinkActive","active","class","buttonSideBar ",4,"ngIf"],["class","relative group",4,"ngIf"],["routerLink","/map-viewer-admin","routerLinkActive","active",1,"buttonSideBar"],["height","24px","width","24px","version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 512 512",0,"xml","space","preserve"],["points","154.64,420.096 154.64,59.496 0,134 0,512 ",2,"fill","white"],["points","309.288,146.464 309.288,504.472 154.64,420.096 154.64,59.496 ",2,"fill","white"],["points","463.928,50.152 309.288,146.464 309.288,504.472 463.928,415.68 ",2,"fill","white"],["d",`M414.512,281.656l-11.92-15.744c-8.8-11.472-85.6-113.984-85.6-165.048
                C317.032,39.592,355.272,0,414.512,0S512,39.592,512,100.864c0,50.992-76.8,153.504-85.488,165.048L414.512,281.656z`,2,"fill","black"],["cx","414.512","cy","101.536","r","31.568",2,"fill","white"],["routerLink","/manage-user","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/reports","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/history","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLink","/user-control","routerLinkActive","active","class","buttonSideBar",4,"ngIf"],["routerLinkActive","active",1,"buttonSideBar","text-white",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","25px","height","25px","viewBox","0 0 48 48","fill","white"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],["routerLink","/transaction-admin","routerLinkActive","active",1,"buttonSideBar"],["fill","white","width","26","height","26","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M2,7V21a1,1,0,0,0,1,1H13V6H3A1,1,0,0,0,2,7ZM5,9h5v2H5Zm0,4h5v2H5Zm0,4h5v2H5ZM22,3V21a1,1,0,0,1-1,1H15V4H10V3a1,1,0,0,1,1-1H21A1,1,0,0,1,22,3Z"],[1,"relative","group"],[1,"buttonSideBar","flex","items-center","justify-between","cursor-pointer","w-full",3,"click"],["src","/assets/svg/calendar.svg","alt","Description of the image",1,"size-6"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","width","20","height","20",1,"ml-auto","text-right",3,"ngClass"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class"," left-0 mt-2 w-48 bg-customDarkGreen  text-white shadow-lg rounded-lg overflow-hidden transition-all duration-200",4,"ngIf"],[1,"left-0","mt-2","w-48","bg-customDarkGreen","text-white","shadow-lg","rounded-lg","overflow-hidden","transition-all","duration-200"],["routerLink","/add-events",1,"block","px-4","py-2","hover:bg-hoverBar","text-sm"],["routerLink","/manage-events",1,"block","px-4","py-2","hover:bg-hoverBar","text-sm"],["routerLink","/manage-user","routerLinkActive","active",1,"buttonSideBar"],["width","24px","height","24px","viewBox","0 0 16 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8 7C9.65685 7 11 5.65685 11 4C11 2.34315 9.65685 1 8 1C6.34315 1 5 2.34315 5 4C5 5.65685 6.34315 7 8 7Z","fill","white"],["d","M14 12C14 10.3431 12.6569 9 11 9H5C3.34315 9 2 10.3431 2 12V15H14V12Z","fill","white"],["routerLink","/reports","routerLinkActive","active",1,"buttonSideBar"],["fill","white","width","24px","height","24px","viewBox","0 0 32 32","version","1.1","xmlns","http://www.w3.org/2000/svg"],["d","M6 11h4v17h-4v-17zM22 16v12h4v-12h-4zM14 28h4v-24h-4v24z"],["routerLink","/history","routerLinkActive","active",1,"buttonSideBar"],["width","24px","height","24px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 8V12L14.5 14.5","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M5.60423 5.60423L5.0739 5.0739V5.0739L5.60423 5.60423ZM4.33785 6.87061L3.58786 6.87438C3.58992 7.28564 3.92281 7.61853 4.33408 7.6206L4.33785 6.87061ZM6.87963 7.63339C7.29384 7.63547 7.63131 7.30138 7.63339 6.88717C7.63547 6.47296 7.30138 6.13549 6.88717 6.13341L6.87963 7.63339ZM5.07505 4.32129C5.07296 3.90708 4.7355 3.57298 4.32129 3.57506C3.90708 3.57715 3.57298 3.91462 3.57507 4.32882L5.07505 4.32129ZM3.75 12C3.75 11.5858 3.41421 11.25 3 11.25C2.58579 11.25 2.25 11.5858 2.25 12H3.75ZM16.8755 20.4452C17.2341 20.2378 17.3566 19.779 17.1492 19.4204C16.9418 19.0619 16.483 18.9393 16.1245 19.1468L16.8755 20.4452ZM19.1468 16.1245C18.9393 16.483 19.0619 16.9418 19.4204 17.1492C19.779 17.3566 20.2378 17.2341 20.4452 16.8755L19.1468 16.1245ZM5.14033 5.07126C4.84598 5.36269 4.84361 5.83756 5.13505 6.13191C5.42648 6.42626 5.90134 6.42862 6.19569 6.13719L5.14033 5.07126ZM18.8623 5.13786C15.0421 1.31766 8.86882 1.27898 5.0739 5.0739L6.13456 6.13456C9.33366 2.93545 14.5572 2.95404 17.8017 6.19852L18.8623 5.13786ZM5.0739 5.0739L3.80752 6.34028L4.86818 7.40094L6.13456 6.13456L5.0739 5.0739ZM4.33408 7.6206L6.87963 7.63339L6.88717 6.13341L4.34162 6.12062L4.33408 7.6206ZM5.08784 6.86684L5.07505 4.32129L3.57507 4.32882L3.58786 6.87438L5.08784 6.86684ZM12 3.75C16.5563 3.75 20.25 7.44365 20.25 12H21.75C21.75 6.61522 17.3848 2.25 12 2.25V3.75ZM12 20.25C7.44365 20.25 3.75 16.5563 3.75 12H2.25C2.25 17.3848 6.61522 21.75 12 21.75V20.25ZM16.1245 19.1468C14.9118 19.8483 13.5039 20.25 12 20.25V21.75C13.7747 21.75 15.4407 21.2752 16.8755 20.4452L16.1245 19.1468ZM20.25 12C20.25 13.5039 19.8483 14.9118 19.1468 16.1245L20.4452 16.8755C21.2752 15.4407 21.75 13.7747 21.75 12H20.25ZM6.19569 6.13719C7.68707 4.66059 9.73646 3.75 12 3.75V2.25C9.32542 2.25 6.90113 3.32791 5.14033 5.07126L6.19569 6.13719Z","fill","white"],["routerLink","/user-control","routerLinkActive","active",1,"buttonSideBar"],["width","24px","height","24px","viewBox","0 0 30 30","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xmlns","sketch","http://www.bohemiancoding.com/sketch/ns"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd",0,"sketch","type","MSPage"],["id","Icon-Set-Filled",0,"sketch","type","MSLayerGroup","transform","translate(-103.000000, -362.000000)","fill","white"],["d","M118,382 C115.261,382 113.042,379.762 113.042,377 C113.042,374.238 115.261,372 118,372 C120.739,372 122.959,374.238 122.959,377 C122.959,379.762 120.739,382 118,382 L118,382 Z M132.008,380.536 L129.685,379.184 C129.815,378.474 129.901,377.749 129.901,377 C129.901,376.252 129.815,375.526 129.685,374.816 L132.008,373.464 C132.957,372.912 133.281,371.688 132.733,370.732 L130.75,367.268 C130.203,366.312 128.989,365.983 128.041,366.536 L125.694,367.901 C124.598,366.961 123.352,366.192 121.967,365.697 L121.967,364 C121.967,362.896 121.079,362 119.983,362 L116.017,362 C114.921,362 114.033,362.896 114.033,364 L114.033,365.697 C112.648,366.192 111.402,366.961 110.306,367.901 L107.959,366.536 C107.011,365.983 105.797,366.312 105.25,367.268 L103.267,370.732 C102.719,371.688 103.044,372.912 103.992,373.464 L106.315,374.816 C106.185,375.526 106.099,376.252 106.099,377 C106.099,377.749 106.185,378.474 106.315,379.184 L103.992,380.536 C103.044,381.088 102.719,382.312 103.267,383.268 L105.25,386.732 C105.797,387.688 107.011,388.017 107.959,387.464 L110.306,386.099 C111.402,387.039 112.648,387.809 114.033,388.303 L114.033,390 C114.033,391.104 114.921,392 116.017,392 L119.983,392 C121.079,392 121.967,391.104 121.967,390 L121.967,388.303 C123.352,387.809 124.598,387.039 125.694,386.099 L128.041,387.464 C128.989,388.017 130.203,387.688 130.75,386.732 L132.733,383.268 C133.281,382.312 132.957,381.088 132.008,380.536 L132.008,380.536 Z M118,374 C116.357,374 115.025,375.344 115.025,377 C115.025,378.657 116.357,380 118,380 C119.643,380 120.975,378.657 120.975,377 C120.975,375.344 119.643,374 118,374 L118,374 Z","id","settings",0,"sketch","type","MSShapeGroup"]],template:function(t,n){t&1&&(x(0,"div",0)(1,"div",1)(2,"img",2),Z("click",function(){return n.refreshPage()}),b(),x(3,"p",3),M(4,"CHMSU-A MAPP"),b()(),x(5,"p",4),M(6,"Dashboard"),b(),B(7,"hr",5),x(8,"a",6)(9,"span",7),te(),x(10,"svg",8),B(11,"path",9)(12,"path",10),b()(),M(13," Dashboard "),b(),ot(),x(14,"p",4),M(15,"Interface"),b(),B(16,"hr",5),ee(17,Oee,5,0,"a",11)(18,Vee,8,4,"div",12),x(19,"a",13)(20,"span",7),te(),x(21,"svg",14),B(22,"polygon",15)(23,"polygon",16)(24,"polygon",17)(25,"path",18)(26,"circle",19),b()(),M(27,"Kiosks"),b(),ee(28,Uee,6,0,"a",20)(29,Hee,7,0,"a",21)(30,zee,6,0,"a",22)(31,jee,7,0,"a",23),ot(),x(32,"a",24),Z("click",function(){return n.logout()}),x(33,"span",7),te(),x(34,"svg",25),B(35,"path",26),b()(),M(36,"logout"),b()()),t&2&&(I(8),F("routerLinkActiveOptions",Xi(7,Nee)),I(9),F("ngIf",n.transactions=="1"),I(),F("ngIf",n.events=="1"),I(10),F("ngIf",n.settings=="1"),I(),F("ngIf",n.reports=="1"),I(),F("ngIf",n.history=="1"),I(),F("ngIf",n.control=="1"))},dependencies:[Mt,Ns,Nt,Wc,Km],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}.buttonSideBar[_ngcontent-%COMP%]{display:flex;height:2.5rem;width:100%;align-items:center;justify-content:flex-start;padding:.5rem;font-size:1.125rem;line-height:1.75rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.buttonSideBar[_ngcontent-%COMP%]:hover{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(27 67 50 / var(--tw-bg-opacity));--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}.truncate[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.active[_ngcontent-%COMP%]{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(44 110 73 / var(--tw-bg-opacity));padding:.5rem;--tw-shadow-color: #1b4332;--tw-shadow-color: 2px;--tw-shadow: var(--tw-shadow-colored)}"]})};var Gee=["notifer"],Wee=["notifyButton"],qee=["sidebar"],Zee=["sidebarButton"];function Xee(i,e){i&1&&(x(0,"div",7)(1,"div",8),B(2,"app-navbar"),b(),x(3,"div",9),B(4,"router-outlet"),b()())}function Yee(i,e){i&1&&(x(0,"div",17,0)(2,"div",12),B(3,"app-admin-navbar"),b()())}function Qee(i,e){if(i&1&&(x(0,"span"),M(1),b()),i&2){let t=Y(4);I(),ge(t.getUnreadCount())}}function Kee(i,e){i&1&&(x(0,"div",41)(1,"div",42),M(2,"No new notifications"),b()())}function Jee(i,e){if(i&1){let t=rt();x(0,"button",49),Z("click",function(){he(t);let r=Y(2).$implicit,s=Y(5);return s.readMessage(r.notification_id,"read"),fe(s.refreshPage())}),M(1,"Read"),b()}}function $ee(i,e){if(i&1&&(x(0,"div",45)(1,"div",46),M(2),b(),x(3,"div",47),M(4),ee(5,Jee,2,0,"button",48),b()()),i&2){let t=Y().$implicit,n=Y(5);I(2),ge(t.message),I(2),Qt(" ",n.formatDate(t.date_created)," "),I(),F("ngIf",t.status=="unread")}}function ete(i,e){if(i&1&&(x(0,"div")(1,"div",43),ee(2,$ee,6,3,"div",44),b()()),i&2){let t=e.$implicit;I(2),F("ngIf",t.status=="unread")}}function tte(i,e){if(i&1&&(x(0,"div",41)(1,"div",50),M(2),b(),x(3,"div",51),M(4),b()()),i&2){let t=Y().$implicit,n=Y(5);I(2),ge(t.message),I(2),ge(n.formatDate(t.date_created))}}function nte(i,e){if(i&1&&(x(0,"div"),ee(1,tte,5,2,"div",39),b()),i&2){let t=e.$implicit;I(),F("ngIf",t.status=="read")}}function ite(i,e){if(i&1&&(x(0,"div",33,3)(2,"div",34),B(3,"div",35),x(4,"div",36)(5,"div",37)(6,"div",38),M(7,"Unread Messages:"),b(),B(8,"hr"),ee(9,Kee,3,0,"div",39)(10,ete,3,1,"div",40),x(11,"div",38),M(12,"Read Messages:"),b(),B(13,"hr"),ee(14,nte,2,1,"div",40),b()()()()),i&2){let t=Y(4);I(9),F("ngIf",!t.hasUnreadMessages()),I(),F("ngForOf",t.notification),I(4),F("ngForOf",t.notification)}}function rte(i,e){i&1&&B(0,"img",52)}function ste(i,e){i&1&&(x(0,"span"),M(1,"..."),b())}function ote(i,e){if(i&1){let t=rt();x(0,"div",20)(1,"div")(2,"button",21,1),Z("click",function(){he(t);let r=Y(3);return fe(r.toggleSidebar())}),te(),x(4,"svg",22),B(5,"path",23),b()()(),ot(),x(6,"div",24)(7,"button",25,2),Z("click",function(){he(t);let r=Y(3);return fe(r.toggleNotificationBar())}),te(),x(9,"svg",26),B(10,"path",27),b(),ot(),x(11,"p",28),ee(12,Qee,2,1,"span",6),b()(),ee(13,ite,15,3,"div",29),x(14,"div",30),ee(15,rte,1,0,"img",31),b(),x(16,"div",32),M(17),ml(18,"slice"),ee(19,ste,2,0,"span",6),b()()()}if(i&2){let t=e.$implicit,n=Y(3);I(12),F("ngIf",n.notification),I(),F("ngIf",n.toggleNotification),I(2),F("ngIf",!t.profile_image),I(2),Qt(" ",Dc(18,5,t.First_name,0,6),""),I(2),F("ngIf",t.First_name.length>6)}}function ate(i,e){if(i&1&&(x(0,"div",18),ee(1,ote,20,9,"div",19),b()),i&2){let t=Y(2);I(),F("ngForOf",t.userData)}}function lte(i,e){if(i&1&&(x(0,"div",7)(1,"div",10)(2,"div",11)(3,"div",12),B(4,"app-admin-navbar"),b()(),ee(5,Yee,4,0,"div",13),x(6,"div",14),ee(7,ate,2,1,"div",15),x(8,"div",16),B(9,"router-outlet"),b()()()()),i&2){let t=Y();I(5),F("ngIf",t.isSidebarVisible),I(2),F("ngIf",!t.isMap())}}function cte(i,e){i&1&&(x(0,"div",53),B(1,"app-footer",54),b())}function dte(i,e){i&1&&(x(0,"div"),B(1,"router-outlet"),b())}var Jd=class i{constructor(e,t,n){this.router=e;this.userService=t;this.adminService=n}notification=[];notifer;notifyButton;sidebar;sidebarButton;showNotification=!1;toggleNotification=!1;userType=null;token="";userData=[];isSidebarVisible=!1;toggleSidebar(){this.isSidebarVisible=!this.isSidebarVisible}ngDoCheck(){this.userType=sessionStorage.getItem("userType")}ngOnInit(){this.fetchUser(),this.getNotification()}onClickOutside(e){this.notifer?.nativeElement&&this.notifyButton?.nativeElement&&!this.notifer.nativeElement.contains(e.target)&&!this.notifyButton.nativeElement.contains(e.target)&&this.toggleNotification===!0?this.toggleNotification=!1:e.stopPropagation(),this.sidebar?.nativeElement&&this.sidebarButton?.nativeElement&&!this.sidebar.nativeElement.contains(e.target)&&!this.sidebarButton.nativeElement.contains(e.target)&&this.isSidebarVisible===!0?this.isSidebarVisible=!1:e.stopPropagation()}getNotification(){this.token=sessionStorage.getItem("tokenId")??"",this.adminService.getNotification(this.token).subscribe(e=>{this.notification=this.sortNotifications(e)})}sortNotifications(e){return e.sort((t,n)=>t.status==="read"&&n.status!=="read"?-1:t.status!=="read"&&n.status==="read"?1:0)}fetchUser(){this.token=sessionStorage.getItem("tokenId")??"",this.userService.getUser(this.token).subscribe(e=>{this.userData=e})}toggleNotificationBar(){this.toggleNotification=!this.toggleNotification}formatDate(e){let t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("en-US",t).replace(",","")}shouldShowForUser(){return this.userType==="user"&&!this.isRoute()}isMap(){return this.router.url.startsWith("/map-viewer-admin")}isRoute(){return this.router.url.startsWith("/login")||this.router.url.startsWith("/register")}shouldShowForAdmin(){return this.userType!=="user"&&!this.isRoute()}hasUnreadMessages(){return this.notification.some(e=>e.status==="unread")}readMessage(e,t){this.userService.updateMessage(e,t).subscribe()}refreshPage(){window.location.reload()}getUnreadCount(){return this.notification.reduce((e,t)=>t.status==="unread"?e+1:e,0)}static \u0275fac=function(t){return new(t||i)(ne(et),ne(qn),ne(gn))};static \u0275cmp=vt({type:i,selectors:[["app-root"]],viewQuery:function(t,n){if(t&1&&(ai(Gee,5),ai(Wee,5),ai(qee,5),ai(Zee,5)),t&2){let r;zn(r=jn())&&(n.notifer=r.first),zn(r=jn())&&(n.notifyButton=r.first),zn(r=jn())&&(n.sidebar=r.first),zn(r=jn())&&(n.sidebarButton=r.first)}},hostBindings:function(t,n){t&1&&Z("click",function(s){return n.onClickOutside(s)},!1,aI)},standalone:!0,features:[_t],decls:4,vars:4,consts:[["sidebar",""],["sidebarButton",""],["notifyButton",""],["notifer",""],["class","min-h-screen flex flex-col items-center bg-customBlack",4,"ngIf"],["class","w-full max-w-screen-xl h-8",4,"ngIf"],[4,"ngIf"],[1,"min-h-screen","flex","flex-col","items-center","bg-customBlack"],[1,"w-full","max-w-full"],[1,"w-full","max-w-screen-xl"],[1,"flex","w-full","justiy-center","align-center"],[1,"hidden","md:flex","w-60","h-full","text-white","flex-col","justify-between","fixed","z-[1000]"],[1,"flex","min-h-screen","w-full","bg-customDarkGreen","shadow-r-xl","shadow-black"],["class","flex md:hidden w-60 h-full  text-white flex-col justify-between fixed z-[1000]",4,"ngIf"],[1,"flex-1","md:ml-60","max-w-screen-xl"],["class","w-full ",4,"ngIf"],[1,"pt-4","max-w-screen-xl"],[1,"flex","md:hidden","w-60","h-full","text-white","flex-col","justify-between","fixed","z-[1000]"],[1,"w-full"],["class"," flex justify-between items-center h-16 bg-[#2c6e49] shadow-[#1b4332] shadow-md px-4 py-4",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","h-16","bg-[#2c6e49]","shadow-[#1b4332]","shadow-md","px-4","py-4"],[1,"md:hidden","text-white","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[1,"flex","justify-center"],[1,"text-white","rounded-md","text-sm","flex","items-center","justify-between","w-auto","pr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 48 48","fill","#ffffff"],["d","M38.498 36H9.502c-1.205 0-2.31-.607-2.955-1.625S5.822 32.1 6.335 31.01L9 25.648v-6.267c0-8.239 6.271-14.987 14.277-15.364l0 0c4.151-.188 8.08 1.271 11.075 4.128C37.35 11.004 39 14.859 39 19v6.648l2.65 5.333c.527 1.119.448 2.377-.197 3.395S39.703 36 38.498 36zM23.348 5.516h.01H23.348zM18.09 38c.478 2.833 2.942 5 5.91 5s5.431-2.167 5.91-5H18.09z"],[1,"relative","size-5","bg-[#880d1e]","rounded-full","text-center","top-[-10px]","left-[-15px]"],["class","flex absolute justify-end items-center animate-swipeDown max-w-[350px] shadow-r-md shadow-black p-2 z-[1000]",4,"ngIf"],[1,"flex","justify-center","items-center"],["src","assets/images/defaultProfile.png","class","size-10 bg-black rounded-full",4,"ngIf"],[1,"pl-2","text-xl","font-bold","justify-center","align-center","pt-1","text-gray-50","pr-4"],[1,"flex","absolute","justify-end","items-center","animate-swipeDown","max-w-[350px]","shadow-r-md","shadow-black","p-2","z-[1000]"],[1,"relative","max-w-[350px]","top-12","right-[8.85rem]","bg-dropDown","shadow-xl","rounded-lg","p-4"],[1,"relative","-top-8","left-36","md:left-36","w-0","h-0","border-l-[36px]","border-r-[36px]","border-b-[36px]","border-l-transparent","border-r-transparent","border-dropDown"],[1,"h-96","w-56","pb-2","grid","overflow-hidden"],[1,"overflow-scrollable","h-full","overflow-y-auto","px-2"],[1,"text-white","text-md","font-bold"],["class","block text-sm justify-self-start align-start py-2",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"block","text-sm","justify-self-start","align-start","py-2"],[1,"text-md","text-white","text-center"],[1,"text-gray-500","text-sm","mb-4","text-center"],["class","block text-sm w-full",4,"ngIf"],[1,"block","text-sm","w-full"],[1,"text-md","text-white","text-left"],[1,"text-[10px]","pt-1","text-right","text-white","flex","justify-between"],["class","text-gray-300 hover:text-gray-50 underline",3,"click",4,"ngIf"],[1,"text-gray-300","hover:text-gray-50","underline",3,"click"],[1,"text-md","text-white"],[1,"text-[10px]","pt-1","text-white","text-left"],["src","assets/images/defaultProfile.png",1,"size-10","bg-black","rounded-full"],[1,"w-full","max-w-screen-xl","h-8"],[1,"bg-customBlack"]],template:function(t,n){t&1&&ee(0,Xee,5,0,"div",4)(1,lte,10,2,"div",4)(2,cte,2,0,"div",5)(3,dte,2,0,"div",6),t&2&&(F("ngIf",n.shouldShowForUser()),I(),F("ngIf",n.shouldShowForAdmin()),I(),F("ngIf",n.shouldShowForUser()||n.shouldShowForAdmin()),I(),F("ngIf",n.isRoute()))},dependencies:[Mt,pn,Nt,Lc,qb,dx,ux,hx],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-ms-user-select:none}"]})};var FC={providers:[TD(),EP(NC)]};Pm(Jd,FC).catch(i=>console.error(i));Pm(Jd,FC).catch(i=>console.error(i));
